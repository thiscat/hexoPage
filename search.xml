<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ç¯å¢ƒéƒ¨ç½²</title>
      <link href="/posts/8c50c265.html"/>
      <url>/posts/8c50c265.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€homesteadç›¸å…³"><a href="#ä¸€ã€homesteadç›¸å…³" class="headerlink" title="ä¸€ã€homesteadç›¸å…³"></a>ä¸€ã€homesteadç›¸å…³</h1><h2 id="1-æŒ‡å®šboxä¸ºæœ¬åœ°"><a href="#1-æŒ‡å®šboxä¸ºæœ¬åœ°" class="headerlink" title="1. æŒ‡å®šboxä¸ºæœ¬åœ°"></a>1. æŒ‡å®šboxä¸ºæœ¬åœ°</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;laravel/homestead&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;versions&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;14.0.2&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;providers&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;virtualbox&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./homestead.box&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="2-é…ç½®å’Œå‘½ä»¤"><a href="#2-é…ç½®å’Œå‘½ä»¤" class="headerlink" title="2. é…ç½®å’Œå‘½ä»¤"></a>2. é…ç½®å’Œå‘½ä»¤</h2><p>æŒ‡å®šç›¸å…³å‚æ•°</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è™šæ‹Ÿæœºåç§°ï¼ˆæ˜¾ç¤ºåœ¨è™šæ‹ŸåŒ–è½¯ä»¶ä¸­çš„åç§°ï¼‰</span></span><br><span class="line"><span class="comment"># æ­¤åç§°åœ¨å®¿ä¸»æœºä¸­éœ€å”¯ä¸€ï¼Œé¿å…å†²çª</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">&#x27;homestead&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨çš„ Vagrant Box åç§°</span></span><br><span class="line"><span class="comment"># å¯æŒ‡å®šç‰ˆæœ¬ï¼Œä¾‹å¦‚ box: &#x27;laravel/homestead:11.0.0&#x27;</span></span><br><span class="line"><span class="attr">box:</span> <span class="string">&#x27;laravel/homestead&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è™šæ‹Ÿæœºä¸»æœºåï¼ˆè™šæ‹Ÿæœºå†…éƒ¨è¯†åˆ«çš„ hostnameï¼‰</span></span><br><span class="line"><span class="comment"># ç”¨äºç½‘ç»œé€šä¿¡å’Œ SSH è¿æ¥</span></span><br><span class="line"><span class="attr">hostname:</span> <span class="string">&#x27;homesteadâ€˜</span></span><br></pre></td></tr></table></figure><p>å¯¹åº”å‘½ä»¤</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># å¯åŠ¨nameä¸ºhomestead</span><br><span class="line">vagrant up homestead</span><br><span class="line"></span><br><span class="line"># provisionï¼šé‡è½½é…ç½®</span><br><span class="line"># --fileï¼šæŒ‡å®šçš„yamlé…ç½®æ–‡ä»¶</span><br><span class="line">vagrant up --provision --file=Homestead-web.yaml</span><br></pre></td></tr></table></figure><h1 id="äºŒã€å¼€å‘ç¯å¢ƒç›¸å…³"><a href="#äºŒã€å¼€å‘ç¯å¢ƒç›¸å…³" class="headerlink" title="äºŒã€å¼€å‘ç¯å¢ƒç›¸å…³"></a>äºŒã€å¼€å‘ç¯å¢ƒç›¸å…³</h1><p>clashéœ€è¦å¼€å¯å…è®¸å±€åŸŸç½‘æ¥å…¥</p><h2 id="1-è„šæœ¬"><a href="#1-è„šæœ¬" class="headerlink" title="1. è„šæœ¬"></a>1. è„šæœ¬</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">set</span> +e</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¹‚ç­‰æ€§æ§åˆ¶ç›®å½•</span></span><br><span class="line">STATE_DIR=<span class="string">&quot;<span class="variable">$&#123;HOME&#125;</span>/.script_states&quot;</span></span><br><span class="line"><span class="built_in">mkdir</span> -p <span class="string">&quot;<span class="variable">$STATE_DIR</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ—¥å¿—é…ç½®</span></span><br><span class="line">LOG_FILE=<span class="string">&quot;<span class="variable">$&#123;HOME&#125;</span>/provision.log&quot;</span></span><br><span class="line"><span class="built_in">exec</span> 3&gt;&amp;1 4&gt;&amp;2</span><br><span class="line"><span class="built_in">touch</span> <span class="string">&quot;<span class="variable">$LOG_FILE</span>&quot;</span></span><br><span class="line"><span class="built_in">exec</span> &gt; &gt;(<span class="built_in">tee</span> -a <span class="string">&quot;<span class="variable">$LOG_FILE</span>&quot;</span>) 2&gt;&amp;1</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‡½æ•°ï¼šå¸¦çŠ¶æ€æ£€æµ‹çš„å‘½ä»¤æ‰§è¡Œ</span></span><br><span class="line"><span class="keyword">function</span> idempotent_cmd &#123;</span><br><span class="line">    <span class="built_in">local</span> state_file=<span class="string">&quot;<span class="variable">$1</span>&quot;</span></span><br><span class="line">    <span class="built_in">local</span> cmd=<span class="string">&quot;<span class="variable">$2</span>&quot;</span></span><br><span class="line">    <span class="built_in">shift</span> 2</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> [ -f <span class="string">&quot;<span class="variable">$&#123;STATE_DIR&#125;</span>/<span class="variable">$&#123;state_file&#125;</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;âœ… [è·³è¿‡] å·²æ‰§è¡Œ: <span class="variable">$cmd</span>&quot;</span> &gt;&amp;3</span><br><span class="line">        <span class="built_in">return</span> 0</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;ğŸ”„ [æ‰§è¡Œ] <span class="variable">$cmd</span> <span class="variable">$@</span>&quot;</span> &gt;&amp;3</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;<span class="variable">$cmd</span>&quot;</span> <span class="string">&quot;<span class="variable">$@</span>&quot;</span>; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">touch</span> <span class="string">&quot;<span class="variable">$&#123;STATE_DIR&#125;</span>/<span class="variable">$&#123;state_file&#125;</span>&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;âœ”ï¸ [æˆåŠŸ] <span class="variable">$cmd</span>&quot;</span> &gt;&amp;3</span><br><span class="line">        <span class="built_in">return</span> 0</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;âŒ [å¤±è´¥] <span class="variable">$cmd</span> é”™è¯¯ç : $?&quot;</span> &gt;&amp;3</span><br><span class="line">        <span class="built_in">return</span> 1</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. ç³»ç»Ÿæºé…ç½®</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">configure_sources</span></span>() &#123;</span><br><span class="line">    <span class="comment"># å¤‡ä»½æ£€æµ‹</span></span><br><span class="line">    <span class="keyword">if</span> [ ! -f <span class="string">&quot;/etc/apt/sources.list_back&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">        idempotent_cmd <span class="string">&quot;apt_backup&quot;</span> <span class="built_in">sudo</span> <span class="built_in">cp</span> /etc/apt/sources.list /etc/apt/sources.list_back</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¿®æ”¹æºæ£€æµ‹</span></span><br><span class="line">    <span class="keyword">if</span> ! grep -q <span class="string">&quot;mirrors.tuna.tsinghua.edu.cn&quot;</span> /etc/apt/sources.list; <span class="keyword">then</span></span><br><span class="line">        idempotent_cmd <span class="string">&quot;apt_source_modify&quot;</span> <span class="built_in">sudo</span> sed -i \</span><br><span class="line">            -e <span class="string">&#x27;s/archive.ubuntu.com/mirrors.tuna.tsinghua.edu.cn/g&#x27;</span> \</span><br><span class="line">            -e <span class="string">&#x27;s/security.ubuntu.com/mirrors.tuna.tsinghua.edu.cn/g&#x27;</span> \</span><br><span class="line">            /etc/apt/sources.list</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">    idempotent_cmd <span class="string">&quot;apt_update&quot;</span> <span class="built_in">sudo</span> apt-get update -y</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. Dockerå®‰è£…</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">install_docker</span></span>() &#123;</span><br><span class="line">    <span class="comment"># ä»“åº“é…ç½®</span></span><br><span class="line">    <span class="keyword">if</span> [ ! -f <span class="string">&quot;/etc/apt/sources.list.d/docker.list&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">        idempotent_cmd <span class="string">&quot;docker_repo_setup&quot;</span> <span class="built_in">sudo</span> apt-key adv \</span><br><span class="line">            --keyserver hkp://keyserver.ubuntu.com:80 \</span><br><span class="line">            --recv-keys 0EBFCD88</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu <span class="subst">$(lsb_release -cs)</span> stable&quot;</span> | \</span><br><span class="line">            idempotent_cmd <span class="string">&quot;docker_repo_add&quot;</span> <span class="built_in">sudo</span> <span class="built_in">tee</span> /etc/apt/sources.list.d/docker.list</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># å®‰è£…æ£€æµ‹</span></span><br><span class="line">    <span class="comment"># if ! command -v docker &amp;&gt; /dev/null; then</span></span><br><span class="line">        <span class="comment"># idempotent_cmd &quot;docker_install&quot; sudo apt-get install -y \</span></span><br><span class="line">        <span class="comment">#     docker-ce \</span></span><br><span class="line">        <span class="comment">#     docker-ce-cli \</span></span><br><span class="line">        <span class="comment">#     containerd.io</span></span><br><span class="line">    <span class="comment"># fi</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># é•œåƒåŠ é€Ÿ</span></span><br><span class="line">    <span class="keyword">if</span> [ ! -f <span class="string">&quot;/etc/docker/daemon.json&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">        idempotent_cmd <span class="string">&quot;docker_mirror&quot;</span> <span class="built_in">sudo</span> <span class="built_in">tee</span> /etc/docker/daemon.json &lt;&lt;-<span class="string">&#x27;EOF&#x27;</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;registry-mirrors&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;https://dockerhub.azk8s.cn&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://hub-mirror.c.163.com&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://mirror.baidubce.com&quot;</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">        idempotent_cmd <span class="string">&quot;docker_restart&quot;</span> <span class="built_in">sudo</span> systemctl restart docker</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. Nodeç¯å¢ƒé…ç½®</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">configure_node</span></span>() &#123;</span><br><span class="line">    <span class="comment"># nvmå®‰è£…</span></span><br><span class="line">    <span class="keyword">if</span> [ ! -d <span class="string">&quot;<span class="variable">$&#123;HOME&#125;</span>/.nvm&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">        idempotent_cmd <span class="string">&quot;nvm_install&quot;</span> curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh | bash</span><br><span class="line">        <span class="built_in">export</span> NVM_DIR=<span class="string">&quot;<span class="variable">$&#123;HOME&#125;</span>/.nvm&quot;</span></span><br><span class="line">        [ -s <span class="string">&quot;<span class="variable">$NVM_DIR</span>/nvm.sh&quot;</span> ] &amp;&amp; \. <span class="string">&quot;<span class="variable">$NVM_DIR</span>/nvm.sh&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># å¸è½½é»˜è®¤çš„nodejs</span></span><br><span class="line">    idempotent_cmd <span class="built_in">sudo</span> apt-get remove nodejs</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Nodeå®‰è£…</span></span><br><span class="line">    <span class="keyword">if</span> ! <span class="built_in">command</span> -v node &amp;&gt; /dev/null; <span class="keyword">then</span></span><br><span class="line">        idempotent_cmd <span class="string">&quot;node_install&quot;</span> nvm install --lts</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># å…¨å±€åŒ…æ£€æµ‹</span></span><br><span class="line">    <span class="built_in">declare</span> -A GLOBAL_PKGS=(</span><br><span class="line">        [<span class="string">&quot;nrm&quot;</span>]=<span class="string">&quot;nrm&quot;</span></span><br><span class="line">        [<span class="string">&quot;hexo-cli&quot;</span>]=<span class="string">&quot;hexo-cli&quot;</span></span><br><span class="line">        [<span class="string">&quot;@vue/cli&quot;</span>]=<span class="string">&quot;@vue/cli&quot;</span></span><br><span class="line">        [<span class="string">&quot;vite&quot;</span>]=<span class="string">&quot;vite&quot;</span></span><br><span class="line">        [<span class="string">&quot;vue-router&quot;</span>]=<span class="string">&quot;vue-router&quot;</span></span><br><span class="line">        [<span class="string">&quot;axios&quot;</span>]=<span class="string">&quot;axios&quot;</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> pkg <span class="keyword">in</span> <span class="string">&quot;<span class="variable">$&#123;!GLOBAL_PKGS[@]&#125;</span>&quot;</span>; <span class="keyword">do</span></span><br><span class="line">        <span class="keyword">if</span> ! npm list -g --depth=0 | grep -q <span class="string">&quot;<span class="variable">$&#123;GLOBAL_PKGS[$pkg]&#125;</span>&quot;</span>; <span class="keyword">then</span></span><br><span class="line">            idempotent_cmd <span class="string">&quot;npm_install_<span class="variable">$pkg</span>&quot;</span> npm install -g <span class="string">&quot;<span class="variable">$&#123;GLOBAL_PKGS[$pkg]&#125;</span>&quot;</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># é•œåƒé…ç½®</span></span><br><span class="line">    <span class="keyword">if</span> [ <span class="string">&quot;<span class="subst">$(npm config get registry)</span>&quot;</span> != <span class="string">&quot;https://registry.npmmirror.com&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">        idempotent_cmd <span class="string">&quot;npm_registry&quot;</span> npm config <span class="built_in">set</span> registry https://registry.npmmirror.com</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. Composeré…ç½®</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">configure_composer</span></span>() &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">command</span> -v composer &amp;&gt; /dev/null; <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">if</span> ! composer config -g --list | grep -q <span class="string">&quot;mirrors.aliyun.com&quot;</span>; <span class="keyword">then</span></span><br><span class="line">            idempotent_cmd <span class="string">&quot;composer_mirror&quot;</span> composer config -g repo.packagist composer https://mirrors.aliyun.com/composer/</span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡Œæµç¨‹</span></span><br><span class="line">configure_sources</span><br><span class="line">install_docker</span><br><span class="line">configure_node</span><br><span class="line">configure_composer</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¸…ç†</span></span><br><span class="line"><span class="built_in">exec</span> 1&gt;&amp;3 2&gt;&amp;4</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;æ‰§è¡Œå®Œæˆï¼Œè¯¦ç»†æ—¥å¿—æŸ¥çœ‹: <span class="variable">$&#123;LOG_FILE&#125;</span>&quot;</span></span><br><span class="line">[ -d <span class="string">&quot;<span class="variable">$STATE_DIR</span>&quot;</span> ] &amp;&amp; find <span class="string">&quot;<span class="variable">$STATE_DIR</span>&quot;</span> -<span class="built_in">type</span> f -mtime +30 -delete</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> homestead </category>
          
      </categories>
      
      
        <tags>
            
            <tag> homestead </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç”Ÿæˆæ‰‹æœºå·ç³»ç»Ÿ</title>
      <link href="/posts/3c50be18.html"/>
      <url>/posts/3c50be18.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>ç”Ÿæˆç›®å‰å¯èƒ½å­˜åœ¨çš„æ‰€æœ‰æ‰‹æœºå·</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">è°ƒåº¦è¡¨ï¼š phone<span class="emphasis">_tasks</span></span><br><span class="line"><span class="emphasis">å­—æ®µï¼šstart_number end_</span>number status</span><br><span class="line"></span><br><span class="line">æ‰‹æœºå·è¡¨: phone<span class="emphasis">_numbers</span></span><br><span class="line"><span class="emphasis">å­—æ®µï¼šphone_number status created_at updated_</span>at</span><br><span class="line"></span><br><span class="line">1. å…ˆå°†æœ€å°çš„æ‰‹æœºå·ï¼ˆ13000000000ï¼‰ï¼Œ åˆ°æœ€å¤§æ‰‹æœºå·ï¼ˆ19999999999ï¼‰ï¼Œå¾ªç¯å¤„ç†ï¼Œåˆ‡å‰²æˆå¤šä»½ï¼Œå†™å…¥start<span class="emphasis">_numberå’Œend_numberã€‚åŒæ—¶å°†ä»»åŠ¡å†™å…¥åˆ°redisä¸­</span></span><br><span class="line"><span class="emphasis">2. ä»»åŠ¡è°ƒåº¦ç±»ï¼Œå°†è°ƒåº¦è¡¨æŸ¥æ‰¾å‡ºæœªè¢«è°ƒç”¨çš„ä»»åŠ¡ã€‚</span></span><br><span class="line"><span class="emphasis">3. è°ƒç”¨redisé”ï¼Œé˜²æ­¢é‡å¤è°ƒç”¨ä»»åŠ¡ï¼Œæ ¹æ®start_numberå’Œend_</span>numberå¼€å§‹å¾ªç¯ï¼ŒåŒæ—¶å¯¹å¾ªç¯ä¸­çš„numè¿›è¡ŒéªŒè¯æ˜¯å¦ç¬¦åˆè§„åˆ™å¹¶ä¸”rediså’Œæ•°æ®åº“ä¸­éƒ½ä¸å­˜åœ¨è¿‡</span><br><span class="line">4. æ‰¹é‡å†™å…¥æ•°æ®åº“ä¸­</span><br></pre></td></tr></table></figure><h1 id="ä¸€ã€ä»£ç å®ç°"><a href="#ä¸€ã€ä»£ç å®ç°" class="headerlink" title="ä¸€ã€ä»£ç å®ç°"></a>ä¸€ã€ä»£ç å®ç°</h1><h2 id="1-åˆå§‹åŒ–"><a href="#1-åˆå§‹åŒ–" class="headerlink" title="1. åˆå§‹åŒ–"></a>1. åˆå§‹åŒ–</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TaskInitializer</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">CHUNK_SIZE</span> = <span class="number">1000000</span>; <span class="comment">// æ¯ä¸ªä»»åŠ¡åŒ…å«å·ç é‡</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">initialize</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$redis</span> = <span class="title class_">Redis</span>::<span class="title function_ invoke__">connection</span>();</span><br><span class="line">        <span class="variable">$maxNumber</span> = <span class="number">19999999999</span>; <span class="comment">// æœ€å¤§çš„æ‰‹æœºå·</span></span><br><span class="line">        <span class="variable">$current</span> = <span class="number">13000000000</span>; <span class="comment">// æœ€å¼€å§‹çš„æ‰‹æœºå·</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (<span class="variable">$current</span> &lt;= <span class="variable">$maxNumber</span>) &#123;</span><br><span class="line">            <span class="variable">$end</span> = <span class="title function_ invoke__">min</span>(<span class="variable">$current</span> + <span class="built_in">self</span>::<span class="variable constant_">CHUNK_SIZE</span> - <span class="number">1</span>, <span class="variable">$maxNumber</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// åŒæ—¶å†™å…¥æ•°æ®åº“å’ŒRedis</span></span><br><span class="line">            DB::<span class="title function_ invoke__">table</span>(<span class="string">&#x27;phone_tasks&#x27;</span>)-&gt;<span class="title function_ invoke__">insert</span>([</span><br><span class="line">                <span class="string">&#x27;start_number&#x27;</span> =&gt; <span class="variable">$current</span>,</span><br><span class="line">                <span class="string">&#x27;end_number&#x27;</span> =&gt; <span class="variable">$end</span>,</span><br><span class="line">                <span class="string">&#x27;status&#x27;</span> =&gt; <span class="number">0</span></span><br><span class="line">            ]);</span><br><span class="line"></span><br><span class="line">            <span class="variable">$redis</span>-&gt;<span class="title function_ invoke__">rpush</span>(<span class="string">&#x27;phone_tasks&#x27;</span>, <span class="string">&quot;<span class="subst">&#123;$current&#125;</span>:<span class="subst">&#123;$end&#125;</span>&quot;</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="variable">$current</span> = <span class="variable">$end</span> + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-åˆ†å¸ƒå¼ä»»åŠ¡å¤„ç†å™¨"><a href="#2-åˆ†å¸ƒå¼ä»»åŠ¡å¤„ç†å™¨" class="headerlink" title="2. åˆ†å¸ƒå¼ä»»åŠ¡å¤„ç†å™¨"></a>2. åˆ†å¸ƒå¼ä»»åŠ¡å¤„ç†å™¨</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app/Services/TaskProcessor.php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TaskProcessor</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">LOCK_TIMEOUT</span> = <span class="number">300</span>; <span class="comment">// 5åˆ†é’Ÿé”è¶…æ—¶</span></span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">BATCH_SIZE</span> = <span class="number">5000</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="variable">$task</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">fetchTask</span>();</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$task</span>) &#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">handleTask</span>(<span class="variable">$task</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="title function_ invoke__">usleep</span>(<span class="number">100000</span>); <span class="comment">// 100msé—´éš”</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">fetchTask</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$redis</span> = <span class="title class_">Redis</span>::<span class="title function_ invoke__">connection</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ä¼˜å…ˆå¤„ç†å¤±è´¥ä»»åŠ¡</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$failedTask</span> = <span class="variable">$redis</span>-&gt;<span class="title function_ invoke__">zrange</span>(<span class="string">&#x27;phone_failed_tasks&#x27;</span>, <span class="number">0</span>, <span class="number">0</span>)) &#123;</span><br><span class="line">            <span class="variable">$taskStr</span> = <span class="title function_ invoke__">array_shift</span>(<span class="variable">$failedTask</span>);</span><br><span class="line">            <span class="variable">$redis</span>-&gt;<span class="title function_ invoke__">zrem</span>(<span class="string">&#x27;phone_failed_tasks&#x27;</span>, <span class="variable">$taskStr</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;:&#x27;</span>, <span class="variable">$taskStr</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·å–æ–°ä»»åŠ¡</span></span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;:&#x27;</span>, <span class="variable">$redis</span>-&gt;<span class="title function_ invoke__">lpop</span>(<span class="string">&#x27;phone_tasks&#x27;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">handleTask</span>(<span class="params"><span class="variable">$task</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        [<span class="variable">$start</span>, <span class="variable">$end</span>] = <span class="variable">$task</span>;</span><br><span class="line">        <span class="variable">$lockKey</span> = <span class="string">&quot;phone_lock:<span class="subst">&#123;$start&#125;</span>-<span class="subst">&#123;$end&#125;</span>&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">acquireLock</span>(<span class="variable">$lockKey</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">updateTaskStatus</span>(<span class="variable">$start</span>, <span class="variable">$end</span>, <span class="number">1</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="variable">$current</span> = <span class="variable">$start</span>;</span><br><span class="line">            <span class="keyword">while</span> (<span class="variable">$current</span> &lt;= <span class="variable">$end</span>) &#123;</span><br><span class="line">                <span class="variable">$batch</span> = [];</span><br><span class="line">                <span class="variable">$batchEnd</span> = <span class="title function_ invoke__">min</span>(<span class="variable">$current</span> + <span class="built_in">self</span>::<span class="variable constant_">BATCH_SIZE</span> - <span class="number">1</span>, <span class="variable">$end</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// ç”Ÿæˆå†™å…¥çš„æ•°æ®åˆ—è¡¨</span></span><br><span class="line">                <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">generateBatch</span>(<span class="variable">$current</span>, <span class="variable">$batchEnd</span>, <span class="variable">$batch</span>);</span><br><span class="line">                <span class="comment">// æ‰¹é‡å†™å…¥</span></span><br><span class="line">                <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">bulkInsert</span>(<span class="variable">$batch</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="variable">$current</span> = <span class="variable">$batchEnd</span> + <span class="number">1</span>;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">updateProgress</span>(<span class="variable">$start</span>, <span class="variable">$end</span>, <span class="variable">$current</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">updateTaskStatus</span>(<span class="variable">$start</span>, <span class="variable">$end</span>, <span class="number">2</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (\<span class="built_in">Exception</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">handleFailure</span>(<span class="variable">$start</span>, <span class="variable">$end</span>, <span class="variable">$e</span>);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">releaseLock</span>(<span class="variable">$lockKey</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">acquireLock</span>(<span class="params"><span class="variable">$lockKey</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$redis</span> = <span class="title class_">Redis</span>::<span class="title function_ invoke__">connection</span>();</span><br><span class="line">        <span class="variable">$workerId</span> = <span class="title function_ invoke__">config</span>(<span class="string">&#x27;app.worker_id&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$redis</span>-&gt;<span class="title function_ invoke__">set</span>(</span><br><span class="line">            <span class="variable">$lockKey</span>, </span><br><span class="line">            <span class="string">&quot;<span class="subst">&#123;$workerId&#125;</span>:&quot;</span>.<span class="title function_ invoke__">time</span>(), </span><br><span class="line">            <span class="string">&#x27;EX&#x27;</span>, <span class="built_in">self</span>::<span class="variable constant_">LOCK_TIMEOUT</span>, </span><br><span class="line">            <span class="string">&#x27;NX&#x27;</span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">generateBatch</span>(<span class="params"><span class="variable">$start</span>, <span class="variable">$end</span>, &amp;<span class="variable">$batch</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$num</span> = <span class="variable">$start</span>; <span class="variable">$num</span> &lt;= <span class="variable">$end</span>; <span class="variable">$num</span>++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">isValidNumber</span>(<span class="variable">$num</span>) &amp;&amp; !<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">isNumberExists</span>(<span class="variable">$num</span>)) &#123;</span><br><span class="line">                <span class="variable">$batch</span>[] = [</span><br><span class="line">                    <span class="string">&#x27;phone_number&#x27;</span> =&gt; <span class="variable">$num</span>,</span><br><span class="line">                    <span class="string">&#x27;status&#x27;</span> =&gt; <span class="number">0</span>,</span><br><span class="line">                    <span class="string">&#x27;created_at&#x27;</span> =&gt; <span class="title function_ invoke__">now</span>(),</span><br><span class="line">                    <span class="string">&#x27;updated_at&#x27;</span> =&gt; <span class="title function_ invoke__">now</span>()</span><br><span class="line">                ];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">bulkInsert</span>(<span class="params"><span class="variable">$batch</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$batch</span>)) &#123;</span><br><span class="line">            DB::<span class="title function_ invoke__">table</span>(<span class="string">&#x27;phone_numbers&#x27;</span>)-&gt;<span class="title function_ invoke__">insertOrIgnore</span>(<span class="variable">$batch</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// æ›´æ–°Redisç¼“å­˜</span></span><br><span class="line">            <span class="title class_">Redis</span>::<span class="title function_ invoke__">pipeline</span>(function (<span class="variable">$pipe</span>) <span class="keyword">use</span> ($<span class="title">batch</span>) &#123;</span><br><span class="line">                <span class="title">foreach</span> ($<span class="title">batch</span> <span class="keyword">as</span> $<span class="title">item</span>) &#123;</span><br><span class="line">                    $<span class="title">pipe</span>-&gt;<span class="title">sadd</span>(&#x27;<span class="title">phone_exist_set</span>&#x27;, $<span class="title">item</span>[&#x27;<span class="title">phone_number</span>&#x27;]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// éªŒè¯è§„åˆ™</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">isValidNumber</span>(<span class="params"><span class="variable">$number</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$str</span> = <span class="title function_ invoke__">str_pad</span>(<span class="variable">$number</span>, <span class="number">11</span>, <span class="string">&#x27;0&#x27;</span>, STR_PAD_LEFT);</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^1[3-9]\d&#123;9&#125;$/&#x27;</span>, <span class="variable">$str</span>); <span class="comment">// å®é™…æ ¡éªŒè§„åˆ™</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">isNumberExists</span>(<span class="params"><span class="variable">$number</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// å…ˆæŸ¥Redisç¼“å­˜</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="title class_">Redis</span>::<span class="title function_ invoke__">sismember</span>(<span class="string">&#x27;phone_exist_set&#x27;</span>, <span class="variable">$number</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å†æŸ¥æ•°æ®åº“</span></span><br><span class="line">        <span class="variable">$exists</span> = DB::<span class="title function_ invoke__">table</span>(<span class="string">&#x27;phone_numbers&#x27;</span>)</span><br><span class="line">            -&gt;<span class="title function_ invoke__">where</span>(<span class="string">&#x27;phone_number&#x27;</span>, <span class="variable">$number</span>)</span><br><span class="line">            -&gt;<span class="title function_ invoke__">exists</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ›´æ–°ç¼“å­˜</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$exists</span>) &#123;</span><br><span class="line">            <span class="title class_">Redis</span>::<span class="title function_ invoke__">sadd</span>(<span class="string">&#x27;phone_exist_set&#x27;</span>, <span class="variable">$number</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$exists</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">handleFailure</span>(<span class="params"><span class="variable">$start</span>, <span class="variable">$end</span>, <span class="variable">$exception</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$redis</span> = <span class="title class_">Redis</span>::<span class="title function_ invoke__">connection</span>();</span><br><span class="line">        <span class="variable">$taskStr</span> = <span class="string">&quot;<span class="subst">&#123;$start&#125;</span>:<span class="subst">&#123;$end&#125;</span>&quot;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è®°å½•å¤±è´¥æ¬¡æ•°</span></span><br><span class="line">        <span class="variable">$retryCount</span> = <span class="variable">$redis</span>-&gt;<span class="title function_ invoke__">zscore</span>(<span class="string">&#x27;phone_failed_tasks&#x27;</span>, <span class="variable">$taskStr</span>) ?: <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$redis</span>-&gt;<span class="title function_ invoke__">zadd</span>(<span class="string">&#x27;phone_failed_tasks&#x27;</span>, <span class="variable">$retryCount</span> + <span class="number">1</span>, <span class="variable">$taskStr</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ›´æ–°æ•°æ®åº“çŠ¶æ€</span></span><br><span class="line">        DB::<span class="title function_ invoke__">table</span>(<span class="string">&#x27;phone_tasks&#x27;</span>)</span><br><span class="line">            -&gt;<span class="title function_ invoke__">where</span>(<span class="string">&#x27;start_number&#x27;</span>, <span class="variable">$start</span>)</span><br><span class="line">            -&gt;<span class="title function_ invoke__">where</span>(<span class="string">&#x27;end_number&#x27;</span>, <span class="variable">$end</span>)</span><br><span class="line">            -&gt;<span class="title function_ invoke__">update</span>([</span><br><span class="line">                <span class="string">&#x27;status&#x27;</span> =&gt; <span class="number">3</span>,</span><br><span class="line">                <span class="string">&#x27;error_message&#x27;</span> =&gt; <span class="title function_ invoke__">substr</span>(<span class="variable">$exception</span>-&gt;<span class="title function_ invoke__">getMessage</span>(), <span class="number">0</span>, <span class="number">255</span>)</span><br><span class="line">            ]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢è¯•æ€»ç»“</title>
      <link href="/posts/27a6e4df.html"/>
      <url>/posts/27a6e4df.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€mysql"><a href="#ä¸€ã€mysql" class="headerlink" title="ä¸€ã€mysql"></a>ä¸€ã€mysql</h1><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1.</span> è€ƒè™‘åˆ°ä¸šåŠ¡åç»­å‘å±•ï¼Œè®¾è®¡å¥½ç»“æ„ä»¥åŠåç»­æ•°æ®é‡å˜å¤§ååˆ†è¡¨</span><br><span class="line"><span class="bullet">2.</span> ç´¢å¼•éœ€è¦ç¬¦åˆæœ€å·¦åŸåˆ™</span><br><span class="line"><span class="bullet">3.</span> æŒ‰ç…§ä½¿ç”¨é¢‘ç‡é¡ºåºåˆ›å»ºç¬¦åˆç´¢å¼•</span><br></pre></td></tr></table></figure><h1 id="äºŒã€é«˜å¹¶å‘"><a href="#äºŒã€é«˜å¹¶å‘" class="headerlink" title="äºŒã€é«˜å¹¶å‘"></a>äºŒã€é«˜å¹¶å‘</h1><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è´Ÿè½½å‡è¡¡ï¼šä¾èµ–nginx ip_hashï¼Œæ ¹æ®<span class="built_in">ip</span>è®¿é—®ä¸åŒçš„æœåŠ¡å™¨ã€‚æˆ–è€…ä½¿ç”¨é˜¿é‡Œäº‘ç­‰å¹³å°è´Ÿè½½å‡è¡¡ + å¼¹æ€§ä¼¸ç¼©</span><br><span class="line"><span class="symbol">mysql</span>ï¼šä¸»ä»å¤åˆ¶ï¼Œæˆ–è€…ä½¿ç”¨é›†ç¾¤</span><br><span class="line"><span class="symbol">redis</span>ï¼šæ ¹æ®ä¸šåŠ¡æ‹†åˆ†redisï¼Œæˆ–è€…åç»­éœ€è¦çš„æƒ…å†µä¸‹ä½¿ç”¨ä¸»ä» + å“¨å…µï¼ˆæ•…éšœè½¬ç§»ï¼‰ï¼Œæˆ–è€…é›†ç¾¤å¤„ç†</span><br></pre></td></tr></table></figure><h1 id="é¡¹ç›®"><a href="#é¡¹ç›®" class="headerlink" title="é¡¹ç›®"></a>é¡¹ç›®</h1><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä»£ç éœ€è¦è€ƒè™‘åˆ°è§£è€¦</span><br></pre></td></tr></table></figure><h1 id="é¡¹ç›®ç»éªŒç®€è¿°"><a href="#é¡¹ç›®ç»éªŒç®€è¿°" class="headerlink" title="é¡¹ç›®ç»éªŒç®€è¿°"></a>é¡¹ç›®ç»éªŒç®€è¿°</h1><p>æ‰‹æœºå·ç³»ç»Ÿ</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">è°ƒåº¦è¡¨ï¼š phone<span class="emphasis">_tasks</span></span><br><span class="line"><span class="emphasis">å­—æ®µï¼šstart_number end_</span>number status</span><br><span class="line"></span><br><span class="line">æ‰‹æœºå·è¡¨: phone<span class="emphasis">_numbers</span></span><br><span class="line"><span class="emphasis">å­—æ®µï¼šphone_number status created_at updated_</span>at</span><br><span class="line"></span><br><span class="line">1. å…ˆå°†æœ€å°çš„æ‰‹æœºå·ï¼ˆ13000000000ï¼‰ï¼Œ åˆ°æœ€å¤§æ‰‹æœºå·ï¼ˆ19999999999ï¼‰ï¼Œå¾ªç¯å¤„ç†ï¼Œåˆ‡å‰²æˆå¤šä»½ï¼Œå†™å…¥start<span class="emphasis">_numberå’Œend_numberã€‚åŒæ—¶å°†ä»»åŠ¡å†™å…¥åˆ°redisä¸­</span></span><br><span class="line"><span class="emphasis">2. ä»»åŠ¡è°ƒåº¦ç±»ï¼Œå°†è°ƒåº¦è¡¨æŸ¥æ‰¾å‡ºæœªè¢«è°ƒç”¨çš„ä»»åŠ¡ã€‚</span></span><br><span class="line"><span class="emphasis">3. è°ƒç”¨redisé”ï¼Œé˜²æ­¢é‡å¤è°ƒç”¨ä»»åŠ¡ï¼Œæ ¹æ®start_numberå’Œend_</span>numberå¼€å§‹å¾ªç¯ï¼ŒåŒæ—¶å¯¹å¾ªç¯ä¸­çš„numè¿›è¡ŒéªŒè¯æ˜¯å¦ç¬¦åˆè§„åˆ™å¹¶ä¸”rediså’Œæ•°æ®åº“ä¸­éƒ½ä¸å­˜åœ¨è¿‡</span><br><span class="line">4. æ‰¹é‡å†™å…¥æ•°æ®åº“ä¸­</span><br><span class="line">5. é’ˆå¯¹æ‰§è¡Œé”™è¯¯çš„æ•°æ®å†™å…¥åˆ°redis listä¸­ï¼Œåç»­æ‰§è¡Œæ—¶ä¼˜å…ˆå¤„ç†æ­¤å—æ•°æ®</span><br></pre></td></tr></table></figure><p>çˆ¬è™«åˆ†å¸ƒå¼ç³»ç»Ÿ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> spider_scheduler.`ss_task` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `taskID` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;æ•°å­—IDï¼Œä¸»è¦ç”¨æ¥åŒºåˆ†çˆ¶å­ä»»åŠ¡,1-3ä½ä¸ºä¸€çº§ï¼Œ4-5ä½ä¸ºäºŒçº§ï¼Œ6-7ä½ä¸ºä¸‰çº§&#x27;</span>,</span><br><span class="line">  `taskNo` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;ä»»åŠ¡ç¼–å·-å¯ä»¥è¯†åˆ«çš„ç¼–å·:å¦‚maitianSell,danxiaSell&#x27;</span>,</span><br><span class="line">  `taskName` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;ä»»åŠ¡åç§°&#x27;</span>,</span><br><span class="line">  `taskType` enum(<span class="string">&#x27;cat&#x27;</span>,<span class="string">&#x27;cat1&#x27;</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å½’å±é¡¹ç›®&#x27;</span>,</span><br><span class="line">  `taskHeaders` text COMMENT <span class="string">&#x27;è¯¥ä»»åŠ¡çš„å¿…éœ€çš„headers&#x27;</span>,</span><br><span class="line">  `taskMethod` enum(<span class="string">&#x27;post&#x27;</span>,<span class="string">&#x27;get&#x27;</span>,<span class="string">&#x27;put&#x27;</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;è¯·æ±‚æ–¹å¼&#x27;</span>,</span><br><span class="line">  `taskReqDataTpye` enum(<span class="string">&#x27;form-data&#x27;</span>,<span class="string">&#x27;raw&#x27;</span>,<span class="string">&#x27;x-www-form-urlencoded&#x27;</span>,<span class="string">&#x27;binary&#x27;</span>,<span class="string">&#x27;json&#x27;</span>,<span class="string">&#x27;text/html&#x27;</span>) <span class="keyword">NOT NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;form-data&#x27;</span> COMMENT <span class="string">&#x27;è¯·æ±‚æ•°æ®ç±»å‹ text/htmlä¸ä½¿ç”¨jsonæ–¹å¼&#x27;</span>,</span><br><span class="line">  `taskRequestCount` tinyint(<span class="number">3</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;16&#x27;</span> COMMENT <span class="string">&#x27;å¹¶å‘é‡&#x27;</span>,</span><br><span class="line">  `taskDownloadDelay` <span class="type">float</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0.5&#x27;</span> COMMENT <span class="string">&#x27;é‡‡é›†å»¶è¿Ÿï¼Œæ¯æ¬¡å¹¶å‘å»¶è¿Ÿ&#x27;</span>,</span><br><span class="line">  `taskDownloadTimeout` <span class="type">int</span>(<span class="number">3</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;10&#x27;</span> COMMENT <span class="string">&#x27;è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼Œé’ˆå¯¹æœ‰äº›ç‰¹åˆ«å¡çš„ç½‘ç«™å¯ä»¥è®¾ç½®è¶…æ—¶æ—¶é—´é•¿ä¸€äº›&#x27;</span>,</span><br><span class="line">  `taskProxy` tinyint(<span class="number">1</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;0ä¸ºä¸å¼€å¯ä»£ç†ï¼Œ1ä¸ºå¼€å¯æ¯æ¬¡æ¢ipä»£ç ï¼Œ2ä¸º5åˆ†é’Ÿæ¢ä¸€æ¬¡ipä»£ç†&#x27;</span>,</span><br><span class="line">  `taskDb` <span class="type">varchar</span>(<span class="number">150</span>) <span class="keyword">NOT NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;é‡‡é›†åå†™å…¥çš„æ•°æ®åº“:ç¤ºä¾‹mysql://userName:userPW@ip:port/dbName&#x27;</span>,</span><br><span class="line">  `taskUrl` <span class="type">varchar</span>(<span class="number">500</span>) <span class="keyword">NOT NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;ç›®æ ‡URL,ä¸å¸¦å‚æ•°&#x27;</span>,</span><br><span class="line">  `taskStatus` tinyint(<span class="number">1</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;1&#x27;</span> COMMENT <span class="string">&#x27;ä»»åŠ¡çŠ¶æ€ï¼Œ1ä¸ºå¯åŠ¨ï¼Œ0ä¸ºç¦ç”¨&#x27;</span>,</span><br><span class="line">  `ver` tinyint(<span class="number">3</span>) <span class="keyword">NOT NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;101&#x27;</span> COMMENT <span class="string">&#x27;æ•°æ®ç‰ˆæœ¬&#x27;</span>,</span><br><span class="line">  `createTime` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `updateTime` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`,`taskNo`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `taskNo` (`taskNo`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">1</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 COMMENT<span class="operator">=</span><span class="string">&#x27;çˆ¬è™«ä»»åŠ¡ &#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `ss_task_url` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `SSID` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;å”¯ä¸€æ ‡è¯†ï¼šmd5(taskNo+urlParam)&#x27;</span>,</span><br><span class="line">  `taskNo` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;å…³è”ss_taskè¡¨ä¸­çš„taskNo&#x27;</span>,</span><br><span class="line">  `SSIDStr` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;é“¾æ¥æ ‡è¯†:å¦‚hid,uidç­‰&#x27;</span>,</span><br><span class="line">  `parentSSID` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;çˆ¶ID&#x27;</span>,</span><br><span class="line">  `topParentSSID` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;é¡¶çº§çˆ¶ç±»idã€‚ä¾‹å¦‚æ–°æˆ¿å›¾ç‰‡-&gt;å›¾ç‰‡è¯¦æƒ…-&gt;æ–°æˆ¿åŸºç¡€ä¿¡æ¯ï¼Œé¡¶çº§çˆ¶ç±»idå°±ç­‰äºæ–°æˆ¿åŸºç¡€ä¿¡æ¯çš„ssid&#x27;</span>,</span><br><span class="line">  `urlParam` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;urlå‚æ•°å€¼ï¼ŒæŒ‰é¡ºåºï¼Œâ€œ|â€éš”å¼€å¦‚:3501|fz&#x27;</span>,</span><br><span class="line">  `otherAct` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;ç”¨&quot;|&quot;éš”å¼€å„å‚æ•°ï¼Œå…¶ä»–è‡ªå®šä¹‰ä¼ å€¼å‚æ•°,å¦‚æœ‰äº›urlä¸­ä¸å¸¦åŸå¸‚ï¼Œä½†æ•°æ®åº“å­—æ®µä¸­éœ€è¦åŸå¸‚&#x27;</span>,</span><br><span class="line">  `isGet` tinyint(<span class="number">1</span>) <span class="keyword">NOT NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;æŠ“å–çŠ¶æ€,0ä¸ºæœªæŠ“,1ä¸ºå·²æŠ“å–æˆåŠŸ,2ä¸ºå¾…æ›´æ–°,3ä¸ºæ›´æ–°æˆåŠŸ,7ä¸ºæ ‡è¯†é“¾æ¥ä¸å­˜åœ¨ï¼ˆå¦‚æšä¸¾çš„é“¾æ¥ä¸å­˜åœ¨,æˆ–è€…å·²ä¸‹æ¶è¿‡æœŸï¼‰,8ä¸ºæŠ“å–å¤±è´¥,9ä¸ºæ›´æ–°å¤±è´¥&#x27;</span>,</span><br><span class="line">  `status` tinyint(<span class="number">1</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;2ä¸ºèµ„æºä¸‹è½½å®Œæˆæˆ–å­ä»»åŠ¡å·²å®Œæˆ,&#x27;</span>,</span><br><span class="line">  `createTime` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">  `updateTime` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`,`SSID`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `SSID` (`SSID`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `id` (`id`) <span class="keyword">USING</span> BTREE,</span><br><span class="line">  KEY `parentSSID` (`parentSSID`),</span><br><span class="line">  KEY `topParentSSID` (`topParentSSID`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">1</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> è°ƒç”¨start_requests(æ”¯æŒå¼‚æ­¥)ï¼Œ</span><br><span class="line"><span class="number">2.</span> è°ƒç”¨è°ƒåº¦æ•°æ®ä»»åŠ¡ç±»ï¼Œè·å–æœªè¢«æ‰§è¡Œçš„ä»»åŠ¡æˆ–ä¸åœ¨æ‰§è¡Œä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡æ•°æ®</span><br><span class="line"><span class="number">3.</span> è°ƒç”¨dataParseï¼Œæ ¹æ®ä¸åŒçš„ä»»åŠ¡ç±»å‹æ‰§è¡Œä¸åŒçš„ä»£ç ï¼Œå¹¶ä¸”è¿”å›æ•´åˆåçš„æ•°æ®</span><br><span class="line"><span class="number">4.</span> å¯¹æ•°æ®è¿›è¡Œç»Ÿä¸€æ¸…ç†ï¼Œå¹¶æ‰¹é‡å…¥åº“ï¼Œå¦‚æœå­˜åœ¨çˆ¶idï¼Œåˆ™åŒæ­¥ä¿®æ”¹çˆ¶ç±»ä¿¡æ¯</span><br><span class="line"><span class="number">5.</span> å¦‚æœæ˜¯å›¾ç‰‡åˆ™å»é™¤æ°´å°åï¼Œä¸Šä¼ åˆ°hadoopä¸­</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> é¢è¯•æ€»ç»“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¢è¯•æ€»ç»“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>luaä¼˜åŒ–redisåˆ†å¸ƒå¼é”</title>
      <link href="/posts/a73d9edf.html"/>
      <url>/posts/a73d9edf.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>Lua è„šæœ¬èƒ½å¤Ÿæå‡ Redis åˆ†å¸ƒå¼é”çš„æ€§èƒ½å’Œå¯é æ€§ï¼Œä¸»è¦åŸºäºä»¥ä¸‹æ ¸å¿ƒåŸç†ï¼š</p><h1 id="ä¸€ã€åŸå­æ€§ä¿è¯ï¼šæ›¿ä»£å¤šå‘½ä»¤åºåˆ—"><a href="#ä¸€ã€åŸå­æ€§ä¿è¯ï¼šæ›¿ä»£å¤šå‘½ä»¤åºåˆ—" class="headerlink" title="ä¸€ã€åŸå­æ€§ä¿è¯ï¼šæ›¿ä»£å¤šå‘½ä»¤åºåˆ—"></a>ä¸€ã€åŸå­æ€§ä¿è¯ï¼šæ›¿ä»£å¤šå‘½ä»¤åºåˆ—</h1><h2 id="1-1-åŸå­æ€§ä¿è¯ï¼šæ›¿ä»£å¤šå‘½ä»¤åºåˆ—"><a href="#1-1-åŸå­æ€§ä¿è¯ï¼šæ›¿ä»£å¤šå‘½ä»¤åºåˆ—" class="headerlink" title="1.1 åŸå­æ€§ä¿è¯ï¼šæ›¿ä»£å¤šå‘½ä»¤åºåˆ—"></a>1.1 åŸå­æ€§ä¿è¯ï¼šæ›¿ä»£å¤šå‘½ä»¤åºåˆ—</h2><p>ä¼ ç»Ÿåˆ†å¸ƒå¼é”å®ç°éœ€æ‰§è¡Œå¤šä¸ª Redis å‘½ä»¤ï¼ˆå¦‚ EXISTS â†’ HSET â†’ EXPIREï¼‰ï¼Œåœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹å¯èƒ½å› ç½‘ç»œå»¶è¿Ÿå¯¼è‡´åŸå­æ€§ç ´åã€‚ä¾‹å¦‚ï¼š</p><ol><li>å®¢æˆ·ç«¯ A æ£€æŸ¥é”å­˜åœ¨ï¼ˆEXISTS è¿”å› 0ï¼‰</li><li>å®¢æˆ·ç«¯ B æŠ¢å…ˆè·å–é”å¹¶è®¾ç½®</li><li>å®¢æˆ·ç«¯ A ç»§ç»­æ‰§è¡Œ HSETï¼Œè¦†ç›–å®¢æˆ·ç«¯ B çš„é”</li></ol><p>Redis æ‰§è¡Œ Lua è„šæœ¬æ—¶ä¼šå°†å…¶ä½œä¸ºåŸå­æ“ä½œï¼Œé¿å…ä¸­é—´çŠ¶æ€è¢«å…¶ä»–å®¢æˆ·ç«¯å¹²æ‰°ã€‚</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (redis.call(<span class="string">&#x27;EXISTS&#x27;</span>, KEYS[<span class="number">1</span>]) == <span class="number">0</span>) <span class="keyword">then</span></span><br><span class="line">    redis.call(<span class="string">&#x27;HSET&#x27;</span>, KEYS[<span class="number">1</span>], <span class="string">&#x27;client_id&#x27;</span>, ARGV[<span class="number">1</span>], <span class="string">&#x27;reentry&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">    redis.call(<span class="string">&#x27;EXPIRE&#x27;</span>, KEYS[<span class="number">1</span>], ARGV[<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><h1 id="äºŒã€å‡å°‘ç½‘ç»œå¼€é”€ï¼šå¤šå‘½ä»¤åˆå¹¶ä¸ºå•æ¬¡è°ƒç”¨"><a href="#äºŒã€å‡å°‘ç½‘ç»œå¼€é”€ï¼šå¤šå‘½ä»¤åˆå¹¶ä¸ºå•æ¬¡è°ƒç”¨" class="headerlink" title="äºŒã€å‡å°‘ç½‘ç»œå¼€é”€ï¼šå¤šå‘½ä»¤åˆå¹¶ä¸ºå•æ¬¡è°ƒç”¨"></a>äºŒã€å‡å°‘ç½‘ç»œå¼€é”€ï¼šå¤šå‘½ä»¤åˆå¹¶ä¸ºå•æ¬¡è°ƒç”¨</h1><p>ä¼ ç»Ÿå®ç°éœ€å¤šæ¬¡å®¢æˆ·ç«¯ä¸ Redis æœåŠ¡å™¨çš„å¾€è¿”é€šä¿¡ï¼ˆå¦‚è·å–é”éœ€ 3 æ¬¡ IOï¼‰ï¼Œè€Œ Lua è„šæœ¬å¯å°†å¤šä¸ªå‘½ä»¤å°è£…ä¸ºä¸€æ¬¡è°ƒç”¨ã€‚</p><h1 id="ä¸‰ã€å¯é æ€§å¢å¼ºï¼šåŸå­åŒ–é”é‡Šæ”¾"><a href="#ä¸‰ã€å¯é æ€§å¢å¼ºï¼šåŸå­åŒ–é”é‡Šæ”¾" class="headerlink" title="ä¸‰ã€å¯é æ€§å¢å¼ºï¼šåŸå­åŒ–é”é‡Šæ”¾"></a>ä¸‰ã€å¯é æ€§å¢å¼ºï¼šåŸå­åŒ–é”é‡Šæ”¾</h1><p>é‡Šæ”¾é”æ—¶éœ€éªŒè¯é”å½’å±å¹¶åˆ é™¤ï¼Œä¼ ç»Ÿå®ç°éœ€ä¸¤æ­¥æ“ä½œï¼š</p><ul><li>HGET æ£€æŸ¥é”æ˜¯å¦å±äºå½“å‰å®¢æˆ·ç«¯</li><li>DEL åˆ é™¤é”</li></ul><p>è‹¥å®¢æˆ·ç«¯åœ¨è¿™ä¸¤æ­¥ä¹‹é—´å‘ç”Ÿé˜»å¡ï¼ˆå¦‚ GCï¼‰ï¼Œé”å¯èƒ½è¿‡æœŸå¹¶è¢«å…¶ä»–å®¢æˆ·ç«¯è·å–ï¼Œå¯¼è‡´è¯¯åˆ ã€‚<br>Lua è„šæœ¬å¯å°†éªŒè¯å’Œåˆ é™¤åˆå¹¶ä¸ºåŸå­æ“ä½œï¼š</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> redis.call(<span class="string">&#x27;HGET&#x27;</span>, KEYS[<span class="number">1</span>], <span class="string">&#x27;client_id&#x27;</span>) == ARGV[<span class="number">1</span>] <span class="keyword">then</span></span><br><span class="line"><span class="keyword">return</span> redis.call(<span class="string">&#x27;DEL&#x27;</span>, KEYS[<span class="number">1</span>])</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>ç¡®ä¿åªæœ‰é”çš„æŒæœ‰è€…æ‰èƒ½é‡Šæ”¾é”ï¼Œé¿å…è¯¯åˆ ã€‚</p><h1 id="å››ã€å¯é‡å…¥é”çš„åŸå­å®ç°"><a href="#å››ã€å¯é‡å…¥é”çš„åŸå­å®ç°" class="headerlink" title="å››ã€å¯é‡å…¥é”çš„åŸå­å®ç°"></a>å››ã€å¯é‡å…¥é”çš„åŸå­å®ç°</h1><p>å®ç°å¯é‡å…¥é”æ—¶ï¼Œéœ€æ£€æŸ¥é”æ˜¯å¦å­˜åœ¨ã€æ˜¯å¦å±äºå½“å‰å®¢æˆ·ç«¯ã€å¢åŠ é‡å…¥è®¡æ•°å¹¶ç»­æœŸã€‚è¿™äº›æ“ä½œè‹¥åˆ†æ­¥æ‰§è¡Œï¼Œå¯èƒ½åœ¨ä¸­é—´çŠ¶æ€è¢«å…¶ä»–å®¢æˆ·ç«¯æ‰“æ–­ã€‚<br>Lua è„šæœ¬å¯åŸå­åŒ–å¤„ç†æ•´ä¸ªæµç¨‹ï¼š</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (redis.call(<span class="string">&#x27;EXISTS&#x27;</span>, KEYS[<span class="number">1</span>]) == <span class="number">0</span>) <span class="keyword">then</span></span><br><span class="line">    <span class="comment">-- é”ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°é”</span></span><br><span class="line">    redis.call(<span class="string">&#x27;HSET&#x27;</span>, KEYS[<span class="number">1</span>], <span class="string">&#x27;client_id&#x27;</span>, ARGV[<span class="number">1</span>], <span class="string">&#x27;reentry&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">    redis.call(<span class="string">&#x27;EXPIRE&#x27;</span>, KEYS[<span class="number">1</span>], ARGV[<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">elseif</span> (redis.call(<span class="string">&#x27;HGET&#x27;</span>, KEYS[<span class="number">1</span>], <span class="string">&#x27;client_id&#x27;</span>) == ARGV[<span class="number">1</span>]) <span class="keyword">then</span></span><br><span class="line">    <span class="comment">-- é”å·²å­˜åœ¨ä¸”å±äºå½“å‰å®¢æˆ·ç«¯ï¼Œå¢åŠ é‡å…¥è®¡æ•°</span></span><br><span class="line">    redis.call(<span class="string">&#x27;HINCRBY&#x27;</span>, KEYS[<span class="number">1</span>], <span class="string">&#x27;reentry&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">    redis.call(<span class="string">&#x27;EXPIRE&#x27;</span>, KEYS[<span class="number">1</span>], ARGV[<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="comment">-- é”è¢«å…¶ä»–å®¢æˆ·ç«¯æŒæœ‰</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡ Lua è„šæœ¬ï¼Œå¯é‡å…¥é”çš„è·å–é€»è¾‘åœ¨ä¸€ä¸ªåŸå­æ“ä½œä¸­å®Œæˆï¼Œé¿å…ç«æ€æ¡ä»¶ã€‚</p><h1 id="äº”ã€å†…å­˜ä¸æ€§èƒ½ä¼˜åŒ–"><a href="#äº”ã€å†…å­˜ä¸æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="äº”ã€å†…å­˜ä¸æ€§èƒ½ä¼˜åŒ–"></a>äº”ã€å†…å­˜ä¸æ€§èƒ½ä¼˜åŒ–</h1><p>Redis æ‰§è¡Œ Lua è„šæœ¬æ—¶ä¼šå°†å…¶ç¼“å­˜ï¼Œåç»­ç›¸åŒè„šæœ¬æ— éœ€é‡æ–°ç¼–è¯‘ï¼Œå‡å°‘ CPU å¼€é”€ã€‚æ­¤å¤–ï¼Œè„šæœ¬æ‰§è¡ŒæœŸé—´ä¸ä¼šæ‰§è¡Œå…¶ä»–å‘½ä»¤ï¼Œé¿å…é”æ“ä½œè¢«ä¸­æ–­ï¼Œæå‡ååé‡ã€‚</p><h1 id="å…­ã€é€‚ç”¨åœºæ™¯æ‰©å±•"><a href="#å…­ã€é€‚ç”¨åœºæ™¯æ‰©å±•" class="headerlink" title="å…­ã€é€‚ç”¨åœºæ™¯æ‰©å±•"></a>å…­ã€é€‚ç”¨åœºæ™¯æ‰©å±•</h1><p>Lua è„šæœ¬ä¸ä»…é€‚ç”¨äºåŸºç¡€é”æ“ä½œï¼Œè¿˜å¯å®ç°å¤æ‚é€»è¾‘ï¼š</p><ol><li>å¸¦é‡è¯•çš„é”è·å–ï¼šåœ¨è„šæœ¬å†…å®ç°æœ‰é™æ¬¡æ•°é‡è¯•ï¼Œå‡å°‘å®¢æˆ·ç«¯é€»è¾‘ã€‚</li><li>æ¡ä»¶é”é‡Šæ”¾ï¼šæ ¹æ®ä¸šåŠ¡çŠ¶æ€å†³å®šæ˜¯å¦é‡Šæ”¾é”ï¼Œå¦‚åº“å­˜æ‰£å‡æˆåŠŸåæ‰é‡Šæ”¾é”ã€‚</li><li>æ‰¹é‡é”æ“ä½œï¼šåŸå­åŒ–å¤„ç†å¤šä¸ªé”ï¼ˆå¦‚è·å–é” A å’Œé” Bï¼‰ï¼Œé¿å…æ­»é”ã€‚</li></ol><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>Lua è„šæœ¬é€šè¿‡åŸå­æ€§ä¿è¯ã€å‡å°‘ç½‘ç»œå¼€é”€ã€å¢å¼ºå¯é æ€§ä¸‰å¤§æ ¸å¿ƒä¼˜åŠ¿ï¼Œæ˜¾è‘—æå‡ Redis åˆ†å¸ƒå¼é”åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹çš„æ€§èƒ½å’Œç¨³å®šæ€§ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œåˆç†ä½¿ç”¨ Lua è„šæœ¬å¯å°†é”æ“ä½œçš„ QPS æå‡ 3-5 å€ï¼ŒåŒæ—¶é™ä½å› ç«æ€æ¡ä»¶å¯¼è‡´çš„ç³»ç»Ÿæ•…éšœç‡ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¢è¯• </tag>
            
            <tag> redis </tag>
            
            <tag> redisé¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpä¸­Redisåˆ†å¸ƒå¼é”ä¼˜åŒ–</title>
      <link href="/posts/32277a83.html"/>
      <url>/posts/32277a83.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€åŸºç¡€åŸç†ä¸é—®é¢˜åˆ†æ"><a href="#ä¸€ã€åŸºç¡€åŸç†ä¸é—®é¢˜åˆ†æ" class="headerlink" title="ä¸€ã€åŸºç¡€åŸç†ä¸é—®é¢˜åˆ†æ"></a>ä¸€ã€åŸºç¡€åŸç†ä¸é—®é¢˜åˆ†æ</h1><h2 id="1-Redisåˆ†å¸ƒå¼é”æ ¸å¿ƒé—®é¢˜"><a href="#1-Redisåˆ†å¸ƒå¼é”æ ¸å¿ƒé—®é¢˜" class="headerlink" title="1. Redisåˆ†å¸ƒå¼é”æ ¸å¿ƒé—®é¢˜"></a>1. Redisåˆ†å¸ƒå¼é”æ ¸å¿ƒé—®é¢˜</h2><p>åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼ŒPHPä½¿ç”¨Rediså®ç°åˆ†å¸ƒå¼é”ä¼šé‡åˆ°ä»¥ä¸‹å…¸å‹é—®é¢˜ï¼š</p><ol><li>é”ç«äº‰æ¿€çƒˆï¼šå¤§é‡è¯·æ±‚åŒæ—¶äº‰æŠ¢åŒä¸€ä¸ªé”</li><li>é”ç»­æœŸå›°éš¾ï¼šPHPæ— åå°çº¿ç¨‹éš¾ä»¥å®ç°è‡ªåŠ¨ç»­æœŸ</li><li>é”é‡Šæ”¾é£é™©ï¼šè„šæœ¬å¼‚å¸¸é€€å‡ºå¯¼è‡´æ­»é”</li><li>æ€§èƒ½ç“¶é¢ˆï¼šé¢‘ç¹çš„Redisé€šä¿¡æˆä¸ºç³»ç»Ÿç“¶é¢ˆ</li></ol><h2 id="2-å…³é”®æŒ‡æ ‡è¯„ä¼°"><a href="#2-å…³é”®æŒ‡æ ‡è¯„ä¼°" class="headerlink" title="2. å…³é”®æŒ‡æ ‡è¯„ä¼°"></a>2. å…³é”®æŒ‡æ ‡è¯„ä¼°</h2><table><thead><tr><th>æŒ‡æ ‡</th><th>é˜ˆå€¼</th><th>ç›‘æ§æ–¹æ³•</th></tr></thead><tbody><tr><td>é”ç­‰å¾…æ—¶é—´</td><td>&lt; 100ms</td><td>è®°å½•è·å–é”è€—æ—¶</td></tr><tr><td>é”æŒæœ‰æ—¶é—´</td><td>&lt; 500ms</td><td>è®°å½•ä¸šåŠ¡å¤„ç†æ—¶é—´</td></tr><tr><td>é”ç«äº‰å¤±è´¥ç‡</td><td>&lt; 5%</td><td>ç»Ÿè®¡å¤±è´¥è¯·æ±‚æ¯”ä¾‹</td></tr><tr><td>Redis QPS</td><td>&lt; 50,000</td><td>Redisç›‘æ§info commands</td></tr></tbody></table><h1 id="äºŒã€ä¼˜åŒ–æ–¹æ¡ˆ"><a href="#äºŒã€ä¼˜åŒ–æ–¹æ¡ˆ" class="headerlink" title="äºŒã€ä¼˜åŒ–æ–¹æ¡ˆ"></a>äºŒã€ä¼˜åŒ–æ–¹æ¡ˆ</h1><h2 id="1-luaä¼˜åŒ–redisåˆ†å¸ƒå¼é”"><a href="#1-luaä¼˜åŒ–redisåˆ†å¸ƒå¼é”" class="headerlink" title="1. luaä¼˜åŒ–redisåˆ†å¸ƒå¼é”"></a>1. luaä¼˜åŒ–redisåˆ†å¸ƒå¼é”</h2><p><a href="/posts/a73d9edf">luaä¼˜åŒ–redisåˆ†å¸ƒå¼é”</a> <a href="../../redis/%E6%93%8D%E4%BD%9C/lua%E4%BC%98%E5%8C%96redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81.md"></a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AdvancedRedisLock</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$redis</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$lockPrefix</span> = <span class="string">&#x27;lock:&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$tokenPrefix</span> = <span class="string">&#x27;token:&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">Redis <span class="variable">$redis</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;redis = <span class="variable">$redis</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–åˆ†å¸ƒå¼é”ï¼ˆå¸¦é‡è¯•æœºåˆ¶ï¼‰</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $key       é”é”®å</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $ttl          é”è¿‡æœŸæ—¶é—´(ms)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $timeout      è·å–è¶…æ—¶æ—¶é—´(ms)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $retryDelay   é‡è¯•é—´éš”(ms)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array|bool       [lock_token, lock_ttl] æˆ– false</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">acquire</span>(<span class="params"><span class="variable">$key</span>, <span class="variable">$ttl</span> = <span class="number">3000</span>, <span class="variable">$timeout</span> = <span class="number">5000</span>, <span class="variable">$retryDelay</span> = <span class="number">100</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$startTime</span> = <span class="title function_ invoke__">microtime</span>(<span class="literal">true</span>) * <span class="number">1000</span>;</span><br><span class="line">        <span class="variable">$lockKey</span> = <span class="variable language_">$this</span>-&gt;lockPrefix . <span class="variable">$key</span>;</span><br><span class="line">        <span class="variable">$token</span> = <span class="title function_ invoke__">uniqid</span>(<span class="string">&#x27;&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å½“å¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶ç«äº‰åŒä¸€æŠŠé”æ—¶ï¼Œåªæœ‰ä¸€ä¸ªå®¢æˆ·ç«¯èƒ½æˆåŠŸè·å–é”ï¼Œå…¶ä»–å®¢æˆ·ç«¯éœ€è¦é‡è¯•ã€‚</span></span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="comment">// ä½¿ç”¨Luaè„šæœ¬ä¿è¯åŸå­æ€§</span></span><br><span class="line">            <span class="variable">$lua</span> = <span class="string">&quot;</span></span><br><span class="line"><span class="string">                if redis.call(&#x27;SET&#x27;, KEYS[1], ARGV[1], &#x27;NX&#x27;, &#x27;PX&#x27;, ARGV[2]) then</span></span><br><span class="line"><span class="string">                    redis.call(&#x27;SET&#x27;, KEYS[2], 1, &#x27;PX&#x27;, ARGV[2])</span></span><br><span class="line"><span class="string">                    return &#123;ARGV[1], ARGV[2]&#125;</span></span><br><span class="line"><span class="string">                end</span></span><br><span class="line"><span class="string">                local token = redis.call(&#x27;GET&#x27;, KEYS[1])</span></span><br><span class="line"><span class="string">                if token == ARGV[1] then</span></span><br><span class="line"><span class="string">                    redis.call(&#x27;INCR&#x27;, KEYS[2])</span></span><br><span class="line"><span class="string">                    redis.call(&#x27;PEXPIRE&#x27;, KEYS[1], ARGV[2])</span></span><br><span class="line"><span class="string">                    redis.call(&#x27;PEXPIRE&#x27;, KEYS[2], ARGV[2])</span></span><br><span class="line"><span class="string">                    return &#123;token, redis.call(&#x27;PTTL&#x27;, KEYS[1])&#125;</span></span><br><span class="line"><span class="string">                end</span></span><br><span class="line"><span class="string">                return false</span></span><br><span class="line"><span class="string">            &quot;</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="variable">$result</span> = <span class="variable language_">$this</span>-&gt;redis-&gt;<span class="keyword">eval</span>(</span><br><span class="line">                <span class="variable">$lua</span>,</span><br><span class="line">                [<span class="variable">$lockKey</span>, <span class="variable language_">$this</span>-&gt;tokenPrefix.<span class="variable">$key</span>, <span class="variable">$token</span>, <span class="variable">$ttl</span>],</span><br><span class="line">                <span class="number">2</span> <span class="comment">// æ•°ç»„å‰2ä¸ªä¸ºkeysï¼Œå‰©ä½™çš„ä¸ºargv</span></span><br><span class="line">            );</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$result</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> [</span><br><span class="line">                    <span class="string">&#x27;token&#x27;</span> =&gt; <span class="variable">$result</span>[<span class="number">0</span>],</span><br><span class="line">                    <span class="string">&#x27;ttl&#x27;</span> =&gt; <span class="variable">$result</span>[<span class="number">1</span>]</span><br><span class="line">                ];</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$timeout</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="title function_ invoke__">usleep</span>(<span class="variable">$retryDelay</span> * <span class="number">1000</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">while</span> ((<span class="title function_ invoke__">microtime</span>(<span class="literal">true</span>) * <span class="number">1000</span> - <span class="variable">$startTime</span>) &lt; <span class="variable">$timeout</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é‡Šæ”¾åˆ†å¸ƒå¼é”</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">release</span>(<span class="params"><span class="variable">$key</span>, <span class="variable">$token</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$lua</span> = <span class="string">&quot;</span></span><br><span class="line"><span class="string">            if redis.call(&#x27;GET&#x27;, KEYS[1]) == ARGV[1] then</span></span><br><span class="line"><span class="string">                local counter = redis.call(&#x27;DECR&#x27;, KEYS[2])</span></span><br><span class="line"><span class="string">                if counter &lt;= 0 then</span></span><br><span class="line"><span class="string">                    redis.call(&#x27;DEL&#x27;, KEYS[2])</span></span><br><span class="line"><span class="string">                    return redis.call(&#x27;DEL&#x27;, KEYS[1])</span></span><br><span class="line"><span class="string">                end</span></span><br><span class="line"><span class="string">                return 1</span></span><br><span class="line"><span class="string">            end</span></span><br><span class="line"><span class="string">            return 0</span></span><br><span class="line"><span class="string">        &quot;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;redis-&gt;<span class="keyword">eval</span>(</span><br><span class="line">            <span class="variable">$lua</span>,</span><br><span class="line">            [<span class="variable language_">$this</span>-&gt;lockPrefix.<span class="variable">$key</span>, <span class="variable language_">$this</span>-&gt;tokenPrefix.<span class="variable">$key</span>, <span class="variable">$token</span>],</span><br><span class="line">            <span class="number">2</span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°è¯•ç»­æœŸ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">renew</span>(<span class="params"><span class="variable">$key</span>, <span class="variable">$token</span>, <span class="variable">$ttl</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$lua</span> = <span class="string">&quot;</span></span><br><span class="line"><span class="string">            if redis.call(&#x27;GET&#x27;, KEYS[1]) == ARGV[1] then</span></span><br><span class="line"><span class="string">                redis.call(&#x27;PEXPIRE&#x27;, KEYS[1], ARGV[2])</span></span><br><span class="line"><span class="string">                redis.call(&#x27;PEXPIRE&#x27;, KEYS[2], ARGV[2])</span></span><br><span class="line"><span class="string">                return 1</span></span><br><span class="line"><span class="string">            end</span></span><br><span class="line"><span class="string">            return 0</span></span><br><span class="line"><span class="string">        &quot;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;redis-&gt;<span class="keyword">eval</span>(</span><br><span class="line">            <span class="variable">$lua</span>,</span><br><span class="line">            [<span class="variable language_">$this</span>-&gt;lockPrefix.<span class="variable">$key</span>, <span class="variable language_">$this</span>-&gt;tokenPrefix.<span class="variable">$key</span>, <span class="variable">$token</span>, <span class="variable">$ttl</span>],</span><br><span class="line">            <span class="number">2</span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-åˆ†æ®µé”é«˜çº§å®ç°"><a href="#2-åˆ†æ®µé”é«˜çº§å®ç°" class="headerlink" title="2. åˆ†æ®µé”é«˜çº§å®ç°"></a>2. åˆ†æ®µé”é«˜çº§å®ç°</h2><p>å…ˆè¯»å–æœ¬åœ°é”ï¼Œå†åŠ å…¥luaä¼˜åŒ–åçš„åˆ†å¸ƒå¼é”</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SegmentLockManager</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$redis</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$segments</span> = <span class="number">32</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$localLocks</span> = [];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">Redis <span class="variable">$redis</span>, <span class="variable">$segments</span> = <span class="number">32</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;redis = <span class="variable">$redis</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;segments = <span class="variable">$segments</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getSegment</span>(<span class="params"><span class="variable">$resourceId</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">crc32</span>(<span class="variable">$resourceId</span>) % <span class="variable language_">$this</span>-&gt;segments;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">lock</span>(<span class="params"><span class="variable">$resourceId</span>, <span class="variable">$ttl</span> = <span class="number">3000</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$segment</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getSegment</span>(<span class="variable">$resourceId</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å…ˆå°è¯•æœ¬åœ°å¿«é€Ÿé”</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;localLocks[<span class="variable">$segment</span>])) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;localLocks[<span class="variable">$segment</span>][<span class="string">&#x27;count&#x27;</span>]++;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è·å–åˆ†å¸ƒå¼é”</span></span><br><span class="line">        <span class="variable">$lockKey</span> = <span class="string">&quot;segment:lock:<span class="subst">&#123;$segment&#125;</span>&quot;</span>;</span><br><span class="line">        <span class="variable">$token</span> = <span class="title function_ invoke__">uniqid</span>(<span class="string">&#x27;&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="variable">$lua</span> = <span class="string">&quot;</span></span><br><span class="line"><span class="string">            if redis.call(&#x27;SET&#x27;, KEYS[1], ARGV[1], &#x27;NX&#x27;, &#x27;PX&#x27;, ARGV[2]) then</span></span><br><span class="line"><span class="string">                return 1</span></span><br><span class="line"><span class="string">            end</span></span><br><span class="line"><span class="string">            return 0</span></span><br><span class="line"><span class="string">        &quot;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="variable">$locked</span> = <span class="variable language_">$this</span>-&gt;redis-&gt;<span class="keyword">eval</span>(<span class="variable">$lua</span>, [<span class="variable">$lockKey</span>, <span class="variable">$token</span>, <span class="variable">$ttl</span>], <span class="number">1</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$locked</span>) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;localLocks[<span class="variable">$segment</span>] = [</span><br><span class="line">                <span class="string">&#x27;token&#x27;</span> =&gt; <span class="variable">$token</span>,</span><br><span class="line">                <span class="string">&#x27;count&#x27;</span> =&gt; <span class="number">1</span>,</span><br><span class="line">                <span class="string">&#x27;expire&#x27;</span> =&gt; <span class="title function_ invoke__">microtime</span>(<span class="literal">true</span>) + (<span class="variable">$ttl</span> / <span class="number">1000</span>)</span><br><span class="line">            ];</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">unlock</span>(<span class="params"><span class="variable">$resourceId</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$segment</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getSegment</span>(<span class="variable">$resourceId</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;localLocks[<span class="variable">$segment</span>])) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;localLocks[<span class="variable">$segment</span>][<span class="string">&#x27;count&#x27;</span>]--;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;localLocks[<span class="variable">$segment</span>][<span class="string">&#x27;count&#x27;</span>] &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="variable">$lockKey</span> = <span class="string">&quot;segment:lock:<span class="subst">&#123;$segment&#125;</span>&quot;</span>;</span><br><span class="line">            <span class="variable">$token</span> = <span class="variable language_">$this</span>-&gt;localLocks[<span class="variable">$segment</span>][<span class="string">&#x27;token&#x27;</span>];</span><br><span class="line">            </span><br><span class="line">            <span class="variable">$lua</span> = <span class="string">&quot;</span></span><br><span class="line"><span class="string">                if redis.call(&#x27;GET&#x27;, KEYS[1]) == ARGV[1] then</span></span><br><span class="line"><span class="string">                    return redis.call(&#x27;DEL&#x27;, KEYS[1])</span></span><br><span class="line"><span class="string">                end</span></span><br><span class="line"><span class="string">                return 0</span></span><br><span class="line"><span class="string">            &quot;</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="variable language_">$this</span>-&gt;redis-&gt;<span class="keyword">eval</span>(<span class="variable">$lua</span>, [<span class="variable">$lockKey</span>, <span class="variable">$token</span>], <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">unset</span>(<span class="variable language_">$this</span>-&gt;localLocks[<span class="variable">$segment</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-ä½¿ç”¨Socketé€šä¿¡"><a href="#3-ä½¿ç”¨Socketé€šä¿¡" class="headerlink" title="3. ä½¿ç”¨Socketé€šä¿¡"></a>3. ä½¿ç”¨Socketé€šä¿¡</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ›´é«˜æ•ˆçš„Socketé€šä¿¡æ–¹å¼</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">redissonLock</span>(<span class="params"><span class="variable">$command</span>, <span class="variable">$lockName</span>, <span class="variable">$ttl</span> = <span class="literal">null</span></span>) </span>&#123;</span><br><span class="line"><span class="variable">$socket</span> = <span class="title function_ invoke__">fsockopen</span>(<span class="string">&#x27;redisson-service&#x27;</span>, <span class="number">12345</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$socket</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$data</span> = [</span><br><span class="line">        <span class="string">&#x27;command&#x27;</span> =&gt; <span class="variable">$command</span>,</span><br><span class="line">        <span class="string">&#x27;lockName&#x27;</span> =&gt; <span class="variable">$lockName</span>,</span><br><span class="line">        <span class="string">&#x27;ttl&#x27;</span> =&gt; <span class="variable">$ttl</span></span><br><span class="line">    ];</span><br><span class="line">    </span><br><span class="line">    <span class="title function_ invoke__">fwrite</span>(<span class="variable">$socket</span>, <span class="title function_ invoke__">json_encode</span>(<span class="variable">$data</span>).<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="variable">$response</span> = <span class="title function_ invoke__">fgets</span>(<span class="variable">$socket</span>);</span><br><span class="line">    <span class="title function_ invoke__">fclose</span>(<span class="variable">$socket</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">json_decode</span>(<span class="variable">$response</span>)-&gt;success;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€æ›¿ä»£æ–¹æ¡ˆé›†æˆ"><a href="#ä¸‰ã€æ›¿ä»£æ–¹æ¡ˆé›†æˆ" class="headerlink" title="ä¸‰ã€æ›¿ä»£æ–¹æ¡ˆé›†æˆ"></a>ä¸‰ã€æ›¿ä»£æ–¹æ¡ˆé›†æˆ</h1><h2 id="1-ä¸ZooKeeperé›†æˆ"><a href="#1-ä¸ZooKeeperé›†æˆ" class="headerlink" title="1. ä¸ZooKeeperé›†æˆ"></a>1. ä¸ZooKeeperé›†æˆ</h2><p>ZooKeeper ä¿æŒåŸå­æ€§çš„åŸç†ä¸»è¦é€šè¿‡åŸå­å¹¿æ’­åè®®ï¼ˆAtomic Broadcast Protocolï¼‰å’Œäº‹åŠ¡æ—¥å¿—ï¼ˆTransaction Logï¼‰æ¥å®ç°ã€‚</p><ul><li>ZAB ä¿è¯åŸå­æ€§</li><li>äº‹åŠ¡æ—¥å¿—æ˜¯ä¸€ä¸ªé¡ºåºæ–‡ä»¶ï¼Œæ‰€æœ‰èŠ‚ç‚¹åšçš„ä»»åŠ¡éƒ½æ˜¯ä¸€æ ·çš„ï¼Œè€Œä¸”æ˜¯æŒ‰åŒæ ·çš„é¡ºåºåšï¼Œä¿è¯äº†æ•°æ®çš„ä¸€è‡´æ€§</li></ul><ol><li><p>åŸå­å¹¿æ’­åè®®</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">æ¦‚è¿°ï¼š</span><br><span class="line">ZooKeeper ä½¿ç”¨ Zabï¼ˆZooKeeper Atomic <span class="keyword">Broadcastï¼‰åè®®æ¥ä¿è¯åˆ†å¸ƒå¼ç¯å¢ƒä¸‹æ•°æ®çš„åŸå­æ€§ã€‚</span></span><br><span class="line"><span class="keyword"></span>åœ¨ Zab åè®®ä¸­ï¼Œæ‰€æœ‰çš„å†™æ“ä½œéƒ½éœ€è¦ç»è¿‡ä¸€ä¸ªé¢†å¯¼è€…ï¼ˆLeaderï¼‰èŠ‚ç‚¹æ¥åè°ƒå’Œå¹¿æ’­ã€‚</span><br><span class="line"></span><br><span class="line">å·¥ä½œåŸç†ï¼š</span><br><span class="line">å½“ä¸€ä¸ªå®¢æˆ·ç«¯å‘èµ·ä¸€ä¸ªå†™è¯·æ±‚æ—¶ï¼Œè¯¥è¯·æ±‚ä¼šè¢«å‘é€åˆ° ZooKeeper é›†ç¾¤ä¸­çš„æŸä¸ªèŠ‚ç‚¹ã€‚</span><br><span class="line">å¦‚æœè¿™ä¸ªèŠ‚ç‚¹æ˜¯é¢†å¯¼è€…ï¼Œå®ƒä¼šå°†è¿™ä¸ªå†™æ“ä½œå°è£…æˆä¸€ä¸ªäº‹åŠ¡ï¼Œå¹¶å‘æ‰€æœ‰çš„è¿½éšè€…ï¼ˆFollowerï¼‰èŠ‚ç‚¹å¹¿æ’­è¿™ä¸ªäº‹åŠ¡ã€‚</span><br><span class="line">è¿½éšè€…èŠ‚ç‚¹æ”¶åˆ°äº‹åŠ¡åï¼Œä¼šå…ˆå°†å…¶å†™å…¥æœ¬åœ°çš„äº‹åŠ¡æ—¥å¿—ï¼Œç„¶åå‘é¢†å¯¼è€…å‘é€ä¸€ä¸ªç¡®è®¤æ¶ˆæ¯ã€‚</span><br><span class="line">å½“é¢†å¯¼è€…æ”¶åˆ°å¤§å¤šæ•°è¿½éšè€…èŠ‚ç‚¹çš„ç¡®è®¤æ¶ˆæ¯åï¼Œå®ƒä¼šå‘æ‰€æœ‰çš„è¿½éšè€…èŠ‚ç‚¹å‘é€ä¸€ä¸ªæäº¤æ¶ˆæ¯ï¼Œé€šçŸ¥å®ƒä»¬å¯ä»¥å°†è¿™ä¸ªäº‹åŠ¡åº”ç”¨åˆ°æœ¬åœ°çš„å†…å­˜æ•°æ®åº“ä¸­ã€‚</span><br><span class="line">è¿™æ ·ï¼Œæ‰€æœ‰çš„èŠ‚ç‚¹éƒ½ä¼šä»¥ç›¸åŒçš„é¡ºåºæ‰§è¡Œç›¸åŒçš„äº‹åŠ¡ï¼Œä»è€Œä¿è¯äº†æ•°æ®çš„åŸå­æ€§ã€‚</span><br></pre></td></tr></table></figure></li><li><p>äº‹åŠ¡æ—¥å¿—</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">æ¦‚è¿°ï¼š</span><br><span class="line">ZooKeeper ä½¿ç”¨äº‹åŠ¡æ—¥å¿—æ¥è®°å½•æ‰€æœ‰çš„å†™æ“ä½œã€‚äº‹åŠ¡æ—¥å¿—æ˜¯ä¸€ä¸ªé¡ºåºæ–‡ä»¶ï¼Œæ¯ä¸ªäº‹åŠ¡åœ¨æ—¥å¿—ä¸­éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ç¼–å·ï¼ˆZxidï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">å·¥ä½œåŸç†ï¼š</span><br><span class="line">å½“ä¸€ä¸ªäº‹åŠ¡è¢«æäº¤æ—¶ï¼Œå®ƒä¼šè¢«å†™å…¥åˆ°äº‹åŠ¡æ—¥å¿—ä¸­ã€‚</span><br><span class="line">åœ¨ ZooKeeper èŠ‚ç‚¹å¯åŠ¨æ—¶ï¼Œå®ƒä¼šä»äº‹åŠ¡æ—¥å¿—ä¸­è¯»å–æ‰€æœ‰çš„äº‹åŠ¡ï¼Œå¹¶æŒ‰ç…§ Zxid çš„é¡ºåºå°†å®ƒä»¬åº”ç”¨åˆ°æœ¬åœ°çš„å†…å­˜æ•°æ®åº“ä¸­ã€‚</span><br><span class="line">è¿™æ ·å¯ä»¥ä¿è¯åœ¨èŠ‚ç‚¹é‡å¯åï¼Œèƒ½å¤Ÿæ¢å¤åˆ°æœ€åä¸€æ¬¡æˆåŠŸæäº¤çš„çŠ¶æ€ï¼Œä»è€Œä¿è¯äº†æ•°æ®çš„åŸå­æ€§ã€‚</span><br><span class="line">åŒæ—¶ï¼Œäº‹åŠ¡æ—¥å¿—ä¹Ÿå¯ä»¥ç”¨äºåœ¨é›†ç¾¤ä¸­è¿›è¡Œæ•°æ®åŒæ­¥ï¼Œå½“ä¸€ä¸ªæ–°çš„èŠ‚ç‚¹åŠ å…¥é›†ç¾¤æ—¶ï¼Œå®ƒå¯ä»¥é€šè¿‡è¯»å–å…¶ä»–èŠ‚ç‚¹çš„äº‹åŠ¡æ—¥å¿—æ¥å¿«é€ŸåŒæ­¥æ•°æ®ã€‚</span><br></pre></td></tr></table></figure></li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ZookeeperLock</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="variable">$zk</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="variable">$path</span> = <span class="string">&#x27;/locks/&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$host</span> = <span class="string">&#x27;localhost:2181&#x27;</span>, <span class="variable">$timeout</span> = <span class="number">10000</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;zk = <span class="keyword">new</span> <span class="title class_">Zookeeper</span>(<span class="variable">$host</span>, <span class="literal">null</span>, <span class="variable">$timeout</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">lock</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$timeout</span> = <span class="number">5000</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$lockPath</span> = <span class="variable language_">$this</span>-&gt;path . <span class="variable">$name</span>;</span><br><span class="line">        <span class="variable">$startTime</span> = <span class="title function_ invoke__">microtime</span>(<span class="literal">true</span>) * <span class="number">1000</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸´æ—¶èŠ‚ç‚¹</span></span><br><span class="line">        <span class="variable">$realPath</span> = <span class="variable language_">$this</span>-&gt;zk-&gt;<span class="title function_ invoke__">create</span>(</span><br><span class="line">            <span class="variable">$lockPath</span>,</span><br><span class="line">            <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">            [[<span class="string">&#x27;perms&#x27;</span> =&gt; <span class="title class_">Zookeeper</span>::<span class="variable constant_">PERM_ALL</span>, <span class="string">&#x27;scheme&#x27;</span> =&gt; <span class="string">&#x27;world&#x27;</span>, <span class="string">&#x27;id&#x27;</span> =&gt; <span class="string">&#x27;anyone&#x27;</span>]],</span><br><span class="line">            <span class="title class_">Zookeeper</span>::<span class="variable constant_">EPHEMERAL</span></span><br><span class="line">        );</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$realPath</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ç­‰å¾…é”é‡Šæ”¾</span></span><br><span class="line">        <span class="keyword">while</span> ((<span class="title function_ invoke__">microtime</span>(<span class="literal">true</span>) * <span class="number">1000</span> - <span class="variable">$startTime</span>) &lt; <span class="variable">$timeout</span>) &#123;</span><br><span class="line">            <span class="variable">$children</span> = <span class="variable language_">$this</span>-&gt;zk-&gt;<span class="title function_ invoke__">getChildren</span>(<span class="variable">$this</span>-&gt;path);</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$children</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">lock</span>(<span class="variable">$name</span>, <span class="number">0</span>); <span class="comment">// é‡è¯•è·å–</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="title function_ invoke__">usleep</span>(<span class="number">100000</span>); <span class="comment">// 100ms</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">unlock</span>(<span class="params"><span class="variable">$name</span></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// ZooKeeperä¸´æ—¶èŠ‚ç‚¹ä¼šè‡ªåŠ¨é‡Šæ”¾</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-å¤šçº§ç¼“å­˜é”æ–¹æ¡ˆ"><a href="#2-å¤šçº§ç¼“å­˜é”æ–¹æ¡ˆ" class="headerlink" title="2. å¤šçº§ç¼“å­˜é”æ–¹æ¡ˆ"></a>2. å¤šçº§ç¼“å­˜é”æ–¹æ¡ˆ</h2><p>åœ¨åˆ†æ®µå¼é”åŸºç¡€ä¸Šï¼Œå¢åŠ APCuå…±äº«å†…å­˜é”</p><ol><li>APCuç‰¹ç‚¹</li></ol><ul><li>é”®å€¼å¯¹ç¼“å­˜<ul><li>å­˜å‚¨ä»»æ„ PHP å˜é‡ï¼ˆå¦‚æ•°ç»„ã€å¯¹è±¡ã€å­—ç¬¦ä¸²ï¼‰åˆ°å…±äº«å†…å­˜ï¼Œé€šè¿‡é”®å¿«é€Ÿè®¿é—®ã€‚</li></ul></li><li>è¿›ç¨‹é—´å…±äº«<ul><li>æ‰€æœ‰ PHP-FPM è¿›ç¨‹æˆ– CLI è„šæœ¬å‡å¯è®¿é—®åŒä¸€ä»½ç¼“å­˜æ•°æ®ï¼Œæ— éœ€é‡å¤è®¡ç®—ã€‚</li></ul></li><li>è‡ªåŠ¨è¿‡æœŸæœºåˆ¶<ul><li>æ”¯æŒè®¾ç½®ç¼“å­˜é¡¹çš„ TTLï¼ˆTime-To-Liveï¼‰ï¼Œåˆ°æœŸè‡ªåŠ¨åˆ é™¤ï¼Œå‡å°‘å†…å­˜å ç”¨ã€‚</li></ul></li><li>åŸå­æ“ä½œ<ul><li>æä¾› add()ã€cas()ï¼ˆCompare And Swapï¼‰ç­‰åŸå­æ“ä½œï¼Œé¿å…ç«æ€æ¡ä»¶ã€‚</li></ul></li></ul><ol start="2"><li>ä¼˜ç¼ºç‚¹</li></ol><ul><li>ä¼˜ç‚¹ï¼šé€Ÿåº¦æå¿«ï¼ŒAPI ç®€å•</li><li>ç¼ºç‚¹ï¼šä»…å•æœºæœ‰æ•ˆ</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MultiLevelLock</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="variable">$localLocks</span> = [];</span><br><span class="line"><span class="keyword">private</span> <span class="variable">$redisLock</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="variable">$segmentCount</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">Redis <span class="variable">$redis</span>, <span class="variable">$segmentCount</span> = <span class="number">64</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;redisLock = <span class="keyword">new</span> <span class="title class_">AdvancedRedisLock</span>(<span class="variable">$redis</span>);</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;segmentCount = <span class="variable">$segmentCount</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">lock</span>(<span class="params"><span class="variable">$resourceId</span>, <span class="variable">$ttl</span> = <span class="number">3000</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$segment</span> = <span class="title function_ invoke__">crc32</span>(<span class="variable">$resourceId</span>) % <span class="variable language_">$this</span>-&gt;segmentCount;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ç¬¬ä¸€å±‚ï¼šè¿›ç¨‹å†…é”</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;localLocks[<span class="variable">$segment</span>])) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;localLocks[<span class="variable">$segment</span>][<span class="string">&#x27;count&#x27;</span>]++;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ç¬¬äºŒå±‚ï¼šå…±äº«å†…å­˜é”ï¼ˆAPCuï¼‰</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">function_exists</span>(<span class="string">&#x27;apcu_add&#x27;</span>)) &#123;</span><br><span class="line">            <span class="variable">$lockKey</span> = <span class="string">&quot;shm_lock:<span class="subst">&#123;$segment&#125;</span>&quot;</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">apcu_add</span>(<span class="variable">$lockKey</span>, <span class="number">1</span>, <span class="variable">$ttl</span> / <span class="number">1000</span>)) &#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;localLocks[<span class="variable">$segment</span>] = [</span><br><span class="line">                    <span class="string">&#x27;count&#x27;</span> =&gt; <span class="number">1</span>,</span><br><span class="line">                    <span class="string">&#x27;shm&#x27;</span> =&gt; <span class="literal">true</span></span><br><span class="line">                ];</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ç¬¬ä¸‰å±‚ï¼šRedisåˆ†å¸ƒå¼é”</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;redisLock-&gt;<span class="title function_ invoke__">acquire</span>(<span class="string">&quot;global:<span class="subst">&#123;$segment&#125;</span>&quot;</span>, <span class="variable">$ttl</span>)) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;localLocks[<span class="variable">$segment</span>] = [</span><br><span class="line">                <span class="string">&#x27;count&#x27;</span> =&gt; <span class="number">1</span>,</span><br><span class="line">                <span class="string">&#x27;redis&#x27;</span> =&gt; <span class="literal">true</span></span><br><span class="line">            ];</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">unlock</span>(<span class="params"><span class="variable">$resourceId</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$segment</span> = <span class="title function_ invoke__">crc32</span>(<span class="variable">$resourceId</span>) % <span class="variable language_">$this</span>-&gt;segmentCount;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;localLocks[<span class="variable">$segment</span>])) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;localLocks[<span class="variable">$segment</span>][<span class="string">&#x27;count&#x27;</span>]--;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;localLocks[<span class="variable">$segment</span>][<span class="string">&#x27;count&#x27;</span>] &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable language_">$this</span>-&gt;localLocks[<span class="variable">$segment</span>][<span class="string">&#x27;shm&#x27;</span>])) &#123;</span><br><span class="line">                <span class="title function_ invoke__">apcu_delete</span>(<span class="string">&quot;shm_lock:<span class="subst">&#123;$segment&#125;</span>&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">elseif</span> (!<span class="keyword">empty</span>(<span class="variable language_">$this</span>-&gt;localLocks[<span class="variable">$segment</span>][<span class="string">&#x27;redis&#x27;</span>])) &#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;redisLock-&gt;<span class="title function_ invoke__">release</span>(<span class="string">&quot;global:<span class="subst">&#123;$segment&#125;</span>&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">unset</span>(<span class="variable language_">$this</span>-&gt;localLocks[<span class="variable">$segment</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å››ã€ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ"><a href="#å››ã€ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ" class="headerlink" title="å››ã€ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ"></a>å››ã€ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ</h1><h2 id="1-é”ç›‘æ§ç³»ç»Ÿå®ç°"><a href="#1-é”ç›‘æ§ç³»ç»Ÿå®ç°" class="headerlink" title="1. é”ç›‘æ§ç³»ç»Ÿå®ç°"></a>1. é”ç›‘æ§ç³»ç»Ÿå®ç°</h2><p>ç›‘æ§é”è¶…å‡ºæŒ‡å®šæ—¶é•¿çš„ï¼Œè¿›è¡Œå‘Šè­¦</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LockMonitor</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="variable">$redis</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="variable">$channel</span> = <span class="string">&#x27;lock_monitor&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">Redis <span class="variable">$redis</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;redis = <span class="variable">$redis</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">startMonitoring</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// ç›‘æ§é”è¿‡æœŸæƒ…å†µ</span></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;redis-&gt;<span class="title function_ invoke__">psubscribe</span>([<span class="string">&#x27;__keyevent@0__:expired&#x27;</span>], function(<span class="variable">$redis</span>, <span class="variable">$pattern</span>, <span class="variable">$channel</span>, <span class="variable">$key</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$key</span>, <span class="string">&#x27;lock:&#x27;</span>) === <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">alert</span>(<span class="string">&quot;Lock expired: <span class="subst">&#123;$key&#125;</span>&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ç›‘æ§æ­»é”</span></span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="variable">$longHeldLocks</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">checkLongHeldLocks</span>();</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="variable">$longHeldLocks</span> <span class="keyword">as</span> <span class="variable">$lock</span>) &#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">alert</span>(<span class="string">&quot;Long held lock: <span class="subst">&#123;$lock[&#x27;key&#x27;]&#125;</span> held for <span class="subst">&#123;$lock[&#x27;duration&#x27;]&#125;</span>ms&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="title function_ invoke__">sleep</span>(<span class="number">10</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">checkLongHeldLocks</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$keys</span> = <span class="variable language_">$this</span>-&gt;redis-&gt;<span class="title function_ invoke__">keys</span>(<span class="string">&#x27;lock:*&#x27;</span>);</span><br><span class="line">        <span class="variable">$result</span> = [];</span><br><span class="line">        <span class="variable">$now</span> = <span class="title function_ invoke__">microtime</span>(<span class="literal">true</span>) * <span class="number">1000</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$keys</span> <span class="keyword">as</span> <span class="variable">$key</span>) &#123;</span><br><span class="line">            <span class="variable">$ttl</span> = <span class="variable language_">$this</span>-&gt;redis-&gt;<span class="title function_ invoke__">pttl</span>(<span class="variable">$key</span>);</span><br><span class="line">            <span class="variable">$createdAt</span> = <span class="variable">$now</span> - (<span class="variable language_">$this</span>-&gt;redis-&gt;<span class="keyword">object</span>(<span class="string">&#x27;IDLETIME&#x27;</span>, <span class="variable">$key</span>) * <span class="number">1000</span>);</span><br><span class="line">            <span class="variable">$duration</span> = <span class="variable">$now</span> - <span class="variable">$createdAt</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$duration</span> &gt; <span class="number">5000</span>) &#123; <span class="comment">// è¶…è¿‡5ç§’è§†ä¸ºé•¿æŒæœ‰</span></span><br><span class="line">                <span class="variable">$result</span>[] = [</span><br><span class="line">                    <span class="string">&#x27;key&#x27;</span> =&gt; <span class="variable">$key</span>,</span><br><span class="line">                    <span class="string">&#x27;duration&#x27;</span> =&gt; <span class="variable">$duration</span></span><br><span class="line">                ];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$result</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">alert</span>(<span class="params"><span class="variable">$message</span></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// å®ç°æŠ¥è­¦é€»è¾‘</span></span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;/var/log/lock_monitor.log&#x27;</span>, <span class="title function_ invoke__">date</span>(<span class="string">&#x27;[Y-m-d H:i:s]&#x27;</span>) . <span class="variable">$message</span> . PHP_EOL, FILE_APPEND);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-æ€§èƒ½ä¼˜åŒ–é…ç½®"><a href="#2-æ€§èƒ½ä¼˜åŒ–é…ç½®" class="headerlink" title="2. æ€§èƒ½ä¼˜åŒ–é…ç½®"></a>2. æ€§èƒ½ä¼˜åŒ–é…ç½®</h3><p>Redisè¿æ¥ä¼˜åŒ–</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$redis</span> = <span class="keyword">new</span> <span class="title class_">Redis</span>();</span><br><span class="line"><span class="comment">// å¯ç”¨æŒä¹…è¿æ¥</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;<span class="title function_ invoke__">pconnect</span>(<span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="number">6379</span>, <span class="number">2.5</span>); <span class="comment">// 2.5ç§’è¶…æ—¶</span></span><br><span class="line"><span class="comment">// è®¾ç½®è¯»å†™è¶…æ—¶</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;<span class="title function_ invoke__">setOption</span>(<span class="title class_">Redis</span>::<span class="variable constant_">OPT_READ_TIMEOUT</span>, <span class="number">2.5</span>);</span><br><span class="line"><span class="comment">// å¯ç”¨å‹ç¼©</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;<span class="title function_ invoke__">setOption</span>(<span class="title class_">Redis</span>::<span class="variable constant_">OPT_COMPRESSION</span>, <span class="title class_">Redis</span>::<span class="variable constant_">COMPRESSION_LZF</span>);</span><br></pre></td></tr></table></figure><p>é”å‚æ•°è°ƒä¼˜å»ºè®®</p><table><thead><tr><th>åœºæ™¯</th><th>ttl</th><th>timeout</th><th>retryDelay</th><th>segments</th></tr></thead><tbody><tr><td>çŸ­æ—¶é«˜é¢‘æ“ä½œ</td><td>300ms</td><td>500ms</td><td>50ms</td><td>64</td></tr><tr><td>é•¿æ—¶ä¸šåŠ¡å¤„ç†</td><td>5s</td><td>10s</td><td>200ms</td><td>16</td></tr><tr><td>ç§’æ€åœºæ™¯</td><td>100ms</td><td>200ms</td><td>10ms</td><td>256</td></tr></tbody></table><h1 id="äº”ã€å‹æµ‹"><a href="#äº”ã€å‹æµ‹" class="headerlink" title="äº”ã€å‹æµ‹"></a>äº”ã€å‹æµ‹</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// lock_benchmark.php</span></span><br><span class="line"><span class="variable">$redis</span> = <span class="keyword">new</span> <span class="title class_">Redis</span>();</span><br><span class="line"><span class="variable">$redis</span>-&gt;<span class="title function_ invoke__">pconnect</span>(<span class="string">&#x27;127.0.0.1&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$lock</span> = <span class="keyword">new</span> <span class="title class_">AdvancedRedisLock</span>(<span class="variable">$redis</span>);</span><br><span class="line"><span class="variable">$start</span> = <span class="title function_ invoke__">microtime</span>(<span class="literal">true</span>);</span><br><span class="line"><span class="variable">$success</span> = <span class="number">0</span>;</span><br><span class="line"><span class="variable">$fail</span> = <span class="number">0</span>;</span><br><span class="line"><span class="variable">$concurrency</span> = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$pool</span> = <span class="keyword">new</span> <span class="title class_">Pool</span>(<span class="variable">$concurrency</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">1000</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line"><span class="variable">$pool</span>-&gt;<span class="title function_ invoke__">submit</span>(<span class="keyword">new</span> <span class="keyword">class</span>(<span class="variable">$lock</span>, &amp;<span class="variable">$success</span>, &amp;<span class="variable">$fail</span>) <span class="keyword">extends</span> Thread &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$lock</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$success</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$fail</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$lock</span>, &amp;<span class="variable">$success</span>, &amp;<span class="variable">$fail</span></span>) </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;lock = <span class="variable">$lock</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;success = &amp;<span class="variable">$success</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;fail = &amp;<span class="variable">$fail</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="variable">$result</span> = <span class="variable language_">$this</span>-&gt;lock-&gt;<span class="title function_ invoke__">acquire</span>(<span class="string">&#x27;benchmark&#x27;</span>, <span class="number">100</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$result</span>) &#123;</span><br><span class="line">                <span class="title function_ invoke__">usleep</span>(<span class="number">5000</span>); <span class="comment">// 5msæ¨¡æ‹Ÿä¸šåŠ¡å¤„ç†</span></span><br><span class="line">                <span class="variable language_">$this</span>-&gt;lock-&gt;<span class="title function_ invoke__">release</span>(<span class="string">&#x27;benchmark&#x27;</span>, <span class="variable">$result</span>[<span class="string">&#x27;token&#x27;</span>]);</span><br><span class="line">                ++<span class="variable language_">$this</span>-&gt;success;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                ++<span class="variable language_">$this</span>-&gt;fail;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$pool</span>-&gt;<span class="title function_ invoke__">shutdown</span>();</span><br><span class="line"><span class="variable">$duration</span> = <span class="title function_ invoke__">microtime</span>(<span class="literal">true</span>) - <span class="variable">$start</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Total: &quot;</span> . (<span class="variable">$success</span> + <span class="variable">$fail</span>) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Success: <span class="subst">$success</span>\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Fail: <span class="subst">$fail</span>\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;QPS: &quot;</span> . <span class="title function_ invoke__">round</span>((<span class="variable">$success</span> + <span class="variable">$fail</span>) / <span class="variable">$duration</span>, <span class="number">2</span>) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Failure rate: &quot;</span> . <span class="title function_ invoke__">round</span>(<span class="variable">$fail</span> / (<span class="variable">$success</span> + <span class="variable">$fail</span>) * <span class="number">100</span>, <span class="number">2</span>) . <span class="string">&quot;%\n&quot;</span>;</span><br></pre></td></tr></table></figure><h1 id="å…­ã€æ€§èƒ½ä¼˜åŒ–çŸ©é˜µ"><a href="#å…­ã€æ€§èƒ½ä¼˜åŒ–çŸ©é˜µ" class="headerlink" title="å…­ã€æ€§èƒ½ä¼˜åŒ–çŸ©é˜µ"></a>å…­ã€æ€§èƒ½ä¼˜åŒ–çŸ©é˜µ</h1><table><thead><tr><th>ä¼˜åŒ–æ‰‹æ®µ</th><th>ååé‡æå‡</th><th>å»¶è¿Ÿé™ä½</th><th>å®ç°å¤æ‚åº¦</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>Luaè„šæœ¬åŸå­æ“ä½œ</td><td>30%</td><td>20%</td><td>ä½</td><td>æ‰€æœ‰åœºæ™¯</td></tr><tr><td>åˆ†æ®µé”</td><td>5-10x</td><td>60%</td><td>ä¸­</td><td>èµ„æºå¯åˆ†åŒºåœºæ™¯</td></tr><tr><td>æœ¬åœ°ç¼“å­˜+åˆ†å¸ƒå¼é”</td><td>3-5x</td><td>70%</td><td>é«˜</td><td>é«˜å¹¶å‘è¯»åœºæ™¯</td></tr><tr><td>é”ç­‰å¾…é˜Ÿåˆ—</td><td>-</td><td>40%</td><td>é«˜</td><td>å…¬å¹³æ€§è¦æ±‚é«˜åœºæ™¯</td></tr><tr><td>å¤šçº§é”</td><td>2-3x</td><td>50%</td><td>é«˜</td><td>å¤šæ•°æ®ä¸­å¿ƒéƒ¨ç½²</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> é¢è¯• </tag>
            
            <tag> phpé¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysqlé¢è¯•</title>
      <link href="/posts/eeedb29e.html"/>
      <url>/posts/eeedb29e.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€äº‹åŠ¡å’Œé”"><a href="#ä¸€ã€äº‹åŠ¡å’Œé”" class="headerlink" title="ä¸€ã€äº‹åŠ¡å’Œé”"></a>ä¸€ã€äº‹åŠ¡å’Œé”</h1><ol><li>äº‹åŠ¡æ˜¯æ•°æ®åº“ä¸­ä¸€ç³»åˆ—æ“ä½œçš„é›†åˆï¼Œè¿™äº›æ“ä½œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå…¨éƒ¨ä¸å®Œæˆã€‚<br>ACID ç‰¹æ€§ï¼š</li></ol><ul><li>åŸå­æ€§ï¼ˆAtomicityï¼‰ ï¼šäº‹åŠ¡ä¸­çš„æ“ä½œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå…¨éƒ¨ä¸åšã€‚ä¾‹å¦‚ï¼Œé“¶è¡Œè½¬è´¦æ“ä½œï¼Œä» A è´¦æˆ·æ‰£æ¬¾å’Œç»™ B è´¦æˆ·åŠ æ¬¾è¿™ä¸¤ä¸ªæ“ä½œè¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥ã€‚</li><li>ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ ï¼šäº‹åŠ¡æ‰§è¡Œå‰åï¼Œæ•°æ®åº“éƒ½å¤„äºä¸€è‡´æ€§çŠ¶æ€ã€‚è¿˜æ˜¯é“¶è¡Œè½¬è´¦ä¾‹å­ï¼Œäº‹åŠ¡ç»“æŸåï¼ŒA è´¦æˆ·å’Œ B è´¦æˆ·çš„æ€»é‡‘é¢åº”è¯¥ä¿æŒä¸å˜ã€‚</li><li>éš”ç¦»æ€§ï¼ˆIsolationï¼‰ ï¼šå¹¶å‘æ‰§è¡Œçš„äº‹åŠ¡ä¹‹é—´ç›¸äº’éš”ç¦»ã€‚æ¯”å¦‚åœ¨ä¸åŒéš”ç¦»çº§åˆ«ä¸‹ï¼Œä¸€ä¸ªäº‹åŠ¡ä¿®æ”¹çš„æ•°æ®åœ¨æäº¤å‰å¯¹å…¶ä»–äº‹åŠ¡ä¸å¯è§ï¼ˆå…·ä½“å–å†³äºéš”ç¦»çº§åˆ«è®¾ç½®ï¼‰ã€‚</li><li>æŒä¹…æ€§ï¼ˆDurabilityï¼‰ ï¼šäº‹åŠ¡ä¸€æ—¦æäº¤ï¼Œå…¶å¯¹æ•°æ®åº“çš„æ”¹å˜æ˜¯æ°¸ä¹…çš„ï¼Œå³ä½¿ç³»ç»Ÿå‡ºç°æ•…éšœã€‚</li></ul><ol start="2"><li>é”æœ‰å“ªäº›ç±»å‹ï¼Ÿå®ƒä»¬çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</li></ol><ul><li>è¡¨é” ï¼šå¯¹æ•´å¼ è¡¨è¿›è¡Œé”å®šã€‚åœ¨ MyISAM å­˜å‚¨å¼•æ“ä¸­ï¼Œå†™æ“ä½œä¼šé”å®šæ•´å¼ è¡¨ï¼Œè¯»æ“ä½œä¹Ÿä¼šé”å®šè¡¨ï¼ˆä½†å…è®¸å¤šä¸ªè¯»æ“ä½œåŒæ—¶è¿›è¡Œï¼‰ã€‚è¡¨é”å¼€é”€å°ï¼ŒåŠ é”å¿«ï¼Œä½†å¯èƒ½ä¼šé€ æˆè¾ƒå¤§çš„å¹¶å‘å†²çªã€‚</li><li>è¡Œé” ï¼šåªé”å®šæ»¡è¶³æ¡ä»¶çš„è¡Œã€‚InnoDB å­˜å‚¨å¼•æ“é»˜è®¤ä½¿ç”¨è¡Œé”ã€‚è¡Œé”å¯ä»¥å®ç°è¾ƒé«˜çš„å¹¶å‘ï¼Œé€‚ç”¨äºäº‹åŠ¡å¤„ç†è¾ƒå¤šçš„åœºæ™¯ã€‚ä¾‹å¦‚ï¼Œåœ¨æ›´æ–°æŸä¸ªç”¨æˆ·è´¦æˆ·ä½™é¢æ—¶ï¼Œåªé”å®šè¯¥ç”¨æˆ·å¯¹åº”çš„è¡Œï¼Œå…è®¸å…¶ä»–ç”¨æˆ·è´¦æˆ·çš„å¹¶å‘æ“ä½œã€‚</li><li>é—´éš™é” ï¼šä¸»è¦æ˜¯åœ¨å¯é‡å¤è¯»äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸‹ï¼Œä¸ºé˜²æ­¢å¹»è¯»ç°è±¡å‡ºç°è€Œä½¿ç”¨çš„é”ã€‚å®ƒé”å®šçš„æ˜¯æ»¡è¶³æ¡ä»¶çš„è¡Œä¹‹é—´ä»¥åŠè¡Œå’Œç´¢å¼•ä¹‹é—´çš„é—´éš™ã€‚ä¾‹å¦‚ï¼Œå½“åœ¨ä¸€ä¸ªèŒƒå›´æŸ¥è¯¢ä¸­ï¼ˆå¦‚æŸ¥è¯¢å¹´é¾„åœ¨ 20 åˆ° 30 ä¹‹é—´çš„ç”¨æˆ·ï¼‰ï¼Œé—´éš™é”ä¼šé”å®šè¿™ä¸ªèŒƒå›´å†…çš„é—´éš™ï¼Œé˜²æ­¢å…¶ä»–äº‹åŠ¡æ’å…¥æ–°çš„è®°å½•å¯¼è‡´å¹»è¯»ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> mysql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysqlé¢è¯• </tag>
            
            <tag> é¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>redisåº•å±‚åŸç†</title>
      <link href="/posts/9c275835.html"/>
      <url>/posts/9c275835.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€Redis-å†…å­˜ç®¡ç†"><a href="#ä¸€ã€Redis-å†…å­˜ç®¡ç†" class="headerlink" title="ä¸€ã€Redis å†…å­˜ç®¡ç†"></a>ä¸€ã€Redis å†…å­˜ç®¡ç†</h1><p>Redis é‡‡ç”¨ä¸¤ç§å†…å­˜åˆ†é…æœºåˆ¶ï¼šjemallocï¼ˆé»˜è®¤ï¼‰å’Œtcmallocã€‚ä¸¤è€…éƒ½ä¼˜äºç³»ç»Ÿé»˜è®¤çš„ mallocï¼Œå› å¯æœ‰æ•ˆé˜²æ­¢å†…å­˜ç¢ç‰‡åŒ–ï¼Œæå‡å¤šçº¿ç¨‹åœºæ™¯ä¸‹çš„æ€§èƒ½ç¨³å®šæ€§ã€‚  </p><h2 id="1-å†…å­˜åˆ†é…ç­–ç•¥"><a href="#1-å†…å­˜åˆ†é…ç­–ç•¥" class="headerlink" title="1. å†…å­˜åˆ†é…ç­–ç•¥"></a>1. å†…å­˜åˆ†é…ç­–ç•¥</h2><p>Redis ä½¿ç”¨å¤šç§æ•°æ®ç»“æ„å­˜å‚¨æ•°æ®ï¼Œæ¯ç§ç»“æ„æ ¹æ®æ•°æ®å¤§å°åŠ¨æ€è°ƒæ•´å†…å­˜å ç”¨ã€‚</p><ul><li>å‹ç¼©åˆ—è¡¨ï¼ˆZipListï¼‰ï¼šåœ¨ LPUSH å’Œ RPUSH æ“ä½œä¸­ï¼Œå°å—å†…å­˜åˆ†é…é¢‘ç¹ã€‚Redis åŠ¨æ€è°ƒæ•´åˆ—è¡¨å®¹é‡ï¼Œåˆå§‹å®¹é‡å°ï¼Œå…ƒç´ å¢å¤šæ—¶æŒ‡æ•°çº§æ‰©å®¹ï¼ˆå¦‚ 8â†’16â†’32 å­—èŠ‚ï¼‰ï¼Œå‡å°‘å†…å­˜æµªè´¹ã€‚</li><li>å“ˆå¸Œè¡¨ï¼ˆHashTableï¼‰ï¼šå­˜å‚¨é”®å€¼å¯¹æ—¶ï¼Œå°è§„æ¨¡æ•°æ®ç”¨ç´§å‡‘å†…å­˜å¸ƒå±€ã€‚éšæ•°æ®å¢é•¿ï¼Œå“ˆå¸Œè¡¨è‡ªåŠ¨æ‰©å®¹ï¼Œå¹³è¡¡å†…å­˜ä½¿ç”¨ä¸æ“ä½œæ•ˆç‡ã€‚</li></ul><p>Redis æ”¯æŒæ‰‹åŠ¨å†…å­˜æ¸…ç†ã€‚å®¢æˆ·ç«¯å¯è°ƒç”¨ DEL å‘½ä»¤åˆ é™¤æŒ‡å®šé”®å€¼å¯¹ï¼Œæˆ–è®¾ç½®è¿‡æœŸæ—¶é—´è®© Redis è‡ªåŠ¨æ¸…ç†è¿‡æœŸæ•°æ®ã€‚</p><h1 id="äºŒã€Redis-æ•°æ®åº“æŒä¹…åŒ–æœºåˆ¶"><a href="#äºŒã€Redis-æ•°æ®åº“æŒä¹…åŒ–æœºåˆ¶" class="headerlink" title="äºŒã€Redis æ•°æ®åº“æŒä¹…åŒ–æœºåˆ¶"></a>äºŒã€Redis æ•°æ®åº“æŒä¹…åŒ–æœºåˆ¶</h1><p>Redis æä¾› RDB å’Œ AOF ä¸¤ç§æŒä¹…åŒ–æœºåˆ¶ï¼Œå„æœ‰ä¼˜åŠ£ï¼Œå¯ç»“åˆä½¿ç”¨ä»¥ä¿éšœæ•°æ®å¯é æ€§ä¸æ¢å¤æ•ˆç‡ã€‚</p><h2 id="1-å†…å­˜å¿«ç…§ï¼ˆRDBï¼‰"><a href="#1-å†…å­˜å¿«ç…§ï¼ˆRDBï¼‰" class="headerlink" title="1. å†…å­˜å¿«ç…§ï¼ˆRDBï¼‰"></a>1. å†…å­˜å¿«ç…§ï¼ˆRDBï¼‰</h2><p>RDB é€šè¿‡ä¿å­˜å†…å­˜å¿«ç…§å®ç°æŒä¹…åŒ–ã€‚Redis æä¾›ä¸¤ç§è§¦å‘æ–¹å¼ï¼š</p><ul><li>æ‰‹åŠ¨è§¦å‘ï¼šSAVE å‘½ä»¤ä¼šé˜»å¡å½“å‰RedisæœåŠ¡å™¨ï¼Œç›´åˆ°RDBè¿‡ç¨‹å®Œæˆï¼Œé€‚åˆå°æ•°æ®é‡æˆ–å¯¹åœé¡¿ä¸æ•æ„Ÿåœºæ™¯ã€‚</li><li>è‡ªåŠ¨è§¦å‘ï¼šæ ¹æ®é…ç½®çš„ä¿å­˜æ¡ä»¶è‡ªåŠ¨æ‰§è¡Œã€‚å¦‚save 900 1ï¼Œè¡¨ç¤º900ç§’å†…è‡³å°‘1æ¬¡å†™æ“ä½œåè‡ªåŠ¨ä¿å­˜ï¼Œé€‚ç”¨äºå¯¹æ•°æ®å®Œæ•´æ€§å’Œæ¢å¤æ—¶é—´æœ‰ä¸åŒè¦æ±‚çš„ç”Ÿäº§ç¯å¢ƒã€‚</li></ul><p>RDB æ–‡ä»¶ç»“æ„ç®€æ´ï¼Œæ•°æ®ä»¥äºŒè¿›åˆ¶å½¢å¼å­˜å‚¨ï¼Œå ç”¨ç©ºé—´è¾ƒå°ï¼Œä¾¿äºå¿«é€Ÿå­˜å‚¨å’Œè¯»å–ï¼Œæ˜¯å¤‡ä»½å’Œç¾éš¾æ¢å¤çš„é¦–é€‰æ–¹æ¡ˆã€‚</p><h1 id="2-æ—¥å¿—è¿½åŠ ï¼ˆAOFï¼‰"><a href="#2-æ—¥å¿—è¿½åŠ ï¼ˆAOFï¼‰" class="headerlink" title="2. æ—¥å¿—è¿½åŠ ï¼ˆAOFï¼‰"></a>2. æ—¥å¿—è¿½åŠ ï¼ˆAOFï¼‰</h1><p>AOF é€šè¿‡è®°å½•å†™æ“ä½œå‘½ä»¤å®ç°æŒä¹…åŒ–ã€‚Redis æä¾›å¤šç§æŒä¹…åŒ–ç­–ç•¥ï¼š</p><ul><li>æ¯ç§’æŒä¹…åŒ–ï¼ˆappendfsync everysecï¼‰ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¹¿æ³›åº”ç”¨ï¼Œèƒ½åœ¨ç³»ç»Ÿæ•…éšœæ—¶ï¼Œå°†æ•°æ®ä¸¢å¤±é‡æ§åˆ¶åœ¨1ç§’å†…ï¼Œå¹³è¡¡æ€§èƒ½ä¸æ•°æ®å®‰å…¨æ€§ã€‚</li><li>æ¯æ¬¡å†™å…¥éƒ½æŒä¹…åŒ–ï¼ˆappendfsync alwaysï¼‰ï¼šæç«¯é‡è§†æ•°æ®å®‰å…¨çš„åœºæ™¯ä½¿ç”¨ï¼Œæ¯æ¬¡å†™æ“ä½œéƒ½åŒæ­¥åˆ°ç£ç›˜ï¼Œé¿å…æ•°æ®ä¸¢å¤±ã€‚</li><li>ä»ä¸æŒä¹…åŒ–ï¼ˆappendfsync noï¼‰ï¼šæ€§èƒ½ä¼˜å…ˆçš„åœºæ™¯ä½¿ç”¨ï¼Œå†™æ“ä½œä»…åœ¨å†…å­˜ä¸­æ‰§è¡Œï¼Œç”±æ“ä½œç³»ç»Ÿå†³å®šæ•°æ®åˆ·æ–°æ—¶æœºï¼Œæ•°æ®å®‰å…¨æ€§æ— æ³•ä¿è¯ã€‚</li></ul><p>AOF æ—¥å¿—æ–‡ä»¶é‡‡ç”¨æ–‡æœ¬æ ¼å¼ï¼Œè®°å½•å®¢æˆ·ç«¯æ‰§è¡Œçš„å†™æ“ä½œï¼Œä¾¿äºè¯»å–å’Œåˆ†æï¼ŒåŒæ—¶æ”¯æŒæ—¥å¿—é‡å†™åŠŸèƒ½è‡ªåŠ¨ä¼˜åŒ–æ–‡ä»¶å¤§å°ã€‚ä½†ä¸ RDB ç›¸æ¯”ï¼Œç›¸åŒæ•°æ®é‡ä¸‹ AOF æ–‡ä»¶é€šå¸¸æ›´å¤§ï¼Œæ¢å¤é€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢ã€‚</p><h1 id="ä¸‰ã€Redis-ç½‘ç»œé€šä¿¡æ¨¡å‹"><a href="#ä¸‰ã€Redis-ç½‘ç»œé€šä¿¡æ¨¡å‹" class="headerlink" title="ä¸‰ã€Redis ç½‘ç»œé€šä¿¡æ¨¡å‹"></a>ä¸‰ã€Redis ç½‘ç»œé€šä¿¡æ¨¡å‹</h1><p>Redis é‡‡ç”¨å•çº¿ç¨‹ã€å¤šè·¯ I&#x2F;O å¤ç”¨ä¸äº‹ä»¶é©±åŠ¨æŠ€æœ¯å¤„ç†ç½‘ç»œè¯·æ±‚ã€‚å…¶å·¥ä½œåŸç†å¦‚ä¸‹ï¼š</p><h2 id="1-å•çº¿ç¨‹æ¨¡å‹"><a href="#1-å•çº¿ç¨‹æ¨¡å‹" class="headerlink" title="1. å•çº¿ç¨‹æ¨¡å‹"></a>1. å•çº¿ç¨‹æ¨¡å‹</h2><p>Redis çš„å•çº¿ç¨‹æ¨¡å‹åŸºäºæ–‡ä»¶äº‹ä»¶å¤„ç†å™¨ï¼Œå¤„ç†å„ç±»ç½‘ç»œäº‹ä»¶ã€‚å…¶ä¸»è¦ç‰¹ç‚¹å¦‚ä¸‹ï¼š</p><ul><li>I&#x2F;O å¤šè·¯å¤ç”¨ï¼šRedis ä½¿ç”¨epollï¼ˆLinuxï¼‰ã€kqueueï¼ˆFreeBSDï¼‰ã€selectç­‰ç³»ç»Ÿè°ƒç”¨ç›‘æ§å¤šä¸ªå®¢æˆ·ç«¯è¿æ¥ï¼Œå®ç°é«˜æ•ˆäº‹ä»¶é€šçŸ¥ï¼Œä½¿å•çº¿ç¨‹èƒ½åŒæ—¶ç®¡ç†å¤§é‡å¹¶å‘è¿æ¥ã€‚</li><li>äº‹ä»¶é©±åŠ¨ï¼šæ–‡ä»¶äº‹ä»¶å¤„ç†å™¨é‡‡ç”¨IO å¤šè·¯å¤ç”¨æŠ€æœ¯ï¼Œé€šè¿‡æ³¨å†Œäº‹ä»¶ç›‘å¬ï¼Œå®ç°é«˜æ•ˆäº‹ä»¶é©±åŠ¨æœºåˆ¶ï¼Œæå‡ Redis å¹¶å‘æ€§èƒ½ã€‚</li></ul><h2 id="2-å¤šçº¿ç¨‹æ¨¡å‹"><a href="#2-å¤šçº¿ç¨‹æ¨¡å‹" class="headerlink" title="2. å¤šçº¿ç¨‹æ¨¡å‹"></a>2. å¤šçº¿ç¨‹æ¨¡å‹</h2><p>Redis è‡ª4.0èµ·å¼•å…¥å¤šçº¿ç¨‹I&#x2F;Oï¼Œä¼˜åŒ–å†™å›ç½‘ç»œæ•°æ®çš„æ€§èƒ½ç“¶é¢ˆã€‚æ¶æ„å¦‚ä¸‹ï¼š</p><ul><li>ä¸»çº¿ç¨‹ï¼šè´Ÿè´£è¯»å–å®¢æˆ·ç«¯è¯·æ±‚ã€‚</li><li>å­çº¿ç¨‹æ± ï¼šç”±io_threads_do_writeé…ç½®é¡¹è®¾ç½®ï¼Œçº¿ç¨‹æ•°é‡é€šå¸¸ä¸CPUæ ¸å¿ƒæ•°åŒ¹é…ï¼Œç”¨äºå†™å›å“åº”æ•°æ®ã€‚</li><li>å…±äº«ç¼“å†²åŒºï¼šä¸»çº¿ç¨‹è¯»å–è¯·æ±‚åï¼Œå°†å“åº”æ•°æ®æš‚å­˜äºå…±äº«ç¼“å†²åŒºï¼Œä¾›å­çº¿ç¨‹æ± å†™å›ã€‚</li></ul><p>Redis ç½‘ç»œé€šä¿¡æ¨¡å‹çš„ä¼˜åŒ–æ–¹å‘åŒ…æ‹¬åˆ©ç”¨å¼‚æ­¥IOæå‡è¯»å†™æ•ˆç‡ã€é‡‡ç”¨æ•°æ®å‹ç¼©å‡å°‘ä¼ è¾“é‡ã€å®æ–½æµé‡æ§åˆ¶ç­–ç•¥ä¿éšœç¨³å®šæ€§ã€‚æœªæ¥ï¼ŒRedis å°†æŒç»­æ¢ç´¢æ–°æŠ€æœ¯å¦‚ç”¨æˆ·æ€ç½‘ç»œåè®®æ ˆå’Œæ™ºèƒ½ç½‘å¡ï¼Œä»¥è¿›ä¸€æ­¥æå‡ç½‘ç»œé€šä¿¡æ€§èƒ½ã€‚</p><h1 id="å››ã€Redis-æ•°æ®ç»“æ„å®ç°"><a href="#å››ã€Redis-æ•°æ®ç»“æ„å®ç°" class="headerlink" title="å››ã€Redis æ•°æ®ç»“æ„å®ç°"></a>å››ã€Redis æ•°æ®ç»“æ„å®ç°</h1><p>Redisæ¯ç§æ•°æ®ç»“æ„éƒ½é’ˆå¯¹ä¸åŒä½¿ç”¨åœºæ™¯ä¼˜åŒ–ï¼Œä¸‹é¢ä»‹ç»å…¶åº•å±‚å®ç°åŸç†ï¼š</p><h2 id="1-å­—ç¬¦ä¸²ï¼ˆStringï¼‰"><a href="#1-å­—ç¬¦ä¸²ï¼ˆStringï¼‰" class="headerlink" title="1. å­—ç¬¦ä¸²ï¼ˆStringï¼‰"></a>1. å­—ç¬¦ä¸²ï¼ˆStringï¼‰</h2><ul><li>Rediså­—ç¬¦ä¸²åŸºäºç®€å•åŠ¨æ€å­—ç¬¦ä¸²ï¼ˆSDSï¼‰å®ç°ï¼Œç»“æ„åŒ…å«é•¿åº¦ã€åˆ†é…é•¿åº¦åŠå†…å®¹æŒ‡é’ˆï¼Œæ”¯æŒäºŒè¿›åˆ¶å®‰å…¨æ•°æ®ï¼Œè‡ªåŠ¨å¤„ç†ç¼“å†²åŒºæº¢å‡ºã€‚</li><li>SDS æä¾›å¤šç§æ“ä½œå‡½æ•°ï¼Œå¦‚sdsnewã€sdscatç­‰ï¼Œæ”¯æŒæ•°æ®æ“ä½œï¼Œå¦‚è¿½åŠ ã€æˆªå–ç­‰ã€‚å­—ç¬¦ä¸²åº”ç”¨åœºæ™¯å¹¿æ³›ï¼Œå¦‚ç¼“å­˜ã€è®¡æ•°å™¨ç­‰ã€‚</li></ul><h2 id="2-å“ˆå¸Œè¡¨ï¼ˆHashï¼‰"><a href="#2-å“ˆå¸Œè¡¨ï¼ˆHashï¼‰" class="headerlink" title="2. å“ˆå¸Œè¡¨ï¼ˆHashï¼‰"></a>2. å“ˆå¸Œè¡¨ï¼ˆHashï¼‰</h2><ul><li>Rediså“ˆå¸Œè¡¨åº•å±‚ä¸ºæ•°ç»„æŒ‡é’ˆï¼Œåˆå§‹å®¹é‡8ï¼Œå­˜å‚¨å¤§é‡é”®å€¼å¯¹æ—¶åŠ¨æ€æ‰©å®¹ã€‚</li><li>å“ˆå¸Œè¡¨é‡‡ç”¨æ‹‰é“¾æ³•è§£å†³å†²çªï¼Œæ”¯æŒæ¸è¿›å¼rehashï¼Œé¿å…é›†ä¸­æ€§èƒ½å¼€é”€ã€‚é€‚ç”¨äºå­˜å‚¨å¯¹è±¡å±æ€§ï¼ˆå¦‚ç”¨æˆ·ä¿¡æ¯ï¼‰ã€‚</li></ul><h2 id="3-åˆ—è¡¨ï¼ˆListï¼‰"><a href="#3-åˆ—è¡¨ï¼ˆListï¼‰" class="headerlink" title="3. åˆ—è¡¨ï¼ˆListï¼‰"></a>3. åˆ—è¡¨ï¼ˆListï¼‰</h2><ul><li>Redisåˆ—è¡¨ç”±å‹ç¼©åˆ—è¡¨æˆ–åŒå‘é“¾è¡¨å®ç°ã€‚å‹ç¼©åˆ—è¡¨å†…å­˜æ•ˆç‡é«˜ï¼Œé€‚åˆçŸ­åˆ—è¡¨ï¼›åŒå‘é“¾è¡¨æ”¯æŒåŒå‘æ“ä½œï¼Œå¹³å‡æ—¶é—´å¤æ‚åº¦ O(n)ã€‚</li><li>åˆ—è¡¨é€‚ç”¨äºæ¶ˆæ¯é˜Ÿåˆ—å’Œä»»åŠ¡é˜Ÿåˆ—ã€‚</li></ul><h2 id="4-é›†åˆï¼ˆSetï¼‰"><a href="#4-é›†åˆï¼ˆSetï¼‰" class="headerlink" title="4. é›†åˆï¼ˆSetï¼‰"></a>4. é›†åˆï¼ˆSetï¼‰</h2><ul><li>Redisé›†åˆåŸºäºå“ˆå¸Œè¡¨å®ç°ï¼Œé€šè¿‡è®¡ç®—å“ˆå¸Œå€¼åˆ¤é‡ï¼Œæ”¯æŒæ— åºé›†åˆæ“ä½œï¼Œå¹³å‡æ—¶é—´å¤æ‚åº¦ O(1)ã€‚</li><li>æ‰©å±•å®ç°ä¸ºæ•´æ•°é›†åˆï¼Œå­˜å‚¨æ•´æ•°æ—¶é«˜æ•ˆåˆ©ç”¨ç©ºé—´ï¼Œé€‚ç”¨äºå­˜å‚¨å”¯ä¸€å€¼é›†åˆï¼ˆå¦‚å…³æ³¨åˆ—è¡¨ï¼‰ã€‚</li></ul><h2 id="5-æœ‰åºé›†åˆï¼ˆSorted-Setï¼‰"><a href="#5-æœ‰åºé›†åˆï¼ˆSorted-Setï¼‰" class="headerlink" title="5. æœ‰åºé›†åˆï¼ˆSorted Setï¼‰"></a>5. æœ‰åºé›†åˆï¼ˆSorted Setï¼‰</h2><ul><li>Redisæœ‰åºé›†åˆåœ¨å“ˆå¸Œè¡¨å’Œè·³è¡¨åŒé‡ç»“æ„æ”¯æŒä¸‹ï¼ŒåŸºäºå“ˆå¸Œè¡¨å¿«é€Ÿå®šä½å…ƒç´ ï¼Œç»“åˆè·³è¡¨é«˜æ•ˆç»´æŠ¤å…ƒç´ æœ‰åºæ€§ã€‚</li><li>æœ‰åºé›†åˆæ”¯æŒèŒƒå›´æŸ¥è¯¢ï¼Œæ—¶é—´å¤æ‚åº¦ O(log n)ï¼Œé€‚ç”¨äºæ’è¡Œæ¦œåœºæ™¯ã€‚</li></ul><h1 id="äº”ã€Redis-å¤åˆ¶æœºåˆ¶"><a href="#äº”ã€Redis-å¤åˆ¶æœºåˆ¶" class="headerlink" title="äº”ã€Redis å¤åˆ¶æœºåˆ¶"></a>äº”ã€Redis å¤åˆ¶æœºåˆ¶</h1><p>Redis å¤åˆ¶æœºåˆ¶åŸºäºä¸»ä»æ¶æ„ï¼Œä¸»èŠ‚ç‚¹å¤„ç†è¯»å†™æ“ä½œå¹¶å®æ—¶åŒæ­¥æ•°æ®è‡³ä»èŠ‚ç‚¹ï¼Œä»èŠ‚ç‚¹åªè¯»å“åº”ï¼Œå…¶åŸç†å¦‚ä¸‹ï¼š</p><h2 id="1-åˆå§‹åŒ–å¤åˆ¶"><a href="#1-åˆå§‹åŒ–å¤åˆ¶" class="headerlink" title="1. åˆå§‹åŒ–å¤åˆ¶"></a>1. åˆå§‹åŒ–å¤åˆ¶</h2><ul><li>ä»èŠ‚ç‚¹è¿æ¥ä¸»èŠ‚ç‚¹ï¼Œå‘é€ SYNC å‘½ä»¤ï¼Œè§¦å‘å…¨é‡å¤åˆ¶ï¼šä¸»èŠ‚ç‚¹ç”Ÿæˆ RDB å¿«ç…§è‡³ç£ç›˜ï¼Œè¯»å–å¿«ç…§å¹¶å‘é€è‡³ä»èŠ‚ç‚¹ï¼Œä»èŠ‚ç‚¹æ¸…ç©ºæ—§æ•°æ®å¹¶åŠ è½½å¿«ç…§ã€‚</li><li>é‡‡ç”¨ PSYNC å‘½ä»¤å®ç°éƒ¨åˆ†å¤åˆ¶ï¼šä»èŠ‚ç‚¹è®°å½•å¤åˆ¶åç§»é‡åŠä¸»èŠ‚ç‚¹ IDï¼Œç½‘ç»œä¸­æ–­åå‘ä¸»èŠ‚ç‚¹å‘é€ PSYNC å‘½ä»¤è¯·æ±‚å¢é‡æ›´æ–°æ•°æ®ã€‚</li></ul><h2 id="2-æ•°æ®åŒæ­¥"><a href="#2-æ•°æ®åŒæ­¥" class="headerlink" title="2. æ•°æ®åŒæ­¥"></a>2. æ•°æ®åŒæ­¥</h2><ul><li>ä¸»èŠ‚ç‚¹æ¥æ”¶å†™æ“ä½œå‘½ä»¤åï¼Œå…ˆå†™å…¥è‡ªèº«æ•°æ®åº“ï¼Œå†é€šè¿‡è¾“å‡ºç¼“å†²åŒºå‘é€ç»™ä»èŠ‚ç‚¹ï¼Œç¡®ä¿ä¸»ä»æ•°æ®ä¸€è‡´ã€‚</li><li>ä¸»èŠ‚ç‚¹ç»´æŠ¤å¤åˆ¶ backlog ç¼“å†²åŒºï¼Œå­˜å‚¨æœ€è¿‘éƒ¨åˆ†æ•°æ®ï¼Œä»èŠ‚ç‚¹é‡è¿æ—¶å¯ä»æ­¤ç¼“å†²åŒºè·å–éƒ¨åˆ†ç¼ºå¤±æ•°æ®ã€‚</li></ul><h2 id="3-å¤åˆ¶æ‹“æ‰‘"><a href="#3-å¤åˆ¶æ‹“æ‰‘" class="headerlink" title="3. å¤åˆ¶æ‹“æ‰‘"></a>3. å¤åˆ¶æ‹“æ‰‘</h2><ul><li>Redis æ”¯æŒå¤šçº§å¤åˆ¶é“¾å’Œå¤šä¸»å¤åˆ¶ç»“æ„ï¼šåœ¨å¤šçº§å¤åˆ¶é“¾ä¸­ï¼Œä»èŠ‚ç‚¹å¯ä½œä¸ºå…¶ä»–ä»èŠ‚ç‚¹çš„ä¸»èŠ‚ç‚¹ï¼›å¤šä¸»å¤åˆ¶ç»“æ„å…è®¸å¤šä¸ªä¸»èŠ‚ç‚¹å¹¶è¡Œå·¥ä½œï¼Œé€‚åˆä¸åŒä¸šåŠ¡éœ€æ±‚ã€‚</li><li>ä¸»èŠ‚ç‚¹ç»´æŠ¤å¤åˆ¶åç§»é‡å’Œä»èŠ‚ç‚¹åˆ—è¡¨ï¼Œç›‘æ§ä»èŠ‚ç‚¹çŠ¶æ€å¹¶åŠ¨æ€æ›´æ–°ã€‚ä»èŠ‚ç‚¹å®šæœŸå‘ä¸»èŠ‚ç‚¹å‘é€ PING å‘½ä»¤ï¼Œè¶…æ—¶æœªå“åº”åˆ™ä¸»èŠ‚ç‚¹æ ‡è®°ä¸ºæ–­çº¿ï¼Œç½‘ç»œæ¢å¤åè‡ªåŠ¨é‡è¿ã€‚</li></ul><h1 id="äº”ã€Redis-é›†ç¾¤æ¶æ„"><a href="#äº”ã€Redis-é›†ç¾¤æ¶æ„" class="headerlink" title="äº”ã€Redis é›†ç¾¤æ¶æ„"></a>äº”ã€Redis é›†ç¾¤æ¶æ„</h1><p>Redis Cluster æ˜¯ Redis çš„åˆ†å¸ƒå¼è§£å†³æ–¹æ¡ˆï¼Œå…¶æ ¸å¿ƒç»„ä»¶å’Œæœºåˆ¶å¦‚ä¸‹ï¼š</p><h2 id="1-å“ˆå¸Œæ§½"><a href="#1-å“ˆå¸Œæ§½" class="headerlink" title="1.å“ˆå¸Œæ§½"></a>1.å“ˆå¸Œæ§½</h2><ul><li>Redis Cluster å°†é”®æ˜ å°„åˆ° 16384 ä¸ªå“ˆå¸Œæ§½ï¼ŒèŠ‚ç‚¹è´Ÿè´£éƒ¨åˆ†æ§½ï¼Œé”®é€šè¿‡ CRC16 ç®—æ³•è®¡ç®—å½’å±æ§½ï¼Œå®ç°æ•°æ®åˆ†å¸ƒå¼å­˜å‚¨ã€‚</li><li>å“ˆå¸Œæ§½æå‡æ•°æ®å®šä½æ•ˆç‡ï¼Œç¡®ä¿æ•°æ®å‡åŒ€åˆ†å¸ƒï¼Œä¾¿äºæ‰©å±•å’Œæ”¶ç¼©ã€‚</li></ul><h2 id="2-èŠ‚ç‚¹é€šä¿¡"><a href="#2-èŠ‚ç‚¹é€šä¿¡" class="headerlink" title="2. èŠ‚ç‚¹é€šä¿¡"></a>2. èŠ‚ç‚¹é€šä¿¡</h2><ul><li>èŠ‚ç‚¹é—´é‡‡ç”¨äºŒè¿›åˆ¶åè®®é€šä¿¡ï¼Œä¸»ä»èŠ‚ç‚¹å„å¸å…¶èŒï¼šä¸»èŠ‚ç‚¹å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ï¼Œæ‰§è¡Œæ•°æ®è¯»å†™æ“ä½œï¼›ä»èŠ‚ç‚¹å¼‚æ­¥å¤åˆ¶ä¸»èŠ‚ç‚¹æ•°æ®ï¼Œæå‡é›†ç¾¤è¯»å–èƒ½åŠ›å’Œæ•…éšœè½¬ç§»èƒ½åŠ›ã€‚</li><li>èŠ‚ç‚¹å®šæœŸäº¤æ¢ PING-PONG å‘½ä»¤ï¼Œç›‘æµ‹é“¾è·¯çŠ¶æ€ï¼Œæ›´æ–°é›†ç¾¤é…ç½®ä¿¡æ¯ï¼Œç»´æŠ¤é›†ç¾¤æ‹“æ‰‘ç»“æ„ã€‚</li></ul><h2 id="3-æ•°æ®è¿ç§»"><a href="#3-æ•°æ®è¿ç§»" class="headerlink" title="3. æ•°æ®è¿ç§»"></a>3. æ•°æ®è¿ç§»</h2><ul><li>Redis Cluster æ”¯æŒåœ¨çº¿æ•°æ®è¿ç§»ï¼Œéœ€æŒ‡å®šæºå’Œç›®æ ‡èŠ‚ç‚¹åŠæ§½å·ã€‚è¿ç§»æµç¨‹ï¼šå‘½ä»¤é€šçŸ¥â†’å“ˆå¸ŒæŒ‡é’ˆæ›´æ–°â†’æ•°æ®è¿ç§»â†’å“ˆå¸ŒæŒ‡é’ˆæ¸…é™¤ã€‚</li><li>æ•°æ®è¿ç§»ç¡®ä¿é”®çš„å¯è®¿é—®æ€§ï¼Œè‡ªåŠ¨é‡è¯•ä¿éšœå¯é æ€§ï¼Œä¼˜åŒ–ç­–ç•¥æå‡æ•ˆç‡ï¼Œä½¿é›†ç¾¤åŠ¨æ€è°ƒæ•´æ•°æ®åˆ†å¸ƒåº”å¯¹è´Ÿè½½å˜åŒ–ã€‚</li></ul><h2 id="å…­ã€Redis-å†…å­˜å›æ”¶ç­–ç•¥"><a href="#å…­ã€Redis-å†…å­˜å›æ”¶ç­–ç•¥" class="headerlink" title="å…­ã€Redis å†…å­˜å›æ”¶ç­–ç•¥"></a>å…­ã€Redis å†…å­˜å›æ”¶ç­–ç•¥</h2><p>Redis æä¾›å¤šç§å†…å­˜å›æ”¶ç­–ç•¥ï¼Œåº”å¯¹ä¸åŒå†…å­˜ä½¿ç”¨å‹åŠ›åœºæ™¯ï¼š</p><h2 id="1-æœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼ˆLRUï¼‰"><a href="#1-æœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼ˆLRUï¼‰" class="headerlink" title="1. æœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼ˆLRUï¼‰"></a>1. æœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼ˆLRUï¼‰</h2><ul><li>LRU ç®—æ³•åŸç†ï¼šRedis ç»´æŠ¤åŒå‘é“¾è¡¨è®°å½•é”®è®¿é—®é¡ºåºã€‚è®¿é—®é”®æ—¶ç§»è‡³é“¾è¡¨å¤´éƒ¨ï¼Œå†…å­˜ä¸è¶³æ—¶é‡Šæ”¾é“¾è¡¨å°¾éƒ¨é”®ã€‚</li><li>LRU ç®—æ³•åº”ç”¨åœºæ™¯ï¼šé€‚ç”¨äºå¤§å¤šæ•°åœºæ™¯ï¼Œé»˜è®¤é…ç½®ä¹‹ä¸€ï¼Œè‡ªåŠ¨æ·˜æ±°æœ€ä¹…æœªä½¿ç”¨çš„é”®ï¼Œä¿éšœç¼“å­˜æ›´æ–°ã€‚</li></ul><h2 id="2-æœ€ä¹…æœªä½¿ç”¨ï¼ˆLFUï¼‰"><a href="#2-æœ€ä¹…æœªä½¿ç”¨ï¼ˆLFUï¼‰" class="headerlink" title="2. æœ€ä¹…æœªä½¿ç”¨ï¼ˆLFUï¼‰"></a>2. æœ€ä¹…æœªä½¿ç”¨ï¼ˆLFUï¼‰</h2><ul><li>LFU ç®—æ³•åŸç†ï¼šRedis ä¸ºæ¯ä¸ªé”®è®¾è®¡è®¡æ•°å™¨ï¼Œè¡°å‡ç­–ç•¥ç»“åˆè®¿é—®é¢‘ç‡å’Œæ—¶é—´ã€‚è®¿é—®é”®æ—¶è®¡æ•°å™¨é€’å¢ï¼Œå®šæœŸè¡°å‡ï¼Œå¹³è¡¡æ–°æ—§é”®æƒé‡ã€‚</li><li>LFU ç®—æ³•åº”ç”¨åœºæ™¯ï¼šé€‚ç”¨äºé«˜é¢‘è®¿é—®é”®éœ€ä¿ç•™çš„åœºæ™¯ï¼Œå¦‚ç¤¾äº¤åª’ä½“çƒ­ç‚¹ï¼Œé…ç½®å‘½ä»¤maxmemory-policy lfupã€‚</li></ul><h2 id="3-éšæœºæ·˜æ±°"><a href="#3-éšæœºæ·˜æ±°" class="headerlink" title="3. éšæœºæ·˜æ±°"></a>3. éšæœºæ·˜æ±°</h2><ul><li>éšæœºæ·˜æ±°ç­–ç•¥åŸç†ï¼šå†…å­˜è¶…å‡ºé™åˆ¶æ—¶éšæœºé€‰æ‹©å¹¶é‡Šæ”¾é”®ã€‚</li><li>éšæœºæ·˜æ±°ç­–ç•¥åº”ç”¨åœºæ™¯ï¼šé€‚ç”¨äºæ— æ˜ç¡®è®¿é—®æ¨¡å¼åœºæ™¯ï¼Œé…ç½®å‘½ä»¤maxmemory-policy noevictionã€‚</li></ul><h2 id="ä¸ƒã€Redis-äº‹åŠ¡æœºåˆ¶"><a href="#ä¸ƒã€Redis-äº‹åŠ¡æœºåˆ¶" class="headerlink" title="ä¸ƒã€Redis äº‹åŠ¡æœºåˆ¶"></a>ä¸ƒã€Redis äº‹åŠ¡æœºåˆ¶</h2><p>Redis äº‹åŠ¡é€šè¿‡MULTIã€EXECã€DISCARDå’ŒWATCHå‘½ä»¤å®ç°ï¼Œæä¾›åŸºæœ¬äº‹åŠ¡æ”¯æŒï¼š</p><h2 id="1-äº‹åŠ¡å¯åŠ¨ä¸æ‰§è¡Œ"><a href="#1-äº‹åŠ¡å¯åŠ¨ä¸æ‰§è¡Œ" class="headerlink" title="1. äº‹åŠ¡å¯åŠ¨ä¸æ‰§è¡Œ"></a>1. äº‹åŠ¡å¯åŠ¨ä¸æ‰§è¡Œ</h2><ul><li><p>å‘½ä»¤åºåˆ—ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MULTI      <span class="comment"># æ ‡è¯†äº‹åŠ¡å—å¼€å§‹</span></span><br><span class="line">SET key1 value1</span><br><span class="line">SET key2 value2</span><br><span class="line">EXEC      <span class="comment"># æ‰§è¡Œäº‹åŠ¡</span></span><br></pre></td></tr></table></figure></li><li><p>Redis äº‹åŠ¡å¯åŠ¨åå®¢æˆ·ç«¯è¯·æ±‚å…¥é˜Ÿï¼Œé‡é”™è¯¯ä¹Ÿæ‰§è¡Œï¼Œæ— éš”ç¦»çº§åˆ«ä¸å›æ»šæœºåˆ¶ï¼Œéƒ¨åˆ†å¤±è´¥éœ€å®¢æˆ·ç«¯å¤„ç†ã€‚</p></li></ul><h2 id="2-ä¹è§‚é”å®ç°"><a href="#2-ä¹è§‚é”å®ç°" class="headerlink" title="2. ä¹è§‚é”å®ç°"></a>2. ä¹è§‚é”å®ç°</h2><p>Redis çš„WATCHå‘½ä»¤å®ç°ä¹è§‚é”ï¼šç›‘æ§é”®å˜æ›´ï¼Œäº‹åŠ¡æ‰§è¡Œå‰æ£€æµ‹å˜æ›´ï¼Œè‹¥äº‹åŠ¡æ‰§è¡ŒæœŸé—´é”®è¢«ä¿®æ”¹ï¼Œåˆ™äº‹åŠ¡å–æ¶ˆã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">WATCH key</span><br><span class="line">... <span class="comment"># è¯»å–å’Œä¿®æ”¹é”®çš„é€»è¾‘</span></span><br><span class="line">MULTI</span><br><span class="line">SET key new_value</span><br><span class="line">EXEC      <span class="comment"># æ£€æµ‹é”®å˜æ›´å¹¶æ‰§è¡Œäº‹åŠ¡</span></span><br></pre></td></tr></table></figure><p>Redis ä¹è§‚é”é€‚ç”¨äºé”®ä¿®æ”¹ä¸é¢‘ç¹åœºæ™¯ï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§ï¼Œå‡å°‘äº‹åŠ¡å†²çªã€‚</p><h1 id="å…«ã€Redis-æ¶ˆæ¯å‘å¸ƒè®¢é˜…"><a href="#å…«ã€Redis-æ¶ˆæ¯å‘å¸ƒè®¢é˜…" class="headerlink" title="å…«ã€Redis æ¶ˆæ¯å‘å¸ƒè®¢é˜…"></a>å…«ã€Redis æ¶ˆæ¯å‘å¸ƒè®¢é˜…</h1><p>Redis çš„å‘å¸ƒ&#x2F;è®¢é˜…ç³»ç»Ÿæ˜¯åŸºäºä¸»é¢˜çš„æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿï¼Œé€‚ç”¨äºå®æ—¶æ¶ˆæ¯é€šçŸ¥åœºæ™¯ï¼š</p><h2 id="1-æ¶ˆæ¯å‘å¸ƒè®¢é˜…åŸç†"><a href="#1-æ¶ˆæ¯å‘å¸ƒè®¢é˜…åŸç†" class="headerlink" title="1. æ¶ˆæ¯å‘å¸ƒè®¢é˜…åŸç†"></a>1. æ¶ˆæ¯å‘å¸ƒè®¢é˜…åŸç†</h2><ul><li><p>Redis å®¢æˆ·ç«¯æ‰§è¡ŒSUBSCRIBEå‘½ä»¤è®¢é˜…é¢‘é“ï¼Œæ¶ˆæ¯å‘å¸ƒæ—¶ Redis å°†æ¶ˆæ¯å‘é€ç»™æ‰€æœ‰è®¢é˜…å®¢æˆ·ç«¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SUBSCRIBE channel1 channel2</span><br></pre></td></tr></table></figure></li><li><p>å®¢æˆ·ç«¯æ‰§è¡ŒPSUBSCRIBEå‘½ä»¤è®¢é˜…æ¨¡å¼åŒ¹é…çš„é¢‘é“ï¼Œæ”¯æŒé€šé…ç¬¦åŒ¹é…å¤šä¸ªé¢‘é“ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PSUBSCRIBE news.*</span><br></pre></td></tr></table></figure></li></ul><h2 id="2-æ¶ˆæ¯ä¼ é€’æµç¨‹"><a href="#2-æ¶ˆæ¯ä¼ é€’æµç¨‹" class="headerlink" title="2. æ¶ˆæ¯ä¼ é€’æµç¨‹"></a>2. æ¶ˆæ¯ä¼ é€’æµç¨‹</h2><ul><li><p>å‘å¸ƒè€…å®¢æˆ·ç«¯è°ƒç”¨PUBLISHå‘½ä»¤å‘æŒ‡å®šé¢‘é“å‘é€æ¶ˆæ¯ï¼ŒRedis éå†åŒ¹é…è®¢é˜…è€…å¹¶ä¼ é€’æ¶ˆæ¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PUBLISH channel1 message</span><br></pre></td></tr></table></figure></li><li><p>Redis çš„å‘å¸ƒ&#x2F;è®¢é˜…ç³»ç»Ÿæ”¯æŒæ¨¡å¼åŒ¹é…å’Œå¤šé¢‘é“è®¢é˜…ï¼Œå…·å¤‡ç®€å•è½»é‡ã€é«˜å®æ—¶æ€§ã€æ¾è€¦åˆã€æŒä¹…åŒ–å¯é€‰ã€æ‰©å±•æ€§å¼ºçš„ç‰¹ç‚¹ï¼Œé€‚ç”¨äºèŠå¤©å®¤ã€å®æ—¶é€šçŸ¥ç­‰åŠŸèƒ½ã€‚</p></li></ul><h1 id="ä¹ã€Redis-åº•å±‚æ•°æ®ç»“æ„"><a href="#ä¹ã€Redis-åº•å±‚æ•°æ®ç»“æ„" class="headerlink" title="ä¹ã€Redis åº•å±‚æ•°æ®ç»“æ„"></a>ä¹ã€Redis åº•å±‚æ•°æ®ç»“æ„</h1><p>Redis çš„åº•å±‚æ•°æ®ç»“æ„åŒ…æ‹¬å‹ç¼©åˆ—è¡¨ã€åŒå‘é“¾è¡¨ã€å­—å…¸ã€è·³è¡¨å’Œæ•´æ•°é›†åˆã€‚æ¯ç§ç»“æ„é’ˆå¯¹ä¸åŒåœºæ™¯ä¼˜åŒ–ï¼š</p><h2 id="1-å‹ç¼©åˆ—è¡¨ï¼ˆZipListï¼‰"><a href="#1-å‹ç¼©åˆ—è¡¨ï¼ˆZipListï¼‰" class="headerlink" title="1. å‹ç¼©åˆ—è¡¨ï¼ˆZipListï¼‰"></a>1. å‹ç¼©åˆ—è¡¨ï¼ˆZipListï¼‰</h2><ul><li>Redis çš„å‹ç¼©åˆ—è¡¨æ˜¯ä¸€ç§å†…å­˜é«˜æ•ˆå­˜å‚¨æ–¹å¼ï¼Œç”¨äºæŒ‰æ’å…¥é¡ºåºå­˜å‚¨é”®å€¼å¯¹é›†åˆã€‚å®ƒé€šè¿‡å‡å°‘æŒ‡é’ˆä½¿ç”¨ï¼Œåœ¨æœ‰é™å†…å­˜ç©ºé—´å†…å­˜å‚¨æ›´å¤šå…ƒç´ ï¼Œæå‡å­˜å‚¨æ•ˆç‡å’Œæ•°æ®è®¿é—®é€Ÿåº¦ã€‚</li><li>å‹ç¼©åˆ—è¡¨é‡‡ç”¨é“¾è¡¨å½¢å¼ï¼Œæ¯ä¸ªèŠ‚ç‚¹å­˜æ•°æ®å’Œä¸‹ä¸€èŠ‚ç‚¹åç§»é‡ã€‚èŠ‚ç‚¹ç´§å¯†æ’åˆ—æ— é—´éš”ï¼Œå…ƒç´ å®šä½éœ€é¡ºåºéå†ï¼Œæ—¶é—´å¤æ‚åº¦ O(n)ã€‚é€‚ç”¨äºå­˜å‚¨æŒ‰æ’å…¥é¡ºåºå­˜å–çš„å°å‹é”®å€¼å¯¹é›†åˆã€‚</li></ul><h2 id="2-åŒå‘é“¾è¡¨ï¼ˆLinkedListï¼‰"><a href="#2-åŒå‘é“¾è¡¨ï¼ˆLinkedListï¼‰" class="headerlink" title="2. åŒå‘é“¾è¡¨ï¼ˆLinkedListï¼‰"></a>2. åŒå‘é“¾è¡¨ï¼ˆLinkedListï¼‰</h2><ul><li>Redis çš„åŒå‘é“¾è¡¨æ˜¯ä¸€ç§çº¿æ€§æ•°æ®ç»“æ„ï¼Œç”¨äºå­˜å‚¨æœ‰åºå…ƒç´ é›†åˆï¼Œæ”¯æŒåŒå‘éå†å’Œå¿«é€Ÿæ’å…¥åˆ é™¤æ“ä½œã€‚å®ƒç”±èŠ‚ç‚¹ç»„æˆï¼Œæ¯ä¸ªèŠ‚ç‚¹åŒ…å«æŒ‡å‘å‰é©±å’Œåç»§èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œå¯é€šè¿‡æŒ‡é’ˆåŒå‘éå†ï¼Œæ’å…¥åˆ é™¤æ—¶é—´å¤æ‚åº¦ O(1)ã€‚</li><li>åŒå‘é“¾è¡¨å†…å­˜å ç”¨è¾ƒé«˜ï¼Œé€‚ç”¨äºéœ€é¢‘ç¹æ’å…¥åˆ é™¤å…ƒç´ ä¸”é¡ºåºè®¿é—®çš„åœºæ™¯ï¼Œå¦‚æ¶ˆæ¯é˜Ÿåˆ—å’Œä»»åŠ¡é˜Ÿåˆ—ã€‚</li></ul><h2 id="2-å­—å…¸ï¼ˆDictionaryï¼‰"><a href="#2-å­—å…¸ï¼ˆDictionaryï¼‰" class="headerlink" title="2. å­—å…¸ï¼ˆDictionaryï¼‰"></a>2. å­—å…¸ï¼ˆDictionaryï¼‰</h2><ul><li>Redis çš„å­—å…¸æ˜¯ä¸€ç§å“ˆå¸Œè¡¨ç»“æ„ï¼Œç”¨äºå­˜å‚¨é”®å€¼å¯¹é›†åˆï¼Œæ”¯æŒå¹³å‡æ—¶é—´å¤æ‚åº¦ O(1) çš„æ•°æ®å­˜å–ã€‚å®ƒé€šè¿‡å“ˆå¸Œå‡½æ•°å°†é”®æ˜ å°„è‡³æ•°ç»„ç´¢å¼•ï¼Œå¤„ç†å“ˆå¸Œå†²çªé‡‡ç”¨é“¾åœ°å€æ³•ã€‚</li><li>å­—å…¸åŠ¨æ€æ‰©å®¹ï¼Œè´Ÿè½½å› å­è¾¾ä¸Šé™è‡ªåŠ¨æ‰©å±•ï¼Œé€‚ç”¨äºå­˜å‚¨å¤§é‡é”®å€¼å¯¹åœºæ™¯ï¼Œå¦‚ç¼“å­˜å’Œé…ç½®ç®¡ç†ã€‚</li></ul><h2 id="3-è·³è¡¨ï¼ˆSkipListï¼‰"><a href="#3-è·³è¡¨ï¼ˆSkipListï¼‰" class="headerlink" title="3. è·³è¡¨ï¼ˆSkipListï¼‰"></a>3. è·³è¡¨ï¼ˆSkipListï¼‰</h2><ul><li>Redis çš„è·³è¡¨æ˜¯ä¸€ç§åŸºäºæ•°ç»„å’Œé“¾è¡¨çš„æ•°æ®ç»“æ„ï¼Œç”¨äºå­˜å‚¨æœ‰åºå…ƒç´ é›†åˆï¼Œæ”¯æŒé«˜æ•ˆæŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤æ“ä½œã€‚å®ƒç”±å¤šå±‚é“¾è¡¨æ„æˆï¼Œåº•å±‚é“¾è¡¨å­˜å‚¨æ‰€æœ‰å…ƒç´ ï¼Œä¸Šå±‚é“¾è¡¨åŠ é€ŸæŸ¥æ‰¾ã€‚</li><li>è·³è¡¨æŸ¥æ‰¾æ—¶é—´å¤æ‚åº¦ O(log n)ï¼Œæ’å…¥åˆ é™¤ O(log n)ï¼Œå†…å­˜å ç”¨è¾ƒé«˜ä½†æ“ä½œæ•ˆç‡ç¨³å®šï¼Œé€‚ç”¨äºå­˜å‚¨æœ‰åºé›†åˆåœºæ™¯ï¼Œå¦‚æ’è¡Œæ¦œã€‚</li></ul><h2 id="4-æ•´æ•°é›†åˆï¼ˆIntSetï¼‰"><a href="#4-æ•´æ•°é›†åˆï¼ˆIntSetï¼‰" class="headerlink" title="4. æ•´æ•°é›†åˆï¼ˆIntSetï¼‰"></a>4. æ•´æ•°é›†åˆï¼ˆIntSetï¼‰</h2><ul><li>Redis çš„æ•´æ•°é›†åˆæ˜¯ä¸€ç§å­˜å‚¨æ•´æ•°é›†åˆçš„ç´§å‡‘æ•°ç»„ç»“æ„ï¼ŒæŒ‰å‡åºæ’åˆ—ï¼Œæ”¯æŒé«˜æ•ˆå­˜å‚¨å’Œå¿«é€ŸæŸ¥æ‰¾ã€‚åˆå§‹ç±»å‹ä¸º int16_tï¼Œéšå…ƒç´ å¢å¤§è‡ªåŠ¨å‡çº§è‡³ int32_t æˆ– int64_tã€‚</li><li>æ•´æ•°é›†åˆé€‚ç”¨äºå­˜å‚¨æ•´æ•°é›†åˆåœºæ™¯ï¼Œå¦‚æ ‡ç­¾ç³»ç»Ÿå’Œæƒé™ç®¡ç†ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¢è¯• </tag>
            
            <tag> redis </tag>
            
            <tag> redisé¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>redisé—®é¢˜æ’æŸ¥</title>
      <link href="/posts/c35b050e.html"/>
      <url>/posts/c35b050e.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€å¸¸è§é—®é¢˜ç±»å‹åŠæ’æŸ¥æ–¹æ³•"><a href="#ä¸€ã€å¸¸è§é—®é¢˜ç±»å‹åŠæ’æŸ¥æ–¹æ³•" class="headerlink" title="ä¸€ã€å¸¸è§é—®é¢˜ç±»å‹åŠæ’æŸ¥æ–¹æ³•"></a>ä¸€ã€å¸¸è§é—®é¢˜ç±»å‹åŠæ’æŸ¥æ–¹æ³•</h1><h2 id="1-æ€§èƒ½é—®é¢˜"><a href="#1-æ€§èƒ½é—®é¢˜" class="headerlink" title="1.æ€§èƒ½é—®é¢˜"></a>1.æ€§èƒ½é—®é¢˜</h2><p>è¡¨ç° ï¼šRedis å“åº”å˜æ…¢ï¼Œå»¶è¿Ÿå¢åŠ ï¼Œå¯èƒ½ä¼šå¯¼è‡´å®¢æˆ·ç«¯æ“ä½œè¶…æ—¶ã€‚<br>æ’æŸ¥æ­¥éª¤</p><ol><li>ä½¿ç”¨redis-cli â€“latencyå‘½ä»¤æ£€æµ‹ Redis æœåŠ¡å™¨çš„å»¶è¿Ÿæƒ…å†µï¼Œè¯¥å‘½ä»¤ä¼šæŒç»­å‘é€ PING å‘½ä»¤å¹¶æµ‹é‡å¾€è¿”æ—¶é—´ã€‚</li><li>æŸ¥çœ‹ Redis æœåŠ¡å™¨çš„ CPU å’Œå†…å­˜ä½¿ç”¨ç‡ï¼Œå¯é€šè¿‡æ“ä½œç³»ç»Ÿè‡ªå¸¦çš„å·¥å…·ï¼ˆå¦‚top&#96;&#96;htopå‘½ä»¤ï¼‰æˆ– Redis æä¾›çš„INFO SERVERå‘½ä»¤è·å–ç›¸å…³ä¿¡æ¯ã€‚</li><li>æ£€æŸ¥ Redis æ˜¯å¦å­˜åœ¨æ…¢æŸ¥è¯¢æ“ä½œï¼Œä½¿ç”¨SLOWLOG GETå‘½ä»¤æŸ¥çœ‹æœ€è¿‘æ‰§è¡Œçš„æ…¢æŸ¥è¯¢è®°å½•ï¼Œåˆ†ææ…¢æŸ¥è¯¢çš„åŸå› å¹¶è¿›è¡Œä¼˜åŒ–ã€‚</li></ol><h2 id="2-æ•°æ®é—®é¢˜"><a href="#2-æ•°æ®é—®é¢˜" class="headerlink" title="2.æ•°æ®é—®é¢˜"></a>2.æ•°æ®é—®é¢˜</h2><p>è¡¨ç° ï¼šæ•°æ®ä¸¢å¤±ã€æ•°æ®ä¸ä¸€è‡´ç­‰ï¼Œæ¯”å¦‚å®¢æˆ·ç«¯å†™å…¥çš„æ•°æ®æ— æ³•æ­£ç¡®è¯»å–ï¼Œæˆ–è€…ä¸»ä»èŠ‚ç‚¹ä¹‹é—´çš„æ•°æ®ä¸ä¸€è‡´ã€‚<br>æ’æŸ¥æ­¥éª¤</p><ol><li>æ£€æŸ¥ Redis çš„æŒä¹…åŒ–é…ç½®æ˜¯å¦æ­£ç¡®ã€‚å¯¹äº RDB æŒä¹…åŒ–ï¼ŒæŸ¥çœ‹é…ç½®æ–‡ä»¶ä¸­çš„saveé€‰é¡¹æ˜¯å¦åˆç†è®¾ç½®ï¼›å¯¹äº AOF æŒä¹…åŒ–ï¼Œæ£€æŸ¥appendonlyé€‰é¡¹æ˜¯å¦å¼€å¯ä»¥åŠappendfsyncé€‰é¡¹çš„é…ç½®æ˜¯å¦åˆé€‚ã€‚</li><li>å¯¹äºä¸»ä»å¤åˆ¶åœºæ™¯ï¼Œä½¿ç”¨INFO REPLICATIONå‘½ä»¤æŸ¥çœ‹ä¸»ä»èŠ‚ç‚¹çš„å¤åˆ¶çŠ¶æ€ï¼Œæ£€æŸ¥ä»èŠ‚ç‚¹æ˜¯å¦æ­£ç¡®è¿æ¥åˆ°ä¸»èŠ‚ç‚¹ï¼Œä»¥åŠå¤åˆ¶çš„è¿›åº¦å’Œå»¶è¿Ÿæƒ…å†µã€‚åŒæ—¶ï¼Œå¯ä»¥åœ¨ä»èŠ‚ç‚¹ä¸Šæ‰§è¡ŒSLAVEOF NO ONEå‘½ä»¤ï¼Œä½¿å…¶æš‚æ—¶è„±ç¦»ä¸»èŠ‚ç‚¹ï¼Œç„¶åæ£€æŸ¥ä»èŠ‚ç‚¹çš„æ•°æ®æ˜¯å¦å®Œæ•´ã€‚</li></ol><h1 id="äºŒã€æ—¥å¿—åˆ†æ"><a href="#äºŒã€æ—¥å¿—åˆ†æ" class="headerlink" title="äºŒã€æ—¥å¿—åˆ†æ"></a>äºŒã€æ—¥å¿—åˆ†æ</h1><ol><li>æ—¥å¿—ä½ç½® ï¼šRedis çš„æ—¥å¿—é€šå¸¸ä½äº Redis æœåŠ¡å™¨çš„å®‰è£…ç›®å½•ä¸‹ï¼Œæˆ–è€…æ ¹æ®é…ç½®æ–‡ä»¶ä¸­çš„logfileé€‰é¡¹æŒ‡å®šçš„è·¯å¾„ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ—¥å¿—å¯èƒ½è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºï¼ˆåœ¨å‰å°è¿è¡Œæ—¶ï¼‰æˆ–ç³»ç»Ÿæ—¥å¿—ï¼ˆåœ¨åå°è¿è¡Œæ—¶ï¼‰ã€‚</li><li>æ—¥å¿—çº§åˆ« ï¼šRedis æä¾›äº†ä¸åŒçš„æ—¥å¿—çº§åˆ«ï¼ŒåŒ…æ‹¬debug<code>verbose</code>notice&#96;&#96;warningç­‰ã€‚åœ¨æ’æŸ¥é—®é¢˜æ—¶ï¼Œå¯ä»¥ä¸´æ—¶å°†æ—¥å¿—çº§åˆ«è®¾ç½®ä¸ºæ›´è¯¦ç»†çš„çº§åˆ«ï¼ˆå¦‚debugï¼‰ï¼Œä»¥ä¾¿è·å–æ›´å¤šçš„è°ƒè¯•ä¿¡æ¯ã€‚</li><li>æ—¥å¿—å†…å®¹åˆ†æ ï¼šæŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ä¸­çš„é”™è¯¯ä¿¡æ¯ã€è­¦å‘Šä¿¡æ¯ä»¥åŠå®¢æˆ·ç«¯çš„è¿æ¥å’Œæ“ä½œè®°å½•ç­‰ã€‚ä¾‹å¦‚ï¼Œæ—¥å¿—ä¸­å¯èƒ½ä¼šè®°å½•å®¢æˆ·ç«¯çš„ IP åœ°å€ã€ç«¯å£å·ã€æ‰§è¡Œçš„å‘½ä»¤ã€é”™è¯¯ä»£ç å’Œæè¿°ç­‰ä¿¡æ¯ï¼Œé€šè¿‡åˆ†æè¿™äº›å†…å®¹å¯ä»¥å¸®åŠ©å®šä½é—®é¢˜ã€‚</li></ol><h1 id="ä¸‰ã€ä½¿ç”¨ç›‘æ§å·¥å…·"><a href="#ä¸‰ã€ä½¿ç”¨ç›‘æ§å·¥å…·" class="headerlink" title="ä¸‰ã€ä½¿ç”¨ç›‘æ§å·¥å…·"></a>ä¸‰ã€ä½¿ç”¨ç›‘æ§å·¥å…·</h1><ol><li>Redis è‡ªå¸¦çš„ç›‘æ§å·¥å…·</li></ol><ul><li>redis-cliï¼šé™¤äº†ç”¨äºæ‰§è¡Œ Redis å‘½ä»¤å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡redis-cli â€“statå‘½ä»¤å®æ—¶ç›‘æ§ Redis æœåŠ¡å™¨çš„åŸºæœ¬ç»Ÿè®¡ä¿¡æ¯ï¼Œå¦‚å†…å­˜ä½¿ç”¨é‡ã€å®¢æˆ·ç«¯è¿æ¥æ•°ã€å‘½ä»¤æ‰§è¡Œæ¬¡æ•°ç­‰ã€‚</li><li>redis-benchmarkï¼šç”¨äºæµ‹è¯• Redis æœåŠ¡å™¨çš„æ€§èƒ½ï¼Œæ¨¡æ‹Ÿå¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶å‘é€è¯·æ±‚ï¼Œæµ‹é‡ Redis çš„ååé‡ï¼ˆæ¯ç§’å¤„ç†çš„è¯·æ±‚æ•°ï¼‰å’Œå»¶è¿Ÿã€‚å¯ä»¥é€šè¿‡è°ƒæ•´æµ‹è¯•çš„å‚æ•°ï¼ˆå¦‚å¹¶å‘æ•°ã€è¯·æ±‚ç±»å‹ç­‰ï¼‰æ¥è¯„ä¼° Redis åœ¨ä¸åŒè´Ÿè½½ä¸‹çš„æ€§èƒ½è¡¨ç°ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¢è¯• </tag>
            
            <tag> redis </tag>
            
            <tag> redisé¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>redis ç¼“å­˜ç©¿é€ã€ç¼“å­˜é›ªå´©å’Œç¼“å­˜å‡»ç©¿è¯¦è§£</title>
      <link href="/posts/1c152689.html"/>
      <url>/posts/1c152689.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€ç¼“å­˜ç©¿é€"><a href="#ä¸€ã€ç¼“å­˜ç©¿é€" class="headerlink" title="ä¸€ã€ç¼“å­˜ç©¿é€"></a>ä¸€ã€ç¼“å­˜ç©¿é€</h1><h2 id="1-1-å®šä¹‰"><a href="#1-1-å®šä¹‰" class="headerlink" title="1.1 å®šä¹‰"></a>1.1 å®šä¹‰</h2><p>ç¼“å­˜ç©¿é€æ˜¯æŒ‡å®¢æˆ·ç«¯è¯·æ±‚çš„æ•°æ®æ—¢ä¸åœ¨ç¼“å­˜ä¸­ï¼Œä¹Ÿä¸åœ¨æ•°æ®åº“ä¸­ã€‚æ¯æ¬¡è¯·æ±‚éƒ½ä¼šç›´æ¥è®¿é—®æ•°æ®åº“ï¼Œå¯¼è‡´æ•°æ®åº“å‹åŠ›å¢å¤§ã€‚<br>è¿™ç§æƒ…å†µé€šå¸¸å‘ç”Ÿåœ¨æ¶æ„æ”»å‡»æˆ–æ•°æ®ä¸å­˜åœ¨æ—¶ã€‚</p><h2 id="1-2-åŸå› "><a href="#1-2-åŸå› " class="headerlink" title="1.2 åŸå› "></a>1.2 åŸå› </h2><ul><li>æ•°æ®ä¸å­˜åœ¨ï¼šè¯·æ±‚çš„æ•°æ®ä»æœªè¢«åˆ›å»ºæˆ–å·²è¢«åˆ é™¤ã€‚</li><li>æ¶æ„æ”»å‡»ï¼šå®¢æˆ·ç«¯æ•…æ„è¯·æ±‚ä¸å­˜åœ¨çš„æ•°æ®ï¼Œå¯¼è‡´å¤§é‡è¯·æ±‚ç›´æ¥è®¿é—®æ•°æ®åº“ã€‚</li></ul><h2 id="1-3-å½±å“"><a href="#1-3-å½±å“" class="headerlink" title="1.3 å½±å“"></a>1.3 å½±å“</h2><ul><li>æ•°æ®åº“å‹åŠ›å¢å¤§ï¼šå¤§é‡è¯·æ±‚ç›´æ¥è®¿é—®æ•°æ®åº“ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®åº“è¿‡è½½ã€‚</li><li>ç³»ç»Ÿæ€§èƒ½ä¸‹é™ï¼šå“åº”æ—¶é—´å¢åŠ ï¼Œç”¨æˆ·ä½“éªŒå˜å·®ã€‚</li></ul><h2 id="1-4-è§£å†³æ–¹æ³•"><a href="#1-4-è§£å†³æ–¹æ³•" class="headerlink" title="1.4 è§£å†³æ–¹æ³•"></a>1.4 è§£å†³æ–¹æ³•</h2><h3 id="1-4-1-å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆBloom-Filterï¼‰"><a href="#1-4-1-å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆBloom-Filterï¼‰" class="headerlink" title="1.4.1 å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆBloom Filterï¼‰"></a>1.4.1 å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆBloom Filterï¼‰</h3><p>ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨åˆ¤æ–­æ•°æ®æ˜¯å¦å­˜åœ¨ï¼Œé¿å…æŸ¥è¯¢ä¸å­˜åœ¨çš„æ•°æ®ã€‚éœ€è¦å®‰è£…RedisBloomæ¨¡å—<br>ç¤ºä¾‹æµç¨‹ï¼š</p><ol><li>å°†æ‰€æœ‰å­˜åœ¨çš„æ•°æ®é”®å­˜å‚¨åœ¨å¸ƒéš†è¿‡æ»¤å™¨ä¸­ã€‚</li><li>å®¢æˆ·ç«¯è¯·æ±‚æ•°æ®æ—¶ï¼Œå…ˆé€šè¿‡å¸ƒéš†è¿‡æ»¤å™¨åˆ¤æ–­æ•°æ®æ˜¯å¦å­˜åœ¨ã€‚</li><li>å¦‚æœå¸ƒéš†è¿‡æ»¤å™¨è¿”å›ä¸å­˜åœ¨ï¼Œåˆ™ç›´æ¥è¿”å›ç©ºç»“æœï¼Œä¸æŸ¥è¯¢æ•°æ®åº“ã€‚</li></ol><h3 id="1-4-2-ç¼“å­˜ç©ºå€¼"><a href="#1-4-2-ç¼“å­˜ç©ºå€¼" class="headerlink" title="1.4.2 ç¼“å­˜ç©ºå€¼"></a>1.4.2 ç¼“å­˜ç©ºå€¼</h3><p>å°†ä¸å­˜åœ¨çš„æ•°æ®ä¹Ÿç¼“å­˜ä¸€æ®µæ—¶é—´ï¼Œé¿å…é‡å¤æŸ¥è¯¢ã€‚  </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_data_with_empty_cache</span>(<span class="params"><span class="variable">$key</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$data</span> = redis-&gt;<span class="title function_ invoke__">get</span>(<span class="variable">$key</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$data</span> === <span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="variable">$data</span> = <span class="title function_ invoke__">db_get_data</span>(<span class="variable">$key</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$data</span> === <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// ç¼“å­˜ç©ºå€¼ï¼Œè®¾ç½®è¾ƒçŸ­çš„è¿‡æœŸæ—¶é—´</span></span><br><span class="line">            redis-&gt;<span class="title function_ invoke__">setex</span>(<span class="variable">$key</span>, <span class="number">60</span>, <span class="string">&quot;NULL&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        redis-&gt;<span class="title function_ invoke__">setex</span>(<span class="variable">$key</span>, <span class="number">300</span>, <span class="variable">$data</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$data</span> === <span class="string">&quot;NULL&quot;</span> ? <span class="literal">null</span> : <span class="variable">$data</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="äºŒã€ç¼“å­˜é›ªå´©"><a href="#äºŒã€ç¼“å­˜é›ªå´©" class="headerlink" title="äºŒã€ç¼“å­˜é›ªå´©"></a>äºŒã€ç¼“å­˜é›ªå´©</h2><h2 id="2-1-å®šä¹‰"><a href="#2-1-å®šä¹‰" class="headerlink" title="2.1 å®šä¹‰"></a>2.1 å®šä¹‰</h2><p>ç¼“å­˜é›ªå´©æ˜¯æŒ‡å¤§é‡ç¼“å­˜æ•°æ®åœ¨åŒä¸€æ—¶é—´è¿‡æœŸï¼Œå¯¼è‡´å¤§é‡è¯·æ±‚åŒæ—¶è®¿é—®æ•°æ®åº“ï¼Œå¯¹æ•°æ®åº“é€ æˆå·¨å¤§å‹åŠ›ã€‚</p><h2 id="2-2-åŸå› "><a href="#2-2-åŸå› " class="headerlink" title="2.2 åŸå› "></a>2.2 åŸå› </h2><ul><li>ç¼“å­˜è¿‡æœŸæ—¶é—´ç›¸åŒï¼šå¤šä¸ªç¼“å­˜é”®è®¾ç½®ç›¸åŒçš„è¿‡æœŸæ—¶é—´ï¼Œå¯¼è‡´åŒæ—¶å¤±æ•ˆã€‚</li><li>ç³»ç»Ÿæ•…éšœï¼šRedis æœåŠ¡é‡å¯æˆ–æ•…éšœæ¢å¤åï¼Œæ‰€æœ‰ç¼“å­˜å¤±æ•ˆã€‚</li></ul><h2 id="2-3-å½±å“"><a href="#2-3-å½±å“" class="headerlink" title="2.3 å½±å“"></a>2.3 å½±å“</h2><ul><li>æ•°æ®åº“å‹åŠ›éª¤å¢ï¼šå¤§é‡è¯·æ±‚åŒæ—¶è®¿é—®æ•°æ®åº“ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®åº“å´©æºƒã€‚</li><li>ç³»ç»Ÿå“åº”å»¶è¿Ÿï¼šç”¨æˆ·è¯·æ±‚å“åº”æ—¶é—´å¢åŠ ã€‚</li></ul><h2 id="2-4-è§£å†³æ–¹æ³•"><a href="#2-4-è§£å†³æ–¹æ³•" class="headerlink" title="2.4 è§£å†³æ–¹æ³•"></a>2.4 è§£å†³æ–¹æ³•</h2><h3 id="2-4-1-è®¾ç½®éšæœºè¿‡æœŸæ—¶é—´"><a href="#2-4-1-è®¾ç½®éšæœºè¿‡æœŸæ—¶é—´" class="headerlink" title="2.4.1 è®¾ç½®éšæœºè¿‡æœŸæ—¶é—´"></a>2.4.1 è®¾ç½®éšæœºè¿‡æœŸæ—¶é—´</h3><p>ä¸ºç¼“å­˜é”®è®¾ç½®ä¸åŒçš„è¿‡æœŸæ—¶é—´ï¼Œé¿å…åŒæ—¶å¤±æ•ˆã€‚  </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">set_data_with_random_expiry</span>(<span class="params"><span class="variable">$key</span>, <span class="variable">$data</span>, <span class="variable">$base_expiry</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$random_expiry</span> = <span class="variable">$base_expiry</span> + <span class="title function_ invoke__">rand</span>(<span class="number">0</span>, <span class="number">100</span>); <span class="comment">// éšæœºå¢åŠ  0-100 ç§’</span></span><br><span class="line">    redis-&gt;<span class="title function_ invoke__">setex</span>(<span class="variable">$key</span>, <span class="variable">$random_expiry</span>, <span class="variable">$data</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-4-2-ç¼“å­˜é¢„çƒ­"><a href="#2-4-2-ç¼“å­˜é¢„çƒ­" class="headerlink" title="2.4.2 ç¼“å­˜é¢„çƒ­"></a>2.4.2 ç¼“å­˜é¢„çƒ­</h2><p>åœ¨ç¼“å­˜å¤±æ•ˆå‰ï¼Œæå‰åˆ·æ–°ç¼“å­˜ã€‚  </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_data_with_preheat</span>(<span class="params"><span class="variable">$key</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$data</span> = redis-&gt;<span class="title function_ invoke__">get</span>(<span class="variable">$key</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$data</span> === <span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="variable">$data</span> = <span class="title function_ invoke__">db_get_data</span>(<span class="variable">$key</span>);</span><br><span class="line">        redis-&gt;<span class="title function_ invoke__">setex</span>(<span class="variable">$key</span>, <span class="number">300</span>, <span class="variable">$data</span>);</span><br><span class="line">    &#125; <span class="keyword">elseif</span> (<span class="title function_ invoke__">rand</span>(<span class="number">1</span>, <span class="number">100</span>) &lt;= <span class="number">10</span>) &#123; <span class="comment">// 10% çš„æ¦‚ç‡æå‰åˆ·æ–°ç¼“å­˜</span></span><br><span class="line">        <span class="title function_ invoke__">go</span>(function () <span class="keyword">use</span> ($<span class="title">key</span>) &#123;</span><br><span class="line">            $<span class="title">data</span> = <span class="title">db_get_data</span>($<span class="title">key</span>);</span><br><span class="line">            redis-&gt;<span class="title function_ invoke__">setex</span>(<span class="variable">$key</span>, <span class="number">300</span>, <span class="variable">$data</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$data</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€ç¼“å­˜å‡»ç©¿"><a href="#ä¸‰ã€ç¼“å­˜å‡»ç©¿" class="headerlink" title="ä¸‰ã€ç¼“å­˜å‡»ç©¿"></a>ä¸‰ã€ç¼“å­˜å‡»ç©¿</h1><h2 id="3-1-å®šä¹‰"><a href="#3-1-å®šä¹‰" class="headerlink" title="3.1 å®šä¹‰"></a>3.1 å®šä¹‰</h2><p>ç¼“å­˜å‡»ç©¿æ˜¯æŒ‡çƒ­ç‚¹æ•°æ®çš„ç¼“å­˜è¿‡æœŸåï¼Œå¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶è¯·æ±‚è¯¥æ•°æ®ï¼Œå¯¼è‡´è¿™äº›è¯·æ±‚éƒ½å‡»ç©¿ç¼“å­˜ï¼Œç›´æ¥è®¿é—®æ•°æ®åº“ã€‚</p><h2 id="3-2-åŸå› "><a href="#3-2-åŸå› " class="headerlink" title="3.2 åŸå› "></a>3.2 åŸå› </h2><ul><li>çƒ­ç‚¹æ•°æ®è¿‡æœŸï¼šè®¿é—®é¢‘ç‡æé«˜çš„æ•°æ®ç¼“å­˜è¿‡æœŸã€‚</li><li>é«˜å¹¶å‘è¯·æ±‚ï¼šå¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶è¯·æ±‚åŒä¸€ä¸ªçƒ­ç‚¹æ•°æ®ã€‚</li></ul><h2 id="3-3-å½±å“"><a href="#3-3-å½±å“" class="headerlink" title="3.3 å½±å“"></a>3.3 å½±å“</h2><ul><li>æ•°æ®åº“å‹åŠ›å¢å¤§ï¼šå¤§é‡è¯·æ±‚ç›´æ¥è®¿é—®æ•°æ®åº“ã€‚</li><li>å“åº”å»¶è¿Ÿï¼šç”¨æˆ·è¯·æ±‚å“åº”æ—¶é—´å¢åŠ ã€‚</li></ul><h2 id="3-4-è§£å†³æ–¹æ³•"><a href="#3-4-è§£å†³æ–¹æ³•" class="headerlink" title="3.4 è§£å†³æ–¹æ³•"></a>3.4 è§£å†³æ–¹æ³•</h2><h3 id="3-4-1-äº’æ–¥é”ï¼ˆMutex-Lockï¼‰"><a href="#3-4-1-äº’æ–¥é”ï¼ˆMutex-Lockï¼‰" class="headerlink" title="3.4.1 äº’æ–¥é”ï¼ˆMutex Lockï¼‰"></a>3.4.1 äº’æ–¥é”ï¼ˆMutex Lockï¼‰</h3><p>ä½¿ç”¨äº’æ–¥é”ç¡®ä¿åªæœ‰ä¸€ä¸ªå®¢æˆ·ç«¯æ›´æ–°ç¼“å­˜ï¼Œå…¶ä»–å®¢æˆ·ç«¯ç­‰å¾…ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_data_with_mutex</span>(<span class="params"><span class="variable">$key</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$lock_key</span> = <span class="variable">$key</span> . <span class="string">&quot;_lock&quot;</span>;</span><br><span class="line">    <span class="variable">$lock_acquired</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">while</span> (!<span class="variable">$lock_acquired</span>) &#123;</span><br><span class="line">        <span class="variable">$lock_acquired</span> = (<span class="keyword">bool</span>)redis-&gt;<span class="title function_ invoke__">setnx</span>(<span class="variable">$lock_key</span>, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$lock_acquired</span>) &#123;</span><br><span class="line">            redis-&gt;<span class="title function_ invoke__">expire</span>(<span class="variable">$lock_key</span>, <span class="number">30</span>); <span class="comment">// è®¾ç½®é”çš„è¿‡æœŸæ—¶é—´</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="title function_ invoke__">usleep</span>(<span class="number">100</span>); <span class="comment">// çŸ­æš‚ç­‰å¾…åé‡è¯•</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$data</span> = redis-&gt;<span class="title function_ invoke__">get</span>(<span class="variable">$key</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$data</span> === <span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="variable">$data</span> = <span class="title function_ invoke__">db_get_data</span>(<span class="variable">$key</span>);</span><br><span class="line">        redis-&gt;<span class="title function_ invoke__">setex</span>(<span class="variable">$key</span>, <span class="number">300</span>, <span class="variable">$data</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    redis-&gt;<span class="title function_ invoke__">del</span>(<span class="variable">$lock_key</span>); <span class="comment">// é‡Šæ”¾é”</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$data</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-4-2-å†—ä½™ç¼“å­˜"><a href="#3-4-2-å†—ä½™ç¼“å­˜" class="headerlink" title="3.4.2 å†—ä½™ç¼“å­˜"></a>3.4.2 å†—ä½™ç¼“å­˜</h3><p>è®¾ç½®ä¸¤ä¸ªç¼“å­˜é”®ï¼Œä¸€ä¸ªç”¨äºæ•°æ®å­˜å‚¨ï¼Œä¸€ä¸ªç”¨äºè¿‡æœŸæ£€æµ‹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_data_with_redundant_cache</span>(<span class="params"><span class="variable">$key</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$check_key</span> = <span class="variable">$key</span> . <span class="string">&quot;_check&quot;</span>;</span><br><span class="line">    <span class="variable">$data</span> = redis-&gt;<span class="title function_ invoke__">get</span>(<span class="variable">$key</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$data</span> === <span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (redis-&gt;<span class="title function_ invoke__">ttl</span>(<span class="variable">$check_key</span>) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="variable">$data</span> = <span class="title function_ invoke__">db_get_data</span>(<span class="variable">$key</span>);</span><br><span class="line">            redis-&gt;<span class="title function_ invoke__">setex</span>(<span class="variable">$key</span>, <span class="number">300</span>, <span class="variable">$data</span>);</span><br><span class="line">            redis-&gt;<span class="title function_ invoke__">setex</span>(<span class="variable">$check_key</span>, <span class="number">290</span>, <span class="number">1</span>); <span class="comment">// è®¾ç½®è¾ƒçŸ­çš„è¿‡æœŸæ—¶é—´</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>; <span class="comment">// è¿”å›ç©ºç»“æœ</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$data</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å››ã€ä¸‰ç§é—®é¢˜çš„åŒºåˆ«"><a href="#å››ã€ä¸‰ç§é—®é¢˜çš„åŒºåˆ«" class="headerlink" title="å››ã€ä¸‰ç§é—®é¢˜çš„åŒºåˆ«"></a>å››ã€ä¸‰ç§é—®é¢˜çš„åŒºåˆ«</h3><table><thead><tr><th>é—®é¢˜</th><th>å®šä¹‰</th><th>åŸå› </th><th>è§£å†³æ–¹æ³•</th></tr></thead><tbody><tr><td>ç¼“å­˜ç©¿é€</td><td>è¯·æ±‚çš„æ•°æ®æ—¢ä¸åœ¨ç¼“å­˜ä¸­ï¼Œä¹Ÿä¸åœ¨æ•°æ®åº“ä¸­</td><td>æ•°æ®ä¸å­˜åœ¨æˆ–æ¶æ„æ”»å‡»</td><td>å¸ƒéš†è¿‡æ»¤å™¨ã€ç¼“å­˜ç©ºå€¼</td></tr><tr><td>ç¼“å­˜é›ªå´©</td><td>å¤§é‡ç¼“å­˜æ•°æ®åœ¨åŒä¸€æ—¶é—´è¿‡æœŸ</td><td>ç¼“å­˜è¿‡æœŸæ—¶é—´ç›¸åŒæˆ–ç³»ç»Ÿæ•…éšœ</td><td>è®¾ç½®éšæœºè¿‡æœŸæ—¶é—´ã€ç¼“å­˜é¢„çƒ­</td></tr><tr><td>ç¼“å­˜å‡»ç©¿</td><td>çƒ­ç‚¹æ•°æ®çš„ç¼“å­˜è¿‡æœŸåï¼Œå¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶è¯·æ±‚è¯¥æ•°æ®</td><td>çƒ­ç‚¹æ•°æ®è¿‡æœŸä¸”é«˜å¹¶å‘è¯·æ±‚</td><td>äº’æ–¥é”ã€å†—ä½™ç¼“å­˜</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¢è¯• </tag>
            
            <tag> redis </tag>
            
            <tag> redisé¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¸¸ç”¨è®¾è®¡æ¨¡å¼</title>
      <link href="/posts/1e80ad29.html"/>
      <url>/posts/1e80ad29.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€å•ä¾‹æ¨¡å¼-Singleton"><a href="#ä¸€ã€å•ä¾‹æ¨¡å¼-Singleton" class="headerlink" title="ä¸€ã€å•ä¾‹æ¨¡å¼ (Singleton):"></a>ä¸€ã€å•ä¾‹æ¨¡å¼ (Singleton):</h1><p>ç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹ã€‚é€‚ç”¨äºéœ€è¦å…¨å±€ç®¡ç†çš„èµ„æºï¼ˆå¦‚æ•°æ®åº“è¿æ¥ï¼‰ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$instance</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getInstance</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">self</span>::<span class="variable">$instance</span> == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="built_in">self</span>::<span class="variable">$instance</span> = <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">self</span>::<span class="variable">$instance</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="äºŒã€å·¥å‚æ¨¡å¼-Factory"><a href="#äºŒã€å·¥å‚æ¨¡å¼-Factory" class="headerlink" title="äºŒã€å·¥å‚æ¨¡å¼ (Factory):"></a>äºŒã€å·¥å‚æ¨¡å¼ (Factory):</h1><p>ç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸ªç±»ã€‚é€‚ç”¨äºæœ‰å¤šä¸ªç›¸å…³ç±»çš„æƒ…å†µã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getName</span>(<span class="params"></span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProductA</span> <span class="keyword">implements</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Product A&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProductB</span> <span class="keyword">implements</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Product B&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProductFactory</span> </span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">create</span>(<span class="params"><span class="variable">$type</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$type</span> == <span class="string">&#x27;A&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title function_ invoke__">ProductA</span>();</span><br><span class="line">    &#125; <span class="keyword">elseif</span> (<span class="variable">$type</span> == <span class="string">&#x27;B&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title function_ invoke__">ProductB</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;Unknown product type.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€è§‚å¯Ÿè€…æ¨¡å¼-Observer"><a href="#ä¸‰ã€è§‚å¯Ÿè€…æ¨¡å¼-Observer" class="headerlink" title="ä¸‰ã€è§‚å¯Ÿè€…æ¨¡å¼ (Observer):"></a>ä¸‰ã€è§‚å¯Ÿè€…æ¨¡å¼ (Observer):</h1><p>å®šä¹‰ä¸€ä¸ªä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œè®©å¤šä¸ªè§‚å¯Ÿè€…å¯¹è±¡åŒæ—¶ç›‘å¬ä¸€ä¸ªä¸»é¢˜å¯¹è±¡ï¼Œä»¥ä¾¿ä¸»é¢˜å¯¹è±¡çŠ¶æ€æ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½å¾—åˆ°é€šçŸ¥ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Subject</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="variable">$observers</span> = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">attach</span>(<span class="params"><span class="variable">$observer</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;observers[] = <span class="variable">$observer</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">notify</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable language_">$this</span>-&gt;observers <span class="keyword">as</span> <span class="variable">$observer</span>) &#123;</span><br><span class="line">            <span class="variable">$observer</span>-&gt;<span class="title function_ invoke__">update</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Observer updated!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å››ã€ç­–ç•¥æ¨¡å¼-Strategy"><a href="#å››ã€ç­–ç•¥æ¨¡å¼-Strategy" class="headerlink" title="å››ã€ç­–ç•¥æ¨¡å¼ (Strategy):"></a>å››ã€ç­–ç•¥æ¨¡å¼ (Strategy):</h1><p>å®šä¹‰ä¸€ç³»åˆ—ç®—æ³•ï¼Œå°†æ¯ä¸ªç®—æ³•å°è£…èµ·æ¥ï¼Œå¹¶ä½¿å®ƒä»¬å¯ä»¥äº’æ¢ã€‚å¯ä»¥åœ¨è¿è¡Œæ—¶é€‰æ‹©ç®—æ³•ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Strategy</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">execute</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConcreteStrategyA</span> <span class="keyword">implements</span> <span class="title">Strategy</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">execute</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$a</span> + <span class="variable">$b</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConcreteStrategyB</span> <span class="keyword">implements</span> <span class="title">Strategy</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">execute</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$a</span> * <span class="variable">$b</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Context</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="variable">$strategy</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setStrategy</span>(<span class="params">Strategy <span class="variable">$strategy</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;strategy = <span class="variable">$strategy</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">executeStrategy</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;strategy-&gt;<span class="title function_ invoke__">execute</span>(<span class="variable">$a</span>, <span class="variable">$b</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="äº”ã€é€‚é…å™¨æ¨¡å¼-Adapter"><a href="#äº”ã€é€‚é…å™¨æ¨¡å¼-Adapter" class="headerlink" title="äº”ã€é€‚é…å™¨æ¨¡å¼ (Adapter):"></a>äº”ã€é€‚é…å™¨æ¨¡å¼ (Adapter):</h1><p>å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦ä¸€ä¸ªæ¥å£ã€‚é€‚ç”¨äºéœ€è¦å…¼å®¹ä¸åŒæ¥å£çš„æƒ…å†µã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Adaptee</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">specificRequest</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Adaptee&#x27;s specific request.&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Adapter</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="variable">$adaptee</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">Adaptee <span class="variable">$adaptee</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;adaptee = <span class="variable">$adaptee</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">request</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;adaptee-&gt;<span class="title function_ invoke__">specificRequest</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å…­ã€å‘½ä»¤æ¨¡å¼-Command"><a href="#å…­ã€å‘½ä»¤æ¨¡å¼-Command" class="headerlink" title="å…­ã€å‘½ä»¤æ¨¡å¼ (Command):"></a>å…­ã€å‘½ä»¤æ¨¡å¼ (Command):</h1><p>å°†è¯·æ±‚å°è£…æˆå¯¹è±¡ï¼Œä»è€Œä½¿æ‚¨èƒ½å¤Ÿä½¿ç”¨ä¸åŒçš„è¯·æ±‚ã€é˜Ÿåˆ—è¯·æ±‚å’Œæ—¥å¿—è¯·æ±‚ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">execute</span>(<span class="params"></span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConcreteCommand</span> <span class="keyword">implements</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="variable">$receiver</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$receiver</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;receiver = <span class="variable">$receiver</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">execute</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;receiver-&gt;<span class="title function_ invoke__">action</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Receiver</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">action</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Action executed.&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Invoker</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="variable">$command</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setCommand</span>(<span class="params">Command <span class="variable">$command</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;command = <span class="variable">$command</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;command-&gt;<span class="title function_ invoke__">execute</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpæ‰§è¡Œå¤šçº¿ç¨‹å¹¶å‘</title>
      <link href="/posts/7e0668e3.html"/>
      <url>/posts/7e0668e3.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€PCNTLæ‰©å±•ï¼ˆè¿›ç¨‹çº§å¹¶å‘ï¼‰"><a href="#ä¸€ã€PCNTLæ‰©å±•ï¼ˆè¿›ç¨‹çº§å¹¶å‘ï¼‰" class="headerlink" title="ä¸€ã€PCNTLæ‰©å±•ï¼ˆè¿›ç¨‹çº§å¹¶å‘ï¼‰"></a>ä¸€ã€PCNTLæ‰©å±•ï¼ˆè¿›ç¨‹çº§å¹¶å‘ï¼‰</h1><p>é€‚ç”¨åœºæ™¯ï¼šCLIç¯å¢ƒä¸‹çš„ä»»åŠ¡åˆ†ç‰‡å¤„ç†<br>ç‰¹ç‚¹ï¼š</p><ul><li>çœŸæ­£çš„å¹¶è¡Œå¤„ç†</li><li>è¿›ç¨‹éš”ç¦»å®‰å…¨æ€§é«˜</li><li>å†…å­˜æ— æ³•å…±äº«ï¼ˆéœ€IPCé€šä¿¡ï¼‰<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ£€æŸ¥æ‰©å±•æ˜¯å¦åŠ è½½</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">function_exists</span>(<span class="string">&#x27;pcntl_fork&#x27;</span>)) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;PCNTL extension required&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$workers</span> = <span class="number">3</span>;</span><br><span class="line"><span class="variable">$tasks</span> = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$workers</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">    <span class="variable">$pid</span> = <span class="title function_ invoke__">pcntl_fork</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$pid</span> == -<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Fork failed&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">elseif</span> (<span class="variable">$pid</span>) &#123;</span><br><span class="line">        <span class="comment">// çˆ¶è¿›ç¨‹</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Started worker <span class="subst">$pid</span>\n&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// å­è¿›ç¨‹</span></span><br><span class="line">        <span class="variable">$task</span> = <span class="variable">$tasks</span>[<span class="variable">$i</span>] ?? <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$task</span>) &#123;</span><br><span class="line">            <span class="title function_ invoke__">processTask</span>(<span class="variable">$task</span>); <span class="comment">// æ‰§è¡Œå…·ä½“ä»»åŠ¡</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">exit</span>; <span class="comment">// å¿…é¡»é€€å‡ºå­è¿›ç¨‹</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç­‰å¾…æ‰€æœ‰å­è¿›ç¨‹ç»“æŸ</span></span><br><span class="line"><span class="keyword">while</span> (<span class="title function_ invoke__">pcntl_waitpid</span>(<span class="number">0</span>, <span class="variable">$status</span>) != -<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="variable">$status</span> = <span class="title function_ invoke__">pcntl_wexitstatus</span>(<span class="variable">$status</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Worker completed: Status <span class="subst">$status</span>\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">processTask</span>(<span class="params"><span class="variable">$task</span></span>) </span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">sleep</span>(<span class="title function_ invoke__">rand</span>(<span class="number">1</span>, <span class="number">3</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Processed <span class="subst">$task</span>\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h1 id="äºŒã€pthreadsæ‰©å±•ï¼ˆçœŸçº¿ç¨‹ï¼‰"><a href="#äºŒã€pthreadsæ‰©å±•ï¼ˆçœŸçº¿ç¨‹ï¼‰" class="headerlink" title="äºŒã€pthreadsæ‰©å±•ï¼ˆçœŸçº¿ç¨‹ï¼‰"></a>äºŒã€pthreadsæ‰©å±•ï¼ˆçœŸçº¿ç¨‹ï¼‰</h1><p>è¦æ±‚ï¼šZTSï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰ç‰ˆPHP 7.2+<br>ç‰¹ç‚¹ï¼š</p><ul><li>å…±äº«å†…å­˜ï¼ˆéœ€åŒæ­¥æ§åˆ¶ï¼‰</li><li>Windows&#x2F;Linuxå‡å¯è¿è¡Œ</li><li>éœ€æ‰‹åŠ¨ç®¡ç†çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AsyncTask</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$taskId</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$id</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;taskId = <span class="variable">$id</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Running task <span class="subst">&#123;$this-&gt;taskId&#125;</span>\n&quot;</span>;</span><br><span class="line">        <span class="comment">// æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ</span></span><br><span class="line">        <span class="title function_ invoke__">usleep</span>(<span class="title function_ invoke__">rand</span>(<span class="number">500000</span>, <span class="number">1000000</span>));</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Result_<span class="subst">&#123;$this-&gt;taskId&#125;</span>&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$threads</span> = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">3</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">    <span class="variable">$threads</span>[<span class="variable">$i</span>] = <span class="keyword">new</span> <span class="title class_">AsyncTask</span>(<span class="variable">$i</span>);</span><br><span class="line">    <span class="variable">$threads</span>[<span class="variable">$i</span>]-&gt;<span class="title function_ invoke__">start</span>(); <span class="comment">// éé˜»å¡</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$threads</span> <span class="keyword">as</span> <span class="variable">$thread</span>) &#123;</span><br><span class="line">    <span class="variable">$thread</span>-&gt;<span class="title function_ invoke__">join</span>(); <span class="comment">// ç­‰å¾…çº¿ç¨‹ç»“æŸ</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$thread</span>-&gt;<span class="title function_ invoke__">getResult</span>() . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h1 id="ä¸‰ã€Swooleåç¨‹ï¼ˆæ¨èæ–¹æ¡ˆï¼‰"><a href="#ä¸‰ã€Swooleåç¨‹ï¼ˆæ¨èæ–¹æ¡ˆï¼‰" class="headerlink" title="ä¸‰ã€Swooleåç¨‹ï¼ˆæ¨èæ–¹æ¡ˆï¼‰"></a>ä¸‰ã€Swooleåç¨‹ï¼ˆæ¨èæ–¹æ¡ˆï¼‰</h1><p>é€‚ç”¨åœºæ™¯ï¼šé«˜å¹¶å‘IOå¯†é›†å‹ä»»åŠ¡<br>ä¼˜åŠ¿ï¼š</p><ul><li>å•è¿›ç¨‹å¤„ç†æ•°åƒå¹¶å‘</li><li>åç¨‹åˆ‡æ¢é›¶æ¶ˆè€—</li><li>å†…ç½®è¿æ¥æ± å’Œå®šæ—¶å™¨<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Swoole\Runtime</span>::<span class="title function_ invoke__">enableCoroutine</span>(); <span class="comment">// å¼€å¯åç¨‹Hook</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$start</span> = <span class="title function_ invoke__">microtime</span>(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">go</span>(function () &#123;</span><br><span class="line"><span class="variable">$cli</span> = <span class="keyword">new</span> <span class="title class_">Swoole\Coroutine\Http\Client</span>(<span class="string">&#x27;api.example.com&#x27;</span>, <span class="number">80</span>);</span><br><span class="line"><span class="variable">$cli</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/data1&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Response1: &quot;</span>.<span class="variable">$cli</span>-&gt;body.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">go</span>(function () &#123;</span><br><span class="line"><span class="variable">$cli</span> = <span class="keyword">new</span> <span class="title class_">Swoole\Coroutine\Http\Client</span>(<span class="string">&#x27;api.example.com&#x27;</span>, <span class="number">80</span>);</span><br><span class="line"><span class="variable">$cli</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;/data2&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Response2: &quot;</span>.<span class="variable">$cli</span>-&gt;body.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç­‰å¾…æ‰€æœ‰åç¨‹å®Œæˆ</span></span><br><span class="line"><span class="title class_">Swoole\Event</span>::<span class="title function_ invoke__">wait</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Time: &quot;</span>.(<span class="title function_ invoke__">microtime</span>(<span class="literal">true</span>)-<span class="variable">$start</span>).<span class="string">&quot;s\n&quot;</span>;</span><br></pre></td></tr></table></figure></li></ul><h1 id="å››ã€ReactPHPæ¡†æ¶äº‹ä»¶å¾ªç¯"><a href="#å››ã€ReactPHPæ¡†æ¶äº‹ä»¶å¾ªç¯" class="headerlink" title="å››ã€ReactPHPæ¡†æ¶äº‹ä»¶å¾ªç¯"></a>å››ã€ReactPHPæ¡†æ¶äº‹ä»¶å¾ªç¯</h1><p>é€‚ç”¨åœºæ™¯ï¼šå¼‚æ­¥éé˜»å¡IO  </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$loop</span> = <span class="title class_">React\EventLoop\Factory</span>::<span class="title function_ invoke__">create</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¹¶å‘HTTPè¯·æ±‚</span></span><br><span class="line"><span class="variable">$promises</span> = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">1</span>; <span class="variable">$i</span> &lt;= <span class="number">3</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">    <span class="variable">$promises</span>[] = (<span class="keyword">new</span> <span class="title class_">React\Http\Browser</span>(<span class="variable">$loop</span>))</span><br><span class="line">        -&gt;<span class="title function_ invoke__">get</span>(<span class="string">&quot;http://example.com/api?q=<span class="subst">$i</span>&quot;</span>)</span><br><span class="line">        -&gt;<span class="title function_ invoke__">then</span>(</span><br><span class="line">            function (Psr\Http\Message\ResponseInterface <span class="variable">$response</span>) <span class="keyword">use</span> ($<span class="title">i</span>) &#123;</span><br><span class="line">                <span class="title">echo</span> &quot;<span class="title">Response</span> $<span class="title">i</span>: &quot;.$<span class="title">response</span>-&gt;<span class="title">getBody</span>().&quot;\<span class="title">n</span>&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">        );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¹¶è¡Œæ‰§è¡Œ</span></span><br><span class="line">React\Promise\<span class="title function_ invoke__">all</span>(<span class="variable">$promises</span>)-&gt;<span class="title function_ invoke__">then</span>(</span><br><span class="line">    function () &#123; <span class="keyword">echo</span> <span class="string">&quot;All done!\n&quot;</span>; &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="variable">$loop</span>-&gt;<span class="title function_ invoke__">run</span>();</span><br></pre></td></tr></table></figure><h1 id="äº”ã€Guzzleè¯·æ±‚åº“å¼‚æ­¥è¯·æ±‚"><a href="#äº”ã€Guzzleè¯·æ±‚åº“å¼‚æ­¥è¯·æ±‚" class="headerlink" title="äº”ã€Guzzleè¯·æ±‚åº“å¼‚æ­¥è¯·æ±‚"></a>äº”ã€Guzzleè¯·æ±‚åº“å¼‚æ­¥è¯·æ±‚</h1><p>é€‚ç”¨åœºæ™¯ï¼šHTTP APIå¹¶å‘è°ƒç”¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">GuzzleHttp</span>\<span class="title">Client</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">GuzzleHttp</span>\<span class="title">Promise</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$client</span> = <span class="keyword">new</span> <span class="title class_">Client</span>([<span class="string">&#x27;base_uri&#x27;</span> =&gt; <span class="string">&#x27;http://api.example.com&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘èµ·å¹¶å‘è¯·æ±‚</span></span><br><span class="line"><span class="variable">$promises</span> = [</span><br><span class="line"><span class="string">&#x27;users&#x27;</span> =&gt; <span class="variable">$client</span>-&gt;<span class="title function_ invoke__">getAsync</span>(<span class="string">&#x27;/users&#x27;</span>),</span><br><span class="line"><span class="string">&#x27;posts&#x27;</span> =&gt; <span class="variable">$client</span>-&gt;<span class="title function_ invoke__">getAsync</span>(<span class="string">&#x27;/posts&#x27;</span>)</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç­‰å¾…æ‰€æœ‰è¯·æ±‚å®Œæˆ</span></span><br><span class="line"><span class="variable">$results</span> = <span class="title class_">Promise\Utils</span>::<span class="title function_ invoke__">settle</span>(<span class="variable">$promises</span>)-&gt;<span class="title function_ invoke__">wait</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$results</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$response</span>) &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$key</span>: &quot;</span>.<span class="variable">$response</span>[<span class="string">&#x27;value&#x27;</span>]-&gt;<span class="title function_ invoke__">getBody</span>().<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å…­ã€æ–¹æ¡ˆå¯¹æ¯”ä¸é€‰å‹"><a href="#å…­ã€æ–¹æ¡ˆå¯¹æ¯”ä¸é€‰å‹" class="headerlink" title="å…­ã€æ–¹æ¡ˆå¯¹æ¯”ä¸é€‰å‹"></a>å…­ã€æ–¹æ¡ˆå¯¹æ¯”ä¸é€‰å‹</h1><table><thead><tr><th>æ–¹æ¡ˆ</th><th>å¹¶å‘æ¨¡å‹</th><th>å†…å­˜éš”ç¦»</th><th>é€‚ç”¨åœºæ™¯</th><th>æ€§èƒ½</th></tr></thead><tbody><tr><td>PCNTL</td><td>å¤šè¿›ç¨‹</td><td>å®Œå…¨éš”ç¦»</td><td>CPUå¯†é›†å‹ä»»åŠ¡</td><td>é«˜ï¼ˆçœŸå¹¶è¡Œï¼‰</td></tr><tr><td>pthreads</td><td>å¤šçº¿ç¨‹</td><td>å…±äº«å†…å­˜</td><td>è®¡ç®—+IOæ··åˆä»»åŠ¡</td><td>é«˜ï¼ˆéœ€åŒæ­¥ï¼‰</td></tr><tr><td>Swoole</td><td>åç¨‹</td><td>å…±äº«å†…å­˜</td><td>é«˜å¹¶å‘IOæ“ä½œ</td><td>æé«˜</td></tr><tr><td>ReactPHP</td><td>äº‹ä»¶å¾ªç¯</td><td>å•çº¿ç¨‹</td><td>å¼‚æ­¥éé˜»å¡ä»»åŠ¡</td><td>ä¸­</td></tr><tr><td>Guzzleå¼‚æ­¥</td><td>HTTPå¹¶å‘</td><td>å•çº¿ç¨‹</td><td>APIèšåˆè°ƒç”¨</td><td>ä¸­</td></tr></tbody></table><h1 id="ä¸ƒã€æœ€ä½³å®è·µå»ºè®®"><a href="#ä¸ƒã€æœ€ä½³å®è·µå»ºè®®" class="headerlink" title="ä¸ƒã€æœ€ä½³å®è·µå»ºè®®"></a>ä¸ƒã€æœ€ä½³å®è·µå»ºè®®</h1><ul><li>CPUå¯†é›†å‹ï¼šä¼˜å…ˆé€‰æ‹©PCNTLæˆ–å¤šè¿›ç¨‹æ¨¡å¼</li><li>IOå¯†é›†å‹ï¼šä½¿ç”¨Swooleåç¨‹æˆ–ReactPHP</li><li>HTTPè¯·æ±‚ï¼šGuzzleå¼‚æ­¥æ–¹æ¡ˆæœ€ç®€å•</li></ul>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
          <category> ä¸šåŠ¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> é¢è¯• </tag>
            
            <tag> phpé¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpç‰¹æ€§JIT</title>
      <link href="/posts/75f8cdd8.html"/>
      <url>/posts/75f8cdd8.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>PHP çš„ JITï¼ˆJust-In-Time Compilerï¼‰æ˜¯ PHP 8.0 å¼•å…¥çš„æ ¸å¿ƒç‰¹æ€§ï¼Œæ—¨åœ¨é€šè¿‡è¿è¡Œæ—¶ç¼–è¯‘çƒ­ç‚¹ä»£ç ï¼ˆé¢‘ç¹æ‰§è¡Œçš„ä»£ç æ®µï¼‰ä¸ºæœºå™¨ç ï¼Œæ˜¾è‘—æå‡è®¡ç®—å¯†é›†å‹ä»»åŠ¡çš„æ€§èƒ½</p><h1 id="ä¸€ã€JIT-çš„å·¥ä½œåŸç†"><a href="#ä¸€ã€JIT-çš„å·¥ä½œåŸç†" class="headerlink" title="ä¸€ã€JIT çš„å·¥ä½œåŸç†"></a>ä¸€ã€JIT çš„å·¥ä½œåŸç†</h1><h2 id="1-ä»£ç æ‰§è¡Œæµç¨‹ä¼˜åŒ–"><a href="#1-ä»£ç æ‰§è¡Œæµç¨‹ä¼˜åŒ–" class="headerlink" title="1. ä»£ç æ‰§è¡Œæµç¨‹ä¼˜åŒ–"></a>1. ä»£ç æ‰§è¡Œæµç¨‹ä¼˜åŒ–</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">PHP</span> ä¼ ç»Ÿæ‰§è¡Œæµç¨‹åˆ†ä¸ºè¯æ³•åˆ†æï¼ˆTokenizingï¼‰ã€è¯­æ³•åˆ†æï¼ˆParsingï¼‰ã€ç”Ÿæˆä¸­é—´ç ï¼ˆOpcodesï¼‰ï¼Œ</span><br><span class="line">æœ€åç”± Zend è™šæ‹Ÿæœºï¼ˆZend VMï¼‰é€è¡Œè§£é‡Šæ‰§è¡Œã€‚</span><br></pre></td></tr></table></figure><p>JIT åœ¨æ­¤æµç¨‹ä¸­æ’å…¥åŠ¨æ€ç¼–è¯‘ç¯èŠ‚ï¼š</p><ul><li>çƒ­ç‚¹ä»£ç è¯†åˆ«ï¼šZend å¼•æ“ç›‘æ§æ‰§è¡Œé¢‘ç‡é«˜çš„ä»£ç æ®µï¼ˆå¦‚å¾ªç¯ã€é€’å½’ï¼‰ã€‚</li><li>æœºå™¨ç ç”Ÿæˆï¼šé€šè¿‡ DynASM åº“å°† Opcodes è½¬æ¢ä¸º CPU æŒ‡ä»¤ï¼Œç»•è¿‡ Zend VM ç›´æ¥æ‰§è¡Œã€‚</li><li>ç¼“å­˜æœºåˆ¶ï¼šç¼–è¯‘åçš„æœºå™¨ç å­˜å…¥å…±äº«å†…å­˜ï¼Œä¾›åç»­è¯·æ±‚å¤ç”¨ã€‚</li></ul><h2 id="2-ç±»å‹æ¨æ–­æŒ‘æˆ˜"><a href="#2-ç±»å‹æ¨æ–­æŒ‘æˆ˜" class="headerlink" title="2. ç±»å‹æ¨æ–­æŒ‘æˆ˜"></a>2. ç±»å‹æ¨æ–­æŒ‘æˆ˜</h2><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PHP æ˜¯å¼±ç±»å‹è¯­è¨€ï¼Œå˜é‡ç±»å‹åœ¨è¿è¡Œæ—¶æ‰èƒ½ç¡®å®šã€‚<span class="keyword">JIT </span>éœ€åŠ¨æ€åˆ†æä»£ç è·¯å¾„ï¼Œç»“åˆè¿è¡Œæ—¶ç±»å‹ä¿¡æ¯ç”Ÿæˆé«˜æ•ˆæœºå™¨ç ï¼Œä½†è¿‡åº¦æ¨æ–­å¯èƒ½å¢åŠ ç¼–è¯‘å¼€é”€ã€‚</span><br></pre></td></tr></table></figure><h1 id="äºŒã€æ€§èƒ½æå‡ä¸é€‚ç”¨åœºæ™¯"><a href="#äºŒã€æ€§èƒ½æå‡ä¸é€‚ç”¨åœºæ™¯" class="headerlink" title="äºŒã€æ€§èƒ½æå‡ä¸é€‚ç”¨åœºæ™¯"></a>äºŒã€æ€§èƒ½æå‡ä¸é€‚ç”¨åœºæ™¯</h1><ol><li>æ€§èƒ½æå‡èŒƒå›´</li></ol><ul><li>è®¡ç®—å¯†é›†å‹ä»»åŠ¡ï¼šå¦‚æ•°å­¦è¿ç®—ã€å›¾åƒå¤„ç†ï¼Œæ€§èƒ½æå‡å¯è¾¾æ•°å€ï¼ˆä¾‹å¦‚æ–æ³¢é‚£å¥‘æ•°åˆ—è®¡ç®—ï¼‰ã€‚<ul><li>å°†çƒ­ç‚¹ä»£ç ï¼ˆé¢‘ç¹æ‰§è¡Œçš„ä»£ç æ®µï¼‰åŠ¨æ€ç¼–è¯‘ä¸ºæœºå™¨ç ï¼Œç»•è¿‡è§£é‡Šæ‰§è¡Œï¼Œæå‡è®¡ç®—å¯†é›†å‹ä»»åŠ¡æ•ˆç‡ï¼ˆå¦‚ PHP çš„ JIT å¯æå‡ 30% ä»¥ä¸Šæ€§èƒ½ï¼‰ã€‚</li></ul></li><li>IO å¯†é›†å‹åº”ç”¨ï¼šå› ç“¶é¢ˆåœ¨ç£ç›˜&#x2F;ç½‘ç»œæ“ä½œï¼ŒJIT æ•ˆæœæœ‰é™ã€‚</li><li>å‡½æ•°è°ƒç”¨ä¼˜åŒ–ï¼šæ”¯æŒå†…è”å‡½æ•°è°ƒç”¨ï¼Œå‡å°‘æ ˆå¸§æ“ä½œå¼€é”€ã€‚<ul><li>æ ¹æ®è¿è¡Œæ—¶çŠ¶æ€ç”Ÿæˆé’ˆå¯¹æ€§ä¼˜åŒ–çš„æœºå™¨æŒ‡ä»¤ï¼ˆå¦‚å†…è”å‡½æ•°ã€å¯„å­˜å™¨åˆ†é…ï¼‰ï¼Œä¼˜äºé™æ€ç¼–è¯‘çš„äº‹å‰ä¼˜åŒ–</li></ul></li><li>é€‰æ‹©æ€§ç¼–è¯‘çƒ­ç‚¹ä»£ç ï¼Œå‡å°‘ç¼–è¯‘æ—¶é—´å’Œå†…å­˜å ç”¨</li></ul><ol start="2"><li>å®é™…æ¡ˆä¾‹<br>ç¤ºä¾‹ä»£ç å¯ç”¨ JIT åé€’å½’è®¡ç®— fibonacci(35) æ—¶é—´ç¼©çŸ­ 50% ä»¥ä¸Šï¼š<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;opcache.jit&#x27;</span>, <span class="string">&#x27;tracing&#x27;</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fibonacci</span>(<span class="params"><span class="variable">$n</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="variable">$n</span> &lt;= <span class="number">1</span>) ? <span class="variable">$n</span> : <span class="title function_ invoke__">fibonacci</span>(<span class="variable">$n</span>-<span class="number">1</span>) + <span class="title function_ invoke__">fibonacci</span>(<span class="variable">$n</span>-<span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ‰§è¡Œæ—¶é—´æ˜¾è‘—å‡å°‘:cite[3]:cite[4]ã€‚</span></span><br></pre></td></tr></table></figure></li></ol><h1 id="ä¸‰ã€é…ç½®ä¸ä¼˜åŒ–ç­–ç•¥"><a href="#ä¸‰ã€é…ç½®ä¸ä¼˜åŒ–ç­–ç•¥" class="headerlink" title="ä¸‰ã€é…ç½®ä¸ä¼˜åŒ–ç­–ç•¥"></a>ä¸‰ã€é…ç½®ä¸ä¼˜åŒ–ç­–ç•¥</h1><ol><li>æ ¸å¿ƒé…ç½®å‚æ•°</li></ol><ul><li>å¯ç”¨ JITï¼šopcache.jit&#x3D;tracingï¼ˆé»˜è®¤æ¨¡å¼ï¼‰æˆ– functionã€‚</li><li>ç¼“å†²åŒºå¤§å°ï¼šopcache.jit_buffer_size&#x3D;256Mï¼ˆæ ¹æ®å†…å­˜è°ƒæ•´ï¼‰ã€‚</li><li>è°ƒè¯•æ¨¡å¼ï¼šopcache.jit_debug&#x3D;1 è¾“å‡ºç¼–è¯‘åçš„æ±‡ç¼–ä»£ç ã€‚</li></ul><ol start="2"><li>ä»£ç ä¼˜åŒ–å»ºè®®</li></ol><ul><li>ä¸¥æ ¼ç±»å‹å£°æ˜ï¼šå¸®åŠ© JIT æ¨æ–­å˜é‡ç±»å‹ï¼Œä¾‹å¦‚ä½¿ç”¨ declare(strict_types&#x3D;1) å’Œå‚æ•°ç±»å‹æ³¨è§£ã€‚</li><li>é¿å…åŠ¨æ€ç‰¹æ€§ï¼šå¦‚é­”æœ¯æ–¹æ³•ã€eval()ï¼Œå‡å°‘ç±»å‹ä¸ç¡®å®šæ€§ã€‚</li></ul><h1 id="å››ã€å±€é™æ€§åŠæ³¨æ„äº‹é¡¹"><a href="#å››ã€å±€é™æ€§åŠæ³¨æ„äº‹é¡¹" class="headerlink" title="å››ã€å±€é™æ€§åŠæ³¨æ„äº‹é¡¹"></a>å››ã€å±€é™æ€§åŠæ³¨æ„äº‹é¡¹</h1><ol><li><p>å†…å­˜ä¸ç¼–è¯‘å¼€é”€<br>JIT ç¼–è¯‘éœ€å ç”¨é¢å¤–å†…å­˜ï¼ˆé»˜è®¤ç¼“å†²åŒº 64MBï¼‰ï¼Œä¸”ç¼–è¯‘è¿‡ç¨‹å¯èƒ½å¢åŠ åˆå§‹å»¶è¿Ÿã€‚</p></li><li><p>è°ƒè¯•å¤æ‚æ€§<br>ç¼–è¯‘åçš„æœºå™¨ç æ— æ³•é€šè¿‡ä¼ ç»Ÿè°ƒè¯•å™¨è·Ÿè¸ªï¼Œéœ€ä¾èµ–æ—¥å¿—å’Œæ€§èƒ½åˆ†æå·¥å…·ã€‚</p></li><li><p>é€‚ç”¨åœºæ™¯é™åˆ¶</p><ul><li>Web åº”ç”¨ï¼šå¤šæ•°å—é™äº IO æ“ä½œï¼Œæ€§èƒ½æå‡æœ‰é™ã€‚</li><li>å°å‹è„šæœ¬ï¼šç¼–è¯‘å¼€é”€å¯èƒ½æŠµæ¶ˆæ‰§è¡ŒåŠ é€Ÿæ•ˆæœ1ã€‚</li></ul></li></ol><h1 id="äº”ã€æ€»ç»“"><a href="#äº”ã€æ€»ç»“" class="headerlink" title="äº”ã€æ€»ç»“"></a>äº”ã€æ€»ç»“</h1><p>PHP çš„ JIT é€šè¿‡åŠ¨æ€ç¼–è¯‘æŠ€æœ¯ä¸ºè®¡ç®—å¯†é›†å‹ä»»åŠ¡å¸¦æ¥æ˜¾è‘—æ€§èƒ½æå‡ï¼Œä½†éœ€ç»“åˆä»£ç ä¼˜åŒ–å’Œåˆç†é…ç½®ã€‚å¯¹äºå¤šæ•° Web åº”ç”¨ï¼Œå»ºè®®ä¼˜å…ˆä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢ã€ç¼“å­˜ç­–ç•¥ï¼Œè€Œéè¿‡åº¦ä¾èµ– JIT</p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
          <category> åŸç† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> é¢è¯• </tag>
            
            <tag> phpé¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpåº•å±‚åŸç†</title>
      <link href="/posts/9f50d3de.html"/>
      <url>/posts/9f50d3de.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€å››å±‚ä½“ç³»æ¶æ„"><a href="#ä¸€ã€å››å±‚ä½“ç³»æ¶æ„" class="headerlink" title="ä¸€ã€å››å±‚ä½“ç³»æ¶æ„"></a>ä¸€ã€å››å±‚ä½“ç³»æ¶æ„</h1><p>PHPé‡‡ç”¨åˆ†å±‚è®¾è®¡ï¼Œç”±ä¸‹è‡³ä¸Šåˆ†ä¸ºå››å±‚ï¼Œå½¢æˆé«˜æ•ˆå¯æ‰©å±•çš„è¿è¡Œæ¡†æ¶ï¼š</p><h2 id="1-Zendå¼•æ“"><a href="#1-Zendå¼•æ“" class="headerlink" title="1.Zendå¼•æ“"></a>1.Zendå¼•æ“</h2><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">PHP</span>çš„æ ¸å¿ƒï¼Œç”¨çº¯<span class="built_in">C</span>å®ç°ï¼Œè´Ÿè´£è¯æ³•<span class="operator">/</span>è¯­æ³•è§£æã€ç¼–è¯‘ç”Ÿæˆ<span class="variable">opcode</span>ã€å†…å­˜ç®¡ç†åŠæä¾›åŸºç¡€<span class="variable">API</span></span><br><span class="line">å®ç°äº†å“ˆå¸Œè¡¨ã€å¯¹è±¡æ¨¡å‹ç­‰æ ¸å¿ƒæ•°æ®ç»“æ„ï¼Œæ”¯æ’‘<span class="variable">PHP</span>çš„å¼±ç±»å‹ç‰¹æ€§</span><br><span class="line">æœ€æ–°ç‰ˆæœ¬ï¼ˆå¦‚<span class="variable">PHP</span> <span class="number">8.3</span>ï¼‰å¼•å…¥<span class="variable">JIT</span>ç¼–è¯‘æŠ€æœ¯ï¼Œæ˜¾è‘—æå‡æ‰§è¡Œæ•ˆç‡</span><br></pre></td></tr></table></figure><h2 id="2-Extensionsç»„ä»¶å±‚"><a href="#2-Extensionsç»„ä»¶å±‚" class="headerlink" title="2.Extensionsç»„ä»¶å±‚"></a>2.Extensionsç»„ä»¶å±‚</h2><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é€šè¿‡æ¨¡å—åŒ–æ‰©å±•æä¾›æ ‡å‡†åº“åŠŸèƒ½ï¼ˆå¦‚æ•°ç»„æ“ä½œã€æ–‡ä»¶å¤„ç†ç­‰ï¼‰</span><br><span class="line">å¼€å‘è€…å¯ç¼–å†™<span class="built_in">C</span>æ‰©å±•å®ç°æ€§èƒ½æ•æ„ŸåŠŸèƒ½ï¼ˆå¦‚åŠ å¯†ç®—æ³•ã€åè®®è§£æï¼‰</span><br></pre></td></tr></table></figure><h2 id="2-SAPIå±‚ï¼ˆæœåŠ¡å™¨æŠ½è±¡æ¥å£ï¼‰"><a href="#2-SAPIå±‚ï¼ˆæœåŠ¡å™¨æŠ½è±¡æ¥å£ï¼‰" class="headerlink" title="2.SAPIå±‚ï¼ˆæœåŠ¡å™¨æŠ½è±¡æ¥å£ï¼‰"></a>2.SAPIå±‚ï¼ˆæœåŠ¡å™¨æŠ½è±¡æ¥å£ï¼‰</h2><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">éš”ç¦»<span class="variable">Web</span>æœåŠ¡å™¨ä¸<span class="variable">PHP</span>æ ¸å¿ƒï¼Œæ”¯æŒå¤šç§è¿è¡Œæ¨¡å¼ï¼š</span><br><span class="line"><span class="variable">FPM</span>ï¼ˆ<span class="variable">FastCGI</span> <span class="variable">Process</span> <span class="variable">Manager</span>ï¼‰ï¼šä¸»æµç”Ÿäº§ç¯å¢ƒæ–¹æ¡ˆï¼Œæ”¯æŒè¿›ç¨‹æ± ç®¡ç†</span><br><span class="line"><span class="variable">CLI</span>ï¼šå‘½ä»¤è¡Œè„šæœ¬æ‰§è¡Œ</span><br><span class="line"><span class="variable">Embedded</span>ï¼šåµŒå…¥<span class="built_in">C</span><span class="operator">/</span><span class="built_in">C</span><span class="operator">++</span>åº”ç”¨</span><br></pre></td></tr></table></figure><h2 id="3-åº”ç”¨å±‚"><a href="#3-åº”ç”¨å±‚" class="headerlink" title="3.åº”ç”¨å±‚"></a>3.åº”ç”¨å±‚</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¼€å‘è€…ç¼–å†™çš„ä¸šåŠ¡ä»£ç ï¼Œé€šè¿‡SAPIä¸ä¸‹å±‚äº¤äº’</span><br></pre></td></tr></table></figure><h1 id="äºŒã€æ‰§è¡Œæµç¨‹ä¸Opcodeæœºåˆ¶"><a href="#äºŒã€æ‰§è¡Œæµç¨‹ä¸Opcodeæœºåˆ¶" class="headerlink" title="äºŒã€æ‰§è¡Œæµç¨‹ä¸Opcodeæœºåˆ¶"></a>äºŒã€æ‰§è¡Œæµç¨‹ä¸Opcodeæœºåˆ¶</h1><p>PHPä»£ç çš„æ‰§è¡Œç»å†ä¸‰ä¸ªé˜¶æ®µï¼Œä½“ç°è§£é‡Šå‹è¯­è¨€ç‰¹æ€§ï¼š</p><h2 id="1-ç¼–è¯‘é˜¶æ®µ"><a href="#1-ç¼–è¯‘é˜¶æ®µ" class="headerlink" title="1.ç¼–è¯‘é˜¶æ®µ"></a>1.ç¼–è¯‘é˜¶æ®µ</h2><ul><li>è¯æ³•åˆ†æï¼šå°†æºç è½¬æ¢ä¸ºTokenæµï¼ˆå¦‚$a&#x3D;1åˆ†è§£ä¸ºå˜é‡ã€è¿ç®—ç¬¦ã€å¸¸é‡ï¼‰</li><li>è¯­æ³•åˆ†æï¼šæ„å»ºæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰</li><li>ç”ŸæˆOpcodeï¼šå°†ASTç¼–è¯‘ä¸ºä¸­é—´æŒ‡ä»¤é›†ï¼Œå¦‚ï¼š</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ZEND_ASSIGN_SPEC_CV_CONST_HANDLER  <span class="comment">// $a=1</span></span><br><span class="line">ZEND_ADD_SPEC_CV_CV_HANDLER        <span class="comment">// $c=$a+$b</span></span><br></pre></td></tr></table></figure><h2 id="2-æ‰§è¡Œé˜¶æ®µ"><a href="#2-æ‰§è¡Œé˜¶æ®µ" class="headerlink" title="2.æ‰§è¡Œé˜¶æ®µ"></a>2.æ‰§è¡Œé˜¶æ®µ</h2><ul><li>Zendè™šæ‹Ÿæœºé€æ¡æ‰§è¡ŒOpcodeï¼Œè°ƒç”¨å¯¹åº”çš„Cå‡½æ•°</li><li>PHP 8å¼•å…¥çš„JITä¼šå°†çƒ­ç‚¹ä»£ç ç¼–è¯‘ä¸ºæœºå™¨ç ç›´æ¥æ‰§è¡Œï¼Œæ€§èƒ½æå‡å¯è¾¾30% <a href="/posts/75f8cdd8">phpç‰¹æ€§JIT</a> <a href="php%E7%89%B9%E6%80%A7JIT.md"></a></li></ul><h2 id="3-ç¼“å­˜ä¼˜åŒ–"><a href="#3-ç¼“å­˜ä¼˜åŒ–" class="headerlink" title="3.ç¼“å­˜ä¼˜åŒ–"></a>3.ç¼“å­˜ä¼˜åŒ–</h2><ul><li>Opcacheæ‰©å±•å°†ç¼–è¯‘ç»“æœç¼“å­˜åœ¨å…±äº«å†…å­˜ï¼Œé¿å…é‡å¤è§£æï¼ˆé»˜è®¤å¼€å¯äºPHP 5.5+ï¼‰</li><li>å…¸å‹é…ç½®ï¼š<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">opcache.enable</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">opcache.memory_consumption</span>=<span class="number">128</span></span><br></pre></td></tr></table></figure></li></ul><h1 id="ä¸‰ã€æ ¸å¿ƒæ•°æ®ç»“æ„è®¾è®¡"><a href="#ä¸‰ã€æ ¸å¿ƒæ•°æ®ç»“æ„è®¾è®¡" class="headerlink" title="ä¸‰ã€æ ¸å¿ƒæ•°æ®ç»“æ„è®¾è®¡"></a>ä¸‰ã€æ ¸å¿ƒæ•°æ®ç»“æ„è®¾è®¡</h1><p>PHPçš„é«˜æ•ˆè¿è¡Œä¾èµ–ä¸¤å¤§åº•å±‚ç»“æ„ï¼š</p><h2 id="1-HashTableï¼ˆå“ˆå¸Œè¡¨ï¼‰"><a href="#1-HashTableï¼ˆå“ˆå¸Œè¡¨ï¼‰" class="headerlink" title="1. HashTableï¼ˆå“ˆå¸Œè¡¨ï¼‰"></a>1. HashTableï¼ˆå“ˆå¸Œè¡¨ï¼‰</h2><ul><li>å®ç°PHPæ•°ç»„ã€ç±»å±æ€§è¡¨ç­‰æ ¸å¿ƒåŠŸèƒ½</li><li>é‡‡ç”¨â€é“¾åœ°å€æ³•â€è§£å†³å“ˆå¸Œå†²çªï¼Œç»“æ„åŒ…å«ï¼š<ul><li>æ•£åˆ—æ¡¶æ•°ç»„ï¼šå¿«é€Ÿå®šä½å…ƒç´ ï¼ˆæ—¶é—´å¤æ‚åº¦O(1)ï¼‰</li><li>åŒå‘é“¾è¡¨ï¼šæ”¯æŒé¡ºåºéå†ï¼ˆforeachæ“ä½œï¼‰</li></ul></li><li>åŠ¨æ€æ‰©å®¹ç­–ç•¥ï¼šå½“å…ƒç´ æ•°è¶…è¿‡å½“å‰å®¹é‡75%æ—¶ï¼Œå®¹é‡ç¿»å€é‡å»ºå“ˆå¸Œè¡¨</li></ul><h2 id="2-zvalå˜é‡å®¹å™¨"><a href="#2-zvalå˜é‡å®¹å™¨" class="headerlink" title="2.zvalå˜é‡å®¹å™¨"></a>2.zvalå˜é‡å®¹å™¨</h2><ul><li>å­˜å‚¨å˜é‡å€¼çš„ç»“æ„ä½“ï¼š<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">zval_struct</span> &#123;</span></span><br><span class="line">zend_value value;    <span class="comment">// å®é™…å€¼ï¼ˆè”åˆä½“ï¼‰</span></span><br><span class="line">  <span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    zend_uchar type;     <span class="comment">// å½“å‰ç±»å‹</span></span><br><span class="line">    zend_uchar type_flags;</span><br><span class="line">    <span class="type">uint32_t</span> refcount;   <span class="comment">// å¼•ç”¨è®¡æ•°</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li><li>æ”¯æŒè‡ªåŠ¨ç±»å‹è½¬æ¢ï¼šå½“è¿›è¡Œ$a&#x3D;1; $a&#x3D;â€textâ€æ—¶ï¼Œzvalç±»å‹æ ‡è®°ä»IS_LONGå˜ä¸ºIS_STRING</li><li>å¼•ç”¨è®¡æ•°æœºåˆ¶å®ç°å†™æ—¶å¤åˆ¶ï¼ˆCopy-On-Writeï¼‰ï¼Œå‡å°‘å†…å­˜æ¶ˆè€—</li></ul><h1 id="å››ã€å†…å­˜ç®¡ç†ä¸è¿›ç¨‹æ¨¡å‹"><a href="#å››ã€å†…å­˜ç®¡ç†ä¸è¿›ç¨‹æ¨¡å‹" class="headerlink" title="å››ã€å†…å­˜ç®¡ç†ä¸è¿›ç¨‹æ¨¡å‹"></a>å››ã€å†…å­˜ç®¡ç†ä¸è¿›ç¨‹æ¨¡å‹</h1><h2 id="1-å†…å­˜åˆ†é…"><a href="#1-å†…å­˜åˆ†é…" class="headerlink" title="1.å†…å­˜åˆ†é…"></a>1.å†…å­˜åˆ†é…</h2><ul><li>é‡‡ç”¨åŸºäºæ± ï¼ˆPoolï¼‰çš„åˆ†é…ç­–ç•¥ï¼Œå‡å°‘é¢‘ç¹è°ƒç”¨mallocçš„æ€§èƒ½æŸè€—</li><li>åƒåœ¾å›æ”¶ï¼ˆGCï¼‰æœºåˆ¶ï¼š<ul><li>å¼•ç”¨è®¡æ•°ä¸ºä¸»ï¼Œå‘¨æœŸå›æ”¶ç®—æ³•ä¸ºè¾…</li><li>å½“refcount&#x3D;0æˆ–æ£€æµ‹åˆ°å¾ªç¯å¼•ç”¨æ—¶è‡ªåŠ¨é‡Šæ”¾å†…å­˜</li></ul></li></ul><h2 id="2-å¹¶å‘å¤„ç†æ¨¡å‹"><a href="#2-å¹¶å‘å¤„ç†æ¨¡å‹" class="headerlink" title="2.å¹¶å‘å¤„ç†æ¨¡å‹"></a>2.å¹¶å‘å¤„ç†æ¨¡å‹</h2><ul><li>ä¼ ç»Ÿå¤šè¿›ç¨‹æ¨¡å‹ï¼šæ¯ä¸ªè¯·æ±‚ç‹¬ç«‹è¿›ç¨‹ï¼Œé¿å…å†…å­˜æ³„æ¼å½±å“å…¨å±€ï¼ˆPHP-FPMé»˜è®¤æ¨¡å¼ï¼‰</li><li>å¤šçº¿ç¨‹æ”¯æŒï¼šé€šè¿‡ZTSï¼ˆZend Thread Safetyï¼‰æ¨¡å¼å¯ç”¨ï¼Œéœ€è°¨æ…å¤„ç†å…¨å±€å˜é‡</li><li>åç¨‹æ–¹æ¡ˆï¼šSwooleç­‰æ‰©å±•å®ç°å¼‚æ­¥éé˜»å¡IOï¼Œé€‚ç”¨äºé«˜å¹¶å‘åœºæ™¯</li></ul><h1 id="äº”ã€æ€§èƒ½ä¼˜åŒ–å®è·µ"><a href="#äº”ã€æ€§èƒ½ä¼˜åŒ–å®è·µ" class="headerlink" title="äº”ã€æ€§èƒ½ä¼˜åŒ–å®è·µ"></a>äº”ã€æ€§èƒ½ä¼˜åŒ–å®è·µ</h1><p>1.Opcodeç¼“å­˜ï¼šç¡®ä¿Opcacheå¯ç”¨å¹¶åˆç†é…ç½®å†…å­˜å¤§å°<br>2.JITè°ƒä¼˜ï¼šé’ˆå¯¹è®¡ç®—å¯†é›†å‹åœºæ™¯å¯ç”¨JITï¼ˆå¦‚opcache.jit&#x3D;1235ï¼‰<br>3.æ•°æ®ç»“æ„é€‰æ‹©ï¼š</p><ul><li>å…³è”æ•°ç»„æ”¹ç”¨SplFixedArrayï¼ˆç´¢å¼•æ•°ç»„ï¼‰å¯æå‡30%è®¿é—®é€Ÿåº¦ï¼Œç›¸æ¯”è¾ƒæ•°ç»„ä¼˜åŠ¿ï¼š<ul><li>å…ƒç´ ç±»å‹æ£€æŸ¥ï¼š SplFixedArray å…è®¸æŒ‡å®šå…ƒç´ çš„ç±»å‹ï¼Œæœ‰åŠ©äºç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§å’Œå¯é æ€§ã€‚</li><li>ç±»å‹å®‰å…¨ï¼š å…ƒç´ è®¿é—®æ˜¯ç±»å‹å®‰å…¨çš„ï¼Œå¼ºåˆ¶æ‰§è¡Œå£°æ˜çš„ç±»å‹ã€‚è¿™å¯ä»¥é˜²æ­¢æ„å¤–æ•°æ®ç±»å‹è½¬æ¢ï¼Œæé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œå®‰å…¨æ€§ã€‚</li><li>è·¨è¿›ç¨‹å…±äº«ï¼š SplFixedArray å¯¹è±¡å¯ä»¥è·¨è¿›ç¨‹å…±äº«ï¼Œåœ¨éœ€è¦åœ¨å¤šä¸ªè¿›ç¨‹ä¹‹é—´ä¼ é€’æˆ–è®¿é—®æ•°æ®æ—¶éå¸¸æœ‰ç”¨ã€‚</li><li>æ•°æ®é‡å¤§ä¸”å·²çŸ¥ï¼š å¯¹äºå…·æœ‰å¤§é‡é¢„å®šä¹‰å¤§å°çš„æ•°æ®é›†ï¼ŒSplFixedArray å¯ä»¥æ›´æœ‰æ•ˆåœ°ç®¡ç†å†…å­˜ã€‚</li></ul></li><li>å¤§æ•°ç»„ä¼˜å…ˆä½¿ç”¨ç”Ÿæˆå™¨ï¼ˆGeneratorï¼‰å‡å°‘å†…å­˜å ç”¨<br>4.æ‰©å±•å¼€å‘ï¼š</li><li>ä½¿ç”¨Zephirè¯­è¨€ç¼–å†™é«˜æ€§èƒ½æ‰©å±•ï¼ˆå¦‚Phalconæ¡†æ¶ï¼‰</li><li>é€šè¿‡FFIè°ƒç”¨Cåº“å‡½æ•°ï¼ˆPHP 7.4+ç‰¹æ€§ï¼‰</li></ul>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
          <category> åŸç† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> é¢è¯• </tag>
            
            <tag> phpé¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>redisæ¶ˆæ¯è®¢é˜…</title>
      <link href="/posts/589cfa0.html"/>
      <url>/posts/589cfa0.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="Controller-newSubscript"><a href="#Controller-newSubscript" class="headerlink" title="Controller\newSubscript"></a>Controller\newSubscript</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">redis</span>\<span class="title class_">Controller</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">newSubscript</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span> (<span class="params"><span class="variable">$redis</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$redis</span> = <span class="keyword">new</span> <span class="title class_">\Redis</span>();</span><br><span class="line">        <span class="variable">$redis</span>-&gt;<span class="title function_ invoke__">connect</span>(<span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="number">6379</span>);</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;redis = <span class="variable">$redis</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºèŠå¤©</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $sender å‘é€è€…</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array $recipients æ¥æ”¶è€…</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $message ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> null $char_id èŠå¤©å®¤ID</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">create_chat</span> (<span class="params"><span class="keyword">string</span> <span class="variable">$sender</span>,<span class="keyword">array</span> <span class="variable">$recipients</span>, <span class="keyword">string</span> <span class="variable">$message</span>,<span class="keyword">int</span> <span class="variable">$char_id</span> = <span class="literal">null</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$char_id</span> = <span class="variable">$char_id</span> ?? <span class="variable language_">$this</span>-&gt;redis-&gt;<span class="title function_ invoke__">incr</span>(<span class="string">&#x27;ids:chat:&#x27;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$recipients</span> = <span class="title function_ invoke__">array_push</span>(<span class="variable">$recipients</span>, <span class="variable">$sender</span>);</span><br><span class="line">        <span class="variable">$pipeline</span> = <span class="variable language_">$this</span>-&gt;redis-&gt;<span class="title function_ invoke__">multi</span>(<span class="title class_">\Redis</span>::<span class="variable constant_">PIPELINE</span>);</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$recipients</span> <span class="keyword">as</span> <span class="variable">$recipient</span>) &#123;</span><br><span class="line">            <span class="variable">$pipeline</span>-&gt;<span class="title function_ invoke__">zAdd</span>(<span class="string">&#x27;chat:&#x27;</span> . <span class="variable">$char_id</span>, <span class="number">0</span>, <span class="variable">$recipient</span>); <span class="comment">// ç¾¤ç»„æœ‰åºé›†å’Œ</span></span><br><span class="line">            <span class="variable">$pipeline</span>-&gt;<span class="title function_ invoke__">zAdd</span>(<span class="string">&#x27;seen:&#x27;</span> . <span class="variable">$recipient</span>, <span class="number">0</span>, <span class="variable">$char_id</span>); <span class="comment">// å·²è¯»æœ‰åºé›†å’Œ</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$pipeline</span>-&gt;<span class="title function_ invoke__">exec</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">send_message</span>(<span class="variable">$char_id</span>, <span class="variable">$sender</span>, <span class="variable">$message</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‘é€ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $char_id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $sender</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $message</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> mixed</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">send_message</span> (<span class="params"><span class="variable">$char_id</span>, <span class="variable">$sender</span>, <span class="variable">$message</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="variable">$mid</span> = <span class="variable language_">$this</span>-&gt;redis-&gt;<span class="title function_ invoke__">incr</span>(<span class="string">&#x27;ids:chat:&#x27;</span> . <span class="variable">$char_id</span>);</span><br><span class="line">            <span class="variable">$ts</span> = <span class="title function_ invoke__">time</span>();</span><br><span class="line">            <span class="variable">$packed</span> = [</span><br><span class="line">                <span class="string">&#x27;id&#x27;</span> =&gt; <span class="variable">$mid</span>,</span><br><span class="line">                <span class="string">&#x27;ts&#x27;</span> =&gt; <span class="variable">$ts</span>,</span><br><span class="line">                <span class="string">&#x27;sender&#x27;</span> =&gt; <span class="variable">$sender</span>,</span><br><span class="line">                <span class="string">&#x27;message&#x27;</span> =&gt; <span class="variable">$message</span></span><br><span class="line">            ];</span><br><span class="line"></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;redis-&gt;<span class="title function_ invoke__">zAdd</span>(<span class="string">&#x27;msgs:&#x27;</span> . <span class="variable">$char_id</span>, <span class="variable">$mid</span>, <span class="title function_ invoke__">json_encode</span>(<span class="variable">$packed</span>));</span><br><span class="line">        &#125;<span class="keyword">catch</span>(\<span class="built_in">Exception</span> <span class="variable">$e</span>)&#123;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">// pass</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$char_id</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">fetch_pending_message</span> (<span class="params"><span class="variable">$recipient</span></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// è·å–æœ€åä¸€æ¡ä¿¡æ¯</span></span><br><span class="line">        <span class="variable">$seen</span> = <span class="variable language_">$this</span>-&gt;redis-&gt;<span class="title function_ invoke__">zRange</span>(<span class="string">&#x27;seen:&#x27;</span> . <span class="variable">$recipient</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$pipeline</span> = <span class="variable language_">$this</span>-&gt;redis-&gt;<span class="title function_ invoke__">multi</span>(<span class="title class_">\Redis</span>::<span class="variable constant_">PIPELINE</span>);</span><br><span class="line">        <span class="comment">// è·å–æ‰€æœ‰æœªè¯»ä¿¡æ¯</span></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$seen</span> <span class="keyword">as</span> <span class="variable">$chat_id</span> =&gt; <span class="variable">$seen_id</span>) &#123;</span><br><span class="line">            <span class="variable">$pipeline</span>-&gt;<span class="title function_ invoke__">zRangeByScore</span>(<span class="string">&#x27;msgs:&#x27;</span> . <span class="variable">$chat_id</span>, <span class="variable">$seen_id</span> + <span class="number">1</span>, <span class="string">&#x27;+inf&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$msgsList</span> = <span class="variable">$pipeline</span>-&gt;<span class="title function_ invoke__">exec</span>();</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$msgsList</span> <span class="keyword">as</span> <span class="variable">$msgsItem</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$msgsItem</span>)) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//            $packed = [</span></span><br><span class="line"><span class="comment">//                &#x27;id&#x27; =&gt; $mid,</span></span><br><span class="line"><span class="comment">//                &#x27;ts&#x27; =&gt; $ts,</span></span><br><span class="line"><span class="comment">//                &#x27;sender&#x27; =&gt; $sender,</span></span><br><span class="line"><span class="comment">//                &#x27;message&#x27; =&gt; $message</span></span><br><span class="line"><span class="comment">//            ];</span></span><br><span class="line">            <span class="variable">$chat_id</span> = <span class="variable">$msgsItem</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">            <span class="variable">$sender</span> = <span class="variable">$msgsItem</span>[<span class="string">&#x27;sender&#x27;</span>];</span><br><span class="line">            <span class="variable">$message</span> = <span class="variable">$msgsItem</span>[<span class="string">&#x27;message&#x27;</span>];</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;redis-&gt;<span class="title function_ invoke__">zAdd</span>(<span class="string">&#x27;chat:&#x27;</span> . <span class="variable">$chat_id</span>, <span class="variable">$recipient</span>, <span class="variable">$seen_id</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Controller-subscribe"><a href="#Controller-subscribe" class="headerlink" title="Controller\subscribe"></a>Controller\subscribe</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">redis</span>\<span class="title class_">Controller</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * redisæ¶ˆæ¯è®¢é˜…</span></span><br><span class="line"><span class="comment"> * Class subscribe</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">subscribe</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$redis</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;redis = <span class="variable">$redis</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†å¸ƒæ¶ˆæ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $msgList</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">publisher</span> (<span class="params"><span class="keyword">array</span> <span class="variable">$msgList</span></span>) </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">sleep</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$msgList</span> <span class="keyword">as</span> <span class="variable">$msgItem</span>) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;redis-&gt;<span class="title function_ invoke__">publish</span>(<span class="variable">$msgItem</span>[<span class="string">&#x27;channel&#x27;</span>], <span class="variable">$msgItem</span>[<span class="string">&#x27;info&#x27;</span>]);</span><br><span class="line">            <span class="title function_ invoke__">sleep</span>(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¢é˜…ä¸æ¨é€</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array $channel</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">run_pubsub</span> (<span class="params"><span class="keyword">array</span> <span class="variable">$channel</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$pubsub</span> = <span class="variable language_">$this</span>-&gt;redis-&gt;<span class="title function_ invoke__">subscribe</span>(<span class="variable">$channel</span>, [<span class="variable">$this</span>, <span class="string">&#x27;callback&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å›è°ƒå‡½æ•°,è¿™é‡Œå†™å¤„ç†é€»è¾‘</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">callback</span>(<span class="params"><span class="variable">$instance</span>, <span class="variable">$channelName</span>, <span class="variable">$message</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$channelName</span>, <span class="string">&quot;==&gt;&quot;</span>, <span class="variable">$message</span>,PHP_EOL;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ¶ˆæ¯å‘é€å’Œè®¢é˜…"><a href="#æ¶ˆæ¯å‘é€å’Œè®¢é˜…" class="headerlink" title="æ¶ˆæ¯å‘é€å’Œè®¢é˜…"></a>æ¶ˆæ¯å‘é€å’Œè®¢é˜…</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">redis</span>\<span class="title">Controller</span>;</span><br><span class="line"><span class="keyword">require_once</span> <span class="title function_ invoke__">dirname</span>(<span class="keyword">__DIR__</span>) . <span class="string">&#x27;/Controller/Subscript.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$redis</span> = <span class="keyword">new</span> <span class="title class_">Redis</span>();</span><br><span class="line"><span class="variable">$redis</span>-&gt;<span class="title function_ invoke__">connect</span>(<span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="number">6379</span>);</span><br><span class="line"><span class="variable">$subClass</span> = <span class="keyword">new</span> \redis\Controller\<span class="title function_ invoke__">Subscribe</span>(<span class="variable">$redis</span>);</span><br><span class="line"><span class="variable">$subClass</span>-&gt;<span class="title function_ invoke__">run_pubsub</span>([<span class="string">&#x27;cat&#x27;</span>]);</span><br></pre></td></tr></table></figure><h1 id="å‘å¸ƒæ¶ˆæ¯"><a href="#å‘å¸ƒæ¶ˆæ¯" class="headerlink" title="å‘å¸ƒæ¶ˆæ¯"></a>å‘å¸ƒæ¶ˆæ¯</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">redis</span>\<span class="title">Controller</span>;</span><br><span class="line"><span class="keyword">require_once</span> <span class="title function_ invoke__">dirname</span>(<span class="keyword">__DIR__</span>) . <span class="string">&#x27;/Controller/Subscript.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$redis</span> = <span class="keyword">new</span> <span class="title class_">Redis</span>();</span><br><span class="line"><span class="variable">$redis</span>-&gt;<span class="title function_ invoke__">connect</span>(<span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="number">6379</span>);</span><br><span class="line"><span class="variable">$subClass</span> = <span class="keyword">new</span> \redis\Controller\<span class="title function_ invoke__">Subscribe</span>(<span class="variable">$redis</span>);</span><br><span class="line"><span class="variable">$subClass</span>-&gt;<span class="title function_ invoke__">publisher</span>([[<span class="string">&#x27;channel&#x27;</span>=&gt;<span class="string">&#x27;cat&#x27;</span>, <span class="string">&#x27;info&#x27;</span>=&gt;<span class="string">&#x27;thisofcat&#x27;</span>], [<span class="string">&#x27;channel&#x27;</span>=&gt;<span class="string">&#x27;cat&#x27;</span>, <span class="string">&#x27;info&#x27;</span>=&gt;<span class="string">&#x27;info&#x27;</span>]]);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä¿æŒPHPä¼šè¯ä¸€è‡´æ€§çš„æ–¹æ³•</title>
      <link href="/posts/d51ea391.html"/>
      <url>/posts/d51ea391.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€æ ¸å¿ƒè§£å†³æ–¹æ¡ˆ"><a href="#ä¸€ã€æ ¸å¿ƒè§£å†³æ–¹æ¡ˆ" class="headerlink" title="ä¸€ã€æ ¸å¿ƒè§£å†³æ–¹æ¡ˆ"></a>ä¸€ã€æ ¸å¿ƒè§£å†³æ–¹æ¡ˆ</h1><h2 id="1-é›†ä¸­å¼ä¼šè¯å­˜å‚¨ï¼ˆæ¨èæ–¹æ¡ˆï¼‰"><a href="#1-é›†ä¸­å¼ä¼šè¯å­˜å‚¨ï¼ˆæ¨èæ–¹æ¡ˆï¼‰" class="headerlink" title="1. é›†ä¸­å¼ä¼šè¯å­˜å‚¨ï¼ˆæ¨èæ–¹æ¡ˆï¼‰"></a>1. é›†ä¸­å¼ä¼šè¯å­˜å‚¨ï¼ˆæ¨èæ–¹æ¡ˆï¼‰</h2><p>   å°†ä¼šè¯æ•°æ®å­˜å‚¨åœ¨å…±äº«çš„ä¸­å¤®å­˜å‚¨ç³»ç»Ÿä¸­ï¼Œæ‰€æœ‰èŠ‚ç‚¹é€šè¿‡ç»Ÿä¸€æ¥å£è®¿é—®ã€‚</p><p>æ–¹æ¡ˆå¯¹æ¯”ï¼š</p><table><thead><tr><th>å­˜å‚¨ç±»å‹</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>Redisé›†ç¾¤</td><td>é«˜æ€§èƒ½ã€é«˜å¯ç”¨ã€è‡ªåŠ¨åˆ†ç‰‡</td><td>éœ€è¦é¢å¤–ç»´æŠ¤åŸºç¡€è®¾æ–½</td><td>ä¸­å¤§å‹é«˜å¹¶å‘ç³»ç»Ÿ</td></tr><tr><td>Memcached</td><td>ç®€å•å¿«é€Ÿ</td><td>æ— æŒä¹…åŒ–ã€æ— é›†ç¾¤åŸç”Ÿæ”¯æŒ</td><td>ä¸­å°å‹ä¸´æ—¶ä¼šè¯ç³»ç»Ÿ</td></tr><tr><td>MySQL</td><td>å¼ºä¸€è‡´æ€§ã€äº‹åŠ¡æ”¯æŒ</td><td>æ€§èƒ½ç“¶é¢ˆã€æ‰©å±•å¤æ‚</td><td>æ•°æ®æ•æ„Ÿå‹ç³»ç»Ÿ</td></tr></tbody></table><p>Redisé›†ç¾¤é…ç½®ç¤ºä¾‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// php.ini é…ç½®</span></span><br><span class="line">session.save_handler = redis</span><br><span class="line">session.save_path = <span class="string">&quot;tcp://redis1:6379,tcp://redis2:6379?auth=your_password&amp;timeout=2&amp;cluster=1&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åŠ¨æ€é…ç½®ï¼ˆä»£ç ä¸­ï¼‰</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;session.save_handler&#x27;</span>, <span class="string">&#x27;redis&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;session.save_path&#x27;</span>, <span class="string">&#x27;tcp://redis-cluster:6379?auth=your_password&#x27;</span>);</span><br></pre></td></tr></table></figure><h2 id="2-ä½¿ç”¨Memcachedçš„ä¼šè¯å¤åˆ¶ï¼ˆé€‚ç”¨äºå°å‹ç³»ç»Ÿï¼‰"><a href="#2-ä½¿ç”¨Memcachedçš„ä¼šè¯å¤åˆ¶ï¼ˆé€‚ç”¨äºå°å‹ç³»ç»Ÿï¼‰" class="headerlink" title="2. ä½¿ç”¨Memcachedçš„ä¼šè¯å¤åˆ¶ï¼ˆé€‚ç”¨äºå°å‹ç³»ç»Ÿï¼‰"></a>2. ä½¿ç”¨Memcachedçš„ä¼šè¯å¤åˆ¶ï¼ˆé€‚ç”¨äºå°å‹ç³»ç»Ÿï¼‰</h2><p>æ¯ä¸ªèŠ‚ç‚¹åŒæ­¥ä¼šè¯æ•°æ®åˆ°å…¶ä»–èŠ‚ç‚¹ï¼Œé€šè¿‡å¹¿æ’­æœºåˆ¶ä¿æŒä¸€è‡´æ€§ã€‚<br>å®ç°æ–¹å¼ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨Memcachedçš„ä¼šè¯å¤åˆ¶ï¼ˆç¤ºä¾‹ï¼‰</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;session.save_handler&#x27;</span>, <span class="string">&#x27;memcached&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;session.save_path&#x27;</span>, <span class="string">&#x27;server1:11211,server2:11211&#x27;</span>);</span><br></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ç¼ºç‚¹ï¼š</span><br><span class="line">ç½‘ç»œå»¶è¿Ÿå¯¼è‡´åŒæ­¥ä¸ä¸€è‡´</span><br><span class="line">æ‰©å±•æ€§å·®ï¼ˆèŠ‚ç‚¹æ•°å¢åŠ æ—¶æ€§èƒ½ä¸‹é™ï¼‰</span><br></pre></td></tr></table></figure><h2 id="3-JWTæ–¹æ¡ˆ"><a href="#3-JWTæ–¹æ¡ˆ" class="headerlink" title="3. JWTæ–¹æ¡ˆ"></a>3. JWTæ–¹æ¡ˆ</h2><p>å°†ä¼šè¯æ•°æ®åŠ å¯†å­˜å‚¨åœ¨å®¢æˆ·ç«¯ï¼ŒæœåŠ¡ç«¯æ— éœ€å­˜å‚¨çŠ¶æ€ã€‚</p><p>JWTå®ç°ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">Firebase</span>\<span class="title">JWT</span>\<span class="title">JWT</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”Ÿæˆä»¤ç‰Œ</span></span><br><span class="line"><span class="variable">$payload</span> = [</span><br><span class="line"><span class="string">&#x27;user_id&#x27;</span> =&gt; <span class="number">123</span>,</span><br><span class="line"><span class="string">&#x27;exp&#x27;</span> =&gt; <span class="title function_ invoke__">time</span>() + <span class="number">3600</span>,</span><br><span class="line"><span class="string">&#x27;data&#x27;</span> =&gt; [<span class="string">&#x27;role&#x27;</span> =&gt; <span class="string">&#x27;admin&#x27;</span>]</span><br><span class="line">];</span><br><span class="line"><span class="variable">$token</span> = JWT::<span class="title function_ invoke__">encode</span>(<span class="variable">$payload</span>, <span class="string">&#x27;your_secret_key&#x27;</span>, <span class="string">&#x27;HS256&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// éªŒè¯ä»¤ç‰Œ</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"><span class="variable">$decoded</span> = JWT::<span class="title function_ invoke__">decode</span>(<span class="variable">$token</span>, <span class="string">&#x27;your_secret_key&#x27;</span>, [<span class="string">&#x27;HS256&#x27;</span>]);</span><br><span class="line">&#125; <span class="keyword">catch</span> (<span class="built_in">Exception</span> <span class="variable">$e</span>) &#123;</span><br><span class="line"><span class="comment">// å¤„ç†éªŒè¯å¤±è´¥</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ³¨æ„äº‹é¡¹ï¼š</span><br><span class="line">éœ€é…åˆHTTPSé˜²æ­¢ä»¤ç‰Œæ³„éœ²</span><br><span class="line">ä»¤ç‰Œå¤§å°éœ€æ§åˆ¶åœ¨4KBä»¥å†…</span><br></pre></td></tr></table></figure><h1 id="äºŒã€é«˜çº§ä¼˜åŒ–ç­–ç•¥"><a href="#äºŒã€é«˜çº§ä¼˜åŒ–ç­–ç•¥" class="headerlink" title="äºŒã€é«˜çº§ä¼˜åŒ–ç­–ç•¥"></a>äºŒã€é«˜çº§ä¼˜åŒ–ç­–ç•¥</h1><h2 id="1-è¯»å†™ä¸€è‡´æ€§ä¿éšœ"><a href="#1-è¯»å†™ä¸€è‡´æ€§ä¿éšœ" class="headerlink" title="1. è¯»å†™ä¸€è‡´æ€§ä¿éšœ"></a>1. è¯»å†™ä¸€è‡´æ€§ä¿éšœ</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨Redisäº‹åŠ¡ä¿è¯åŸå­æ€§æ“ä½œ</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;<span class="title function_ invoke__">multi</span>()</span><br><span class="line">-&gt;<span class="title function_ invoke__">hSet</span>(<span class="string">&#x27;session:&#x27;</span>.<span class="variable">$sessionId</span>, <span class="string">&#x27;last_activity&#x27;</span>, <span class="title function_ invoke__">time</span>())</span><br><span class="line">-&gt;<span class="title function_ invoke__">expire</span>(<span class="string">&#x27;session:&#x27;</span>.<span class="variable">$sessionId</span>, <span class="number">3600</span>)</span><br><span class="line">-&gt;<span class="title function_ invoke__">exec</span>();</span><br></pre></td></tr></table></figure><h2 id="2-æ•…éšœè½¬ç§»æœºåˆ¶"><a href="#2-æ•…éšœè½¬ç§»æœºåˆ¶" class="headerlink" title="2. æ•…éšœè½¬ç§»æœºåˆ¶"></a>2. æ•…éšœè½¬ç§»æœºåˆ¶</h2><p>å“¨å…µæ¨¡å¼é…ç½®ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">session.save_path = <span class="string">&quot;tcp://sentinel1:26379?sentinel=mymaster&amp;auth=password&quot;</span></span><br></pre></td></tr></table></figure><p>è‡ªåŠ¨é‡è¯•ç­–ç•¥ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$redis</span> = <span class="keyword">new</span> <span class="title class_">RedisCluster</span>(<span class="literal">null</span>, [<span class="string">&#x27;redis-node1:6379&#x27;</span>, <span class="string">&#x27;redis-node2:6379&#x27;</span>], <span class="number">1.5</span>, <span class="number">1.5</span>, <span class="literal">true</span>, <span class="string">&#x27;password&#x27;</span>);</span><br><span class="line"><span class="variable">$redis</span>-&gt;<span class="title function_ invoke__">setOption</span>(<span class="title class_">RedisCluster</span>::<span class="variable constant_">OPT_SLAVE_FAILOVER</span>, <span class="title class_">RedisCluster</span>::<span class="variable constant_">FAILOVER_DISTRIBUTE</span>);</span><br></pre></td></tr></table></figure><h2 id="3-æ€§èƒ½ä¼˜åŒ–"><a href="#3-æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="3. æ€§èƒ½ä¼˜åŒ–"></a>3. æ€§èƒ½ä¼˜åŒ–</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Nginxé…ç½®ä¼šè¯äº²å’Œæ€§ï¼ˆç²˜æ€§ä¼šè¯ï¼‰</span></span><br><span class="line"><span class="section">upstream</span> backend &#123;</span><br><span class="line"><span class="comment"># ip_hash: æ¯ä¸ªè¯·æ±‚æŒ‰ç…§è®¿é—®ipï¼ˆå³Nginxçš„å‰ç½®æœåŠ¡å™¨æˆ–è€…å®¢æˆ·ç«¯IPï¼‰çš„hashç»“æœåˆ†é…ï¼Œè¿™æ ·æ¯ä¸ªè®¿å®¢ä¼šå›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œå¯ä»¥è§£å†³sessionä¸€è‡´é—®é¢˜ã€‚</span></span><br><span class="line">    ip_hash;</span><br><span class="line">    <span class="attribute">server</span> <span class="number">10.0.0.1:80</span>;</span><br><span class="line">    <span class="attribute">server</span> <span class="number">10.0.0.2:80</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€å®‰å…¨é˜²æŠ¤æ–¹æ¡ˆ"><a href="#ä¸‰ã€å®‰å…¨é˜²æŠ¤æ–¹æ¡ˆ" class="headerlink" title="ä¸‰ã€å®‰å…¨é˜²æŠ¤æ–¹æ¡ˆ"></a>ä¸‰ã€å®‰å…¨é˜²æŠ¤æ–¹æ¡ˆ</h1><h2 id="1-ä¼šè¯å®‰å…¨åŠ å›º"><a href="#1-ä¼šè¯å®‰å…¨åŠ å›º" class="headerlink" title="1. ä¼šè¯å®‰å…¨åŠ å›º"></a>1. ä¼šè¯å®‰å…¨åŠ å›º</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¼ºåˆ¶ä½¿ç”¨å®‰å…¨Cookie</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;session.cookie_secure&#x27;</span>, <span class="number">1</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;session.cookie_httponly&#x27;</span>, <span class="number">1</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;session.cookie_samesite&#x27;</span>, <span class="string">&#x27;Strict&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šæœŸæ›´æ¢Session ID</span></span><br><span class="line"><span class="title function_ invoke__">session_regenerate_id</span>(<span class="literal">true</span>);</span><br></pre></td></tr></table></figure><h2 id="2-æ•°æ®åŠ å¯†"><a href="#2-æ•°æ®åŠ å¯†" class="headerlink" title="2. æ•°æ®åŠ å¯†"></a>2. æ•°æ®åŠ å¯†</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨OpenSSLåŠ å¯†ä¼šè¯æ•°æ®</span></span><br><span class="line"><span class="variable">$iv</span> = <span class="title function_ invoke__">openssl_random_pseudo_bytes</span>(<span class="number">16</span>);</span><br><span class="line"><span class="variable">$encrypted</span> = <span class="title function_ invoke__">openssl_encrypt</span>(<span class="variable">$data</span>, <span class="string">&#x27;AES-256-CBC&#x27;</span>, <span class="variable">$key</span>, <span class="number">0</span>, <span class="variable">$iv</span>);</span><br><span class="line"><span class="variable">$redis</span>-&gt;<span class="title function_ invoke__">set</span>(<span class="variable">$sessionId</span>, <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$iv</span>.<span class="variable">$encrypted</span>));</span><br></pre></td></tr></table></figure><h1 id="å››ã€ç›‘æ§ä¸ç»´æŠ¤"><a href="#å››ã€ç›‘æ§ä¸ç»´æŠ¤" class="headerlink" title="å››ã€ç›‘æ§ä¸ç»´æŠ¤"></a>å››ã€ç›‘æ§ä¸ç»´æŠ¤</h1><h2 id="1-å…³é”®ç›‘æ§æŒ‡æ ‡"><a href="#1-å…³é”®ç›‘æ§æŒ‡æ ‡" class="headerlink" title="1. å…³é”®ç›‘æ§æŒ‡æ ‡"></a>1. å…³é”®ç›‘æ§æŒ‡æ ‡</h2><table><thead><tr><th>æŒ‡æ ‡</th><th>å‘Šè­¦é˜ˆå€¼</th><th>ç›‘æ§å·¥å…·</th></tr></thead><tbody><tr><td>ä¼šè¯å­˜å‚¨å»¶è¿Ÿ</td><td>&gt;100ms</td><td>Prometheus+Grafana</td></tr><tr><td>Rediså†…å­˜ä½¿ç”¨ç‡</td><td>&gt;80%</td><td>Redis-cli INFO</td></tr><tr><td>ä¼šè¯ä¸¢å¤±ç‡</td><td>&gt;0.1%</td><td>ELKæ—¥å¿—åˆ†æ</td></tr></tbody></table><h2 id="2-ç¾å¤‡æ–¹æ¡ˆ"><a href="#2-ç¾å¤‡æ–¹æ¡ˆ" class="headerlink" title="2. ç¾å¤‡æ–¹æ¡ˆ"></a>2. ç¾å¤‡æ–¹æ¡ˆ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Redisé›†ç¾¤æ•°æ®å¤‡ä»½</span></span><br><span class="line">redis-cli --cluster backup redis-node1:6379 --backup-dir /backups</span><br></pre></td></tr></table></figure><h2 id="äº”ã€æ–¹æ¡ˆé€‰å‹å»ºè®®"><a href="#äº”ã€æ–¹æ¡ˆé€‰å‹å»ºè®®" class="headerlink" title="äº”ã€æ–¹æ¡ˆé€‰å‹å»ºè®®"></a>äº”ã€æ–¹æ¡ˆé€‰å‹å»ºè®®</h2><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ä¸­å°å‹ç³»ç»Ÿï¼šRedisä¸»ä» + å“¨å…µ</span><br><span class="line">å¤§å‹åˆ†å¸ƒå¼ç³»ç»Ÿï¼šRedis Cluster + è‡ªåŠ¨åˆ†ç‰‡</span><br><span class="line">æ— çŠ¶æ€æœåŠ¡ï¼š<span class="keyword">JWT </span>+ å®¢æˆ·ç«¯å­˜å‚¨</span><br><span class="line">ä¼ ç»Ÿæ¶æ„ï¼šæ•°æ®åº“å­˜å‚¨ + è¯»å†™åˆ†ç¦»</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
          <category> ä¸šåŠ¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¢è¯• </tag>
            
            <tag> phpé¢è¯• </tag>
            
            <tag> åˆ†å¸ƒå¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®ä¿¡å°ç¨‹åº</title>
      <link href="/posts/4618cb0a.html"/>
      <url>/posts/4618cb0a.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">å¾®ä¿¡å°ç¨‹åºåˆ†äº«å’Œåˆ†äº«åˆ°æœ‹å‹åœˆåŠŸèƒ½</span><br><span class="line"><span class="number">1.</span> tså†™æ³•</span><br><span class="line">&lt;script lang=<span class="string">&quot;ts&quot;</span> setup&gt;</span><br><span class="line">    <span class="keyword">import</span> &#123; onShareAppMessage, onShareTimeline &#125; <span class="keyword">from</span> <span class="string">&quot;@dcloudio/uni-app&quot;</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†äº«</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@link</span> https://uniapp.dcloud.net.cn/api/plugins/share.html</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@link</span> https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onShareAppMessage-Object-object</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="title function_">onShareAppMessage</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&#x27;è‡ªå®šä¹‰åˆ†äº«æ ‡é¢˜&#x27;</span>, <span class="comment">// é»˜è®¤å½“å‰é¡µé¢title</span></span><br><span class="line">            <span class="comment">// path: &#x27;/pages/map/map&#x27;, // é»˜è®¤å½“å‰é¡µé¢åœ°å€</span></span><br><span class="line">            <span class="attr">imageUrl</span>: <span class="string">&#x27;../../static/share_cover.jpg&#x27;</span> <span class="comment">// é»˜è®¤å½“å‰é¡µé¢æˆªå›¾</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†äº«åˆ°æœ‹å‹åœˆ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@link</span> https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onShareTimeline</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="title function_">onShareTimeline</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&#x27;è‡ªå®šä¹‰åˆ†äº«æ ‡é¢˜&#x27;</span>,</span><br><span class="line">            <span class="comment">// query: &#x27;&#x27;, // å‚æ•°</span></span><br><span class="line">            <span class="attr">imageUrl</span>: <span class="string">&#x27;../../static/share_cover.jpg&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> étså†™æ³•</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">onShareAppMessage</span>(<span class="params">res</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (res.<span class="property">from</span> === <span class="string">&#x27;button&#x27;</span>) &#123;<span class="comment">// æ¥è‡ªé¡µé¢å†…åˆ†äº«æŒ‰é’®</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">target</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;è‡ªå®šä¹‰åˆ†äº«æ ‡é¢˜&#x27;</span>,</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/pages/test/test?id=123&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
          <category> js </category>
          
          <category> å¾®ä¿¡å°ç¨‹åº </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¾®ä¿¡å°ç¨‹åº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>tableå›ºå®šåˆ—</title>
      <link href="/posts/b741af1a.html"/>
      <url>/posts/b741af1a.html</url>
      
        <content type="html"><![CDATA[<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/*tableæ»šåŠ¨å¼€å§‹*/</span></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.scroll</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">overflow-x</span>: auto;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding-bottom</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.scroll</span> <span class="selector-class">.warp</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="comment">/*ç”±äºtable_layoutä¸ºè‡ªåŠ¨ï¼Œåç»­æ”¹æˆfixedï¼Œtdæ ¹æ®å®½åº¦è®¾ç½®æ—¶åˆ é™¤*/</span></span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">2000px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">max-width</span>: <span class="number">2000px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.scroll</span>::-webkit-scrollbar &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">6px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">6px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.scroll</span>::-webkit-scrollbar-thumb &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">3px</span>;</span></span><br><span class="line"><span class="language-css">    -webkit-<span class="attribute">box-shadow</span>: inset <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.2</span>);</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#0076f5</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.scroll</span>::-webkit-scrollbar-track &#123;</span></span><br><span class="line"><span class="language-css">    -webkit-<span class="attribute">box-shadow</span>: inset <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.2</span>);</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.1</span>);</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/*åˆ—å›ºå®šå¼€å§‹*/</span></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.scroll</span> <span class="selector-tag">table</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.position-fixed-left</span>, <span class="selector-class">.position-fixed-right</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">position</span>: sticky;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">z-index</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#FFFFFF</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.position-fixed-left</span><span class="selector-pseudo">:hover</span>, <span class="selector-class">.position-fixed-right</span><span class="selector-pseudo">:hover</span>,</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.position-fixed-left</span><span class="selector-class">.active</span>, <span class="selector-class">.position-fixed-right</span><span class="selector-class">.active</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#f5f5f5</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.position-fixed-left</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.position-fixed-right</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">right</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.position-operate</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="comment">/*å›ºå®šåˆ—å¹¶ä¸”table_layoutè‡ªåŠ¨æƒ…å†µä¸‹è®¾ç½®ï¼Œé˜²æ­¢å®½åº¦è¿‡å¤§*/</span></span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"><span class="comment">/*åˆ—å›ºå®šç»“æŸ*/</span></span></span><br><span class="line"><span class="language-css"><span class="comment">/*tableæ»šåŠ¨ç»“æŸ*/</span></span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot; scroll &quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">&quot;table-class warp&quot;</span> <span class="attr">id</span>=<span class="string">&quot;memberList&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;position-fixed-left&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 50px; left: 0px;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;checkbox-common&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;&quot;</span>&gt;</span>åˆ—1<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;&quot;</span>&gt;</span>åˆ—2<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">&quot;position-fixed-right&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 320px;&quot;</span>&gt;</span>æ“ä½œ<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tbody</span> <span class="attr">id</span>=<span class="string">&quot;productTbody&quot;</span> <span class="attr">style</span>=<span class="string">&quot;text-align: center;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">rowspan</span>=<span class="string">&quot;1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;position-fixed-left&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;checkbox-common&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">class</span>=<span class="string">&quot;checkbox-input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">value</span>=<span class="string">&quot;70&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sub&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>æ•°æ®1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>&gt;</span>æ•°æ®2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">rowspan</span>=<span class="string">&quot;1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;position-fixed-right&quot;</span> <span class="attr">style</span>=<span class="string">&quot;white-space: nowrap;&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">button</span>&gt;</span>è¯¦æƒ…<span class="tag">&lt;/<span class="name">butotn</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// å›ºå®štableåˆ—,é‡æ–°è®¡ç®—è·ç¦»</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">function</span> <span class="title function_">position_fixed</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    $.<span class="title function_">each</span>($(<span class="string">&#x27;.position-fixed-left&#x27;</span>), <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        $(<span class="variable language_">this</span>).<span class="title function_">css</span>(<span class="string">&#x27;left&#x27;</span>, $(<span class="variable language_">this</span>).<span class="title function_">position</span>().<span class="property">left</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    $.<span class="title function_">each</span>($(<span class="string">&#x27;.position-fixed-right&#x27;</span>), <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        $(<span class="variable language_">this</span>).<span class="title function_">css</span>(<span class="string">&#x27;right&#x27;</span>, $(<span class="variable language_">this</span>).<span class="title function_">position</span>().<span class="property">right</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linuxæŸ¥çœ‹ç™»å½•æ—¥å¿—</title>
      <link href="/posts/ad54ee0c.html"/>
      <url>/posts/ad54ee0c.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>linuxç³»ç»Ÿçš„ç™»é™†æ—¥å¿—åœ¨&#x2F;var&#x2F;log&#x2F;wtmpæ–‡ä»¶é‡Œï¼Œç™»é™†å¤±è´¥æ—¥å¿—åœ¨&#x2F;var&#x2F;log&#x2F;btmpé‡Œï¼Œä½†æ˜¯ç›´æ¥æŸ¥çœ‹æ˜¯éƒ¨åˆ†ä¹±ç ï¼Œè€Œlastã€lastbå‘½ä»¤å°±æ˜¯ç”¨æ¥æŸ¥çœ‹è¿™äº›æ–‡ä»¶çš„</p><p>last å‘½ä»¤ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">åŠŸèƒ½è¯´æ˜ï¼šåˆ—å‡ºç›®å‰ä¸è¿‡å»ç™»å…¥ç³»ç»Ÿçš„ç”¨æˆ·ç›¸å…³ä¿¡æ¯ã€‚</span><br><span class="line">ã€€ã€€è¯­ã€€ã€€æ³•ï¼šlast <span class="selector-attr">[-adRx]</span><span class="selector-attr">[-f ]</span><span class="selector-attr">[-n ]</span><span class="selector-attr">[å¸å·åç§°...]</span><span class="selector-attr">[ç»ˆç«¯æœºç¼–å·...]</span></span><br><span class="line">ã€€ã€€è¡¥å……è¯´æ˜ï¼šå•ç‹¬æ‰§è¡ŒlastæŒ‡ä»¤ï¼Œå®ƒä¼šè¯»å–ä½äº/<span class="selector-tag">var</span>/logç›®å½•ä¸‹ï¼Œåç§°ä¸ºwtmpçš„æ–‡ä»¶ï¼Œå¹¶æŠŠè¯¥ç»™æ–‡ä»¶çš„å†…å®¹è®°å½•çš„ç™»å…¥ç³»ç»Ÿçš„ç”¨æˆ·åå•å…¨éƒ¨æ˜¾ç¤ºå‡ºæ¥ã€‚</span><br><span class="line">ã€€ã€€å‚ã€€ã€€æ•°ï¼š</span><br><span class="line">ã€€ã€€-<span class="selector-tag">a</span> ã€€æŠŠä»ä½•å¤„ç™»å…¥ç³»ç»Ÿçš„ä¸»æœºåç§°æˆ–IPåœ°å€ï¼Œæ˜¾ç¤ºåœ¨æœ€åä¸€è¡Œã€‚</span><br><span class="line">ã€€ã€€-d ã€€å°†IPåœ°å€è½¬æ¢æˆä¸»æœºåç§°ã€‚</span><br><span class="line">ã€€ã€€-f  ã€€æŒ‡å®šè®°å½•æ–‡ä»¶ã€‚</span><br><span class="line">ã€€ã€€-n æˆ–- ã€€è®¾ç½®åˆ—å‡ºåå•çš„æ˜¾ç¤ºåˆ—æ•°ã€‚</span><br><span class="line">ã€€ã€€-<span class="attribute">R</span> ã€€ä¸æ˜¾ç¤ºç™»å…¥ç³»ç»Ÿçš„ä¸»æœºåç§°æˆ–IPåœ°å€ã€‚</span><br><span class="line">ã€€ã€€-<span class="attribute">x</span> ã€€æ˜¾ç¤ºç³»ç»Ÿå…³æœºï¼Œé‡æ–°å¼€æœºï¼Œä»¥åŠæ‰§è¡Œç­‰çº§çš„æ”¹å˜ç­‰ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯æŒ‡å®šwtmpå’Œbtmpæ—¥å¿—æ–‡ä»¶</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">last</span> -f /<span class="built_in">var</span>/<span class="built_in">log</span>/wtmp</span><br><span class="line">$ <span class="built_in">last</span> -f /<span class="built_in">var</span>/<span class="built_in">log</span>/btmp</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linuxé™åˆ¶ç™»å½•æ¬¡æ•°</title>
      <link href="/posts/712733f4.html"/>
      <url>/posts/712733f4.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>é€šè¿‡pamæ¨¡å—ï¼Œé™åˆ¶ç”¨æˆ·ç™»å½•å¤±è´¥æ¬¡æ•°ï¼Œè¾¾åˆ°é˜ˆå€¼ï¼Œé”å®šæ‰€æœ‰ç”¨æˆ·ç™»å½•</p><h1 id="ä¸€ã€æŸ¥çœ‹pamæ¨¡å—"><a href="#ä¸€ã€æŸ¥çœ‹pamæ¨¡å—" class="headerlink" title="ä¸€ã€æŸ¥çœ‹pamæ¨¡å—"></a>ä¸€ã€æŸ¥çœ‹pamæ¨¡å—</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ll /usr/lib64/security/pam_tally2.so</span></span><br></pre></td></tr></table></figure><h1 id="äºŒã€ssh-è¿œç¨‹ç™»å½•é™åˆ¶"><a href="#äºŒã€ssh-è¿œç¨‹ç™»å½•é™åˆ¶" class="headerlink" title="äºŒã€ssh è¿œç¨‹ç™»å½•é™åˆ¶"></a>äºŒã€ssh è¿œç¨‹ç™»å½•é™åˆ¶</h1><ol><li>åœ¨&#x2F;etc&#x2F;pam.d&#x2F;sshdæ–‡ä»¶ä¸­æ·»åŠ é…ç½®<br>åœ¨#%PAM-1.0çš„ä¸‹é¢ï¼Œå³ç¬¬äºŒè¡Œï¼Œæ·»åŠ å†…å®¹ã€‚å¦‚æœå†™åœ¨åé¢ï¼Œè™½ç„¶ç”¨æˆ·è¢«é”å®šï¼Œä½†æ˜¯åªè¦ç”¨æˆ·è¾“å…¥æ­£ç¡®çš„å¯†ç ï¼Œè¿˜æ˜¯å¯ä»¥ç™»å½•ã€‚<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># deny=3 è¡¨ç¤ºå°è¯•ç™»å½•æ¬¡æ•°,è¶…è¿‡3æ¬¡åä¼šæ‰§è¡Œåç»­åŠ¨ä½œ,å•ä½ä¸ºç§’</span></span><br><span class="line"><span class="comment"># even_deny_root å¯¹rootä¹Ÿå¼€å¯æ­¤é™åˆ¶</span></span><br><span class="line">auth required pam_tally2.so <span class="attribute">deny</span>=3 <span class="attribute">unlock_time</span>=3600 even_deny_root <span class="attribute">root_unlock_time</span>=1800</span><br></pre></td></tr></table></figure></li></ol><h1 id="ä¸‰ã€tty-è¿œç¨‹ç™»å½•é™åˆ¶"><a href="#ä¸‰ã€tty-è¿œç¨‹ç™»å½•é™åˆ¶" class="headerlink" title="ä¸‰ã€tty è¿œç¨‹ç™»å½•é™åˆ¶"></a>ä¸‰ã€tty è¿œç¨‹ç™»å½•é™åˆ¶</h1><ol><li>åœ¨ &#x2F;etc&#x2F;pam.d&#x2F;login æ–‡ä»¶ä¸­æ·»åŠ é…ç½®<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># deny=3 è¡¨ç¤ºå°è¯•ç™»å½•æ¬¡æ•°,è¶…è¿‡3æ¬¡åä¼šæ‰§è¡Œåç»­åŠ¨ä½œ,å•ä½ä¸ºç§’</span></span><br><span class="line"><span class="comment"># even_deny_root å¯¹rootä¹Ÿå¼€å¯æ­¤é™åˆ¶</span></span><br><span class="line">auth required pam_tally2.so <span class="attribute">deny</span>=3 <span class="attribute">unlock_time</span>=3600 even_deny_root <span class="attribute">root_unlock_time</span>=1800</span><br></pre></td></tr></table></figure></li></ol><h1 id="å››ã€æŸ¥çœ‹æœ€åç™»å½•å¤±è´¥çš„ç”¨æˆ·"><a href="#å››ã€æŸ¥çœ‹æœ€åç™»å½•å¤±è´¥çš„ç”¨æˆ·" class="headerlink" title="å››ã€æŸ¥çœ‹æœ€åç™»å½•å¤±è´¥çš„ç”¨æˆ·"></a>å››ã€æŸ¥çœ‹æœ€åç™»å½•å¤±è´¥çš„ç”¨æˆ·</h1><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·</span></span><br><span class="line"><span class="variable">$ </span>pam_tally2 -u</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æŒ‡å®šç”¨æˆ·</span></span><br><span class="line"><span class="variable">$ </span>pam_tally2 -u ç”¨æˆ·å -r</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¨¡æ¿å¼•æ“</title>
      <link href="/posts/1eee99d3.html"/>
      <url>/posts/1eee99d3.html</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="æŠ±æ­‰, è¿™ä¸ªå¯†ç çœ‹ç€ä¸å¤ªå¯¹, è¯·å†è¯•è¯•." data-whm="æŠ±æ­‰, è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹.">  <script id="hbeData" type="hbeData" data-hmacdigest="8cd1091a573c7cb88be57c95896639c3630e449cf306f1c7f79d94eed5357281">bbb879bf3d66ea4849d210dc8822f289dd8efcb189c33003bddceeb3f6351cf2807edf15e5149c0f8f6f96cdbec346ee8d36e465341b9a7faa4b21b797cc6dc67281eee569cde4847b5ced1c97fbb5ba1288b2cdbf1f056fab11177e114ddb3289c875b96d73178b90c60f6bdcdf58ba17a807c92ff2808301129f0536846247772483dd434eb20986116f9ef7b45f0be4da2a0dbeab7b7c6312aa0ca0e3ebb071be073a12b011375026fd5bf76f3e503d49c2b647d50b74f1da481ed381a87a0f9b29e83353b95c5d45132c66e3e56c09d29d2df1615f641511f881a9955d0f1845281e9f6a65f91223813efa07f7df14addaf5121ce4681376e5d5278442a14e06eefb6f4443e99f8051580240d1d210d8aa0be43dc257e29e2a316f2de7eb425d858bcd1feef8242e2afc76c106f581a57ea17428605ddb7dda5834812ea0b3bf7693a6c0e0f193c45089b061abbbee5c0d8cbc49dabf14077b00ecd2c9669a11830f3efbaee2cbe792fc81b58d599d1acb895c285473df601cb64ebbd232a3d8196efabfd32b172fa9d23ae953f46a73812f181f68783550a569c0a330745ec31123b2c2384901735abd8d7eb5fb8da8cdc4eb25f593686b001509f45417ef008f1c8c983c8e54afd96a075dbf3494e192cdfc00f431f6ca9cd973bc10a0707e6982ec236b4227927402ffff1724b1817400bcf58c63d1a1dddbf0845e8ba38a900ac191f0be5abbda5c08cc23b654c727f9ddb9ffb731a5fc8605ea06cb6f40f6e376fa0e82af25d3a00b6bea302216a44d6c752ea3f2212c9324bc19fc489650c918cd34cea9d6252b072019d5d1159be66b845aa8c8136a53731c60d7f200aea4996149f0acd9eea945f97175dd7b310a5bc8dde8556d3d8bc8108601874ed5696e0d90354845da61166192fda674fa8c5446978cf327471df4e41eabb195b1b2a0dc8b77485b3a05d13f17e01def6d8c525823c7aed2cc1118b4ad8684e68a5f205d09335d7e5bed292ee691d6ba7284d436b07b75b8708733159deb456e1f616e38b281e0650066cea5b3c57626fa4d96a94d563c341a81a092afbfc499ece151a42d63dc72553ae66e56447ace02418c4d3a0014c5412029c44b1f02e841d4ea7cbd38d2a9d24b846d126b16e00db3e3c92332777c59ddfdf7edafd37ed1f546fef207028a51feadfa1f6a261003892244bbfc8af4a4f237b784452a316370c2e8e43636378804f13541235c5efb7c4080eeda66689665f7d874bc778d395ac82dc0cfd9ace7e441f73dacfb3cbc5a693840528b9d878dfcb33a6091c835073dc66f0a2de51bbfaa67ac36bd7a4f2e3fec30ac7274db05913c2f186adab96c955f659fc8e38ad6363931315106bb5dbc305ba673d12ad3f928847001aae7a7fc244cf2fc8bc189333d6172a2cabe28c42fec3a9f85a84b2a2904f97a5c05429181b9076345e63df4139d7c680fda41f196a82971ebf67933055a9dd5d11336692817387bbd9304f077e4c6890d5a8d6b9a40780132f047e8749e9bd6d0e05e4ba3e45406d63da83d1edcb6ff61324f53e03d88782439b4717dd0d6dd2f00c0fa44740a7ba3eca622c06d2a72a93c7098fc019c1c28c45257f5edc162cd1482f066d263b7808ebb1bbd8311fc94d8dac1c3560877f51108a436401e2db0baa77e78cf57f005f43716669f262073bd4c98d3fb6f1dee2c19db313d9e5c3b22fd11241498080b8b6d49f8e0be60b0041f23056fa876df01c8d1c179ca894ce003a7850bcac0534db00a2d30e217dd79fe4e64f0fd2657703162f9cb4dd04568f45559ebb68926b26aa760c238f280911b286eb5f962ef3e277a063fb536cdafa3735f529a4776d60ee2b7fbfab797489f49a08df7abcd4d53d64776a014a1f2fbc577dd46be298d6994d7dd6fc8b385d95658d5e1551260410a8499749d0a8e8e0614369bdd18097aa09c3b3d9e3e252c254cd174e02e58e5090b8e743453a808560167f26a712bd8939d4a2180203d8df135a0599f69e184b9c655984468ebff6808d7c4f1c0562696f22eb72271b7b56a8d31c92fe3a86dcd55440da843e34609a9ff01fea252c15e236b80bb6ae6fbebc33767dbc9e553bacefe4cb136665325df3f83124831d5fcdc31ba51ced895ca9362cbbfbd9f4881692636b0b8c51cbf984eb5deb4f163a561f0156bd61a3e1f7aeced643bd6c861b4c7af422284c41fd69d3388593c9a7acbe71f95bf59cb8d92a06eefc804a3bf8f22f2bcd9a15d08cd7586813d99fea73cd285bdbfedccac7e0840329e11f577b02deb8650080c32f3e56be8581c5a7b289e6b4a7cd43218af7cd77d5c119ad0378a20cd246f4bca7002cbaf8debc6a5f3dd303816341b585878c877a3f6451a08ee35ca2b753b975af9fb0a4c219581404e7c2db2073aa3505cba9cc75bdf9a30b10d44493beca26f49382292058d72783bdeb9b2ac40cf499d8a1c3a0dc4918777b7943eafe4174c1d41439b7a237b241c06100b2d8d3b871685e046374bc4c32a82c1d0f9ee78aee6143d05d4f8086c249f283bef31abcd4a05ba7cfb4acdb8384a4c8eaaa1655f2ce6072606b26fca71d6adf6381c39c7bacd16ad1f8fdd0b5c77971825efbcaafe50f2f64eb2f977f3e8d8e7288631a587bb72d94f4456ba869f56d8173b3b9d38d2737356e6b778450a313561b875aa19a8884403cafe39d0680682bee07ae660a38b0c72788427d4eaa642e733e502a1f7de9ddbe26198327dbb892f1e3bc0e726099f5aad2e6f72b7b0eb00621725f0b1a50c059ca948903897d78b7497b57f5f8bd121b37f7cf4e00ec52eb57bd961be7478522a718608c694b429b63ea8b02d03130f32ab62f2c020f71167d39f1ca657b472c8d1c47c7f48b39bada88bed36265ec7f611e2c352385f4a33a0b27d3fa239434a5be859410d46be6e2e70459e7eca49842def63bed46c5cf1c04b2a8bb2a7f3f20b46d4bc04b20393953f2336c5e1f987412729a78abba178d12797226f8cf34344a94d591cc8033ee6a2b6eda0d750a173afc5b82479031bcdbbc799e19aa04c90e3741fb00715388da02fc7296bbf2953d9258a937b1e610844b6f60a948874431528b37a3045c998ded0f6180c3540e79d50ac13216c9525c6b461f37c1d7729aae231c57e55f9850e0c889d78ce65984e220792831ebb6e0bd9f701b6ac097b46af165f037aaa5011742e15d58ff194c864956c0835ea5b73d512fa25ad66435db7ecb2a06cde94a7900ef76ef0b56996ff1e5fefb62d3d3b336a6caf6e1bafa1f13d26e874eb19533ad35a8c2911755e0b705f39b35907b898d1121afbc199967bbd7885948f24ea4c39794d412f46eec74e8e657bca32507f6e7810aa1cc2352b7f04704e42a44b69abca188f4795a36991d099a0af89a8861c5fd2baab18d655db3fb423e349961e942bc2cd9e0dd9da489c5c71fdc5e80b20f8704c3152be165f0a02642d4e4986e2a3434c18bc157b3593936cd2a0e5541cd97f0a348ae9fb9267ecae875a53276b450ccbea8e9771b6088da03991a287edbeae86338b54b551999355a4085c99ffde7609a630c342a7862d65132a511d844af874fd68176d8b99dca7a93773dc90146bc54f5162ee1f9ee84f11cefa64e18b036c9230ade017cd2515a3f480150e7f23830d588721c4ab10dcd527c1932e9e8523a2e0b18f690393742d8afaedc31c47516eea55fc32b985a715ae0d3d8564a7812003bcc5b027a7be98f7927cd5f5f181f77188e8a6f106a408290d76c8e1f586cfa784dae4337a159f79580f6f6142cc780e4572617f9265189287f3e6cb7ca741c030b870ade81edec85695b87f82eaab3074b19b12bf059a530efbe056654bf2bbb6b5747bb85fc947fc56d50b9115ba09d684b6d599f3cce548db5061311f1be232a80973808571e9df3fbb0daf95f659a528f983318a61cb6740172a21327bd51451f7b80f3dc2598ba84b22602ec0876dc709fc5220c289e07f7698ba541554e5623db0706f8633e4cda3e7b5dedb52a30f2588e1d53503a8c6282af47ae78aac6357bbe1bcc6ac4718003ff53a153c422d79bc11e9d758557b5ec4dbd458bf156d84e769be937582a522a49b5c15d85e40306b7d211165142afde83835cca9c0ad3170ccf3c44ff2fd5593b3c0787ed06d34ee91f2cbbd280395e7d73a1041ea30251981d80ec73f2f5bf2b73f22de0b69a6b2a5282ad1b21505ebf3d9ea27f432142308eefd11e931ef56b614c6359eaa9434015460142aef39b3dc2032efa0aaf7d4eb426696f9d99dbea7c63b7018804b5e91483d09e3e28a04c6e60a204b06532de052d5976fe3aa693362518d8b5b8596f7ff9145be74dbe15f36cc1d4731d6974749e8f9ccd7f2653e1961da64db4969ac6a76d67fe2b6eceb0614494407331343e2771e27115ce1612bb8ea9ab1f4a9613391780cb14ce16c4ed2c2689cc1391f588fb1f9312d28a87dbe0c9226aae345bc836a26add13da5965bcf73a02c5482ac3ef027f10aa38bb87ca5ab2caecd4b3e13ba9737070bb5b2313cfc6f5601e10d6f02a2372494e80c6508ca9a84b42c5ad456ff4c129160915def958552df28faf937b68705ac52fc8b2ab70830168178b73ede2d4319ae13fc6e87d3fb28c64a4e703d2cda7cd570c77bed979915124998a73c2d1f9795e3e81a1c94dd29ac40b0e180e57ff748833629981f92df137132440c8520f499fa1883eaa2a885e3bc317cea4f2e8175437787c379938ca3248683a8e66098361c1a6768afdc29f4891d454615113ff3a6981db12f9d4a8fa07bd251dfef3019ec0b7e784ccf5feba256981f6d797944c800e55850b4826ffc5e87782fc24555f3ffe54b70e2e738f70207708de817c11eb0be1b1e00836276dc3c4074a1b3e0accbf385d5cd30f4042f7f7f29070a89698d4cb64b71f02ddeabaf81e7ec5b8794f9cb4385ec1115b0b038895e7a59f520a63081247131baba0308e999aa04376b6fb2900c4eb14f2d8937f1e8b3defd0c66d26dc2855c4bd6127ddca7a4a68b627285eaa18458716e13b84d254d4f40139da2bcfe6e06e4aa83eeb23958db4e0b5723e8fc40fdb958cc61dd3a4c45d55b212163e5565d771b3f9dbc501f27d86f2207036db2a23a0051933526eebdf41924a0de99756d8ec6849d9a57db6e4df58b7973eaf11ecb96ef207b0e5e86769c3bd6aef31f4183bcb99b2f8bdd9d59d42e2d20c5254d48ee58d32c8f617d7097088d22276b77fe3c12b7a1e159087266f72a89a6e276a357b797039f53513dd142ccbb48a6a66bf992c9c90bae09969306afd00627cd54888aaa52805c903e35aab56125f06a5e2a2c79ffc98ecbff9c66c8245488324654b7e6cdeda1bba2fd619066859dc0e0b24a6bed1507fadf72f8bda328b77aa4054c4069691c25286b2c9e965e8eb029f9f28bfa239ecef0fe568f0ad78d3e76f29fa139ebf73b23c366201f042755f11d4b07159b1ca9125af831afb536292c1cc03fab326a51f1ca283d3ed2556cf1d93be9dd80557758926c94518cd97beb0c52ffe7e60917f1a75e71487672fd128c35dc140019b8a6d12a9e96e11c4bb76932e0553c683230c7b2a873c75a4fdaf72c08cd15b1d6137aafcfe30da05489ed949badccc1f9c8282f17408dc0582cde64b9aed412877c2024f01bb63dece112f8dae2f847352eadfccbd05fbffc7d25088b0208ad44f355e0fb68f99e71481a853427eae706d742990d1c1ae79c1b34acd1503ae56cb38accf63834915dba6126586edb48421c04f3f2f803f3f9d1adcfc05d5a02f1d5575d469a233af1f91cccac015ca108b88f6fba2c7f34803a994dfb5b2737e9f58fe3c389fbd1dca73df952e5cf36d4af4ecfae247e74bf3a75f977eb3e6a17f5bf1913cd48449e3224d97d07bc3b81ae31beee184d7be68bf312aaeefcfddb603ac7dd667a890a42d0818798307f3806c91d47bff5ba0916d40dd1255c453c9d99ab5d90eede491dd867645f29025c1e242e859b81be06d4378f1caa31c201164aa00fbd5b14ebad792719420fafb8903e7a47d0385a82294d7ec6594f741a46f6c51a181d6c5dd72f4c96accb02bc0ee678bd2eb449aed37b84f097978b02c665f41e35cb857b20b6589065433b595f930a924bb5207c902e57d79aa3239e1fc70f498e17aca167220697d607cd328b223adb76a2b0bccd3b9ed49591df6d6412ba435a1597fecaf3a33f21ee33f33571533137e1c098a499113c0a7c6e8ccac2cc057220b01f13431a9b8b03349f1e8423f14905f321eb11d2df6742fcc15464f800fffccc84c3e4afbf16aca01f343c83a6de1cbd3b6745885db165c3a0c7ba114ab84d9dd6196325561a1119cf29e1f3a1fa0fedac163e022ad4b7b7c99a70de3d89e6eebc4d641593986d56d56a96aa5574b60a324d056c8a2f66bbeb146e156ceefb343e2d00ea6c99b97f6371da9e1f3342e9f88966e3c1de986fbac328f094466392f588070c9d21cd274b27d6f8c932287a838de53ffc5d3b3958ba991e66e6d8bd85e44aaafde8def1019a1158c61144bf9f409e4dae225937def2eb0d7d970fb466eafa7442e7301940926cab20a2dbd2978c996c985de8dd0114e6c5df3b7132718791c1bd1f0761733beb94408ff476e9e8c75c551d1249d73661bcb398f87cdd8ddeb213d597a1d4e7d0eb0fd7c709b38cf9b45394883de9e665cc6076b002ccc1194084b37c0eda13472631b2f3dfdbf60805907f231940f8e13c0ccd59470d0cc2a1817b2ac0a7448ffcb6d72162f7499ea86047ffecee2dd84ec610b3567cbbc93455dab56504ea9bc0e231c5bbb91b75b5344ba17ce838d8849b0a31b2f6b4870e889b308191b46f7b21731f4473b32a8bd52a569de6b6c3b69925eb12c2f843f7b03bb152f407d01237d05100fdb295614c2b5a627b6dea18333292b2eddcbf1f7a6a45f3e20f6ee1d31eb04878e4a27595420394f6136bdabdb6fa192405baa43478e2801515f595c74ce491fab2c8aeae0fb7e26e7895e87e6b7f54601c9ea78fc8dbedc7b5bc5dc6e7a4ef28d642d1f953adb179ee55d5d599fb014d3f9e394843db69aa1148c83613514512aaacb4cdd749329c4acdc3379c42176c088264c26d87047ca3868de1b6a6617424251e96850e5ecc166753e9c273bd8729345887270cd4b9b4bfdbba5b09ea1864ff2f56f320469cb493ed0472544a5cf67af982b6c764e8b74034477aefa4181eeb9add12b99e722019102d62ba8aad7d21aaf5eff2b86a2431104852ed385cec05692985e7485b3113087b976a9f0ae5b572b1a1097eb53f2e070ba2696a7d824fc5dbe9fa558f039003f07997366dfb20bc4cd8b3648ca44a395d77198613af64838e1ecf45bb14f0e3b70619980edf075adf9de262e6e4313fe12e7f6eabba489ab8bbfa8e6c19b3ffa6ccd402d213a23a6ae96a72ae54fede4220ad38e9036b6324964c86f04d07f31e5d0626bc7b940541e2485c18aede8eb68980b79ffa78ad1868f8891c1241bde7b59ac9c6cf653cfaa99dac2d82ade3ac6c9f28f8df7b23c28c0044ff77b21ab8ee8e1389488d2d7398155a10bad3c6fbadfb649b8e62aa7c24412dbc65cd9e4fe7113e100d66b4c90a0084d0ce197605c25e4ae4ffc50c5f778475110fab043c882b65b888159a3f5188a36fc567938181ea4764cc1a15d09478f351454285d1b4d6575cbfa4c80925964d1d6897323626f9d80f0c5dedc2170de089984816dc9ff0f3038ab64077912e0ca83c4f4f4e195769ec236e4690c4fde7a0f7225ada338f01ecf6806bc249ba62afa6b13d6f14ecf7d6d98d86154511353fcaaee9742c19fe449f11b8d0be76425c338cb91b12d7da9b2322269b91f29c0d88a3f6ac89be0ef16f7744c694d6fcdafe59a0de81281ce282c67266dca4d0bb7883baf7c7eb05b3fdcaf882bfce55cca94d00809131b9f47a9e4208af8e2ca9ae9f34d7cb6556b70f92ad86c99444e3e210dc6fd168aadf6df2b0acad8334c4e020b92ff1ac8a5f27612f5af8d86345bf8ed8041afa30626bada8026ad9b82579f064bfef4d9bf637a33008cf8b940fa56979445ef0d03e7563663edb0e711742154c8d55dd4449cdb70e546212f602b938ff5c16c2bf1a97dc475540d42833e31173552e129d7bd0900d2460afa5c396a6b28ca9d088bac75deeb2de6b925e1b3edb53418e8f08d5e30b89dbe45deb295dd382d9f0b4d8641df3b3f608115e45a942e9b9940a580080802267d85c3afe0bf7fbedc8120ee123345f702c91eb7fcdf67ef61851078bc04df2d38db74aeab5a285f21b628df5880166460d3d32d5bf8e99e896d3cc547ea8b96c26f0e72ab5f6fa9fba603394822db7f07cb139efe90207683cca388bcfb3ce9738c951e399d347eaaa3f08083f388588afcf16b540582a6cd1ec38be2448b1b4b887e36acad12f14fb128c74c071f54ad0937d6d6b6b381de0a595bc74ae0835d997967d0598f81e8e6c41527a93b2c964e156e2ada2c87755079d1c38b6afd97f346a6a71905b1f8f06ac041829c3b67298bb8387a12fe5a2a0aec1f44a4fff4516f94aecddb4429a951f3cb4193ac057b8938f6556643b1bfc52aa853c27c53a7df6e975f70fe71c4c541bae1961cdaa1aa4ac387999f01e4e0e97872e8cd9b51d7794d47e7dc741e137a3cda8bf793bec0d7c3da08b30f1595368fe4da7f727d236c3d543607599d8925ff935574f4e3016cf342482f245189e674d006491ea37662ef56312e62c90c67ddcbb42ebe2b3bd15bb1053b0ec31e77f37713be550f650946592c14e167a5dd55cacd9737481c9b1920b8c9f0ecf2231abc0a33834156d5b0fa52fab4b6b1f1ea4791a9e09f0dddd35eb4a58bf85f8d6f7bccd82940a8097f5e2a94523aed350689be43f337d4419e87a8057a76ae4d431f94fc6dc1a338f3f99543a07025178946ed75d0cdb8541cf700625890a02e8e6ccc8f208aef97051e6c63174de880cea67cf7c7455b341c88db86742be3bfd641882430745a62e46cb726df664ae4466a83d9fd919097e48353eafe22a8900947be46b432e2d6c4f99e61644adf22025919202dcfa4c7cc563be2c925ad4980da2a3e3dc65db58848b011c5cda9dbec5b77cc3e3fed5ea34a173bf3983354813b0c308966b32bf80d70d40226f42b4c666ce31f48dfe78877fbd2ca9b1e20e349b4feccff95f35beda8361d0359b2e3ae45ea999e32660e438ce1cfbb77d5b9b6cf7170fb8192a21a39b966227b644bc2c69ce1c65b2f144314127f50489285d86b0734e022eb194420c2ce9a92a4fbe3d48083f10094f90dae0da3d41bf6aa7b6f347fd6db3f7352d1e12c15899786f2de4e88d833f0dddb26ecae08c9626ce9e7bebe593484a833b814c2d26ac36e29a68daa350c56e34e6b40dcd87528e568c90c2c5d1741c83f911fb7faa06b437c664b5e2b0fd1271adb3ab4e8787f6289fe6f52cc11d5a7dabf9f8dfa2e59dee8fb752ead6005bc5b512ad7f4046574cd0940f6af65d430bec7fe386e317274b04e6356d1aca9c7769f5121a0bd745d930b76d952fba0c1a62e62f0e0977b8b100c0a8fd9aefcb189eb54d8dc49e719b48f4f14b188da66299953ce51e1bf03f02c1de44de80165b174d92a7b56a0805f6ceafbae572723415251bd510ab39a139747edc187ef4a9f163698092135bd3e866d0d36522e0a8777a6c27b26d62123f77f4e82f160e581e90622dc5223c0f2614b71158c2893c7042832a8f105c301c46fc0dbe0b07ad73722fadf519376e6e301df5fec823d674c6fc55de6c0c4960e2a12c461272a77ef4026bc2b6892083e939c92949c8a81a7e4afd6423f5e5e9ad759d69fad37eb478f80809feba67545645d737b43b9b65fd185531df88cafb96ad03538a1945a0f712b180fa54c1e281fc5c2c4c7de564ba7b2b781866f29090faa4c61864604cbe38455a1b1a08e9193d7fe23f894b1d815791c0ed630f5e9f91a712d48c2af5e9fff4da2025212e23152299868eacb0a9e180917366a8be5111a775270e97196cca77a8230573a3c8ad846a50269ae2952560439687ed080553451624ef84cf474485a736d6a089e45a684de27f611dd5187c8836a3d822d17fc02006630bc4553d212fb18b805fb908c2d383e01b1efe2640f0f9e0352f452483b9f96ea5f8e74f535df93fa07ce5fd5440be0802767c89b106abfa8baefd28f917337a4f618419331281bb73f2eeb621beb3e698d52a52061537c1452d2fa8c3657d7ecf5aa4cf871fd7db472ce537778abbf4be2fb7b2cbe5f401d007e82463ae4d620b94348e6cb8c1ae13f9f7b7211895270629e203708c105bbbca67e1ff095f97c6b110522b3c6692cd718394e206f1f507bfd46cbf66b29feeccf2e250d556aace4451f000f01f17672453812fc1315ce2d77129fcffb3e41ce1908f32c34ba93b290ea289cf191e1af8f7dcb22134bdfd1be78270b6edc9af6e3a8eb8d4a1e021a168ca4d6a96fbfc825c5efc211c84ed1ab27761bc2bb71d35fd5cc92aa8d6c907b5b17ea2ea1a3d7456032bfdccc3f1ee2ce21257558a4187935b86e065f9d908db829ca336c81927708f398858e7d7fc8e120a5b91dc0fc94a99feef29bcfe345f3ee66d499634f3ede2b6049db83fc7bbfbe6cf16e02d31ff17a4e6eee871207bc996a14cb281fddafe7a9f5a5d86c84a9a6d8375fb886167bf7cc1eef2c45c2a803f5eb4b3cdf6f217d7a2c32496e754be2be7f3334ab2deac9f332adad788e826c9fc4a1464309890b5cf60efd77ed1b48605ff6526b55e9d9ab49f4dda6d5e8c40561a844b4acbddd074e869067f1cba4b438e952748d1f834cad455f16b43cac17fed84963b534254adfd4a75d4ee00a3643bdba2b565ec58290203c46b3d4e6d39af6d105f31a32d50f283ea82c8087b43fe74ff7487f863186d42257e42137b6ea6c5b54b627e0f20d8490500a6be31dd9784e9d31aaddd02ea40ee43d1db2eae58cdcc5dd3bb12ec8c42c5ef0d09d35cdb8c6a0e4c6fbbc7e6bdecd5be3312f88178d673af418b83d33e6b4e2353cf628478e4e84a7b26c9a1dd5945a2120a5fb9437d0a6e87ccd46428199f2cba6116e429c9eccd05711d1c3dee2dda80dec252edba5f7d30314b2f9ebf9e4c2e7baa342329700b15f46c4a214a7e2e794e7e3c01df5cb5485957d2461b10e6fc1e4b458f360466d51a79afd04c0e3f8527569663c201061b3ca2897f1c3d234547f5e4f3e82c1ac5e0a914680c39305637e258ce492355cf264085758ad0a2d62957f89299ec02d805c6d1342cde793eb1a21a5d7675760af4eeb78224de018ddc1f16605b5ca5c344ab9ff3cdefc1f9f7c3cd1e56a1658496ec6085e38091ff5bc3b125582f02f17d708f61b003858a372126efc29036c06ff615ff5c463067e649d546c06bc935351ebdb26fad36df1a592422228e0ccd2bdad108d6f2ac0c222fb7ccf2853576e281a2d84224570f5109fba3f8886790bbd298b971d8cb47aa02e4aaa480a623f3156427b9aa6526cce0deba0208085e599c3350fc9d6c54a64c01920cf9409da50471bfae56c05ecd5fb4e12c591ded8e20df42f731d223e6e037495f40fdf5784c4ac608c4c56c1b12c828db4538e8f98001f9c5a99f41e9a5ba2815b1d4a6be39bc5358d31d5812ce4e49d466b35ddc3785d181218cb8b0912ac4122f67cadce11a05a681d3295c80d40d89499a8d3bff6de2ec1f6e651d9bd31f2d4d955756320c71dc7a61ea48d03cb3868cee03565306c0bfd2f12ca8db3427e5825e3e821c01d886d0f71650a7699c668d7709ee19f935538675a2c17f9a119ea112396c77b153fb35305572a395d198d338db6c1fa205bab4fd5852a515db4507d56137a92b8b8d6b34a978590ac98669d6d6f8659daf8ab703cd6ceaf634b6d208a0f2b941cd6dd40ba5a89105c8a9c2d6a59ed1327baf1ebc24ceb6067a0415084770bcb8f8c18c4172a9384a5935c3f62629566c49b14e36f44f9b493efcdc33b0e252958dcff429d75c48ef453483778ef347374302f60c7e6115038a392e7d2954e62565014bddb894883c64affee4e70348114b1620b9790fd1fd5fb8bca60cd4d057bda1c8d2d5ae024408979935275ae927f786693002f537707e9da6aba50efdb5ba4cbdd1744d8af581f77947e31fd72291b183cbf18fc393ea2ceaf3de7b50611c9203d066621a2c72886d44824410c6ab2b4eae3b4a174508b840f5a2362a0f57fbfef899c3d4863422e923dbfcf85c40223b7fe29c1d57488fd9efefc689cea75c23077304a0a33fd7cbd6a8f8be880b64f9d770b7e30184e0c46851d3fc4af72f149bd04ed3d41b0c53e4199695f895caff09f7a07cb75c93baad39dac74b36069daf91dbb241a3c8de438164f4ee376d17d36afcea4553dd14f3662286d39bb42858a5de75b804dc8694633e85bc409034ca4820a0d1dbaca034febed518f0546ab822dc97ff84ae4f7beaba3e383a073b95b92f9399de22c0f8ad1be91229d23a8b657da4e41d333877519b11146af6e61522eeb9a6a1978a713ac8ba09ac81d9af93d8b15c7b439b34eb89c1fc646952ec14c0a433c37e10b3e498641646dcbfb7a16cf32a27743ff4cb85a1d6fa2d216542b5ea4df58c1d104f171fc727557b00abd90bea7aa62f4556bded7587363830aa6234b6ebd8ae9e72ec0cdcfbeaf64a3b1074d26164932180a17fde468d4764fdef07add4cd45a514990f0b27a7a000ce9c8d989881c7f578ae86209155113f7279eac5f1a7296e38cbdace5d3ccfda9a8f76384aa13b25e641296781af78afdc24e11165071d2454d3a5b629bac8851ccb73f94a83f91de36ba3af7578e94fed78cd374a3257be24b21b640ee52713b4b3cc9cf44edece708ca8143362fda2b95f9d174122272932994554bb4ecf7fd56fe9d9e1b80a5c70fadb49001d58ed231100ece05f168b3ce0636b2314ab5079ded30d54966e000fb1546ae0d696beb41d2c69a6282eecbe1fda837398dd435fb8f4598399b45ad2a3fc0d040337a5408108c875737e85a78ee435f5ea88362e21650029864bff64e25cd0c6a7c9c98c226cf89bd345870519425b79a8408190c69061a6b07f94772af08042a0e48be409472068def6c7204b2552d0a6ec51facca2dfa070b301b6e35e38b4214ea6178bd77e60c6be716092428abd0aa0e1f9aec066b5ab6c5536bdb5839c74d7ae51755af6ef7bdbd069acad62e98aac94bd8d18f1cba8dd9367999d08f8a661580c1d2c2bd77700d313dadefed551dd7d963437c062045425130923e849b8df710f68b1d644938701d253e6e0e1487b547bd8a3683b8112fcf265bb852759d11170d063033fbd20c2ea7479de7f049d8e527c128a5a64b8ca8592c4dd58f0d236f5ba55dce397c5921569ddb7ef2b2434719de71912aeecf6e0ca1ae064450134fa9a69a90deb2d9b7bcd84609d9cb11f92997d7b95d21c4b52e7eadf57128a8b4c53041be5d476e2299358e2bf0a0254085f8df29de9a70b8268de4e51f344d59b3e1551cf4bb8b3a22a984031bba7ab80d0a32506e46cc2c0a2f0decc3ba23bb1a0dcfc935ce5824ae9905269e2d89ac8b59ff972e2f81b21c327eb898bea436e01f9b6a1902c7604038e4527bf50c65aa7591806c6ef12872a0950f9e986d4b237ef17545b42ce109aa2e4a5ac3aa8520afdd4e958e3b96315e52df0a90770a71f70fed6f93d39f196e7e6aff199f95364470325a65537ea44de8394d1bf92a052c48ddcfa13d7e94c529c9f2883c1d27033cb90686904db9c73659a7d2632fe14b21f33615f988c1447ebc2c4969995a9e41badbc9358a9722682cf863a3fabda8212f1bbf2784ac219c5fe645b04ee82caf0acc44e85554a8dc923160f82bcdaa039c8e0a5889af254a28e18e84ca4c6730de0efb992ff120dcd9d1b3aa63defc13ca1af11b0fdc4f7d9ce95cd775af59848e34c8eff7a513cf7e395c90d9b4ca440ade7438fc1ab191e0ed8f99330c54e25129f335be5142e3e9846322f6916fbca8d81fea100695881c14d494681e246f1145a5da3a7b22c904a3abd23331f4938fb9aff0d84ba511365c7eddfaf077f0778b9b1b5d6c8bf66cc95ec90a0cf3161e55f0e0fce222501d9efe98dacd6f354c35bcc3b510c624e8e8c323053229a2d08a15414ed0297f8c93d8b67ed47ed71b9181502c70eca31c74b71a7e0d66ecb99ffb1a68e313a70fe2d9e8199ace305dae6b5bb581480a111b4d28bfcfc9442141cd13ed508bcb91abda6c0b400c16585fc77ed73b2f96d61b3c4d2a93b8d5975f57c183fd3c76bdc592947e8b40c9b2e2f9c3fe1d4a74e13d65707880379b148d2301d1b93fa83a1a7daae15d9af519f9391943a13f23dc88648bbd084cfef954b33de2d94f4cd3f1e727c28a35248eea5a30213603bb621f3e9a511714cb9f0f218288bb2961d9a19f8236b21a05821300389c55df79edf961bb63eb3aa5867fc75fb1f5b2a5488bce8e7e9ef8c138683ee9de29ec1fee14ded4a1746e462774049886c24265d5e4d311c0371b83462b6c49918a00efb56d629dfe7c66468bccc8feb799ffd30e6bb7dabf2827fc8a4025aa3e25ae9212609e380a1b3a079ae1b12146fd807f3ffe0e58fa7c309331a6e1af6419c1ac8eb3d385d89dedae89d0bfc061771704454bdd66c602b8e3a14c6523a7a2a7c42bbb90d151ae48751f28b57fcb7c57b0381ce08d2c4a7b774dbe7c3e920daacb00bfa49b83a86832fd4aa315ba599ebc9c1e3e54464594fe1e5c93d0ed03fd1cd635bde1c5cf8cd5968f055247aca2cb5673860d9c6f5d78fd4ae59d5aee66a315137c4dc1d3535620fe7126e6f2812407d6cdf9b98649b5946a09a0b493b6c69f13c530f2adb13be72e1347094f86e90c70817f812bb9f9312e0713c7b2e1e63f95c5ac89c1723a8e5902ce6182725eaec2786a14373d1eda77ebfea381c51fc3334c2cc5676bb302c25e11f4ad3d693214ad200499b9ec5296de2961cc878a095542139fa54559f63965b8ccbb67b54ed8a42614f339fc14ff10b2bf25ea11a20865bcbc28b6f8a700350035d6c83be158df86339818d22df48771f09b67608b0139151aebe7a9131df56def0e57e7206dcd2a1506a1ad502d0af3cec593fe72d57f63b04b55e977187657e71a21d592538baac5c7d03f6a1f1fc7ecb267684af18867cfd74a959c31e04f3a75180170ec9328d69cde959f1527ab631e9d3d6c37433f589c5d618251fbb3f4950d4187d88f7b69f77097753ab05d7081ffd60165be5eb8669a638746f285a5a0480ab6a05ee58763db4894647357cd8cb3a9f9c6c6367d6b1d4ef82957cd86daecb700a3e1252e0394882c30500879f96285f2f972e7565b0cb7c48364149489dc6cf7577202417896da9018b6c951270518f20e51672165fecfeef9c2e7a9863b819aae87b626c2793d53509eecb25bdcf436cb738019f7928fe4a034b57942bec0c7444bbcaf21f884b018b036779054ac6011a571eaddc36a311573ea8b294bfbc2755ce1759e0ab3c82519f17ef981ffa910e81e06c7a50c577b54d158f0fbf4fc22db90d795d8b32c4f6ec00f929c8172f95f14e11efb63726410ef0dbea04bceef46b79582a07b11fe842ee8ed57e6709b7875ea07f8d34bc3e929b2ce1551c3828c9a4f61b69c9d1fbf6227c98e2cdbea8b533f1362f908c6b47a510140296868014534c88479f0e8f4ee4f988fe90bb0389cd5fe3c4738514853f59ebff5e8cb65e3a7b290a47fda31cafbbd508f3dd1aebb62fee602e0004d788f13e32b176ea57ad9d4c8d7d1d50410511393556513b7b7c876e243464448e3a4f3575bbdf0cce1b06e75ee32b3a2e833ed23ef615fa30d60754c456dc0a8af31b8c5a6d4cc7242a9afb8aed8d0b34d663235157e49457f5c9210a13568d648e85359cf1ca7e31ef176eadf14c8c7cf91d09e572181c9e28858614938a6ef4e525e2680b58c6d9d262ce9b6e853a8365a100310e7e0290d3fc92c9e7f45cb24db55ea01317d019e230eed3005ef6fedbe2c20e9b9d1014b6dd41a4b9c5dfda151e6ae3ea5c495a926c52a30fa7999a1d3ce91bec16a8473284f80236b57f6f8de3d5390c35ae56f9422d1679aaf8d474e9e2f5979c501ec14ec2f0ac70ad1f798a5fcff067e92934fbb81eb1c688a3f0e4870f42fd8083a1c22c226399d21d9148bb26f342627b7a6407886a03b38889ed3a9f866150f3b66e57a0561fbf39469786027c0a0834c9c0483b09fc7d5521d6ba6ac220c91b2b5f4967b7818f922f206c40798538713b205760cb62a4435e293c4d6dcbbeebc2c472a71cfb1720be084f8a4e5daba68a9b04da02edf88d7b497342ca1102b7e76d0a0c31878f72a6b9fcdbc4b55ce716e42245e6d892a807680285a29eeccbca7b90411c8e880912956fd2e83b28e913b54826f267dc9ee9181df9f0500160d1440741fabed8faf149dcadf4c6e094c2600f928cea22709c99ebb3ba47a6e32a71b38ede662839a4a88c24cec8a20f0293bc62f2bc1ae625c22c1f460d98929079279ad1fbf585e5f6c5737b2abcd1e1ef177454ba4f5953baef3e5a19b1cdab725cc08389f5a3d3096629aee8ca1d8333ab80fb929ba955ef42191ed6d89f2eda4afe71b6b7674a2406eb51c60fd3d597c5321f64a10ec6c85168a437c6c8e4e11869be6d95a8d8a61586cf3cdc805c34f5a17e745eb11ad55e51ef661c452278b01af018f6ba979018776172c5ce0f7327e8ddf5841f05e8ed445c039af52062ee2fb651a1b28813c09ec28509d9f5b3c7c7aa916f5f2df0442a6db0159d4ffbe8dcd366f66a8c0e592d7bc313a1acefabee2364be75dbc03361092f3578befdaca91d3768bc1861b3718d2b5910233bc65571c536239abc2cff4e3254d9bd2d1e2b7797db91f1968bc2a00ec705b3525a184ce028914e8ee89d5b3d1434590292867421d0f55ffb411c6ca493cde7f0642800381afcda80f6a0a5f1db76797bc31b78db185bec7f1fc043f44726ee2b0c67326fdd0ad75373ecae58b623ce66d208e289cb1b6d43586992532d102197262c40106a48fb59780a1bd3266bb39bd109b6800a051d8d06e05ff6ad51332ab05249000b542024a965cf2320bb2bb5a084932e992edc1001696624a4cdfeee250c7b6e442044030e8da6ca3d287e8800667f6bc7d5d57645fec6a736aa7ff03ada4342ad57fb4681214ea65a2a89fab4e0a1755864ed832453f67418c08c7c25d9372513ca9be059be03697de0254de232bca8965de1fd9f80ae4165e1ad18c39ae6d3d93c95e34e4473d3cc5b6a6a2f95eb5d2c815f69159c5278925aad30febcab067eb85fee7393c342fa41e55534414abe69970c5e2ecbaeb2f62a109e286b556513a3040a3bf0192228a26f6ab5981690c67565abc39ac4d7338fa4c82cb8890d47932110c9d09b3615940476abcdaadd16e283b19be7c512b6fca36c9eaf692135898563acfe91cfbb1c0dda84b3198d0d3fd4bccbbc9ab46d6d4ffa167474468d3b85e4ff846d1645d19d9de10bb3e2549b95d1cf31f70574cb2d78aada3a375b4686c59e4d49ccfb220d84c1f5f6f944c5420682fe19fd72f4b376d590ed50dc073a9e5f67b377261c7e695d4269fa9b1035f39b0601fa2483dfd87381237a930f6dcc74488b0aba8ee6c4307a4f2971bcb9bccecf6e5a15a0441c1427a57598274fc092a9dc482b60fa211bec921464f502ff72ba71d3c77ce99caffad4c294a044cc10857ddd444d641d77cf39860a79a78716d2fae509b4ace3e28263f49fe24fd31d7a69428d83e183df64d39e0218bf93282e8ffa40c8146b7c11bee0927c39c401b185342bcf096914c3092a7e9c5c625036ecda0c6a729a20d47125221c355d43add13393b695fc2c90587609f5061a78741c8acc0514733af85841790acef1391f1be6a00624b841f899dada0afc93bd41dde2b175f26891526f862a0d318e3ff4e8626a2d4dba04d0d4ea7e1482950c12ef728f3192eff0fe9cf156b0c4a41bcb8d1421dff3b6b04375e9456db546bc0fe2717172942913f395f9ca2033b2334b562cee3325039141e542b4ae1c4583a44d785ce249a4705ca66ffb264a7065d3f34bcd4f440c5a464045f1b4205d45f6509d078aaca0094676f60654f3b77567185615371fc0ef9057cdc8e53216a52c2fef7b211a11d335056bcce7b9cb72f1cdc95df75420f2da28ff82795646a50fb9a5e368d97105f397e2139ab2acb0cc1f050980be35fa47922c02921a5332f0f1081d92557d7fa042462bceea0da146f265ac12339386f029f5c5fe13c4fdbf2f0f157c30c96bf467d6ceced8a30568ed9ce1542e50821ff0fe73a9c4b3243578ed29010c3d8ac7fc375811f7f368ca37010f9c36702cde8ef8c4189cbb398053b1a17eab14f51479fb92e7e44803a6fc05e91613d7f037d5afb027b3a3cdcc5fcbfb6a4ff9752f4e17b9a179ddfdced7bcd669286676194d1e32dace9a0b594a529db979dc583e5f65ba62cc85127cd4dc72c54d7aae00b7cfa2f72a4c3a6c5cef234b1554e6cb03b6a083b863c9d54bd317dedd78fa8210a77c15c9ffec6bd2a687e404974072697b3f601865023ddb93fb605a08bc252408fe17355140f563a46a858a221c16eab693d975d983aa19546812b50cd5403e9b193c76eb61da694f1ecd9ed46d42f6361f0f387de4931c78580d56cf90d68e161028b8426c9fa6b91967822f248a403e088b7d774c09ad2c6cb82a6afeb0d1b8273638bf1e57bce4fc3a288d86947707f60f22417bee081d2d4c61d3064a0fd40b8abb423ad6b26d475d7c0744cd40b87f7178f121c9d8b3114492be801d3bc6dbeceea6fd70f1ddd2de936e8b119d236ca73c9417a83e46af4a10cf87a29982f0c1b5758467aed9ee7f43de2baadc80477b4d710a6f9ecb7748260e029d08d7e7e7dcd412be0ecd1ad529694fdf8393b4ad700eb7671a6e2cef78fb5d413080a4140664c423b19cea162febef56b121370151b9004ef66d32ea7d6954280554fd56730e8b8e6757ac1e7f8341aacdfb41001a0e0ef081c07c8b6a4579ce0ddc7cab619405f0a7b3ff6d2505f2b9bc60b94732675caaed0a61999752e5e6bf8815a15fe64c14c7dcafbf9ceb57122a5d462c5ec34313c7441e5605c656431c5839636f8e31297aba5919400c3c05a548e8880e83f3156fd4c19c1bdd8005b8d7d4803961b16c00c78be94b09dc954e96dbbd30ef319166e6066b61dd1b54c06822435e93857dde55c066fc15318184b9ba0018bfbbe1b0bb3e62ca950d20ecad191c4a5784ac45150717594268e97989a11e541b6e974c4a4e9e2b0ce98c489e992bc157f41a73ccc1ecd46de5408b12dff6d2dce3cda14ee0c6d7aafa927356f13da6b4c518ff9d801ce6247d03ea4a1c9c16196b09052f12ee71d3249ed2eeae966dc0d43e5b9404b5896d718db9883f17a6893a5b8159b4dc781846b7cf0308053186d85914d9883a6168c8327947dcbb544d622776765a793fd3e8af07835ea785b42ea9c1a068c13258ef0645c020835b2301f9b516159a1eeccc8a21bbd79317cb56d1327b02546b158c4e134c89a4199dcd82800521a9313f3e04b71cc741affac81b5959a3a683bf56bca73b2faa427ea911f8b157c18c1fc3d1117ab67be5b70ae0eedd57c78882493c912c082280bfc203f56ceeb4b1ad89123ca8186f14c0f6027a11b79420d38ed8e4e0862d21b4f47211aa5e82b9efe315b525367f5bfd2d535fd10875571501dfc8809949b30ee7a4a519ce096ec826137ecbbe9381a49497d623b292bccd3bf073b3f8c039088cb86eb8feee93cb8a072d5fd28688dbdb9e1d44ea4f2f2abfe2b763adb283d6b01ff78aba444f82af4a4d275d9963960eda4805004cf80285838806e8c8476c9f3fd2b8bf972864fce6439a172cc7c9c98bbe6eb497f1f2b78f407ee31570ee5b9a2cc19b735a87211f7e21bf71767e476546b903d7d8435c9e8b57bed60442c9034367405eb8f319dd510d7a0a2edc4051be1fa4b707f177429b4cfbc7d0b2e8680f2cd5b6072e7d305bc7c6c24ccd4e666eb6691ce23ea688bce4fb9486c3832b30b6b687fac6102c7dc094a0a48e9de66092418e20c36ee55a6781fd105f7ecac74b92e9366a6dd9eb26cadb4097dfa6b492cf237ba7e07a7bc20dc0ff09625cf23d28b61ae924fe56e0b6c1a94b2c9df2aecbfd8b43ed58f8232b8a9928a708a1c973ebf51e37274a992081ea9ddeb8909e2eeea9cc6252a02676f919d0b9ca9c73dc69bffc8ddf9c05078718b13f5df430904f8b280c924186536d3d6592dc5bcaba07c024d2e6a13ac675ee6cb1c7cd076f6119689d1c3b316ba62edf57849493aac52356a856b1bbd52d7292bac5def358bc4e36c7d6561ced4310ac5782b3e29d45cf68da6d38dc8014b47b658fc23b8a0d8fefae24356db909ad8bc3fe3a856ef80ffb11bd161de44527e91a8385b927bbea047b249b6ee7321fb4dc721f1acfcab98513bc4c116c3119225962330a19b9c77819c1c186ab4719558f71f14bc7bc75da23694db4c9647fe08785cebc95bc11e764ad60ed10a6bd6476091d862068d7ab6060112967e44d0122a742f56cfb7dcad8014c57e6bde0fc612c88b9fe3ae2f9864309a39df5836a4a02d3ffdfa520861d4f826777321f396b02a685f040656bda693897bbb7b6dceecad7aac16171f2713f1cc890fca4924bbe572f26878e1e9d95b3427fd3b40c2d8ff2abc39493a0ef0934680846c6302234de835aca2e771ad376225047407d88144347aa097c2ffcfabb5cf2b2b753af69a9f1e439abda6183fe22d81c83df35d2c8e2e83c7b851d8ecf0fcae8e9f1c6adce7bd497567e79a58990d3fc769b2249a5e22f8cfb7f4a27b948b548887762f5314770eab27af1cc77bb97a5cae02991bef0f4ce4e689e09bf373e62c8af55cf82e2637649389fe8b442751f3ad2ededf13f29980bf6ff96be4947e8ddf32a64b08458c111025de6891a22215eec9f420128bc92ddf9876b38e1c4af46ef755b888ccf524c0841f427668348890bfd416fd9f0c885b120d09ab2e09e97611184da5d1346ac2a397948e75e756e2b418d701334bd6aa56068d84b3aeac751e5450d7c12a7f93f418b70c5eac22d839cc111a46944c8a6fabbb0a523d583c98c5c74e9805fc261d3e6d88c96f1a6aab727301bf05a1a38d90b5c444d57731fbaf6feb8c313b2c189f3c358549d84ea1c4652e75eef2b56ad453cd63f3327fe79bf04feef953d54d0d52557c4270a9dd516360fce4c74608a7f6bd91f4bff27e716170a1da56cc6dd73e89acd113dbc15c0e6eeb43f1eb33ba8fd7819c507e4fbf1de7180cde04e122841a141cd4d281f3755b316cd5fb914473a44c637c2e6c30431dbeba1e04dcb80b0d6e2782e56facd8d8f15e05c04b8422a69047367c565a2083efff8b8e06e1d41529733075c4a896dfc80a144f8fc2956bac91448dda8805ed9e4c82f4c9872708ea94efe92aeb2f2afb52d484bc0d534616b4c51f493517caf625ac4f0281574b76fc77c727106b91313d17001cd9a79355ace9f0d139046303e618e3850d9b0cf7c19516fd90983af52777a481e0ae01ec808a9d55a8837333c6bfe4d7a62916b52cf1feab51f37a1bb4334b51c96f6d0f07b325ace909ed21b7f047c55f580d1c26b74a3bcbebf12d309354e0c80184423af3e5d2b678a9c35f54905c8b23e4b5e2aac13f34d5f44a3fdba2aaa603db2eec442f3b9ecfc2a3ab9ea2113a436c6379990a7c225d646a5bd9bc60362c83a918e1577733652720985f5d3c7f3b3c6aaf49dcc2e3d6f444acda4e46bbcc521fe6f725b8628d5d7a4d2b6b7d3a99df91a5b5a88511e2f01f2f1b30525b35ccea20affb9f5b83725ae48e2f970dd49d83190ffa6be1dfc1f10fc201069dc6563efbfc691e6ff68adc59c44cdcbe3506b925fcb2f13ad3c6f0807cedd1b435a2b2336e923696b25d6ac9c8a4dcfc4c0786a595c3254ade0da7856ce6c328e39f9ff5d012d50258b63bfc8f849c0de88876b6e7d72cc46f17fbcb937f93671dcc08acdde3813057eb88ee40e0f75696b6667c5a4e3df61af431aa81b7c24f0fb768778ca6224eafa6e8e7cd60852717090a54bce5b2c4cd264916312eb9134d1e2d75c85176f99003175d3decceda5937f948606669745be27d3392490e9722aa2f4e593ee18bc8f282e341d4eaf937fb0d4d0732bd3a82d6378648c5c9e354c9f0ba578a97aababdeec99b84c0306130f04c8eae231cc7d30ef5070aa74f8b7786dc425c02c16936b4f682c872abdfa4ca03d4e50deeb91c03cc7f3e836c4c77e4a62a11456fc1a7af3f03dd9907f05df73373c9e493e27cd4f1bc1db6b4c4ffc3184689586d3e16640d9fa9d8246df77f944bd9b0becf26428e1d7a81fb5049a7ad9a3775e2c50b51543b46f1a9aa40139159c837f8b4eba29e6b844cb533bace2a26be83d53d040ff529efc2659705d60af0638e12ba1dfc623925b6b060f8ca5793f2f853ec1d84c624c1cdfd5068dd8d6b3a509a42ce989a52c4f5d42bc9576cd1939a35a2bac9654b7a4ac7795a24789589a35e57161e519046a469d41cdb4bbfb5c0a68f4bd6842169f9b1aebff6aa61558549ae11dd98bb52f21bd8fa30ef7fda37aa6b629aec63b8744dbbf364b6276bec593a3e0e23cd89209700cb24ae02596fc431f832bf21d7a09b0c86a57b93c53ac6f38b439e5bf39f38c754267a9a20979b1c6d2bd98a98a452efc60c74845e2f1fa84bf49404c46abd67b58b61ffd80bc4f44e322d83c271e8851824af43ec87ace972e04a3cb6aa8ffca96c0bbfa46187204533d30ae73515805495da65114a48a06f29bf2c1f1356c311c2e110c78af0f41b57f54be3a0fa5512175509cd4b390b6af6acaf41a046d1fa834dc2043dc2b2701c52f8ee66134632ffac5acc355e3b4b2217b0681541cc7ee373ae1eb1fd858e0aea422880025312864dc6f72cd0171bbd760f7f91549805892ddcefbda1fb0131d0df4bf84803b67135b1810024b5bb10bf2406567d99c554a3acb7b35472d7b874dbc1a757e65ac9c670868f55ce82a5f5daa521645b7a3ed470e0d34e0cfe7bbb1c0b4ae16674c51184087e698ec2a10e09a176414f8f694428b810b89269c8bd65eaa25955c4dbd954d4af8381c46024a766ff18acddfd3cc3b2924cea2adeaf5650f8cefa630f732b365eed924ce24b5c02bb4b7ba45b7dc78e911ada1741d386df2dcf78e87f9ad4f29dea942b9dcd1dd9579b5b9053573b1b0da960bc088c15952b27d3d23b35e7d589454d7398fe67cbf45b8fe345bbf588415b8a39b7e580e29155224255e0817ccc0ad2dbb12b9519f42cdbfcd29f48b2b00c9aefe9ffdab37eb5cfa9aaab641d62864d098e7e689b8acbb687d5c9a9880310c3849178ac691529a0b5d33e289ac6d3889d1732f1f99958bae2b04d155aa03ea7d1fa04fc1593a3664270347fae2f8c16b842b24204f3709bce2e62bfa75b48dd04ec504a5559285920043fc59a7ab2404dbe05bd55fd69c3ea4b80182793cf2b3c07356250e2544e08fef5b0aeaf04cdd096234c7a8cad717b6c06343e2df6a9fc9ed7d7425887b2842de5c563470adf84e8d4379685f5b81352b49a33e399274107f6c889086e387ed6d33738fe48c087e773d37fb2d9fd9400ddc9f5119969ecf3e97e1af36d8ceee548b84a6c62cbdb7ef94b1642c677ead9b56ff499989690425a6a215393f634a10b399c376486cb6c979353fcdd0b28e5b846e69347dd3943caaea6c5327ab52e1dbdf473f3f80ba16e221000a779878de1bb5d08528181769c28f36b02d32037dc2164335aff6fa15084ae28942ed02b5677282697fe6e5472023d61f71e14c24d6d6653ba59fd138eed76440032cc27545683f8023eef2c7a09f60473327786082a70bb8d04d4195ce27b1f80f547afc16ea3c109c8103e9c5ed40229602ac40552d8e4f50f5dcfef120a0194fcd4e28f5aef073442bec829b8d64d4581f6ac3ef5d5860fe410e9dfd153eea400fcbe0691d4502160e9acd25b23d814ed1d25183bd745f4025fd40987f08de5211713e421f46e7675ecac7fdc4f34b07e58d2a7709caea269c27eae8b51fa1bf05dcfbb95feeb9d8a91955d133b112e6c3d9ce18be2a5fb887154a0872bf280faa26afb0a6ff0fe812a871f97cf996c91a00fbc968b5336b3ad7700dabbc49d47bd71c6ca2c237fcd9b33f7cd3b3b5b3bacd79faab911666b936a082748f21f0251690e358c70a8259db15fe9a2c4a0203917042482088cae09d7ed0a52eec418eab12e91b1a5ec0e6f7c752ae6188287286cc809be57276a1772ec7be3b88b395eac176b971599965013f5388f28338cf1c087a0e7863f7950d65a18094c2b6f696089a804f4beb905f55e77500bbd6919fd45116d27415500e34c64f40e804632ea3f0cbfaa9e64674e171ca4fac51c8efb682b42285f39526c5db993e2b40b3e047ff113a057a2638f098e6fdfb6b77230b1179a49c12241cbd90e12ebbed05865ffeee602df8cdcba4f546607ac10d5bc5fa8abcd56d2f1edc33da52fac5f4a23cfefe78c34488a4c050189cc4e1545ebe1e6f72054f1940852346e402974c205dedc1e1dfb3f9b01ce101167e85d740d01bfaab90fabcc7e4b41d0aa3def188f52151e7b115b8f2eeb745dcda346e61b5b2d70d671450eebda0758ab66e1bdc2eac9820ca3f5d366cc4afe7d14e5f8a056f17d130c9e0e3d5bb5453b719ecf5425f767359e324cf040c5265c379b9d6490a40c1d27cd42ed32a163046d7a00aaa88f1cc189469877303d8c4ff97e3cc30eed95c680ae09eae36926424e6474161a8a26fb98a0ea91f43c1962ff7ee2fc0ef43693360ceab3276ed5805b1e0577169a1a7dabb65376067a7c0fdea67b795fd181e12e5d720428fe31df150a8a7134e23bd2e9da72f7fd07649512b2cdeb9870fb5badb1387835b538ce8c74b88bea2976d3c3c47aa091ce34844d70a8db1303b20da530c0e8bf054779eee46e4b13003b810b45a871799bac2721721dfddd62e938b790890edf2cec3e40683da2de762735743167da667367178e9264586420c25b952de91b9173e3d0fe0a2880fbb748de900d1ccfb093f35a848c51abd7f6fabdff35f225073ed245ac526bf59e48670da327f8d113b7b709a9d527c50b1815cf629c67a32d4999fbfc8410f09a5758cfdeb4d82f7b3207c3a81281473471536c916daa03057501c8ccc9c04efbdb5cd40d847dc904698313d1468a03505dfb388ee6a00c821ae1ebdf5153db671df32cc3efb494b9a2a502305d6a7659af101f4c13bab26148bbc4256aa4dc45e350414444ef1555820a33a78abb320ee579c1b72067cb3b05a938af9624b7848a1ab2cc47b7fa746437837113c873dd736352ae2398ca18f642e2c6a25a55ff527714f519e16a48b9c26589f775163ba4c9a8cc56231889c2d25d9cd08eb23453fdbfbca655740c287f060bcb043e0bb4b2bf4b75b89706ea14cf78528b8c6e35ece9ad308687a98be751fb7f53d15e1cd39a3b8eb6b65bdf5c391ffaa1e34a9d11d6843123f95fde4d5441e95c9a3c49cff2db04dafd749a1ae30c9c54b73a22b423c39f9d321ed316ea8a4859a6594a84cae8faf4c3b228d85a80cd0ea8b8b4e486999cddb3e14151412d84a57ad986c3747d97440f19fddec9bdf222334b1349b2197919d214ecd612fb9f2dfab4eb3aed496656594bf02b9309b2682d107c858100418e0e7d4a20c301ecbe16372504201d35d3f4d06dc2d28e60f87c81c7ad9b9ded3b7b621388e99a20d1522d0aa50393d43ec77cd1b7981dd60e0992f2de50fd95f6c3a0effe93a81ca59df9916fadc75c048483eb1dad7c90faa3e287c69fe06687c6f7aeddb55a8abec1e76bb2a5c83f387bdf4ce04cd8bceadf784f832940c5915ee3cfe0fb2f87f596411a5a402f3ceaf4c640cde59b930fbf501477ab537b3a341f01f860dc2b0e433e7891679f012fa567aed07259c0c47207795fcf060466d929692671228d843cf1fea2b805b1fa86c9e1c15c9579d501f1c427f7f24703ddebc40f72ff87bfa01076a3c80dc4ce3dc6dc2c106741fceab2cc2fc9956a634631a65a2300c3e4e74c4497da0e13b88584e299631b1ce70fcad0843b93e53cf4b7a68dd385e3f4a58693d39cb74f51ac1dcbb900b5a2bb54499eae118389a142d2aad7ac039c94a340adbc08b44469016cd64af7fb7f0c0346fca8608c0f4ec1806968ebf43314bc63b9c157b9193ab63621ddcb4776dfa8ab1947012fc74d1771ef92999b0e9784dd98c34feb733ca52f769d4db1a30abb40bf1a016d7c872bea2e9762c5436aff8d08e0b0f18c963b278459ffaae66f8ec69b4c138a67d72d2537e34830d914ec0784b51fd1d93fbce2c37f68d9c08ae876edef92b59ee6620021cf0a261eab2de4eff6b70ac7f01a07a9bf97aa5f1815263299a2667207d2c54ffe6cdae30e4cd451c45fd936fff46056609152d8bce6f5d9634bed7ec5fcb212e846541280b18057565c825b306ec41a7919a62db6ebe9f1fc0b7bdc9f8e0baef8093877f24a6aaecbc4afd93c98c2cf9b88e01d04a7f37fbc552f8ee53a21cc21b8d286d98abbcbd5db99f6cd8a4db4a4be3daa37ea1e4b1778c49e81feab2b73559add653aa967dc5a2d41550a5b1a55f7be6299c4db87261eb1da6424bee0f2dc878a66e3abd0b0131d08ddc49a891dbbc4446577fd79d8191cdcad30ea52d0d5219df28d72f64dab3247011ca8f3b0aaba98bcb2a5c067378366829c55efe0da32bec1c0e882d04966968969ed29f82d775f9bef25772d26d087fae84feced16fc61afbc3bfeafcadeec77e0c9e963a64048b72e4e5d2192eeb4b3b4cba9971b41a17569986d8d33ab42dca3b1816da3807657c1d223c66ff84727fc62b5178a4a57ea4eb6d41493fef8fc90628c089acea3bbe010c2bbcafb1e78829a7310e5277ea556b1f8a3bceeaf05684b369d640db3d5422628990ca705cee3cd31ad43ae871cad96ae67ff82769b15902923ef7d4e22a32bb148cc302cf42fd204d5cbf97dca45c6b9c1f1394577f858f39e575db762a19eb4df398092406457a6f05f95766a22fb721bbf9b71ec58284a934f1fd09f744af4ed74905631686f4a342ae0d1ab6edff7d8f5d32905756a9c6261cd715e34b64fbfbcd8f6aacf95b0e3bd0f1b78219e2f7630bc283d32ccc865a3c3e14e69c4d17cce0e21aab9ba82a96dfb7bd6e6e6f960b7d5a72ff247ca8dc4db069cb2d585c13cb7c87d2e7ddc017fd951f6f9d19e71f5af31ef31e49e4e93778bff43befbab16a8f8d5933a610648c1bad78e14dac03d0e5161f8e0bb4974edf5938feff8a14dbbd26cecd1410ce436c14d6ae8fe12c80316fc56b11546c5a689c2a8e663b3f4e12bacd7f765647141a0f2e63675dce68a74a011bda95efdf17507561358a2f8af2a739d446b5f1653c83e6cf6e2f505f31c914983aa52ff4139e9fb9647e79d32006dd38892903641089d451e7d82f98456f2ce65eac7f8f987c12593be480eaad2016d9be65836ea69942de2a27012cc930319e896938fc78d67b84f7da51f46ab837bf0c9502071bb0bb5c474ee8f56127e3361bc3dfc2d242149a21f519416415364b78ea5a30257c52dd1e6133794df9a78f0c5431a81a3b833f5e69f9b62d2125a607959b41434c5e915b115ecced4d5b66e8b7dde2fc6257e9e65e8d44f6591cd71e43f4f0a0c54a75182070ad77a8ec53de2a6208c1061c21111523ad50e4a46d276154614b701c0dccaf95752ba411b29de7a68f5cb53a28ade9d9007cb217d5a39cd9f24fcfc9b2e0b5d5291dffff3cff8995295080b5f97f63b32be46839dbc9b31b1286ee2e2c988427f006c820abb26f6d9f09468747c4d0b3cdec6728d5d39d5f5b18271f8a6ac7c58d05bc39906a3fb6c75a5a6daf318383099efae5cb02150b9840d04e84a2cbc4949aabd96f3531550841341f70202217c0be7582fe122a5fa7d8bbb6b3f26419b6fc923e0bb3fbca36d72abcd1cd5eb953225ddae97e830a9fa50c6a0a0669d8c59d7de52a813d14d5fc0642b99825df182c1edd757f95b6f639ed165c7a4a2da933cd3c8f861a7759aa6132c877d7b81467554be5da99932fdb385d378ba4df9f60ff72b0298208c258d8937109e4f13d020521cc3ceb7bddaab2d4dcc80078be8c694466cf546234631999c5db70296e37a54db4027d0ab713a59093d7228a6d257f7ff6021c93f688f9442bb62ec2bd78d72835d45a72ec4e7f411e76c5ac48787cedc23de9e37627c19aa549978cef0b02d646685709a3df76370b6506cba5613db176e169af3199cd0482f388349a3ee8eda22f6ca17db78670797bb25ebc5826c703e4a76ed94f089afe241e41423d3d18bc1b49f6064938d6b12b85b04e0389cf1b20d3e722f629d398d71170150b19e92999d1dd4cf1e80271b2164836d732130c1a5e66c0bd9ff1125ccaa35bbfd43f15bc154fa93cb014d6bcc9e33e12f3ad6c77a0fe66ea410b0d7c8dcb613c3ca7296a174d91a3e8f0e33badc12f57b4b3f170a42633e91c65aedc84733b9b89fe1a520760f6a39ed6a99f5eec80856cdd9beb908c035bcf9ebc212d28a650902de92f1f7c2d5fa9e112621105bc3af4709f651d1ef0371c689739c52df28131d257cd6dd3efb92b97bc81f5f0983620b85bcc064d8e636a3cb0a09e624d1589dc2c642276f1267534576ebf172accdd1951dea4e81198601c72e416c72f8d31651697892f73ad44b101d2579bb02bf1e3b66cc4f5b959ef2512d1d17e74f3e6be44826e57ce763fc5f051bb82b78945613bb5f54ed5e0dcf447a6888d00b511f9b7cf4c20086a7b64ecd9de1de85ffa9caf6ba1ce1ad8d00494b24f0caa00f3c1d4b9607f7315ef19cea420780b26d0af811be8ae381f4cfd1793079a40fc093fc0920b76bfbbf753350a26a1ee07538a8617b3dc93df37eeade66d0306dd760d6672c2f11306e016422ce70e7aa57acde80ce6a8d8ced09e047d658fd35582861c4b34ad1ac94a7a97d1478ab2b40a55c03b9d5f20ec24cf33b304f76f1659f40762a6a41b0b053acd7950a26daeec8f3259db6ed4bf8e09cc4792ede64a6d032f9326c2017b7b877c1776bd01b54860192190a520980d2765182129bc2a960495369c511c0596b3c3ae71ee592ee6938e4173bed66dc9e83ca17c59bd9e8e353d1d3d3cda1372e9ce41f16f7b743e57b3765a596d1e6e560decd6f0405c6fb5cca4091dd20d879ca4b92058b1969d3d7f16a4e59b0a877cfb2b986090615e8737561cb8b64157d10e07317ffe43b36e6c9bfb4f3c675ef9738235d917a9ed243e61d0828c04577021d69a84f0dd8bc3ab936ca4526cd528c2f7286258a3525c90379395d45f51ae5af68f6d1bf25e66278b8d6c52f640f07a18fde39ed27b92e36faee3ebeb9e877f2156609a1d1a8893c098e149a4a40f20bede02e9b8d14831707792be019484e928ea94c0d42d19ebb47e55220de029089f8d19c70c73d8b00a6101382ad73a9b36fb236d7bb4fae2f31a3b9b4f4579f74759432f0c8191304500dd2435c83a9675a02e27494b5f341a80cb8f04f2b57161dbbd2005b5252d559657820996a4d391998f67f944475bf14e10f22bf2cb90173f02f5b7dae7346a1d9d10884ba378887f4cc360d90d6b1dab60c1b64dc9b6b8e329afa9fcb99d1c1db0b41362fd7be7e4a0b0dffca1614fa2a6338d11d449822eb3c9cef468d95e2ddeed5b10c90601699f3ae82ff8a07b0749ea02f3d36a89ab2f21881e0a8b3d8bf2f30078f3a233f77efd92c48dda60f350d40f0725654d5ea612788e16809f246d9ec2561d21206ea6fc78645f0f56c079cd855d4be74e8d4f74c4a80730b58e02b31f18b6a2cb2db0ee133068cfbf4c3cbcd8a91a544b2662e4053ad7721c29d5b2d11953975de829784dd8e1df1b69a7c07679eaabd0c44addd76060e3bb330c6130943bfb390ae48d8b377bbde32a154e88f215d34da2a15181e0a7f8904f335f9854b1c913651059a65a3f319b56edda82030ec44c4265980facd92d64acb7269bd1d2a63ee0bf32c122c09e8b8545f67ff2a5c3ca3f7f39dbf46defa3aedc87549d97a6ffee99781c6b24c4fdd0d9ddb9ab17a8c96de40859020aa87ab8dfc6e1bfb95f4c369ca3b0b58724e48ce6d571230df15ccba64b27c44b0d4f0f2257ea2b7294f534308d5821b0a5a947da7c5eb21bbe99c52f3322a0d678e303a46a12cfa57a140a249a30576fe163bcc8929c2b218ca0533b6172f871fe23fb933f8474b46def0c15c773ecbdff8f416930f50d89c103c4b6301df24d96189a33a7d26f49eeaf9e81b19f662fda590323727ed28f62b35d083b9ca724b8d79a0e3fbb860a1de598cdb6baadc62e662f7c873a88b382835b298d8d9baa0d883a116f18187b48bf230900588d6c19ec49a17c1217372c989752415106e52b33ab1edf5cc67a6649c77240abd52fce0d42fd8101eb6137c900132f0243f7bd74af19e7741bfc0d03f2c1a7e04a71bb7e0f8512738cec46096a77e58f0a3ece9888d5e3db9f6d9389e17035b9c0cc2870a60d6eed857774274c07d2cd6a6fa0a5a0d8637f4ab4dc88c20a87cd9e18f326c4823027c100535b14f00751a5d950ebcf1fd5e410e814e7d76f0dec6c9d1c8e25760ef16dc74b61f53fd737154ea1ca18b8938a3ffb8242dbdcf82dcdd11e5e8a1674f311716563c94fb0fe006a6832a3d87f9e2381108386946f6f88ef012530bab33dfcac38c43d53e1482a053152e501eaf655d79c1e2d784d19fc52d8d7253754963fddd8a00c1335fbb2c95bd52ce207364469968694ea8aa9c7ced2215620317b4848219a3d186b98ed64716e5a827ce911abb8b3f423c8ff24aee5acf36c38cd260361883173988e7269f90dd5d0e44eaba2a88592d9b02ad19045ecbfd5efa943e9b7745b31991d968a30f9cd8565df1fd37aed6f88cdd9bcdd564ab7bcb43ed7f834ffe378e45eea584a9b24a54a663a320aa1ff9d4672ec88523f9487e34b17b0841dbfd8141e6a72f860e6af0ebcb0a7b59ac83129f9d6e18350d294f44af3a2959f072f8d997e6aad8b39268d0dab7d931666c7037082833303f1abae5c034aaef57f64afd5909226d241bb1bec33e16a2541140c41f4dd3c88a6ca9a529046d43e88fbec1d4d27b8a859af2087d99ef66d04078655e28986b13f1ef109fa47784e279dbaa0a1020abc85d2f8a7e99b34343c5de4f9430f820a274c2271bb3b7c819fe7680fbdf84f2a5bd524f871fe773058c189cc13a49e78cae7299b1473f4f07bb33ce8b637a04030f93685b53b46200219263df79aab80064fc2819af6073b69e2e350372e41ce56cfc5945ec3775f7cf7eb287cb5d39947c697594f82d653354af81183c2a0311ed9bae2da931f66f859a0264cdfe3902d4a4fe70f8ab9285af2caa499d38202ac089fb31cb8b26d005a16025a24697a8e2b8e4cc316638c98d7255c3bbe9b131f7f38219a32e0a2b44b3e1f3b3bedc36fb989103a7bf62fd1991f0f6822821e5c8ddc35bbb6a8b9b875d7bbf8db85341447dd7e1c954ab7a4344ffcaf4d76e33d5a6dcb24e55942a515b341c213597eb8feb1eca386f32eb8e106b2139654bd3d73e3cc7a3dda4af406def297be310c48e7cbe0fd79268e1d3a97e7c5c7de4e8c854427c28772c7c7e714f8f2c5d2df7540a0b7164428812716d60484b35639ee8a1c3d3605abd2cf1f17e1f56d378fe4bfd24a2a5f9f5b9ad08b02b30a5353edd67908b1688f265cce6c246d7663d29fb5daa71c17d13a44cee2579e97b4b7061f51af5380384ce4692a0dfb611ab9089f93ca17bec7ce7d33ed5015f4549d31f8adb128bd16d48a55ef2c93f4fc7d13a07f22bf0219845def23187c1f440fd559117295bfc05f8a9660063fbd946f4511c55f18b16b2a030a1d09c58863b9d7b7a9a122482dd2cbc320b53c7c976a766b30fbab0da84b925f468455268c50efbbbc57978ffb85b93dd556a8514f6c0cf324034b2d4d433e52345b255d5db0e2d6edfd9da54b65befa0cfe7f61527b8500dcc1b583f4936edbbbf1b31eb6180050528420eb261fab4aff225e8c03d07bcb456e93e6e019a488a051fd63cd2056efe2ef651cdbbb5230dd9a4e41340000866108db5a477c545efcb0598f6ebe10d4ad2cb3311634bb2cf4be0889b971c206986d36ae429d724715b10f996e6c366356043cabc8b1a80411697ab4c4de0fc881ea97fe2b5ec2f82de7bb3b847f41df741dd4bdaa72461efdd6aa2cb849ceeffd4823d6340b44f6fb719266eb682843ec0101793c0afebdf156dbedae6989205eb300b006410ec791341d61e96ca11695b7d7bec08a50e7233cfdc7f03411cd60eeabe6f21a3f2a35fd6c8506b39af27785815749b957ffb0926a6e5b495638df24654e04ebae64a0a35b95650c9d7dafc67159ff5ea85ced6354f543a881e49eaf82daf5d6f4392123a8de82218a2bc67ac8b097be333786aaadb9e5d2fcc8bb80e8027b392e58965cd08fc78e92868b77e1d950a5a6e189923c3649abfa0e3275beecc539db94389de1701eab5e578fd8de2d754287df9e7dd89364800a2dc7c8fd82f6739675c63a4626fbde59c9b6ebebc472d1a0bd44fe71ac62ac169be54a3e239a128f6627ebbe21522fa9a3e47801ae13287164fdfa066249821a8f6683a1629b0c07fd3ce996b265f2cf1caefef0e6a2ac5ff61f516fad4a77239b450e44611c14be7205c435c165912177592bfaa8502c84e78b8a5b619d55b1cd74e686f095ce5009f6273b4750c85e636191eddfb62306cf63db7ff9ffef43f8009ff0e977a3019c50411b31568341f9e86bb692b9644b029fa9300336e166787d519819bba5a23415a4ebc78aa1d4952701e81ca5f000569f396a60627767f2a9e28090ebf19fb308267eafb94cb9f328803bdbc3a6f08454f4e480136cdf3361d80a91772954dd5d4078ccb41c1f8aec0d7b920a44c06a5891310aec74c2ae2a161c35a3f084b744d41a8d4be043e2bc6337e0d9fe871edc8255f5c046b73f91d46a8d0fbaaa69f71dd88ef4ceed171878efec5c3363aa0169725de650ad13770d62492c83e9e9e918a9c1505e6499cbb7e64e5c0acb954977561ad5e3f6771ed83766ae503e4daab4195c596b585936db8a44630226b9ebec537135dbaf5a5bcb46e318abd0bdf2678f3c522bed4cc7a454f2cf06f6b6829b5cb809d96b6bf8df1fbb0ce3d9863688bc452b12b3e2912184012c46d5f983229cd706a6a78306dbc001033823dfb266d619cb74bc72022c4bc27ac76928a501ed8160f68eb464ea1f9da535bffafe122925e4029f269390e7938c64d3ff2ef6512074237cddda38741da5e21e6fcdaffd67c855e52c448d2e63b6fc4b76747436e90dc406cbd0485cbfe02879177f48629d692698cbb51b293f014ba8fd6474c3953ffd6ae2c653f4abc97ef8f326778778bc09a3611744404ac7fa824c87a92b6234914e90ee4c0b9d9386cb6153a2b708880cccd0600791061218e0353ba566bf84fe4a47103cddeb3ca0019d9e1ede821f93311ffa2280523c4b49639f25ddc0b06c86db27e32b50219a839de4a77a63ea52eb7f56a92524279d3d54f4b8f2fa09ff1ce93864c07238db992569bf5f5a3bf38346956f3e7cddaab80b61c324176f2952f12cd2a4bcae3be62b6b64a3c257e065ae489fd65f19533c2a63297923f7e03e5ecd48a1e67ba07c305b672dfc45f89c18af1b75e98bb7b7e8c4fbd266c1f0373c8854e8c649d13321e3d43eeda81656c795758124ae76af48413bc857d82a1ea10d79d8ff598a1c64f1d041e7cf639f33768ca63abb2d50a7e831026a4fee4441a9909d606cb034d1c3f8a8af298c50e4dbe08bf10c8ef39e5def0ea7bfe9f9766d28c8f1759fe51c987cca4c6f2ab545338f5a7b6f2374eb9477560fbd251c7e9e41a23591d17ad406404e917876274046a6d3d3047dbe529a2caa09603c89886119c45dff8d0dbe4ec3de92f92d013e64740cc5e657b57b7de4877e82d8819dd7b57c62b7cfe5de114e4bbf5ab3e533dc9837d14d0d9899983bd4cdc6f23e7507ed3e699ed2e35218bab40442f2dfee045f90f97a8a575570f87a5d2a9a12bff19791cfd7a361e373d0f6dd078ece801ba3e3ff47cec5201dffc540a5176fbf9c76a4a186bae1c41b2dc7c609af31837d3420e47bc3160694e135488dd4fc8ab01ca0ff31d6a4bf85297c255ef50807379e37520820229c5750da2b22ef52d461a3857f18c20d2e1da196349060668ae37e438baed3b8915868756d4fb6c54f70e6718044e3ecc0f11e34038c1e3282d9b88f7d385cce01d23c9a3c5c38f29ee0bb59d776c2284db3917e3949a440d997beb6d8aa82feb5fa2c213edd3ca3b2c7b83fcf851f08b81c427345618e635cf51da19fbf5cf5b2fbf7d088de7efd739dd0262e7c29a8e16f9b776d6d7730ad6b531d67b4d07d636b72129c0693aaa925145922a67c467ec1e5a40af89942de2b1d1aa88ea2eb18c66d4396ddb12b38038b083d05cb5c07bcc62b7edd81c7b10a104c51f2f4bc9b296186823ef02cb5150b90cabe839cd19901b08304e8dd586e83bc8ce7e9bd48eef02fc65bd8d1dd11621fe7aaa9627a073cff73ee7e60348396101329d2ecde8dd2fc9f3902ca49ecf73e1ade22262b45738c08090a2e36ba059caeb3c07c250af01512c18ecdea3c7849d23e1ba5cdf8351f29f5acdc785f3b03810be56fe0f7aa719a608cb6cbeb29280fa12c12ba5ce4d3912e031dc4f8f1c94d78c2e82f904c2c104201aa401171d641b63700f4aa472b11ccf30059a2e3cdc6798ae321f43218262e18f3a58517a6aed6bd83948e6d505869aafe1a7f7faf200e8968c44b5e7800d7ff569b293fcde4647bb65106b1f54a2a980690ee76e1e8db8f10dce07614fc2d7de85db501a54e780ef874e2b5043764b0f4f23c80646db908cc99edabbd5ddbfd0e5f1106bb57a506b20ae1efe4bf55c812758d52d925282b5187ac01b41274514673c462aa0ef67eeafe89bb5a31bccbe98c5649c07f7f1384ab64f69e25d796c16516a49981183eac4362dc44a8df9ea48df6d930fce998a3f70538530b4d13556eae52afdf580794a06db914ba2a69fb9924ffb971b19b25602eb0bd179c58be1c6249d8e409f6f8e239b429ae0865d5038a2590dbca7d364e11e4e99a627afaf55284bd11521c4054329e55bbee966886cc2f930e6dbd0afc24f026c1d0bd391a501f61c9f393d2fbaf8e8499965c1d8daa63eac56e63b562c130fb067c32dec28123aa1437872b0b837c5ee82c0733b4f32fa50382b45ab4ad619c42899b8eb44b1f61d4a038dcd682428d82ce90519422bdc1cdc8a85fb796ec3080ac99e249b6c90799e9f203ba4764e8800e2f3a5822e41a35af872111d1cbf1656e4bcc31a91bba89b6146e09770d40391ce74cd6e7c2051e250d6bc526d4f9765289051ba200afffa0253a22a55a9cab3b0221472caaacce3dd76ac6ae4b150e6f1266d787271b3db89e1f2bcd672b1d59021d46c8cdf273b1456f1902b6e9206fe9f750ee6a7545309742e95650451432b897fa3ffb0cca9fecc6e3cd44ad716db2761ee3372287d5368fca4b6e559340174aeabe806563ef87ee9a294f3fe17ba77cacc3c8739d716332fc44fa6b6b43b2de2a23c95acc3f636ef6c6e0750ced5bd103f4b672805cf80aad8cd4e5b0e50d77bea3dcb9f6d7d39226b624492bbb4ef5a00cd8aeccea5043d8b456da53485e55c9e045394840e74e542873a3e329391299cedd359eef49b4040931cc96b9178c1c28a8d1e7bb7b51f9d018be4ef655eed80ada8bb030200dc2404a393ef21cfb0662e73903895b002d5c1d59c12685d801bdab20223475b6a1b60134449dad753a68f18d2d33f20918b89fe4fc5bb9a4229361aee672db7dfd316e55e3fe7c3c8d800a1df1efeed65680426d6fcdf8826836d79f2574037801d69a265ff4572b6322d654e61496d0571df05f1612643be753cb068a0af591f308cc23f87d2a8cf0ed4239b3d5ce70dccf7d17fec46849320de8763cae887f8de146a7fa0ee219f055a0ce7597acfac66ee3faba681d77e70ab5eb963b0a1092b95396259d3e423d5751ae7d7fc21ffe5f39a68542d1bcf6906e7f8b43578692f76512d296594b8f0e00fedf816460fd5ad220bc532fdce64d2dd129a41f9ba7447f739ccde85ee2334e29acbe303e79daef563c91c630b970e7fc3184610a12445c75d5f58ba0dcf1975318a1b61f66b9098e1e9a5c5263bab6a7f91213ff755b8e87e6336184e74d160962d0584eb2ed28e729ae5c12041e12eb7938a128124c03e287998132959d02c12f46035b72dfe9195af64f42a60c15af8dc7a392227ed79b13fd622e2cd0c4a0de0c0299ef52f77d0252b5ff0fc3fc0b8e620ea9f7d6540c31c6da83a0fb2b56c0872e9c3b3f12d70d7785494af8806ba096b26e3ede7e8c1ed90a6651a9214d7bbbb4a47b48f45b1b47cac5704376b670f41c233106f41782ee280a9b7e8c9b3eeb7b65007b0b74e6c28605b4c1e834daa651a9de982f7903f69b93cfd3636398f8d4b6bc7c7c9be0712903165dc96efb0b014c426125a30b0d94cdefb3a10be1f5af3ff466f82f4cd232b467e50dd5a9dece4f37113f8ac003d5a76588ec16b755b3b9e5edf463d920b42ba0a24924425af528e21149ee5b8662356d4b71c032cd5c066a574f93ac10c8b3ef9a4b63ffaeeb8f496e8392ff356f1146bb51489ea775aeed1d3feb2d93dfc801453978b2dd997a9fc14171f1988ae71de61887900e62ac6f7c0b70360317dea81d80e3f4910c9f79c499a78579e55a7e4a4af75094dcc15625a273153e23abca6988a6e8507f787785165250ed046aa7307887bbf1f63b535e57c12887c6d83a7f54822835913428171fb4353832c9a8783df3539f6c67c981249a5d3976c3b0288607fb7fc9d2c4b38349d5159fce395c1792a312f5daebbfe7d1180df0982a1287ca73ffc404279cc34e01e27f39b77975fddb1c2944d57acdc2fbe06ba3ee93f783e42298ceee6eb7d363b792f14d680797617723bd19b5e6168859f2b5b2f7477bae0ff6af0e18e1f55d87b162dbf4f48d12b1493c49ac4cb72d45f875c3f93cedb599726a41752922e662194ebf66ce333d76738760051f7ee3f2f50fe273a9511998b37a36bab8a1817d164f27078e93c55c3cc04e52e12e16f4ef2212a49e68214112b0c3588315b258f5c6b4f4249f85809abca9c63132f86c3ac35f119a2a6b3031b76fc4c77de824795de336bda7cc6f0a06d155c1ae77069e83c757050e57f6621af3d97844884b05b757ab19f60737273a2f1a42fcf558ab1b39f397d5d5f45554f044e165b1c68b27e99f479de276b2a6497c0b8c8ce3ff7c9c638bc9c4888c5380959b64974493c644956cb270a350b20e1ded6ffc6d661e3452547bf4557479aef6a560bfd92e88dc6656975f0f918828282a138dab65ace7bb56acc5738c8314e3ba656194d32b40cdb0b56c82eb1cb17ec5a3ca44724737c65c00d89be2071330b067f137926fdb285a954484265097177aaf0d08230e1ca9396c4e16ed20080620f4dbbf7b39ab328c15a030c9e77d206e8d5c86cdf6f19f10cd643c280abc86f3a54b8ee410636c53c4360ca1acf8ca26626404801154bcb56f8a4b85908dd59a0b832f02a97245ef02c67ef058fe158eb5a6844997fee67663bd0e4d5e131cdf5d8d3ec35d36d470d03f958ba9202072095a11e943b016649300a5b4dab79707ff23413f3e211ca452ecf646f918d2ab41b9cc83fc3be2961ef1239e3600b2d244f00b43519ca27b0749cdaf30ce6e784147322049f258bda931d4811dcb26ff9bcf8130b5f10ce24655ab8d15657d8e66810856509a98c462e3f9ad4bca30d2808d27ed21720e8607e891a837c3a8f898d1bd8eeb9b8f5ba6e489a048f0df4b4682154a01bac85865898d836e1250b6c85085cb2ab7a207dd0390af77321254670171b597e786a01f7a72d37c803844db3f6ee420c170af5be92953ee3dce53964447799766cb0fda6cf593cdfb262ac06f2398239ded66223401447e0ff8a947e1407fb7ba3547ed80015f9202f865044a98689000bc39bcaf2d118f92ab80dd8fb6660b5504eb4498d6055da5cb712f0ed8d5bfb6f909d2547e16335f8aa0623941e4ca2e0bd017bb7fd66b97ccbb489386c7ea825e4505d9d42d0dbc3cbe4624697d632fda92f500f854944a946cce065cffed129aaba6e4f6f8af2e5178bb36cfd5b1925251b372050c6a7b81574ddc2bbf53e87d620363584a2f07b9f4edbe2c5fc8d1cf2d7fee46530add4f151169cae91d4dcca654e00ead5353c3d048af5f3e8abd788306c102103bd454d810c3a6fcbb6e7a963657a1641ea84e93d149740f03d3285f6fe7e34793278fff8699fde4451f59963cb1d64d24422d5b8f9a40f28789abdd9f629cc8c107ce77abdde2acd2a5ead37f8114a610fa9fc118fb2074794f8921c80a97bfa89dca36991645c1fc503fde847657b2355cf3a95c5b7b1adf4b7787da4fbdfe88872b1d9fbceb2bac7c5bbd104957c933979af2506a1f3802eaad8980101c9a607f509267790312779a23ffc9c19cdd95a991549607a9158c88e701cf5c1b5046af3a378064b2efee676275b0dafc3c55e6c054a215c0d759c6c706f4072e6254dbcf1cf4d115e404b6feb83ffc6b8939d5eb7eb99479e0816bf1800a8b550e0c372155ec4f0f033fe980628b378bb2b3a60fd59f91f763ce8e62db1fe26db4ba8b01f8543eb30e25d252c59380fd0b7c379653a00f16d78360e957ebe706bd6dc3716b3496b55e165bf826177684823356cd4baf1c5e6efe6bb94b1d1cebb9346e16404e03935f9a75604e5211ba49cd8451740a3626b23544bf3ac1bdf87988c1c30a7b80cb5e2184af8ba6c4fe2c48d01411d4cdcfdd94f7313e84988fb08a83549049f44dedfd8022d743c395c795e81afe626c550bd3c496a6375f5682c90f7fb53179da4a8d5623caf987bcbc711a247df8f59cd7fc97ed994a72bf3894a84f7f435314116a5f3a6543e651b3af1b116f340e24e004872b60ee243b626fa94bf793ee8b89b6b7a19d6eaa219a2972a50b18b65258bb11c50ebe2129a08949518ce06126b36a578d6da9d2ab6bda412188a4e5ef5f38847b143bfd91aa6f4c3a8db394b70babece6ad249d4d654e4699b1a032fbff61f4c975cbd7bc01ef2c7db25ca8721352305bf4520dd27014ecc5992969e5da3359f68d86eed601c305b2b0556f86a71729d39a609cfe8cfccfc9d50ad78e5e7c1044edf0278b8dcb345085d337d96337c2c87df69d638e1d49fe10dcd7e841bbf9d0f9cf61e0198e0378fe5a70c9e410bff124897706cfeaf5f1f0aa7ce9b199f527eb6cf216a9de2c25c8a9c9c8b8e2c83d7bf70d764921806ed0ba28ad4cfbbff4ba31fead0ddbdf0fe420f7bf0f60317251b936a7fdd469fb6c81198579110f8c1359335a04d42e0d234bbf2d0baae5309ebaaf0026e7a6df6a39817eb901ad174a0749f75825a297bffe0382ef0b101c3be29693f2c5c926f8b5e39f48aa7ddc6bc5061e06e2bb5a6d6bb09b02206d2d8676b2afdd25e4eceb78b0516f9b441327a02fd91f349ab86b751b65af54d2e6044fdd6e730bd556725518fa4797dfbeb57439ee6ae7402a69a4d2563e9f8ac4b65eb994751ce422d142956d01282b7602ed90d303cbeed9609671888cdab24e0ec20cb2d6d7cd3f227c89fde0dcb2d0e27eb1b9ad4b79f579304e2855973471f6f96cde15e495d156869207a293dd5dfd780873a5c43f95d1dacb6debae1bfe72b686925602365baba7fb08d298f76c503eb14b1c2bce3dc9266824b4616cf5563bcbde33fc6709fd6e080c9f7b55c934f1756caa57fdb8ccce04b26715327e09f3eae07484fbe62d204f72739b53fd8b760308257cc063197616e49fe77069c5dcab07fa16137e267452d7e427a669a9b7afd514d7d7ba55cde59b57c673fe10183a5b3fa77250b5d01fcdb92bfc32d732007f6e6a2911f7bd7779925fb37ac7636fbc22a1f6c651796be41fc5f4c66688d1c68d78aacaf1c0d89f5eed2cedbf67362fc3dbc5fe83a64a43df860b3cff9e25c48a7e7248b4c501c81db7b6690ca76604fa8d797ea3708b5d05fe6feeec1e1a1286b23a3374023a82fd4d5ba7d8022ded81713009d6c2d652bef1bd0bd85a5d0365c5d53f2618e06218af66df56d8cae386dcd8da80bd68e437e47cc6c3a15b9637ff850230155d2a5d63a9fba72973014c3b1b637c763731a3e01aa0a9da25b5ec3883c0c027f1ab6a0c0dad4d7c827b36bd43af7449b1c323f6efbf765cd0927b2c0f82278a6321197f35158f9f93b7caccf1f5db6fefed393e1d0e8fa872e4dc6d0975a1c5f2e44f540ae0aed981298e98026882e240cec89206802d79215fc0b477f2fb87fab0036ce1a9a2f85a46e89496435266fdfeb7db9dad2a9e66b3b3c2660a09d02d8fd55bd6a43b27c7e4cd5ab78ebe7b89138721def237308fc30d3bd1542042c7758dd022f39ada6e337979383bc41cc09188b5dc8d776b4daa62a51229696b751a99d7cc94a21fb5f9bb6e8927b943d07bff789cc28687a2c6fc2f1607aee299c288a618c16b905631f0da455f9837dc55c00e45ad497b5dd10cde62f6e7ff1a590d88212eea6e5334d25f161d8be503927b7ee22240e3f7af7b8e3824bd31d9bb47f7a2a1648e2ad5aedf04839d43c24e7e2b316c033575989f6716e43ee113be1c839ad2ffeddd2e6bed2b67652dc4a37ee10046a9d5eea0b4219db1e4dc318a4caee412081c624a8ceca69c5c3d89b53b88107ac98cba9abeb9a11de09dca0b1a656426d3fc21f88e95033f5b81b5174bbe2fee3c0344f56a49884a890783f553a1c7305be8782cb448e0869c1cd6698924a405bf5d0fbe439d9a0bc0c9f7b831ff1e55cf9e242350bd6c8fa8b2f939750dbc06d3adfd62ccd2c1053599a763c4819404913f9ae1566b9363450632c1cc65984f88803e9d8cde018ac2de5cdff0994c53ae285b488b8bc33e530f5b360f141a4d1e3ecfc0a35badba92bb306f316fbfd54b4591ad25c69a3d303c91798d828101b705821b39abce59aa6a3fdd7d1ff25aa788c8c12733a46f078e58df3615faa5c8ce0392fb3ba9b96ef92df36cdfa9f6d868a8b7f7e0b0216493dc2f1691f7502964f1723991b177f63e14d8debcfc9ee3db2ce1c1d0d8ac6475857ce7973a64131cb9d6323261e50397047fdc5ed50c7251b2db79d22c8df4dee0f4c8415f5ea1aa78751f81b116e6553b58e20f6e32d28f13643012d4a00afc9927f2b3b3fcb843df7de6b8d95d7ddd2dccc0a67b850cb15614ffe4c5817f51c3976be65a5c4f0efad47e7e8672a2e07b48ee4922a43f35efed4d9e5e280f11201abbe3257c89c72a2aa96ac64f6e776bb39ddde90a3e4d99bc606d8eaaf77ed9134086e08ba084ac05403dd40491946e8276ad755d5a4002e742b2b2d4dc0f6700a77922c407b6b90798cb66c631648724b2f84c83bcca58bc3316f86baaa6884684bc25b81a578417e01f755a37dc0380a73f61199a0cdaa9a249690898db0499749b55e25f8db41d225c89e7477f1a2f919435a17f2da1014aa763f2c032ba81acef5b63ad7bc889b0b8f4adba2f9eaab8b808e6f69303e1790c0ea418059d8d688aad2578676a53c1c5f5f9b8e6805c8bc5bf83b97b3d3528262d212d8186eb41783bea412d80e8706ee8a411da3f5dd6363e8547493e8797882953029483a957cf03dd944456cbdead80fc1422c26bf6274d46e84df2e8421a669910f6548e0411b9554a3ca629f2ea6db4e147629d77dcef9cf73997d432282bbbe2db492efad8bd35b5ab171502399206286fcdc6cac06e6e08f76f5b07653a4dc57a698e76fd1e0de0954e10537689f867ffc9f83aefcf0e3147469f1eb757f5494046dff0d45d256d652cc53e442bd02d7dea68f11ce998d0070c63dafec2cdb257de275c85190d9b62326301f9681585816f4959206d629fc674a3c7890474b6608893e261a56431b5561ce3ecc275fc0c1d8c94224bd01394d38d8a02a520434e4702cbd45579ea37ca054ba82ceb28dc0c1b0458c39a1e0ba642034444afbec927c1fc612438b22fcd1e7a5bf38eae2384e82698895e058628d38c376645a429cd62d0f1526c3b181e4319690f1ec550cafcb4071a57bce17f8e639e71569c163e95286d46cfafe8aac70d7915be31a45c23ae80741c2b2d8d8b7952fcfe0199adad2a8e89c61c789672b04e669e2917427de7cca3b3e881186d9486f7228109ccd5a2f67ed44f4aabd8d0c5477d6d2eebb07ccf281152799725a947ea55fb5c3ba785381f7febd462f5acefddb460c9ea7f8d21026688367f7402d5ed701c483c6b0f32e2196358ca50d97a52d32187344714d5d95cf3a23024e80aa408e2077b3c061cae7130e6ba7d81f3bd31387b928509f4e22aef25da1812235f9f31a16a9a18a32b46a29002f7cc375977be94fb37034ef0c101218cbf4c24fcb615de0f1eb36f2e9310d99a8634af0ac0003ae95dd8a3818146601d2a7919f63342f0a337c450593bac99e22420187ca1f7acf0d578f39a2176c6eff547cdfb8c391c120989d0f7a32b408d6668b1f8a5ef5d75077206cff642ee493c43cc81aa0124b498d492f7a28677e85d4b29255e121c0cc373653a6652bb4d0112c640bd1050501fd0577c4a78d0a28bc3bfe6a1727618ec287b492583afb3baed8910c250971d8dbd57ffe9932aa5e8ff11a1ccddd30499db550882a458db431a35c24827f23dd7590bdb747a5905421b4598dc3cb79f0b633edc098179adb93677276178f6c90046d3aaa30d8ac356a5ecd62f40c6803bc22d9c8af5f2261f92a932aa7507d7af897849165f58dcc5335b9b039b502f39a966b0e508732b9ca988a0661e95ea5ecac95a18bcf68c343df5956dbbe4f0906be831f754978d9251784b8f33091b9b05391afb272072cb8c641b747856565ba196e683fd5992fdfadb67397690ee32ae32e8a22075f3a250feac02f411d202d71bf61ecc1eb687e3797c73e3a9b9c6948ed57fcf85133073c049c4dd549b1d17c3b6dd5795830bec2e6e354b9eb7dceeea5bcd6ba452123eacd4a7d556686fbc5344fdba163b0be2941bedfa5172093da883e0f2c9f0732657f85c688c192aa005f20d833e131d3f83e1278c0f94c8363815477038a091847fb384e077520ebf23f11a9c5ddce75bdbfc5cd8e58c6f63943b347dadb5ac8e69a9e5ab8fec95903daa7b15d6b263f6a73799fcf7f3053a6083d6f39a9a4de58aa6430a77f15423fd992bdfc3dfd6663c6f9299708f8f3e425b3c2ff3a14149a8a7c535a8c0d6bff98d01e9b6f2cc8c1ed07fdeb34b613ed481bad68854ae0eed7ff78ee1af83dd049ea027eb62b9dfa27f97e07d75fd17255243e7cc570bceaddaf6635fcdc8c9896e5e31f9a1357faaf7d2b3b02ba37fb196301fe3c62015e60f4fb1bf3fbe6bc8f763005094b338589e57cd11cee3e836846c471ea97b1b8c1f867af771fb6417f5e48c9354fc8a7965f637c6ae31f72a79400873ef980f4f45d76e9602cdf0b98b283a07e8e089361a1c4c5e84640699510e062ed8c658e3521501edc35360571533e195f7b0aac6f525dca004040b5112fe70f944e1b142d13f0a440f19f0188bd7b35eea42cb00c247adde06745806bc0f84abf326b91b80e22b1851490732d4f6ea037b5539807c0e76e985f89d4d54ec92182e4344ed2154792467bc42f27471058587d85db8ad01348dfe2c418079ab6a6ca0b95291c3be64c4db4929a5b9a4ab337fde008d05988c9128e34370a607a5ab8ab02e354cb76a6d8daaf817932b1cdd8258054e2ef335f0b8c922be7a5a1d2a38d0acb43853d372fc1c221ccbe8f3b875a0e1d8593eec9c4628d8b3e98f6146bef5213bc958ab21b12f7d1dd6354fb64278f5abe25f9818d2541769b2ac185f3672a06d5cbcaf4daecf2b0a6e2ebf9c243d7e09ce2679bf7a47711a554154fe72da4224c50a1be9dc1c7b99f63c8e05b270cf6db16abec907114307606f7965ed8c3ed8ce147ee37a704eff9ec5a8d6747aede4fda69e32154e524d968e4c11d0b13a9531d9a922da37ebc7442d9bd042528d21518ddbe1542e9afbbed21bc7a4e87d7f905936c040e8e1d479651cdd2bd1a3002a1d646d176d92cae9803190f024f8ffa6dd3da46e014f2c644093a2077e31ad10378e58cbf04db4e388e0c487cc7a7a6da44e222500f9ae2b1606596cac6c6d8340e5ac118e229d61babcdc01bb0db19143fd36a3ea8fec86920d182ef5ba7df17efe22f75bdfbaaa7dbc4a41dc81fd66b14dce6c1469cf23364a425ad8ae7f6f8b8b3f0365945dfcaa5610d48249b6d3079d69706804be1d5ffe647aac84060d9aac92cc0529dd6fdebf4bac66a6fb312e3e83e0b178ac160a53d28010a808ccf529f36fde7757b418a587310adea733546cac5ea6b5d1420218e23c7c0044714d6dfce5ff157defcb11cadd6414690ea142006ae370d0b305e2c19fe5a3c4ef30ab88acac452102f1809af045f00d87823c65ac1e59189c1f17e94bd823894e95cc64a7bc0ceeb73ee5c8153731288a0b54842d9fb251a1ffeaa87892034df377671ce7f7c16be65147c62ad0f2727c0673f574e1730cfea42decb3f0f7ae3909ffe17ccb2f6c23d5b915766279d6a1f1ddbc6b2230c4f741da571e97f29aa7a7acc3a0232674524cb1f5bf0f5d7d890f808205de4210e20f4f64b4a22e63899777f99de90e75d4903a4ca7938516e9de0037b8bae50104b63a0660e367d3fb595c7f806d3fb4a9e1d968870aaad294cbbc3bbb9116c64a2d0fbcb85091bc8aeb9f687fc933b5a75bc35cc1fc7127efcc58fa82c5592a587de983c605d06f3cbf2061a5c910f13d6e20fc3fb9f37e1daa95def5afded890edd91b08bec8f51d9003c963e2f4fb07da1b0702813472f374f300771ae69da54fffa1f98531cd375e44383fa4ab2a732826537f416e9858c440dab5a415a785bb42d1760a0ffd803c32891eb0976cfdf32f81bda01317262c1787bcad8339f61b6f9d4527220bf971f6fc894972e303e91c0079b84fac5bc1550142fb0303d012530ebc03f7a34563f55d14b86cffe564e2b7f023c629c8a48da28ba01f9d368326a7aeadf4ae38aa871754c19c56469719cbdf5a0ec10a00c7502b22d752f3d2973b2c0e4f8f3e9d0f67a79cba32a42e5a15293c8cb0e87318646266bff0c6f86f037e1f8bdd5937ee22d292af8f456f7ec04f5534ff8e85079f872b8f3b4d6701da25345bfc8590a6906ec28dc64da80ffb34e4a7f099f66c894b908c416e2ea8bbd15b5e7a1e1c4099b15c39ed51ce11822746e28504c86bd51bc9a3fc7109040f8d5556323ed505c59585d9f18066b14c8805fb84a1b41ced3cd68f94444b0897d8b287b895df3fbb570776b0814eb9e3ac6baade898dcb695732af52b3dba05f8bde39a123fcc7497b495332abe4d665e579775fa2bb988994adf5c4ee174aa292a9100d038928e1b7f9511189b006c0a7133e46a8850446b34cec590afa5be54134bf57d1fa461d1ca6e753cc5d7ff6a1ce00f9a169876566ff415753fa055b26deb94259d32241cfef77959665e7d0fbd7d673a3195860675da67a23b1523fa8d808dff4cf85c7da362463776adeb286c9228e10400ea8d5cdaf260b97751b60bb82b71ee0ab4d7228a65d7b8d29b54e075510bd4145705956f4f0fff3431e6fc9ff387d07ff25eec257cbbf0be2111ec02c9cff0d7d96bf3e15be1234f2c2b1f5d507a2bb514dcfd963ff33e543a365c03d3d3e32777584d73598c68ee8761789444ea77bd4ddeee03372d0b443dfd80d1ff6d637ff4c06deb48880fbce544a568f7d013d110aafba9a33c3a78f2e3a553169cd24ceaff8d9e8ed02908702ef49e91db5d48a47d91e6dccb5df58271ba6fdc4e4693d5a9e26696698b82326c88dd11f539cfbaf2b3532d0f4831361a662b6884851d092c2372e80d87815921083b33bd6a76054dbffe097d32ca2fa76bcde191111544199f9cfcdafc25525d868d3ddebf624405c34b73630fe843b0051369a8ad5b3e6dee6b1039390a5244f37b4e63570fbfc3b98141e2aa74957d12d83e89aaaeb65e94552c963f57fc51f3ba58e9fc9cc926deec6c2ae987cf34a9dee6f870c05694495bf19f3635d94dc30d8a4f6bf108da740f336c9d8fdad7cdc02bd56beab453e5c6050fbaa3e9d4babce0fe34ab1a077de63674d326d7d3fe840fc9387a51e95d9a598467eab0d1f6fdef0bd0ab043c57e0973bc7187200103aceabf5d647452071824fe037018a6e0e52a6eebe3740fcade01de0223a5719d0b9aaa4952810d92bd40015ea8f71426d37fdf32a45e3b2287cc88ae4ef76124a27f58d2698aef54f9ab5539934cd726b19787c65233ceb01de51e9659fe6a945dc40aaf6302300895c94dee55370eb0a909235ec8a637b49602e25b32811f5703b2b8fda2bff3f194fbc946c3c749c0f245d92be94c090ff7238e88f24d4e035d6e39665268c97fc07b782594c4f8d0685d8ca1bff6a241e70d680cb01004431c98f2da8ceff2e310e390fab692b81db84f1462d099d1e986e5be956c6dc6e63863a94ce63ca90da363d12b7e60c4a407f1a115e8c9a0898316d38f7ee4b1e6eaeb6bcb48b49b48d6dfc2549e282a4e02fb3564f2e92e9345b1a1751d6da8753f3f735b02fa91f4bc5612cac16092cd02cd1d2c4c3cf0b43af29ad7d63a71b49de4186bb16d5d99ff1991b64685f01a2191d9ef3a116ab0ae779fe8a574b995edf0899524ef294d5d6ee35f8bb27afc15f3cc512efb782c6566ea26871c2d2f69997cab27b69680f0980b411c69f0c332b9e4b0730ddd44c85c3d2441f3a6867ff2bc2a63b65e45b3d7d4c26fb77e169749fcfc0dd2ec4447e3a0530d7d567a622bb4fbcbc89d984b2f04f96832ea3c2804c350cce9d95cf68a38f736eb7401ea2ef42870776416f71aa5848ad12384b7be3e8f53f9a5813b8969f3daabb5ab954d835dd0fa2281edc54714582bae77ac94d1f57f1f4c9bd04f3b9ed7960a017ecc553a7355af30bb004584cd3f03933ffb38b145b441238cc4b699dfcb2618c2c727371d1b233ddbe767cdcd5bd5db451b41d3201474b71bf0ba0756a9b1427d8b4e9b0fc3c9fafeedaf44a0c7726225a865644cce182df540201e730f43efc55349d412468805d38277561013cedce30af147606febedf615617bae9febe20977cf5a30e5059541db666e8f06106e2be1c42d8bc4f7566bc69d253bd528f8ed0e9cd2b654033c95c6e3911c8698e5e26135e3e3ae65478568bc3b9e15f979ff9417564409932dec733218599b4ec099ac84876b29d4b9bf8af8e2e3629e9cef61823a741559c6b8065d9eeff580cc461f796415be60cc73477a32f83658b67e38d05f02b607e1be076318d97d708e4157c095648f25309ec1aa25836aa1486cee6914f3b02ecf7e399e3f4e4695f0188218ff7de7c1a3d32f23e9bee83f8ca6fa209b7060009102809661144b03c4a8b4d2134842b63128e58f06235c107092b3979903c114910135145753617da81efb14e24c239c18c49700c53c17d9b478c4a9f804720d2254b8dd74084554b64b0fd05f580fed48f36717508d53a5623e1fd6442b8075a37751099585f26750863a10f40850c7169f3a9cb591060f1c977ba73a5dd017962ca57a89bca5abcaa41a1978089fddbf1a32724b4d8d249b25e9b48e6a3a22568748bb1d6c206cc85c4eb9d8336d85f24b35e9ecd2efa5216c68932170158d94fcd0b2fda875bda8046caa65faafff24ccd591448c4842937366ad26f571ea6d3b3d1e7ac26747a3081ffdda647c64b984a08a8ba97cf8346c0c569fa4cbdd7286584c7ed58741bd440117e2cd116a0912cba07be760882bc3bae45d501a999cf5387b4ab1212e4030372e88872893722a325d31c7e23f14ddf52278d55b85ac7539b49e5149af9bf5f1d8a3e2a914d1eef1ca46d155f7d93c2fbccd76e25458b3188a0b6eb43c6ce9525d7b917da0fe0fb3adb56749ea921331b7918ad6d3efbec6548c30c44c3576d72afa814d4873e38235167bd45a2810cf305972d5fa103466c27f52a03d93067a595fdf77ceeb02a78643648f41ff3597ce23c499e29c156628bdb60a5dfbd0860f6840eb506d28fc49170b2b6d2b5e2a3d874f0958becec8edc74a89a4b06cb1593dd3b275531a8cd9592acc3b83f1a44033eb3ac52e2584f098afe6a495ce448c94a2016c3f53f543f80a2133364a1f91ddf36f84b0ae7cfb85acba6d125e51e49a7f5b3de816ad01e53acf92ded207c15d818ec4f3fad72a1ca2fa573b2acc84d2f9f6ec0d1144764b4a89292ae3999696effb551201c95ccb387fcd4d3452a3992d478afd5eacd4935fc759e6ec3a12cc4290f8bd163961e7c8f9ecb9548e702aad37c9964569dd444c428c3d5dbaecdde05c198b177f4b8acf16b0ab2fdc1d0b95369c29daebd3a0027d01dc4367cc8d92009a155c000b414130dc6ecc018b876ac29de3713858368ca146f917c45498a0795a2ca357f3bfe8a00918b4caa5f850d14216a3077ffea6c694a1ba418a613c29b80ba42ec467a85b19d02550fb248a3dd579ff80a45b985b22ce16470858d02b5820b0bf2fd0e942e3a38eb77fc7bbf3990ba8584e5da9c8915cebd58e3f5bc63f3bc32739270bd182a912a5acbc784db35b98c5b11ad8b886ec606ba2806f6d96ce2c2ee8b761de6f61265ddadea04bd860761dcda60a6eaed032144da43219b42decac1bf2de96dc3ffa4820f431983a8f958f82aed389af355af43b44a3ba80d3c481a1d72073b2930e9e8abec0d1cddcf4679c1569b78e46926135f10a23cacb02dbaf341eb2f87a11fa86dd882e63ed52a8ddbc82c77723378de35052a30a449d43d43975587feb951f06865796e7ca0dbfbd6b369255a4bbd330c1eae5bf47248765351ec3d9bc463101402d6fcfaf21bd7cb3dd2e0edda0578593731e8e85203b8cd3e1e0dcc8c7863ecea462fb3fd7075b0cf9d48590f06fb86316bd65447034d84c88d5d77b1eb3fd3cca51f608f711d924f199ea5a8d0d4192d588fc7a0bbaf3dbac47d3ff05f9e82f42d7ed4f7d0533b72236ee6bc94d76e21c0e2a96798e586a8c7a608137dd6589fbb8c91976d2db1fc10ecbe19df0e1005765603b234fb31527489c8d61bf0b869584b8662af4f5340b3fb1540aca0ab16c01e46d102d102df997b9c4337e7dcdf76cd0f47873802b572aa222a377618c19e1e1b8f55db8b41043fdd34bf57ce8a47c4466d313e2afb09f7c66539d27f1de273707dcab3ceaef14e913505e488a71a01f46d46dc82792b85bf52cde3177eeabe19f36da4ba846203b7580f753650d40dd283d1c3c34cfda5c4f989faec378f9ae7f776f87b1f11df9054fc2d75564e1f38794d0d60027c55e0e0f2c9975d8d29a66230228e260afd04e31933787a430055af30351d352a2eb6c9aba98c65914f90f00a02305da711c01ca7b48d36229019ec574dc995ae18c22e4ab6920b4c4338e608bafaeeb5c23c5fc67fe2da9a357f64d7af0bb3d41671ec8e71ff9b22eb0d4c8133138f4ff2a7e39d49351325cfb529b65759dcc8d2fada88cf433c4d2bd901cc257c26041205072de80ab44a7745db6ea69142450fe7d006595154f187d3ef420e46447a4859f449a52708ec158235df88bae8fb7efcc8c2bccd9da28e68620944dc9aed31e441d1e8db0523f006ab89b5494f46d4ba488a8658710b85c706f7292afdbf512723727b236e058302bf6b4ec98bee139300d0a15d27573880ec1eacf5e92128a2ef013e862654244c0a0c8105656701335be7d743d310b32fc1f2b002def4d1e2e7beafcab34e9f00e9125b495b114944b4ad8fdad1cd863c0c3c6807acfb0ffa0a3115599ca38dc01e11bfc51b77b1184183981954b139fad534e979b3583a2ea8336f2f7ea04ef0a675f294445f429ce3c7c6aaa0a98969536a8660ed55dcee112bfc7177fa5021fedbcbfb2deabc8c7b66fe9acd65687c1cab78dae891c6a21daf669f74edbdb5e7503194f3158179019f3bfa61763cc4d5f8a15a6ebd140cf6259d773dbe961baf514cba2664ea6d44ceacd91b4b4ff43ab8317965ef3f37696d33f28c77b0778a2ad40f44857775991434dab5ee1974165f0a2d03b4c2f37f4ef5e36e7e1476b976a622e77cab54d38af28978f103e18f9be9635a4017a1cb7a9081e316b18846911279b60cbb0986fd4d1400c788206a9c9af577e1222924d42453417c7c9361c3803b98be654d789448cc7b7c2461c6ec171bc65ea0b6b0f8c80737502c836f2975be87e3ddfe6812bd53e4e60782e529ef7e56613acd3739d420f23ee20ec521a211e062d39a775df9171c19e9d3056494d336506b0daf8db70ba24cfe6f3af7253a7a4163fab9d164795ff1018dc2d00b6009eb7db030b14c9d2d7eeea8fd0ce29e44f549285c5dd45c9ad9f6288576787b2234dd43e2ee9e2175692d58b2bc8e7d78d81e69a3708e54fc86aea00fce74d5ba42fa0466c222cfc1c0a800537d24aab43c3a509874d04f5ffe488ab1f3c22c981d1897848c9ab29ddf5621d6e1520536044d29e2f83ebf8ab11241fdefdf4b7665a4ea38ab261032a16a7619d24fce3d033e0fd3971305c19acac1da9b8f9f4b2bcbf8b0799fd4b1f3be57a0a82e6b26cd93dd49c94daedd5d5a9274632dc56409ed3373cb19169bbe4a84fbfdf2c31f858dd783b3b57ea972d654ba23de3e7e973e787043b342492a221e67811ce295ba038f2be7a157aa6fd67d10c2bc2362f5ae58adee9ab83cdfa808de8f112e670e4e743fb225183b097e8d207d978d7ad652fe312abcb80b8c7cedad3270c03ef1f2d4a5ed926e7d6e37608c014c0109c5ae0622e38977eb9922fdb59ed899c534e8e260f7aad7abea75b3bfc798266b39dccd967c2361322ecc76afbf044b4c7e6bbc9b6d49d495517cf728b84bc0eac278a1359dc911a38f6bdf144b65e892b1448dbe925a7de9259326134e0073e3aa6f7e9d799b896444ab42e99e0c66576f20201eba7b6fc6328ad9ee99fe55936ec9aa2e6742ad599b7264a14c8ecc497a778845029a843358034efb8cabf73ea9742e3d4899af3a885ab922e4cf0c0202195c23a8ec2a1d2795a7e28a3442d1bf3bfa36c92e9efdcc596b5eb8b4fe2dc06bca97ecb17cd2342d3e35429ddacd0b57068740a588a86e470da054d01576896805ac56c199f441d6ea5ba1de64b06ee0e0dfb377d445d640a4ecfcf6ca1808176f5aaeceb9d87b41896d96a9a31ebbd9ca55351ca123a0e5042520fe56d24b78f61006bdfab6ff25d6d07bb1d3ea11e3cb1c0d2a061cea36a0dfcfb49a0976f5835ce6be8fd488bdf82ea6687da4040b6d8d4145c24e9159c38763afbd6559d5fc78a3980ae8a0a9d164dbf18324f9967b862b8bb07ffeb4012e5fe3b85cd163ceee8b9056b3d113368774e94a747ee697be2800e550e199370d0eea6c42fe0d03b3fca59a5017a5925f5f790a2b4d3bfad2fd83991af513199c146aa6c091a7e3092d6c7834d2e40d2fb7073c53906c2ea444d9a4c25177a7132d16d746eb62119ec4a6cb1e602adab14d1b647b1288498dd6f9e13a62a9cc20f85b82f20ad38d8e6a1f6de9c172be2634af47a91cce34ca59d2bce781c3a5135a24226570cb87029383b2d5973825f10c713836d5a733bc48b504a152f42df51ae54c50e85e9e5730c3579b0353a7d05efde2e07e5a0d8ee5418fc2103f32d9a42f9a6b4f7413488d458bb42698189f7f6e662387b55148db645958ff9d97cfe729eefcaecf8f7f6229d4552d187921ccff57b35f329a44754152f871271422c943ba85a5456f3ca389362d5be3301463c93feec4df4840c0ba20bae0e38bc5adb5f7478fea043767ee7fba2b5126e9c2a72ff9d303e71ef5a37b59297668318054bcb507cd6a0f432ce960c83213f17e9d3f7eda5663a0fca10170fc17a1053aa7951fc8a7711a92bb206d480ce925451069c0912202ddd33632a75e198e273bfd3144e933d8cf44bb98c3dff5980daa01fa0e91827172fa1dcffaedce244d44301fba2da42aec882aeabb23c4588365f3f6a7f3db85ef4d192cf88e6410ac7529d07070881676ab9f9f92ecf871b8ab27755a579396b12a4cb0912d2f3d59e20febb383fa9af9e1aa70dd078a27aad3a9063bb398ef4293655010b5482432c4d1d168a79e41d43df89c795a8e54bf71b5ee17bee6ca6965e4324ff87499fd15fd4b2652c0520d8a58a2af0956efc9976b73cb41f1243f3e8bb84dd9c16562f7bfa4fba4d514ef9da15525b32c1edebd83fc4ae55fa287d2a396dfaa0adfbfaf39184f697c0ae83d9911095b3b1149a3b475708760bcf28f5048bc0747099df8747056b44d28c9b323dee15b693a89c2a464c78b217666ef698e1a8ee675cdcb8688445952bc087a38b18c7df9af45a215d91de57bfe7dc79966eb793db747828b5e32a9e8502311269aea89de094b85ec1198af212544863c1297de50c99beb84a668fe85fd5546b1c7a36b6aea7b3ca3db5e632950c0e74ede97cd1ecf9ae326b6cd79b3a567eae8a7c51b90893f95b69e47918f91b95deaa190634d6f11fa374274dd4c006701b09347149dd5f99884e2d5f7d3dc063c4ce8e79ebee9ecd3fa0c09b4e24bd813677e95ea58df5bd5a192a42f3ced8e0919b3d107eaca122e598d797de0c4478a8670ac7df4598c5803cf49595ef5b437506e71ccdffc940af97efbb4e1af8cb09df96ed4b895fab9ec9d282743493f8a31f64d9823994a9690a88bc2b6c688c378301ddc971ebf0547e52601bb9f12bd1c5371a30e4946ff24aa6ba80e0135b14db72c8dc2f8dc08c8b4a1a8fbe640f114a03100ce5ffff502e5f10295c14c2b2cb824412116a62c504f5ed473a32f7cf124ca89d958300117649562628234c587d2e5456d299dcf7204d73c756ab3b7ed7ae34bc7ecd1ae52432a285d527fa3ad2e8f36de2cdacca977704c4d4d2cfb54cde9f0ba29d3f6ed20524be825ac109f742d8fdb520acd2d040e73f65d39e6506a10dfe121d3d80238f91682214a5fefb2161fd955d76969184fa86b829ff5b5e34c407f2b9a24b1e46a6bfd32a558a3a3bfbdecc158a54adf0d14c48f18dcbe37e14166b659435b85511d295f9d8851895ab4c05284e2149f1d2d74e6b5fa340c7fe90279c6139fead45162d571b98bca26d0384ee4de78c516386f219fe14dd6212e011c67796db661628b0256b38dd16b4207684ea33b2b49ed69cfc9f0ad93090043918aee8b49a721b261a9507750cf2ce2c9abd7fc001bffcb8397ba781034e50f2ea87fdf2bceb55fb0242dc957e651af843040035e3744ee78f4641df81c261ca915f0912338c285c2120d68fe66deb8fce740a85c2c32de08ea1159e06bfe45b3addfd1112dea0d51546b4919a5c3abacd47b46d6a0d43bdd4c81d8fb66c3e37b05ce63afa9edf3b3de77b09054b5092811b9c91421c48b38ebbe02a4d5b5252c78b4cd3eb38c7e38dc8db5a5ee16c7312abd7e958e1c6d4be73fc37a631d7e7002876c9e6beb805efdb157e9115ee59fa8c00ada97e67cfb6f9728190bfccbc5f359450f4d053dfe1c0d1115b8be2e6e8259cbcbd3700baebc58e92da6f2149cadd479fdf775cc37e63de21d5b139cb9f933bb32bf6b5c7a9923e4526e95dcf974a9f3fc736db1132dd9842fe890cc6c482d99396356663f6cff356d9eeed7f18972401d1d09fd9768b093a5cd2e65011ca66408c6acd564fc42b297d35c14f7e286485c232cd8bc952390c8b6b9350115f89f0c410cde6dafb658ddcc466bb020bdabb34c9033e039a33a76651270ee83e28fe02d59ea3850bc49cba900071fae8bffd9960d0040890bd20812f27d811131ee049e57ab4332678225075a64c6a604654a63e1fa571f380577a44f907489cb7168c36125373914efe2f088a18b4461895e0ef650369c3e97bc08d173aee7256934622489147fa98e35c79bb7b98b56c39f098d67bde943a74cbf2e5ca15c21502f4f42104e20b073e26b0ccb2f3149d388aa5fa6895db9223302c4ee56e9be0591897d37ae40bcb4c7f8d83980ccdcd456960257ac42c5489ec680d980d54391146b0aeb2559d3bbd72caa2d51c8a9d477624ad8ba251a80422b9e741bdf44602e3960118ed491f701cefa2a3e9f05695f7c4c3c2ef43e4753f4d47e4e53507eaff2bc06da2dc7d2937b74043e2f2b7c78d0c788feae88868ed64d11e5630d7470d8c822d8ac9daa924358af7e33a3d149c6d901b838a82c076087f4dfbf3d7001d64760d90d03d3ce9960519b035f1cc5ec59945f279fcef809d5681b84e3ac6dcb0cda20ff7c6912a0439a3e7a6b6677bc2453dd6036cf3aa8eb5eac403a1d4704d99f84ee564f6ed9e7a5a536bd8ebda1fe6919b59f4c7dde61ddbbf0d1ce2e8ae7bac466a886c5c73deb59cd03090e7f181243d93b324cce4f4c68798f09f0889d7e770bdfa6625a42f4a90bf21c4394150c760244aa896ce0c27ff04b1c95252c312160ba32b7b33f738fb23de54f51f55a0d1b68deba2a619eec9b5cb22c3963199ef42dba8c212b87fb739ae8099ba83b9cb7400b9fa26ccb8e00dd0fa6057c3c9d2f2fbb6503623e83887e980b87c5db39fdd29ad84de1a1dfc6133d9ecbe5a9709b37b2d98b2a925010cc0082214da4fd848ef83bfee5d2b8d9cbd71bbc2e5efe49a499518996ca5dd7a7798aabbc102e4a7a23e2fac4399d4367d0ee26ef7811e2c797a0366f348105f7390439256759172bd8e4845c42048028c859c2cb0c18cf85a4aea1ed8eb71280f2ffc9b9fb3cafcc5da8a8a2b3f0d636c13e9e8ebaf9c1bd7b4b47086be3fadc74db6f897b7e5a19594397452e189541645b2a09401fd799f70cc0679b69b79eb45c863f5c01baab7f66467214e204c9325ba241d788e0afc153e269ba41f06185aa1e0a3c70fac753d132da541865dab4dea5f0c9307c0478999d1ce2f98078ff690e0f5253f296f9606488de4faaf016dfcac5c235ac1533fed76a39255db2bff13247d8e63f98ca98b423cac68c5d8bf62af57acab6a9404020d273e4132a31d235ff30e8bdfe54c063302e8ef8ded7471e1265265cb84725f8001c84975232a69039545a22303f36660d2f502e1712eb5702341547c5b2f7e0924685b7eb40bbf5ab7f8dca24563aab241167fd59794d8edde12f7eea6239c509904b3a1196307c47e72f0908431c25886610b74cee0a09258519ce154bee9a7e2a7dc936dcf6b6b949d5d0f6acf90ba20990d3216add54ef4ba050856f9bcd08d68fd30d20435c86e3167a703c8fb784d6e08bdb5b46783a3c584f3c95141ece291d9195bad0c03b7cc7fed48a0fdd5031195f9d41179fa84cddf92d3cd58d2cc9bf300f27a522ac12a324b61692c38d29ce567b61d9db20ea7ecd26152585eb393667b7c657aa4a8eaa7ed113e047172895a7c9e94f8aa505511a6a1285fc79827e7396d5ee2886090ba6094d3f2c5e3511bc41b1d8c3eb8a44853a6ac6c7fdc274cbe83f7e185ac4cff8cb70f727998e2bfc12770365694f7f2bcd1af28bf849ea6ff4644ead826abc2814d9043bb261fa1dcf10432878b66c11b3b9d9105ddaf6a3aece4615c163c609ee5e5207e71a6418265710945479c3fea00eafe2f550ef618e168a1b3decb57e0cbe564b375b868bc09dc33e07e9add4b7b62e78f7a30150d5232ffc3ad4438836bc6902336efd49bd62b299a9f33fecda42cec3d1c627f4ac182c6ffb8347238ade75b36843fc10c05555f3a41cbc70c549e9da99bc36723cb7529e39901384d13b9d666d49d4cfa62a9ff06bdb46729ff167f127d187cdf19b8f8d58945a5e101291c41d04b7f6e47c2d953af42d125b2f9039759b62dbd53bbc1ee171f62f3ae62bfede3c0633f0128690716ac4ef0b0fe4ad744496e899c8cf601cad7a717f890fd6463c53a06321ebffab41986794542ef9a0ca33684f2f696ce370fc136c03965582a2a973a6220bcaeccbfb38d57033b0bf3f6409921ae6daf53c7dca1c5f6479386a5c6c624a289914810b95e3c0d4e5fba27c39fad7bed68774bf6979ad1526010a82d52c060fc4a80268a6787d8d02ccb951e47c8d1f59b6fb952eb3ddc57f9d96241ebbcb6aab6d0fe20d283daccddeed84eb4d52863cde024bdbdd77c6df89c9a90a49f526b494c49429f7fd327945943a85ce7d6adce50a207704015eaecfd4684f7e8c543f23263e895b19c1d0442e0df856776df4549415ffb69c8ee4cc6037bbe406adb7390f595e5321347821dbf1cb639ad2a0a93cc56df6ff49106f8a60f5488605c27eed07cf038d1ff1fa62e7dab6dba90ded9f6095db054f506b4c15320d8c9527bd291b86bd96c8418c2ed6ce1bd3b8ec23daef4c9181af84d32d7939624c184040ae54fc68f7e77b08bada679ae737a7d5ba47ae147a6d4c4d79544e56b8703e6cc80ad9f6eb6d4231ecdb9ee74b4616fa80cccce916383cd4211cea0fbbb8f50a71c93fb4833395c156fa9fa971757a9e3ff73dac826350306e2e088dbf05dd40f4f0eec8b50d7e4b9f3a7a98175a5c3a44e1d0d26b3d8aea423d1c83a78a7169a218b8ab83883c8e07ad1cb6a2133d64783c366a1fff1fd056f77ff4d62417650bd9dbda12e8661412e5d07afcc5c606bd4bed94a15a119acaa1e86be36fc76277e8f7b8e4473ad128496952f1df909ab7b74fbbed70a85cdfc5fb4e8ea09d77b61a2a209ce4a1ab6bae4a024d40d2e9699964e416c39c1d71e0f5a59253e8711960be3597b79b67dddeb96ec56c7629af8469160c63943794648bcb153c8f38603b360259380275ce244a7e50499f792613ff140f17238b1bc0ea044569aa12d0102c9646c4a46a8dcb981372771823b7ccd789be8eaa51e29f23681ad3e791897c62a480d48ad4c8bb4abdec0895fa5be3c4240bea13ec18696cb2ea5a863c89f59e29fbf3ed9ac343fa262d35bd1147d4e2aa439f89fba173b5676aca68918fec47eff979b9d254f86d95268fa69525cd1f285e7043c668980779e83fe0a06a51abb264935be281e70d0d14bed188164e9a8b93e2f23d21f30c522dcc72d4b6a0f68a23ea26c3a64855ce04179615aeb928e0e5d07f9783ff60032dca5289446748a60dff493ebcf4f52bbf10e3e2ea8b64bb93152a2fd61aa772abaae4da54ad0d949bbcaa0f38280826f567ca419ad32a910b7d90efaabb8e434e2474b4707c57f8721b36b0546eb9aba00f9a03b1667a0713381ca321b72dc5bd124a25e4bca59cf0b740d11a38e2577152bbc53cc760220984f2d71604c41e2ab1ab57014fbcd7b430c1d86add7be5713f0dd280086d83ab0566c7bf50b26672e18ae59bf6bdf9f80d72e08d0699c0a0dab5d0c5e3c7ce60394817c3035bc476699fb8e0708cd049a19f62e14e231f5028ce7261373ccc65ef8dccf5416f1782e81c176342cc8350e0abf338f147e597cbb9c082fea32eafb3dd47687352aae29e7961ab597e954030a3ab85ad1761b322c1ccbbf9e52a4e57670e1ceeb9301b90020516cd6e9365a8aed3694ffb162f480f5057801ca1720dc2ba43bbfe32945b7deea1cf09bfe04833ee5ecda4728ca9fe820524597c8acd2d30a60b7d5ba14cc1fb58bada5013b4ce258731d5e2642c65b234f0edb23744fc10f8850d031346c85bcb80a917b1b1585e7080de211f89b367576441a53998d7cef0bc0c27751aba1f0b72943127c99dbd2095e0717833c8e347286daa84e5dfc35e8e786d132ba8eb705b0d14481c65ae324ecd3ea3407d6b7f1067c7de1e578199e39e0fe0677e2018b9fc68640f4d7162583b0b4c284220ae114811e33786b5ecd1d0617a57deb89132ca917dfe9730766e34bad29a17ccea0b7501009378d7516a47d08645af11dc93735f430cfff688b4dbadda63296d2ff1894d98decb1702c484d07cc0d88ffedae4c7dcbe6e9e56518faaefeebe5d2b3cb497fac05657640a71384d3a4833d9944457c770b3805b66121c39119bb44ae731e6cf210904d2b9345c682d3c2e19a066dfefb7926bcc269e47afc21308244c488938b32005faae69abb25aacf56d9ce477fcc972afadb029dc8d5787a1d1167e97c60e0eed9dc9eda0b5ac8fbabf64e74d9d3849b7fc0983212bf2412f28d7914b71eedd4af98ba0d084394eb9113756ea5be35bbcd6d8cb614cf8bc7dd3a6352372807e73209fcd4820005649738be8e13e8392437a40d800314921ea807e2b0c6a573097ab9f67b53d37c27fd2e73001f47336d5005a97fa7a12a2daed7c3d3d789be1402fba9d5643494ad5c15c7c2a5382df08b936ae4fc202afb00f63644c1ef7c47e478b4096b444fe52655a28f4d5b24d20713a2e0bec12ceb82199fed714dfd31345bed6f6553c4c5a54b6493c6deb33686298f3bc9b7a3305f437b5117c359711d323db2be141079bb8d963c64de8942b891755951235d3775caead62d875efe647671b0d4f7ed0c370dfe7d479bb31c8241459a5eda9e8d4d53abc360a5482ccb8a60c24ce743e72fa596c62c922ffec9e6bf760769e93d408e64181d2e7d7fa9676c590c0a78030814aaf1102dd790dac50dd6e771434423e3f8d48254fd68ce37bfc6cb49e0e92d9d8a53ea907b3f10ea53e58b41e8bfb0faba46e4d30a75237906ef18cd62de1f1c1183e8b5b3a97eeb633a70ce30b31142b5e7a0ab5553b0ad1d0d8105c024d3e48d74a0d577e9498087c74d970564cbbfacf9dec5c685fbe230de97f5bfbf096d836e74d4cff9566e509237a318fd7515e9aec36d72cb823c8e8240cdd38184bcf564e6dfb3474aba6946827ec3226df669a7e059dd0365d923524dd4ec33a1917032d33d41d8549da1acc8b9dffbbcea7a4a5a21aa2f508f890affda745a5ac64e8d5cd507fa1b2a59da4b33cf6bf342c6b80a96eff8867e12fb180a03a0e499c2b087a20f716da2727c30739d89596e0b1a1205c2da628f2740908983cdb11cc9a84fa92ff28680855cd672194a90e9a9f8104aea2a1e1e5db19f323955b3a5ef6b66030142a08b4c9d0758044da869588a0aeae9fe9122c5fdc0f72acccc8c697fd1c41c2103f6fad07dfc3cc8a1c00ba4dc0a8ed8d15f0e16a96ea6cd028566e1868582d8e5914b54777f5132fd2402d75981148e3bef80698df5fd7a8f66740c9958d2855169e2c0fef7c8e52c8be6b68f35abe8a8c22525f5b207e4dfb226eb9fab23104e1c49c90c9d45e8ffb2bf98aa96fd237615174c1f2ae1fe3186afc6e78b618489da4e7eabebe88864ccad1dd3d5a40c6c2450ddd68c43c84f33b73343926d2d7998a559ac58c195c2bb84409f4102c6904732c01698766ead7be43b9fccea02d3375a5294ff1ad8757058ed0182fafdcde9eb2a0643e0c08f00b47e38ae1447fee0fcb3b2bf7ed8c9d4cf1292c8154ce726a7f330f68a69c1ba6d37d3f8b2c9f4d15805306640046f5a7f0e02a0a430e903601250f593535712699c3ae78b9a518092f649ba8bcad3019587b52f7e3b7e3931a09167f5c2f8ae74179ff8680e02534af71c2f4255e7ddf34ccd93c6e49ae6895b5636b9d3a894819b73c59d49cbd4ad7a6ac19688142fb5439ecae857f03eb62a8682ae4c38a6040701f1ff0827d747da703ebd41dc18fa04508775a84667e59130f6f9f5f0cc155339a8f25516478ae0e51a6ab167510771e0f94f31697b5aaad41c9d00b0f81011e8ea58219964fccee5014e8d78065d20da75b6a1200c9bd80287be7387c24dfd9b6e662132b2188b1466e960a0f5c515f588935548c69af3801ed256a628382a05a303efa7d6a9679912e642f98bffad15928572e24d40e00adb813d56a3c4cb59a7f5895d29b610b7572193450541dd2b68bb88c9f7612e20935121d850266dca1a377f820f5a360c1a2518b28b4c992c66983b11b4fa57cade8e5dbd4f72ed6da4a9f4b07182ba0da8c2c51ad36cce9dce3bcd7ad4bd0f335b9fcd00ee3a587c86dde76424728a94e67f61801a057cc37f4738efce3f1a65773f3d1639fa22d71257f981be8285dbb2f4a7ac308e8ba85d9ba0f29cadcf4bf37cf73a63a26e6dfa25f52b7c5d4f2766384046800082ea82ec0f63821b8d36b6f75faadc9dfb1338f470e8beca7c2461f9751e4b5ab75decee3b478a0b6d0aa3f57df573c5ef6ff1ec6b08c2810d17c9e60a82bce6cde9ce9f961f0037ccb47118f3f7475e46ff6fae68ba7f38e16ce1699730ced97039487bf01102942c22875277012ff1334d1d8d200a200f035b7bd3952be5ead4210652d8edcf4704f3a2b6058ec76b08eb3de1186323b2675b19185f3bce13eadbf0b876a8284f930f7d609eb4aac4d02bdfa8cf2c58d1be51b626024db45aa5d438133ded361b05183bee0e220fe38b0ad564d11a5e13c0c3c423cca8dc4222d8051f7dcc94f4af84c9220cb54b4fc0266ec0424434c7aff33860f46166ace5eeb9df0e48cc9dc75e6ceee3e5b47bbfac90548b961795283bb350a4253c777163111cfcfbfca37eba3e1e6f7e756950b8e52729853d6fd689be23478b433637e208a0000af03e7f767bb210baf7285365988a3e99dcc6971723d87f140d928c8a065b8ea223f1e0bd9694c6bc54b613674bc04f26a71599f437ee2844695a12393823a98bd4fe9d89f00c982c1e2493dcb5c401679e91d9c7bd8230c146bb4ab94a4332203b6a98739ea96872115ed3ee415b9b73b2462227ed6fd942960136d460e60db70b08add51144c69b31b1133409a15c8d6a0127d3f6614322726b020296d6559eda5e4e9b937f9994c1ee609272e8a1f4a98c9945af2460b7458e50fc036d2867f998e0baefe8769897fcae7f8702c976c372c2a3fb46a6b72f361f58c72ac548bd265158704569c5aa5ecae65668377afbe259bb33f40832caea2a8459471fdae0ae50fe2475ea70699cb8159b68e0be6b88f5bf4f8f2520aedc4602010650a820c4ef42f129ea960007a1e170dbc211435503ad37d834791a0f8bb2d8924ae0ee20acb1225bf6217f1b8fbc3140af838a6f168d7a379110af4d9b1f8942b59a3092c0281d4d11a49829848ae047b97cfefe9f735363213a5d5573b91b9064af8336641a807cbebc54f350dc60489b4b084fd733f03885a519d700f3156a5adcc0537947cd6fe708b62192dc391d32c95f38f0569164fda41dc93cd24d77a1b74c977ae3634a3ea2e69d0813476d27476baef182cff677fba3e58ce657728e7dbeedeed5d48fabe18997bb31effa725113e4d1d9e9874bb67ce432fdc394be900b73204a57f21df5fa42195c06f237452d716b0d5a3f7ef96679c4bbe80738e4e75771394e8da0a8f80d7054eb6a77b9bda9366c7bf944ca755b57299aefc03f21de3de146b2262431a4eff9d0d72c7a54e50bc432129b2739b067821e4489a90171372635d258491f5fdd296b94e657af7dabaad9166aabbfd75dd60a15f2ab41062f8129979d156a94bc31498a83990ea3c09fb169700cc04446d32370eabb35ceceefe12aef0a6433e288b1935e9786eb755bdeb23411d024238ac94b88bb435a75c7bca6ac70718deb4434d76dbd760ebcdef9e9cc163bc6bd01ac450bf82f46cf51eb9c85be2126ee234d3bd95e88e9c3b0839487d3e004fb36e4c3669f581c6e85334e7537a6da0ab6326516e86793593355f40b9cd0176ab946bda818e9661d536d69533e4daa2780c548374d643ec46aab565034aced0351dbc52be8af4f2b13332d62737c960913e06a7fc1faa394809f5dfdd63d43c41884e90780527a44900357609fafc1349b56b93baa7e559a22aeb0f8b50d4af7e4739c58eb1bff359295b1a8de8aa2f49374f6ade78453f87fb709c5c584437e28ea4452f5f4c6024ed5b3cecd9befc0b69f7e1e942780abc01819489db5a1612dcfc69435975aa54a2389e09dede71d471b85158532f3b219112a7e955d5f705771bbe6e44e942181f1e61e47b2d104f66903df6b6138ae5a9c84830c9d6b6c9b4403e510a0aa69de54a9337c6817631aac9db314c839269bddffc65bc9953dd7d0a471f5aa3541c564eed68a084943b56278bfbbf89c9a644153a558996d7913e8939a32adb2593fc5c8c88ce357b9c7cb145291bbd51d72065ab6717cd45b05f778a5aeb7ce16f7efcb13eebf98a8f097ca302d8f645b932b1b4361e9bf0b9bab90aa6bc7d39c7d487465041f35cd647c11004fba15724fcb37a59ed5cb56ee2fcfe300ada7c793b919196cf1496ca291d95068eb5c0caf8c87562520df2cecf0b5cc1f6495fad982868eaf37f2b65a4c2867004c30e20cd885ef7130f5a156a955087dec3aa28ca3b50cc30bf3aaaa983b6bb329f48bb45101801cb30182b1e0dc4220ab616f2dbed84ab125b4c6b6ceb8ab1f0dd87de1b86b582b31c9882b035380406ee93dd014b2a09e1d21de7e2985f3a35f365ca4c962d6f6972a3a306c188c69af2062b43eed31000982c1c7948fc0419c469523a81a65e5794bfd408b8bbb14a30b79ee416cf21f02bc3b8c92d7e6ab84e92a0272afb4d08e923601139ce8df0283af29d3d42146c1fbeea190a0dacdf757b63d156f8aa822799d74d3362d9a450ac9b0c26480fda171b2d51384214d916f1c648d8892d46394dbdf5cebb362ddac25192620df28fb416219b0fb1ce914c3d4379f7c2c5537acbd0ada5a210c54f32fc687fedbf7761fa4348078895e81d9198a36056db1f32f22379440d63c8bebbd0622ca4644e7537dad54069d2489c60b49170c22d1a21c95b285c3305cc10f7ddd98f187be1e7d1b5700dcf9623f4878a8c89716f17d3b0f666d118215fe294ed79d48ee723e110652276f91ac36830520c645f8d1c1d24125e5683f7eb888fd3ac062aa776560684ec5a70b0d7f2e6f403cffeb109e20f73639d370297ca5be5b6528c901d22c72aaee735df24b80cb3a834186203027bbbdcae476a06f9bbf5be56f08efc0a7aa0a435ce6c9dbc3453f35a677801bc5d6104bedfe2438432d27ce9c3907c063ce06116dd45e9e9640acfee10143643eac3d1a43b5d154560a13aa37b25e296ed1dcb14d523d90974a807214a3ead566b27621991f0e3bb9e6e76e6d6a048db35be414c43a40fe84e585597e07829c22eb822b97278d7cc19440423755eca0898f036c5824e225369aa5fb1234defd32de4bac0dd162f67417d976e5095e7972ec2d9931db24efa4340713cc288b82e3f007974843f491148e8ad2fc6af52d5e0504a5221d5f4993991bc01d4bfcf4838a50661b2894e4e7edbddbc0656f011bda6a15bad756e0327c7b42fcde867efd118d319a5edf3ed3eabd76c8ff75463281141c56e4f4d97750f85b03237a1e986e411db0995cfcf79058862304fe999b91a61da2c2d1a02de02673b2fef9111a2494af146b412a0ad6c1c070b5868504755fe6ab7e881c781f29b866c38403bfb8180adf97e5a4ef31185d231e1939cf32b307f54b8c593c2517391ebde08902ddb158f8c1b61d6c73929fa06c9b6a3b0778fcf28635c1e763400cd6034295129f3ad6e5b6dbdc06c7c90c5d96fdf57b290c5e4e0cb6a3b74176b09aa9c432316e849167f2990e07947030718b47e030f39e4025f53f7b423604f42a92450b9e3b3a1c455741b26577d46d93f225a3cbfc7adfdf7945beec9e50aab1f81661159bb3846aad347d3d793815f807bc52fe628965c0d5aa5d4fca923ca20c1e4d9445d755b96c85aafae3ea579544fabe432b0ebb1b06152069eeca888d06a758b1476a88626ee6c311a929f2e783b66668b60d2b2de18da39e88eace8cbee76e3b8fb5d282a207bff0ba81dfd5ef509b9db4311fd1c075647c6af66f3731bf24dbf380ec09a93b32ecf9fe9a113c5864af1fe1510618a20e3c599f12c2e26d505fbfb8ab514d9f417bf5656d68c544ca546632ec73dcd2722630c171c865cf7094826cb65c2f24382bebb1797eefb6d2179f9f2c1a3252bf0a953307b40bef9e86cf663d66ce5966943b3ab4b5c0fe34d285100f235ff11803d16bf31b9f44d9d1f7136bd8ac05cf22f5bcc553ae680f403cb0014b63a3e06f6f83123b52bbfeeb2080fb65d007de1920c9885bb74ab41d3dbc9cfdc02782a06e9afc2fc73fe81c6a002ab1987c0401844dc355818533a46ff10c3283bab81dd63da5b864c10b9bdd79c41c5fad995fa32582ff1fefaff06e8d02433e679c3527a727a80846dedf9f69e9bcb6b9de1cfee53873b7b01264c7b11d5a700b353ff430bb63ff6d6df5fc8faff2c61339c9384a6fd0e9c72e5e2e0f809c1f6e9d4740ec0e80e8bb1430a5b200a985549993b58dae33626e600573e5bec0e981d43a576761b1b7d4a46940fb58dd93e802c48d050fe9cf773503a71b195d75430357121661e7b0a4ec5880cca88f259fcbdde0ac368ba7ea2c9f1e7ff646a9a0f8357bdd4608d85d8bcc9c0da7595ee846c22c2effde2c57f1f9174b997c373c430ccfe3cac9dbc10e949fdf0174d3315d939e7e738878038a28fb0b9bd155a469ab8c59fd8b9e3b397fc9a1d69b8b07402831e7477a30df68a20f284eafc3bcd9805e0ac3502e5599efaeb225e43da27958180f4a02b5c416cc9d58d11ba13031bab38c3b6ef620ff6383d61d3e253e78d54e1cf175946e283bbe7b9105b87bca3089a9b06ef326d7da32c797d95c3650f21567f36eff775deb9f3991bc2adbb0eeca739c2c2ef83ce95ebf409262f70376ee7ed5ef4c0cf203c9d9bc2f5b4433865829a71d35bdcf465284abd2a1fcc5c1470c65afebf7e9902c541950d4ae22b51077fa25e6642c1eab4d3d506b5d99fca070952e0206846fa90d66980bb33f3e4033531279cb958cd34a2c2872a0660765d7ccf31e18eab9f4118bd60bb710c3919e9d29d8be627a1298bc77ea0fdf1a60bec3d4bd1ad63b1c8e6aa6b47eb39ff0d470f4b7e6f188711f6831220258f8c76ed801881dc7c2ef5f554a0732a98c6ab7039a088c53a8175216d0daca67afe649e316d5261d34d4e7390f5be3a6482b0210cedfb56f0d1646057854c2b70ede51097df523f8a81899bdd8b6d88ba7babe3ce756547fd55ef9ab317f5ac41a4e5e480cc7958ae9108d1a381f8bb750761332c44628b95f1be635508aaee3eeb323ae9fea8076b9dd4b865e02b33ba0611842cff65ef93844d7d5a124b5f6b77ef7cd50e79a2c94785c0e84140cc379f9f9a6f27ae9bd65e3b8607f0461b2dd932f614e3a2965389f4a795741647256b3cc151f0378743a03a18adce6dd2108b3d9ebda3d68933c8966749ff8c8fbe9772639f6a780189af064d329d48784bdf32ca743867c94c0d7365968f3d27789a6ad24f8fc1d23b21df2a61b970fe0f2dfd0122a044f20fb4af9b7f6c7ea8b1a3f69d87ac5c41a5ebaa6a6efe020c49ecb793f3b71cca05ebdef092bc59d7c226e82997c0aee3ff4937d09c2bf8691fd0f198a8d55cc4bde22aed6175f788084b4458dcb6cb35500874c21ec50183fb6675cadaa92defaac740355e0af1ba5171b84be1215032cfbead8a6b2eb58478daa469165ad7834bb7cb425e7c33f6a045e73f5caac7c12cc8a412a70e03248c87d60f4a8856d6d5678b727d9915b5ed62aafbef13bc9b9cf488fe7a64bf6c1573870bbfbc9d3fa997ffa501af93408a381b062843d25bc08e227a5d32a2df652e126cbc8fd978990d420c882f09b7de7fd51296b874a8884dba81ba73deedb639b7bba451a9e65d8f1ba7a9102d846932b0a829cda948e8499f373923dc14801616374a9b9eb181eef5afdfbf1971364d054fc7b0f0cee371549d56a965a3c80e4197cd7b596b5b5f1a2fc45488bc3266e6256db9e453151f33aca33b153b7a38c448f74a9d294f35d5474721aaf9a6c3c6c279f5f1b964935140e728ec969ae03dd3938f9ea42dbbb26e27da71aeea7a6a2be73204b975d0f68f0a5b2bb7850317c4f42d9e54db211ca086b99cb1685fdaaa66324f13c88ddd1a6b53b1da9d38c79b0bfadafaa395db4b1822cdabb2872ec211b90d883b3ca2c40b232f7000dbed08a77fcdfda3c6b52e97b3744df83e068b160812a7a900ea7e041216056f03cf8f67c1f782b0717906eb25581ecee6d7d060001922d73a019c1a782fb107666334a5efa754efc9c79b357168f0769f5c5bff95ede33fc8e2f613e75b2d659fa1f722b90175de65fbc2a35383d927390b737056906d755cadfde4c74ec3efd3d348c09badebad135812ab33614bb5d0d0320bb9ed13beb05baa799b31d08ff51cff6ed37263a9a3b8fc3e27cbe38d693edc4086416c65b58125a748362d0d4cac313ef60abe7267eceff247130b9c9761fbefe689bb354f39e8f189a1867fca78ffbe483d4eca58953ebeb412fe1187059a4202450fe670c7f03a20a83d138174ec2835351c93da54d2e5ec16373903f4f66dbadc92d0ae1b214befa3dea09e214402995142eea2b7caf7ee1f017f725e6a2372503dd5042e047b3048137a1a7453ee544fde7e22fd317ad20953ab0388874241ff2ad9181808b5a7803d3167d09326837848eac0b98d73afab4673f3569233f913fc4577647d8373439349de7f75d39d42913bb65209d9a85e10f138f53f13cd70b80e50ae3242e4acff80614e1fa5341eb63df9a3e0718ca712f0d865e51c28ff05e10eef9d6e7d63f5ccf3002cea75190a01ec017df1a7e6b5fd8be0111ada517fd1d44ccac1cec1953891e4cdb6aedf5fe795ce2f042a3fd32ca66834e4ff936ea90f13b7e4988f90658e7bc6a9c631e73ac9d44d1d00dc1ebcac948ea80d6a6ff499805582194947bdbcb599ac37f77f80cd3204ea516d1f3b0333e54f0bb49233cda43ec85763cd416a74a5237e512ea574452f45768d770eef05c3ca407946f043e8f9b8960cf91abc8843b5a29407ba40cea7f064620ceee038edb65b3cbe0fe4a609de01da6da4f905c9e4caa1195100d71039f390e821b72d291d608964204b9c83d9bcba2392b59977435d066d33049c241d234f09a08b82ab2f2327a372ceee3f426e540ed25fb40553bd2d58b1671ee798aee3f88f2ff7a8fd85fd73eba86979c2e9f1c0ff66add941565d4210f3099f9445e9595be777d83f28906db300b2886d93b5ad72793497ae42c36445ac10de249f45ecac5464de856902db7c3e98490e7ce309bfbcff1c3d38c061498b6cc5acd4d7227da14e84333cb43c97f3820d990ed53c6cb6bda3862496669dbe578a52351943e9fc5a1046ec8d9a31f2b794c075d581480186b5e285162e59fe0d6719c85113bb80427795cd9b5abed8ba24a3aaea632b6bc1c10b71e72ed6d8e7860d6a23dbeaf8b51ecf8895e2e446a71f0f7b44dd83b915c837a0fb60d6c8a350f9615f9d1dfa9c245a046f53595408ec9a7eb4b819a9907208d477519d33ee88e1e940dd3c312805184c2ef3f870ee1e0087fa8be6fa65a947af399291417792129dc3a5aef81a8688cd26a5562c3682c3064eb8249856349d33cec94153e4047f633336b9d173707374db7f014a9299a2867ea56c434e10d9bdf19aab15ff6be73dee18c43f5fca7f46c1bc070d89c04e4823767070d3946c15c375acb13ae1adf97be1e4a0b821d67b6db487676ff8995206ac9f3dd2d5c34d67ca7ff1389430f1db9af0fc3fdd29ce6fe836b8fdd7783a17fe6a751bc4cdf2713979a5e996c0d87fc8f5ed37742c390e74c942648eabeb51b35a8792081e1a9d9b33a2148cd16a92f9ea38c6ab025b07ac3fd15c5cd2d4998099ea118c6840887f7b4265fecbd7063be02283bdcaf40c62b0fb56c121223d27f0729b6aabc7d7709bd9176a9330f023cf2b519a1f09960e17407de2af458fe96a90a1bb8103092eeba364e20f54b96d346fc03e7bf82224bbb5dbdb26b91dc5518c51a0048f479f648528c1a3d4807d3f38ab82e7f455ec01e40197edb9f41265e36df855903d9de06700d2d015be63b54a939f9378d9657d2062ecf5837cdf958489a07d7ea0e675043ac74823d01e5c4fd78be976d0edd9192cb7c19e6f77d336840506e56fd1aac01a1c6c0cda294ef6d4630937901926ab365d235f6e4e86bc1a384995b1caeed9835b46e19a7ad3bccc3123c331582ce3e7f40882fec23cb8da3fd2664e85a55a940d7090ff4d8c2b7b76a0d669eb6312fcfd00c72c544f894d16d77032c0dc1e83f7dfa4d43951bfa80df9099e2b4e0a2024139dbf3d839102ab851b54271cd3f895b833116b78adc7b0ce9be294074fc873ccbca52ef407cc238856b4890b5fbf6bf110b52e1a6f26d42bbe3bf5958c60775da516cf0f90f46ca582afba0849994016d84d1308b5cc2c016d0d16d08094f255df5f391fb2fd560f6baf04ba8d2ba6ddca429c9e4ef45430bd562aa3ff53048d1d8b3542b3f832d59cb3cfb69a35f33a67075711373880bb0d5c3d5d254af66adcc5b87bfc31a1df53d091193728f5e06c7ff79f14e127a96d4aa21f78c27664e5d1a5b21a6497b32cf248e76fa15c68b89916a5b55df0b007e7fe9865a3dcb1ec94f71ca4685ee43adec8b2b6c13838f5b5660051a94ff48ab4be8d0b0b4b7798a3fdfbc5db96576a3a1e55a71657b050dc48cfea82f080147960c8d58137a78e91770d48cbbeaa23a100bf5e663ea6cd2ea744e4b3490c01bf0af869c44c5b23d0b26371b5c7d9db1da7f06350dd15efc8fb45bfdd24f6c2f7b93b1a24feff5704c4a26f9b57c82f8cb56882b8fd6d4ed8f0903f719cd571aaccb122c3f71c59286902d0937a3202ab87ccb291860de0acde3d78dd09d132f373e27dd58783667d85b9ae76f97e0a929cd558ffa84cd7b7feeda2625ef1bf8ac267e038cc0abf19f159f7a414ee7df8b8abe676b6dc2bb848cc4607f6b28561360d7191e98cdcd111517fee4e12fe007754211d9a7866b5c8f4d3aeb2d11fa27334315d35bff2e827d72f4ca854008683758dce188a6c1c14dee9f6c19f65b37938f5bb0565c2d9e50ed67a35ab293f2814dcacee2d453e9aa34c8c12c1b506ce65dd627dce2e8f707c9d8e9d7ea623605c576732f7c9096cd9a809fbfce3829b3731c8466d0645b650ddf8a4bdcb384f7af3f8845054d5285100a3c2ea0cfb914bc269fac9115a68faf356b51deb4c744ef841ba079f41d3b3a7077f3ca21838d6bbfa7d5743cb9b90b5efa35d592fd7fcf0c661395d776b6764a77576982f93c32c2cbcfee216beba68b550987ec1d63f4d3a6b57c780e5ede1d5a3e2d7e8638de9a76414ae8ec3dff207d9b927d2bd22706963da0194a11d37703b8fde05bfa87a1ecbff018e734baf3c725bf0e00bc4cf5ea0e4172063122b12a2c2778e31b3f95c084e19f514adf2bbe3611f6d6c40b5eba57fce63e3a09948c27066a1f6de693f2f9c48da190d81e9be6331e9fe528486aca2d3f5ad9f6ca4d04691197adf4abb6e0dcb01ea8f3824caab39a26afa236951516598dfbd53081371f7ef4578f889c803098164905892b3843d5e26fd89322cbdd7c1d599e1a5a48b083d3af233211725e1791e5a58e53febc1d02572e35488782ffd75af004358515c30300cc28239d60f21ff82f7b6a0e40f74da21beb45dac46e85f8ec4023b3dcbacc722aa3d84ac9e623b7be4959b122d9ff2e4baa7aa88d85d2462a859db95b3514f8e852cc68633db5257aa45fb616c4e697a67bd7ef1a2983e3111a7d3099b44c4727132873f62083b207a1ff412a51ee3a7302dd6e956b4cd0c211be7b517a9ba0cfdd5d76ac7aab894d22391aa09533158daaecd6c00916ccd721378176072bc9acdbd2658710ea61e683a2cb0d7a925d7343beb5a1f0764e50e004383efc83d48c68bfa50678e9c508ed6a030940e71fa13404984ed696296d12530a58b06c706a9f566bff0b19d0acdad2bb9708e289d4099491879100ba4127dac8c06c5e5703a80e8697cfe83650eb8db4b8a0fdeb121b233795856093862978ceffd56bfe80cb7b83c27d180a4651d7c667da9d3958d1a8997aeed461cf7e170f80c57a81c4569c60f94cd14de07bd63eab49fd76cc0e9e7740868a553339366cc5f59d7be8e97b55cc9a98593d0eede8a9a54b1247ec426b00292621e41e6c76b6f150f43ec5f6b9b91502c6cea613fea3cf62fe377653fc5a60cc72f060db4a6529b985f4e654264abfcc1173651786078cfeb3dec788de3eda10de6f9873d2fb0c0575590e31433a5f021f354f7fabbca9312b609ba813ec3b8c32bdf3ec27e3971f3639353c1e7f5f03d1e42bf2ac7e89a30cd1c66240b14e4e25d523a29b1d30fb00528b888dff7e3fb7734536183ba7fb05182ff7fffafc4d632bb290c5f36fe7c46825eef854517f2246fef03b853c5d2f1398353dd65af393aef2fe75443346aace606a4c212507f7b0bb71f3b14618f84695a4ca8bfb5767ff27d5d34c09bd513e6c5af6d5efb73dd31bd75f57f1588ae9df7394c8eb1304ac32c96576cdba136769d6c89d1358ffb7a60908a0f1592779cf56e8d5e965be280fccc19c7f824da6363b40a36902fbf6442729dce13b1a543b24c9b9b95e2bd3840845bef5544eb4b1c0e02d680b16f158f9f3e92398e3883344ea61c2f56707160fbd7940bb4c5d438747c1380404c3a872fcf51ec1ebcd2af3e7ea87862e05941302c8b8fed81cce7fec787e709408b2983d1dc76ebe689c6beb928705632e1efe6f690ff6c061181edde68933ee6df2221e546eccf0ce48b6a66426136836362950bd9c6ed6422ba8c87da88c3e5f116acc4c6f359a5628c3fc34149e770c1437aa5ade32ee7bcad90b2f67f2f40eef373099dbaf149d3a0c0db7da2e33571b3a627d021837308308e91a528d2f092b6c043243bcaea4db5632cfd118d24b7e034ee3a24812ab22059928479f5ec3a397d8d7d4ec45595d1fabec9a1373e3062017eee281a5c80bf0f65b9cbe4e71a31883a821a5aba2e5a3d41e39274c3b7fb5cd0c3624bcb67da22d0148852d8bd524fb26a896d20222c9f0d5a1db255d89c8c0c47f18a17a376727df86406d485e9f8174fe12a5049f27bdc4e565062a4cca4c31546c5e730a7fa107eb3b7fac70e98b4d4e013256c8c78908d8b39306cf102e1a7067d5a4d8a0a3f534ff0f58a126f92d90eb779ceaa247edd2de05b199f7cd8dc93d801f91218138ec077a0ee318148bd9c43cec76ae1d55b09d0cce7f4d256c928bf01332da55883fda2b05ee8cd9993fbd235832e09f05e39a8f8de47014bbe24c655fbb3372050b146239fbde46ac5f19f9766a6cefe645c16221ba7e8c238d50149c106ae45c2387c3884d2101c2ec8d73ae8eef9788c72a16dde5a6b86a32259d6c1d6bd474dfe5e32ef91121c2bce6d5293a38e96f433cb09ecaf9a2c8ca97541ee41b12da503768ea0b69f6f94ac0c9ea967487ba19bb952023c3594aeab180cb2f576a2699055f5c8cd2c487cea49c7b320facf0fb0b44cb11222bfaf7f5a26b9037a09d94e98e689ee30fc7b157a271f0f9d0a433680ca2a10436e8b313495b7f56050847ec47eb7d5c7575e003c243abd19d61d5a407a03a2ae6e959f82bc6a8aaa4d753ce216ba508a2792faae0e0c26db814ce6b770e2c256493c198b1405d93a221c20635254cbde0ddd54b0620e3532d5a6eaaa9d78f56531b560f18554ae9351c02fde3f549577a8a40d8b24115fd2c6f293fc13d306f1a274c5ae5bfcb0d648fac8d8116431dec08caf9b5f567bf90b53a64dce01d7bc941cca2168865148e3a339e6c1225a10124d8291f97587bbeaf5793499857755f2393e6ba79633c92e69bbe2c3bbf2bf542d7f57f6f04e9abbd3e2f6327590eeabec211e9c74d45bd8d8c40347883a2fcb39682c2dc8364257b5c1887434896cb0db6548987b043b545fac11c381de52935effd216489554cfa5d71e32ec4ddba2af45d7f7af455b715a625095e078b3a3bab376c31a5831a57ea5c22b1dc63993626c3abb21e336be94dfe336f8f4a61fec7d79937d76fc53b4fadb235db0e6b4df62df975f925c4e06613eb65af65ae9ebbb9e7cecbb135a078742e60032ee8ce8c22ce386aa4b0d4fa1b55ada08384c96bf60d300dbb20bf768cf1464bcb4d7b51fe313eab7981e1af655a5b2781420f054f70aa7338b07fd529d5e12f1f58747f7beae46931e226ffaada178b0dcdd0b6a4cbb24aaade3dc56fd6d410587cdc009645e76da3a092e5665d26ead5e20694655876793cc1eb9dca39d23d798d651bde8f206bd654e3a09ab74f6707d6d75228d760806f2ac7cc2b24ab426e598a559499d017701f06b6cbb819cb2909254cd9bcf0cf32d4697327715415741f7617bfa63c35f630ab821019888a5e4a2c38ce0d290e98520c7d3d3eb3f56c00f60b96d5a658b9315e3c1f0fb6e4ef9bbaa5971d38170dd377f7c2eafa22bd60ead017c6df4f430f232edd9332f4ac5cf0c7cf7841d6e858a98f9a53b481182040bf8540659d5f21bee233fd4ef2236ddae0eb1f462acc9024284d318d9c78557e4e4ed4d33ac918db65607961b79a2b6f58d543f43e8d0ccb972ed41db41352e7835f7d28075a6ad961924ad3f18cfcdd3d7783f26fa7a44fc19ae08bad66706eb8781f267d21cfddc8a9efcd37816869f3922e5c684f71b4dae21144bc486911ad7f48a8161996c7f7f2b8eb459bf8a5e5246af0b41e191ab2477cde80cb3786ae5a8fbb5714bf300aaa2eb75a75e06675733c1c843d68474b88cd932ac316de2dfd3f897fdacf9b8c8c353d9d615e5fd1496c7cb884477e5cef75cef12ed77609000e1b5200579e699822b37e4f1e067f44615d3f744f6120a8404b7ea154da19cb33a93210704e58f31b600505daf7b00475fdf875b37f76a2cf7fc606ea4440304e8f06a9b630e2d5641b6a839adf70330f28a66270654b950a008e4da1961f2ee5061bea72a60f03d951138c627991a28ea79615cd263dca300fc2f1cb11f15373f3065166559611528062218e83c2b42ec3992cb278b3d6a9ce6332a500f4c8e7291d87be4debde4abc5233924d0681d21820387585308aee2b9bed6dbe5233dfaa383a9bc74e7ea574f633e63e8f</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-xray">      <input class="hbe hbe-input-field hbe-input-field-xray" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-xray" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-xray">æ‚¨å¥½, è¿™é‡Œéœ€è¦å¯†ç .</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-xray" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>        <path d="M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> åŠ å¯†æ–‡ç«  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysql GROUP BY è¯¦è§£</title>
      <link href="/posts/5532bb23.html"/>
      <url>/posts/5532bb23.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="GROUP-BY-æ˜¯å¦èƒ½èµ°ç´¢å¼•åŠåŸç†"><a href="#GROUP-BY-æ˜¯å¦èƒ½èµ°ç´¢å¼•åŠåŸç†" class="headerlink" title="GROUP BY æ˜¯å¦èƒ½èµ°ç´¢å¼•åŠåŸç†"></a>GROUP BY æ˜¯å¦èƒ½èµ°ç´¢å¼•åŠåŸç†</h1><p><a href="https://www.qycn.com/xzx/article/7041.html">å‚è€ƒé“¾æ¥</a></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> city ,count(*) <span class="keyword">as</span> num <span class="keyword">from</span> <span class="keyword">table</span> <span class="keyword">group</span> <span class="keyword">by</span> city;</span><br></pre></td></tr></table></figure><ol><li>æ‰§è¡Œè¿‡ç¨‹<ol><li>åˆ›å»ºå†…å­˜ä¸´æ—¶è¡¨ï¼Œè¡¨é‡Œæœ‰ä¸¤ä¸ªå­—æ®µcityå’Œnumï¼›</li><li>å…¨è¡¨æ‰«æ table çš„è®°å½•ï¼Œä¾æ¬¡å–å‡ºcity &#x3D; â€˜Xâ€™çš„è®°å½•ã€‚</li><li>åˆ¤æ–­ä¸´æ—¶è¡¨ä¸­æ˜¯å¦æœ‰ä¸º city&#x3D;â€™Xâ€™çš„è¡Œï¼Œæ²¡æœ‰å°±æ’å…¥ä¸€ä¸ªè®°å½• (X,1);</li><li>å¦‚æœä¸´æ—¶è¡¨ä¸­æœ‰city&#x3D;â€™Xâ€™çš„è¡Œçš„è¡Œï¼Œå°±å°†x è¿™ä¸€è¡Œçš„numå€¼åŠ  1ï¼›</li><li>éå†å®Œæˆåï¼Œå†æ ¹æ®å­—æ®µcityåšæ’åºï¼Œå¾—åˆ°ç»“æœé›†è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</li></ol></li></ol><h2 id="mysql-å¯¹-GROUP-BY-çš„ä¼˜åŒ–"><a href="#mysql-å¯¹-GROUP-BY-çš„ä¼˜åŒ–" class="headerlink" title="mysql å¯¹ GROUP BY çš„ä¼˜åŒ–"></a>mysql å¯¹ GROUP BY çš„ä¼˜åŒ–</h2><p>æ‰€æœ‰çš„group byä¸­çš„åˆ—ï¼Œå¿…é¡»åœ¨åŒä¸€ä¸ªç´¢å¼•é‡Œé¢<br>MySQLä¼šä½¿ç”¨ä¸¤ç§æ–¹å¼æ¥åšgroup byçš„ä¼˜åŒ–ï¼š</p><ol><li>æ¾ç´¢å¼•æ‰«æ(Loose Index Scan)</li><li>ç´§ç´¢å¼•æ‰«æ(Tight Index Scan)</li></ol><h3 id="æ¾ç´¢å¼•æ‰«æ"><a href="#æ¾ç´¢å¼•æ‰«æ" class="headerlink" title="æ¾ç´¢å¼•æ‰«æ"></a>æ¾ç´¢å¼•æ‰«æ</h3><ol><li><p>å½“ç´¢å¼•æœ¬èº«å°±èƒ½å¤Ÿè¦†ç›–åˆ°æ‰€æœ‰groupçš„åˆ—çš„æ—¶å€™ï¼ŒMySQLå°±ä¼šä½¿ç”¨æ¾ç´¢å¼•æ‰«æã€‚ä¸ºä»€ä¹ˆå«æ¾ç´¢å¼•æ‰«æå‘¢ï¼Ÿå› ä¸ºè¿™ç§æ‰«ææ–¹å¼åªè€ƒè™‘ç´¢å¼•ä¸­çš„éƒ¨åˆ†keyï¼Œè€Œä¸æ˜¯å…¨éƒ¨keyã€‚</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœä½¿ç”¨äº†æ¾ç´¢å¼•æ‰«æï¼Œä½ çš„æŸ¥è¯¢è¯­å¥<span class="keyword">explain</span>ä¼šåœ¨Extraä¸­æ˜¾ç¤ºï¼š<span class="keyword">Using</span> <span class="keyword">index</span> <span class="keyword">for</span> <span class="keyword">group</span>-<span class="keyword">by</span> (scanning)</span><br></pre></td></tr></table></figure></li><li><p>æ¾æ•£æ‰«ææœ‰ä»¥ä¸‹é™åˆ¶ï¼š</p><ol><li>æŸ¥è¯¢å¿…é¡»æ˜¯å•è¡¨ï¼Œè·¨è¡¨ä¸è¡Œ</li><li>group byçš„åˆ—å¿…é¡»ç¬¦åˆç´¢å¼•çš„æœ€å·¦åŒ¹é…åŸåˆ™</li><li>selectä¸­ï¼Œåªæœ‰MINå’ŒMAXèšåˆå‡½æ•°èƒ½ç”¨ï¼Œé‡Œé¢çš„åˆ—å¿…é¡»åœ¨ç´¢å¼•ä¸­ï¼Œå¹¶ä¸”å¿…é¡»ç´§é‚»åœ¨group byåˆ—çš„åé¢</li><li>é™¤äº†MINå’ŒMAXå‡½æ•°çš„å‚æ•°å¤–ï¼ŒæŸ¥è¯¢ä¸­çš„åˆ—å¦‚æœä¸åœ¨group byä¸­ï¼Œé‚£whereæ¡ä»¶ä¸­è¿™ä¸€åˆ—åªèƒ½æ˜¯â€œç­‰äºä¸€ä¸ªå¸¸é‡â€ï¼Œè€Œå¦‚æœåœ¨group byçš„åˆ—ä¸­ï¼Œå¯ä»¥ä½¿ç”¨å¤§äºå’Œå°äºç­‰æ¡ä»¶ã€‚</li><li>å­—ç¬¦ä¸²çš„å‰ç¼€ç´¢å¼•ä¸é€‚ç”¨ï¼Œæ¯”å¦‚c1 varchar(20)ï¼Œç´¢å¼•c1(10)å°±ä¸è¡Œã€‚</li><li>SELECT çš„å­—æ®µå¿…é¡»å‡ºç°åœ¨ GROUP BY ä¸­</li></ol></li></ol><h3 id="ç´§ç´¢å¼•æ‰«æ"><a href="#ç´§ç´¢å¼•æ‰«æ" class="headerlink" title="ç´§ç´¢å¼•æ‰«æ"></a>ç´§ç´¢å¼•æ‰«æ</h3><ol><li>ç´§ç´¢å¼•æ‰«æä¼šæ ¹æ®æŸ¥è¯¢æ¡ä»¶æ¥å†³å®šæ˜¯å…¨ç´¢å¼•æ‰«æè¿˜æ˜¯èŒƒå›´ç´¢å¼•æ‰«æã€‚å½“æ¡ä»¶ä¸æ»¡è¶³æ¾æ•£ç´¢å¼•æ‰«ææ—¶ï¼Œå°¤å…¶æ˜¯ä¸æ»¡è¶³ç´¢å¼•çš„æœ€å·¦åŒ¹é…åŸåˆ™æ—¶ï¼Œå¦‚æœæŸ¥è¯¢æ¡ä»¶é‡Œé¢ï¼Œæœ‰ä¸€äº›æ¡ä»¶èƒ½å¤Ÿâ€œå¡«å……â€ç´¢å¼•ä¸­çš„â€ç¼éš™â€ï¼ŒMySQLä¹Ÿèƒ½å¤Ÿåˆ©ç”¨ç´¢å¼•æ’å¥½åºçš„èƒ½åŠ›ï¼Œç›´æ¥å®Œæˆgroupã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> mysql </category>
          
          <category> ç´¢å¼• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
            <tag> ç´¢å¼• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysql ORDER BY è¯¦è§£</title>
      <link href="/posts/9762c2f9.html"/>
      <url>/posts/9762c2f9.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ORDER-BY-èƒ½å¦èµ°ç´¢å¼•åŠåŸç†"><a href="#ORDER-BY-èƒ½å¦èµ°ç´¢å¼•åŠåŸç†" class="headerlink" title="ORDER BY èƒ½å¦èµ°ç´¢å¼•åŠåŸç†"></a>ORDER BY èƒ½å¦èµ°ç´¢å¼•åŠåŸç†</h1><p><a href="https://www.teqng.com/2021/09/10/%E7%9C%8B%E4%B8%80%E9%81%8D%E5%B0%B1%E7%90%86%E8%A7%A3%EF%BC%9Aorder-by%E8%AF%A6%E8%A7%A3">å‚è€ƒé“¾æ¥</a></p><h1 id="æ˜¯å¦èµ°ç´¢å¼•"><a href="#æ˜¯å¦èµ°ç´¢å¼•" class="headerlink" title="æ˜¯å¦èµ°ç´¢å¼•"></a>æ˜¯å¦èµ°ç´¢å¼•</h1><ol><li>å¦‚æœå…¶ä¸­ä»»ä½•ä¸€ä¸ªå­—æ®µæ²¡æœ‰å»ºç«‹ç´¢å¼•ï¼Œé‚£ä¹ˆorder byå°±ä¸ä¼šèµ°ç´¢å¼•ï¼Œè€Œæ˜¯åˆ©ç”¨filesortè¿›è¡Œè¾…åŠ©æ’åº</li><li>è¦æƒ³ä½¿å¤šä¸ªå­—æ®µèƒ½å¤Ÿæ»¡è¶³ç´¢å¼•æŸ¥è¯¢çš„è¯ï¼Œéœ€è¦ç»™è¿™äº›ä¸ªå­—æ®µå»ºç«‹è”åˆç´¢å¼•ï¼Œå¹¶ä¸”å‡ºç°åœ¨order byåé¢çš„é¡ºåºéœ€è¦æ»¡è¶³æœ€å·¦å‰ç¼€åŒ¹é…åŸåˆ™ï¼Œå¦åˆ™çš„è¯ä¼šå‡ºç°filesortçš„æƒ…å†µè€Œä¸ä¼šèµ°ç´¢å¼•ã€‚</li></ol><h1 id="å·¥ä½œåŸç†"><a href="#å·¥ä½œåŸç†" class="headerlink" title="å·¥ä½œåŸç†"></a>å·¥ä½œåŸç†</h1><h2 id="å…¨å­—æ®µæ’åº"><a href="#å…¨å­—æ®µæ’åº" class="headerlink" title="å…¨å­—æ®µæ’åº"></a>å…¨å­—æ®µæ’åº</h2><p>å°†æŸ¥è¯¢æ‰€éœ€çš„å­—æ®µå…¨éƒ¨è¯»å–åˆ°sort_bufferä¸­ï¼Œå°±æ˜¯å…¨å­—æ®µæ’åºã€‚  </p><p>MySQL ä¼šç»™æ¯ä¸ªæŸ¥è¯¢çº¿ç¨‹åˆ†é…ä¸€å—å°å†…å­˜ï¼Œç”¨äºæ’åºçš„ï¼Œç§°ä¸º sort_bufferã€‚ä»€ä¹ˆæ—¶å€™æŠŠå­—æ®µæ”¾è¿›å»æ’åºå‘¢ï¼Œå…¶å®æ˜¯é€šè¿‡idx_cityç´¢å¼•æ‰¾åˆ°å¯¹åº”çš„æ•°æ®ï¼Œæ‰æŠŠæ•°æ®æ”¾è¿›å»å•¦ã€‚</p><p>æ‰§è¡Œæµç¨‹:</p><ol><li>MySQL ä¸ºå¯¹åº”çš„çº¿ç¨‹åˆå§‹åŒ–sort_bufferï¼Œæ”¾å…¥éœ€è¦æŸ¥è¯¢çš„nameã€ageã€cityå­—æ®µ</li><li>ä»ç´¢å¼•æ ‘idx_cityï¼Œ æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³ city&#x3D;â€™æ·±åœ³â€™æ¡ä»¶çš„ä¸»é”® idï¼Œä¹Ÿå°±æ˜¯å›¾ä¸­çš„id&#x3D;9ï¼›</li><li>åˆ°ä¸»é”® id ç´¢å¼•æ ‘æ‹¿åˆ°id&#x3D;9çš„è¿™ä¸€è¡Œæ•°æ®ï¼Œ å–nameã€ageã€cityä¸‰ä¸ªå­—æ®µçš„å€¼ï¼Œå­˜åˆ°sort_bufferï¼›</li><li>ä»ç´¢å¼•æ ‘idx_city æ‹¿åˆ°ä¸‹ä¸€ä¸ªè®°å½•çš„ä¸»é”® idï¼Œå³å›¾ä¸­çš„id&#x3D;13ï¼›</li><li>é‡å¤æ­¥éª¤ 3ã€4 ç›´åˆ°cityçš„å€¼ä¸ç­‰äºæ·±åœ³ä¸ºæ­¢ï¼›</li><li>å‰é¢5æ­¥å·²ç»æŸ¥æ‰¾åˆ°äº†æ‰€æœ‰cityä¸ºæ·±åœ³çš„æ•°æ®ï¼Œåœ¨ sort_bufferä¸­ï¼Œå°†æ‰€æœ‰æ•°æ®æ ¹æ®ageè¿›è¡Œæ’åºï¼›</li><li>æŒ‰ç…§æ’åºç»“æœå–å‰10è¡Œè¿”å›ç»™å®¢æˆ·ç«¯ã€‚<br><img src="/images/%E5%90%8E%E7%AB%AF/mysql/%E5%85%A8%E5%AD%97%E6%AE%B5%E6%8E%92%E5%BA%8F.png" alt="æ‰§è¡Œç¤ºæ„å›¾"></li></ol><h2 id="ç£ç›˜ä¸´æ—¶æ–‡ä»¶è¾…åŠ©æ’åº"><a href="#ç£ç›˜ä¸´æ—¶æ–‡ä»¶è¾…åŠ©æ’åº" class="headerlink" title="ç£ç›˜ä¸´æ—¶æ–‡ä»¶è¾…åŠ©æ’åº"></a>ç£ç›˜ä¸´æ—¶æ–‡ä»¶è¾…åŠ©æ’åº</h2><p>å®é™…ä¸Šï¼Œsort_bufferçš„å¤§å°æ˜¯ç”±ä¸€ä¸ªå‚æ•°æ§åˆ¶çš„ï¼šsort_buffer_sizeã€‚å¦‚æœè¦æ’åºçš„æ•°æ®å°äºsort_buffer_sizeï¼Œæ’åºåœ¨sort_buffer å†…å­˜ä¸­å®Œæˆï¼Œå¦‚æœè¦æ’åºçš„æ•°æ®å¤§äºsort_buffer_sizeï¼Œåˆ™å€ŸåŠ©ç£ç›˜æ–‡ä»¶æ¥è¿›è¡Œæ’åº</p><p>æ‰§è¡Œæµç¨‹:</p><ol><li>ä»ä¸»é”®Idç´¢å¼•æ ‘ï¼Œæ‹¿åˆ°éœ€è¦çš„æ•°æ®ï¼Œå¹¶æ”¾åˆ°sort_bufferå†…å­˜å—ä¸­ã€‚å½“sort_bufferå¿«è¦æ»¡æ—¶ï¼Œå°±å¯¹sort_bufferä¸­çš„æ•°æ®æ’åºï¼Œæ’å®Œåï¼ŒæŠŠæ•°æ®ä¸´æ—¶æ”¾åˆ°ç£ç›˜ä¸€ä¸ªå°æ–‡ä»¶ä¸­ã€‚</li><li>ç»§ç»­å›åˆ°ä¸»é”® id ç´¢å¼•æ ‘å–æ•°æ®ï¼Œç»§ç»­æ”¾åˆ°sort_bufferå†…å­˜ä¸­ï¼Œæ’åºåï¼Œä¹ŸæŠŠè¿™äº›æ•°æ®å†™å…¥åˆ°ç£ç›˜ä¸´æ—¶å°æ–‡ä»¶ä¸­ã€‚</li><li>ç»§ç»­å¾ªç¯ï¼Œç›´åˆ°å–å‡ºæ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„æ•°æ®ã€‚æœ€åæŠŠç£ç›˜çš„ä¸´æ—¶æ’å¥½åºçš„å°æ–‡ä»¶ï¼Œåˆå¹¶æˆä¸€ä¸ªæœ‰åºçš„å¤§æ–‡ä»¶ã€‚</li></ol><h2 id="rowid-æ’åº"><a href="#rowid-æ’åº" class="headerlink" title="rowid æ’åº"></a>rowid æ’åº</h2><p>rowid æ’åºå°±æ˜¯ï¼ŒåªæŠŠæŸ¥è¯¢SQLéœ€è¦ç”¨äºæ’åºçš„å­—æ®µå’Œä¸»é”®idï¼Œæ”¾åˆ°sort_bufferä¸­ã€‚é‚£æ€ä¹ˆç¡®å®šèµ°çš„æ˜¯å…¨å­—æ®µæ’åºè¿˜æ˜¯rowid æ’åºæ’åºå‘¢ï¼Ÿ  </p><p>å®é™…ä¸Šæœ‰ä¸ªå‚æ•°æ§åˆ¶çš„ã€‚è¿™ä¸ªå‚æ•°å°±æ˜¯max_length_for_sort_dataï¼Œå®ƒè¡¨ç¤ºMySQLç”¨äºæ’åºè¡Œæ•°æ®çš„é•¿åº¦çš„ä¸€ä¸ªå‚æ•°ï¼Œå¦‚æœå•è¡Œçš„é•¿åº¦è¶…è¿‡è¿™ä¸ªå€¼ï¼ŒMySQL å°±è®¤ä¸ºå•è¡Œå¤ªå¤§ï¼Œå°±æ¢rowid æ’åºã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å‘½ä»¤çœ‹ä¸‹è¿™ä¸ªå‚æ•°å–å€¼ã€‚  </p><p>max_length_for_sort_data é»˜è®¤å€¼æ˜¯1024ã€‚å› ä¸ºæœ¬æ–‡ç¤ºä¾‹ä¸­name,age,cityé•¿åº¦&#x3D;64+4+64 &#x3D;132 &lt; 1024, æ‰€ä»¥èµ°çš„æ˜¯å…¨å­—æ®µæ’åºã€‚æˆ‘ä»¬æ¥æ”¹ä¸‹è¿™ä¸ªå‚æ•°ï¼Œæ”¹å°ä¸€ç‚¹ã€‚</p><p>æ‰§è¡Œæµç¨‹:</p><ol><li>MySQL ä¸ºå¯¹åº”çš„çº¿ç¨‹åˆå§‹åŒ–sort_bufferï¼Œæ”¾å…¥éœ€è¦æ’åºçš„ageå­—æ®µï¼Œä»¥åŠä¸»é”®idï¼›</li><li>ä»ç´¢å¼•æ ‘idx_cityï¼Œ æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³ city&#x3D;â€™æ·±åœ³â€™æ¡ä»¶çš„ä¸»é”® idï¼Œä¹Ÿå°±æ˜¯å›¾ä¸­çš„id&#x3D;9ï¼›</li><li>åˆ°ä¸»é”® id ç´¢å¼•æ ‘æ‹¿åˆ°id&#x3D;9çš„è¿™ä¸€è¡Œæ•°æ®ï¼Œ å–ageå’Œä¸»é”®idçš„å€¼ï¼Œå­˜åˆ°sort_bufferï¼›</li><li>ä»ç´¢å¼•æ ‘idx_city æ‹¿åˆ°ä¸‹ä¸€ä¸ªè®°å½•çš„ä¸»é”® idï¼Œå³å›¾ä¸­çš„id&#x3D;13ï¼›</li><li>é‡å¤æ­¥éª¤ 3ã€4 ç›´åˆ°cityçš„å€¼ä¸ç­‰äºæ·±åœ³ä¸ºæ­¢ï¼›</li><li>å‰é¢5æ­¥å·²ç»æŸ¥æ‰¾åˆ°äº†æ‰€æœ‰cityä¸ºæ·±åœ³çš„æ•°æ®ï¼Œåœ¨ sort_bufferä¸­ï¼Œå°†æ‰€æœ‰æ•°æ®æ ¹æ®ageè¿›è¡Œæ’åºï¼›</li><li>éå†æ’åºç»“æœï¼Œå–å‰10è¡Œï¼Œå¹¶æŒ‰ç…§ id çš„å€¼å›åˆ°åŸè¡¨ä¸­ï¼Œå–å‡ºcityã€name å’Œ age ä¸‰ä¸ªå­—æ®µè¿”å›ç»™å®¢æˆ·ç«¯ã€‚</li></ol><p><img src="/images/%E5%90%8E%E7%AB%AF/mysql/ROWID%E6%8E%92%E5%BA%8F.png" alt="æ‰§è¡Œç¤ºæ„å›¾"></p><h2 id="å…¨å­—æ®µæ’åºä¸rowidæ’åºå¯¹æ¯”"><a href="#å…¨å­—æ®µæ’åºä¸rowidæ’åºå¯¹æ¯”" class="headerlink" title="å…¨å­—æ®µæ’åºä¸rowidæ’åºå¯¹æ¯”"></a>å…¨å­—æ®µæ’åºä¸rowidæ’åºå¯¹æ¯”</h2><ol><li>å…¨å­—æ®µæ’åºï¼šsort_bufferå†…å­˜ä¸å¤Ÿçš„è¯ï¼Œå°±éœ€è¦ç”¨åˆ°ç£ç›˜ä¸´æ—¶æ–‡ä»¶ï¼Œé€ æˆç£ç›˜è®¿é—®ã€‚</li><li>rowidæ’åºï¼šsort_bufferå¯ä»¥æ”¾æ›´å¤šæ•°æ®ï¼Œä½†æ˜¯éœ€è¦å†å›åˆ°åŸè¡¨å»å–æ•°æ®ï¼Œæ¯”å…¨å­—æ®µæ’åºå¤šä¸€æ¬¡å›è¡¨ã€‚</li></ol><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¯¹äºInnoDBå­˜å‚¨å¼•æ“ï¼Œä¼šä¼˜å…ˆä½¿ç”¨å…¨å­—æ®µæ’åºã€‚å¯ä»¥å‘ç° max_length_for_sort_data å‚æ•°è®¾ç½®ä¸º1024ï¼Œè¿™ä¸ªæ•°æ¯”è¾ƒå¤§çš„ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ’åºå­—æ®µä¸ä¼šè¶…è¿‡è¿™ä¸ªå€¼ï¼Œä¹Ÿå°±æ˜¯éƒ½ä¼šèµ°å…¨å­—æ®µæ’åºã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> mysql </category>
          
          <category> ç´¢å¼• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
            <tag> ç´¢å¼• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç´¢å¼•åŸç†</title>
      <link href="/posts/3d64ba28.html"/>
      <url>/posts/3d64ba28.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>ç´¢å¼•å°±æ˜¯å¸®åŠ©æ•°æ®åº“é«˜æ•ˆæŸ¥æ‰¾æ•°æ®çš„å­˜å‚¨ç»“æ„ï¼Œå­˜å‚¨å†ç£ç›˜ä¸­ï¼Œéœ€è¦æ¶ˆè€—ç£ç›˜IO</p><h1 id="1-å­˜å‚¨å¼•æ“"><a href="#1-å­˜å‚¨å¼•æ“" class="headerlink" title="1. å­˜å‚¨å¼•æ“"></a>1. å­˜å‚¨å¼•æ“</h1><ol><li>myisam æ”¯æŒè¡¨é”ï¼Œç´¢å¼•å’Œæ•°æ®åˆ†å¼€å­˜å‚¨é€‚åˆè·¨æœåŠ¡å™¨è¿ç§»</li><li>innodb æ”¯æŒè¡Œé”ï¼Œç´¢å¼•å’Œæ•°æ®å­˜å‚¨å†ä¸€ä¸ªæ–‡ä»¶</li></ol><h1 id="2-ç´¢å¼•ç±»å‹"><a href="#2-ç´¢å¼•ç±»å‹" class="headerlink" title="2. ç´¢å¼•ç±»å‹"></a>2. ç´¢å¼•ç±»å‹</h1><h2 id="1-hashç´¢å¼•"><a href="#1-hashç´¢å¼•" class="headerlink" title="1. hashç´¢å¼•"></a>1. hashç´¢å¼•</h2><ol><li>é€‚åˆç²¾ç¡®æŸ¥è¯¢ä¸”æ•ˆç‡é«˜</li><li>æ— æ³•æ’åºã€ä¸é€‚åˆèŒƒå›´æŸ¥è¯¢</li><li>hashå†²çªçš„æƒ…å†µä¸‹éœ€è¦éå†é“¾è¡¨ï¼ˆphpæ•°ç»„çš„å®ç°åŸç†ã€redis zset çš„å®ç°åŸç†ç±»ä¼¼ï¼‰</li></ol><h2 id="2-b-tree-å’Œ-b-tree-çš„åŒºåˆ«"><a href="#2-b-tree-å’Œ-b-tree-çš„åŒºåˆ«" class="headerlink" title="2. b-tree å’Œ b+tree çš„åŒºåˆ«"></a>2. b-tree å’Œ b+tree çš„åŒºåˆ«</h2><ol><li>b+tree çš„æ•°æ®å…¨éƒ¨å­˜å‚¨åœ¨å¶å­èŠ‚ç‚¹ï¼Œå†…éƒ¨èŠ‚ç‚¹åªå­˜key,ä¸€æ¬¡ç£ç›˜IOèƒ½è·å–åˆ°æ›´å¤šçš„èŠ‚ç‚¹</li><li>b-tree çš„å†…éƒ¨èŠ‚ç‚¹å’Œå¶å­èŠ‚ç‚¹éƒ½å­˜å‚¨keyå’Œæ•°æ®ï¼ŒæŸ¥æ‰¾æ•°æ®ä¸éœ€è¦æ‰¾åˆ°å¶å­èŠ‚ç‚¹ï¼Œå†…éƒ¨èŠ‚ç‚¹å¯ä»¥ç›´æ¥è¿”å›æ•°æ®</li><li>b+tree å¢åŠ äº†å¶å­èŠ‚ç‚¹åˆ°ç›¸é‚»èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œæ–¹ä¾¿è¿”å›æŸ¥è¯¢éå†</li></ol><h1 id="1-èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•"><a href="#1-èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•" class="headerlink" title="1. èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•"></a>1. èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•</h1><h2 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1. æ¦‚å¿µ"></a>1. æ¦‚å¿µ</h2><ol><li>èšç°‡ç´¢å¼•  :ç´¢å¼•å’Œæ•°æ®å­˜å‚¨åœ¨ä¸€ä¸ªèŠ‚ç‚¹</li><li>éèšç°‡ç´¢å¼•:ç´¢å¼•å’Œæ•°æ®åˆ†å¼€å­˜å‚¨ï¼Œé€šè¿‡ç´¢å¼•æ‰¾åˆ°æ•°æ®å®é™…å­˜å‚¨çš„åœ°å€</li></ol><h2 id="2-è¯¦è§£"><a href="#2-è¯¦è§£" class="headerlink" title="2. è¯¦è§£:"></a>2. è¯¦è§£:</h2><ol><li>innodb ä½¿ç”¨çš„èšç°‡ç´¢å¼•,ä¸”é»˜è®¤ä¸»é”®ç´¢å¼•ä¸ºèšç°‡ç´¢å¼•ï¼ˆæ²¡æœ‰ä¸»é”®ç´¢å¼•çš„æ—¶å€™ï¼Œé€‰æ‹©ä¸€ä¸ªéç©ºç´¢å¼•ï¼Œè¿˜æ²¡æœ‰åˆ™éšå¼çš„ä¸»é”®ç´¢å¼•ï¼‰ï¼Œè¾…åŠ©ç´¢å¼•æŒ‡å‘èšç°‡ç´¢å¼•ä½ç½®ï¼Œç„¶ååœ¨æ‰¾åˆ°å®é™…å­˜å‚¨åœ°å€</li><li>myisam ä½¿ç”¨éèšç°‡ç´¢å¼•ï¼Œæ‰€æœ‰çš„ç´¢å¼•éƒ½åªéœ€è¦æŸ¥è¯¢ä¸€æ¬¡å°±èƒ½æ‰¾åˆ°æ•°æ®</li></ol><h2 id="3-èšç°‡ç´¢å¼•çš„ä¼˜åŠ¿å’Œç•¥åŠ¿"><a href="#3-èšç°‡ç´¢å¼•çš„ä¼˜åŠ¿å’Œç•¥åŠ¿" class="headerlink" title="3. èšç°‡ç´¢å¼•çš„ä¼˜åŠ¿å’Œç•¥åŠ¿"></a>3. èšç°‡ç´¢å¼•çš„ä¼˜åŠ¿å’Œç•¥åŠ¿</h2><ol><li>ç´¢å¼•å’Œæ•°æ®åœ¨ä¸€èµ·ï¼ŒåŒä¸€é¡µçš„æ•°æ®ä¼šè¢«ç¼“å­˜åˆ°ï¼ˆbufferï¼‰å†…å­˜ä¸­ï¼Œæ‰€ä»¥æŸ¥çœ‹åŒä¸€é¡µæ•°æ®çš„æ—¶å€™åªéœ€è¦ä»å†…å­˜ä¸­å–å‡ºï¼Œ</li><li>æ•°æ®æ›´æ–°ä¹‹åä¹‹åªéœ€è¦ç»´æŠ¤ä¸»é”®ç´¢å¼•å³å¯ï¼Œè¾…åŠ©ç´¢å¼•ä¸å—å½±å“</li><li>è¾…åŠ©ç´¢å¼•å­˜çš„æ˜¯ä¸»é”®ç´¢å¼•çš„å€¼ï¼Œå ç”¨æ›´å¤šçš„ç‰©ç†ç©ºé—´ã€‚æ‰€ä»¥ä¼šå—åˆ°å½±å“</li><li>ä½¿ç”¨éšæœºçš„UUIDï¼Œæ•°æ®åˆ†å¸ƒä¸å‡åŒ€ï¼Œå¯¼è‡´èšç°‡ç´¢å¼•å¯èƒ½æ‰«å…¨è¡¨ï¼Œé™ä½æ•ˆç‡ï¼Œæ‰€ä»¥å°½é‡ä½¿ç”¨è‡ªå¢ä¸»é”®id</li></ol><h1 id="ç´¢å¼•åŸç†è¡¥å……"><a href="#ç´¢å¼•åŸç†è¡¥å……" class="headerlink" title="ç´¢å¼•åŸç†è¡¥å……"></a>ç´¢å¼•åŸç†è¡¥å……</h1><h2 id="1-ç´¢å¼•åŸç†"><a href="#1-ç´¢å¼•åŸç†" class="headerlink" title="1. ç´¢å¼•åŸç†"></a>1. ç´¢å¼•åŸç†</h2><h3 id="1-ç£ç›˜IOï¼š"><a href="#1-ç£ç›˜IOï¼š" class="headerlink" title="1. ç£ç›˜IOï¼š"></a>1. ç£ç›˜IOï¼š</h3><ol><li>å¯»é“æ—¶é—´ï¼šæŒ‡çš„æ˜¯ç£è‡‚ç§»åŠ¨åˆ°æŒ‡å®šç£é“æ‰€éœ€è¦çš„æ—¶é—´ï¼Œä¸»æµç£ç›˜ä¸€èˆ¬åœ¨5msä»¥ä¸‹</li><li>æ—‹è½¬å»¶è¿Ÿï¼šæŒ‡çš„æ˜¯æˆ‘ä»¬ç»å¸¸å¬è¯´çš„ç£ç›˜è½¬é€Ÿï¼Œæ¯”å¦‚ä¸€ä¸ªç£ç›˜7200è½¬ï¼Œè¡¨ç¤ºæ¯åˆ†é’Ÿèƒ½è½¬7200æ¬¡ï¼Œä¹Ÿå°±æ˜¯è¯´1ç§’é’Ÿèƒ½è½¬120æ¬¡ï¼Œæ—‹è½¬å»¶è¿Ÿå°±æ˜¯1&#x2F;120&#x2F;2 &#x3D; 4.17ms</li><li>ä¼ è¾“æ—¶é—´ï¼šæŒ‡çš„æ˜¯ä»ç£ç›˜è¯»å‡ºæˆ–å°†æ•°æ®å†™å…¥ç£ç›˜çš„æ—¶é—´ï¼Œä¸€èˆ¬åœ¨é›¶ç‚¹å‡ æ¯«ç§’ï¼Œç›¸å¯¹äºå‰ä¸¤ä¸ªæ—¶é—´å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚</li><li>ç£ç›˜è¯»å–æ•°æ®é çš„æ˜¯æœºæ¢°è¿åŠ¨ï¼Œæ¯æ¬¡è¯»å–æ•°æ®èŠ±è´¹çš„æ—¶é—´å¯ä»¥åˆ†ä¸ºå¯»é“æ—¶é—´ã€æ—‹è½¬å»¶è¿Ÿã€ä¼ è¾“æ—¶é—´ä¸‰ä¸ªéƒ¨åˆ†ã€‚è®¿é—®ä¸€æ¬¡ç£ç›˜çš„æ—¶é—´ï¼Œå³ä¸€æ¬¡ç£ç›˜IOçš„æ—¶é—´çº¦ç­‰äº5+4.17 &#x3D; 9mså·¦å³</li></ol><h3 id="2-é¢„è¯»"><a href="#2-é¢„è¯»" class="headerlink" title="2. é¢„è¯»"></a>2. é¢„è¯»</h3><ol><li>è€ƒè™‘åˆ°ç£ç›˜IOæ˜¯éå¸¸é«˜æ˜‚çš„æ“ä½œï¼Œè®¡ç®—æœºæ“ä½œç³»ç»Ÿåšäº†ä¸€äº›ä¼˜åŒ–ï¼Œå½“ä¸€æ¬¡IOæ—¶ï¼Œä¸å…‰æŠŠå½“å‰ç£ç›˜åœ°å€çš„æ•°æ®ï¼Œè€Œæ˜¯æŠŠç›¸é‚»çš„æ•°æ®ä¹Ÿéƒ½è¯»å–åˆ°å†…å­˜ç¼“å†²åŒºå†…ï¼Œå› ä¸ºå±€éƒ¨é¢„è¯»æ€§åŸç†å‘Šè¯‰æˆ‘ä»¬ï¼Œå½“è®¡ç®—æœºè®¿é—®ä¸€ä¸ªåœ°å€çš„æ•°æ®çš„æ—¶å€™ï¼Œä¸å…¶ç›¸é‚»çš„æ•°æ®ä¹Ÿä¼šå¾ˆå¿«è¢«è®¿é—®åˆ°ã€‚æ¯ä¸€æ¬¡IOè¯»å–çš„æ•°æ®æˆ‘ä»¬ç§°ä¹‹ä¸ºä¸€é¡µ(page)</li><li>å…·ä½“ä¸€é¡µæœ‰å¤šå¤§æ•°æ®è·Ÿæ“ä½œç³»ç»Ÿæœ‰å…³ï¼Œä¸€èˆ¬ä¸º4kæˆ–8kï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¯»å–ä¸€é¡µå†…çš„æ•°æ®æ—¶å€™ï¼Œå®é™…ä¸Šæ‰å‘ç”Ÿäº†ä¸€æ¬¡IOï¼Œè¿™ä¸ªç†è®ºå¯¹äºç´¢å¼•çš„æ•°æ®ç»“æ„è®¾è®¡éå¸¸æœ‰å¸®åŠ©ã€‚</li></ol><h3 id="3-B-tree"><a href="#3-B-tree" class="headerlink" title="3. B+tree"></a>3. B+tree</h3><ol><li>ä¸€æ¬¡IOå°†ä¸€é¡µçš„æ•°æ®åŠ è½½åˆ°å†…å­˜ä¸­</li><li>ä¸ºä»€ä¹ˆç´¢å¼•å­—æ®µå°½é‡å°å¹¶ä¸”æ•°æ®åªå­˜åœ¨å¶å­èŠ‚ç‚¹ï¼šå­—èŠ‚è¶Šå°‘ï¼Œæ¯æ¬¡IOè¯·æ±‚æ‰«æçš„èŠ‚ç‚¹å°±è¶Šå¤š<ol><li>å‡è®¾å½“å‰æ•°æ®è¡¨çš„æ•°æ®ä¸ºNï¼Œæ¯ä¸ªç£ç›˜å—çš„æ•°æ®é¡¹çš„æ•°é‡æ˜¯mï¼Œåˆ™æœ‰h&#x3D;ã’(m+1)Nï¼Œå½“æ•°æ®é‡Nä¸€å®šçš„æƒ…å†µä¸‹ï¼Œmè¶Šå¤§ï¼Œhè¶Šå°ï¼›è€Œm &#x3D; ç£ç›˜å—çš„å¤§å° &#x2F; æ•°æ®é¡¹çš„å¤§å°ï¼Œç£ç›˜å—çš„å¤§å°ä¹Ÿå°±æ˜¯ä¸€ä¸ªæ•°æ®é¡µçš„å¤§å°ï¼Œæ˜¯å›ºå®šçš„ï¼Œå¦‚æœæ•°æ®é¡¹å çš„ç©ºé—´è¶Šå°ï¼Œæ•°æ®é¡¹çš„æ•°é‡è¶Šå¤šï¼Œæ ‘çš„é«˜åº¦è¶Šä½</li></ol></li><li>æœ€å·¦å‰ç¼€ç‰¹æ€§ï¼šb+æ•°æ˜¯æŒ‰ç…§ä»å·¦åˆ°å³çš„é¡ºåºæ¥å»ºç«‹æœç´¢æ ‘çš„</li></ol><h2 id="2-ç´¢å¼•åˆ›å»ºåŸåˆ™"><a href="#2-ç´¢å¼•åˆ›å»ºåŸåˆ™" class="headerlink" title="2. ç´¢å¼•åˆ›å»ºåŸåˆ™"></a>2. ç´¢å¼•åˆ›å»ºåŸåˆ™</h2><ol><li>æœ€å·¦å‰ç¼€åŸåˆ™ï¼šmysqlä¼šä¸€ç›´å‘å³åŒ¹é…ç›´åˆ°é‡åˆ°èŒƒå›´æŸ¥è¯¢(&gt;ã€&lt;ã€betweenã€like)å°±åœæ­¢åŒ¹é…ã€‚è”åˆç´¢å¼•ï¼ˆA,B,Cï¼‰ &#x3D; (A) + (A,B) +(A,B,C)</li><li>&#x3D;å’Œinå¯ä»¥ä¹±åº,mysqlæŸ¥è¯¢ä¼˜åŒ–å™¨ä¼šè‡ªåŠ¨è¯†åˆ«æˆéœ€è¦ä½¿ç”¨ç´¢å¼•çš„ç±»å‹</li><li>å°½é‡é€‰æ‹©åŒºåˆ†åº¦é«˜çš„åˆ—ä½œä¸ºç´¢å¼•</li><li>ç´¢å¼•åˆ—ä¸èƒ½å‚ä¸è®¡ç®—</li><li>å°½é‡çš„æ‰©å±•ç´¢å¼•ï¼Œä¸è¦æ–°å»ºç´¢å¼•ï¼Œå…¥è¿‡å·²ç»å­˜åœ¨Aç´¢å¼• éœ€è¦åŠ ä¸€ä¸ªæ–°çš„ç´¢å¼•ï¼Œå»ºè®®ä¿®æ”¹åŸæ¥çš„ç´¢å¼•ä¸ºï¼ˆA,Bï¼‰è”åˆç´¢å¼•</li></ol><h2 id="èµ°ç´¢å¼•çš„æƒ…å†µå’Œä¸èµ°ç´¢å¼•çš„æƒ…å†µ"><a href="#èµ°ç´¢å¼•çš„æƒ…å†µå’Œä¸èµ°ç´¢å¼•çš„æƒ…å†µ" class="headerlink" title="èµ°ç´¢å¼•çš„æƒ…å†µå’Œä¸èµ°ç´¢å¼•çš„æƒ…å†µ"></a>èµ°ç´¢å¼•çš„æƒ…å†µå’Œä¸èµ°ç´¢å¼•çš„æƒ…å†µ</h2><ol><li>inèµ°ç´¢å¼•</li><li>èŒƒå›´æŸ¥è¯¢èµ°ç´¢å¼•</li><li>æ¨¡ç³ŠæŸ¥è¯¢åªæœ‰å·¦å‰ç¼€ä½¿ç”¨ç´¢å¼•</li><li>åå‘æ¡ä»¶ä¸èµ°ç´¢å¼• !&#x3D; ã€ &lt;&gt; ã€ NOT INã€IS NOT NULL</li><li>å¯¹æ¡ä»¶è®¡ç®—(ä½¿ç”¨å‡½æ•°æˆ–è€…ç®—æ•°è¡¨è¾¾å¼)ä¸èµ°ç´¢å¼•</li><li>æŸ¥è¯¢æ—¶å¿…é¡»ä½¿ç”¨æ­£ç¡®çš„æ•°æ®ç±»å‹ï¼Œå­—æ®µç±»å‹å’ŒæŸ¥è¯¢çš„æ•°æ®ç±»å‹å¯¹åº”</li></ol><h3 id="1-OR-æ˜¯å¦èƒ½èµ°ç´¢å¼•åŠåŸç†"><a href="#1-OR-æ˜¯å¦èƒ½èµ°ç´¢å¼•åŠåŸç†" class="headerlink" title="1. OR æ˜¯å¦èƒ½èµ°ç´¢å¼•åŠåŸç†"></a>1. OR æ˜¯å¦èƒ½èµ°ç´¢å¼•åŠåŸç†</h3><ol><li>å¿…é¡»æ‰€æœ‰çš„oræ¡ä»¶éƒ½å¿…é¡»æ˜¯è¦†ç›–ç´¢å¼•</li><li>ç”¨UNIONæˆ–è€…INæ›¿æ¢OR</li></ol><h3 id="4-å‰ç¼€ç´¢å¼•"><a href="#4-å‰ç¼€ç´¢å¼•" class="headerlink" title="4. å‰ç¼€ç´¢å¼•"></a>4. å‰ç¼€ç´¢å¼•</h3><ol><li>å‰ç¼€ç´¢å¼•æ˜¯ä¸€ç§èƒ½ä½¿ç´¢å¼•æ›´å°ã€æ›´å¿«çš„æœ‰æ•ˆåŠæ³•ï¼Œä½†å®ƒä¹Ÿæœ‰ç¼ºç‚¹ï¼šMySQLæ— æ³•ä½¿ç”¨å‰ç¼€ç´¢å¼•åšORDER BYå’ŒGROUP BYæ“ä½œï¼Œä¹Ÿæ— æ³•ä½¿ç”¨å‰ç¼€ç´¢å¼•åšè¦†ç›–æ‰«æã€‚</li></ol><h3 id="å…¶ä»–æƒ…å†µ"><a href="#å…¶ä»–æƒ…å†µ" class="headerlink" title="å…¶ä»–æƒ…å†µ"></a>å…¶ä»–æƒ…å†µ</h3><ol><li><a href="./5532bb23.html">mysql GROUP BY è¯¦è§£</a> [](GROUP BY è¯¦è§£.md)</li><li><a href="./9762c2f9.html">mysql ORDER BY è¯¦è§£</a> [](ORDER BYè¯¦è§£.md)</li></ol>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> mysql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
            <tag> mysqlé¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Redisã€Memcachedã€MongoDBçš„ç‰¹ç‚¹å’ŒåŒºåˆ«</title>
      <link href="/posts/4f683a18.html"/>
      <url>/posts/4f683a18.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€Redisã€Memcachedã€MongoDBçš„ç‰¹ç‚¹"><a href="#ä¸€ã€Redisã€Memcachedã€MongoDBçš„ç‰¹ç‚¹" class="headerlink" title="ä¸€ã€Redisã€Memcachedã€MongoDBçš„ç‰¹ç‚¹"></a>ä¸€ã€Redisã€Memcachedã€MongoDBçš„ç‰¹ç‚¹</h1><h2 id="1-Redis"><a href="#1-Redis" class="headerlink" title="1. Redis"></a>1. Redis</h2><h3 id="1-1-ä¼˜ç‚¹"><a href="#1-1-ä¼˜ç‚¹" class="headerlink" title="1.1 ä¼˜ç‚¹"></a>1.1 ä¼˜ç‚¹</h3><ol><li>æ”¯æŒå¤šç§æ•°æ®ç»“æ„ï¼Œå¦‚ stringï¼ˆå­—ç¬¦ä¸²ï¼‰ã€ list(åŒå‘é“¾è¡¨)ã€dict(hashè¡¨)ã€set(é›†åˆï¼‰ã€zset(æ’åºset)</li><li>æ”¯æŒæŒä¹…åŒ–æ“ä½œï¼Œå¯ä»¥è¿›è¡ŒaofåŠrdbæ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œä»è€Œè¿›è¡Œæ•°æ®å¤‡ä»½æˆ–æ•°æ®æ¢å¤ç­‰æ“ä½œï¼Œè¾ƒå¥½çš„é˜²æ­¢æ•°æ®ä¸¢å¤±çš„æ‰‹æ®µ</li><li>æ”¯æŒé€šè¿‡Replicationè¿›è¡Œæ•°æ®å¤åˆ¶ï¼Œé€šè¿‡master-slaveæœºåˆ¶ï¼Œå¯ä»¥å®æ—¶è¿›è¡Œæ•°æ®çš„åŒæ­¥å¤åˆ¶ï¼Œæ”¯æŒå¤šçº§å¤åˆ¶å’Œå¢é‡å¤åˆ¶ï¼Œmaster-slaveæœºåˆ¶æ˜¯Redisè¿›è¡ŒHAçš„é‡è¦æ‰‹æ®µ</li><li>å•çº¿ç¨‹è¯·æ±‚ï¼Œæ‰€æœ‰å‘½ä»¤ä¸²è¡Œæ‰§è¡Œï¼Œå¹¶å‘æƒ…å†µä¸‹ä¸éœ€è¦è€ƒè™‘æ•°æ®ä¸€è‡´æ€§é—®é¢˜</li><li>æ”¯æŒpub&#x2F;subæ¶ˆæ¯è®¢é˜…æœºåˆ¶ï¼Œå¯ä»¥ç”¨æ¥è¿›è¡Œæ¶ˆæ¯è®¢é˜…ä¸é€šçŸ¥</li><li>æ”¯æŒç®€å•çš„äº‹åŠ¡éœ€æ±‚ï¼Œä½†ä¸šç•Œä½¿ç”¨åœºæ™¯å¾ˆå°‘ï¼Œå¹¶ä¸æˆç†Ÿ</li></ol><h3 id="1-2-ç¼ºç‚¹"><a href="#1-2-ç¼ºç‚¹" class="headerlink" title="1.2 ç¼ºç‚¹"></a>1.2 ç¼ºç‚¹</h3><ol><li>Redisåªèƒ½ä½¿ç”¨å•çº¿ç¨‹ï¼Œæ€§èƒ½å—é™äºCPUæ€§èƒ½ï¼Œæ•…å•å®ä¾‹CPUæœ€é«˜æ‰å¯èƒ½è¾¾åˆ°5-6wQPSæ¯ç§’ï¼ˆå–å†³äºæ•°æ®ç»“æ„ï¼Œæ•°æ®å¤§å°ä»¥åŠæœåŠ¡å™¨ç¡¬ä»¶æ€§èƒ½ï¼Œæ—¥å¸¸ç¯å¢ƒä¸­QPSé«˜å³°å¤§çº¦åœ¨1-2wå·¦å³ï¼‰</li><li>æ”¯æŒç®€å•çš„äº‹åŠ¡éœ€æ±‚ï¼Œä½†ä¸šç•Œä½¿ç”¨åœºæ™¯å¾ˆå°‘ï¼Œå¹¶ä¸æˆç†Ÿï¼Œæ—¢æ˜¯ä¼˜ç‚¹ä¹Ÿæ˜¯ç¼ºç‚¹</li><li>Redisåœ¨stringç±»å‹ä¸Šä¼šæ¶ˆè€—è¾ƒå¤šå†…å­˜ï¼Œå¯ä»¥ä½¿ç”¨dictï¼ˆhashè¡¨ï¼‰å‹ç¼©å­˜å‚¨ä»¥é™ä½å†…å­˜è€—ç”¨</li></ol><h3 id="1-3-åº”ç”¨åœºæ™¯ï¼š"><a href="#1-3-åº”ç”¨åœºæ™¯ï¼š" class="headerlink" title="1.3 åº”ç”¨åœºæ™¯ï¼š"></a>1.3 åº”ç”¨åœºæ™¯ï¼š</h3><ol><li>é…åˆå…³ç³»å‹æ•°æ®åº“åšé«˜é€Ÿç¼“å­˜</li><li>ç¼“å­˜é«˜é¢‘æ¬¡æ•°æ®ï¼Œé™ä½æ•°æ®åº“io</li><li>åˆ†å¸ƒå¼æ¶æ„ï¼Œåšsessionå…±äº«</li></ol><h2 id="Memcached"><a href="#Memcached" class="headerlink" title="Memcached"></a>Memcached</h2><h3 id="1-1-ä¼˜ç‚¹-1"><a href="#1-1-ä¼˜ç‚¹-1" class="headerlink" title="1.1 ä¼˜ç‚¹"></a>1.1 ä¼˜ç‚¹</h3><ol><li>å¯ä»¥åˆ©ç”¨å¤šæ ¸ä¼˜åŠ¿ï¼Œå•å®ä¾‹ååé‡æé«˜ï¼Œå¯ä»¥è¾¾åˆ°å‡ åä¸‡QPSï¼ˆå–å†³äºkeyã€valueçš„å­—èŠ‚å¤§å°ä»¥åŠæœåŠ¡å™¨ç¡¬ä»¶æ€§èƒ½ï¼Œæ—¥å¸¸ç¯å¢ƒä¸­QPSé«˜å³°å¤§çº¦åœ¨4-6wå·¦å³ï¼‰ï¼Œé€‚ç”¨äºæœ€å¤§ç¨‹åº¦æ‰›é‡</li><li>æ”¯æŒç›´æ¥é…ç½®ä¸ºsession handle</li></ol><h3 id="1-2-ç¼ºç‚¹-1"><a href="#1-2-ç¼ºç‚¹-1" class="headerlink" title="1.2 ç¼ºç‚¹"></a>1.2 ç¼ºç‚¹</h3><ol><li>åªæ”¯æŒç®€å•çš„key&#x2F;valueæ•°æ®ç»“æ„ï¼Œä¸åƒRediså¯ä»¥æ”¯æŒä¸°å¯Œçš„æ•°æ®ç±»å‹</li><li>æ— æ³•è¿›è¡ŒæŒä¹…åŒ–ï¼Œæ•°æ®ä¸èƒ½å¤‡ä»½ï¼Œåªèƒ½ç”¨äºç¼“å­˜ä½¿ç”¨ï¼Œä¸”é‡å¯åæ•°æ®å…¨éƒ¨ä¸¢å¤±</li><li>æ— æ³•è¿›è¡Œæ•°æ®åŒæ­¥ï¼Œä¸èƒ½å°†MCä¸­çš„æ•°æ®è¿ç§»åˆ°å…¶ä»–MCå®ä¾‹ä¸­</li><li>å†…å­˜åˆ†é…é‡‡ç”¨Slab Allocationæœºåˆ¶ç®¡ç†å†…å­˜ï¼Œvalueå¤§å°åˆ†å¸ƒå·®å¼‚è¾ƒå¤§æ—¶ä¼šé€ æˆå†…å­˜åˆ©ç”¨ç‡é™ä½ï¼Œå¹¶å¼•å‘ä½åˆ©ç”¨ç‡æ—¶ä¾ç„¶å‡ºç°è¸¢å‡ºç­‰é—®é¢˜ã€‚éœ€è¦ç”¨æˆ·æ³¨é‡valueè®¾è®¡</li></ol><h2 id="MongoDB"><a href="#MongoDB" class="headerlink" title="MongoDB"></a>MongoDB</h2><h3 id="1-1-ä¼˜ç‚¹-2"><a href="#1-1-ä¼˜ç‚¹-2" class="headerlink" title="1.1 ä¼˜ç‚¹"></a>1.1 ä¼˜ç‚¹</h3><ol><li>æ›´é«˜çš„å†™è´Ÿè½½ï¼Œæ‹¥æœ‰æ›´é«˜çš„å†™å…¥é€Ÿåº¦</li><li>å¤„ç†å¾ˆå¤§è§„æ¨¡çš„å•è¡¨ï¼Œå½“æ•°æ®è¡¨å¾ˆå¤§çš„æ—¶å€™ï¼Œå¯ä»¥å®¹æ˜“çš„åˆ†å‰²è¡¨</li><li>é«˜å¯ç”¨æ€§ï¼Œè®¾ç½®M-Sä¸ä»…æ–¹ä¾¿è€Œä¸”å¾ˆå¿«ï¼Œè¿˜å¯ä»¥å¿«é€Ÿã€å®‰å…¨åŠè‡ªåŠ¨åŒ–çš„å®ç°èŠ‚ç‚¹ï¼ˆæ•°æ®ä¸­å¿ƒï¼‰æ•…éšœè½¬ç§»</li><li>å¿«é€Ÿçš„æŸ¥è¯¢ï¼ŒMongoDBæ”¯æŒäºŒç»´ç©ºé—´ç´¢å¼•ï¼Œæ¯”å¦‚ç®¡é“ï¼Œå› æ­¤å¯ä»¥å¿«é€ŸåŠç²¾ç¡®çš„ä»æŒ‡å®šä½ç½®è·å–æ•°æ®ã€‚MongoDBåœ¨å¯åŠ¨åä¼šå°†æ•°æ®åº“ä¸­çš„æ•°æ®ä»¥æ–‡ä»¶æ˜ å°„çš„æ–¹å¼åŠ è½½åˆ°å†…å­˜ä¸­ã€‚å¦‚æœå†…å­˜èµ„æºç›¸å½“ä¸°å¯Œçš„è¯ï¼Œè¿™å°†æå¤§åœ°æé«˜æ•°æ®åº“çš„æŸ¥è¯¢é€Ÿåº¦ã€‚</li><li>éç»“æ„åŒ–æ•°æ®çš„çˆ†å‘å¢é•¿ï¼Œå¢åŠ åˆ—åœ¨æœ‰äº›æƒ…å†µä¸‹å¯èƒ½é”å®šæ•´ä¸ªæ•°æ®åº“ï¼Œæˆ–è€…å¢åŠ è´Ÿè½½ä»è€Œå¯¼è‡´æ€§èƒ½ä¸‹é™ï¼Œç”±äºMongoDBçš„å¼±æ•°æ®ç»“æ„æ¨¡å¼ï¼Œæ·»åŠ 1ä¸ªæ–°å­—æ®µä¸ä¼šå¯¹æ—§è¡¨æ ¼æœ‰ä»»ä½•å½±å“ï¼Œæ•´ä¸ªè¿‡ç¨‹ä¼šéå¸¸å¿«é€Ÿã€‚</li></ol><h3 id="1-2-ç¼ºç‚¹-2"><a href="#1-2-ç¼ºç‚¹-2" class="headerlink" title="1.2 ç¼ºç‚¹"></a>1.2 ç¼ºç‚¹</h3><ol><li>ä¸æ”¯æŒäº‹åŠ¡</li><li>å ç”¨ç©ºé—´è¿‡å¤§</li><li>æ²¡æœ‰æˆç†Ÿçš„ç»´æŠ¤å·¥å…·</li></ol><h3 id="1-3-é€‚åˆåœºæ™¯"><a href="#1-3-é€‚åˆåœºæ™¯" class="headerlink" title="1.3 é€‚åˆåœºæ™¯"></a>1.3 é€‚åˆåœºæ™¯</h3><ol><li>äº‹ä»¶è®°å½•ã€å†…å®¹ç®¡ç†æˆ–è€…åšå®¢å¹³å°ï¼Œæ¯”å¦‚è¯„è®ºç³»ç»Ÿ</li></ol><h1 id="äºŒã€Redisã€Memcachedã€MongoDBçš„åŒºåˆ«"><a href="#äºŒã€Redisã€Memcachedã€MongoDBçš„åŒºåˆ«" class="headerlink" title="äºŒã€Redisã€Memcachedã€MongoDBçš„åŒºåˆ«"></a>äºŒã€Redisã€Memcachedã€MongoDBçš„åŒºåˆ«</h1><h2 id="1-æ€§èƒ½"><a href="#1-æ€§èƒ½" class="headerlink" title="1. æ€§èƒ½"></a>1. æ€§èƒ½</h2><ol><li>ä¸‰è€…çš„æ€§èƒ½éƒ½æ¯”è¾ƒé«˜ï¼Œæ€»çš„æ¥è®²ï¼šMemcacheå’ŒRediså·®ä¸å¤šï¼Œè¦é«˜äºMongoDBã€‚</li></ol><h2 id="2-ä¾¿åˆ©æ€§"><a href="#2-ä¾¿åˆ©æ€§" class="headerlink" title="2. ä¾¿åˆ©æ€§"></a>2. ä¾¿åˆ©æ€§</h2><ol><li>memcacheæ•°æ®ç»“æ„å•ä¸€ã€‚  </li><li>redisä¸°å¯Œä¸€äº›ï¼Œæ•°æ®æ“ä½œæ–¹é¢ï¼Œredisæ›´å¥½ä¸€äº›ï¼Œè¾ƒå°‘çš„ç½‘ç»œIOæ¬¡æ•°ã€‚  </li><li>mongodbæ”¯æŒä¸°å¯Œçš„æ•°æ®è¡¨è¾¾ï¼Œç´¢å¼•ï¼Œæœ€ç±»ä¼¼å…³ç³»å‹æ•°æ®åº“ï¼Œæ”¯æŒçš„æŸ¥è¯¢è¯­è¨€éå¸¸ä¸°å¯Œã€‚</li></ol><h2 id="3-å­˜å‚¨ç©ºé—´"><a href="#3-å­˜å‚¨ç©ºé—´" class="headerlink" title="3. å­˜å‚¨ç©ºé—´"></a>3. å­˜å‚¨ç©ºé—´</h2><ol><li>MemCachedå¯ä»¥ä¿®æ”¹æœ€å¤§å†…å­˜ï¼Œé‡‡ç”¨LRUç®—æ³•ã€‚  </li><li>Rediså¢åŠ äº†VMçš„ç‰¹æ€§ï¼Œçªç ´äº†ç‰©ç†å†…å­˜çš„é™åˆ¶ã€‚  </li><li>MongoDB é€‚åˆå¤§æ•°æ®é‡çš„å­˜å‚¨ï¼Œä¾èµ–æ“ä½œç³»ç»Ÿ VM åšå†…å­˜ç®¡ç†ï¼Œå†…å­˜å ç”¨å¤§</li></ol><h2 id="4-å¯ç”¨æ€§"><a href="#4-å¯ç”¨æ€§" class="headerlink" title="4. å¯ç”¨æ€§"></a>4. å¯ç”¨æ€§</h2><ol><li><p>redisä¾èµ–å®¢æˆ·ç«¯æ¥å®ç°åˆ†å¸ƒå¼è¯»å†™ï¼›ä¸»ä»å¤åˆ¶æ—¶ï¼Œæ¯æ¬¡ä»èŠ‚ç‚¹é‡æ–°è¿æ¥ä¸»èŠ‚ç‚¹éƒ½è¦ä¾èµ–æ•´ä¸ªå¿«ç…§,æ— å¢é‡å¤åˆ¶ï¼Œå› æ€§èƒ½å’Œæ•ˆç‡é—®é¢˜ï¼Œæ‰€ä»¥å•ç‚¹é—®é¢˜æ¯”è¾ƒå¤æ‚ã€‚<br>ä¸æ”¯æŒè‡ªåŠ¨sharding,éœ€è¦ä¾èµ–ç¨‹åºè®¾å®šä¸€è‡´hash æœºåˆ¶ã€‚ä¸€ç§æ›¿ä»£æ–¹æ¡ˆæ˜¯ï¼Œä¸ç”¨redisæœ¬èº«çš„å¤åˆ¶æœºåˆ¶ï¼Œé‡‡ç”¨è‡ªå·±åšä¸»åŠ¨å¤åˆ¶ï¼ˆå¤šä»½å­˜å‚¨ï¼‰ï¼Œæˆ–è€…æ”¹æˆå¢é‡å¤åˆ¶çš„æ–¹å¼ï¼ˆéœ€è¦è‡ªå·±å®ç°ï¼‰ï¼Œä¸€è‡´æ€§é—®é¢˜å’Œæ€§èƒ½çš„æƒè¡¡ã€‚  </p></li><li><p>Memcacheæœ¬èº«æ²¡æœ‰æ•°æ®å†—ä½™æœºåˆ¶ï¼Œä¹Ÿæ²¡å¿…è¦ï¼›å¯¹äºæ•…éšœé¢„é˜²ï¼Œé‡‡ç”¨ä¾èµ–æˆç†Ÿçš„hashæˆ–è€…ç¯çŠ¶çš„ç®—æ³•ï¼Œè§£å†³å•ç‚¹æ•…éšœå¼•èµ·çš„æŠ–åŠ¨é—®é¢˜ã€‚  </p></li><li><p>mongoDBæ”¯æŒmaster-slave,replicasetï¼ˆå†…éƒ¨é‡‡ç”¨paxosé€‰ä¸¾ç®—æ³•ï¼Œè‡ªåŠ¨æ•…éšœæ¢å¤ï¼‰,auto shardingæœºåˆ¶ï¼Œå¯¹å®¢æˆ·ç«¯å±è”½äº†æ•…éšœè½¬ç§»å’Œåˆ‡åˆ†æœºåˆ¶ã€‚</p></li></ol><h2 id="5-å¯é æ€§"><a href="#5-å¯é æ€§" class="headerlink" title="5. å¯é æ€§"></a>5. å¯é æ€§</h2><ol><li>redisæ”¯æŒï¼ˆå¿«ç…§ã€AOFï¼‰ï¼šä¾èµ–å¿«ç…§è¿›è¡ŒæŒä¹…åŒ–ï¼Œaofå¢å¼ºäº†å¯é æ€§çš„åŒæ—¶ï¼Œå¯¹æ€§èƒ½æœ‰æ‰€å½±å“ã€‚  </li><li>memcacheä¸æ”¯æŒï¼Œé€šå¸¸ç”¨åœ¨åšç¼“å­˜,æå‡æ€§èƒ½ã€‚  </li><li>MongoDBä»1.8ç‰ˆæœ¬å¼€å§‹é‡‡ç”¨binlogæ–¹å¼æ”¯æŒæŒä¹…åŒ–çš„å¯é æ€§ã€‚</li></ol><h2 id="6-ä¸€è‡´æ€§"><a href="#6-ä¸€è‡´æ€§" class="headerlink" title="6. ä¸€è‡´æ€§"></a>6. ä¸€è‡´æ€§</h2><ol><li>Memcache åœ¨å¹¶å‘åœºæ™¯ä¸‹ï¼Œç”¨casä¿è¯ä¸€è‡´æ€§ã€‚  </li><li>redisäº‹åŠ¡æ”¯æŒæ¯”è¾ƒå¼±ï¼Œåªèƒ½ä¿è¯äº‹åŠ¡ä¸­çš„æ¯ä¸ªæ“ä½œè¿ç»­æ‰§è¡Œã€‚  </li><li>mongoDBä¸æ”¯æŒäº‹åŠ¡ã€‚</li></ol><h2 id="7-æ•°æ®åˆ†æ"><a href="#7-æ•°æ®åˆ†æ" class="headerlink" title="7. æ•°æ®åˆ†æ"></a>7. æ•°æ®åˆ†æ</h2><ol><li>mongoDBå†…ç½®äº†æ•°æ®åˆ†æçš„åŠŸèƒ½(mapreduce),å…¶ä»–ä¸¤è€…ä¸æ”¯æŒã€‚</li></ol><h2 id="8-åº”ç”¨åœºæ™¯"><a href="#8-åº”ç”¨åœºæ™¯" class="headerlink" title="8. åº”ç”¨åœºæ™¯"></a>8. åº”ç”¨åœºæ™¯</h2><ol><li>redisï¼šæ•°æ®é‡è¾ƒå°çš„æ›´æ€§èƒ½æ“ä½œå’Œè¿ç®—ä¸Šã€‚  </li><li>memcacheï¼šç”¨äºåœ¨åŠ¨æ€ç³»ç»Ÿä¸­å‡å°‘æ•°æ®åº“è´Ÿè½½ï¼Œæå‡æ€§èƒ½;åšç¼“å­˜ï¼Œæé«˜æ€§èƒ½ï¼ˆé€‚åˆè¯»å¤šå†™å°‘ï¼Œå¯¹äºæ•°æ®é‡æ¯”è¾ƒå¤§ï¼Œå¯ä»¥é‡‡ç”¨shardingï¼‰ã€‚</li><li>Mongodbï¼šä¸»è¦è§£å†³æµ·é‡æ•°æ®çš„è®¿é—®æ•ˆç‡é—®é¢˜</li></ol>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> NoSQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NoSQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysql å’Œ NOSQL åŒºåˆ«</title>
      <link href="/posts/e56e688.html"/>
      <url>/posts/e56e688.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€å…³ç³»å‹æ•°æ®åº“"><a href="#ä¸€ã€å…³ç³»å‹æ•°æ®åº“" class="headerlink" title="ä¸€ã€å…³ç³»å‹æ•°æ®åº“"></a>ä¸€ã€å…³ç³»å‹æ•°æ®åº“</h1><h2 id="1-1-ä»€ä¹ˆæ˜¯å…³ç³»å‹æ•°æ®åº“"><a href="#1-1-ä»€ä¹ˆæ˜¯å…³ç³»å‹æ•°æ®åº“" class="headerlink" title="1.1 ä»€ä¹ˆæ˜¯å…³ç³»å‹æ•°æ®åº“"></a>1.1 ä»€ä¹ˆæ˜¯å…³ç³»å‹æ•°æ®åº“</h2><p>å…³ç³»æ•°æ®åº“ï¼ˆRelational databaseï¼‰ï¼Œæ˜¯åˆ›å»ºåœ¨å…³ç³»æ¨¡å‹åŸºç¡€ä¸Šçš„æ•°æ®åº“ï¼Œå€ŸåŠ©äºé›†åˆä»£æ•°ç­‰æ•°å­¦æ¦‚å¿µå’Œæ–¹æ³•æ¥å¤„ç†æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚<br>ç°å®ä¸–ç•Œä¸­çš„å„ç§å®ä½“ä»¥åŠå®ä½“ä¹‹é—´çš„å„ç§è”ç³»å‡ç”¨å…³ç³»æ¨¡å‹æ¥è¡¨ç¤ºã€‚</p><ol><li>æ•°æ®åº“ï¼šåŒ…æ‹¬ä¸€ä¸ªæˆ–å¤šä¸ªè¡¨</li><li>è¡¨ï¼ˆå…³ç³» Relationï¼‰ï¼šæ˜¯ä»¥åˆ—å’Œè¡Œçš„å½¢å¼ç»„ç»‡èµ·æ¥çš„æ•°æ®çš„é›†åˆ</li><li>åˆ—ï¼ˆå±æ€§ Attributeï¼‰ï¼šåœ¨æ•°æ®åº“ä¸­ç»å¸¸è¢«ç§°ä¸ºå­—æ®µ</li><li>è¡Œï¼ˆå€¼ç»„ Tupleï¼‰ï¼šåœ¨æ•°æ®åº“ä¸­ç»å¸¸è¢«ç§°ä¸ºè®°å½•</li></ol><h2 id="1-2-å…³ç³»å‹æ•°æ®åº“ä¼˜ç‚¹"><a href="#1-2-å…³ç³»å‹æ•°æ®åº“ä¼˜ç‚¹" class="headerlink" title="1.2 å…³ç³»å‹æ•°æ®åº“ä¼˜ç‚¹"></a>1.2 å…³ç³»å‹æ•°æ®åº“ä¼˜ç‚¹</h2><ol><li>äº‹åŠ¡ä¸€è‡´æ€§ï¼šé€šè¿‡äº‹åŠ¡å¤„ç†ä¿æŒæ•°æ®çš„ä¸€è‡´æ€§</li><li>å¤æ‚æŸ¥è¯¢ï¼šæ”¯æŒSQLï¼Œå¯ä»¥è¿›è¡ŒJOINç­‰å¤æ‚æŸ¥è¯¢</li><li>å®¹æ˜“æŸ¥è¯¢ï¼šå…³ç³»æ¨¡å‹ç›¸å¯¹ç½‘çŠ¶å’Œå±‚æ¬¡ç­‰å…¶ä»–æ¨¡å‹ï¼Œæ›´æ˜“äºç†è§£</li><li>ä½¿ç”¨æ–¹ä¾¿ï¼šé€šç”¨çš„ SQL è¯­è¨€ä½¿å¾—æ“ä½œå…³ç³»å‹æ•°æ®åº“éå¸¸æ–¹ä¾¿</li><li>æ˜“äºç»´æŠ¤ï¼šä¸°å¯Œçš„ å®Œæ•´æ€§(å®ä½“å®Œæ•´æ€§ã€å‚ç…§å®Œæ•´æ€§å’Œç”¨æˆ·å®šä¹‰çš„å®Œæ•´æ€§)å¤§å¤§å‡ä½äº†æ•°æ®å†—ä½™å’Œæ•°æ®ä¸ä¸€è‡´çš„æ¦‚ç‡</li></ol><h2 id="1-3-å…³ç³»å‹æ•°æ®åº“ç¼ºç‚¹"><a href="#1-3-å…³ç³»å‹æ•°æ®åº“ç¼ºç‚¹" class="headerlink" title="1.3 å…³ç³»å‹æ•°æ®åº“ç¼ºç‚¹"></a>1.3 å…³ç³»å‹æ•°æ®åº“ç¼ºç‚¹</h2><ol><li>è¯»å†™æ€§èƒ½ï¼šåœ¨æ•°æ®é‡è¾¾åˆ°ä¸€å®šè§„æ¨¡æ—¶ï¼Œç”±äºå…³ç³»å‹æ•°æ®åº“çš„é€»è¾‘éå¸¸å¤æ‚ï¼Œä¸ºäº†ç»´æŠ¤ä¸€è‡´æ€§ï¼Œä½¿å¾—å®¹æ˜“å‡ºç°æ­»é”ç­‰å¹¶å‘é—®é¢˜ï¼Œæ‰€ä»¥å¯¼è‡´è¯»å†™é€Ÿåº¦ä¸‹æ»‘éå¸¸ä¸¥é‡</li><li>è¡¨ç»“æ„æ›´æ–°ï¼šè¡¨æœºæ„å¦‚æœæœ‰éå¸¸å¤§çš„ç»“æ„å˜æ›´æ—¶ï¼Œä¼šå˜å¾—éå¸¸å¤æ‚</li><li>é«˜å¹¶å‘ï¼šç½‘ç«™çš„ç”¨æˆ·å¹¶å‘æ€§éå¸¸é«˜ï¼Œå¯¹äºä¼ ç»Ÿå…³ç³»å‹æ•°æ®åº“æ¥è¯´ï¼Œç¡¬ç›˜ I&#x2F;O æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„ç“¶é¢ˆ</li><li>æµ·é‡æ•°æ®ï¼šå¯¹äºå…³ç³»å‹æ•°æ®åº“ï¼Œåœ¨ä¸€å¼ åŒ…å«æµ·é‡æ•°æ®çš„è¡¨ä¸­æŸ¥è¯¢ï¼Œæ•ˆç‡éå¸¸ä½</li></ol><h1 id="äºŒã€éå…³ç³»å‹æ•°æ®åº“"><a href="#äºŒã€éå…³ç³»å‹æ•°æ®åº“" class="headerlink" title="äºŒã€éå…³ç³»å‹æ•°æ®åº“"></a>äºŒã€éå…³ç³»å‹æ•°æ®åº“</h1><h2 id="1-1-ä»€ä¹ˆæ˜¯éå…³ç³»å‹æ•°æ®åº“"><a href="#1-1-ä»€ä¹ˆæ˜¯éå…³ç³»å‹æ•°æ®åº“" class="headerlink" title="1.1 ä»€ä¹ˆæ˜¯éå…³ç³»å‹æ•°æ®åº“"></a>1.1 ä»€ä¹ˆæ˜¯éå…³ç³»å‹æ•°æ®åº“</h2><p>éå…³ç³»å‹æ•°æ®åº“ï¼ˆNOSQLï¼‰æ˜¯å¯¹ä¸åŒäºä¼ ç»Ÿçš„å…³ç³»æ•°æ®åº“çš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„ç»Ÿç§°ã€‚</p><p>å½“å…¸å‹çš„å…³ç³»æ•°æ®åº“åœ¨ä¸€äº›æ•°æ®æ•æ„Ÿçš„åº”ç”¨ä¸­è¡¨ç°äº†ç³Ÿç³•çš„æ€§èƒ½ï¼Œä¾‹å¦‚ä¸ºå·¨é‡æ–‡æ¡£åˆ›å»ºç´¢å¼•ã€é«˜æµé‡ç½‘ç«™çš„ç½‘é¡µæœåŠ¡ï¼Œä»¥åŠå‘é€æµå¼åª’ä½“ã€‚å…³ç³»å‹æ•°æ®åº“çš„å…¸å‹å®ç°ä¸»è¦è¢«è°ƒæ•´ç”¨äºæ‰§è¡Œè§„æ¨¡å°è€Œè¯»å†™é¢‘ç¹ï¼Œæˆ–è€…å¤§æ‰¹é‡æå°‘å†™è®¿é—®çš„äº‹åŠ¡ã€‚</p><p>NOSQL çš„ç»“æ„é€šå¸¸æä¾›å¼±ä¸€è‡´æ€§çš„ä¿è¯ï¼Œå¦‚æœ€ç»ˆä¸€è‡´æ€§ï¼Œæˆ–äº¤æ˜“ä»…é™äºå•ä¸ªçš„æ•°æ®é¡¹ã€‚</p><p>NOSQL æå‡ºå¦ä¸€ç§ç†å¿µï¼Œä¾‹å¦‚ï¼Œä»¥é”®å€¼å¯¹å­˜å‚¨ï¼Œä¸”ç»“æ„ä¸å›ºå®šï¼Œæ¯ä¸€ä¸ªå…ƒç»„å¯ä»¥æœ‰ä¸ä¸€æ ·çš„å­—æ®µï¼Œæ¯ä¸ªå…ƒç»„å¯ä»¥æ ¹æ®éœ€è¦å¢åŠ ä¸€äº›è‡ªå·±çš„é”®å€¼å¯¹ï¼Œè¿™æ ·å°±ä¸ä¼šå±€é™äºå›ºå®šçš„ç»“æ„ï¼Œå¯ä»¥å‡å°‘ä¸€äº›æ—¶é—´å’Œç©ºé—´çš„å¼€é”€ã€‚</p><p>NOSQL ä¸ SQL å­˜åœ¨è®¸å¤šæ˜¾è‘—çš„ä¸åŒç‚¹ï¼Œå…¶ä¸­æœ€é‡è¦çš„æ˜¯ NOSQL ä¸ä½¿ç”¨ SQL ä½œä¸ºæŸ¥è¯¢è¯­è¨€ã€‚å…¶æ•°æ®å­˜å‚¨å¯ä»¥ä¸éœ€è¦å›ºå®šçš„è¡¨æ ¼æ¨¡å¼ï¼Œä¹Ÿç»å¸¸ä¼šé¿å…ä½¿ç”¨ SQL çš„ JOIN æ“ä½œï¼Œä¸€èˆ¬æœ‰æ°´å¹³å¯æ‰©å±•æ€§çš„ç‰¹å¾ã€‚</p><p>éå…³ç³»å‹æ•°æ®åº“åŒ…æ‹¬ï¼š<br>ä¸´æ—¶æ€§é”®å€¼å­˜å‚¨ï¼šmemcachedã€Redis<br>æ°¸ä¹…æ€§é”®å€¼å­˜å‚¨ï¼šROMAã€Redis<br>é¢å‘æ–‡æ¡£çš„æ•°æ®åº“ï¼šMongoDBã€CouchDB<br>é¢å‘åˆ—çš„æ•°æ®åº“ï¼šCassandraã€HBase<br>ä¸»è¦ä»£è¡¨ï¼šMongoDBï¼ŒRedisï¼ŒCouchDB</p><h2 id="1-2-éå…³ç³»å‹æ•°æ®åº“åˆ†ç±»"><a href="#1-2-éå…³ç³»å‹æ•°æ®åº“åˆ†ç±»" class="headerlink" title="1.2 éå…³ç³»å‹æ•°æ®åº“åˆ†ç±»"></a>1.2 éå…³ç³»å‹æ•°æ®åº“åˆ†ç±»</h2><p>éå…³ç³»å‹æ•°æ®åº“ä¸¥æ ¼ä¸Šä¸æ˜¯ä¸€ç§æ•°æ®åº“ï¼Œåº”è¯¥æ˜¯ä¸€ç§æ•°æ®ç»“æ„åŒ–å­˜å‚¨æ–¹æ³•çš„é›†åˆã€‚ä¾æ®ç»“æ„åŒ–æ–¹æ³•ä»¥åŠåº”ç”¨åœºåˆçš„ä¸åŒï¼Œä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š</p><ol><li>é¢å‘é«˜æ€§èƒ½å¹¶å‘è¯»å†™çš„ key-value æ•°æ®åº“ï¼šå…·æœ‰æé«˜çš„å¹¶å‘è¯»å†™æ€§èƒ½ã€‚å…¸å‹ä»£è¡¨æœ‰ Redisï¼ŒTokyo Cabinetï¼ŒFlare</li><li>é¢å‘æµ·é‡æ•°æ®è®¿é—®çš„é¢å‘æ–‡æ¡£æ•°æ®åº“ï¼šå¯ä»¥åœ¨æµ·é‡çš„æ•°æ®ä¸­å¿«é€ŸæŸ¥è¯¢æ•°æ®ã€‚å…¸å‹ä»£è¡¨æœ‰ MongoDB ä»¥åŠ CouchDB</li><li>é¢å‘å¯æ‰©å±•æ€§çš„åˆ†å¸ƒå¼æ•°æ®åº“ï¼šè¿™ç±»æ•°æ®åº“æƒ³è§£å†³çš„é—®é¢˜å°±æ˜¯ä¼ ç»Ÿæ•°æ®åº“å­˜åœ¨å¯æ‰©å±•æ€§ä¸Šçš„ç¼ºç‚¹ï¼Œè¿™ç±»æ•°æ®åº“å¯ä»¥é€‚åº”æ•°æ®é‡çš„å¢åŠ å’Œæ•°æ®ç»“æ„çš„å˜åŒ–</li></ol><h2 id="1-3-éå…³ç³»å‹æ•°æ®åº“çš„ä¼˜ç‚¹"><a href="#1-3-éå…³ç³»å‹æ•°æ®åº“çš„ä¼˜ç‚¹" class="headerlink" title="1.3 éå…³ç³»å‹æ•°æ®åº“çš„ä¼˜ç‚¹"></a>1.3 éå…³ç³»å‹æ•°æ®åº“çš„ä¼˜ç‚¹</h2><ol><li>è¯»å†™æ€§èƒ½ï¼šæ— éœ€ç»è¿‡ SQL å±‚çš„è§£æï¼Œè¯»å†™æ€§èƒ½éå¸¸é«˜ã€‚ä¸»è¦ä¾‹å­æœ‰Redisï¼Œç”±äºå…¶é€»è¾‘ç®€å•ï¼Œè€Œä¸”çº¯å†…å­˜æ“ä½œï¼Œä½¿å¾—å…¶æ€§èƒ½éå¸¸å‡ºè‰²ï¼Œå•èŠ‚ç‚¹æ¯ç§’å¯ä»¥å¤„ç†è¶…è¿‡10ä¸‡æ¬¡è¯»å†™æ“ä½œ</li><li>ç®€å•çš„æ‰©å±•ï¼šåŸºäºé”®å€¼å¯¹ï¼Œæ•°æ®æ²¡æœ‰è€¦åˆæ€§ï¼Œå®¹æ˜“æ‰©å±•ã€‚å…¸å‹ä¾‹å­æ˜¯ Cassandraï¼Œç”±äºå…¶æ¶æ„æ˜¯ç±»ä¼¼äºç»å…¸çš„ P2Pï¼Œæ‰€ä»¥èƒ½é€šè¿‡è½»æ¾åœ°æ·»åŠ æ–°çš„èŠ‚ç‚¹æ¥æ‰©å±•è¿™ä¸ªé›†ç¾¤</li><li>å­˜å‚¨æ ¼å¼å¤šï¼šæ”¯æŒ key-value ã€æ–‡æ¡£æ ¼å¼ã€å›¾ç‰‡æ ¼å¼ï¼Œè€Œå…³ç³»å‹æ•°æ®åº“åªæ”¯æŒåŸºç¡€ç±»å‹</li><li>ä½å»‰çš„æˆæœ¬ï¼šå› ä¸ºä¸»è¦éƒ½æ˜¯å¼€æºè½¯ä»¶ï¼Œæ²¡æœ‰æ˜‚è´µçš„Licenseæˆæœ¬</li></ol><h2 id="1-4-éå…³ç³»å‹æ•°æ®åº“çš„ç¼ºç‚¹"><a href="#1-4-éå…³ç³»å‹æ•°æ®åº“çš„ç¼ºç‚¹" class="headerlink" title="1.4 éå…³ç³»å‹æ•°æ®åº“çš„ç¼ºç‚¹"></a>1.4 éå…³ç³»å‹æ•°æ®åº“çš„ç¼ºç‚¹</h2><ol><li>ä¸æä¾›å¯¹ SQL çš„æ”¯æŒï¼šä¼šå¯¹ç”¨æˆ·äº§ç”Ÿä¸€å®šçš„å­¦ä¹ å’Œåº”ç”¨è¿ç§»æˆæœ¬</li><li>æ”¯æŒçš„ç‰¹æ€§ä¸å¤Ÿä¸°å¯Œï¼šç°æœ‰äº§å“æ‰€æä¾›çš„åŠŸèƒ½éƒ½æ¯”è¾ƒæœ‰é™ï¼Œå¤§å¤šæ•° NOSQL æ•°æ®åº“éƒ½ä¸æ”¯æŒäº‹åŠ¡</li><li>ç°æœ‰äº§å“çš„ä¸å¤Ÿæˆç†Ÿï¼šå¤§å¤šæ•°äº§å“éƒ½è¿˜å¤„äºåˆåˆ›æœŸï¼Œå’Œå…³ç³»å‹æ•°æ®åº“å‡ åå¹´çš„å®Œå–„ä¸å¯åŒæ—¥è€Œè¯­</li></ol><h1 id="ä¸‰ã€å…³ç³»å‹æ•°æ®åº“ä¸-NOSQL"><a href="#ä¸‰ã€å…³ç³»å‹æ•°æ®åº“ä¸-NOSQL" class="headerlink" title="ä¸‰ã€å…³ç³»å‹æ•°æ®åº“ä¸ NOSQL"></a>ä¸‰ã€å…³ç³»å‹æ•°æ®åº“ä¸ NOSQL</h1><h2 id="1-NOSQL-ä½¿ç”¨åœºæ™¯"><a href="#1-NOSQL-ä½¿ç”¨åœºæ™¯" class="headerlink" title="1.NOSQL ä½¿ç”¨åœºæ™¯"></a>1.NOSQL ä½¿ç”¨åœºæ™¯</h2><ol><li><p>æ•°æ®åº“è¡¨ç»å¸¸å˜åŠ¨<br>æ¯”å¦‚åœ¨çº¿å•†åŸï¼Œç»´æŠ¤äº§å“çš„å±æ€§ç»å¸¸è¦å¢åŠ å­—æ®µï¼Œè¿™å°±æ„å‘³ç€ ORMapping å±‚çš„ä»£ç å’Œé…ç½®è¦æ”¹ï¼Œå¦‚æœè¯¥è¡¨çš„æ•°æ®é‡è¿‡ç™¾ä¸‡ï¼Œæ–°å¢å­—æ®µä¼šå¸¦æ¥é¢å¤–å¼€é”€ï¼ˆé‡å»ºç´¢å¼•ç­‰ï¼‰</p></li><li><p>æ•°æ®åº“è¡¨å­—æ®µæ˜¯å¤æ‚æ•°æ®ç±»å‹<br>NoSQL ä»¥ json æ–¹å¼å­˜å‚¨ï¼Œæä¾›äº†åŸç”Ÿæ€çš„æ”¯æŒï¼Œåœ¨æ•ˆç‡æ–¹ä¾¿è¿œè¿œé«˜äºä¼ ç»Ÿå…³ç³»å‹æ•°æ®åº“</p></li><li><p>é«˜å¹¶å‘æ•°æ®åº“è¯·æ±‚<br>æ— éœ€ç»è¿‡ SQL å±‚çš„è§£æï¼Œè¯»å†™æ€§èƒ½éå¸¸é«˜ï¼Œå¾ˆå¤šåº”ç”¨å¯¹äºæ•°æ®ä¸€è‡´æ€§è¦æ±‚å¾ˆä½</p></li><li><p>æµ·é‡æ•°æ®çš„åˆ†å¸ƒå¼å­˜å‚¨<br>NoSQL åˆ†å¸ƒå¼å­˜å‚¨ï¼Œå¯ä»¥éƒ¨ç½²åœ¨å»‰ä»·çš„ç¡¬ä»¶ä¸Šï¼Œæ˜¯ä¸€ä¸ªæ€§ä»·æ¯”éå¸¸é«˜çš„è§£å†³æ–¹æ¡ˆ</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> mysql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysqlå¤–é”®ä¼˜åŠ£</title>
      <link href="/posts/28c1bc23.html"/>
      <url>/posts/28c1bc23.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h2 id="ä¼˜ç‚¹ï¼š"><a href="#ä¼˜ç‚¹ï¼š" class="headerlink" title="ä¼˜ç‚¹ï¼š"></a>ä¼˜ç‚¹ï¼š</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">1</span>.ç”±æ•°æ®åº“è‡ªèº«ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼Œå®Œæ•´æ€§ï¼Œæ›´å¯é ï¼Œå› ä¸ºç¨‹åºå¾ˆéš¾<span class="number">100</span>ï¼…ä¿è¯æ•°æ® çš„å®Œæ•´æ€§ï¼Œè€Œç”¨å¤–é”®å³ä½¿åœ¨æ•°æ®åº“æœåŠ¡å™¨å½“æœºæˆ–è€…å‡ºç°å…¶ä»–é—®é¢˜çš„æ—¶å€™ï¼Œä¹Ÿèƒ½å¤Ÿæœ€å¤§é™åº¦çš„ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§å’Œå®Œæ•´æ€§ã€‚</span><br><span class="line"><span class="attribute">2</span>.æœ‰ä¸»å¤–é”®çš„æ•°æ®åº“è®¾è®¡å¯ä»¥å¢åŠ ERå›¾(å®ä½“-è”ç³»å›¾)çš„å¯è¯»æ€§ï¼Œè¿™ç‚¹åœ¨æ•°æ®åº“è®¾è®¡æ—¶éå¸¸é‡è¦ã€‚</span><br><span class="line"><span class="attribute">3</span>.å¤–é”®åœ¨ä¸€å®šç¨‹åº¦ä¸Šè¯´æ˜çš„ä¸šåŠ¡é€»è¾‘ï¼Œä¼šä½¿è®¾è®¡å‘¨åˆ°å…·ä½“å…¨é¢</span><br><span class="line"><span class="attribute">4</span>.é™¤éèƒ½è¯æ˜è§¦å‘å™¨çš„æ€§èƒ½å’Œå¯ç»´æŠ¤æ€§æ¯”å¤–é”®æ›´ä¼˜ï¼Œå¦åˆ™å‡­ä»€ä¹ˆä¸€å®šè¦å¦å®šå¤–é”®å‘¢ï¼Ÿä½¿ç”¨åº”ç”¨ç¨‹åºæ¥ç»´æŠ¤æ•°æ®å®Œæ•´æ€§ï¼Œåˆ™æ˜¯ä¸¥é‡é™ä½æ•°æ®åº“å®‰å…¨æ€§çš„ä¸€ç§åšæ³•ã€‚è¿æ¥å­—ç¬¦ä¸²é‡Œå¦‚æœæœ‰uidå’Œpwdæˆ–è€…ç±»ä¼¼çš„è¿™ä¸¤ä¸ªä¸œè¥¿ï¼Œå¯ä»¥ä½¿ç”¨å·¥å…·è·å–ä½ æ•°æ®åº“çš„å¸å·ã€‚å› ä¸ºæ¯æ¬¡å»ºç«‹æ•°æ®åº“è”æ¥çš„æ—¶å€™éƒ½ä¼šåœ¨ç½‘çº¿ä¸Šä»¥æ ‡å‡†æ ¼å¼ä¼ é€’è¿™äº›ä¿¡æ¯ã€‚ä»æ­¤ç¼–ç å†…çš„ä»»ä½•ä¿è¯éƒ½æ˜¯ç©ºçš„ã€‚</span><br><span class="line"><span class="attribute">5</span>.ä¸ä½¿ç”¨å¤–é”®ï¼Œä¼šå¯¼è‡´æ•°æ®å†—ä½™ï¼Œåœ¨çº§è”æœ€åº•å±‚çš„è¡¨å¯èƒ½ä¼šé‡å¤å¥½å‡ å±‚çš„æ•°æ®ã€‚å¿…ç„¶å¯¼è‡´æœ€åº•å±‚çš„è¡¨æ•°æ®é‡ç¿»å€ï¼ŒIOç“¶é¢ˆæ˜¯æ•°æ®åº“æ€§èƒ½ç“¶é¢ˆä¹‹ä¸€</span><br></pre></td></tr></table></figure><h2 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h2><h3 id="æ€§èƒ½ä¸Š"><a href="#æ€§èƒ½ä¸Š" class="headerlink" title="æ€§èƒ½ä¸Š"></a>æ€§èƒ½ä¸Š</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1..æ•°æ®åº“éœ€è¦ç»´æŠ¤å¤–é”®çš„å†…éƒ¨ç®¡ç†</span><br><span class="line">2.å¤–é”®ç­‰äºæŠŠæ•°æ®çš„ä¸€è‡´æ€§äº‹åŠ¡å®ç°ï¼Œå…¨éƒ¨äº¤ç»™æ•°æ®åº“æœåŠ¡å™¨å®Œæˆ</span><br><span class="line">3.æœ‰äº†å¤–é”®ï¼Œå½“åšä¸€äº›æ¶‰åŠå¤–é”®å­—æ®µçš„å¢ï¼Œåˆ ï¼Œæ›´æ–°æ“ä½œä¹‹åï¼Œéœ€è¦è§¦å‘ç›¸å…³æ“ä½œå»æ£€æŸ¥ï¼Œè€Œä¸å¾—ä¸æ¶ˆè€—èµ„æº,ä¸ç”¨å¤–é”®æ—¶æ•°æ®ç®¡ç†ç®€å•ï¼Œæ“ä½œæ–¹ä¾¿ï¼Œæ€§èƒ½é«˜</span><br><span class="line">4.å¤–é”®è¿˜ä¼šå› ä¸ºéœ€è¦è¯·æ±‚å¯¹å…¶ä»–è¡¨å†…éƒ¨åŠ é”è€Œå®¹æ˜“å‡ºç°æ­»é”æƒ…å†µ</span><br></pre></td></tr></table></figure><h3 id="mysqlçš„å¤–é”®è®¾è®¡é—®é¢˜"><a href="#mysqlçš„å¤–é”®è®¾è®¡é—®é¢˜" class="headerlink" title="mysqlçš„å¤–é”®è®¾è®¡é—®é¢˜"></a>mysqlçš„å¤–é”®è®¾è®¡é—®é¢˜</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>æ‰€æœ‰<span class="keyword">tables</span>å¿…é¡»æ˜¯InnoDBå‹ï¼Œå®ƒä»¬ä¸èƒ½æ˜¯ä¸´æ—¶è¡¨ã€‚</span><br><span class="line"><span class="number">2.</span>åœ¨å¼•ç”¨è¡¨ä¸­ï¼Œå¿…é¡»æœ‰ä¸€ä¸ªç´¢å¼•ï¼Œå¤–é”®åˆ—ä»¥åŒæ ·çš„é¡ºåºè¢«åˆ—åœ¨å…¶ä¸­ä½œä¸ºç¬¬ä¸€åˆ—ã€‚è¿™æ ·ä¸€ä¸ªç´¢å¼•å¦‚æœä¸å­˜åœ¨ï¼Œå®ƒå¿…é¡»åœ¨å¼•ç”¨è¡¨é‡Œè¢«è‡ªåŠ¨åˆ›å»ºã€‚</span><br><span class="line"><span class="number">3.</span>ä¸æ”¯æŒå¯¹å¤–é”®åˆ—çš„ç´¢å¼•å‰ç¼€ã€‚è¿™æ ·çš„åæœä¹‹ä¸€æ˜¯BLOBå’Œ<span class="type">TEXT</span>åˆ—ä¸è¢«åŒ…æ‹¬åœ¨ä¸€ä¸ªå¤–é”®ä¸­ï¼Œè¿™æ˜¯å› ä¸ºå¯¹è¿™äº›åˆ—çš„ç´¢å¼•å¿…é¡»æ€»æ˜¯åŒ…å«ä¸€ä¸ªå‰ç¼€é•¿åº¦ </span><br><span class="line"><span class="number">4.</span>InnoDBä¸å¯¹é‚£äº›å¤–é”®æˆ–åŒ…å«<span class="keyword">NULL</span>åˆ—çš„è¢«å¼•ç”¨é”®å€¼æ£€æŸ¥å¤–é”®çº¦æŸ </span><br></pre></td></tr></table></figure><h3 id="å¤–é”®å¯¹æ‹“å±•æ€§çš„é™åˆ¶å’Œå½±å“"><a href="#å¤–é”®å¯¹æ‹“å±•æ€§çš„é™åˆ¶å’Œå½±å“" class="headerlink" title="å¤–é”®å¯¹æ‹“å±•æ€§çš„é™åˆ¶å’Œå½±å“"></a>å¤–é”®å¯¹æ‹“å±•æ€§çš„é™åˆ¶å’Œå½±å“</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.å¤–é”®çš„ä¸»ä»å…³ç³»æ˜¯å®šçš„ï¼Œä¸»é”®è¡¨éœ€è¦æ‹†åˆ†æˆ–è€…é‡æ„æ—¶ï¼Œå¢åŠ æˆæœ¬</span><br><span class="line">2.è¿‡åˆ†å¼ºè°ƒæˆ–è€…è¯´ä½¿ç”¨ä¸»é”®ï¼å¤–é”®ä¼šå¹³æ·»å¼€å‘éš¾åº¦ï¼Œå¯¼è‡´è¡¨è¿‡å¤šç­‰é—®é¢˜</span><br></pre></td></tr></table></figure><h3 id="é€»è¾‘å¤–é”®åœ¨ä¸šç•Œæ¯”è¾ƒæˆç†Ÿ"><a href="#é€»è¾‘å¤–é”®åœ¨ä¸šç•Œæ¯”è¾ƒæˆç†Ÿ" class="headerlink" title="é€»è¾‘å¤–é”®åœ¨ä¸šç•Œæ¯”è¾ƒæˆç†Ÿ"></a>é€»è¾‘å¤–é”®åœ¨ä¸šç•Œæ¯”è¾ƒæˆç†Ÿ</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.æ•°æ®åº“ä¸Šçš„ç­–ç•¥ï¼šå¯ä»¥é€‰æ‹©å¤§å¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬åªæ›´æ–°ä¸åˆ é™¤ï¼Œä¹Ÿå°±æ˜¯é€»è¾‘åˆ ï¼Œä¸å†ä½¿ç”¨çš„å†å²æ•°æ®å®šæœŸå½’æ¡£æ¥å‡å°‘å‹åŠ›ã€‚</span><br><span class="line">2.ä»£ç çš„è®¾è®¡å’Œé™åˆ¶ï¼šå¯¹è¡¨èŒƒå›´çš„æ“ä½œæƒé™ï¼Œå¼€å¯äº‹åŠ¡å»å¤„ç†é€»è¾‘ï¼Œæœ‰éœ€è¦è¿›è¡Œå¼‚æ­¥æ“ä½œ</span><br><span class="line">æ¥æé«˜æ€§èƒ½çš„æˆ‘ä»¬è®¾è®¡è¡¥å¿æœºåˆ¶å»å¼¥è¡¥ï¼Œç­‰ç­‰ã€‚</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> mysql </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æ‘˜æŠ„</title>
      <link href="/posts/639b053d.html"/>
      <url>/posts/639b053d.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ä¸‰ç¦½è¨€Â·è¡Œä¸å¾—ä¹Ÿå“¥å“¥</span><br><span class="line">è¡Œä¸å¾—ä¹Ÿå“¥å“¥ï¼</span><br><span class="line">åå…«æ»©å¤´ä¹±çŸ³å¤šã€‚</span><br><span class="line">ä¸œå»å…¥é—½å—å…¥æµ·ï¼Œ</span><br><span class="line">æºªæµæ¹æ€¥å²­åµ¯å³¨ã€‚</span><br><span class="line">è¡Œä¸å¾—ä¹Ÿå“¥å“¥ï¼</span><br></pre></td></tr></table></figure><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ç‹å›½ç»´ã€Šè¶æ‹èŠ±Â·é˜…å°½å¤©æ¶¯ç¦»åˆ«è‹¦ã€‹</span><br><span class="line">é˜…å°½å¤©æ¶¯ç¦»åˆ«è‹¦ï¼Œä¸é“å½’æ¥ï¼Œé›¶è½èŠ±å¦‚è®¸ã€‚èŠ±åº•ç›¸çœ‹æ— ä¸€è¯­ï¼Œç»¿çª—æ˜¥ä¸å¤©ä¿±è«ã€‚(ä¿±è« ä¸€ä½œï¼šä¿±æš®)</span><br><span class="line">å¾…æŠŠç›¸æ€ç¯ä¸‹è¯‰ï¼Œä¸€ç¼•æ–°æ¬¢ï¼Œæ—§æ¨åƒåƒç¼•ã€‚æœ€æ˜¯äººé—´ç•™ä¸ä½ï¼Œæœ±é¢œè¾é•œèŠ±è¾æ ‘ã€‚ </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ‘˜æŠ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ‘˜æŠ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>github vimé…ç½®</title>
      <link href="/posts/7dda2c10.html"/>
      <url>/posts/7dda2c10.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot; Vim color file</span></span><br><span class="line"><span class="string">&quot;</span>   This file was generated by Palette</span><br><span class="line"><span class="string">&quot;   http://rubygems.org/gems/palette</span></span><br><span class="line"><span class="string">&quot;</span></span><br><span class="line"><span class="string">&quot; Author: Compiled from a handful of different themes</span></span><br><span class="line"><span class="string">&quot;</span> Notes:  Github color scheme (light)</span><br><span class="line"></span><br><span class="line">hi clear</span><br><span class="line"><span class="keyword">if</span> version &gt; 580</span><br><span class="line">    <span class="keyword">if</span> exists(<span class="string">&quot;syntax_on&quot;</span>)</span><br><span class="line">        syntax reset</span><br><span class="line">    endif</span><br><span class="line">endif</span><br><span class="line"></span><br><span class="line">let <span class="attribute">colors_name</span>=<span class="string">&quot;github&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> has(<span class="string">&quot;gui_running&quot;</span>)</span><br><span class="line">    <span class="built_in">set</span> <span class="attribute">background</span>=light</span><br><span class="line">endif</span><br><span class="line"></span><br><span class="line">hi Normal       <span class="attribute">guifg</span>=#000000 <span class="attribute">ctermfg</span>=16   <span class="attribute">guibg</span>=#F8F8FF <span class="attribute">ctermbg</span>=231  <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi DiffAdd      <span class="attribute">guifg</span>=#003300 <span class="attribute">ctermfg</span>=22   <span class="attribute">guibg</span>=#DDFFDD <span class="attribute">ctermbg</span>=194  <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi DiffChange   <span class="attribute">guibg</span>=#ECECEC <span class="attribute">ctermbg</span>=255  <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi DiffText     <span class="attribute">guifg</span>=#000033 <span class="attribute">ctermfg</span>=17   <span class="attribute">guibg</span>=#DDDDFF <span class="attribute">ctermbg</span>=189  <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi DiffDelete   <span class="attribute">guifg</span>=#DDCCCC <span class="attribute">ctermfg</span>=252  <span class="attribute">guibg</span>=#FFDDDD <span class="attribute">ctermbg</span>=224  <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi Folded       <span class="attribute">guifg</span>=#808080 <span class="attribute">ctermfg</span>=244  <span class="attribute">guibg</span>=#ECECEC <span class="attribute">ctermbg</span>=255  <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi LineNr       <span class="attribute">guifg</span>=#BBBBBB <span class="attribute">ctermfg</span>=250  <span class="attribute">guibg</span>=#ECECEC <span class="attribute">ctermbg</span>=255  <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi NonText      <span class="attribute">guifg</span>=#808080 <span class="attribute">ctermfg</span>=244  <span class="attribute">guibg</span>=#ECECEC <span class="attribute">ctermbg</span>=255  <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi VertSplit    <span class="attribute">guifg</span>=#BBBBBB <span class="attribute">ctermfg</span>=250  <span class="attribute">guibg</span>=#BBBBBB <span class="attribute">ctermbg</span>=250  <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi StatusLine   <span class="attribute">guifg</span>=#404040 <span class="attribute">ctermfg</span>=238  <span class="attribute">guibg</span>=#BBBBBB <span class="attribute">ctermbg</span>=250  <span class="attribute">gui</span>=BOLD <span class="attribute">cterm</span>=BOLD</span><br><span class="line">hi StatusLineNC <span class="attribute">guifg</span>=#BBBBBB <span class="attribute">ctermfg</span>=250  <span class="attribute">guibg</span>=#ECECEC <span class="attribute">ctermbg</span>=255  <span class="attribute">gui</span>=ITALIC <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi ModeMsg      <span class="attribute">guifg</span>=#990000 <span class="attribute">ctermfg</span>=88   <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi MoreMsg      <span class="attribute">guifg</span>=#990000 <span class="attribute">ctermfg</span>=88   <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi Title        <span class="attribute">guifg</span>=#EF5939 <span class="attribute">ctermfg</span>=203  <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi WarningMsg   <span class="attribute">guifg</span>=#EF5939 <span class="attribute">ctermfg</span>=203  <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi SpecialKey   <span class="attribute">guifg</span>=#FFFFFF <span class="attribute">ctermfg</span>=231  <span class="attribute">guibg</span>=#FF1100 <span class="attribute">ctermbg</span>=196  <span class="attribute">gui</span>=ITALIC <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi MatchParen   <span class="attribute">guifg</span>=#000000 <span class="attribute">ctermfg</span>=16   <span class="attribute">guibg</span>=#CDCDFD <span class="attribute">ctermbg</span>=189  <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi Underlined   <span class="attribute">guifg</span>=#000000 <span class="attribute">ctermfg</span>=16   <span class="attribute">gui</span>=UNDERLINE <span class="attribute">cterm</span>=UNDERLINE</span><br><span class="line">hi Directory    <span class="attribute">guifg</span>=#990000 <span class="attribute">ctermfg</span>=88   <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi Visual       <span class="attribute">guifg</span>=#FFFFFF <span class="attribute">ctermfg</span>=231  <span class="attribute">guibg</span>=#3465A4 <span class="attribute">ctermbg</span>=61   <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi VisualNOS    <span class="attribute">guifg</span>=#FFFFFF <span class="attribute">ctermfg</span>=231  <span class="attribute">guibg</span>=#204A87 <span class="attribute">ctermbg</span>=24   <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi IncSearch    <span class="attribute">guifg</span>=#000000 <span class="attribute">ctermfg</span>=16   <span class="attribute">guibg</span>=#CDCDFD <span class="attribute">ctermbg</span>=189  <span class="attribute">gui</span>=ITALIC <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi Search       <span class="attribute">guifg</span>=#000000 <span class="attribute">ctermfg</span>=16   <span class="attribute">guibg</span>=#CDCDFD <span class="attribute">ctermbg</span>=189  <span class="attribute">gui</span>=ITALIC <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi Ignore       <span class="attribute">guifg</span>=#808080 <span class="attribute">ctermfg</span>=244  <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi Identifier   <span class="attribute">guifg</span>=#0086B3 <span class="attribute">ctermfg</span>=31   <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi PreProc      <span class="attribute">guifg</span>=#A0A0A0 <span class="attribute">ctermfg</span>=247  <span class="attribute">gui</span>=BOLD <span class="attribute">cterm</span>=BOLD</span><br><span class="line">hi Comment      <span class="attribute">guifg</span>=#AAAAAA <span class="attribute">ctermfg</span>=248  <span class="attribute">gui</span>=ITALIC <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi Constant     <span class="attribute">guifg</span>=#177F80 <span class="attribute">ctermfg</span>=30   <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi String       <span class="attribute">guifg</span>=#D81745 <span class="attribute">ctermfg</span>=161  <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi Function     <span class="attribute">guifg</span>=#990000 <span class="attribute">ctermfg</span>=88   <span class="attribute">gui</span>=BOLD <span class="attribute">cterm</span>=BOLD</span><br><span class="line">hi Statement    <span class="attribute">guifg</span>=#000000 <span class="attribute">ctermfg</span>=16   <span class="attribute">gui</span>=BOLD <span class="attribute">cterm</span>=BOLD</span><br><span class="line">hi<span class="built_in"> Type </span>        <span class="attribute">guifg</span>=#445588 <span class="attribute">ctermfg</span>=60   <span class="attribute">gui</span>=BOLD <span class="attribute">cterm</span>=BOLD</span><br><span class="line">hi Number       <span class="attribute">guifg</span>=#1C9898 <span class="attribute">ctermfg</span>=30   <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi Todo         <span class="attribute">guifg</span>=#FFFFFF <span class="attribute">ctermfg</span>=231  <span class="attribute">guibg</span>=#990000 <span class="attribute">ctermbg</span>=88   <span class="attribute">gui</span>=BOLD <span class="attribute">cterm</span>=BOLD</span><br><span class="line">hi Special      <span class="attribute">guifg</span>=#159828 <span class="attribute">ctermfg</span>=28   <span class="attribute">gui</span>=BOLD <span class="attribute">cterm</span>=BOLD</span><br><span class="line">hi rubySymbol   <span class="attribute">guifg</span>=#960B73 <span class="attribute">ctermfg</span>=89   <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi <span class="built_in">Error</span>        <span class="attribute">guifg</span>=#F8F8FF <span class="attribute">ctermfg</span>=231  <span class="attribute">guibg</span>=#FF1100 <span class="attribute">ctermbg</span>=196  <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi Todo         <span class="attribute">guifg</span>=#F8F8FF <span class="attribute">ctermfg</span>=231  <span class="attribute">guibg</span>=#FF1100 <span class="attribute">ctermbg</span>=196  <span class="attribute">gui</span>=UNDERLINE <span class="attribute">cterm</span>=UNDERLINE</span><br><span class="line">hi Label        <span class="attribute">guifg</span>=#000000 <span class="attribute">ctermfg</span>=16   <span class="attribute">gui</span>=BOLD <span class="attribute">cterm</span>=BOLD</span><br><span class="line">hi StorageClass <span class="attribute">guifg</span>=#000000 <span class="attribute">ctermfg</span>=16   <span class="attribute">gui</span>=BOLD <span class="attribute">cterm</span>=BOLD</span><br><span class="line">hi Structure    <span class="attribute">guifg</span>=#000000 <span class="attribute">ctermfg</span>=16   <span class="attribute">gui</span>=BOLD <span class="attribute">cterm</span>=BOLD</span><br><span class="line">hi TypeDef      <span class="attribute">guifg</span>=#000000 <span class="attribute">ctermfg</span>=16   <span class="attribute">gui</span>=BOLD <span class="attribute">cterm</span>=BOLD</span><br><span class="line">hi WildMenu     <span class="attribute">guifg</span>=#7FBDFF <span class="attribute">ctermfg</span>=111  <span class="attribute">guibg</span>=#425C78 <span class="attribute">ctermbg</span>=60   <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi Pmenu        <span class="attribute">guifg</span>=#FFFFFF <span class="attribute">ctermfg</span>=231  <span class="attribute">guibg</span>=#808080 <span class="attribute">ctermbg</span>=244  <span class="attribute">gui</span>=BOLD <span class="attribute">cterm</span>=BOLD</span><br><span class="line">hi PmenuSel     <span class="attribute">guifg</span>=#000000 <span class="attribute">ctermfg</span>=16   <span class="attribute">guibg</span>=#CDCDFD <span class="attribute">ctermbg</span>=189  <span class="attribute">gui</span>=ITALIC <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi PmenuSbar    <span class="attribute">guifg</span>=#444444 <span class="attribute">ctermfg</span>=238  <span class="attribute">guibg</span>=#000000 <span class="attribute">ctermbg</span>=16   <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi PmenuThumb   <span class="attribute">guifg</span>=#AAAAAA <span class="attribute">ctermfg</span>=248  <span class="attribute">guibg</span>=#AAAAAA <span class="attribute">ctermbg</span>=248  <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi TabLine      <span class="attribute">guifg</span>=#404040 <span class="attribute">ctermfg</span>=238  <span class="attribute">guibg</span>=#DDDDDD <span class="attribute">ctermbg</span>=253  <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi TabLineFill  <span class="attribute">guifg</span>=#404040 <span class="attribute">ctermfg</span>=238  <span class="attribute">guibg</span>=#DDDDDD <span class="attribute">ctermbg</span>=253  <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi TabLineSel   <span class="attribute">guifg</span>=#404040 <span class="attribute">ctermfg</span>=238  <span class="attribute">gui</span>=BOLD <span class="attribute">cterm</span>=BOLD</span><br><span class="line">hi cucumberTags <span class="attribute">guifg</span>=#333333 <span class="attribute">ctermfg</span>=236  <span class="attribute">guibg</span>=#FFFF66 <span class="attribute">ctermbg</span>=227  <span class="attribute">gui</span>=BOLD <span class="attribute">cterm</span>=BOLD</span><br><span class="line">hi htmlTagN     <span class="attribute">gui</span>=BOLD <span class="attribute">cterm</span>=BOLD</span><br><span class="line">hi Cursor       <span class="attribute">guifg</span>=#F8F8FF <span class="attribute">ctermfg</span>=231  <span class="attribute">guibg</span>=#444454 <span class="attribute">ctermbg</span>=238  <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi CursorLine   <span class="attribute">guibg</span>=#D8D8DD <span class="attribute">ctermbg</span>=253  <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line">hi CursorColumn <span class="attribute">guibg</span>=#D8D8DD <span class="attribute">ctermbg</span>=253  <span class="attribute">gui</span>=NONE <span class="attribute">cterm</span>=NONE</span><br><span class="line"></span><br><span class="line">hi link rubyStringDelimiter String</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å…¶ä»– </category>
          
          <category> é…ç½®æ–‡ä»¶ </category>
          
          <category> vim </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vim </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linuxä¸‹å®‰è£…docker</title>
      <link href="/posts/b83e5bf.html"/>
      <url>/posts/b83e5bf.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="linuxä¸‹å®‰è£…"><a href="#linuxä¸‹å®‰è£…" class="headerlink" title="linuxä¸‹å®‰è£…"></a>linuxä¸‹å®‰è£…</h1><p>ä¸€ã€å®‰è£…docker</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¦‚æœæ²¡æœ‰yum-config-mangeéœ€è¦å®‰è£…</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">yum -y install yum-utils</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¢åŠ å›½å†…dockeræº</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å®‰è£…docker</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">yum install docker-ce docker-compose</span></span><br></pre></td></tr></table></figure><h1 id="å»ºç«‹ç”¨æˆ·ç»„"><a href="#å»ºç«‹ç”¨æˆ·ç»„" class="headerlink" title="å»ºç«‹ç”¨æˆ·ç»„"></a>å»ºç«‹ç”¨æˆ·ç»„</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sudo</span> groupadd docker</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å°†å½“å‰ç”¨æˆ·åŠ å…¥dockerç”¨æˆ·ç»„</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sudo</span> usermod -aG docker <span class="variable">$USER</span></span></span><br></pre></td></tr></table></figure><h1 id="é…ç½®é•œåƒåŠ é€Ÿ"><a href="#é…ç½®é•œåƒåŠ é€Ÿ" class="headerlink" title="é…ç½®é•œåƒåŠ é€Ÿ"></a>é…ç½®é•œåƒåŠ é€Ÿ</h1><h2 id="æŸ¥çœ‹æ˜¯å¦åœ¨docker-serviceé…ç½®è¿‡é•œåƒåœ°å€"><a href="#æŸ¥çœ‹æ˜¯å¦åœ¨docker-serviceé…ç½®è¿‡é•œåƒåœ°å€" class="headerlink" title="æŸ¥çœ‹æ˜¯å¦åœ¨docker.serviceé…ç½®è¿‡é•œåƒåœ°å€"></a>æŸ¥çœ‹æ˜¯å¦åœ¨docker.serviceé…ç½®è¿‡é•œåƒåœ°å€</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">systemctl <span class="built_in">cat</span> docker | grep <span class="string">&#x27;\-\-registry\-mirror&#x27;</span></span></span><br></pre></td></tr></table></figure><h2 id="é…ç½®åŠ é€Ÿ"><a href="#é…ç½®åŠ é€Ÿ" class="headerlink" title="é…ç½®åŠ é€Ÿ"></a>é…ç½®åŠ é€Ÿ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">mkdir</span> /etc/docker</span><br><span class="line">$ vim /etc/docker/daemon.json</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†™å…¥å†…å®¹</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;registry-mirrors&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;https://hub-mirror.c.163.com&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://mirror.baidubce.com&quot;</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é‡å¯æœåŠ¡"><a href="#é‡å¯æœåŠ¡" class="headerlink" title="é‡å¯æœåŠ¡"></a>é‡å¯æœåŠ¡</h2><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>systemctl daemon-reload</span><br><span class="line"><span class="variable">$ </span>systemctl restart docker</span><br></pre></td></tr></table></figure><h2 id="æ£€æŸ¥åŠ é€Ÿå™¨æ˜¯å¦ç”Ÿæ•ˆ"><a href="#æ£€æŸ¥åŠ é€Ÿå™¨æ˜¯å¦ç”Ÿæ•ˆ" class="headerlink" title="æ£€æŸ¥åŠ é€Ÿå™¨æ˜¯å¦ç”Ÿæ•ˆ"></a>æ£€æŸ¥åŠ é€Ÿå™¨æ˜¯å¦ç”Ÿæ•ˆ</h2><p>æ‰§è¡Œ <code>$ docker info</code>ï¼Œå¦‚æœä»ç»“æœä¸­çœ‹åˆ°äº†å¦‚ä¸‹å†…å®¹ï¼Œè¯´æ˜é…ç½®æˆåŠŸã€‚</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Registry Mirrors:</span><br><span class="line"><span class="symbol">  https:</span><span class="comment">//hub-mirror.c.163.com/</span></span><br><span class="line"><span class="symbol">  https:</span><span class="comment">//mirror.baidubce.com/</span></span><br></pre></td></tr></table></figure><h1 id="é—®é¢˜å¤„ç†"><a href="#é—®é¢˜å¤„ç†" class="headerlink" title="é—®é¢˜å¤„ç†"></a>é—®é¢˜å¤„ç†</h1><h2 id="Failed-to-start-Docker-Application-Container-Engine"><a href="#Failed-to-start-Docker-Application-Container-Engine" class="headerlink" title="Failed to start Docker Application Container Engine."></a>Failed to start Docker Application Container Engine.</h2><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ vim <span class="regexp">/usr/</span>lib<span class="regexp">/systemd/</span>system/docker.service</span><br><span class="line"># å°†</span><br><span class="line">#ExecStart=<span class="regexp">/usr/</span>bin<span class="regexp">/dockerd -H fd:/</span><span class="regexp">/ --containerd=/</span>run<span class="regexp">/containerd/</span>containerd.sock</span><br><span class="line"># ä¿®æ”¹ä¸º</span><br><span class="line">ExecStart=<span class="regexp">/usr/</span>bin<span class="regexp">/dockerd -H tcp:/</span><span class="regexp">/0.0.0.0:2375 -H unix:/</span><span class="regexp">/var/</span>run/docker.sock</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> Docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>elasticsearchå®‰è£…</title>
      <link href="/posts/b99f8e70.html"/>
      <url>/posts/b99f8e70.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><p>Elastic éœ€è¦ Java 8 ç¯å¢ƒã€‚</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$</span> <span class="built_in">wget</span> https://artifacts.elastic.co/downloads/elasticsearch/elastic<span class="built_in">search-8</span>.<span class="number">4.2</span><span class="literal">-linux-x86_64</span>.tar.gz</span><br><span class="line"><span class="variable">$</span> tar xzvf elastic<span class="built_in">search-8</span>.<span class="number">4.2</span><span class="literal">-linux-x86_64</span>.tar.gz</span><br></pre></td></tr></table></figure><h1 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">elastic/bin/elasticsearch</span></span><br></pre></td></tr></table></figure><h1 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h1><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¿é—®host</span></span><br><span class="line"><span class="attr">http.host:</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line"><span class="comment"># è®¿é—®ç«¯å£</span></span><br><span class="line"><span class="attr">http.port:</span> <span class="number">9200</span></span><br></pre></td></tr></table></figure><h1 id="é—®é¢˜å¤„ç†"><a href="#é—®é¢˜å¤„ç†" class="headerlink" title="é—®é¢˜å¤„ç†"></a>é—®é¢˜å¤„ç†</h1><h2 id="Failure-running-machine-learning-native-code-unsupported-OS-or-distributionâ€¦"><a href="#Failure-running-machine-learning-native-code-unsupported-OS-or-distributionâ€¦" class="headerlink" title="Failure running machine learning native code - unsupported OS or distributionâ€¦"></a>Failure running machine learning native code - unsupported OS or distributionâ€¦</h2><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ vim <span class="symbol">./config/elasticsearch.yml</span></span><br><span class="line"><span class="comment"># æ·»åŠ </span></span><br><span class="line">xpack.ml.<span class="params">enabled:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><h2 id="æœ¬åœ°æ— æ³•å¯åŠ¨"><a href="#æœ¬åœ°æ— æ³•å¯åŠ¨" class="headerlink" title="æœ¬åœ°æ— æ³•å¯åŠ¨"></a>æœ¬åœ°æ— æ³•å¯åŠ¨</h2><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…³é—­å®‰å…¨</span></span><br><span class="line">$ vim <span class="symbol">./config/elasticsearch.yml</span></span><br><span class="line">xpack.security.<span class="params">enabled:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><h2 id="system-call-filters-failed-to-install-check-the-logs-and-fix-your-configuration-or-disable-system-call-filters"><a href="#system-call-filters-failed-to-install-check-the-logs-and-fix-your-configuration-or-disable-system-call-filters" class="headerlink" title="system call filters failed to install; check the logs and fix your configuration or disable system call filters"></a>system call filters failed to install; check the logs and fix your configuration or disable system call filters</h2><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">åŸå› ï¼š</span><br><span class="line">è¿™æ˜¯åœ¨å› ä¸ºCentos6ä¸æ”¯æŒSecCompï¼Œè€ŒES5.<span class="number">2.0</span>é»˜è®¤bootstrap.<span class="params">system</span>_call_filterä¸º<span class="literal">true</span>è¿›è¡Œæ£€æµ‹ï¼Œæ‰€ä»¥å¯¼è‡´æ£€æµ‹å¤±è´¥ï¼Œå¤±è´¥åç›´æ¥å¯¼è‡´ESä¸èƒ½å¯åŠ¨ã€‚</span><br><span class="line">è§£å†³ï¼š</span><br><span class="line">åœ¨elasticsearch.ymlä¸­é…ç½®bootstrap.<span class="params">system</span>_call_filterä¸º<span class="literal">false</span>ï¼Œæ³¨æ„è¦åœ¨Memoryä¸‹é¢:</span><br><span class="line">bootstrap.memory_lock: <span class="literal">false</span></span><br><span class="line">bootstrap.<span class="params">system</span>_call_filter: <span class="literal">false</span></span><br></pre></td></tr></table></figure><h2 id="max-number-of-threads-2048-for-user-to-low"><a href="#max-number-of-threads-2048-for-user-to-low" class="headerlink" title="max number of threads [2048] for user to low"></a>max number of threads [2048] for user to low</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ vim /etc/security/limits.conf</span><br><span class="line">æ·»åŠ </span><br><span class="line">hadoop soft nofile 65536</span><br><span class="line">hadoop hard nofile 131072</span><br><span class="line">hadoop soft <span class="built_in">nproc</span> 4096</span><br><span class="line">hadoop hard <span class="built_in">nproc</span> 4096</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> elasticsearch </category>
          
      </categories>
      
      
        <tags>
            
            <tag> elasticsearch </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>elasticsearch-head</title>
      <link href="/posts/33ca46c0.html"/>
      <url>/posts/33ca46c0.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>æ–°å»ºç´¢å¼•æ—¶ï¼ŒæŠ¥é”™{â€œerrorâ€:â€Content-Type header [application&#x2F;x-www-form-urlencoded] is not supportedâ€,â€statusâ€:406}<br>è§£å†³æ–¹æ³•:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">è¿›å…¥<span class="built_in">head</span>å®‰è£…ç›®å½•ç¼–è¾‘vendor.js å…±æœ‰ä¸¤å¤„</span><br><span class="line">â‘ . 6886è¡Œ contentType: <span class="string">&quot;application/x-www-form-urlencoded</span></span><br><span class="line"><span class="string">æ”¹æˆ</span></span><br><span class="line"><span class="string">contentType: &quot;</span>application/json;charset=UTF-8<span class="string">&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">â‘¡. 7573è¡Œ var inspectData = s.contentType === &quot;</span>application/x-www-form-urlencoded<span class="string">&quot; &amp;&amp;</span></span><br><span class="line"><span class="string">æ”¹æˆ</span></span><br><span class="line"><span class="string">var inspectData = s.contentType === &quot;</span>application/json;charset=UTF-8<span class="string">&quot; &amp;&amp;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> elasticsearch </category>
          
      </categories>
      
      
        <tags>
            
            <tag> elasticsearch </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nginxè®°å½•</title>
      <link href="/posts/e66d5b16.html"/>
      <url>/posts/e66d5b16.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h2 id="rewrite-åçš„è¯·æ±‚å‚æ•°"><a href="#rewrite-åçš„è¯·æ±‚å‚æ•°" class="headerlink" title="rewrite åçš„è¯·æ±‚å‚æ•°"></a>rewrite åçš„è¯·æ±‚å‚æ•°</h2><p>å¦‚æœæ›¿æ¢å­—ç¬¦ä¸²replacementåŒ…å«æ–°çš„è¯·æ±‚å‚æ•°ï¼Œåˆ™åœ¨å®ƒä»¬ä¹‹åé™„åŠ å…ˆå‰çš„è¯·æ±‚å‚æ•°ã€‚<br>å¦‚æœä½ ä¸æƒ³è¦ä¹‹å‰çš„å‚æ•°ï¼Œåˆ™åœ¨æ›¿æ¢å­—ç¬¦ä¸² replacement çš„æœ«å°¾æ”¾ç½®ä¸€ä¸ªé—®å·ï¼Œé¿å…é™„åŠ å®ƒä»¬ã€‚</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">rewrite</span> regex replacement [flag];</span><br><span class="line"><span class="comment"># ç”±äºæœ€ååŠ äº†ä¸ª ?ï¼ŒåŸæ¥çš„è¯·æ±‚å‚æ•°å°†ä¸ä¼šè¢«è¿½åŠ åˆ°rewriteä¹‹åçš„urlåé¢ </span></span><br><span class="line"><span class="attribute">rewrite</span><span class="regexp"> ^\(.*)$</span> /req?act=<span class="variable">$1</span>? <span class="literal">last</span>;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vagrantæ‰©å……ç¡¬ç›˜</title>
      <link href="/posts/34964111.html"/>
      <url>/posts/34964111.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="è®°å½•åŸå§‹ç¡¬ç›˜çš„uuid"><a href="#è®°å½•åŸå§‹ç¡¬ç›˜çš„uuid" class="headerlink" title="è®°å½•åŸå§‹ç¡¬ç›˜çš„uuid"></a>è®°å½•åŸå§‹ç¡¬ç›˜çš„uuid</h1><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>vboxmanage showhdinfo centos-vm-disk1.vmdk</span><br></pre></td></tr></table></figure><h1 id="åˆ¶ä½œæ‰©å®¹ç¡¬ç›˜"><a href="#åˆ¶ä½œæ‰©å®¹ç¡¬ç›˜" class="headerlink" title="åˆ¶ä½œæ‰©å®¹ç¡¬ç›˜"></a>åˆ¶ä½œæ‰©å®¹ç¡¬ç›˜</h1><h2 id="å°†åŸæœ¬çš„æ ¼å¼è½¬æ¢"><a href="#å°†åŸæœ¬çš„æ ¼å¼è½¬æ¢" class="headerlink" title="å°†åŸæœ¬çš„æ ¼å¼è½¬æ¢"></a>å°†åŸæœ¬çš„æ ¼å¼è½¬æ¢</h2><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vboxmanage centos_centos7onehd <span class="string">&quot;centos-vm-disk1.vmdk&quot;</span> <span class="string">&quot;new-virtualdisk.vdi&quot;</span> <span class="comment">--format vdi</span></span><br></pre></td></tr></table></figure><h2 id="å°†ç¡¬ç›˜å®¹é‡æ‰©å®¹"><a href="#å°†ç¡¬ç›˜å®¹é‡æ‰©å®¹" class="headerlink" title="å°†ç¡¬ç›˜å®¹é‡æ‰©å®¹"></a>å°†ç¡¬ç›˜å®¹é‡æ‰©å®¹</h2><p>å•ä½æ˜¯MB</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vboxmanage modifyhd <span class="string">&quot;new-virtualdisk.vdi&quot;</span> <span class="comment">--resize 30720</span></span><br></pre></td></tr></table></figure><h2 id="ç¡¬ç›˜ç±»å‹è½¬æ¢å›åŸæœ¬"><a href="#ç¡¬ç›˜ç±»å‹è½¬æ¢å›åŸæœ¬" class="headerlink" title="ç¡¬ç›˜ç±»å‹è½¬æ¢å›åŸæœ¬"></a>ç¡¬ç›˜ç±»å‹è½¬æ¢å›åŸæœ¬</h2><p>éå¿…è¦</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ VBoxManage centos_centos7onehd <span class="string">&quot;new-virtualdisk.vdi&quot;</span> <span class="string">&quot;resized.vmdk&quot;</span> <span class="comment">--format vmdk</span></span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨æ–°åˆ¶é€ ç¡¬ç›˜æ›¿æ¢åŸç¡¬ç›˜é‡æ–°æŒ‚è½½ç£ç›˜åˆ°è™šæ‹Ÿæœº"><a href="#ä½¿ç”¨æ–°åˆ¶é€ ç¡¬ç›˜æ›¿æ¢åŸç¡¬ç›˜é‡æ–°æŒ‚è½½ç£ç›˜åˆ°è™šæ‹Ÿæœº" class="headerlink" title="ä½¿ç”¨æ–°åˆ¶é€ ç¡¬ç›˜æ›¿æ¢åŸç¡¬ç›˜é‡æ–°æŒ‚è½½ç£ç›˜åˆ°è™šæ‹Ÿæœº"></a>ä½¿ç”¨æ–°åˆ¶é€ ç¡¬ç›˜æ›¿æ¢åŸç¡¬ç›˜é‡æ–°æŒ‚è½½ç£ç›˜åˆ°è™šæ‹Ÿæœº</h2><p>ä½¿ç”¨å‘½ä»¤æˆ–è€…ç›´æ¥ä¿®æ”¹virtualboxçš„å­˜å‚¨ä¸ºæ‰©å®¹åçš„æ–‡ä»¶</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ VBoxManage storageattach <span class="number">16</span><span class="built_in">c94808-3de9-4de5-8919-d8b875fbc5e9</span>(uuidçš„å€¼) <span class="attr">--storagectl</span> &quot;SATA Controller&quot; <span class="attr">--port</span> <span class="number">0</span> <span class="attr">--device</span> <span class="number">0</span> <span class="attr">--type</span> hdd <span class="attr">--medium</span> resized<span class="selector-class">.vmdk</span></span><br></pre></td></tr></table></figure><h1 id="å°†æ–°ç¡¬ç›˜è½½å…¥"><a href="#å°†æ–°ç¡¬ç›˜è½½å…¥" class="headerlink" title="å°†æ–°ç¡¬ç›˜è½½å…¥"></a>å°†æ–°ç¡¬ç›˜è½½å…¥</h1><h2 id="é‡å¯è™šæ‹Ÿæœº"><a href="#é‡å¯è™šæ‹Ÿæœº" class="headerlink" title="é‡å¯è™šæ‹Ÿæœº"></a>é‡å¯è™šæ‹Ÿæœº</h2><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">vagrant reload</span></span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨fdiskåˆ†åŒºæ‰©å®¹"><a href="#ä½¿ç”¨fdiskåˆ†åŒºæ‰©å®¹" class="headerlink" title="ä½¿ç”¨fdiskåˆ†åŒºæ‰©å®¹"></a>ä½¿ç”¨fdiskåˆ†åŒºæ‰©å®¹</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sudo</span> fdisk -l</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sudo</span> fdisk /dev/sda</span></span><br><span class="line"></span><br><span class="line">æŒ‰pæ˜¾ç¤ºåˆ†åŒºè¡¨ï¼Œé»˜è®¤æ˜¯ sda1 å’Œ sda2ã€‚</span><br><span class="line">æŒ‰næ–°å»ºä¸»åˆ†åŒºã€‚</span><br><span class="line">æŒ‰pè®¾ç½®ä¸ºä¸»åˆ†åŒºã€‚</span><br><span class="line">è¾“å…¥3è®¾ç½®ä¸ºç¬¬ä¸‰åˆ†åŒºã€‚</span><br><span class="line">è¾“å…¥ä¸€æ¬¡å›è½¦è®¾ç½®é»˜è®¤ç£ç›˜ä½ç½®ã€‚</span><br><span class="line">å†è¾“å…¥ä¸€æ¬¡å›è½¦è®¾ç½®é»˜è®¤ç£ç›˜ä½ç½®ã€‚</span><br><span class="line">è¾“å…¥tæ”¹å˜åˆ†åŒºæ ¼å¼</span><br><span class="line">è¾“å…¥3é€‰æ‹©ç¬¬ä¸‰åˆ†åŒº</span><br><span class="line">è¾“å…¥8eæ ¼å¼æˆLVMæ ¼å¼</span><br><span class="line">è¾“å…¥wæ‰§è¡Œä¿å­˜</span><br></pre></td></tr></table></figure><h2 id="é‡å¯è™šæ‹Ÿæœº-1"><a href="#é‡å¯è™šæ‹Ÿæœº-1" class="headerlink" title="é‡å¯è™šæ‹Ÿæœº"></a>é‡å¯è™šæ‹Ÿæœº</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sudo</span> reboot</span></span><br></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹ç¡¬ç›˜ä¿¡æ¯"><a href="#æŸ¥çœ‹ç¡¬ç›˜ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹ç¡¬ç›˜ä¿¡æ¯"></a>æŸ¥çœ‹ç¡¬ç›˜ä¿¡æ¯</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sudo</span> fdisk -l</span></span><br></pre></td></tr></table></figure><h2 id="ç»™æ–°çš„åˆ†åŒºåˆ›å»ºç‰©ç†å·"><a href="#ç»™æ–°çš„åˆ†åŒºåˆ›å»ºç‰©ç†å·" class="headerlink" title="ç»™æ–°çš„åˆ†åŒºåˆ›å»ºç‰©ç†å·"></a>ç»™æ–°çš„åˆ†åŒºåˆ›å»ºç‰©ç†å·</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sudo</span> pvcreate /dev/sda3</span></span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹VG Name</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sudo</span> pvdisplay | grep <span class="string">&quot;VG Name&quot;</span></span></span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹å·ç»„ï¼Œå°†æ–°åˆ†åŒºæ‰©å±•åˆ°VG Nameè¿™ä¸ªç»„</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sudo</span> vgdisplay</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sudo</span> vgextend centos_centos7 /dev/sda3</span></span><br></pre></td></tr></table></figure><p>æ‰©å±•é€»è¾‘åˆ†åŒº</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> lvextend /dev/mapper/centos_centos7-root /dev/sda3</span><br></pre></td></tr></table></figure><p>æ›´æ–°æ–‡ä»¶ç³»ç»Ÿ,resizeå¹¶ä¸”ç”Ÿæ•ˆ<br>centos6</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sudo</span> resize2fs /dev/mapper/centos_centos7-root</span></span><br></pre></td></tr></table></figure><p>centos7</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sudo</span> xfs_growfs /dev/mapper/centos_centos7-root</span></span><br></pre></td></tr></table></figure><p>é‡å¯è™šæ‹Ÿæœº</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>vagrant reload</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> vagrant </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vagrant </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸¤æ•°ä¹‹å’Œ</title>
      <link href="/posts/d98ef1d2.html"/>
      <url>/posts/d98ef1d2.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªæ•´æ•°ç›®æ ‡å€¼ targetï¼Œè¯·ä½ åœ¨è¯¥æ•°ç»„ä¸­æ‰¾å‡º å’Œä¸ºç›®æ ‡å€¼ target  çš„é‚£ ä¸¤ä¸ª æ•´æ•°ï¼Œå¹¶è¿”å›å®ƒä»¬çš„æ•°ç»„ä¸‹æ ‡ã€‚<br>ä½ å¯ä»¥å‡è®¾æ¯ç§è¾“å…¥åªä¼šå¯¹åº”ä¸€ä¸ªç­”æ¡ˆã€‚ä½†æ˜¯ï¼Œæ•°ç»„ä¸­åŒä¸€ä¸ªå…ƒç´ åœ¨ç­”æ¡ˆé‡Œä¸èƒ½é‡å¤å‡ºç°ã€‚<br>ä½ å¯ä»¥æŒ‰ä»»æ„é¡ºåºè¿”å›ç­”æ¡ˆã€‚</p><p>ç¤ºä¾‹:</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums = <span class="comment">[2,7,11,15]</span>, target = 9</span><br><span class="line">è¾“å‡ºï¼š<span class="comment">[0,1]</span></span><br><span class="line">è§£é‡Šï¼šå› ä¸º nums<span class="comment">[0]</span> + nums<span class="comment">[1]</span> == 9 ï¼Œè¿”å› <span class="comment">[0, 1]</span> ã€‚</span><br></pre></td></tr></table></figure><p>æ€è·¯ï¼š</p><ul><li>hashé€šè¿‡ä¸‹æ ‡è·å–æ•°æ®æ—¶é—´å¤æ‚åº¦O(1)</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> Integer[] $nums</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> Integer $target</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Integer[]</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">twoSum</span>(<span class="params"><span class="variable">$nums</span>, <span class="variable">$target</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$dic</span> = [];</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable">$nums</span> <span class="keyword">as</span> <span class="variable">$i</span> =&gt; <span class="variable">$num</span>) &#123;</span><br><span class="line">            <span class="variable">$value</span> = <span class="variable">$target</span> - <span class="variable">$num</span>;</span><br><span class="line">            <span class="comment">// åˆ¤æ–­æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨$valueçš„ä¸‹æ ‡</span></span><br><span class="line">            <span class="comment">// å¦‚æœå­˜åœ¨åˆ™ç›´æ¥è¿”å›ä¸‹æ ‡</span></span><br><span class="line">            <span class="comment">// å¦‚æœä¸å­˜åœ¨åˆ™å°†å½“å‰çš„å€¼ä¸ºkeyï¼Œä¸‹æ ‡ä¸ºvalueå†™å…¥æ•°ç»„</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$dic</span>[<span class="variable">$value</span>])) &#123;</span><br><span class="line">                <span class="keyword">return</span> [<span class="variable">$dic</span>[<span class="variable">$value</span>], <span class="variable">$i</span>];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$dic</span>[<span class="variable">$num</span>] = <span class="variable">$i</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
          <category> é¢˜åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²</title>
      <link href="/posts/4cd9164b.html"/>
      <url>/posts/4cd9164b.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² s ï¼Œè¯·ä½ æ‰¾å‡ºå…¶ä¸­ä¸å«æœ‰é‡å¤å­—ç¬¦çš„ æœ€é•¿å­ä¸² çš„é•¿åº¦ã€‚</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">è¾“å…¥: s = &quot;pwwkew&quot;</span></span><br><span class="line"><span class="section">è¾“å‡º: 3</span></span><br><span class="line"><span class="section">è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ &quot;wke&quot;ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 3ã€‚</span></span><br><span class="line">     è¯·æ³¨æ„ï¼Œä½ çš„ç­”æ¡ˆå¿…é¡»æ˜¯ å­ä¸² çš„é•¿åº¦ï¼Œ<span class="string">&quot;pwke&quot;</span> æ˜¯ä¸€ä¸ªå­åºåˆ—ï¼Œä¸æ˜¯å­ä¸²ã€‚</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> String $s</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> Integer</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">lengthOfLongestSubstring</span>(<span class="params"><span class="variable">$s</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// ç»´æŠ¤ä¸€ä¸ªæ»‘åŠ¨çª—å£ï¼Œçª—å£å†…ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²</span></span><br><span class="line">    <span class="comment">// ä»¥ pwwkew ä¸ºä¾‹ï¼Œéå†æ•´ä¸ªå­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="comment">// left ä¸ºæ»‘åŠ¨çª—å£èµ·ç‚¹ç´¢å¼•ï¼Œ i ä¸ºæ»‘åŠ¨çª—å£ç»ˆç‚¹ç´¢å¼•</span></span><br><span class="line">    <span class="comment">// hash è®°å½•å½“å‰æ»‘åŠ¨çª—å£å†…çš„å­—æ¯ï¼Œé”®ä¸º å­—æ¯ï¼Œå€¼ä¸º ç´¢å¼•</span></span><br><span class="line">    <span class="comment">// å…¨å±€ max è®°å½•çª—å£æœ€å¤§é•¿åº¦</span></span><br><span class="line">    <span class="comment">// left=i=0, çª—å£å†…åªæœ‰ä¸€ä¸ªå­—æ¯ p, length=1, hash=[&#x27;p&#x27; =&gt; 0]</span></span><br><span class="line">    <span class="comment">// left=0, i=1, ç´¢å¼• 1 å¯¹åº”çš„å­—æ¯ w ä¸åœ¨ hash å†…ï¼Œçª—å£å‘å³æ»‘åŠ¨, length=2, hash=[&#x27;p&#x27; =&gt; 0, &#x27;w&#x27; =&gt; 1]</span></span><br><span class="line">    <span class="comment">// left=0, right=2, ç´¢å¼• 2 å¯¹åº”çš„å­—æ¯ w åœ¨ hash å†…,çª—å£èµ·ç‚¹è¦æ›´æ–°ä¸ºä¸Šä¸€ä¸ª w çš„ç´¢å¼•çš„ä¸‹ä¸€ä¸ªä½ç½®,left=hash[&#x27;w&#x27;] + 1.</span></span><br><span class="line">    <span class="comment">// åŒæ—¶ï¼Œ hash[&#x27;w&#x27;] æ›´æ–°ä¸ºæ–°çš„ç´¢å¼• ï¼ŒæŒ‡å‘æœ€åä¸€ä¸ª w, hash=[&#x27;p&#x27; =&gt; 0, &#x27;w&#x27; =&gt; 2]</span></span><br><span class="line">    <span class="variable">$length</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$s</span>);</span><br><span class="line">    <span class="variable">$left</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$hash</span> = [];</span><br><span class="line">    <span class="variable">$max</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$length</span>; ++<span class="variable">$i</span>) &#123;</span><br><span class="line">        <span class="variable">$char</span> = <span class="variable">$s</span>[<span class="variable">$i</span>];</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$hash</span>[<span class="variable">$char</span>])) &#123;</span><br><span class="line">            <span class="variable">$left</span> = <span class="title function_ invoke__">max</span>(<span class="variable">$left</span>, <span class="variable">$hash</span>[<span class="variable">$char</span>] + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç”±äºå‰©ä½™çš„æ•°æ®å¯è¾¾åˆ°çš„æœ€å¤§å­—ç¬¦é•¿åº¦è¶…è¿‡$max,æå‰ç»“æŸéå†</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$left</span> + <span class="variable">$max</span> &gt;= <span class="variable">$length</span>) <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$hash</span>[<span class="variable">$char</span>] = <span class="variable">$i</span>;</span><br><span class="line">        <span class="comment">// å³è¾¹ç´¢å¼• - å·¦è¾¹ç´¢å¼•ï¼Œè®¡ç®—å‡ºç›®å‰æŠ½å±‰é‡Œçš„å€¼çš„ä¸ªæ•°</span></span><br><span class="line">        <span class="variable">$max</span> = <span class="title function_ invoke__">max</span>(<span class="variable">$max</span>, <span class="variable">$i</span> - <span class="variable">$left</span> + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$max</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$str</span> = <span class="string">&quot;pwwkeeww&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">lengthOfLongestSubstring</span>(<span class="variable">$str</span>));</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
          <category> é¢˜åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vscodeä»£ç ç‰‡æ®µ</title>
      <link href="/posts/59473344.html"/>
      <url>/posts/59473344.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="comment">// Place your snippets for markdown here. Each snippet is defined under a snippet name and has a prefix, body and </span></span><br><span class="line"><span class="comment">// description. The prefix is what is used to trigger the snippet and the body will be expanded and inserted. Possible variables are:</span></span><br><span class="line"><span class="comment">// $1, $2 for tab stops, $0 for the final cursor position, and $&#123;1:label&#125;, $&#123;2:another&#125; for placeholders. Placeholders with the </span></span><br><span class="line"><span class="comment">// same ids are connected.</span></span><br><span class="line"><span class="comment">// Example:</span></span><br><span class="line"><span class="string">&quot;markdown&quot;</span>: &#123;</span><br><span class="line"><span class="string">&quot;prefix&quot;</span>: <span class="string">&quot;markdown&quot;</span>,</span><br><span class="line"><span class="string">&quot;body&quot;</span>: [</span><br><span class="line"><span class="string">&quot;---&quot;</span>,</span><br><span class="line"><span class="string">&quot;title: &quot;</span>,</span><br><span class="line"><span class="string">&quot;date: &#123;&#123;Date&#125;&#125;&quot;</span>,</span><br><span class="line">  <span class="string">&quot;&quot;</span>,</span><br><span class="line"><span class="string">&quot;tags:&quot;</span>,</span><br><span class="line">  <span class="string">&quot;- &quot;</span>,</span><br><span class="line"><span class="string">&quot;categories:&quot;</span>,</span><br><span class="line">  <span class="string">&quot;- &quot;</span></span><br><span class="line"><span class="string">&quot;---&quot;</span>,</span><br><span class="line"><span class="string">&quot;&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;&quot;</span>,</span><br><span class="line"><span class="string">&quot;&quot;</span>,</span><br><span class="line"><span class="string">&quot;&lt;!-- more --&gt;&quot;</span>,</span><br><span class="line"><span class="string">&quot;&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;&quot;</span>,</span><br><span class="line"><span class="string">&quot;<span class="subst">\n</span>&quot;</span>,</span><br><span class="line">],</span><br><span class="line"><span class="string">&quot;description&quot;</span>: <span class="string">&quot;markdown header template&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å…¶ä»– </category>
          
          <category> vscode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vscode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¿œç¨‹ç™»å½•é…ç½®</title>
      <link href="/posts/3f8e3d32.html"/>
      <url>/posts/3f8e3d32.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Host vagrant</span><br><span class="line">  HostName 127.0.0.1</span><br><span class="line"> <span class="built_in"> User </span>vagrant</span><br><span class="line"> <span class="built_in"> Port </span>2222</span><br><span class="line">  UserKnownHostsFile /dev/<span class="literal">null</span></span><br><span class="line">  StrictHostKeyChecking <span class="literal">no</span></span><br><span class="line">  PasswordAuthentication <span class="literal">no</span></span><br><span class="line">  IdentityFile G:/vagrantVMS/boxes/centos7-v1/0/virtualbox/vagrant_private_key</span><br><span class="line">  IdentitiesOnly <span class="literal">yes</span></span><br><span class="line">  LogLevel FATAL</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…å¯†ç™»å½•</span></span><br><span class="line">Host docker-php</span><br><span class="line">  HostName 172.18.0.1</span><br><span class="line"> <span class="built_in"> Port </span>2233</span><br><span class="line"> <span class="built_in"> User </span>root</span><br><span class="line">  IdentitiesOnly <span class="literal">yes</span></span><br><span class="line">  LogLevel FATAL</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å…¶ä»– </category>
          
          <category> vscode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vscode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pgrep</title>
      <link href="/posts/86fb8a88.html"/>
      <url>/posts/86fb8a88.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h1><p>pgrepæ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå®ç”¨ç¨‹åºï¼Œå¯è®©æ‚¨æ ¹æ®ç»™å®šçš„æ¡ä»¶æŸ¥æ‰¾æ­£åœ¨è¿è¡Œçš„ç¨‹åºçš„è¿›ç¨‹IDã€‚</p><ul><li>dè®¾ç½®ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨äºåˆ†éš”è¾“å‡ºçš„æ¯ä¸ªè¿›ç¨‹ID</li><li>fæ¨¡å¼å‚æ•°ä»…ç”¨äºåŒ¹é…è¿›ç¨‹å</li><li>Iåˆ—å‡ºè¿›ç¨‹ååŠè¿›ç¨‹ID</li><li>Pä»…é€‰æ‹©åŒ¹é…æŒ‡å®šçˆ¶è¿›ç¨‹IDçš„è¿›ç¨‹</li><li>ué€‰æ‹©ä»…åŒ¹é…æŒ‡å®šæœ‰æ•ˆç”¨æˆ·IDè¿›ç¨‹</li><li>Ué€‰æ‹©ä»…åŒ¹é…æŒ‡å®šçœŸå®ç”¨æˆ·IDçš„è¿›ç¨‹</li></ul>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>top</title>
      <link href="/posts/1ed91fca.html"/>
      <url>/posts/1ed91fca.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="è¯­æ³•è¯´æ˜"><a href="#è¯­æ³•è¯´æ˜" class="headerlink" title="è¯­æ³•è¯´æ˜"></a>è¯­æ³•è¯´æ˜</h1><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">top</span> <span class="selector-attr">[-]</span> <span class="selector-attr">[d delay]</span> <span class="selector-attr">[q]</span> <span class="selector-attr">[c]</span> <span class="selector-attr">[S]</span> <span class="selector-attr">[s]</span> <span class="selector-attr">[i]</span> <span class="selector-attr">[n]</span> <span class="selector-attr">[b]</span></span><br></pre></td></tr></table></figure><h1 id="å‚æ•°è¯´æ˜ï¼š"><a href="#å‚æ•°è¯´æ˜ï¼š" class="headerlink" title="å‚æ•°è¯´æ˜ï¼š"></a>å‚æ•°è¯´æ˜ï¼š</h1><ul><li>d : æ”¹å˜æ˜¾ç¤ºçš„æ›´æ–°é€Ÿåº¦ï¼Œæˆ–æ˜¯åœ¨äº¤è°ˆå¼æŒ‡ä»¤åˆ—( interactive command)æŒ‰ s</li><li>q : æ²¡æœ‰ä»»ä½•å»¶è¿Ÿçš„æ˜¾ç¤ºé€Ÿåº¦ï¼Œå¦‚æœä½¿ç”¨è€…æ˜¯æœ‰ superuser çš„æƒé™ï¼Œåˆ™ top å°†ä¼šä»¥æœ€é«˜çš„ä¼˜å…ˆåºæ‰§è¡Œ</li><li>c : åˆ‡æ¢æ˜¾ç¤ºæ¨¡å¼ï¼Œå…±æœ‰ä¸¤ç§æ¨¡å¼ï¼Œä¸€æ˜¯åªæ˜¾ç¤ºæ‰§è¡Œæ¡£çš„åç§°ï¼Œå¦ä¸€ç§æ˜¯æ˜¾ç¤ºå®Œæ•´çš„è·¯å¾„ä¸åç§°</li><li>S : ç´¯ç§¯æ¨¡å¼ï¼Œä¼šå°†å·±å®Œæˆæˆ–æ¶ˆå¤±çš„å­è¿›ç¨‹ ( dead child process ) çš„ CPU time ç´¯ç§¯èµ·æ¥</li><li>s : å®‰å…¨æ¨¡å¼ï¼Œå°†äº¤è°ˆå¼æŒ‡ä»¤å–æ¶ˆ, é¿å…æ½œåœ¨çš„å±æœº</li><li>i : ä¸æ˜¾ç¤ºä»»ä½•é—²ç½® (idle) æˆ–æ— ç”¨ (zombie) çš„è¿›ç¨‹</li><li>n : æ›´æ–°çš„æ¬¡æ•°ï¼Œå®Œæˆåå°†ä¼šé€€å‡º top</li><li>b : æ‰¹æ¬¡æ¡£æ¨¡å¼ï¼Œæ­é… â€œnâ€ å‚æ•°ä¸€èµ·ä½¿ç”¨ï¼Œå¯ä»¥ç”¨æ¥å°† top çš„ç»“æœè¾“å‡ºåˆ°æ¡£æ¡ˆå†…</li></ul><h1 id="é€šè¿‡åŒ¹é…æŸ¥çœ‹"><a href="#é€šè¿‡åŒ¹é…æŸ¥çœ‹" class="headerlink" title="é€šè¿‡åŒ¹é…æŸ¥çœ‹"></a>é€šè¿‡åŒ¹é…æŸ¥çœ‹</h1><h3 id="ä½¿ç”¨pgrepæ¥è·å¾—åŒ¹é…å‘½ä»¤è¡Œçš„pidï¼š"><a href="#ä½¿ç”¨pgrepæ¥è·å¾—åŒ¹é…å‘½ä»¤è¡Œçš„pidï¼š" class="headerlink" title="ä½¿ç”¨pgrepæ¥è·å¾—åŒ¹é…å‘½ä»¤è¡Œçš„pidï¼š"></a>ä½¿ç”¨pgrepæ¥è·å¾—åŒ¹é…å‘½ä»¤è¡Œçš„pidï¼š</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$</span> top <span class="literal">-c</span> <span class="literal">-p</span> <span class="variable">$</span>(pgrep <span class="literal">-d</span><span class="string">&#x27;,&#x27;</span> <span class="operator">-f</span> COMMANDä¸­éœ€è¦åŒ¹é…çš„æ–‡å­—) </span><br></pre></td></tr></table></figure><h3 id="äº¤äº’æ–¹å¼"><a href="#äº¤äº’æ–¹å¼" class="headerlink" title="äº¤äº’æ–¹å¼"></a>äº¤äº’æ–¹å¼</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ top -c</span><br><span class="line">è¾“å…¥oï¼Œå†™å…¥<span class="attribute">COMMAND</span>=éœ€è¦åŒ¹é…çš„æ–‡å­—</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è·å–ç¡¬ç›˜ç±»å‹</title>
      <link href="/posts/551b1547.html"/>
      <url>/posts/551b1547.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h1><p>åˆ¤æ–­cat &#x2F;sys&#x2F;block&#x2F;<em>&#x2F;queue&#x2F;rotationalçš„è¿”å›å€¼ï¼ˆå…¶ä¸­</em>ä¸ºä½ çš„ç¡¬ç›˜è®¾å¤‡åç§°ï¼Œä¾‹å¦‚sdaç­‰ç­‰ï¼‰ï¼Œå¦‚æœè¿”å›1 åˆ™è¡¨ç¤ºç£ç›˜å¯æ—‹è½¬ï¼Œé‚£ä¹ˆå°±æ˜¯HDDäº†ï¼›<br>å¦‚æœè¿”å›0ï¼Œåˆ™è¡¨ç¤ºç£ç›˜ä¸å¯ä»¥æ—‹è½¬ï¼Œé‚£ä¹ˆå°±æ˜¯SSDäº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ cat /sys/block/sda/queue/rotational</span><br><span class="line">0</span><br><span class="line">$ grep ^ /sys/block/*/queue/rotational</span><br><span class="line">/sys/block/ram0/queue/rotational:1</span><br><span class="line">/sys/block/sda/queue/rotational:0</span><br><span class="line">/sys/block/sdb/queue/rotational:0</span><br><span class="line">/sys/block/sdc/queue/rotational:0</span><br><span class="line">/sys/block/sdd/queue/rotational:0</span><br></pre></td></tr></table></figure><p>è¿™ç§æ–¹æ³•æœ‰ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯&#x2F;sys&#x2F;block&#x2F;ä¸‹é¢ä¸åªæœ‰ç¡¬ç›˜ï¼Œè¿˜å¯èƒ½æœ‰åˆ«çš„å—è®¾å¤‡ï¼Œå®ƒä»¬éƒ½åœ¨å¹²æ‰°ä½ çš„åˆ¤æ–­ã€‚</p><h1 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h1><p>ä½¿ç”¨lsblkå‘½ä»¤è¿›è¡Œåˆ¤æ–­ï¼Œå‚æ•°-dè¡¨ç¤ºæ˜¾ç¤ºè®¾å¤‡åç§°ï¼Œå‚æ•°-oè¡¨ç¤ºä»…æ˜¾ç¤ºç‰¹å®šçš„åˆ—ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ lsblk -d -o name,rota</span><br><span class="line">NAME ROTA</span><br><span class="line">sda 0</span><br><span class="line">sdb 0</span><br><span class="line">sdc 0</span><br><span class="line">sdd 0</span><br></pre></td></tr></table></figure><p>è¿™ç§æ–¹æ³•çš„ä¼˜åŠ¿åœ¨äºå®ƒåªåˆ—å‡ºäº†ä½ è¦çœ‹çš„å†…å®¹ï¼Œç»“æœæ¯”è¾ƒç®€æ´æ˜äº†ã€‚è¿˜æ˜¯é‚£ä¸ªè§„åˆ™ï¼ŒROTAæ˜¯1çš„è¡¨ç¤ºå¯ä»¥æ—‹è½¬ï¼Œåä¹‹åˆ™ä¸èƒ½æ—‹è½¬ã€‚</p><h1 id="æ–¹æ³•ä¸‰"><a href="#æ–¹æ³•ä¸‰" class="headerlink" title="æ–¹æ³•ä¸‰"></a>æ–¹æ³•ä¸‰</h1><p>å¯ä»¥é€šè¿‡fdiskå‘½ä»¤æŸ¥çœ‹ï¼Œå‚æ•°-lè¡¨ç¤ºåˆ—å‡ºç£ç›˜è¯¦æƒ…ã€‚åœ¨è¾“å‡ºç»“æœä¸­ï¼Œä»¥Diskå¼€å¤´çš„è¡Œè¡¨ç¤ºç£ç›˜ç®€ä»‹ï¼Œä¸‹é¢æ˜¯ä¸€äº›è¯¦ç»†å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥è¯•ç€åœ¨è¿™äº›å‚æ•°ä¸­å¯»æ‰¾ä¸€äº›HDDç‰¹æœ‰çš„å…³é”®å­—ï¼Œæ¯”å¦‚ï¼šâ€headsâ€ï¼ˆç£å¤´ï¼‰ï¼Œâ€trackâ€ï¼ˆç£é“ï¼‰å’Œâ€cylindersâ€ï¼ˆæŸ±é¢ï¼‰ã€‚  </p><p>ä¸‹é¢åˆ†åˆ«æ˜¯HDDå’ŒSSDçš„è¾“å‡ºç»“æœ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Disk /dev/sda: 120.0 GB, 120034123776 bytes</span><br><span class="line">255 heads, 63 sectors/track, 14593 cylinders</span><br><span class="line">Units = cylinders of 16065 * 512 = 8225280 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disk identifier: 0x00074f7d</span><br><span class="line">$ sudo fdisk -l</span><br><span class="line">Disk /dev/nvme0n1: 238.5 GiB, 256060514304 bytes, 500118192 sectors</span><br><span class="line">Units: sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disklabel type: dos</span><br><span class="line">Disk identifier: 0xad91c214</span><br><span class="line">......</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>proxy gfwlist</title>
      <link href="/posts/40f710d0.html"/>
      <url>/posts/40f710d0.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="è§„åˆ™è®¢é˜…åœ°å€"><a href="#è§„åˆ™è®¢é˜…åœ°å€" class="headerlink" title="è§„åˆ™è®¢é˜…åœ°å€"></a>è§„åˆ™è®¢é˜…åœ°å€</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//</span>raw.githubusercontent.com<span class="regexp">/gfwlist/g</span>fwlist<span class="regexp">/master/g</span>fwlist.txt </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å…¶ä»– </category>
          
          <category> æµè§ˆå™¨æ‰©å±• </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>vscode debugé…ç½®</title>
      <link href="/posts/9ba392b9.html"/>
      <url>/posts/9ba392b9.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;version&quot;</span>: <span class="string">&quot;0.2.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;configurations&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Python:&quot;</span>,</span><br><span class="line">            <span class="string">&quot;type&quot;</span>: <span class="string">&quot;python&quot;</span>,</span><br><span class="line">            <span class="string">&quot;request&quot;</span>: <span class="string">&quot;launch&quot;</span>,</span><br><span class="line">            <span class="string">&quot;program&quot;</span>: <span class="string">&quot;<span class="variable">$&#123;file&#125;</span>&quot;</span>,</span><br><span class="line">            <span class="string">&quot;console&quot;</span>: <span class="string">&quot;integratedTerminal&quot;</span>,</span><br><span class="line">            <span class="string">&quot;env&quot;</span>: &#123;<span class="string">&quot;PYTHONPATH&quot;</span>:<span class="string">&quot;<span class="variable">$&#123;workspaceRoot&#125;</span>&quot;</span>&#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;name&quot;</span>: <span class="string">&quot;scrapy&quot;</span>,</span><br><span class="line">            <span class="string">&quot;type&quot;</span>: <span class="string">&quot;python&quot;</span>,</span><br><span class="line">            <span class="string">&quot;request&quot;</span>: <span class="string">&quot;launch&quot;</span>,</span><br><span class="line">            <span class="string">&quot;module&quot;</span>: <span class="string">&quot;scrapy&quot;</span>,</span><br><span class="line">            <span class="string">&quot;args&quot;</span>: [</span><br><span class="line">                <span class="string">&quot;crawl&quot;</span>,</span><br><span class="line">                <span class="string">&quot;spiderCommon&quot;</span></span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;name&quot;</span>: <span class="string">&quot;php xdebug&quot;</span>,</span><br><span class="line">            <span class="string">&quot;type&quot;</span>: <span class="string">&quot;php&quot;</span>,</span><br><span class="line">            <span class="string">&quot;request&quot;</span>: <span class="string">&quot;launch&quot;</span>,</span><br><span class="line">            <span class="string">&quot;program&quot;</span>: <span class="string">&quot;<span class="variable">$&#123;file&#125;</span>&quot;</span>,</span><br><span class="line">            <span class="string">&quot;cwd&quot;</span>: <span class="string">&quot;<span class="variable">$&#123;fileDirname&#125;</span>&quot;</span>,</span><br><span class="line">            <span class="string">&quot;port&quot;</span>: 9100</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å…¶ä»– </category>
          
          <category> vscode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vscode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vscode é…ç½®</title>
      <link href="/posts/6284dd81.html"/>
      <url>/posts/6284dd81.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;cmake-tools-helper.cmake_download_path&quot;</span>: <span class="string">&quot;c:<span class="char escape_">\\</span>Users<span class="char escape_">\\</span>Administrator<span class="char escape_">\\</span>.vscode<span class="char escape_">\\</span>extensions<span class="char escape_">\\</span>maddouri.cmake-tools-helper-0.2.1<span class="char escape_">\\</span>cmake_download&quot;</span>,</span><br><span class="line">    <span class="string">&quot;remote.SSH.configFile&quot;</span>: <span class="string">&quot;C:<span class="char escape_">\\</span>Users<span class="char escape_">\\</span>Administrator<span class="char escape_">\\</span>.ssh<span class="char escape_">\\</span>config&quot;</span>,</span><br><span class="line">    <span class="string">&quot;terminal.integrated.shell.windows&quot;</span>: <span class="string">&quot;D:<span class="char escape_">\\</span>Program Files<span class="char escape_">\\</span>Git<span class="char escape_">\\</span>bin<span class="char escape_">\\</span>sh.exe&quot;</span>,</span><br><span class="line">    <span class="string">&quot;remote.SSH.path&quot;</span>: <span class="string">&quot;D:<span class="char escape_">\\</span>Program Files<span class="char escape_">\\</span>Git<span class="char escape_">\\</span>usr<span class="char escape_">\\</span>bin<span class="char escape_">\\</span>ssh.exe&quot;</span>,</span><br><span class="line">    <span class="string">&quot;python.pythonPath&quot;</span>: <span class="string">&quot;/usr/bin/python3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;deploy&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;targets&quot;</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">&quot;type&quot;</span>: <span class="string">&quot;sftp&quot;</span>,</span><br><span class="line">                <span class="string">&quot;name&quot;</span>: <span class="string">&quot;pythonpachong&quot;</span>,</span><br><span class="line">                <span class="string">&quot;description&quot;</span>: <span class="string">&quot;212 python pachong&quot;</span>,</span><br><span class="line">                <span class="string">&quot;dir&quot;</span>: <span class="string">&quot;/data/http/python/pachong&quot;</span>,</span><br><span class="line">                <span class="string">&quot;host&quot;</span>: <span class="string">&quot;192.168.1.212&quot;</span>, <span class="string">&quot;port&quot;</span>: <span class="number">22</span>,</span><br><span class="line">                <span class="string">&quot;user&quot;</span>: <span class="string">&quot;root&quot;</span>, <span class="string">&quot;password&quot;</span>: <span class="string">&quot;Csh917-server&quot;</span>,</span><br><span class="line"></span><br><span class="line">                <span class="string">&quot;checkBeforeDeploy&quot;</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">                <span class="string">&quot;mappings&quot;</span>: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="string">&quot;source&quot;</span>: <span class="string">&quot;E:<span class="char escape_">\\</span>work<span class="char escape_">\\</span>wamp<span class="char escape_">\\</span>www<span class="char escape_">\\</span>python<span class="char escape_">\\</span>pachong&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;target&quot;</span>: <span class="string">&quot;/data/http/python/pachong&quot;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å…¶ä»– </category>
          
          <category> vscode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vscode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windowså®¿ä¸»æœºè®¿é—®è™šæ‹Ÿæœºä¸­çš„dockeræœåŠ¡</title>
      <link href="/posts/e5d94df7.html"/>
      <url>/posts/e5d94df7.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h2 id="æœåŠ¡å™¨ifconfigä¿¡æ¯"><a href="#æœåŠ¡å™¨ifconfigä¿¡æ¯" class="headerlink" title="æœåŠ¡å™¨ifconfigä¿¡æ¯"></a>æœåŠ¡å™¨ifconfigä¿¡æ¯</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">br</span>-<span class="number">9</span>d1a3752f9ed: flags=<span class="number">4163</span>&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu <span class="number">1500</span></span><br><span class="line">        <span class="attribute">inet</span> <span class="number">172.19.0.1</span>  netmask <span class="number">255.255.0.0</span>  broadcast <span class="number">172.19.255.255</span></span><br><span class="line">        <span class="attribute">ether</span> <span class="number">02</span>:<span class="number">42</span>:c5:<span class="number">80</span>:<span class="number">3</span>f:<span class="number">8</span>b  txqueuelen <span class="number">0</span>  (Ethernet)</span><br><span class="line">        <span class="attribute">RX</span> packets <span class="number">0</span>  bytes <span class="number">0</span> (<span class="number">0</span>.<span class="number">0</span> B)</span><br><span class="line">        <span class="attribute">RX</span> errors <span class="number">0</span>  dropped <span class="number">0</span>  overruns <span class="number">0</span>  frame <span class="number">0</span></span><br><span class="line">        <span class="attribute">TX</span> packets <span class="number">0</span>  bytes <span class="number">0</span> (<span class="number">0</span>.<span class="number">0</span> B)</span><br><span class="line">        <span class="attribute">TX</span> errors <span class="number">0</span>  dropped <span class="number">0</span> overruns <span class="number">0</span>  carrier <span class="number">0</span>  collisions <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">docker0</span>: flags=<span class="number">4099</span>&lt;UP,BROADCAST,MULTICAST&gt;  mtu <span class="number">1500</span></span><br><span class="line">        <span class="attribute">inet</span> <span class="number">172.17.0.1</span>  netmask <span class="number">255.255.0.0</span>  broadcast <span class="number">172.17.255.255</span></span><br><span class="line">        <span class="attribute">ether</span> <span class="number">02</span>:<span class="number">42</span>:<span class="number">7</span>e:a0:<span class="number">98</span>:<span class="number">91</span>  txqueuelen <span class="number">0</span>  (Ethernet)</span><br><span class="line">        <span class="attribute">RX</span> packets <span class="number">0</span>  bytes <span class="number">0</span> (<span class="number">0</span>.<span class="number">0</span> B)</span><br><span class="line">        <span class="attribute">RX</span> errors <span class="number">0</span>  dropped <span class="number">0</span>  overruns <span class="number">0</span>  frame <span class="number">0</span></span><br><span class="line">        <span class="attribute">TX</span> packets <span class="number">0</span>  bytes <span class="number">0</span> (<span class="number">0</span>.<span class="number">0</span> B)</span><br><span class="line">        <span class="attribute">TX</span> errors <span class="number">0</span>  dropped <span class="number">0</span> overruns <span class="number">0</span>  carrier <span class="number">0</span>  collisions <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">eth0</span>: flags=<span class="number">4163</span>&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu <span class="number">1500</span></span><br><span class="line">        <span class="attribute">inet</span> <span class="number">10.0.2.15</span>  netmask <span class="number">255.255.255.0</span>  broadcast <span class="number">10.0.2.255</span></span><br><span class="line">        <span class="attribute">ether</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:<span class="number">98</span>:a2:<span class="number">83</span>  txqueuelen <span class="number">1000</span>  (Ethernet)</span><br><span class="line">        <span class="attribute">RX</span> packets <span class="number">983</span>  bytes <span class="number">118711</span> (<span class="number">115</span>.<span class="number">9</span> KiB)</span><br><span class="line">        <span class="attribute">RX</span> errors <span class="number">0</span>  dropped <span class="number">0</span>  overruns <span class="number">0</span>  frame <span class="number">0</span></span><br><span class="line">        <span class="attribute">TX</span> packets <span class="number">695</span>  bytes <span class="number">128882</span> (<span class="number">125</span>.<span class="number">8</span> KiB)</span><br><span class="line">        <span class="attribute">TX</span> errors <span class="number">0</span>  dropped <span class="number">0</span> overruns <span class="number">0</span>  carrier <span class="number">0</span>  collisions <span class="number">0</span></span><br></pre></td></tr></table></figure><h2 id="windows-ä¸»æœºip"><a href="#windows-ä¸»æœºip" class="headerlink" title="windows ä¸»æœºip"></a>windows ä¸»æœºip</h2><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">inet</span> <span class="number">172.28.128.3</span></span><br><span class="line">netmask <span class="number">255.255.255.0</span></span><br></pre></td></tr></table></figure><h2 id="windowsä¸»æœºä¸­æ·»åŠ è·¯ç”±"><a href="#windowsä¸»æœºä¸­æ·»åŠ è·¯ç”±" class="headerlink" title="windowsä¸»æœºä¸­æ·»åŠ è·¯ç”±"></a>windowsä¸»æœºä¸­æ·»åŠ è·¯ç”±</h2><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># ç®¡ç†å‘˜æƒé™ä¸‹è¿è¡Œ</span><br><span class="line"># route -p add dockerçš„ip mask <span class="number">255</span>.<span class="number">255</span>.<span class="number">0</span>.<span class="number">0</span> æœåŠ¡å™¨çš„ip</span><br><span class="line"># ä¾‹å¦‚ä½¿ç”¨çš„ç½‘ç»œæ˜¯docker0ï¼Œåˆ™ä½¿ç”¨docker0çš„inetå’Œnetmask</span><br><span class="line">$ route -p add <span class="number">172</span>.<span class="number">17</span>.<span class="number">0</span>.<span class="number">0</span> mask <span class="number">255</span>.<span class="number">255</span>.<span class="number">0</span>.<span class="number">0</span> <span class="number">172</span>.<span class="number">28</span>.<span class="number">128</span>.<span class="number">3</span></span><br><span class="line">$ <span class="built_in">ping</span> <span class="number">172</span>.<span class="number">17</span>.<span class="number">0</span>.<span class="number">1</span></span><br><span class="line"># åˆ é™¤ä½¿ç”¨route delete ç›®æ ‡ip</span><br><span class="line"># route delete <span class="number">172</span>.<span class="number">17</span>.<span class="number">0</span>.<span class="number">0</span></span><br><span class="line">$ </span><br></pre></td></tr></table></figure><h2 id="æµ‹è¯•é“¾æ¥"><a href="#æµ‹è¯•é“¾æ¥" class="headerlink" title="æµ‹è¯•é“¾æ¥"></a>æµ‹è¯•é“¾æ¥</h2><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># ä½¿ç”¨çš„æ˜¯docker0çš„ç½‘ç»œ</span><br><span class="line">$ ssh root@<span class="number">172</span>.<span class="number">17</span>.<span class="number">0</span>.<span class="number">1</span> -p2233</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> Docker </category>
          
          <category> sshd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dockerèµ„æ–™æ•´ç†</title>
      <link href="/posts/a76edd6f.html"/>
      <url>/posts/a76edd6f.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="åœ¨alpineç‰ˆæœ¬çš„é•œåƒä¸­å®‰è£…bash"><a href="#åœ¨alpineç‰ˆæœ¬çš„é•œåƒä¸­å®‰è£…bash" class="headerlink" title="åœ¨alpineç‰ˆæœ¬çš„é•œåƒä¸­å®‰è£…bash"></a>åœ¨alpineç‰ˆæœ¬çš„é•œåƒä¸­å®‰è£…bash</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker <span class="built_in">exec</span> -ti 8a7b3af22d0b apk add --no-cache bash</span><br></pre></td></tr></table></figure><h1 id="å®¿ä¸»æœºå¼€æœºå¯åŠ¨dockerå†…éƒ¨å‘½ä»¤-ä¸èƒ½åŠ t"><a href="#å®¿ä¸»æœºå¼€æœºå¯åŠ¨dockerå†…éƒ¨å‘½ä»¤-ä¸èƒ½åŠ t" class="headerlink" title="å®¿ä¸»æœºå¼€æœºå¯åŠ¨dockerå†…éƒ¨å‘½ä»¤(ä¸èƒ½åŠ t)"></a>å®¿ä¸»æœºå¼€æœºå¯åŠ¨dockerå†…éƒ¨å‘½ä»¤(ä¸èƒ½åŠ t)</h1><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -i xx</span><br></pre></td></tr></table></figure><h1 id="å¤„ç†nginx-confä¿®æ”¹åå®¹å™¨å†…éƒ¨æ²¡åŒæ­¥"><a href="#å¤„ç†nginx-confä¿®æ”¹åå®¹å™¨å†…éƒ¨æ²¡åŒæ­¥" class="headerlink" title="å¤„ç†nginx.confä¿®æ”¹åå®¹å™¨å†…éƒ¨æ²¡åŒæ­¥"></a>å¤„ç†nginx.confä¿®æ”¹åå®¹å™¨å†…éƒ¨æ²¡åŒæ­¥</h1><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¿®æ”¹æ–‡ä»¶æƒé™ï¼Œç„¶åé‡å¯å®¹å™¨åï¼Œå¯ä»¥åŒæ­¥ï¼Œå…¶ä»–æ–‡ä»¶ä¹Ÿå¯èƒ½å­˜åœ¨ä¸€æ ·çš„æƒ…å†µ</span></span><br><span class="line">chmod 666 nginx.conf</span><br></pre></td></tr></table></figure><h1 id="dockeræ–‡ä»¶æŒ‚è½½é—®é¢˜"><a href="#dockeræ–‡ä»¶æŒ‚è½½é—®é¢˜" class="headerlink" title="dockeræ–‡ä»¶æŒ‚è½½é—®é¢˜"></a>dockeræ–‡ä»¶æŒ‚è½½é—®é¢˜</h1><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dockeræ¨èæŒ‚è½½æ–‡ä»¶å¤¹ï¼Œdockeråœ¨è¿›è¡Œæ–‡ä»¶æŒ‚è½½æ—¶ï¼Œå¹¶ä¸æ˜¯ä»…ä»…æŒ‚è½½æ–‡ä»¶ååˆ°å¯¹åº”ä½ç½®ï¼Œè€Œæ˜¯å°†æ–‡ä»¶å¯¹åº”çš„inode è¿›è¡Œæ˜ å°„ã€‚</span><br></pre></td></tr></table></figure><h1 id="ä¸­æ–‡ä¹±ç å¤„ç†"><a href="#ä¸­æ–‡ä¹±ç å¤„ç†" class="headerlink" title="ä¸­æ–‡ä¹±ç å¤„ç†"></a>ä¸­æ–‡ä¹±ç å¤„ç†</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">1.ä¸´æ—¶ä¿®æ”¹ï¼š</span><br><span class="line">locale</span><br><span class="line">locale -a</span><br><span class="line"><span class="attribute">LANG</span>=C.UTF-8  (æœ‰çš„æ˜¯zh_CN.UTF-8ï¼Œä¸è¿‡æˆ‘åœ¨æœ¬åœ°æ²¡å‘ç°è¿™ç§ç¼–ç )</span><br><span class="line">source /etc<span class="built_in">/profile</span></span><br><span class="line"><span class="built_in"></span></span><br><span class="line"><span class="comment"># æ°¸ä¹…ä¿®æ”¹ï¼šä¿®æ”¹Dockerfile</span></span><br><span class="line">åœ¨Dockerfileä¸­æ·»åŠ ä¸€è¡Œ</span><br><span class="line">ENV LANG C.UTF-8</span><br><span class="line"></span><br><span class="line"><span class="comment"># docker-compose.yml ä¸­</span></span><br><span class="line">environment:</span><br><span class="line">      LANG: <span class="string">&quot;C.UTF-8&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># dockerå‘½ä»¤</span></span><br><span class="line">docker exec å®¹å™¨åç§° env <span class="attribute">LANG</span>=C.UTF-8 bash</span><br></pre></td></tr></table></figure><h1 id="å¯ç”¨systemctl"><a href="#å¯ç”¨systemctl" class="headerlink" title="å¯ç”¨systemctl"></a>å¯ç”¨systemctl</h1><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">entrypoint: [<span class="string">&quot;/usr/sbin/init&quot;</span>] # ä¿®æ”¹æ—©æœŸçš„ docker run å‘½ä»¤ï¼Œå¹¶å°†<span class="regexp">/usr/</span>sbin<span class="operator">/</span><span class="keyword">init</span> ä½œä¸ºå‘½ä»¤(<span class="type">CMD</span>)ä¼ é€’ç»™å®¹å™¨å†…æ”¯æŒ <span class="type">Systemd</span> <span class="keyword">init</span> è¿›ç¨‹çš„ç”¨æˆ·<span class="operator">ã€‚</span></span><br></pre></td></tr></table></figure><h1 id="å®¹å™¨èµ‹äºˆrootæƒé™"><a href="#å®¹å™¨èµ‹äºˆrootæƒé™" class="headerlink" title="å®¹å™¨èµ‹äºˆrootæƒé™"></a>å®¹å™¨èµ‹äºˆrootæƒé™</h1><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">privileged</span>: <span class="keyword">true</span></span><br></pre></td></tr></table></figure><h1 id="è¿è¡Œmysqlå®¹å™¨å¤±è´¥"><a href="#è¿è¡Œmysqlå®¹å™¨å¤±è´¥" class="headerlink" title="è¿è¡Œmysqlå®¹å™¨å¤±è´¥"></a>è¿è¡Œmysqlå®¹å™¨å¤±è´¥</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqld <span class="attribute">--user</span>=root</span><br></pre></td></tr></table></figure><h1 id="åå°è¿è¡Œnginxå®¹å™¨"><a href="#åå°è¿è¡Œnginxå®¹å™¨" class="headerlink" title="åå°è¿è¡Œnginxå®¹å™¨"></a>åå°è¿è¡Œnginxå®¹å™¨</h1><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nginx</span> -g daemon <span class="literal">off</span></span><br></pre></td></tr></table></figure><h1 id="O-perating-system-error-number-22-in-a-file-operation"><a href="#O-perating-system-error-number-22-in-a-file-operation" class="headerlink" title="O#perating system error number 22 in a file operation"></a>O#perating system error number 22 in a file operation</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker-composeæ–‡ä»¶ä¸­æ·»åŠ </span><br><span class="line">command: <span class="attribute">--default-authentication-plugin</span>=mysql_native_password <span class="attribute">--innodb-use-native-aio</span>=0</span><br></pre></td></tr></table></figure><h1 id="æ— æ³•è®¿é—®å±€åŸŸç½‘å†…çš„ip"><a href="#æ— æ³•è®¿é—®å±€åŸŸç½‘å†…çš„ip" class="headerlink" title="æ— æ³•è®¿é—®å±€åŸŸç½‘å†…çš„ip"></a>æ— æ³•è®¿é—®å±€åŸŸç½‘å†…çš„ip</h1><p>å¼€å¯è·¯ç”±è½¬å‘åŠŸèƒ½</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1. ä¸´æ—¶å¼€å¯</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="string">&quot;1&quot;</span> &gt; /proc/sys/net/ipv4/ip_forward</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2. æ°¸ä¹…å¼€å¯</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="string">&quot;net.ipv4.ip_forward = 1&quot;</span> &gt;&gt; /etc/sysctl.conf</span> </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åŠ è½½ï¼Œä½¿å¾—é…ç½®æ–‡ä»¶ç«‹å³ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sysctl -p</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ£€æŸ¥æ˜¯å¦å¼€å¯æˆåŠŸ</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sysctl -a |grep <span class="string">&quot;ip_forward&quot;</span></span>    </span><br></pre></td></tr></table></figure><h3 id="docker-network-å‰ç¼€åç§°"><a href="#docker-network-å‰ç¼€åç§°" class="headerlink" title="docker network å‰ç¼€åç§°"></a>docker network å‰ç¼€åç§°</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é»˜è®¤å½“å‰è·¯å¾„åï¼šè·¯å¾„_*</span></span><br><span class="line"><span class="comment"># è®¾ç½®ç¯å¢ƒå˜é‡ æˆ–è€… .envä¸­è®¾ç½®</span></span><br><span class="line">COMPOSE_PROJECT_NAME=</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> Docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¸¸ç”¨å‘½ä»¤</title>
      <link href="/posts/6fc55794.html"/>
      <url>/posts/6fc55794.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h1><p>å¦‚éœ€ç®¡ç†docker-composeæœåŠ¡ï¼Œè¯·åœ¨å‘½ä»¤åé¢åŠ ä¸ŠæœåŠ¡å™¨åç§°ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ docker-compose up                         <span class="comment"># åˆ›å»ºå¹¶ä¸”å¯åŠ¨æ‰€æœ‰å®¹å™¨</span></span><br><span class="line">$ docker-compose up -d                      <span class="comment"># åˆ›å»ºå¹¶ä¸”åå°è¿è¡Œæ–¹å¼å¯åŠ¨æ‰€æœ‰å®¹å™¨</span></span><br><span class="line">$ docker-compose up nginx php mysql         <span class="comment"># åˆ›å»ºå¹¶ä¸”å¯åŠ¨nginxã€phpã€mysqlçš„å¤šä¸ªå®¹å™¨</span></span><br><span class="line">$ docker-compose up -d nginx php  mysql     <span class="comment"># åˆ›å»ºå¹¶ä¸”å·²åå°è¿è¡Œçš„æ–¹å¼å¯åŠ¨nginxã€phpã€mysqlå®¹å™¨</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$ docker-compose start php                  <span class="comment"># å¯åŠ¨æœåŠ¡</span></span><br><span class="line">$ docker-compose stop php                   <span class="comment"># åœæ­¢æœåŠ¡</span></span><br><span class="line">$ docker-compose restart php                <span class="comment"># é‡å¯æœåŠ¡</span></span><br><span class="line">$ docker-compose build php                  <span class="comment"># æ„å»ºæˆ–è€…é‡æ–°æ„å»ºæœåŠ¡</span></span><br><span class="line"></span><br><span class="line">$ docker-compose <span class="built_in">rm</span> php                     <span class="comment"># åˆ é™¤å¹¶ä¸”åœæ­¢phpå®¹å™¨</span></span><br><span class="line">$ docker-compose down                       <span class="comment"># åœæ­¢å¹¶åˆ é™¤å®¹å™¨ï¼Œç½‘ç»œï¼Œå›¾åƒå’ŒæŒ‚è½½å·</span></span><br></pre></td></tr></table></figure><p>å¦‚ä¸æ”¯æŒdocker-composeçš„ç®¡ç†æœåŠ¡ï¼Œè¯·åœ¨å‘½ä»¤åé¢åŠ ä¸ŠæœåŠ¡å™¨åç§°ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$ docker run                         <span class="comment"># åˆ›å»ºå¹¶ä¸”å¯åŠ¨æ‰€æœ‰å®¹å™¨</span></span><br><span class="line">$ docker run -d                      <span class="comment"># åˆ›å»ºå¹¶ä¸”åå°è¿è¡Œæ–¹å¼å¯åŠ¨æ‰€æœ‰å®¹å™¨</span></span><br><span class="line">$ docker run nginx                   <span class="comment"># åˆ›å»ºå¹¶ä¸”å¯åŠ¨nginxå®¹å™¨</span></span><br><span class="line">$ docker run -d nginx                 <span class="comment"># åˆ›å»ºå¹¶ä¸”å·²åå°è¿è¡Œçš„æ–¹å¼å¯åŠ¨nginxå®¹å™¨</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$ docker container start å®¹å™¨I        <span class="comment"># å¯åŠ¨å®¹å™¨</span></span><br><span class="line">$ docker container stop å®¹å™¨ID        <span class="comment"># åœæ­¢å®¹å™¨</span></span><br><span class="line">$ docker container restart å®¹å™¨ID     <span class="comment"># é‡å¯å®¹å™¨</span></span><br><span class="line"></span><br><span class="line">$ docker <span class="built_in">rm</span> å®¹å™¨ID                    <span class="comment"># åˆ é™¤å®¹å™¨</span></span><br><span class="line">$ docker rmi é•œåƒID                   <span class="comment"># åˆ é™¤é•œåƒ</span></span><br><span class="line">$ docker network create dnmp_net     <span class="comment"># åˆ›å»ºç½‘ç»œ</span></span><br><span class="line">$ docker network <span class="built_in">rm</span> dnmp_net         <span class="comment"># åˆ é™¤ç½‘ç»œ</span></span><br><span class="line">$ docker inspect é•œåƒID|å®¹å™¨ID         <span class="comment"># æŸ¥çœ‹é•œåƒæˆ–è€…å®¹å™¨è¯¦æƒ…</span></span><br><span class="line">$ docker rmi $(docker ps -a | grep <span class="string">&quot;none&quot;</span> | awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>) <span class="comment"># åˆ é™¤noneé•œåƒ</span></span><br><span class="line">$ docker inspect -f <span class="string">&#x27;&#123;&#123;range .NetworkSettings.Networks&#125;&#125;&#123;&#123;.IPAddress&#125;&#125;&#123;&#123;end&#125;&#125;&#x27;</span> å®¹å™¨ID æŸ¥çœ‹å®¹å™¨çš„ip</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> Docker </category>
          
          <category> å¸¸ç”¨å‘½ä»¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sshd</title>
      <link href="/posts/e9824289.html"/>
      <url>/posts/e9824289.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="å®‰è£…sshd"><a href="#å®‰è£…sshd" class="headerlink" title="å®‰è£…sshd"></a>å®‰è£…sshd</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">yum install openssh-server</span></span><br></pre></td></tr></table></figure><h1 id="ä¿®æ”¹é…ç½®"><a href="#ä¿®æ”¹é…ç½®" class="headerlink" title="ä¿®æ”¹é…ç½®"></a>ä¿®æ”¹é…ç½®</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">vi /etc/ssh/sshd_config</span></span><br></pre></td></tr></table></figure><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹ç«¯å£</span></span><br><span class="line"><span class="attribute">Port</span> <span class="number">2233</span></span><br><span class="line"><span class="comment"># å¯ç”¨rootç™»å½•</span></span><br><span class="line">PermitRootLogin <span class="literal">yes</span></span><br><span class="line"><span class="comment"># å¦‚æœä½¿ç”¨è´¦å·å¯†ç ç™»å½•ï¼Œå¯ç”¨å¹¶ä¸”è®¾ç½®rootå¯†ç </span></span><br><span class="line">PasswordAuthentication <span class="literal">yes</span></span><br></pre></td></tr></table></figure><h1 id="å¯åŠ¨sshd"><a href="#å¯åŠ¨sshd" class="headerlink" title="å¯åŠ¨sshd"></a>å¯åŠ¨sshd</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">systemctl start sshd</span></span><br></pre></td></tr></table></figure><h1 id="ç™»å½•"><a href="#ç™»å½•" class="headerlink" title="ç™»å½•"></a>ç™»å½•</h1><h2 id="æœåŠ¡å™¨ifconfigä¿¡æ¯"><a href="#æœåŠ¡å™¨ifconfigä¿¡æ¯" class="headerlink" title="æœåŠ¡å™¨ifconfigä¿¡æ¯"></a>æœåŠ¡å™¨ifconfigä¿¡æ¯</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">br</span>-<span class="number">9</span>d1a3752f9ed: flags=<span class="number">4163</span>&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu <span class="number">1500</span></span><br><span class="line">        <span class="attribute">inet</span> <span class="number">172.18.0.1</span>  netmask <span class="number">255.255.0.0</span>  broadcast <span class="number">172.19.255.255</span></span><br><span class="line">        <span class="attribute">ether</span> <span class="number">02</span>:<span class="number">42</span>:c5:<span class="number">80</span>:<span class="number">3</span>f:<span class="number">8</span>b  txqueuelen <span class="number">0</span>  (Ethernet)</span><br><span class="line">        <span class="attribute">RX</span> packets <span class="number">0</span>  bytes <span class="number">0</span> (<span class="number">0</span>.<span class="number">0</span> B)</span><br><span class="line">        <span class="attribute">RX</span> errors <span class="number">0</span>  dropped <span class="number">0</span>  overruns <span class="number">0</span>  frame <span class="number">0</span></span><br><span class="line">        <span class="attribute">TX</span> packets <span class="number">0</span>  bytes <span class="number">0</span> (<span class="number">0</span>.<span class="number">0</span> B)</span><br><span class="line">        <span class="attribute">TX</span> errors <span class="number">0</span>  dropped <span class="number">0</span> overruns <span class="number">0</span>  carrier <span class="number">0</span>  collisions <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">docker0</span>: flags=<span class="number">4099</span>&lt;UP,BROADCAST,MULTICAST&gt;  mtu <span class="number">1500</span></span><br><span class="line">        <span class="attribute">inet</span> <span class="number">172.17.0.1</span>  netmask <span class="number">255.255.0.0</span>  broadcast <span class="number">172.17.255.255</span></span><br><span class="line">        <span class="attribute">ether</span> <span class="number">02</span>:<span class="number">42</span>:<span class="number">7</span>e:a0:<span class="number">98</span>:<span class="number">91</span>  txqueuelen <span class="number">0</span>  (Ethernet)</span><br><span class="line">        <span class="attribute">RX</span> packets <span class="number">0</span>  bytes <span class="number">0</span> (<span class="number">0</span>.<span class="number">0</span> B)</span><br><span class="line">        <span class="attribute">RX</span> errors <span class="number">0</span>  dropped <span class="number">0</span>  overruns <span class="number">0</span>  frame <span class="number">0</span></span><br><span class="line">        <span class="attribute">TX</span> packets <span class="number">0</span>  bytes <span class="number">0</span> (<span class="number">0</span>.<span class="number">0</span> B)</span><br><span class="line">        <span class="attribute">TX</span> errors <span class="number">0</span>  dropped <span class="number">0</span> overruns <span class="number">0</span>  carrier <span class="number">0</span>  collisions <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">eth0</span>: flags=<span class="number">4163</span>&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu <span class="number">1500</span></span><br><span class="line">        <span class="attribute">inet</span> <span class="number">10.0.2.15</span>  netmask <span class="number">255.255.255.0</span>  broadcast <span class="number">10.0.2.255</span></span><br><span class="line">        <span class="attribute">ether</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:<span class="number">98</span>:a2:<span class="number">83</span>  txqueuelen <span class="number">1000</span>  (Ethernet)</span><br><span class="line">        <span class="attribute">RX</span> packets <span class="number">983</span>  bytes <span class="number">118711</span> (<span class="number">115</span>.<span class="number">9</span> KiB)</span><br><span class="line">        <span class="attribute">RX</span> errors <span class="number">0</span>  dropped <span class="number">0</span>  overruns <span class="number">0</span>  frame <span class="number">0</span></span><br><span class="line">        <span class="attribute">TX</span> packets <span class="number">695</span>  bytes <span class="number">128882</span> (<span class="number">125</span>.<span class="number">8</span> KiB)</span><br><span class="line">        <span class="attribute">TX</span> errors <span class="number">0</span>  dropped <span class="number">0</span> overruns <span class="number">0</span>  carrier <span class="number">0</span>  collisions <span class="number">0</span></span><br></pre></td></tr></table></figure><h2 id="å®¹å™¨ip"><a href="#å®¹å™¨ip" class="headerlink" title="å®¹å™¨ip"></a>å®¹å™¨ip</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker inspect container_id</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">&quot;Gateway&quot;</span>: <span class="string">&quot;172.17.0.1&quot;</span>,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">&quot;IPAddress&quot;</span>: <span class="string">&quot;172.17.0.2&quot;</span>,</span></span><br></pre></td></tr></table></figure><h2 id="å¯†é’¥æ–¹å¼ç™»å½•é…ç½®"><a href="#å¯†é’¥æ–¹å¼ç™»å½•é…ç½®" class="headerlink" title="å¯†é’¥æ–¹å¼ç™»å½•é…ç½®"></a>å¯†é’¥æ–¹å¼ç™»å½•é…ç½®</h2><h3 id="ç”Ÿæˆå¯†é’¥å¯¹"><a href="#ç”Ÿæˆå¯†é’¥å¯¹" class="headerlink" title="ç”Ÿæˆå¯†é’¥å¯¹"></a>ç”Ÿæˆå¯†é’¥å¯¹</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¦‚æœè®¾ç½®å¯†ç ï¼Œåˆ™ç™»å½•è¦æœåŠ¡å™¨æ—¶ï¼Œéœ€è¦è¾“å…¥å¯†ç </span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ssh-keygen -t rsa</span></span><br></pre></td></tr></table></figure><h3 id="åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…å…¬é’¥"><a href="#åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…å…¬é’¥" class="headerlink" title="åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…å…¬é’¥"></a>åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…å…¬é’¥</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</span></span><br></pre></td></tr></table></figure><h3 id="å°†å®¢æˆ·ç«¯å…¬é’¥è¿½åŠ åˆ°æœåŠ¡å™¨ç«¯"><a href="#å°†å®¢æˆ·ç«¯å…¬é’¥è¿½åŠ åˆ°æœåŠ¡å™¨ç«¯" class="headerlink" title="å°†å®¢æˆ·ç«¯å…¬é’¥è¿½åŠ åˆ°æœåŠ¡å™¨ç«¯"></a>å°†å®¢æˆ·ç«¯å…¬é’¥è¿½åŠ åˆ°æœåŠ¡å™¨ç«¯</h3><h4 id="ssh-copy-id-è‡ªåŠ¨å®Œæˆ"><a href="#ssh-copy-id-è‡ªåŠ¨å®Œæˆ" class="headerlink" title="ssh-copy-id è‡ªåŠ¨å®Œæˆ"></a>ssh-copy-id è‡ªåŠ¨å®Œæˆ</h4><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>ssh-copy-id -i ~<span class="regexp">/.ssh/id</span>_rsa.pub root<span class="variable">@172</span>.<span class="number">17.0</span>.<span class="number">1</span> -p2233</span><br></pre></td></tr></table></figure><h4 id="æ‰‹åŠ¨æ“ä½œ"><a href="#æ‰‹åŠ¨æ“ä½œ" class="headerlink" title="æ‰‹åŠ¨æ“ä½œ"></a>æ‰‹åŠ¨æ“ä½œ</h4><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥æœåŠ¡å™¨</span></span><br><span class="line"><span class="variable">$ </span>vi ~<span class="regexp">/.ssh/authorized</span>_keys</span><br><span class="line"><span class="comment"># æ¢è¡Œåï¼Œå°†å®¢æˆ·ç«¯çš„id_rsa.pubå†…å®¹è¿½åŠ åˆ°è¯¥æ–‡ä»¶ä¸­</span></span><br></pre></td></tr></table></figure><h3 id="ä¿®æ”¹æ–‡ä»¶æƒé™"><a href="#ä¿®æ”¹æ–‡ä»¶æƒé™" class="headerlink" title="ä¿®æ”¹æ–‡ä»¶æƒé™"></a>ä¿®æ”¹æ–‡ä»¶æƒé™</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æƒé™é»˜è®¤å€¼ï¼Œæ— éœ€ä¿®æ”¹</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">chmod</span> 644 authorized_keys</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">chmod</span> 700 ~/.ssh</span></span><br></pre></td></tr></table></figure><h3 id="å¼€å¯å¯†é’¥ç™»å½•"><a href="#å¼€å¯å¯†é’¥ç™»å½•" class="headerlink" title="å¼€å¯å¯†é’¥ç™»å½•"></a>å¼€å¯å¯†é’¥ç™»å½•</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">vi /etc/ssh/sshd_config</span></span><br></pre></td></tr></table></figure><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¼€å¯å¯†é’¥ç™»å½•</span></span><br><span class="line"><span class="attribute">PubkeyAuthentication</span> <span class="literal">yes</span></span><br></pre></td></tr></table></figure><h1 id="ç™»å½•-1"><a href="#ç™»å½•-1" class="headerlink" title="ç™»å½•"></a>ç™»å½•</h1><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨çš„æ˜¯docker0çš„ç½‘ç»œ</span></span><br><span class="line"><span class="variable">$ </span>ssh root<span class="variable">@172</span>.<span class="number">17.0</span>.<span class="number">1</span> -p2233</span><br><span class="line"><span class="comment"># æˆ–è€…ç›´æ¥è¿æ¥å®¹å™¨ip</span></span><br><span class="line"><span class="variable">$ </span>ssh root<span class="variable">@172</span>.<span class="number">17.0</span>.<span class="number">2</span> -p2233</span><br></pre></td></tr></table></figure><h1 id="å¸¸è§é—®é¢˜"><a href="#å¸¸è§é—®é¢˜" class="headerlink" title="å¸¸è§é—®é¢˜"></a>å¸¸è§é—®é¢˜</h1><h2 id="Host-key-verification-failed"><a href="#Host-key-verification-failed" class="headerlink" title="Host key verification failed."></a>Host key verification failed.</h2><p>ECDSA host key for [172.18.0.1]:2233 has changed and you have requested strict checking.<br>Host key verification failed.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ssh-keygen -R <span class="string">&quot;[172.18.0.1]:2233&quot;</span></span></span><br></pre></td></tr></table></figure><h2 id="dockerä¸‹æ— æ³•ç™»å½•"><a href="#dockerä¸‹æ— æ³•ç™»å½•" class="headerlink" title="dockerä¸‹æ— æ³•ç™»å½•"></a>dockerä¸‹æ— æ³•ç™»å½•</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¢åŠ sshdçš„ç«¯å£è½¬å‘</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
          <category> sshd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cmake ç¼–è¯‘å®‰è£…</title>
      <link href="/posts/33d65e5.html"/>
      <url>/posts/33d65e5.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ wget https:<span class="regexp">//gi</span>thub.com<span class="regexp">/Kitware/</span>CMake<span class="regexp">/releases/</span>download<span class="regexp">/v3.24.0/</span>cmake-<span class="number">3.24</span>.<span class="number">0</span>.tar.gz</span><br></pre></td></tr></table></figure><h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tar -xvf cmake-3.24.0.tar.gz</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cd</span> cmake-3.24.0</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./bootstrap --prefix=/usr/local/webserver/cmake/cmake</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">gmake &amp;&amp; gmake install</span></span><br></pre></td></tr></table></figure><h1 id="å»ºç«‹è½¯é“¾æ¥"><a href="#å»ºç«‹è½¯é“¾æ¥" class="headerlink" title="å»ºç«‹è½¯é“¾æ¥"></a>å»ºç«‹è½¯é“¾æ¥</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ln -s <span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>cmake<span class="regexp">/cmake/</span>bin<span class="regexp">/cmake /u</span>sr<span class="regexp">/bin/</span>cmake</span><br></pre></td></tr></table></figure><h1 id="æŸ¥çœ‹å®‰è£…ç‰ˆæœ¬"><a href="#æŸ¥çœ‹å®‰è£…ç‰ˆæœ¬" class="headerlink" title="æŸ¥çœ‹å®‰è£…ç‰ˆæœ¬"></a>æŸ¥çœ‹å®‰è£…ç‰ˆæœ¬</h1><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cmake <span class="comment">--version</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>libzip ç¼–è¯‘å®‰è£…</title>
      <link href="/posts/1707e975.html"/>
      <url>/posts/1707e975.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ wget https:<span class="regexp">//</span>libzip.org<span class="regexp">/download/</span>libzip-<span class="number">1.9</span>.<span class="number">2</span>.tar.gz</span><br></pre></td></tr></table></figure><h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tar -xvf libzip-1.9.2.tar.gz</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cd</span> libzip-1.9.2</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ›å»ºbuildç›®å½•</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">mkdir</span> build &amp;&amp; <span class="built_in">cd</span> build</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åœ¨åˆšåˆšå»ºç«‹çš„buildç›®å½•ä¸­</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ³¨æ„ä½¿ç”¨cmake .. çš„æƒ…å†µæ˜¯ä¼šæŠŠlibzip å®‰è£…åˆ°/usr/lib64 è¯·è‡ªè¡Œäº†è§£/usr/local/lib64 å’Œ /usr/lib64 çš„åŒºåˆ«ï¼Œä¸ºäº†æŠŠä»–å®‰è£…åˆ°/usr/lib64æˆ‘ä»¬é€‰æ‹©ç»™ä»–æŒ‡å®šç›®å½•</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">cmake -DCMAKE_INSTALL_PREFIX=/usr ..</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç¼–è¯‘å’Œå®‰è£…è½¯ä»¶</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">make &amp;&amp; make install</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é€šè¿‡å‘½ä»¤æŸ¥çœ‹æ˜¯å¦ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">pkg-config --libs libzip</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>namedåŸŸåæœåŠ¡å™¨éƒ¨ç½²</title>
      <link href="/posts/52a7d0f0.html"/>
      <url>/posts/52a7d0f0.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ yum install <span class="built_in">bind</span></span><br></pre></td></tr></table></figure><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">sudo</span> vim /etc/named.rfc1912.zones</span><br></pre></td></tr></table></figure><h3 id="æ·»åŠ é…ç½®é¡¹"><a href="#æ·»åŠ é…ç½®é¡¹" class="headerlink" title="æ·»åŠ é…ç½®é¡¹"></a>æ·»åŠ é…ç½®é¡¹</h3><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">zone <span class="string">&quot;cat.cs&quot;</span> IN &#123;</span><br><span class="line">        type master<span class="comment">;</span></span><br><span class="line">        file <span class="string">&quot;cat.zone&quot;</span><span class="comment">;</span></span><br><span class="line">        allow-update &#123; none<span class="comment">; &#125;;</span></span><br><span class="line">&#125;<span class="comment">;</span></span><br></pre></td></tr></table></figure><h3 id="æ–°å¢å¯¹åº”é…ç½®æ–‡ä»¶"><a href="#æ–°å¢å¯¹åº”é…ç½®æ–‡ä»¶" class="headerlink" title="æ–°å¢å¯¹åº”é…ç½®æ–‡ä»¶"></a>æ–°å¢å¯¹åº”é…ç½®æ–‡ä»¶</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cp</span> /var/named/named.localhost /var/named/cat.zone</span><br><span class="line">$ vim /var/named/cat.zone</span><br></pre></td></tr></table></figure><h3 id="ä¿®æ”¹é…ç½®"><a href="#ä¿®æ”¹é…ç½®" class="headerlink" title="ä¿®æ”¹é…ç½®"></a>ä¿®æ”¹é…ç½®</h3><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$TTL</span> <span class="number">86400</span></span><br><span class="line">@       <span class="keyword">IN</span> <span class="keyword">SOA</span>          cat.cs. root (</span><br><span class="line">                                        <span class="number">1</span>       <span class="comment">; serial</span></span><br><span class="line">                                        <span class="number">1</span>D      <span class="comment">; refresh</span></span><br><span class="line">                                        <span class="number">1</span>H      <span class="comment">; retry</span></span><br><span class="line">                                        <span class="number">1</span>W      <span class="comment">; expire</span></span><br><span class="line">                                        <span class="number">0</span> )     <span class="comment">; minimum</span></span><br><span class="line"></span><br><span class="line">@       <span class="keyword">IN</span>      <span class="keyword">NS</span>      ns.cat.cs.</span><br><span class="line">ns      <span class="keyword">IN</span>      <span class="keyword">A</span>       <span class="number">192.168.1.212</span></span><br></pre></td></tr></table></figure><h2 id="ä¿®æ”¹æƒé™"><a href="#ä¿®æ”¹æƒé™" class="headerlink" title="ä¿®æ”¹æƒé™"></a>ä¿®æ”¹æƒé™</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">chown</span> root:named /var/named/*.zone</span><br></pre></td></tr></table></figure><h2 id="å¯åŠ¨æœåŠ¡"><a href="#å¯åŠ¨æœåŠ¡" class="headerlink" title="å¯åŠ¨æœåŠ¡"></a>å¯åŠ¨æœåŠ¡</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ service named start</span><br></pre></td></tr></table></figure><h2 id="æµ‹è¯•è¿æ¥"><a href="#æµ‹è¯•è¿æ¥" class="headerlink" title="æµ‹è¯•è¿æ¥"></a>æµ‹è¯•è¿æ¥</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ dig cat.cs @127.0.0.1 +short</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äºŒåˆ†æŸ¥æ‰¾</title>
      <link href="/posts/e8eb0481.html"/>
      <url>/posts/e8eb0481.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h1><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">äºŒåˆ†æŸ¥æ‰¾é’ˆå¯¹çš„æ˜¯ä¸€ä¸ªæœ‰åºçš„æ•°æ®é›†åˆï¼ŒæŸ¥æ‰¾æ€æƒ³æœ‰ç‚¹ç±»ä¼¼åˆ†æ²»æ€æƒ³ã€‚</span><br><span class="line">æ¯æ¬¡éƒ½é€šè¿‡è·ŸåŒºé—´çš„ä¸­é—´å…ƒç´ å¯¹æ¯”ï¼Œå°†å¾…æŸ¥æ‰¾çš„åŒºé—´ç¼©å°ä¸ºä¹‹å‰çš„ä¸€åŠï¼Œç›´åˆ°æ‰¾åˆ°è¦æŸ¥æ‰¾çš„å…ƒç´ ï¼Œæˆ–è€…åŒºé—´è¢«ç¼©å°ä¸º 0</span><br></pre></td></tr></table></figure><h1 id="æ€§èƒ½"><a href="#æ€§èƒ½" class="headerlink" title="æ€§èƒ½"></a>æ€§èƒ½</h1><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ—¶é—´å¤æ‚åº¦: <span class="function"><span class="title">O</span>(<span class="variable">logn</span>)</span></span><br></pre></td></tr></table></figure><h1 id="å±€é™æ€§"><a href="#å±€é™æ€§" class="headerlink" title="å±€é™æ€§"></a>å±€é™æ€§</h1><h3 id="äºŒåˆ†æŸ¥æ‰¾ä¾èµ–çš„æ˜¯é¡ºåºè¡¨ç»“æ„ï¼Œç®€å•ç‚¹è¯´å°±æ˜¯æ•°ç»„ã€‚"><a href="#äºŒåˆ†æŸ¥æ‰¾ä¾èµ–çš„æ˜¯é¡ºåºè¡¨ç»“æ„ï¼Œç®€å•ç‚¹è¯´å°±æ˜¯æ•°ç»„ã€‚" class="headerlink" title="äºŒåˆ†æŸ¥æ‰¾ä¾èµ–çš„æ˜¯é¡ºåºè¡¨ç»“æ„ï¼Œç®€å•ç‚¹è¯´å°±æ˜¯æ•°ç»„ã€‚"></a>äºŒåˆ†æŸ¥æ‰¾ä¾èµ–çš„æ˜¯é¡ºåºè¡¨ç»“æ„ï¼Œç®€å•ç‚¹è¯´å°±æ˜¯æ•°ç»„ã€‚</h3><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">é‚£äºŒåˆ†æŸ¥æ‰¾èƒ½å¦ä¾èµ–å…¶ä»–æ•°æ®ç»“æ„å‘¢ï¼Ÿæ¯”å¦‚é“¾è¡¨ã€‚ç­”æ¡ˆæ˜¯ä¸å¯ä»¥çš„ï¼Œä¸»è¦åŸå› æ˜¯äºŒåˆ†æŸ¥æ‰¾ç®—æ³•éœ€è¦æŒ‰ç…§ä¸‹æ ‡éšæœºè®¿é—®å…ƒç´ ã€‚</span><br><span class="line">æˆ‘ä»¬åœ¨æ•°ç»„å’Œé“¾è¡¨é‚£ä¸¤èŠ‚è®²è¿‡ï¼Œæ•°ç»„æŒ‰ç…§ä¸‹æ ‡éšæœºè®¿é—®æ•°æ®çš„æ—¶é—´å¤æ‚åº¦æ˜¯ <span class="built_in">O</span>(<span class="number">1</span>)ï¼Œè€Œé“¾è¡¨éšæœºè®¿é—®çš„æ—¶é—´å¤æ‚åº¦æ˜¯ <span class="built_in">O</span>(n)ã€‚</span><br><span class="line">æ‰€ä»¥ï¼Œå¦‚æœæ•°æ®ä½¿ç”¨é“¾è¡¨å­˜å‚¨ï¼ŒäºŒåˆ†æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚å°±ä¼šå˜å¾—å¾ˆé«˜ã€‚</span><br><span class="line"></span><br><span class="line">äºŒåˆ†æŸ¥æ‰¾åªèƒ½ç”¨åœ¨æ•°æ®æ˜¯é€šè¿‡é¡ºåºè¡¨æ¥å­˜å‚¨çš„æ•°æ®ç»“æ„ä¸Šã€‚å¦‚æœä½ çš„æ•°æ®æ˜¯é€šè¿‡å…¶ä»–æ•°æ®ç»“æ„å­˜å‚¨çš„ï¼Œåˆ™æ— æ³•åº”ç”¨äºŒåˆ†æŸ¥æ‰¾ã€‚</span><br></pre></td></tr></table></figure><h3 id="äºŒåˆ†æŸ¥æ‰¾é’ˆå¯¹çš„æ˜¯æœ‰åºæ•°æ®ã€‚"><a href="#äºŒåˆ†æŸ¥æ‰¾é’ˆå¯¹çš„æ˜¯æœ‰åºæ•°æ®ã€‚" class="headerlink" title="äºŒåˆ†æŸ¥æ‰¾é’ˆå¯¹çš„æ˜¯æœ‰åºæ•°æ®ã€‚"></a>äºŒåˆ†æŸ¥æ‰¾é’ˆå¯¹çš„æ˜¯æœ‰åºæ•°æ®ã€‚</h3><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">äºŒåˆ†æŸ¥æ‰¾å¯¹è¿™ä¸€ç‚¹çš„è¦æ±‚æ¯”è¾ƒè‹›åˆ»ï¼Œæ•°æ®å¿…é¡»æ˜¯æœ‰åºçš„ã€‚å¦‚æœæ•°æ®æ²¡æœ‰åºï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ’åºã€‚æ’åºçš„æ—¶é—´å¤æ‚åº¦æœ€ä½æ˜¯ <span class="built_in">O</span>(nlogn)ã€‚</span><br><span class="line">æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬é’ˆå¯¹çš„æ˜¯ä¸€ç»„é™æ€çš„æ•°æ®ï¼Œæ²¡æœ‰é¢‘ç¹åœ°æ’å…¥ã€åˆ é™¤ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œä¸€æ¬¡æ’åºï¼Œå¤šæ¬¡äºŒåˆ†æŸ¥æ‰¾ã€‚è¿™æ ·æ’åºçš„æˆæœ¬å¯è¢«å‡æ‘Šï¼ŒäºŒåˆ†æŸ¥æ‰¾çš„è¾¹é™…æˆæœ¬å°±ä¼šæ¯”è¾ƒä½ã€‚</span><br><span class="line">ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬çš„æ•°æ®é›†åˆæœ‰é¢‘ç¹çš„æ’å…¥å’Œåˆ é™¤æ“ä½œï¼Œè¦æƒ³ç”¨äºŒåˆ†æŸ¥æ‰¾ï¼Œè¦ä¹ˆæ¯æ¬¡æ’å…¥ã€åˆ é™¤æ“ä½œä¹‹åä¿è¯æ•°æ®ä»ç„¶æœ‰åºï¼Œè¦ä¹ˆåœ¨æ¯æ¬¡äºŒåˆ†æŸ¥æ‰¾ä¹‹å‰éƒ½å…ˆè¿›è¡Œæ’åºã€‚</span><br><span class="line">é’ˆå¯¹è¿™ç§åŠ¨æ€æ•°æ®é›†åˆï¼Œæ— è®ºå“ªç§æ–¹æ³•ï¼Œç»´æŠ¤æœ‰åºçš„æˆæœ¬éƒ½æ˜¯å¾ˆé«˜çš„ã€‚</span><br><span class="line">æ‰€ä»¥ï¼ŒäºŒåˆ†æŸ¥æ‰¾åªèƒ½ç”¨åœ¨æ’å…¥ã€åˆ é™¤æ“ä½œä¸é¢‘ç¹ï¼Œä¸€æ¬¡æ’åºå¤šæ¬¡æŸ¥æ‰¾çš„åœºæ™¯ä¸­ã€‚é’ˆå¯¹åŠ¨æ€å˜åŒ–çš„æ•°æ®é›†åˆï¼ŒäºŒåˆ†æŸ¥æ‰¾å°†ä¸å†é€‚ç”¨ã€‚</span><br></pre></td></tr></table></figure><h3 id="æ•°æ®é‡å¤ªå°ä¸é€‚åˆäºŒåˆ†æŸ¥æ‰¾"><a href="#æ•°æ®é‡å¤ªå°ä¸é€‚åˆäºŒåˆ†æŸ¥æ‰¾" class="headerlink" title="æ•°æ®é‡å¤ªå°ä¸é€‚åˆäºŒåˆ†æŸ¥æ‰¾"></a>æ•°æ®é‡å¤ªå°ä¸é€‚åˆäºŒåˆ†æŸ¥æ‰¾</h3><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœè¦å¤„ç†çš„æ•°æ®é‡å¾ˆå°ï¼Œå®Œå…¨æ²¡æœ‰å¿…è¦ç”¨äºŒåˆ†æŸ¥æ‰¾ï¼Œé¡ºåºéå†å°±è¶³å¤Ÿäº†ã€‚</span><br><span class="line">æ¯”å¦‚æˆ‘ä»¬åœ¨ä¸€ä¸ªå¤§å°ä¸º<span class="number"> 10 </span>çš„æ•°ç»„ä¸­æŸ¥æ‰¾ä¸€ä¸ªå…ƒç´ ï¼Œä¸ç®¡ç”¨äºŒåˆ†æŸ¥æ‰¾è¿˜æ˜¯é¡ºåºéå†ï¼ŒæŸ¥æ‰¾é€Ÿåº¦éƒ½å·®ä¸å¤šã€‚åªæœ‰æ•°æ®é‡æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼ŒäºŒåˆ†æŸ¥æ‰¾çš„ä¼˜åŠ¿æ‰ä¼šæ¯”è¾ƒæ˜æ˜¾ã€‚</span><br><span class="line">ä¸è¿‡ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å¤–ã€‚å¦‚æœæ•°æ®ä¹‹é—´çš„æ¯”è¾ƒæ“ä½œéå¸¸è€—æ—¶ï¼Œä¸ç®¡æ•°æ®é‡å¤§å°ï¼Œæˆ‘éƒ½æ¨èä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾ã€‚</span><br><span class="line">æ¯”å¦‚ï¼Œæ•°ç»„ä¸­å­˜å‚¨çš„éƒ½æ˜¯é•¿åº¦è¶…è¿‡<span class="number"> 300 </span>çš„å­—ç¬¦ä¸²ï¼Œå¦‚æ­¤é•¿çš„ä¸¤ä¸ªå­—ç¬¦ä¸²ä¹‹é—´æ¯”å¯¹å¤§å°ï¼Œå°±ä¼šéå¸¸è€—æ—¶ã€‚</span><br><span class="line">æˆ‘ä»¬éœ€è¦å°½å¯èƒ½åœ°å‡å°‘æ¯”è¾ƒæ¬¡æ•°ï¼Œè€Œæ¯”è¾ƒæ¬¡æ•°çš„å‡å°‘ä¼šå¤§å¤§æé«˜æ€§èƒ½ï¼Œè¿™ä¸ªæ—¶å€™äºŒåˆ†æŸ¥æ‰¾å°±æ¯”é¡ºåºéå†æ›´æœ‰ä¼˜åŠ¿ã€‚</span><br></pre></td></tr></table></figure><h3 id="æ•°æ®é‡å¤ªå¤§ä¹Ÿä¸é€‚åˆäºŒåˆ†æŸ¥æ‰¾"><a href="#æ•°æ®é‡å¤ªå¤§ä¹Ÿä¸é€‚åˆäºŒåˆ†æŸ¥æ‰¾" class="headerlink" title="æ•°æ®é‡å¤ªå¤§ä¹Ÿä¸é€‚åˆäºŒåˆ†æŸ¥æ‰¾"></a>æ•°æ®é‡å¤ªå¤§ä¹Ÿä¸é€‚åˆäºŒåˆ†æŸ¥æ‰¾</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">äºŒåˆ†æŸ¥æ‰¾çš„åº•å±‚éœ€è¦ä¾èµ–æ•°ç»„è¿™ç§æ•°æ®ç»“æ„ï¼Œè€Œæ•°ç»„ä¸ºäº†æ”¯æŒéšæœºè®¿é—®çš„ç‰¹æ€§ï¼Œè¦æ±‚å†…å­˜ç©ºé—´è¿ç»­ï¼Œå¯¹å†…å­˜çš„è¦æ±‚æ¯”è¾ƒè‹›åˆ»ã€‚</span><br><span class="line">æ¯”å¦‚ï¼Œæˆ‘ä»¬æœ‰ 1GB å¤§å°çš„æ•°æ®ï¼Œå¦‚æœå¸Œæœ›ç”¨æ•°ç»„æ¥å­˜å‚¨ï¼Œé‚£å°±éœ€è¦ 1GB çš„è¿ç»­å†…å­˜ç©ºé—´ã€‚</span><br><span class="line">æ³¨æ„è¿™é‡Œçš„â€œè¿ç»­â€äºŒå­—ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå³ä¾¿æœ‰ 2GB çš„å†…å­˜ç©ºé—´å‰©ä½™ï¼Œä½†æ˜¯å¦‚æœè¿™å‰©ä½™çš„ 2GB å†…å­˜ç©ºé—´éƒ½æ˜¯é›¶æ•£çš„ï¼Œ</span><br><span class="line">æ²¡æœ‰è¿ç»­çš„ 1GB å¤§å°çš„å†…å­˜ç©ºé—´ï¼Œé‚£ç…§æ ·æ— æ³•ç”³è¯·ä¸€ä¸ª 1GB å¤§å°çš„æ•°ç»„ã€‚</span><br><span class="line">è€Œæˆ‘ä»¬çš„äºŒåˆ†æŸ¥æ‰¾æ˜¯ä½œç”¨åœ¨æ•°ç»„è¿™ç§æ•°æ®ç»“æ„ä¹‹ä¸Šçš„ï¼Œæ‰€ä»¥å¤ªå¤§çš„æ•°æ®ç”¨æ•°ç»„å­˜å‚¨å°±æ¯”è¾ƒåƒåŠ›äº†ï¼Œä¹Ÿå°±ä¸èƒ½ç”¨äºŒåˆ†æŸ¥æ‰¾äº†ã€‚</span><br></pre></td></tr></table></figure><h1 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h1><h3 id="éé€’å½’å†™æ³•"><a href="#éé€’å½’å†™æ³•" class="headerlink" title="éé€’å½’å†™æ³•"></a>éé€’å½’å†™æ³•</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * äºŒåˆ†æŸ¥æ‰¾ éé€’å½’å†™æ³•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> array $numbers</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int $length æ•°ç»„é•¿åº¦</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int $value è¦æŸ¥æ‰¾çš„å€¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> int æŸ¥æ‰¾å€¼çš„index</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bSearch</span>(<span class="params"><span class="variable">$numbers</span>, <span class="variable">$length</span>, <span class="variable">$value</span></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// å¼€å§‹å’Œç»“æŸä¸‹æ ‡</span></span><br><span class="line">    <span class="variable">$low</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$high</span> = <span class="variable">$length</span> - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="variable">$low</span> &lt;= <span class="variable">$high</span>) &#123;</span><br><span class="line"><span class="comment">//        $mid = $low + ($high - $low) / 2;</span></span><br><span class="line">        <span class="comment">// è·å–ä¸­é—´å€¼</span></span><br><span class="line">        <span class="variable">$mid</span> = <span class="variable">$low</span> + ((<span class="variable">$high</span> - <span class="variable">$low</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$numbers</span>[<span class="variable">$mid</span>] == <span class="variable">$value</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$mid</span>;</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (<span class="variable">$numbers</span>[<span class="variable">$mid</span>] &lt; <span class="variable">$value</span>) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœæŸ¥æ‰¾çš„å€¼å¤§äºä¸­é—´å€¼ï¼Œè¦æ‰¾çš„å…ƒç´ åœ¨[mid + 1, high]ä¹‹é—´</span></span><br><span class="line">            <span class="variable">$low</span> = <span class="variable">$mid</span> + <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœæŸ¥æ‰¾çš„å€¼å°äºä¸­é—´å€¼ï¼Œè¦æ‰¾çš„å…ƒç´ åœ¨[low, mid - 1]ä¹‹é—´</span></span><br><span class="line">            <span class="variable">$high</span> = <span class="variable">$mid</span> - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$numbers</span> = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">22</span>,<span class="number">33</span>,<span class="number">55</span>,<span class="number">77</span>,<span class="number">99</span>];</span><br><span class="line"><span class="variable">$index</span> = <span class="title function_ invoke__">bSearch</span>(<span class="variable">$numbers</span>, <span class="title function_ invoke__">count</span>(<span class="variable">$numbers</span>), <span class="number">55</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$index</span>, <span class="variable">$numbers</span>[<span class="variable">$index</span>]);</span><br></pre></td></tr></table></figure><h3 id="é€’å½’å†™æ³•"><a href="#é€’å½’å†™æ³•" class="headerlink" title="é€’å½’å†™æ³•"></a>é€’å½’å†™æ³•</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * äºŒåˆ†æŸ¥æ‰¾</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> array $numbers</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int $length æ•°ç»„é•¿åº¦</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int $value è¦æŸ¥æ‰¾çš„å€¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> int æŸ¥æ‰¾å€¼çš„index</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">binSearch</span>(<span class="params"><span class="variable">$numbers</span>, <span class="variable">$length</span>, <span class="variable">$value</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">bsearchInternally</span>(<span class="variable">$numbers</span>, <span class="number">0</span>, <span class="variable">$length</span> - <span class="number">1</span>, <span class="variable">$value</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * äºŒåˆ†æŸ¥æ‰¾ é€’å½’å†™æ³•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> array $numbers</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int $low å¼€å§‹index</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int $high ç»“æŸindex</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int $value è¦æŸ¥æ‰¾çš„å€¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> int æŸ¥æ‰¾å€¼çš„index</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bsearchInternally</span>(<span class="params"><span class="variable">$numbers</span>, <span class="variable">$low</span>, <span class="variable">$high</span>, <span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$low</span> &gt; <span class="variable">$high</span>) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$mid</span> = <span class="variable">$low</span> + ((<span class="variable">$high</span> - <span class="variable">$low</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$numbers</span>[<span class="variable">$mid</span>] == <span class="variable">$value</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$mid</span>;</span><br><span class="line">    &#125; <span class="keyword">elseif</span> (<span class="variable">$numbers</span>[<span class="variable">$mid</span>] &lt; <span class="variable">$value</span>) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœæŸ¥æ‰¾çš„å€¼å¤§äºä¸­é—´å€¼ï¼Œè¦æ‰¾çš„å…ƒç´ åœ¨[mid + 1, high]ä¹‹é—´</span></span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">bsearchInternally</span>(<span class="variable">$numbers</span>, <span class="variable">$mid</span> + <span class="number">1</span>, <span class="variable">$high</span>, <span class="variable">$value</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœæŸ¥æ‰¾çš„å€¼å°äºä¸­é—´å€¼ï¼Œè¦æ‰¾çš„å…ƒç´ åœ¨[low, mid - 1]ä¹‹é—´</span></span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">bsearchInternally</span>(<span class="variable">$numbers</span>, <span class="variable">$low</span>, <span class="variable">$mid</span> - <span class="number">1</span>, <span class="variable">$value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$numbers</span> = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">22</span>,<span class="number">33</span>,<span class="number">55</span>,<span class="number">77</span>,<span class="number">99</span>];</span><br><span class="line"><span class="variable">$index</span> = <span class="title function_ invoke__">binSearch</span>(<span class="variable">$numbers</span>, <span class="title function_ invoke__">count</span>(<span class="variable">$numbers</span>), <span class="number">55</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$index</span>, <span class="variable">$numbers</span>[<span class="variable">$index</span>]);</span><br></pre></td></tr></table></figure><h3 id="æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå€¼ç­‰äºç»™å®šå€¼çš„å…ƒç´ "><a href="#æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå€¼ç­‰äºç»™å®šå€¼çš„å…ƒç´ " class="headerlink" title="æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå€¼ç­‰äºç»™å®šå€¼çš„å…ƒç´ "></a>æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå€¼ç­‰äºç»™å®šå€¼çš„å…ƒç´ </h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * äºŒåˆ†æŸ¥æ‰¾</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> array $numbers</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int $length æ•°ç»„é•¿åº¦</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int $value è¦æŸ¥æ‰¾çš„å€¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> int</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bSearch</span>(<span class="params"><span class="variable">$numbers</span>, <span class="variable">$length</span>, <span class="variable">$value</span></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// å¼€å§‹å’Œç»“æŸä¸‹æ ‡</span></span><br><span class="line">    <span class="variable">$low</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$high</span> = <span class="variable">$length</span> - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="variable">$low</span> &lt;= <span class="variable">$high</span>) &#123;</span><br><span class="line"><span class="comment">//        $mid = $low + ($high - $low) / 2;</span></span><br><span class="line">        <span class="comment">// è·å–ä¸­é—´å€¼</span></span><br><span class="line">        <span class="variable">$mid</span> = <span class="variable">$low</span> + ((<span class="variable">$high</span> - <span class="variable">$low</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$numbers</span>[<span class="variable">$mid</span>] == <span class="variable">$value</span>) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœ mid ç­‰äº 0ï¼Œé‚£è¿™ä¸ªå…ƒç´ å·²ç»æ˜¯æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œé‚£å®ƒè‚¯å®šæ˜¯æˆ‘ä»¬è¦æ‰¾çš„ï¼›</span></span><br><span class="line">            <span class="comment">// å¦‚æœ mid ä¸ç­‰äº 0ï¼Œä½† a[mid]çš„å‰ä¸€ä¸ªå…ƒç´  a[mid-1]ä¸ç­‰äº valueï¼Œé‚£ä¹Ÿè¯´æ˜ a[mid]å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„ç¬¬ä¸€ä¸ªå€¼ç­‰äºç»™å®šå€¼çš„å…ƒç´ ã€‚</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$mid</span> == <span class="number">0</span> || (<span class="variable">$numbers</span>[<span class="variable">$mid</span> - <span class="number">1</span>] != <span class="variable">$numbers</span>[<span class="variable">$mid</span>])) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$mid</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// a[mid]çš„å‰ä¸€ä¸ªå…ƒç´  a[mid-1]ç­‰äº valueï¼Œ è¯´æ˜å…ƒç´ åœ¨æ›´å°çš„åŒºé—´[low, mid - 1]</span></span><br><span class="line">                <span class="variable">$high</span> = <span class="variable">$mid</span> - <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (<span class="variable">$numbers</span>[<span class="variable">$mid</span>] &lt; <span class="variable">$value</span>) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœæŸ¥æ‰¾çš„å€¼å¤§äºä¸­é—´å€¼ï¼Œè¦æ‰¾çš„å…ƒç´ åœ¨[mid + 1, high]ä¹‹é—´</span></span><br><span class="line">            <span class="variable">$low</span> = <span class="variable">$mid</span> + <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$high</span> = <span class="variable">$mid</span> - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$numbers</span> = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">22</span>,<span class="number">22</span>,<span class="number">33</span>,<span class="number">33</span>,<span class="number">55</span>,<span class="number">77</span>,<span class="number">99</span>];</span><br><span class="line"><span class="variable">$index</span> = <span class="title function_ invoke__">bSearch</span>(<span class="variable">$numbers</span>, <span class="title function_ invoke__">count</span>(<span class="variable">$numbers</span>), <span class="number">22</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$index</span>, <span class="variable">$numbers</span>[<span class="variable">$index</span>]);</span><br></pre></td></tr></table></figure><h3 id="æŸ¥æ‰¾æœ€åä¸€ä¸ªå€¼ç­‰äºç»™å®šå€¼çš„å…ƒç´ "><a href="#æŸ¥æ‰¾æœ€åä¸€ä¸ªå€¼ç­‰äºç»™å®šå€¼çš„å…ƒç´ " class="headerlink" title="æŸ¥æ‰¾æœ€åä¸€ä¸ªå€¼ç­‰äºç»™å®šå€¼çš„å…ƒç´ "></a>æŸ¥æ‰¾æœ€åä¸€ä¸ªå€¼ç­‰äºç»™å®šå€¼çš„å…ƒç´ </h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * äºŒåˆ†æŸ¥æ‰¾</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> array $numbers</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int $length æ•°ç»„é•¿åº¦</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int $value è¦æŸ¥æ‰¾çš„å€¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> int</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bSearch</span>(<span class="params"><span class="variable">$numbers</span>, <span class="variable">$length</span>, <span class="variable">$value</span></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// å¼€å§‹å’Œç»“æŸä¸‹æ ‡</span></span><br><span class="line">    <span class="variable">$low</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$high</span> = <span class="variable">$length</span> - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="variable">$low</span> &lt;= <span class="variable">$high</span>) &#123;</span><br><span class="line"><span class="comment">//        $mid = $low + ($high - $low) / 2;</span></span><br><span class="line">        <span class="comment">// è·å–ä¸­é—´å€¼</span></span><br><span class="line">        <span class="variable">$mid</span> = <span class="variable">$low</span> + ((<span class="variable">$high</span> - <span class="variable">$low</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$numbers</span>[<span class="variable">$mid</span>] == <span class="variable">$value</span>) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœå…ƒç´ å·²ç»æ˜¯æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œé‚£å®ƒè‚¯å®šæ˜¯æˆ‘ä»¬è¦æ‰¾çš„ï¼›</span></span><br><span class="line">            <span class="comment">// å¦‚æœå…ƒç´ æ˜¯æœ€åä¸€ä¸ªå…ƒç´ ï¼Œä½† a[mid]çš„åä¸€ä¸ªå…ƒç´  a[mid+1]ä¸ç­‰äº valueï¼Œé‚£ä¹Ÿè¯´æ˜ a[mid]å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„æœ€åä¸€ä¸ªå€¼ç­‰äºç»™å®šå€¼çš„å…ƒç´ ã€‚</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$mid</span> == <span class="variable">$length</span> - <span class="number">1</span> || (<span class="variable">$numbers</span>[<span class="variable">$mid</span> + <span class="number">1</span>] != <span class="variable">$numbers</span>[<span class="variable">$mid</span>])) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$mid</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// a[mid]çš„å‰ä¸€ä¸ªå…ƒç´  a[mid-1]ç­‰äº valueï¼Œ è¯´æ˜å…ƒç´ åœ¨æ›´å°çš„åŒºé—´[mid+1, high]</span></span><br><span class="line">                <span class="variable">$low</span> = <span class="variable">$mid</span> + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (<span class="variable">$numbers</span>[<span class="variable">$mid</span>] &lt; <span class="variable">$value</span>) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœæŸ¥æ‰¾çš„å€¼å¤§äºä¸­é—´å€¼ï¼Œè¦æ‰¾çš„å…ƒç´ åœ¨[mid + 1, high]ä¹‹é—´</span></span><br><span class="line">            <span class="variable">$low</span> = <span class="variable">$mid</span> + <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$high</span> = <span class="variable">$mid</span> - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$numbers</span> = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">22</span>,<span class="number">22</span>,<span class="number">33</span>,<span class="number">33</span>,<span class="number">55</span>,<span class="number">77</span>,<span class="number">99</span>];</span><br><span class="line"><span class="variable">$index</span> = <span class="title function_ invoke__">bSearch</span>(<span class="variable">$numbers</span>, <span class="title function_ invoke__">count</span>(<span class="variable">$numbers</span>), <span class="number">22</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$index</span>, <span class="variable">$numbers</span>[<span class="variable">$index</span>]);</span><br></pre></td></tr></table></figure><h3 id="æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå¤§äºç­‰äºç»™å®šå€¼çš„å…ƒç´ "><a href="#æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå¤§äºç­‰äºç»™å®šå€¼çš„å…ƒç´ " class="headerlink" title="æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå¤§äºç­‰äºç»™å®šå€¼çš„å…ƒç´ "></a>æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå¤§äºç­‰äºç»™å®šå€¼çš„å…ƒç´ </h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * äºŒåˆ†æŸ¥æ‰¾</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> array $numbers</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int $length æ•°ç»„é•¿åº¦</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int $value è¦æŸ¥æ‰¾çš„å€¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> int</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bSearch</span>(<span class="params"><span class="variable">$numbers</span>, <span class="variable">$length</span>, <span class="variable">$value</span></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// å¼€å§‹å’Œç»“æŸä¸‹æ ‡</span></span><br><span class="line">    <span class="variable">$low</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$high</span> = <span class="variable">$length</span> - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="variable">$low</span> &lt;= <span class="variable">$high</span>) &#123;</span><br><span class="line"><span class="comment">//        $mid = $low + ($high - $low) / 2;</span></span><br><span class="line">        <span class="comment">// è·å–ä¸­é—´å€¼</span></span><br><span class="line">        <span class="variable">$mid</span> = <span class="variable">$low</span> + ((<span class="variable">$high</span> - <span class="variable">$low</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$numbers</span>[<span class="variable">$mid</span>] &gt;= <span class="variable">$value</span>) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœ mid ç­‰äº 0ï¼Œé‚£è¿™ä¸ªå…ƒç´ å·²ç»æ˜¯æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œé‚£å®ƒè‚¯å®šæ˜¯æˆ‘ä»¬è¦æ‰¾çš„ï¼›</span></span><br><span class="line">            <span class="comment">// å¦‚æœ mid ä¸ç­‰äº 0ï¼Œä½† a[mid]çš„å‰ä¸€ä¸ªå…ƒç´  a[mid-1] å°äº valueï¼Œé‚£ä¹Ÿè¯´æ˜ a[mid]å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„ç¬¬ä¸€ä¸ªå€¼å¤§äºç­‰äºç»™å®šå€¼çš„å…ƒç´ ã€‚</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$mid</span> == <span class="number">0</span> || (<span class="variable">$numbers</span>[<span class="variable">$mid</span> - <span class="number">1</span>] &lt; <span class="variable">$numbers</span>[<span class="variable">$mid</span>])) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$mid</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// a[mid]çš„å‰ä¸€ä¸ªå…ƒç´  a[mid-1]ç­‰äº valueï¼Œ è¯´æ˜å…ƒç´ åœ¨æ›´å°çš„åŒºé—´[mid+1, high]</span></span><br><span class="line">                <span class="variable">$high</span> = <span class="variable">$mid</span> - <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœæŸ¥æ‰¾çš„å€¼å¤§äºä¸­é—´å€¼ï¼Œè¦æ‰¾çš„å…ƒç´ åœ¨[mid + 1, high]ä¹‹é—´</span></span><br><span class="line">            <span class="variable">$low</span> = <span class="variable">$mid</span> + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$numbers</span> = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">22</span>,<span class="number">22</span>,<span class="number">33</span>,<span class="number">33</span>,<span class="number">55</span>,<span class="number">77</span>,<span class="number">99</span>];</span><br><span class="line"><span class="variable">$index</span> = <span class="title function_ invoke__">bSearch</span>(<span class="variable">$numbers</span>, <span class="title function_ invoke__">count</span>(<span class="variable">$numbers</span>), <span class="number">22</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$index</span>, <span class="variable">$numbers</span>[<span class="variable">$index</span>]);</span><br></pre></td></tr></table></figure><h3 id="æŸ¥æ‰¾æœ€åä¸€ä¸ªå°äºç­‰äºç»™å®šå€¼çš„å…ƒç´ "><a href="#æŸ¥æ‰¾æœ€åä¸€ä¸ªå°äºç­‰äºç»™å®šå€¼çš„å…ƒç´ " class="headerlink" title="æŸ¥æ‰¾æœ€åä¸€ä¸ªå°äºç­‰äºç»™å®šå€¼çš„å…ƒç´ "></a>æŸ¥æ‰¾æœ€åä¸€ä¸ªå°äºç­‰äºç»™å®šå€¼çš„å…ƒç´ </h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * äºŒåˆ†æŸ¥æ‰¾</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> array $numbers</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int $length æ•°ç»„é•¿åº¦</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int $value è¦æŸ¥æ‰¾çš„å€¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> int</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bSearch</span>(<span class="params"><span class="variable">$numbers</span>, <span class="variable">$length</span>, <span class="variable">$value</span></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// å¼€å§‹å’Œç»“æŸä¸‹æ ‡</span></span><br><span class="line">    <span class="variable">$low</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$high</span> = <span class="variable">$length</span> - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="variable">$low</span> &lt;= <span class="variable">$high</span>) &#123;</span><br><span class="line"><span class="comment">//        $mid = $low + ($high - $low) / 2;</span></span><br><span class="line">        <span class="comment">// è·å–ä¸­é—´å€¼</span></span><br><span class="line">        <span class="variable">$mid</span> = <span class="variable">$low</span> + ((<span class="variable">$high</span> - <span class="variable">$low</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$numbers</span>[<span class="variable">$mid</span>] &lt;= <span class="variable">$value</span>) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœå…ƒç´ å·²ç»æ˜¯æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œé‚£å®ƒè‚¯å®šæ˜¯æˆ‘ä»¬è¦æ‰¾çš„ï¼›</span></span><br><span class="line">            <span class="comment">// å¦‚æœå…ƒç´ æ˜¯æœ€åä¸€ä¸ªå…ƒç´ ï¼Œä½† a[mid]çš„åä¸€ä¸ªå…ƒç´  a[mid+1]å¤§äº valueï¼Œé‚£ä¹Ÿè¯´æ˜ a[mid]å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„æœ€åä¸€ä¸ªå€¼ç­‰äºç»™å®šå€¼çš„å…ƒç´ ã€‚</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$mid</span> == <span class="variable">$length</span> - <span class="number">1</span> || <span class="variable">$numbers</span>[<span class="variable">$mid</span> + <span class="number">1</span>] &gt; <span class="variable">$numbers</span>[<span class="variable">$mid</span>]) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$mid</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// a[mid]çš„å‰ä¸€ä¸ªå…ƒç´  a[mid-1]ç­‰äº valueï¼Œ è¯´æ˜å…ƒç´ åœ¨æ›´å°çš„åŒºé—´[mid+1, high]</span></span><br><span class="line">                <span class="variable">$low</span> = <span class="variable">$mid</span> + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœæŸ¥æ‰¾çš„å€¼å¤§äºä¸­é—´å€¼ï¼Œè¦æ‰¾çš„å…ƒç´ åœ¨[mid + 1, high]ä¹‹é—´</span></span><br><span class="line">            <span class="variable">$high</span> = <span class="variable">$mid</span> - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$numbers</span> = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">22</span>,<span class="number">22</span>,<span class="number">33</span>,<span class="number">33</span>,<span class="number">55</span>,<span class="number">77</span>,<span class="number">99</span>];</span><br><span class="line"><span class="variable">$index</span> = <span class="title function_ invoke__">bSearch</span>(<span class="variable">$numbers</span>, <span class="title function_ invoke__">count</span>(<span class="variable">$numbers</span>), <span class="number">22</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$index</span>, <span class="variable">$numbers</span>[<span class="variable">$index</span>]);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŸºæ•°æ’åº</title>
      <link href="/posts/6367b42a.html"/>
      <url>/posts/6367b42a.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€åŸç†"><a href="#ä¸€ã€åŸç†" class="headerlink" title="ä¸€ã€åŸç†"></a>ä¸€ã€åŸç†</h1><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">å°†æ•´æ•°æŒ‰ä½æ•°åˆ‡å‰²æˆä¸åŒçš„æ•°å­—ï¼Œç„¶åæŒ‰æ¯ä¸ªä½æ•°åˆ†åˆ«æ¯”è¾ƒã€‚</span><br><span class="line">ç”±äºæ•´æ•°ä¹Ÿå¯ä»¥è¡¨è¾¾å­—ç¬¦ä¸²ï¼ˆæ¯”å¦‚åå­—æˆ–æ—¥æœŸï¼‰å’Œç‰¹å®šæ ¼å¼çš„æµ®ç‚¹æ•°ï¼Œæ‰€ä»¥åŸºæ•°æ’åºä¹Ÿä¸æ˜¯åªèƒ½ä½¿ç”¨äºæ•´æ•°ã€‚</span><br><span class="line"></span><br><span class="line">åŸºæ•°æ’åºå¯¹è¦æ’åºçš„æ•°æ®æ˜¯æœ‰è¦æ±‚çš„ï¼Œéœ€è¦å¯ä»¥åˆ†å‰²å‡ºç‹¬ç«‹çš„â€œä½â€æ¥æ¯”è¾ƒï¼Œè€Œä¸”ä½ä¹‹é—´æœ‰é€’è¿›çš„å…³ç³»ï¼Œ</span><br><span class="line">å¦‚æœ <span class="selector-tag">a</span> æ•°æ®çš„é«˜ä½æ¯” <span class="selector-tag">b</span> æ•°æ®å¤§ï¼Œé‚£å‰©ä¸‹çš„ä½ä½å°±ä¸ç”¨æ¯”è¾ƒäº†ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæ¯ä¸€ä½çš„æ•°æ®èŒƒå›´ä¸èƒ½å¤ªå¤§ï¼Œ</span><br><span class="line">è¦å¯ä»¥ç”¨çº¿æ€§æ’åºç®—æ³•æ¥æ’åºï¼Œå¦åˆ™ï¼ŒåŸºæ•°æ’åºçš„æ—¶é—´å¤æ‚åº¦å°±æ— æ³•åšåˆ° <span class="built_in">O</span>(n) äº†ã€‚</span><br></pre></td></tr></table></figure><h1 id="æ€§èƒ½"><a href="#æ€§èƒ½" class="headerlink" title="æ€§èƒ½"></a>æ€§èƒ½</h1><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ <span class="built_in">O</span>(n)ã€‚</span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€å®ç°"><a href="#ä¸‰ã€å®ç°" class="headerlink" title="ä¸‰ã€å®ç°"></a>ä¸‰ã€å®ç°</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$numbers</span> = [</span><br><span class="line">    <span class="number">1234</span>,</span><br><span class="line">    <span class="number">4321</span>,</span><br><span class="line">    <span class="number">12</span>,</span><br><span class="line">    <span class="number">31</span>,</span><br><span class="line">    <span class="number">187238</span>,</span><br><span class="line">    <span class="number">412</span>,</span><br><span class="line">];</span><br><span class="line"><span class="variable">$max</span> = <span class="title function_ invoke__">strval</span>(<span class="title function_ invoke__">max</span>(<span class="variable">$numbers</span>)); <span class="comment">// è·å–æœ€å¤§æ•°</span></span><br><span class="line"><span class="variable">$loopNum</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$max</span>); <span class="comment">// è®¡ç®—æœ€å¤§æ•°çš„é•¿åº¦ï¼Œå†³å®šå¾ªç¯æ¬¡æ•°</span></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$loopNum</span>; ++<span class="variable">$i</span>) &#123;</span><br><span class="line">    <span class="title function_ invoke__">radixSort</span>(<span class="variable">$numbers</span>, <span class="variable">$i</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$numbers</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åŸºæ•°æ’åº</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> array $numbers æ•°ç»„</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int $loopNum æ¬¡æ–¹æ•°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">radixSort</span>(<span class="params"><span class="keyword">array</span> &amp;<span class="variable">$numbers</span>, <span class="variable">$loopNum</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$length</span> = <span class="title function_ invoke__">count</span>(<span class="variable">$numbers</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$length</span> &lt;= <span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é™¤æ•°ï¼Œå†³å®šæ¯”è¾ƒçš„ä½æ•°</span></span><br><span class="line">    <span class="variable">$divisor</span> = <span class="title function_ invoke__">pow</span>(<span class="number">10</span>, <span class="variable">$loopNum</span>);</span><br><span class="line">    <span class="comment">// åˆ›å»º10ä¸ªå€¼ä¸ºNULLçš„å…ƒç´ æ•°ç»„</span></span><br><span class="line">    <span class="variable">$bucket</span> = (<span class="keyword">new</span> <span class="title class_">\SplFixedArray</span>(<span class="number">10</span>))-&gt;<span class="title function_ invoke__">toArray</span>();</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$numbers</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$number</span>) &#123;</span><br><span class="line">        <span class="variable">$index</span> = (<span class="variable">$number</span> / <span class="variable">$divisor</span>) % <span class="number">10</span>; <span class="comment">// è®¡ç®—åˆ†é…åˆ°å“ªä¸ªæ¡¶</span></span><br><span class="line">        <span class="variable">$bucket</span>[<span class="variable">$index</span>][] = <span class="variable">$number</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä»æ¡¶ä¸­è·å–æ•°æ®</span></span><br><span class="line">    <span class="variable">$k</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">10</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="title function_ invoke__">count</span>(<span class="variable">$bucket</span>[<span class="variable">$i</span>]) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// å°†bucketç¬¬ä¸€ä¸ªå…ƒç´ å¼¹å‡ºï¼Œå¹¶èµ‹å€¼ç»™numberæ•°ç»„ï¼ŒåŒæ—¶k + 1</span></span><br><span class="line">            <span class="variable">$numbers</span>[<span class="variable">$k</span>++] = <span class="title function_ invoke__">array_shift</span>(<span class="variable">$bucket</span>[<span class="variable">$i</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¡¶æ’åº</title>
      <link href="/posts/9fe164cc.html"/>
      <url>/posts/9fe164cc.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€åŸç†"><a href="#ä¸€ã€åŸç†" class="headerlink" title="ä¸€ã€åŸç†"></a>ä¸€ã€åŸç†</h1><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æ ¸å¿ƒæ€æƒ³æ˜¯å°†è¦æ’åºçš„æ•°æ®åˆ†åˆ°å‡ ä¸ªæœ‰åºçš„æ¡¶é‡Œï¼Œæ¯ä¸ªæ¡¶é‡Œçš„æ•°æ®å†å•ç‹¬è¿›è¡Œæ’åºã€‚</span><br><span class="line">æ¡¶å†…æ’å®Œåºä¹‹åï¼Œå†æŠŠæ¯ä¸ªæ¡¶é‡Œçš„æ•°æ®æŒ‰ç…§é¡ºåºä¾æ¬¡å–å‡ºï¼Œç»„æˆçš„åºåˆ—å°±æ˜¯æœ‰åºçš„äº†ã€‚</span><br></pre></td></tr></table></figure><h1 id="æ€§èƒ½"><a href="#æ€§èƒ½" class="headerlink" title="æ€§èƒ½"></a>æ€§èƒ½</h1><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ <span class="built_in">O</span>(n)ã€‚</span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€å®ç°"><a href="#ä¸‰ã€å®ç°" class="headerlink" title="ä¸‰ã€å®ç°"></a>ä¸‰ã€å®ç°</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$numbers</span> = [<span class="number">11</span>,<span class="number">23</span>,<span class="number">45</span>,<span class="number">67</span>,<span class="number">88</span>,<span class="number">99</span>,<span class="number">22</span>,<span class="number">34</span>,<span class="number">56</span>,<span class="number">78</span>,<span class="number">90</span>,<span class="number">12</span>,<span class="number">34</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">91</span>,<span class="number">92</span>,<span class="number">93</span>,<span class="number">93</span>,<span class="number">94</span>,<span class="number">95</span>,<span class="number">94</span>,<span class="number">95</span>,<span class="number">96</span>,<span class="number">97</span>,<span class="number">98</span>,<span class="number">99</span>,<span class="number">100</span>];</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">bucketSort</span>(<span class="variable">$numbers</span>, <span class="number">10</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ‰§è¡Œæ¡¶æ’åº</span></span><br><span class="line"><span class="comment"> * å½“ä¸€ä¸ªæ¡¶å†…æ•°æ®ä¸ªæ•°è¿‡å¤šï¼Œéœ€è¦ç»§ç»­åˆ†æ¡¶</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> array $numbers éœ€è¦æ’åºçš„æ•°ç»„</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int $size æ¯ä¸ªæ¡¶æ•°æ®ä¸ªæ•°</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bucketSort</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$numbers</span>, <span class="variable">$size</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$min</span> = <span class="title function_ invoke__">min</span>(<span class="variable">$numbers</span>);</span><br><span class="line">    <span class="variable">$max</span> = <span class="title function_ invoke__">max</span>(<span class="variable">$numbers</span>);</span><br><span class="line">    <span class="variable">$length</span> = <span class="title function_ invoke__">count</span>(<span class="variable">$numbers</span>);</span><br><span class="line">    <span class="comment">// è·å¾—æ¡¶æ•°é‡</span></span><br><span class="line">    <span class="variable">$bucketNumber</span> =  <span class="title function_ invoke__">ceil</span>((<span class="variable">$max</span> - <span class="variable">$min</span>) / <span class="variable">$length</span>) + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$buckets</span> = [];</span><br><span class="line">    <span class="comment">// å°†æ•°æ®åˆ†é…åˆ°æ¡¶ä¸­</span></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$numbers</span> <span class="keyword">as</span> <span class="variable">$value</span>) &#123;</span><br><span class="line">        <span class="variable">$index</span> = <span class="title function_ invoke__">ceil</span>((<span class="variable">$value</span> - <span class="variable">$min</span>) / <span class="variable">$length</span>);</span><br><span class="line">        <span class="variable">$buckets</span>[<span class="variable">$index</span>][] = <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$result</span> = [];</span><br><span class="line">    <span class="comment">// å¯¹æ¯ä¸ªæ¡¶è¿›è¡Œå¿«é€Ÿæ’åº</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>;<span class="variable">$i</span> &lt; <span class="variable">$bucketNumber</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="comment">// è·å–æ¡¶æ•°æ®ä»¥åŠæ¡¶æ•°æ®ä¸ªæ•°</span></span><br><span class="line">        <span class="variable">$bucket</span> = <span class="variable">$buckets</span>[<span class="variable">$i</span>];</span><br><span class="line">        <span class="variable">$length</span> = <span class="title function_ invoke__">count</span>(<span class="variable">$bucket</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$length</span> == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å½“æ¡¶çš„å…ƒç´ è¶…è¿‡10ä¸ªï¼Œåˆ™å†æ¬¡è¿›è¡Œåˆ†æ¡¶</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$length</span> &gt; <span class="variable">$size</span>) &#123;</span><br><span class="line">            <span class="variable">$bucket</span> = <span class="title function_ invoke__">bucketSort</span>(<span class="variable">$bucket</span>, <span class="variable">$size</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="title function_ invoke__">quickSortInternally</span>(<span class="variable">$bucket</span>, <span class="number">0</span>, <span class="title function_ invoke__">count</span>(<span class="variable">$bucket</span>) - <span class="number">1</span>);</span><br><span class="line">        <span class="variable">$result</span> = <span class="title function_ invoke__">array_merge</span>(<span class="variable">$result</span>, <span class="variable">$bucket</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$result</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ‰§è¡Œå¿«é€Ÿæ’åº</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> array $arr</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int $start å¼€å§‹ä¸‹æ ‡</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int $end ç»“æŸä¸‹æ ‡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">quickSortInternally</span>(<span class="params">&amp;<span class="variable">$arr</span>, <span class="variable">$start</span>, <span class="variable">$end</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$start</span> &gt;= <span class="variable">$end</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–ä¸­é—´ç‚¹ä½ç½®</span></span><br><span class="line">    <span class="variable">$middle</span> = <span class="title function_ invoke__">partition</span>(<span class="variable">$arr</span>, <span class="variable">$start</span>, <span class="variable">$end</span>);</span><br><span class="line">    <span class="title function_ invoke__">quickSortInternally</span>(<span class="variable">$arr</span>, <span class="variable">$start</span>, <span class="variable">$middle</span> - <span class="number">1</span>);</span><br><span class="line">    <span class="title function_ invoke__">quickSortInternally</span>(<span class="variable">$arr</span>, <span class="variable">$middle</span> + <span class="number">1</span>, <span class="variable">$end</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * äº¤æ¢æ•°æ®è¿›è¡Œæ’åºï¼Œè·å–ä¸­é—´ç‚¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $arr</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $start</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $end</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> mixed</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">partition</span>(<span class="params">&amp;<span class="variable">$arr</span>, <span class="variable">$start</span>, <span class="variable">$end</span></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// å°†æœ€åä¸€ä¸ªä½œä¸ºä¸­é—´ç‚¹</span></span><br><span class="line">    <span class="variable">$pivot</span> = <span class="variable">$arr</span>[<span class="variable">$end</span>];</span><br><span class="line">    <span class="variable">$i</span> = <span class="variable">$start</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä»$startä¸‹æ ‡éå†</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="variable">$start</span>; <span class="variable">$j</span> &lt; <span class="variable">$end</span>; ++<span class="variable">$j</span>) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœéå†çš„å…ƒç´ å°äºä¸­é—´ç‚¹ï¼Œå¹¶ä¸”ä¸‹æ ‡ä¸ç›¸åŒï¼Œåˆ™äº¤æ¢ä¸¤ä¸ªæ•°æ®</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$arr</span>[<span class="variable">$j</span>] &lt; <span class="variable">$pivot</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$i</span> == <span class="variable">$j</span>) &#123;</span><br><span class="line">                <span class="variable">$i</span>++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$tmp</span> = <span class="variable">$arr</span>[<span class="variable">$i</span>];</span><br><span class="line">                <span class="variable">$arr</span>[<span class="variable">$i</span>] = <span class="variable">$arr</span>[<span class="variable">$j</span>];</span><br><span class="line">                <span class="variable">$i</span>++;</span><br><span class="line">                <span class="variable">$arr</span>[<span class="variable">$j</span>] = <span class="variable">$tmp</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†æœ€åä¸€ä¸ªæ•°æ®å’Œ$iäº¤æ¢æ•°æ®ï¼Œ$iä¸ºæœªå¤„ç†æ•°æ®çš„ä¸‹æ ‡</span></span><br><span class="line">    <span class="variable">$tmp</span> = <span class="variable">$arr</span>[<span class="variable">$i</span>];</span><br><span class="line">    <span class="variable">$arr</span>[<span class="variable">$i</span>] = <span class="variable">$arr</span>[<span class="variable">$end</span>];</span><br><span class="line">    <span class="variable">$arr</span>[<span class="variable">$end</span>] = <span class="variable">$tmp</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$i</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¡æ•°æ’åº</title>
      <link href="/posts/cb625b07.html"/>
      <url>/posts/cb625b07.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€åŸç†"><a href="#ä¸€ã€åŸç†" class="headerlink" title="ä¸€ã€åŸç†"></a>ä¸€ã€åŸç†</h1><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è®¡æ•°æ’åºå…¶å®æ˜¯æ¡¶æ’åºçš„ä¸€ç§ç‰¹æ®Šæƒ…å†µã€‚å½“è¦æ’åºçš„ <span class="built_in">n</span> ä¸ªæ•°æ®ï¼Œæ‰€å¤„çš„èŒƒå›´å¹¶ä¸å¤§çš„æ—¶å€™ï¼Œæ¯”å¦‚æœ€å¤§å€¼æ˜¯ kï¼Œ</span><br><span class="line">æˆ‘ä»¬å°±å¯ä»¥æŠŠæ•°æ®åˆ’åˆ†æˆ k ä¸ªæ¡¶ã€‚æ¯ä¸ªæ¡¶å†…çš„æ•°æ®å€¼éƒ½æ˜¯ç›¸åŒçš„ï¼Œçœæ‰äº†æ¡¶å†…æ’åºçš„æ—¶é—´ã€‚</span><br><span class="line"></span><br><span class="line">è®¡æ•°æ’åºåªèƒ½ç”¨åœ¨æ•°æ®èŒƒå›´ä¸å¤§çš„åœºæ™¯ä¸­ï¼Œå¦‚æœæ•°æ®èŒƒå›´ k æ¯”è¦æ’åºçš„æ•°æ® <span class="built_in">n</span> å¤§å¾ˆå¤šï¼Œå°±ä¸é€‚åˆç”¨è®¡æ•°æ’åºäº†ã€‚è€Œä¸”ï¼Œè®¡æ•°æ’åºåªèƒ½ç»™éè´Ÿæ•´æ•°æ’åºï¼Œå¦‚æœè¦æ’åºçš„æ•°æ®æ˜¯å…¶ä»–ç±»å‹çš„ï¼Œè¦å°†å…¶åœ¨ä¸æ”¹å˜ç›¸å¯¹å¤§å°çš„æƒ…å†µä¸‹ï¼Œè½¬åŒ–ä¸ºéè´Ÿæ•´æ•°ã€‚</span><br></pre></td></tr></table></figure><h1 id="æ€§èƒ½"><a href="#æ€§èƒ½" class="headerlink" title="æ€§èƒ½"></a>æ€§èƒ½</h1><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ <span class="built_in">O</span>(n)ã€‚</span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€å®ç°"><a href="#ä¸‰ã€å®ç°" class="headerlink" title="ä¸‰ã€å®ç°"></a>ä¸‰ã€å®ç°</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$numbers</span> = [<span class="number">11</span>,<span class="number">23</span>,<span class="number">45</span>,<span class="number">67</span>,<span class="number">88</span>,<span class="number">99</span>,<span class="number">22</span>,<span class="number">34</span>,<span class="number">56</span>,<span class="number">78</span>,<span class="number">90</span>,<span class="number">12</span>,<span class="number">34</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">91</span>,<span class="number">92</span>,<span class="number">93</span>,<span class="number">93</span>,<span class="number">94</span>,<span class="number">95</span>,<span class="number">94</span>,<span class="number">95</span>,<span class="number">96</span>,<span class="number">97</span>,<span class="number">98</span>,<span class="number">99</span>,<span class="number">100</span>];</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">countSort</span>(<span class="variable">$numbers</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è®¡æ•°æ’åº</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> array $numbers éœ€è¦æ’åºçš„æ•°ç»„ </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">countSort</span>(<span class="params"><span class="variable">$numbers</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$length</span> = <span class="title function_ invoke__">count</span>(<span class="variable">$numbers</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$length</span> &lt;= <span class="number">1</span>) <span class="keyword">return</span> <span class="variable">$numbers</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$max</span> = <span class="title function_ invoke__">max</span>(<span class="variable">$numbers</span>);</span><br><span class="line">    <span class="comment">// ç»Ÿè®¡æ¯ä¸ªåˆ†æ•°çš„äººæ•°</span></span><br><span class="line">    <span class="variable">$countArr</span> = [];</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$numbers</span> <span class="keyword">as</span> <span class="variable">$number</span>) &#123;</span><br><span class="line">        <span class="variable">$countArr</span>[<span class="variable">$number</span>]++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é¡ºåºæ±‚å’Œ</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">1</span>; <span class="variable">$i</span> &lt;= <span class="variable">$max</span>; ++<span class="variable">$i</span>) &#123;</span><br><span class="line">        <span class="variable">$countArr</span>[<span class="variable">$i</span>] += <span class="variable">$countArr</span>[<span class="variable">$i</span> - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ’åº</span></span><br><span class="line">    <span class="variable">$temp</span> = [];</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$numbers</span> <span class="keyword">as</span> <span class="variable">$index</span> =&gt; <span class="variable">$number</span>) &#123;</span><br><span class="line">        <span class="comment">// æ¯æ¬¡å¾ªç¯ï¼Œè®¡æ•°æ•°ç»„çš„å…ƒç´ å€¼å‡ä¸€ï¼Œå› ä¸ºæ•°ç»„æ”¾åˆ°äº†tempæ•°ç»„ä¸­</span></span><br><span class="line">        <span class="comment">// ç”±äºä¸‹æ ‡0å¼€å§‹ï¼Œæ‰€ä»¥ä½¿ç”¨-1åçš„å…ƒç´ çš„å€¼ä¸ºkey</span></span><br><span class="line">        <span class="variable">$countArr</span>[<span class="variable">$number</span>] --;</span><br><span class="line">        <span class="variable">$temp</span>[<span class="variable">$countArr</span>[<span class="variable">$number</span>]] = <span class="variable">$number</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$length</span>; ++<span class="variable">$i</span>) &#123;</span><br><span class="line">        <span class="variable">$numbers</span>[<span class="variable">$i</span>] = <span class="variable">$temp</span>[<span class="variable">$i</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$numbers</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¿«é€Ÿæ’åº</title>
      <link href="/posts/ff8068c0.html"/>
      <url>/posts/ff8068c0.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h1><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å¿«æ’åˆ©ç”¨çš„ä¹Ÿæ˜¯åˆ†æ²»æ€æƒ³ã€‚ä¹çœ‹èµ·æ¥ï¼Œå®ƒæœ‰ç‚¹åƒå¿«é€Ÿæ’åºï¼Œä½†æ˜¯æ€è·¯å…¶å®å®Œå…¨ä¸ä¸€æ ·ã€‚æˆ‘ä»¬å¾…ä¼šä¼šè®²ä¸¤è€…çš„åŒºåˆ«ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹å¿«æ’çš„æ ¸å¿ƒæ€æƒ³ã€‚</span><br><span class="line">å¿«æ’çš„æ€æƒ³æ˜¯è¿™æ ·çš„ï¼šå¦‚æœè¦æ’åºæ•°ç»„ä¸­ä¸‹æ ‡ä» <span class="selector-tag">p</span> åˆ° <span class="attribute">r</span> ä¹‹é—´çš„ä¸€ç»„æ•°æ®ï¼Œæˆ‘ä»¬é€‰æ‹© <span class="selector-tag">p</span> åˆ° <span class="attribute">r</span> ä¹‹é—´çš„ä»»æ„ä¸€ä¸ªæ•°æ®ä½œä¸º pivotï¼ˆåˆ†åŒºç‚¹ï¼‰ã€‚</span><br><span class="line">æˆ‘ä»¬éå† <span class="selector-tag">p</span> åˆ° <span class="attribute">r</span> ä¹‹é—´çš„æ•°æ®ï¼Œå°†å°äº pivot çš„æ”¾åˆ°å·¦è¾¹ï¼Œå°†å¤§äº pivot çš„æ”¾åˆ°å³è¾¹ï¼Œå°† pivot æ”¾åˆ°ä¸­é—´ã€‚ç»è¿‡è¿™ä¸€æ­¥éª¤ä¹‹åï¼Œæ•°ç»„ <span class="selector-tag">p</span> åˆ° <span class="attribute">r</span> ä¹‹é—´çš„æ•°æ®å°±è¢«åˆ†æˆäº†ä¸‰ä¸ªéƒ¨åˆ†ï¼Œå‰é¢ <span class="selector-tag">p</span> åˆ° <span class="selector-tag">q</span>-<span class="number">1</span> ä¹‹é—´éƒ½æ˜¯å°äº pivot çš„ï¼Œä¸­é—´æ˜¯ pivotï¼Œåé¢çš„ <span class="selector-tag">q</span>+<span class="number">1</span> åˆ° <span class="attribute">r</span> ä¹‹é—´æ˜¯å¤§äº pivot çš„ã€‚ã€‚</span><br></pre></td></tr></table></figure><h1 id="å¿«æ’å’Œå½’å¹¶åŒºåˆ«"><a href="#å¿«æ’å’Œå½’å¹¶åŒºåˆ«" class="headerlink" title="å¿«æ’å’Œå½’å¹¶åŒºåˆ«"></a>å¿«æ’å’Œå½’å¹¶åŒºåˆ«</h1><p>å¿«æ’å’Œå½’å¹¶ç”¨çš„éƒ½æ˜¯åˆ†æ²»æ€æƒ³ï¼Œé€’æ¨å…¬å¼å’Œé€’å½’ä»£ç ä¹Ÿéå¸¸ç›¸ä¼¼ï¼Œé‚£å®ƒä»¬çš„åŒºåˆ«åœ¨å“ªé‡Œå‘¢ï¼Ÿ</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">å¿«é€Ÿæ’åºçš„å¤„ç†è¿‡ç¨‹æ˜¯ç”±ä¸‹åˆ°ä¸Šçš„ï¼Œå…ˆå¤„ç†å­é—®é¢˜ï¼Œç„¶åå†åˆå¹¶ã€‚</span><br><span class="line">è€Œå¿«æ’æ­£å¥½ç›¸åï¼Œå®ƒçš„å¤„ç†è¿‡ç¨‹æ˜¯ç”±ä¸Šåˆ°ä¸‹çš„ï¼Œå…ˆåˆ†åŒºï¼Œç„¶åå†å¤„ç†å­é—®é¢˜ã€‚</span><br><span class="line">å¿«é€Ÿæ’åºè™½ç„¶æ˜¯ç¨³å®šçš„ã€æ—¶é—´å¤æ‚åº¦ä¸º <span class="built_in">O</span>(nlogn) çš„æ’åºç®—æ³•ï¼Œä½†æ˜¯å®ƒæ˜¯éåŸåœ°æ’åºç®—æ³•ã€‚</span><br><span class="line">æˆ‘ä»¬å‰é¢è®²è¿‡ï¼Œå½’å¹¶ä¹‹æ‰€ä»¥æ˜¯éåŸåœ°æ’åºç®—æ³•ï¼Œä¸»è¦åŸå› æ˜¯åˆå¹¶å‡½æ•°æ— æ³•åœ¨åŸåœ°æ‰§è¡Œã€‚</span><br><span class="line">å¿«é€Ÿæ’åºé€šè¿‡è®¾è®¡å·§å¦™çš„åŸåœ°åˆ†åŒºå‡½æ•°ï¼Œå¯ä»¥å®ç°åŸåœ°æ’åºï¼Œè§£å†³äº†å¿«é€Ÿæ’åºå ç”¨å¤ªå¤šå†…å­˜çš„é—®é¢˜ã€‚</span><br></pre></td></tr></table></figure><h1 id="æ€§èƒ½"><a href="#æ€§èƒ½" class="headerlink" title="æ€§èƒ½"></a>æ€§èƒ½</h1><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ç¬¬ä¸€ï¼Œå¿«é€Ÿæ’åºæ˜¯ç¨³å®šçš„æ’åºç®—æ³•å—ï¼Ÿ</span><br><span class="line">å¿«é€Ÿæ’åºä¸æ˜¯ä¸€ä¸ªç¨³å®šçš„æ’åºç®—æ³•ã€‚  </span><br><span class="line"></span><br><span class="line">ç¬¬äºŒï¼Œå¿«é€Ÿæ’åºçš„æ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘ï¼Ÿ</span><br><span class="line">æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ <span class="built_in">O</span>(nlogn)ã€‚  </span><br><span class="line"></span><br><span class="line">ç¬¬ä¸‰ï¼Œå¿«é€Ÿæ’åºçš„ç©ºé—´å¤æ‚åº¦æ˜¯å¤šå°‘ï¼Ÿ</span><br><span class="line">é‡‡ç”¨åŸåœ°æ’åºï¼Œæ‰€ä»¥ç©ºé—´å¤æ‚åº¦æ˜¯ <span class="built_in">O</span>(<span class="number">1</span>)ã€‚</span><br></pre></td></tr></table></figure><h1 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¿«é€Ÿæ’åº</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> array $arr</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">quickSort</span>(<span class="params">&amp;<span class="variable">$arr</span></span>) </span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">quickSortInternally</span>(<span class="variable">$arr</span>, <span class="number">0</span>, <span class="title function_ invoke__">count</span>(<span class="variable">$arr</span>) - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ‰§è¡Œå¿«é€Ÿæ’åº</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> array $arr</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int $start å¼€å§‹ä¸‹æ ‡</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int $end ç»“æŸä¸‹æ ‡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">quickSortInternally</span>(<span class="params">&amp;<span class="variable">$arr</span>, <span class="variable">$start</span>, <span class="variable">$end</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$start</span> &gt;= <span class="variable">$end</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–ä¸­é—´ç‚¹ä½ç½®</span></span><br><span class="line">    <span class="variable">$middle</span> = <span class="title function_ invoke__">partition</span>(<span class="variable">$arr</span>, <span class="variable">$start</span>, <span class="variable">$end</span>);</span><br><span class="line">    <span class="title function_ invoke__">quickSortInternally</span>(<span class="variable">$arr</span>, <span class="variable">$start</span>, <span class="variable">$middle</span> - <span class="number">1</span>);</span><br><span class="line">    <span class="title function_ invoke__">quickSortInternally</span>(<span class="variable">$arr</span>, <span class="variable">$middle</span> + <span class="number">1</span>, <span class="variable">$end</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * äº¤æ¢æ•°æ®è¿›è¡Œæ’åºï¼Œè·å–ä¸­é—´ç‚¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $arr</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $start</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $end</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> mixed</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">partition</span>(<span class="params">&amp;<span class="variable">$arr</span>, <span class="variable">$start</span>, <span class="variable">$end</span></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// å°†æœ€åä¸€ä¸ªä½œä¸ºä¸­é—´ç‚¹</span></span><br><span class="line">    <span class="variable">$pivot</span> = <span class="variable">$arr</span>[<span class="variable">$end</span>];</span><br><span class="line">    <span class="variable">$i</span> = <span class="variable">$start</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä»$startä¸‹æ ‡éå†</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="variable">$start</span>; <span class="variable">$j</span> &lt; <span class="variable">$end</span>; ++<span class="variable">$j</span>) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœéå†çš„å…ƒç´ å°äºä¸­é—´ç‚¹ï¼Œå¹¶ä¸”ä¸‹æ ‡ä¸ç›¸åŒï¼Œåˆ™äº¤æ¢ä¸¤ä¸ªæ•°æ®</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$arr</span>[<span class="variable">$j</span>] &lt; <span class="variable">$pivot</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$i</span> == <span class="variable">$j</span>) &#123;</span><br><span class="line">                <span class="variable">$i</span>++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$tmp</span> = <span class="variable">$arr</span>[<span class="variable">$i</span>];</span><br><span class="line">                <span class="variable">$arr</span>[<span class="variable">$i</span>] = <span class="variable">$arr</span>[<span class="variable">$j</span>];</span><br><span class="line">                <span class="variable">$i</span>++;</span><br><span class="line">                <span class="variable">$arr</span>[<span class="variable">$j</span>] = <span class="variable">$tmp</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†æœ€åä¸€ä¸ªæ•°æ®å’Œ$iäº¤æ¢æ•°æ®ï¼Œ$iä¸ºæœªå¤„ç†æ•°æ®çš„ä¸‹æ ‡</span></span><br><span class="line">    <span class="variable">$tmp</span> = <span class="variable">$arr</span>[<span class="variable">$i</span>];</span><br><span class="line">    <span class="variable">$arr</span>[<span class="variable">$i</span>] = <span class="variable">$arr</span>[<span class="variable">$end</span>];</span><br><span class="line">    <span class="variable">$arr</span>[<span class="variable">$end</span>] = <span class="variable">$tmp</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$i</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a1</span> = [<span class="number">10</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>];</span><br><span class="line"><span class="title function_ invoke__">quickSort</span>(<span class="variable">$a1</span>);</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="variable">$a1</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†’æ³¡æ’åº</title>
      <link href="/posts/7430112.html"/>
      <url>/posts/7430112.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€åŸç†"><a href="#ä¸€ã€åŸç†" class="headerlink" title="ä¸€ã€åŸç†"></a>ä¸€ã€åŸç†</h1><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å†’æ³¡æ’åºåªä¼šæ“ä½œç›¸é‚»çš„ä¸¤ä¸ªæ•°æ®ã€‚æ¯æ¬¡å†’æ³¡æ“ä½œéƒ½ä¼šå¯¹ç›¸é‚»çš„ä¸¤ä¸ªå…ƒç´ è¿›è¡Œæ¯”è¾ƒï¼Œçœ‹æ˜¯å¦æ»¡è¶³å¤§å°å…³ç³»è¦æ±‚ã€‚  </span><br><span class="line">å¦‚æœä¸æ»¡è¶³å°±è®©å®ƒä¿©äº’æ¢ã€‚ä¸€æ¬¡å†’æ³¡ä¼šè®©è‡³å°‘ä¸€ä¸ªå…ƒç´ ç§»åŠ¨åˆ°å®ƒåº”è¯¥åœ¨çš„ä½ç½®ï¼Œé‡å¤ <span class="built_in">n</span> æ¬¡ï¼Œå°±å®Œæˆäº† <span class="built_in">n</span> ä¸ªæ•°æ®çš„æ’åºå·¥ä½œã€‚</span><br></pre></td></tr></table></figure><h1 id="äºŒã€æ€§èƒ½"><a href="#äºŒã€æ€§èƒ½" class="headerlink" title="äºŒã€æ€§èƒ½"></a>äºŒã€æ€§èƒ½</h1><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ç¬¬ä¸€ï¼Œå†’æ³¡æ’åºæ˜¯åŸåœ°æ’åºç®—æ³•å—ï¼Ÿ</span><br><span class="line">å†’æ³¡çš„è¿‡ç¨‹åªæ¶‰åŠç›¸é‚»æ•°æ®çš„äº¤æ¢æ“ä½œï¼Œåªéœ€è¦å¸¸é‡çº§çš„ä¸´æ—¶ç©ºé—´ï¼Œ</span><br><span class="line">æ‰€ä»¥å®ƒçš„ç©ºé—´å¤æ‚åº¦ä¸º <span class="built_in">O</span>(<span class="number">1</span>)ï¼Œæ˜¯ä¸€ä¸ªåŸåœ°æ’åºç®—æ³•ã€‚</span><br><span class="line"></span><br><span class="line">ç¬¬äºŒï¼Œå†’æ³¡æ’åºæ˜¯ç¨³å®šçš„æ’åºç®—æ³•å—ï¼Ÿ</span><br><span class="line">åœ¨å†’æ³¡æ’åºä¸­ï¼Œåªæœ‰äº¤æ¢æ‰å¯ä»¥æ”¹å˜ä¸¤ä¸ªå…ƒç´ çš„å‰åé¡ºåºã€‚</span><br><span class="line">ä¸ºäº†ä¿è¯å†’æ³¡æ’åºç®—æ³•çš„ç¨³å®šæ€§ï¼Œå½“æœ‰ç›¸é‚»çš„ä¸¤ä¸ªå…ƒç´ å¤§å°ç›¸ç­‰çš„æ—¶å€™ï¼Œ</span><br><span class="line">æˆ‘ä»¬ä¸åšäº¤æ¢ï¼Œç›¸åŒå¤§å°çš„æ•°æ®åœ¨æ’åºå‰åä¸ä¼šæ”¹å˜é¡ºåºï¼Œæ‰€ä»¥å†’æ³¡æ’åºæ˜¯ç¨³å®šçš„æ’åºç®—æ³•ã€‚</span><br><span class="line"></span><br><span class="line">ç¬¬ä¸‰ï¼Œå†’æ³¡æ’åºçš„æ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘ï¼Ÿ</span><br><span class="line">æœ€å¥½æƒ…å†µä¸‹ï¼Œè¦æ’åºçš„æ•°æ®å·²ç»æ˜¯æœ‰åºçš„äº†ï¼Œæˆ‘ä»¬åªéœ€è¦è¿›è¡Œä¸€æ¬¡å†’æ³¡æ“ä½œï¼Œ</span><br><span class="line">å°±å¯ä»¥ç»“æŸäº†ï¼Œæ‰€ä»¥æœ€å¥½æƒ…å†µæ—¶é—´å¤æ‚åº¦æ˜¯ <span class="built_in">O</span>(n)ã€‚</span><br><span class="line">è€Œæœ€åçš„æƒ…å†µæ˜¯ï¼Œè¦æ’åºçš„æ•°æ®åˆšå¥½æ˜¯å€’åºæ’åˆ—çš„ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œ n æ¬¡å†’æ³¡æ“ä½œï¼Œæ‰€ä»¥æœ€åæƒ…å†µæ—¶é—´å¤æ‚åº¦ä¸º <span class="built_in">O</span>(n2)ã€‚</span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€å®ç°"><a href="#ä¸‰ã€å®ç°" class="headerlink" title="ä¸‰ã€å®ç°"></a>ä¸‰ã€å®ç°</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// å†’æ³¡æ’åº</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bubbleSort</span>(<span class="params">&amp;<span class="variable">$arr</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$length</span> = <span class="title function_ invoke__">count</span>(<span class="variable">$arr</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$length</span> &lt;= <span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$length</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$flag</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>; <span class="variable">$j</span> &lt; <span class="variable">$length</span> - <span class="variable">$i</span> - <span class="number">1</span>; <span class="variable">$j</span>++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$arr</span>[<span class="variable">$j</span>] &gt; <span class="variable">$arr</span>[<span class="variable">$j</span> + <span class="number">1</span>]) &#123;</span><br><span class="line">                <span class="variable">$tmp</span> = <span class="variable">$arr</span>[<span class="variable">$j</span>];</span><br><span class="line">                <span class="variable">$arr</span>[<span class="variable">$j</span>] = <span class="variable">$arr</span>[<span class="variable">$j</span> + <span class="number">1</span>];</span><br><span class="line">                <span class="variable">$arr</span>[<span class="variable">$j</span> + <span class="number">1</span>] = <span class="variable">$tmp</span>;</span><br><span class="line">                <span class="variable">$flag</span> = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$flag</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$arr</span> = [<span class="number">1</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">4</span>];</span><br><span class="line"><span class="title function_ invoke__">bubbleSort</span>(<span class="variable">$arr</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$arr</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å½’å¹¶æ’åº</title>
      <link href="/posts/1599bffe.html"/>
      <url>/posts/1599bffe.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€åŸç†"><a href="#ä¸€ã€åŸç†" class="headerlink" title="ä¸€ã€åŸç†"></a>ä¸€ã€åŸç†</h1><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœè¦æ’åºä¸€ä¸ªæ•°ç»„ï¼Œæˆ‘ä»¬å…ˆæŠŠæ•°ç»„ä»ä¸­é—´åˆ†æˆå‰åä¸¤éƒ¨åˆ†ï¼Œ</span><br><span class="line">ç„¶åå¯¹å‰åä¸¤éƒ¨åˆ†åˆ†åˆ«æ’åºï¼Œå†å°†æ’å¥½åºçš„ä¸¤éƒ¨åˆ†åˆå¹¶åœ¨ä¸€èµ·ï¼Œè¿™æ ·æ•´ä¸ªæ•°ç»„å°±éƒ½æœ‰åºäº†ã€‚</span><br></pre></td></tr></table></figure><h1 id="æ€§èƒ½"><a href="#æ€§èƒ½" class="headerlink" title="æ€§èƒ½"></a>æ€§èƒ½</h1><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ç¬¬ä¸€ï¼Œå½’å¹¶æ’åºæ˜¯ç¨³å®šçš„æ’åºç®—æ³•å—ï¼Ÿ</span><br><span class="line">å½’å¹¶æ’åºæ˜¯ä¸€ä¸ªç¨³å®šçš„æ’åºç®—æ³•ã€‚  </span><br><span class="line"></span><br><span class="line">ç¬¬äºŒï¼Œå½’å¹¶æ’åºçš„æ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘ï¼Ÿ</span><br><span class="line">æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ <span class="built_in">O</span>(nlogn)ã€‚  </span><br><span class="line"></span><br><span class="line">ç¬¬ä¸‰ï¼Œå½’å¹¶æ’åºçš„ç©ºé—´å¤æ‚åº¦æ˜¯å¤šå°‘ï¼Ÿ</span><br><span class="line">åœ¨ä»»æ„æ—¶åˆ»ï¼ŒCPU åªä¼šæœ‰ä¸€ä¸ªå‡½æ•°åœ¨æ‰§è¡Œï¼Œä¹Ÿå°±åªä¼šæœ‰ä¸€ä¸ªä¸´æ—¶çš„å†…å­˜ç©ºé—´åœ¨ä½¿ç”¨ã€‚</span><br><span class="line">ä¸´æ—¶å†…å­˜ç©ºé—´æœ€å¤§ä¹Ÿä¸ä¼šè¶…è¿‡ n ä¸ªæ•°æ®çš„å¤§å°ï¼Œæ‰€ä»¥ç©ºé—´å¤æ‚åº¦æ˜¯ <span class="built_in">O</span>(n)ã€‚</span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€å®ç°"><a href="#ä¸‰ã€å®ç°" class="headerlink" title="ä¸‰ã€å®ç°"></a>ä¸‰ã€å®ç°</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é€’å½’è°ƒç”¨å‡½æ•°</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> array $arr æ•°ç»„</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int $p å¼€å§‹ä¸‹æ ‡</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int $r ç»“æŸä¸‹æ ‡</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mergeSortRecursive</span>(<span class="params"><span class="variable">$arr</span>, <span class="variable">$p</span>, <span class="variable">$r</span></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// å¦‚æœå·²ç»åˆ°æœ€åä¸€ä¸ªä¸‹æ ‡æ—¶ï¼Œè¿”å›æœ€åä¸€ä¸ªçš„å€¼</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$p</span> &gt;= <span class="variable">$r</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> [<span class="variable">$arr</span>[<span class="variable">$r</span>]];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ†æ²»æ€æƒ³ï¼Œè·å–ä¸­é—´ä½ç½®çš„ä¸‹æ ‡</span></span><br><span class="line">    <span class="variable">$middle</span> = <span class="title function_ invoke__">intval</span>((<span class="variable">$p</span> + <span class="variable">$r</span>) / <span class="number">2</span>);</span><br><span class="line">    <span class="comment">// é€’å½’å¯¹æ•°ç»„è¿›è¡Œåˆ†æ²»æ’åºï¼Œç„¶ååˆå¹¶æ’åºåçš„æ•°ç»„</span></span><br><span class="line">    <span class="variable">$left</span> = <span class="title function_ invoke__">mergeSortRecursive</span>(<span class="variable">$arr</span>, <span class="variable">$p</span>, <span class="variable">$middle</span>);</span><br><span class="line">    <span class="variable">$right</span> = <span class="title function_ invoke__">mergeSortRecursive</span>(<span class="variable">$arr</span>, <span class="variable">$middle</span> + <span class="number">1</span>, <span class="variable">$r</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">merge</span>(<span class="variable">$left</span>, <span class="variable">$right</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆå¹¶å‡½æ•°</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> array $left å·¦è¾¹çš„æ•°ç»„</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> array $right å³è¾¹çš„æ•°ç»„</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">merge</span>(<span class="params"><span class="variable">$left</span>, <span class="variable">$right</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$tmp</span> = [];</span><br><span class="line">    <span class="variable">$i</span> = <span class="variable">$j</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$leftLen</span> = <span class="title function_ invoke__">count</span>(<span class="variable">$left</span>);</span><br><span class="line">    <span class="variable">$rightLen</span> = <span class="title function_ invoke__">count</span>(<span class="variable">$right</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æˆ‘ä»¬ç”¨ä¸¤ä¸ªæ¸¸æ ‡ i å’Œ jï¼Œåˆ†åˆ«æŒ‡å‘ $leftå’Œ $rightçš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</span></span><br><span class="line">    <span class="comment">// æ¯”è¾ƒè¿™ä¸¤ä¸ªå…ƒç´  $left[$i]å’Œ $right[$j]ï¼Œå¦‚æœ $left[$i]&lt;=$right[$j]ï¼Œæˆ‘ä»¬å°±æŠŠ $left[$i]æ”¾å…¥åˆ°ä¸´æ—¶æ•°ç»„ $tmpï¼Œ</span></span><br><span class="line">    <span class="comment">// å¹¶ä¸” $i åç§»ä¸€ä½ï¼Œå¦åˆ™å°† $right[$j]æ”¾å…¥åˆ°æ•°ç»„ $tmpï¼Œ$j åç§»ä¸€ä½ã€‚</span></span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$left</span>[<span class="variable">$i</span>] &lt; <span class="variable">$right</span>[<span class="variable">$j</span>]) &#123;</span><br><span class="line">            <span class="variable">$tmp</span>[] = <span class="variable">$left</span>[<span class="variable">$i</span>];</span><br><span class="line">            <span class="variable">$i</span>++;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$tmp</span>[] = <span class="variable">$right</span>[<span class="variable">$j</span>];</span><br><span class="line">            <span class="variable">$j</span>++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">while</span> (<span class="variable">$i</span> &lt; <span class="variable">$leftLen</span> &amp;&amp; <span class="variable">$j</span> &lt; <span class="variable">$rightLen</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ¤æ–­è¿˜æœ‰å‰©ä½™æ•°æ®çš„æ•°ç»„</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$i</span> &lt; <span class="variable">$leftLen</span>) &#123;</span><br><span class="line">        <span class="variable">$start</span> = <span class="variable">$i</span>;</span><br><span class="line">        <span class="variable">$end</span> = <span class="variable">$leftLen</span>;</span><br><span class="line">        <span class="variable">$copyArr</span> = <span class="variable">$left</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$start</span> = <span class="variable">$j</span>;</span><br><span class="line">        <span class="variable">$end</span> = <span class="variable">$rightLen</span>;</span><br><span class="line">        <span class="variable">$copyArr</span> = <span class="variable">$right</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†å‰©ä½™çš„æ•°æ®æ‹·è´åˆ°ä¸´æ—¶æ•°ç»„ tmp</span></span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="variable">$tmp</span>[] = <span class="variable">$copyArr</span>[<span class="variable">$start</span>++];</span><br><span class="line">    &#125; <span class="keyword">while</span> (<span class="variable">$start</span> &lt; <span class="variable">$end</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$tmp</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$arr</span> = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>];</span><br><span class="line"><span class="variable">$length</span> = <span class="title function_ invoke__">count</span>(<span class="variable">$arr</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼€å§‹ä¸‹æ ‡</span></span><br><span class="line"><span class="variable">$p</span> = <span class="number">0</span>;</span><br><span class="line"><span class="comment">// ç»“æŸä¸‹æ ‡</span></span><br><span class="line"><span class="variable">$r</span> = <span class="variable">$length</span> - <span class="number">1</span>;</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">mergeSortRecursive</span>(<span class="variable">$arr</span>, <span class="variable">$p</span>, <span class="variable">$r</span>));</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ’å…¥æ’åº</title>
      <link href="/posts/85f0af4b.html"/>
      <url>/posts/85f0af4b.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€åŸç†"><a href="#ä¸€ã€åŸç†" class="headerlink" title="ä¸€ã€åŸç†"></a>ä¸€ã€åŸç†</h1><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘ä»¬å°†æ•°ç»„ä¸­çš„æ•°æ®åˆ†ä¸ºä¸¤ä¸ªåŒºé—´ï¼Œå·²æ’åºåŒºé—´å’Œæœªæ’åºåŒºé—´ã€‚</span><br><span class="line">åˆå§‹å·²æ’åºåŒºé—´åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œå°±æ˜¯æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</span><br><span class="line">æ’å…¥ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯å–æœªæ’åºåŒºé—´ä¸­çš„å…ƒç´ ï¼Œåœ¨å·²æ’åºåŒºé—´ä¸­æ‰¾åˆ°åˆé€‚çš„æ’å…¥ä½ç½®å°†å…¶æ’å…¥ï¼Œå¹¶ä¿è¯å·²æ’åºåŒºé—´æ•°æ®ä¸€ç›´æœ‰åºã€‚</span><br><span class="line">é‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°æœªæ’åºåŒºé—´ä¸­å…ƒç´ ä¸ºç©ºï¼Œç®—æ³•ç»“æŸã€‚</span><br></pre></td></tr></table></figure><h1 id="äºŒã€æ€§èƒ½"><a href="#äºŒã€æ€§èƒ½" class="headerlink" title="äºŒã€æ€§èƒ½"></a>äºŒã€æ€§èƒ½</h1><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ç¬¬ä¸€ï¼Œæ’å…¥æ’åºæ˜¯åŸåœ°æ’åºç®—æ³•å—ï¼Ÿ</span><br><span class="line">ä»å®ç°è¿‡ç¨‹å¯ä»¥å¾ˆæ˜æ˜¾åœ°çœ‹å‡ºï¼Œæ’å…¥æ’åºç®—æ³•çš„è¿è¡Œå¹¶ä¸éœ€è¦é¢å¤–çš„å­˜å‚¨ç©ºé—´ï¼Œæ‰€ä»¥ç©ºé—´å¤æ‚åº¦æ˜¯ <span class="built_in">O</span>(<span class="number">1</span>)ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªåŸåœ°æ’åºç®—æ³•ã€‚</span><br><span class="line"></span><br><span class="line">ç¬¬äºŒï¼Œæ’å…¥æ’åºæ˜¯ç¨³å®šçš„æ’åºç®—æ³•å—ï¼Ÿ</span><br><span class="line">åœ¨æ’å…¥æ’åºä¸­ï¼Œå¯¹äºå€¼ç›¸åŒçš„å…ƒç´ ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©å°†åé¢å‡ºç°çš„å…ƒç´ ï¼Œæ’å…¥åˆ°å‰é¢å‡ºç°å…ƒç´ çš„åé¢ï¼Œè¿™æ ·å°±å¯ä»¥ä¿æŒåŸæœ‰çš„å‰åé¡ºåºä¸å˜ï¼Œæ‰€ä»¥æ’å…¥æ’åºæ˜¯ç¨³å®šçš„æ’åºç®—æ³•ã€‚</span><br><span class="line"></span><br><span class="line">ç¬¬ä¸‰ï¼Œæ’å…¥æ’åºçš„æ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘ï¼Ÿ</span><br><span class="line">å¦‚æœè¦æ’åºçš„æ•°æ®å·²ç»æ˜¯æœ‰åºçš„ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦æ¬ç§»ä»»ä½•æ•°æ®ã€‚å¦‚æœæˆ‘ä»¬ä»å°¾åˆ°å¤´åœ¨æœ‰åºæ•°æ®ç»„é‡Œé¢æŸ¥æ‰¾æ’å…¥ä½ç½®ï¼Œæ¯æ¬¡åªéœ€è¦æ¯”è¾ƒä¸€ä¸ªæ•°æ®å°±èƒ½ç¡®å®šæ’å…¥çš„ä½ç½®ã€‚æ‰€ä»¥è¿™ç§æƒ…å†µä¸‹ï¼Œæœ€å¥½æ˜¯æ—¶é—´å¤æ‚åº¦ä¸º <span class="built_in">O</span>(n)ã€‚æ³¨æ„ï¼Œè¿™é‡Œæ˜¯ä»å°¾åˆ°å¤´éå†å·²ç»æœ‰åºçš„æ•°æ®ã€‚</span><br><span class="line"></span><br><span class="line">å¦‚æœæ•°ç»„æ˜¯å€’åºçš„ï¼Œæ¯æ¬¡æ’å…¥éƒ½ç›¸å½“äºåœ¨æ•°ç»„çš„ç¬¬ä¸€ä¸ªä½ç½®æ’å…¥æ–°çš„æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦ç§»åŠ¨å¤§é‡çš„æ•°æ®ï¼Œæ‰€ä»¥æœ€åæƒ…å†µæ—¶é—´å¤æ‚åº¦ä¸º <span class="built_in">O</span>(n2)ã€‚</span><br><span class="line">è¿˜è®°å¾—æˆ‘ä»¬åœ¨æ•°ç»„ä¸­æ’å…¥ä¸€ä¸ªæ•°æ®çš„å¹³å‡æ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘å—ï¼Ÿæ²¡é”™ï¼Œæ˜¯ <span class="built_in">O</span>(n)ã€‚</span><br><span class="line">æ‰€ä»¥ï¼Œå¯¹äºæ’å…¥æ’åºæ¥è¯´ï¼Œæ¯æ¬¡æ’å…¥æ“ä½œéƒ½ç›¸å½“äºåœ¨æ•°ç»„ä¸­æ’å…¥ä¸€ä¸ªæ•°æ®ï¼Œå¾ªç¯æ‰§è¡Œ n æ¬¡æ’å…¥æ“ä½œï¼Œæ‰€ä»¥å¹³å‡æ—¶é—´å¤æ‚åº¦ä¸º <span class="built_in">O</span>(n2)ã€‚ã€‚</span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€å®ç°"><a href="#ä¸‰ã€å®ç°" class="headerlink" title="ä¸‰ã€å®ç°"></a>ä¸‰ã€å®ç°</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// æ’å…¥æ’åº</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">insertionSort</span>(<span class="params">&amp;<span class="variable">$arr</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$n</span> = <span class="title function_ invoke__">count</span>(<span class="variable">$arr</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$n</span> &lt;= <span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">1</span>; <span class="variable">$i</span> &lt; <span class="variable">$n</span>; ++<span class="variable">$i</span>) &#123;</span><br><span class="line">        <span class="variable">$value</span> = <span class="variable">$arr</span>[<span class="variable">$i</span>];</span><br><span class="line">        <span class="variable">$j</span> = <span class="variable">$i</span> - <span class="number">1</span>;</span><br><span class="line">        <span class="comment">// æŸ¥æ‰¾æ’å…¥çš„ä½ç½®</span></span><br><span class="line">        <span class="keyword">for</span> (; <span class="variable">$j</span> &gt;= <span class="number">0</span>; --<span class="variable">$j</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$arr</span>[<span class="variable">$j</span>] &gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">                <span class="variable">$arr</span>[<span class="variable">$j</span> + <span class="number">1</span>] = <span class="variable">$arr</span>[<span class="variable">$j</span>];  <span class="comment">// æ•°æ®ç§»åŠ¨</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$arr</span>[<span class="variable">$j</span> + <span class="number">1</span>] = <span class="variable">$value</span>; <span class="comment">// æ’å…¥æ•°æ®</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$arr</span> = [<span class="number">1</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">4</span>];</span><br><span class="line"><span class="title function_ invoke__">insertionSort</span>(<span class="variable">$arr</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$arr</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é€‰æ‹©æ’åº</title>
      <link href="/posts/7430112.html"/>
      <url>/posts/7430112.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€åŸç†"><a href="#ä¸€ã€åŸç†" class="headerlink" title="ä¸€ã€åŸç†"></a>ä¸€ã€åŸç†</h1><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘ä»¬å°†æ•°ç»„ä¸­çš„æ•°æ®åˆ†ä¸ºä¸¤ä¸ªåŒºé—´ï¼Œå·²æ’åºåŒºé—´å’Œæœªæ’åºåŒºé—´ã€‚</span><br><span class="line">æ¯æ¬¡ä¼šä»æœªæ’åºåŒºé—´ä¸­æ‰¾åˆ°æœ€å°çš„å…ƒç´ ï¼Œå°†å…¶æ”¾åˆ°å·²æ’åºåŒºé—´çš„æœ«å°¾ã€‚</span><br><span class="line">é‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°æœªæ’åºåŒºé—´ä¸­å…ƒç´ ä¸ºç©ºï¼Œç®—æ³•ç»“æŸã€‚</span><br></pre></td></tr></table></figure><h1 id="äºŒã€æ€§èƒ½"><a href="#äºŒã€æ€§èƒ½" class="headerlink" title="äºŒã€æ€§èƒ½"></a>äºŒã€æ€§èƒ½</h1><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ç¬¬ä¸€ï¼Œå†’æ³¡æ’åºæ˜¯åŸåœ°æ’åºç®—æ³•å—ï¼Ÿ</span><br><span class="line">é€‰æ‹©æ’åºç©ºé—´å¤æ‚åº¦ä¸º <span class="built_in">O</span>(<span class="number">1</span>)ï¼Œæ˜¯ä¸€ç§åŸåœ°æ’åºç®—æ³•ã€‚</span><br><span class="line"></span><br><span class="line">ç¬¬äºŒï¼Œå†’æ³¡æ’åºæ˜¯ç¨³å®šçš„æ’åºç®—æ³•å—ï¼Ÿ</span><br><span class="line">é€‰æ‹©æ’åºæ˜¯ä¸€ç§ä¸ç¨³å®šçš„æ’åºç®—æ³•ã€‚</span><br><span class="line">é€‰æ‹©æ’åºæ¯æ¬¡éƒ½è¦æ‰¾å‰©ä½™æœªæ’åºå…ƒç´ ä¸­çš„æœ€å°å€¼ï¼Œå¹¶å’Œå‰é¢çš„å…ƒç´ äº¤æ¢ä½ç½®ï¼Œè¿™æ ·ç ´åäº†ç¨³å®šæ€§ã€‚</span><br><span class="line"></span><br><span class="line">ç¬¬ä¸‰ï¼Œå†’æ³¡æ’åºçš„æ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘ï¼Ÿ</span><br><span class="line">é€‰æ‹©æ’åºçš„æœ€å¥½æƒ…å†µæ—¶é—´å¤æ‚åº¦ã€æœ€åæƒ…å†µå’Œå¹³å‡æƒ…å†µæ—¶é—´å¤æ‚åº¦éƒ½ä¸º <span class="built_in">O</span>(n2)ã€‚</span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€å®ç°"><a href="#ä¸‰ã€å®ç°" class="headerlink" title="ä¸‰ã€å®ç°"></a>ä¸‰ã€å®ç°</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// é€‰æ‹©æ’åº</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">selectionSort</span>(<span class="params">&amp;<span class="variable">$arr</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$length</span> = <span class="title function_ invoke__">count</span>(<span class="variable">$arr</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$length</span> &lt;= <span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$length</span> - <span class="number">1</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="comment">//å…ˆå‡è®¾æœ€å°çš„å€¼çš„ä½ç½®</span></span><br><span class="line">        <span class="variable">$p</span> = <span class="variable">$i</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="variable">$i</span> + <span class="number">1</span>; <span class="variable">$j</span> &lt; <span class="variable">$length</span>; <span class="variable">$j</span>++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$arr</span>[<span class="variable">$p</span>] &gt; <span class="variable">$arr</span>[<span class="variable">$j</span>]) &#123;</span><br><span class="line">                <span class="variable">$p</span> = <span class="variable">$j</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$tmp</span> = <span class="variable">$arr</span>[<span class="variable">$p</span>];</span><br><span class="line">        <span class="variable">$arr</span>[<span class="variable">$p</span>] = <span class="variable">$arr</span>[<span class="variable">$i</span>];</span><br><span class="line">        <span class="variable">$arr</span>[<span class="variable">$i</span>] = <span class="variable">$tmp</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$arr</span> = [<span class="number">1</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">4</span>];</span><br><span class="line"><span class="title function_ invoke__">selectionSort</span>(<span class="variable">$arr</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$arr</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hadoopå¸¸ç”¨å‘½ä»¤</title>
      <link href="/posts/eca9a482.html"/>
      <url>/posts/eca9a482.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h3 id="1-è¾“å‡ºä»¥æ—¥æœŸå‘½åçš„æ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”å‘½åæ—¥æœŸä½äºæŒ‡å®šå€¼çš„æ–‡ä»¶å¤¹è·¯å¾„"><a href="#1-è¾“å‡ºä»¥æ—¥æœŸå‘½åçš„æ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”å‘½åæ—¥æœŸä½äºæŒ‡å®šå€¼çš„æ–‡ä»¶å¤¹è·¯å¾„" class="headerlink" title="1. è¾“å‡ºä»¥æ—¥æœŸå‘½åçš„æ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”å‘½åæ—¥æœŸä½äºæŒ‡å®šå€¼çš„æ–‡ä»¶å¤¹è·¯å¾„"></a>1. è¾“å‡ºä»¥æ—¥æœŸå‘½åçš„æ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”å‘½åæ—¥æœŸä½äºæŒ‡å®šå€¼çš„æ–‡ä»¶å¤¹è·¯å¾„</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">hadoop fs -<span class="built_in">du</span> -h /img/*|grep -E <span class="string">&quot;[0-9a-zA-Z/]+/[0-9]+&quot;</span>|<span class="built_in">sort</span> -t <span class="string">&#x27;/&#x27;</span> -k 4nr|awk -F <span class="string">&#x27;/&#x27;</span> <span class="string">&#x27;&#123;if ($(NF)&lt;20220516) print $0&#125;&#x27;</span></span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> hadoop </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hadoop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jsonç”Ÿæˆtable</title>
      <link href="/posts/8c45e8c2.html"/>
      <url>/posts/8c45e8c2.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">table</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-collapse</span>: collapse;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="number">#ddd</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-left</span>: <span class="number">1px</span> solid <span class="number">#ddd</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">th</span>, <span class="selector-tag">td</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#ddd</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border-right</span>: <span class="number">1px</span> solid <span class="number">#ddd</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding</span>: <span class="number">8px</span> <span class="number">0</span> <span class="number">8px</span> <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.optionButtom</span>&#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#217fff</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: <span class="number">#217fff</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">text-decoration</span>: none;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.extractTable</span> <span class="selector-tag">td</span><span class="selector-pseudo">:first-of-type</span> <span class="selector-tag">span</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding-left</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.icon-arrow</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border</span>: <span class="number">6px</span> solid transparent;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: <span class="number">#c9c9c9</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.arrow-right</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border-left</span>: <span class="number">5px</span> solid;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border-left-color</span>: initial;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">top</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.arrow-down</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border-top</span>: <span class="number">5px</span> solid;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border-top-color</span>: initial;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">top</span>: <span class="number">24px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">&quot;extractTable&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span> <span class="attr">colspan</span>=<span class="string">&quot;1&quot;</span> <span class="attr">rowspan</span>=<span class="string">&quot;1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;&quot;</span>&gt;</span>å‚æ•°å<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span> <span class="attr">colspan</span>=<span class="string">&quot;1&quot;</span> <span class="attr">rowspan</span>=<span class="string">&quot;1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;&quot;</span>&gt;</span>ç±»å‹<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span> <span class="attr">colspan</span>=<span class="string">&quot;1&quot;</span> <span class="attr">rowspan</span>=<span class="string">&quot;1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;&quot;</span>&gt;</span>è¯´æ˜<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span> <span class="attr">colspan</span>=<span class="string">&quot;1&quot;</span> <span class="attr">rowspan</span>=<span class="string">&quot;1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;&quot;</span>&gt;</span>ç¤ºä¾‹<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span> <span class="attr">colspan</span>=<span class="string">&quot;1&quot;</span> <span class="attr">rowspan</span>=<span class="string">&quot;1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;&quot;</span>&gt;</span>æ“ä½œ<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// æ ¼å¼åŒ–æ•°æ®</span></span></span><br><span class="line"><span class="language-javascript">    $(<span class="string">&#x27;.formatData&#x27;</span>).<span class="title function_">on</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> re = $(<span class="string">&#x27;textarea[name=&quot;re&quot;]&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (re &amp;&amp; re.<span class="title function_">val</span>()) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// å°†å¡«å†™çš„jsonå­—ç¬¦ä¸²è½¬æ¢ä¸ºjsonå¯¹è±¡å†è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œæ ¼å¼åŒ–</span></span></span><br><span class="line"><span class="language-javascript">            re.<span class="title function_">val</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>($.<span class="title function_">parseJSON</span>(re.<span class="title function_">val</span>()), <span class="literal">null</span>, <span class="string">&#x27;\t&#x27;</span>));</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// æå–åˆ°å³ä¾§</span></span></span><br><span class="line"><span class="language-javascript">    $(<span class="string">&#x27;.extractToRight&#x27;</span>).<span class="title function_">on</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> parentEle = $(<span class="variable language_">this</span>).<span class="title function_">parents</span>(<span class="string">&#x27;.form-group&#x27;</span>),</span></span><br><span class="line"><span class="language-javascript">            extractDataEle = parentEle.<span class="title function_">find</span>(<span class="string">&#x27;textarea&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (extractDataEle &amp;&amp; extractDataEle.<span class="title function_">val</span>()) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// å°†å¡«å†™çš„jsonå­—ç¬¦ä¸²è½¬æ¢ä¸ºjsonå¯¹è±¡å†è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œæ ¼å¼åŒ–</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">let</span> extractBody = parentEle.<span class="title function_">find</span>(<span class="string">&#x27;.extractTable tbody&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">            extractBody.<span class="title function_">empty</span>();</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">recursiveObjectToTable</span>($.<span class="title function_">parseJSON</span>(extractDataEle.<span class="title function_">val</span>()), <span class="number">0</span>, extractBody, <span class="string">&#x27;&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">/**</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">     * é€’å½’æå–jsonå¯¹è±¡ç”Ÿæˆtable</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">     * <span class="doctag">@param</span> object jsonå¯¹è±¡</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">     * <span class="doctag">@param</span> int level å±‚çº§</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">     * <span class="doctag">@param</span> element tableå…ƒç´  $(&#x27;table&#x27;)</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">     * <span class="doctag">@param</span> string | int parentKey çˆ¶ç±»key</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">     */</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">recursiveObjectToTable</span>(<span class="params">obj, level, element, parentKey</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (<span class="title function_">typeof</span>(obj) == <span class="string">&#x27;object&#x27;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">let</span> i = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            $.<span class="title function_">each</span>(obj, <span class="keyword">function</span>(<span class="params">key, value</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// å¡«å……å‚æ•°åã€ç±»å‹ã€è¯´æ˜ã€ç¤ºä¾‹ã€æ“ä½œ</span></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">let</span> className = <span class="string">&#x27;extract-level-&#x27;</span> + level + <span class="string">&#x27; extract-index-&#x27;</span> + i,</span></span><br><span class="line"><span class="language-javascript">                    tdHtml = <span class="string">&#x27;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    trElement = element.<span class="title function_">find</span>(<span class="string">&#x27;.&#x27;</span> + className),</span></span><br><span class="line"><span class="language-javascript">                    keyType = <span class="string">&#x27;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    isObj = <span class="title function_">typeof</span>(value) == <span class="string">&#x27;object&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    curLevel = level,</span></span><br><span class="line"><span class="language-javascript">                    dataValue = value;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span> (!<span class="built_in">isNaN</span>(value)) &#123;</span></span><br><span class="line"><span class="language-javascript">                    keyType = <span class="string">&#x27;int&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> ($.<span class="title function_">isArray</span>(value)) &#123;</span></span><br><span class="line"><span class="language-javascript">                    keyType = <span class="string">&#x27;array&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">                    dataValue = <span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isObj) &#123;</span></span><br><span class="line"><span class="language-javascript">                    keyType = <span class="string">&#x27;object&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">                    dataValue = <span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">                &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    keyType = <span class="title function_">typeof</span>(value);</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// å¦‚æœæ˜¯å¯¹è±¡å¹¶ä¸”keyæ˜¯intç±»å‹ï¼Œåˆ™ä¸æ˜¾ç¤ºåœ¨tableç§ã€‚å¦‚æœæ˜¯æ•°ç»„åˆ™è¦æ˜¾ç¤º</span></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// if (isNaN(key)) &#123;</span></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">//     curLevel = level + 1;</span></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// &#125;</span></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// if (!(keyType == &#x27;object&#x27; &amp;&amp; !isNaN(key))) &#123;</span></span></span><br><span class="line"><span class="language-javascript">                curLevel = level + <span class="number">1</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span> (<span class="number">1</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">if</span> (trElement.<span class="property">length</span> == <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                        <span class="keyword">let</span> arrowHtml = <span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">                        <span class="keyword">if</span> (isObj) &#123;</span></span><br><span class="line"><span class="language-javascript">                            arrowHtml = <span class="string">&#x27;&lt;i class=&quot;icon-arrow arrow-down&quot;&gt;&lt;/i&gt;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">                        &#125;</span></span><br><span class="line"><span class="language-javascript">                        element.<span class="title function_">append</span>(</span></span><br><span class="line"><span class="language-javascript">                            <span class="string">&#x27;&lt;tr class=&quot;&#x27;</span> + className + <span class="string">&#x27;&quot; item-level=&quot;&#x27;</span> + level + <span class="string">&#x27;&quot; parentKey=&quot;&#x27;</span> + parentKey + <span class="string">&#x27;&quot;&gt;&#x27;</span> +</span></span><br><span class="line"><span class="language-javascript">                            <span class="string">&#x27;&lt;td style=&quot;position: relative;padding-left: &#x27;</span> + (curLevel * <span class="number">10</span>) + <span class="string">&#x27;px&quot;&gt;&#x27;</span> + arrowHtml + <span class="string">&#x27;&lt;span&gt;&#x27;</span> + key + <span class="string">&#x27;&lt;/span&gt;&lt;/td&gt;&#x27;</span> +</span></span><br><span class="line"><span class="language-javascript">                            <span class="string">&#x27;&lt;td&gt;&#x27;</span> + keyType + <span class="string">&#x27;&lt;/td&gt;&#x27;</span> +</span></span><br><span class="line"><span class="language-javascript">                            <span class="string">&#x27;&lt;td&gt;&lt;/td&gt;&#x27;</span> +</span></span><br><span class="line"><span class="language-javascript">                            <span class="string">&#x27;&lt;td&gt;&#x27;</span> + dataValue + <span class="string">&#x27;&lt;/td&gt;&#x27;</span> +</span></span><br><span class="line"><span class="language-javascript">                            <span class="string">&#x27;&lt;td&gt;&lt;button type=&quot;button&quot; class=&quot;btn btn-danger&quot; onclick=&quot;del(this)&quot;&gt;åˆ é™¤&lt;/button&gt;&lt;/td&gt;&#x27;</span> +</span></span><br><span class="line"><span class="language-javascript">                            <span class="string">&#x27;&lt;/tr&gt;&#x27;</span></span></span><br><span class="line"><span class="language-javascript">                        );</span></span><br><span class="line"><span class="language-javascript">                    &#125;</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// å¦‚æœæ˜¯å¯¹è±¡ï¼Œåˆ™é€’å½’</span></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span> (isObj) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">let</span> curParentKey;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">if</span> (parentKey) &#123;</span></span><br><span class="line"><span class="language-javascript">                        curParentKey = parentKey + <span class="string">&#x27;|&#x27;</span> + key;</span></span><br><span class="line"><span class="language-javascript">                    &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                        curParentKey = key;</span></span><br><span class="line"><span class="language-javascript">                    &#125;</span></span><br><span class="line"><span class="language-javascript">                    <span class="title function_">recursiveObjectToTable</span>(value, curLevel, element, curParentKey);</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                i++;</span></span><br><span class="line"><span class="language-javascript">            &#125;);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    $(<span class="string">&#x27;.extractToRight&#x27;</span>).<span class="title function_">click</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// ç‚¹å‡»å±•å¼€æŠ˜å </span></span></span><br><span class="line"><span class="language-javascript">    $(<span class="string">&#x27;.extractTable&#x27;</span>).<span class="title function_">on</span>(<span class="string">&#x27;click&#x27;</span>, <span class="string">&#x27;tr&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> parentKey = $(<span class="variable language_">this</span>).<span class="title function_">attr</span>(<span class="string">&#x27;parentKey&#x27;</span>),</span></span><br><span class="line"><span class="language-javascript">            arrow = $(<span class="variable language_">this</span>).<span class="title function_">find</span>(<span class="string">&#x27;i&#x27;</span>),</span></span><br><span class="line"><span class="language-javascript">            curKey = $(<span class="variable language_">this</span>).<span class="title function_">find</span>(<span class="string">&#x27;td&#x27;</span>).<span class="title function_">eq</span>(<span class="number">0</span>).<span class="title function_">text</span>(),</span></span><br><span class="line"><span class="language-javascript">            searchParentKey = <span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (parentKey != <span class="string">&#x27;&#x27;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            searchParentKey = parentKey + <span class="string">&quot;|&quot;</span> + curKey;</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            searchParentKey = curKey;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        childsEle = $(<span class="variable language_">this</span>).<span class="title function_">parents</span>(<span class="string">&#x27;.extractTable&#x27;</span>).<span class="title function_">find</span>(<span class="string">&quot;tr[parentKey^=&#x27;&quot;</span> + searchParentKey + <span class="string">&quot;&#x27;]&quot;</span>); <span class="comment">// è·å–parentKeyæŒ‡å®šå¼€å¤´å…ƒç´ </span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// ç‚¹å‡»æŠ˜å </span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (arrow.<span class="title function_">hasClass</span>(<span class="string">&#x27;arrow-down&#x27;</span>)) &#123;</span></span><br><span class="line"><span class="language-javascript">            arrow.<span class="title function_">removeClass</span>(<span class="string">&#x27;arrow-down&#x27;</span>).<span class="title function_">addClass</span>(<span class="string">&#x27;arrow-right&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">            childsEle.<span class="title function_">hide</span>();</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            arrow.<span class="title function_">removeClass</span>(<span class="string">&#x27;arrow-right&#x27;</span>).<span class="title function_">addClass</span>(<span class="string">&#x27;arrow-down&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">            childsEle.<span class="title function_">show</span>();</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>awk</title>
      <link href="/posts/c4a2fe4.html"/>
      <url>/posts/c4a2fe4.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h3 id="æŸ¥è¯¢bæ–‡ä»¶ä¸­åŒ…å«aæ–‡ä»¶å†…å®¹çš„æ•°æ®"><a href="#æŸ¥è¯¢bæ–‡ä»¶ä¸­åŒ…å«aæ–‡ä»¶å†…å®¹çš„æ•°æ®" class="headerlink" title="æŸ¥è¯¢bæ–‡ä»¶ä¸­åŒ…å«aæ–‡ä»¶å†…å®¹çš„æ•°æ®"></a>æŸ¥è¯¢bæ–‡ä»¶ä¸­åŒ…å«aæ–‡ä»¶å†…å®¹çš„æ•°æ®</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ awk <span class="string">&#x27;NR==FNR&#123;x[$0];next&#125;&#123;for(i in x)if($0~i)print&#125;&#x27;</span> <span class="selector-tag">a</span><span class="selector-class">.txt</span> <span class="selector-tag">b</span>.txt</span><br></pre></td></tr></table></figure><h3 id="è®©grepæŸ¥æ‰¾ç¬¦åˆè§„åˆ™æ¡ä»¶çš„æ–‡ä»¶å†…å®¹ï¼Œæ ¼å¼ä¸ºæ¯è¡Œä¸€ä¸ªè§„åˆ™æ ·å¼"><a href="#è®©grepæŸ¥æ‰¾ç¬¦åˆè§„åˆ™æ¡ä»¶çš„æ–‡ä»¶å†…å®¹ï¼Œæ ¼å¼ä¸ºæ¯è¡Œä¸€ä¸ªè§„åˆ™æ ·å¼" class="headerlink" title="è®©grepæŸ¥æ‰¾ç¬¦åˆè§„åˆ™æ¡ä»¶çš„æ–‡ä»¶å†…å®¹ï¼Œæ ¼å¼ä¸ºæ¯è¡Œä¸€ä¸ªè§„åˆ™æ ·å¼"></a>è®©grepæŸ¥æ‰¾ç¬¦åˆè§„åˆ™æ¡ä»¶çš„æ–‡ä»¶å†…å®¹ï¼Œæ ¼å¼ä¸ºæ¯è¡Œä¸€ä¸ªè§„åˆ™æ ·å¼</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ grep -f <span class="selector-tag">a</span><span class="selector-class">.txt</span> <span class="selector-tag">b</span>.txt</span><br></pre></td></tr></table></figure><h3 id="awkæ­£åˆ™è¡¨è¾¾å¼-æ‰“å°ç¬¦åˆæ•°æ®"><a href="#awkæ­£åˆ™è¡¨è¾¾å¼-æ‰“å°ç¬¦åˆæ•°æ®" class="headerlink" title="awkæ­£åˆ™è¡¨è¾¾å¼, æ‰“å°ç¬¦åˆæ•°æ®"></a>awkæ­£åˆ™è¡¨è¾¾å¼, æ‰“å°ç¬¦åˆæ•°æ®</h3><p>a.logå†…å®¹ä¸ºip 2022:01:01:00 info<br>ç»“æœä¸º2022:01:01:00 ip 2022:01:01:00 info</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ awk &#x27;&#123;match($0,/<span class="comment">[0-9]</span>+:<span class="comment">[0-9]</span>+:<span class="comment">[0-9]</span>+:<span class="comment">[0-9]</span>+/,res);print res<span class="comment">[0]</span>, $0&#125;&#x27; a.log</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨å¤šä¸ªåˆ†éš”ç¬¦-å…ˆä½¿ç”¨ç©ºæ ¼åˆ†å‰²ï¼Œç„¶åå¯¹åˆ†å‰²ç»“æœå†ä½¿ç”¨â€-â€åˆ†å‰²"><a href="#ä½¿ç”¨å¤šä¸ªåˆ†éš”ç¬¦-å…ˆä½¿ç”¨ç©ºæ ¼åˆ†å‰²ï¼Œç„¶åå¯¹åˆ†å‰²ç»“æœå†ä½¿ç”¨â€-â€åˆ†å‰²" class="headerlink" title="ä½¿ç”¨å¤šä¸ªåˆ†éš”ç¬¦.å…ˆä½¿ç”¨ç©ºæ ¼åˆ†å‰²ï¼Œç„¶åå¯¹åˆ†å‰²ç»“æœå†ä½¿ç”¨â€,â€åˆ†å‰²"></a>ä½¿ç”¨å¤šä¸ªåˆ†éš”ç¬¦.å…ˆä½¿ç”¨ç©ºæ ¼åˆ†å‰²ï¼Œç„¶åå¯¹åˆ†å‰²ç»“æœå†ä½¿ç”¨â€,â€åˆ†å‰²</h3><p>a.logå†…å®¹ä¸º10 There are orange,apple,mongo<br>ç»“æœä¸º10 There apple</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ awk -F <span class="string">&#x27;[ ,]&#x27;</span> <span class="string">&#x27;&#123;print <span class="subst">$1</span>,<span class="subst">$2</span>,<span class="subst">$5</span>&#125;&#x27;</span> a.log</span><br></pre></td></tr></table></figure><h3 id="å°†å¤šè¡Œå†…å®¹ç»„åˆæˆä¸€è¡Œ"><a href="#å°†å¤šè¡Œå†…å®¹ç»„åˆæˆä¸€è¡Œ" class="headerlink" title="å°†å¤šè¡Œå†…å®¹ç»„åˆæˆä¸€è¡Œ"></a>å°†å¤šè¡Œå†…å®¹ç»„åˆæˆä¸€è¡Œ</h3><p>aaa<br>bbb<br>ç»„åˆæˆaaa,bbb,</p><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">$ </span>awk &#x27;&#123;printf <span class="string">$2</span><span class="string">&quot;,&quot;</span>&#125;&#x27;</span><br></pre></td></tr></table></figure><h3 id="å˜é‡èµ‹å€¼"><a href="#å˜é‡èµ‹å€¼" class="headerlink" title="å˜é‡èµ‹å€¼"></a>å˜é‡èµ‹å€¼</h3><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gawk -F <span class="string">&#x27;/&#x27;</span> -v <span class="keyword">date</span>=<span class="string">&quot;$(date -d &quot;</span>$&#123;DATE&#125; <span class="number">15</span> days ago<span class="string">&quot; &quot;</span>+%Y%m%d<span class="string">&quot;)&quot;</span> <span class="string">&#x27;&#123;if ($(NF)&lt;date) print $0&#125;&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>json_encodeç´¢å¼•æ•°ç»„å’Œå…³è”æ•°ç»„å¤„ç†</title>
      <link href="/posts/7d7d04c8.html"/>
      <url>/posts/7d7d04c8.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€-ç´¢å¼•æ•°ç»„"><a href="#ä¸€ã€-ç´¢å¼•æ•°ç»„" class="headerlink" title="ä¸€ã€ ç´¢å¼•æ•°ç»„"></a>ä¸€ã€ ç´¢å¼•æ•°ç»„</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$arr</span> = []; <span class="comment">// è¾“å‡º []</span></span><br><span class="line"><span class="variable">$arr</span> = [[<span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&#x27;cat&#x27;</span>], [<span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&#x27;cat1]]</span></span><br><span class="line"><span class="string">$arr = [0 =&gt; [&#x27;</span>name<span class="string">&#x27; =&gt; &#x27;</span>cat<span class="string">&#x27;], 1 =&gt; [&#x27;</span>name<span class="string">&#x27; =&gt; &#x27;</span>cat1<span class="string">&#x27;]];</span></span><br><span class="line"><span class="string">echo json_encode($arr);</span></span><br><span class="line"><span class="string">// è¾“å‡º [&#123;&quot;name&quot;: &quot;cat&quot;&#125;]</span></span><br></pre></td></tr></table></figure><h1 id="äºŒã€å…³è”æ•°ç»„"><a href="#äºŒã€å…³è”æ•°ç»„" class="headerlink" title="äºŒã€å…³è”æ•°ç»„"></a>äºŒã€å…³è”æ•°ç»„</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$arr</span> = []; <span class="comment">// è¾“å‡º []</span></span><br><span class="line"><span class="variable">$arr</span> = [<span class="string">&quot;a&quot;</span> =&gt; [<span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&#x27;cat&#x27;</span>], <span class="string">&quot;b&quot;</span> =&gt; [<span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&#x27;cat1&#x27;</span>]];</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$arr</span>);</span><br><span class="line"><span class="comment">// è¾“å‡º &#123;&#123;&quot;name&quot;: &quot;cat&quot;&#125;&#125;</span></span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€æ ‡å‡†åº“arrayObject"><a href="#ä¸‰ã€æ ‡å‡†åº“arrayObject" class="headerlink" title="ä¸‰ã€æ ‡å‡†åº“arrayObject"></a>ä¸‰ã€æ ‡å‡†åº“arrayObject</h1><p>å¦‚æœéœ€è¦ç´¢å¼•æ•°ç»„æŒ‰ç…§å…³è”æ•°ç»„çš„æ–¹å¼è¾“å‡ºï¼Œç»´æŒæ•°æ®ç»“æ„ä¸å˜åˆ™éœ€è¦ä½¿ç”¨æ ‡å‡†åº“ArrayObjectè½¬æ¢ä¸ºæ•°ç»„å¯¹è±¡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$arr</span> = <span class="keyword">new</span> <span class="title function_ invoke__">arrayObject</span>();</span><br><span class="line"><span class="variable">$arr</span> = [<span class="number">0</span> =&gt; [<span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&#x27;cat&#x27;</span>], <span class="number">1</span> =&gt; [<span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&#x27;cat1&#x27;</span>]];</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$arr</span>);</span><br><span class="line"><span class="comment">// è¾“å‡º &#123;&#123;&quot;name&quot;: &quot;cat&quot;&#125;&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysqlç¼“å­˜æœºåˆ¶</title>
      <link href="/posts/583a888f.html"/>
      <url>/posts/583a888f.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€-MySQLç¼“å­˜ç®€ä»‹"><a href="#ä¸€ã€-MySQLç¼“å­˜ç®€ä»‹" class="headerlink" title="ä¸€ã€ MySQLç¼“å­˜ç®€ä»‹"></a>ä¸€ã€ MySQLç¼“å­˜ç®€ä»‹</h1><h2 id="1-MySQLç¼“å­˜æœºåˆ¶è¯´æ˜"><a href="#1-MySQLç¼“å­˜æœºåˆ¶è¯´æ˜" class="headerlink" title="1. MySQLç¼“å­˜æœºåˆ¶è¯´æ˜"></a>1. MySQLç¼“å­˜æœºåˆ¶è¯´æ˜</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MySQLç¼“å­˜æœºåˆ¶å³ç¼“å­˜<span class="keyword">sql</span> æ–‡æœ¬åŠç¼“å­˜ç»“æœï¼Œç”¨KVå½¢å¼ä¿å­˜å†æœåŠ¡å™¨å†…å­˜ä¸­ï¼Œå¦‚æœè¿è¡Œç›¸åŒçš„<span class="keyword">sql</span>ï¼ŒæœåŠ¡å™¨ç›´æ¥ä»ç¼“å­˜ä¸­å»è·å–ç»“æœï¼Œä¸éœ€è¦å†å»è§£æã€ä¼˜åŒ–ã€æ‰§è¡Œ<span class="keyword">sql</span></span><br></pre></td></tr></table></figure><h2 id="2-MySQLç¼“å­˜å¤±æ•ˆ"><a href="#2-MySQLç¼“å­˜å¤±æ•ˆ" class="headerlink" title="2. MySQLç¼“å­˜å¤±æ•ˆ"></a>2. MySQLç¼“å­˜å¤±æ•ˆ</h2><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> åœ¨è¡¨çš„ç»“æ„æˆ–æ•°æ®å‘ç”Ÿæ”¹å˜æ—¶ï¼ŒæŸ¥è¯¢ç¼“å­˜ä¸­çš„æ•°æ®ä¸å†æœ‰æ•ˆï¼ŒæŸ¥è¯¢ç¼“å­˜å€¼çš„ç›¸å…³æ¡ç›®å°†è¢«æ¸…ç©º</span><br><span class="line"><span class="number">2.</span> <span class="keyword">INSERT</span>ã€<span class="keyword">UPDATE</span>ã€ <span class="keyword">DELETE</span>ã€<span class="keyword">TRUNCATE</span>ã€<span class="keyword">ALTER</span> <span class="keyword">TABLE</span>ã€<span class="keyword">DROP</span> <span class="keyword">TABLE</span>æˆ–<span class="keyword">DROP</span> <span class="keyword">DATABASE</span>ä¼šå¯¼è‡´ç¼“å­˜æ•°æ®å¤±æ•ˆ</span><br></pre></td></tr></table></figure><h2 id="3-ä½¿ç”¨åœºæ™¯"><a href="#3-ä½¿ç”¨åœºæ™¯" class="headerlink" title="3. ä½¿ç”¨åœºæ™¯"></a>3. ä½¿ç”¨åœºæ™¯</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1.</span> å¯¹äºé¢‘ç¹æ›´æ–°çš„è¡¨ï¼ŒæŸ¥è¯¢ç¼“å­˜ä¸åˆé€‚</span><br><span class="line"><span class="bullet">2.</span> å¯¹äºä¸€äº›ä¸å˜çš„æ•°æ®ä¸”æœ‰å¤§é‡ç›¸åŒsqlæŸ¥è¯¢çš„è¡¨ï¼ŒæŸ¥è¯¢ç¼“å­˜å¯ä»¥å¤§å¤§æé«˜æŸ¥è¯¢çš„æ€§èƒ½</span><br></pre></td></tr></table></figure><h2 id="äºŒã€-å‘½ä¸­æ¡ä»¶"><a href="#äºŒã€-å‘½ä¸­æ¡ä»¶" class="headerlink" title="äºŒã€ å‘½ä¸­æ¡ä»¶"></a>äºŒã€ å‘½ä¸­æ¡ä»¶</h2><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> å¤§å°å†™æ•æ„Ÿçš„hashæŸ¥æ‰¾å®ç°çš„</span><br><span class="line"><span class="number">2.</span> ä»¥<span class="keyword">SQL</span>ã€æ•°æ®åº“åå’Œå®¢æˆ·ç«¯åè®®ç­‰ä½œä¸ºKEY</span><br><span class="line"><span class="number">3.</span> åœ¨åˆ¤æ–­å‘½ä¸­å‰ï¼ŒMySQLä¸ä¼šè§£æ<span class="keyword">SQL</span>ï¼Œè€Œæ˜¯ä½¿ç”¨<span class="keyword">SQL</span>å»æŸ¥è¯¢ç¼“å­˜ï¼Œ<span class="keyword">SQL</span>ä¸Šçš„ä»»ä½•å­—ç¬¦çš„ä¸åŒï¼Œå¦‚ç©ºæ ¼ã€æ³¨é‡Šç­‰éƒ½ä¼šå¯¼è‡´ç¼“å­˜ä¸å‘½ä¸­</span><br><span class="line"><span class="number">4.</span> å¦‚æœæŸ¥è¯¢æœ‰ä¸ç¡®å®šçš„æ•°æ®ï¼Œå¦‚<span class="keyword">like</span> now()ã€<span class="built_in">current_date</span>()ï¼Œé‚£ä¹ˆæŸ¥è¯¢å®Œæˆåç»“æœéƒ½ä¸ä¼šè¢«ç¼“å­˜</span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€å·¥ä½œæµç¨‹"><a href="#ä¸‰ã€å·¥ä½œæµç¨‹" class="headerlink" title="ä¸‰ã€å·¥ä½œæµç¨‹"></a>ä¸‰ã€å·¥ä½œæµç¨‹</h1><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> æœåŠ¡å™¨æ¥æ”¶<span class="keyword">SQL</span>ï¼Œä»¥<span class="keyword">SQL</span>å’Œä¸€äº›å…¶ä»–æ¡ä»¶ä¸ºkeyæŸ¥æ‰¾ç¼“å­˜è¡¨</span><br><span class="line"><span class="number">2.</span> å¦‚æœç¼“å­˜å‘½ä¸­ï¼Œåˆ™ç›´æ¥è¿”å›ç¼“å­˜</span><br><span class="line"><span class="number">3.</span> å¦‚æœç¼“å­˜æ²¡æœ‰å‘½ä¸­ï¼Œåˆ™æ‰§è¡Œ<span class="keyword">SQL</span>æŸ¥è¯¢ï¼ŒåŒ…æ‹¬<span class="keyword">SQL</span>è§£æã€é¢„å¤„ç†ã€å†ç”±ä¼˜åŒ–å™¨ç”Ÿæˆå¯¹åº”çš„æ‰§è¡Œè®¡åˆ’ã€‚</span><br><span class="line"><span class="number">4.</span> MySqlæ ¹æ®ä¼˜åŒ–å™¨ç”Ÿæˆçš„æ‰§è¡Œè®¡åˆ’ï¼Œè°ƒç”¨å­˜å‚¨å¼•æ“çš„APIæ‰§è¡ŒæŸ¥è¯¢ã€‚</span><br><span class="line"><span class="number">4.</span> å°†<span class="keyword">SQL</span>æŸ¥è¯¢ç»“æœå†™å…¥ç¼“å­˜è¡¨(ä¸ç¡®å®šå‡½æ•°ä¸ç¼“å­˜ï¼Œä¾‹å¦‚now())ï¼Œå°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚</span><br></pre></td></tr></table></figure><h1 id="å››ã€MySQLç¼“å­˜ç®¡ç†"><a href="#å››ã€MySQLç¼“å­˜ç®¡ç†" class="headerlink" title="å››ã€MySQLç¼“å­˜ç®¡ç†"></a>å››ã€MySQLç¼“å­˜ç®¡ç†</h1><h2 id="1-ç¼“å­˜çš„å†…å­˜ç®¡ç†"><a href="#1-ç¼“å­˜çš„å†…å­˜ç®¡ç†" class="headerlink" title="1. ç¼“å­˜çš„å†…å­˜ç®¡ç†"></a>1. ç¼“å­˜çš„å†…å­˜ç®¡ç†</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1.</span> MySQLç¼“å­˜æœºåˆ¶ä¼šåœ¨å†…å­˜ä¸­å¼€è¾Ÿä¸€å—å†…å­˜ï¼ˆquery<span class="emphasis">_cache_</span>sizeï¼‰åŒºæ¥ç»´æŠ¤ç¼“å­˜æ•°æ®ï¼Œå…¶ä¸­å¤§æ¦‚æœ‰40Kçš„ç©ºé—´æ˜¯ç”¨æ¥ç»´æŠ¤ç¼“å­˜æ•°æ®çš„å…ƒæ•°æ®çš„ï¼Œ</span><br><span class="line">ä¾‹å¦‚ç©ºé—´å†…å­˜ã€æ•°æ®è¡¨å’ŒæŸ¥è¯¢ç»“æœçš„æ˜ å°„ï¼ŒSQLå’ŒæŸ¥è¯¢ç»“æœçš„æ˜ å°„ã€‚</span><br><span class="line"><span class="bullet">2.</span> MySQLç¼“å­˜æœºåˆ¶å°†å¤§å†…å­˜å—åˆ†ä¸ºå°å†…å­˜å—ï¼ˆquery<span class="emphasis">_cache_</span>min<span class="emphasis">_res_</span>unit)ï¼Œæ¯ä¸ªå°å—ä¸­å­˜å‚¨è‡ªèº«çš„ç±»å‹ã€å¤§å°å’ŒæŸ¥è¯¢ç»“æœæ•°æ®ï¼Œè¿˜æœ‰å‰åå†…å­˜å—çš„æŒ‡é’ˆã€‚</span><br><span class="line"><span class="bullet">3.</span> MySQLç¼“å­˜æœºåˆ¶ä¼šåœ¨SQLæŸ¥è¯¢å¼€å§‹ï¼ˆè¿˜æœªå¾—åˆ°ç»“æœï¼‰æ—¶å°±å»ç”³è¯·ä¸€å—å†…å­˜ç©ºé—´ï¼Œæ‰€ä»¥å³ä½¿ç¼“å­˜æ•°æ®æ²¡æœ‰è¾¾åˆ°è¿™ä¸ªå¤§å°ä¹Ÿéœ€è¦å ç”¨ç”³è¯·çš„å†…å­˜å—ç©ºé—´ï¼ˆlike linux filesystemâ€™s block)ã€‚</span><br><span class="line">å¦‚æœè¶…å‡ºç”³è¯·å†…å­˜å—çš„å¤§å°ï¼Œåˆ™éœ€è¦å†ç”³è¯·ä¸€ä¸ªå†…å­˜å—ã€‚å½“æŸ¥è¯¢å®Œæˆå‘ç°ç”³è¯·çš„å†…å­˜æœ‰å¯Œä½™ï¼Œåˆ™ä¼šå°†å¯Œä½™çš„å†…å­˜ç©ºé—´é‡Šæ”¾æ‰ï¼Œå› è€Œå¯èƒ½ä¼šé€ æˆå†…å­˜ç¢ç‰‡ã€‚</span><br></pre></td></tr></table></figure><h2 id="2-ç¼“å­˜å¤±è´¥"><a href="#2-ç¼“å­˜å¤±è´¥" class="headerlink" title="2. ç¼“å­˜å¤±è´¥"></a>2. ç¼“å­˜å¤±è´¥</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1.</span> å½“æŸä¸ªè¡¨æ­£åœ¨å†™å…¥æ•°æ®ï¼Œåˆ™è¿™ä¸ªè¡¨çš„ç¼“å­˜å°†ä¼šå¤„äºå¤±æ•ˆçŠ¶æ€</span><br><span class="line"><span class="bullet">2.</span> åœ¨InnoDBä¸­ï¼Œå¦‚æœæŸä¸ªäº‹åŠ¡ä¿®æ”¹äº†è¡¨ï¼Œåˆ™è¿™ä¸ªè¡¨çš„ç¼“å­˜åœ¨äº‹åŠ¡æäº¤å‰éƒ½ä¼šå¤„äºå¤±æ•ˆçŠ¶æ€ï¼Œå³åœ¨äº‹åŠ¡æäº¤å‰ï¼Œè¿™ä¸ªè¡¨çš„ç›¸å…³æŸ¥è¯¢éƒ½æ— æ³•è¢«ç¼“å­˜</span><br></pre></td></tr></table></figure><h1 id="äº”ã€ç¼“å­˜çš„ä½¿ç”¨æ—¶æœº"><a href="#äº”ã€ç¼“å­˜çš„ä½¿ç”¨æ—¶æœº" class="headerlink" title="äº”ã€ç¼“å­˜çš„ä½¿ç”¨æ—¶æœº"></a>äº”ã€ç¼“å­˜çš„ä½¿ç”¨æ—¶æœº</h1><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1.</span> é€šè¿‡ç¼“å­˜å‘½ä¸­ç‡åˆ¤æ–­</span><br><span class="line">ç¼“å­˜å‘½ä¸­ç‡ = ç¼“å­˜å‘½ä¸­æ¬¡æ•° (Qcache<span class="emphasis">_hits) / æŸ¥è¯¢æ¬¡æ•° (Com_</span>select)</span><br><span class="line"></span><br><span class="line"><span class="bullet">2.</span> é€šè¿‡ç¼“å­˜å†™å…¥ç‡åˆ¤æ–­</span><br><span class="line">å†™å…¥ç‡ = ç¼“å­˜å†™å…¥æ¬¡æ•° (Qcache<span class="emphasis">_inserts) / æŸ¥è¯¢æ¬¡æ•° (Qcache_</span>inserts)</span><br><span class="line"></span><br><span class="line"><span class="bullet">3.</span> é€šè¿‡å‘½ä¸­-å†™å…¥ç‡åˆ¤æ–­</span><br><span class="line">æ¯”ç‡ = å‘½ä¸­æ¬¡æ•° (Qcache<span class="emphasis">_hits) / å†™å…¥æ¬¡æ•° (Qcache_</span>inserts),</span><br><span class="line"></span><br><span class="line">é«˜æ€§èƒ½MySQLä¸­ç§°ä¹‹ä¸ºæ¯”è¾ƒèƒ½åæ˜ æ€§èƒ½æå‡çš„æŒ‡æ•°ï¼Œä¸€èˆ¬æ¥è¯´è¾¾åˆ°3:1åˆ™ç®—æ˜¯æŸ¥è¯¢ç¼“å­˜æœ‰æ•ˆï¼Œè€Œæœ€å¥½èƒ½å¤Ÿè¾¾åˆ°10:1</span><br></pre></td></tr></table></figure><h1 id="å…­ã€ç¼“å­˜å‚æ•°é…ç½®"><a href="#å…­ã€ç¼“å­˜å‚æ•°é…ç½®" class="headerlink" title="å…­ã€ç¼“å­˜å‚æ•°é…ç½®"></a>å…­ã€ç¼“å­˜å‚æ•°é…ç½®</h1><h2 id="1-æŸ¥çœ‹ç¼“å­˜ç›¸å…³é…ç½®"><a href="#1-æŸ¥çœ‹ç¼“å­˜ç›¸å…³é…ç½®" class="headerlink" title="1. æŸ¥çœ‹ç¼“å­˜ç›¸å…³é…ç½®"></a>1. æŸ¥çœ‹ç¼“å­˜ç›¸å…³é…ç½®</h2><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;<span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;%query_cache%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>query_cache_type</span><br><span class="line">æ˜¯å¦æ‰“å¼€ç¼“å­˜ï¼Œå¯é€‰å‚æ•°æœ‰ï¼š</span><br><span class="line">- <span class="keyword">OFF</span>ï¼ˆ<span class="number">0</span>ï¼‰ï¼šå…³é—­ ï¼Œä¸ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜</span><br><span class="line">- <span class="keyword">ON</span>ï¼ˆ<span class="number">1</span>ï¼‰ï¼šæ€»æ˜¯æ‰“å¼€ ï¼Œå§‹ç»ˆä½¿ç”¨æŸ¥è¯¢ç¼“å­˜</span><br><span class="line">- DEMANDï¼ˆ<span class="number">2</span>ï¼‰ï¼šæŒ‰éœ€ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ï¼Œåªæœ‰æ˜ç¡®å†™äº†SQL_CACHEçš„æŸ¥è¯¢æ‰ä¼šå†™å…¥ç¼“å­˜</span><br><span class="line"></span><br><span class="line">å¦‚æœquery_cache_typeä¸º<span class="number">1</span>è€Œåˆä¸æƒ³åˆ©ç”¨æŸ¥è¯¢ç¼“å­˜ä¸­çš„æ•°æ®ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„<span class="keyword">SQL</span>ï¼š</span><br><span class="line">- <span class="keyword">SELECT</span> SQL_NO_CACHE * <span class="keyword">FROM</span> my_table <span class="keyword">WHERE</span> condition;</span><br><span class="line">å¦‚æœå€¼ä¸º<span class="number">2</span>ï¼Œè¦ä½¿ç”¨ç¼“å­˜çš„è¯ï¼Œéœ€è¦ä½¿ç”¨SQL_CACHEå¼€å…³å‚æ•°ï¼š</span><br><span class="line">- <span class="keyword">SELECT</span> SQL_CACHE * <span class="keyword">FROM</span> my_table <span class="keyword">WHERE</span> condition;</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>query_cache_size</span><br><span class="line">ç¼“å­˜ä½¿ç”¨çš„æ€»å†…å­˜ç©ºé—´å¤§å°ï¼Œå•ä½æ˜¯å­—èŠ‚ï¼Œè¿™ä¸ªå€¼å¿…é¡»æ˜¯<span class="number">1024</span>çš„æ•´æ•°å€ï¼›å¦åˆ™MySQLå®é™…åˆ†é…å¯èƒ½è·Ÿè¿™ä¸ªæ•°å€¼ä¸åŒ(æ„Ÿè§‰è¿™ä¸ªåº”è¯¥è·Ÿæ–‡ä»¶ç³»ç»Ÿçš„blcokå¤§å°æœ‰å…³)</span><br><span class="line">é»˜è®¤æƒ…å†µä¸‹query_cache_sizeä¸º<span class="number">0</span>ï¼Œè¡¨ç¤ºä¸ºæŸ¥è¯¢ç¼“å­˜é¢„ç•™çš„å†…å­˜ä¸º<span class="number">0</span>ï¼Œåˆ™æ— æ³•ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜</span><br><span class="line">è®¾ç½®query_cache_sizeçš„å€¼</span><br><span class="line">- <span class="keyword">SET</span> <span class="keyword">GLOBAL</span> query_cache_size = <span class="number">134217728</span>; <span class="comment">-- æ³¨æ„å€¼å¦‚æœè®¾å¾—å¤ªå°ä¸ä¼šç”Ÿæ•ˆ</span></span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>query_cache_min_res_unit</span><br><span class="line">åˆ†é…å†…å­˜å—æ—¶çš„æœ€å°å•ä½å¤§å°</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span>query_cache_limit</span><br><span class="line">MySQLèƒ½å¤Ÿç¼“å­˜çš„æœ€å¤§ç»“æœï¼Œå¦‚æœè¶…å‡ºï¼Œåˆ™å¢åŠ  Qcache_not_cachedçš„å€¼ï¼Œå¹¶åˆ é™¤æŸ¥è¯¢ç»“æœ</span><br><span class="line"></span><br><span class="line"><span class="number">5.</span>query_cache_wlock_invalidate</span><br><span class="line">å¦‚æœæŸä¸ªæ•°æ®è¡¨è¢«é”ä½ï¼Œæ˜¯å¦ä»ç„¶ä»ç¼“å­˜ä¸­è¿”å›æ•°æ®ï¼Œé»˜è®¤æ˜¯<span class="keyword">OFF</span>ï¼Œè¡¨ç¤ºä»ç„¶å¯ä»¥è¿”å›</span><br><span class="line"></span><br><span class="line"><span class="number">6.</span> <span class="keyword">GLOBAL</span> STATUS ä¸­å…³äºç¼“å­˜çš„å‚æ•°è§£é‡Š</span><br><span class="line">Qcache_free_blocksï¼šç¼“å­˜æ± ä¸­ç©ºé—²å—çš„ä¸ªæ•°</span><br><span class="line">Qcache_free_memoryï¼šç¼“å­˜ä¸­ç©ºé—²å†…å­˜é‡</span><br><span class="line">Qcache_hitsï¼šç¼“å­˜å‘½ä¸­æ¬¡æ•°</span><br><span class="line">Qcache_insertsï¼šç¼“å­˜å†™å…¥æ¬¡æ•°</span><br><span class="line">Qcache_lowmen_prunesï¼šå› å†…å­˜ä¸è¶³åˆ é™¤ç¼“å­˜æ¬¡æ•°</span><br><span class="line">Qcache_not_cachedï¼šæŸ¥è¯¢æœªè¢«ç¼“å­˜æ¬¡æ•°,ä¾‹å¦‚æŸ¥è¯¢ç»“æœè¶…å‡ºç¼“å­˜å—å¤§å°,æŸ¥è¯¢ä¸­åŒ…å«å¯å˜å‡½æ•°ç­‰</span><br><span class="line">Qcache_queries_in_cacheï¼šå½“å‰ç¼“å­˜ä¸­ç¼“å­˜çš„<span class="keyword">SQL</span>æ•°é‡</span><br><span class="line">Qcache_total_blocksï¼šç¼“å­˜æ€»blockæ•°</span><br></pre></td></tr></table></figure><h1 id="ä¸ƒã€å‡å°‘ç¼“å­˜ç¢ç‰‡ç­–ç•¥"><a href="#ä¸ƒã€å‡å°‘ç¼“å­˜ç¢ç‰‡ç­–ç•¥" class="headerlink" title="ä¸ƒã€å‡å°‘ç¼“å­˜ç¢ç‰‡ç­–ç•¥"></a>ä¸ƒã€å‡å°‘ç¼“å­˜ç¢ç‰‡ç­–ç•¥</h1><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é€‰æ‹©åˆé€‚çš„<span class="keyword">block</span>å¤§å°</span><br><span class="line">ä½¿ç”¨ <span class="keyword">FLUSH</span> QUERY CACHE å‘½ä»¤æ•´ç†ç¢ç‰‡ï¼Œè¿™ä¸ªå‘½ä»¤åœ¨æ•´ç†ç¼“å­˜æœŸé—´ï¼Œä¼šå¯¼è‡´å…¶ä»–è¿æ¥æ— æ³•ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜</span><br></pre></td></tr></table></figure><h1 id="å…«ã€æ¸…ç©ºç¼“å­˜çš„å‘½ä»¤"><a href="#å…«ã€æ¸…ç©ºç¼“å­˜çš„å‘½ä»¤" class="headerlink" title="å…«ã€æ¸…ç©ºç¼“å­˜çš„å‘½ä»¤"></a>å…«ã€æ¸…ç©ºç¼“å­˜çš„å‘½ä»¤</h1><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">RESET QUERY <span class="keyword">CACHE</span>; <span class="comment">// ä»æŸ¥è¯¢ç¼“å­˜ä¸­ç§»å‡ºæ‰€æœ‰æŸ¥è¯¢ã€‚</span></span><br><span class="line">FLUSH TABLES; <span class="comment">//å…³é—­æ‰€æœ‰æ‰“å¼€çš„è¡¨ï¼ŒåŒæ—¶è¯¥æ“ä½œå°†ä¼šæ¸…ç©ºæŸ¥è¯¢ç¼“å­˜ä¸­çš„å†…å®¹ã€‚</span></span><br></pre></td></tr></table></figure><h1 id="ä¹-InnoDBæŸ¥è¯¢ç¼“å­˜"><a href="#ä¹-InnoDBæŸ¥è¯¢ç¼“å­˜" class="headerlink" title="ä¹. InnoDBæŸ¥è¯¢ç¼“å­˜"></a>ä¹. InnoDBæŸ¥è¯¢ç¼“å­˜</h1><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">InnoDBå­˜å‚¨å¼•æ“ä¼šå¯¹æ¯ä¸ªè¡¨è®¾ç½®ä¸€ä¸ªäº‹åŠ¡è®¡æ•°å™¨ï¼Œé‡Œé¢å­˜å‚¨å½“å‰æœ€å¤§çš„äº‹åŠ¡ID</span><br><span class="line">å½“ä¸€ä¸ªäº‹åŠ¡æäº¤æ—¶ï¼ŒInnoDBä¼šä½¿ç”¨MVCCä¸­ç³»ç»Ÿæœ€å¤§çš„äº‹åŠ¡IDæ›´æ–°å½“å‰è¡¨çš„è®¡æ•°å™¨</span><br><span class="line">åªæœ‰æ¯”è¿™ä¸ªæœ€å¤§IDå¤§çš„äº‹åŠ¡èƒ½ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ï¼Œå…¶ä»–æ¯”è¿™ä¸ªIDå°çš„äº‹åŠ¡åˆ™ä¸èƒ½ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜</span><br><span class="line">åœ¨InnoDBä¸­ï¼Œæ‰€æœ‰åŠ é”æ“ä½œçš„äº‹åŠ¡éƒ½ä¸ä½¿ç”¨ä»»ä½•æŸ¥è¯¢ç¼“å­˜</span><br><span class="line">æŸ¥è¯¢å¿…é¡»æ˜¯å®Œå…¨ç›¸åŒçš„(é€å­—èŠ‚ç›¸åŒ)æ‰èƒ½å¤Ÿè¢«è®¤ä¸ºæ˜¯ç›¸åŒçš„ã€‚</span><br><span class="line">æŸ¥è¯¢å­—ç¬¦ä¸²ç”±äºå…¶å®ƒåŸå› ä½¿ç”¨ä¸åŒçš„æ•°æ®åº“ã€ä¸åŒçš„åè®®ç‰ˆæœ¬æˆ–è€…ä¸åŒçš„é»˜è®¤å­—ç¬¦é›†éƒ½ä¼šè¢«è®¤ä¸ºæ˜¯ä¸åŒçš„æŸ¥è¯¢è€Œåˆ†åˆ«è¿›è¡Œç¼“å­˜ã€‚</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> mysql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>COUNT(*)ã€COUNT(1)ã€COUNT(å­—æ®µ)åŒºåˆ«</title>
      <link href="/posts/9ad8d7b0.html"/>
      <url>/posts/9ad8d7b0.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h2 id="1ã€åˆè¯†COUNT"><a href="#1ã€åˆè¯†COUNT" class="headerlink" title="1ã€åˆè¯†COUNT"></a>1ã€åˆè¯†COUNT</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>ã€<span class="built_in">COUNT</span>(expr) ï¼Œè¿”å›<span class="keyword">SELECT</span>è¯­å¥æ£€ç´¢çš„è¡Œä¸­exprçš„å€¼ä¸ä¸º<span class="keyword">NULL</span>çš„æ•°é‡ã€‚ç»“æœæ˜¯ä¸€ä¸ª<span class="type">BIGINT</span>å€¼ã€‚</span><br><span class="line"><span class="number">2</span>ã€å¦‚æœæŸ¥è¯¢ç»“æœæ²¡æœ‰å‘½ä¸­ä»»ä½•è®°å½•ï¼Œåˆ™è¿”å›<span class="number">0</span></span><br><span class="line"><span class="number">3</span>ã€ä½†æ˜¯ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ<span class="built_in">COUNT</span>(<span class="operator">*</span>) çš„ç»Ÿè®¡ç»“æœä¸­ï¼Œä¼šåŒ…å«å€¼ä¸º<span class="keyword">NULL</span>çš„è¡Œæ•°ã€‚</span><br></pre></td></tr></table></figure><h2 id="2-COUNT-å­—æ®µ-ã€COUNT-å¸¸é‡-å’ŒCOUNT-ä¹‹é—´çš„åŒºåˆ«"><a href="#2-COUNT-å­—æ®µ-ã€COUNT-å¸¸é‡-å’ŒCOUNT-ä¹‹é—´çš„åŒºåˆ«" class="headerlink" title="2.COUNT(å­—æ®µ)ã€COUNT(å¸¸é‡)å’ŒCOUNT(*)ä¹‹é—´çš„åŒºåˆ«"></a>2.COUNT(å­—æ®µ)ã€COUNT(å¸¸é‡)å’ŒCOUNT(*)ä¹‹é—´çš„åŒºåˆ«</h2><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">COUNT(å¸¸é‡) å’Œ COUNT<span class="comment">(*) è¡¨ç¤ºçš„æ˜¯ç›´æ¥æŸ¥è¯¢ç¬¦åˆæ¡ä»¶çš„æ•°æ®åº“è¡¨çš„è¡Œæ•°ã€‚</span></span><br><span class="line"><span class="comment">è€ŒCOUNT(åˆ—å)è¡¨ç¤ºçš„æ˜¯æŸ¥è¯¢ç¬¦åˆæ¡ä»¶çš„åˆ—çš„å€¼ä¸ä¸ºNULLçš„è¡Œæ•°ã€‚</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">COUNT(*)</span>æ˜¯SQL92å®šä¹‰çš„æ ‡å‡†ç»Ÿè®¡è¡Œæ•°çš„è¯­æ³•ï¼Œå› ä¸ºæ˜¯æ ‡å‡†è¯­æ³•ï¼Œæ‰€ä»¥MySQLæ•°æ®åº“è¿›è¡Œè¿‡å¾ˆå¤šä¼˜åŒ–ã€‚</span><br><span class="line">SQL92ï¼šæ˜¯æ•°æ®åº“çš„ä¸€ä¸ªANSI/ISOæ ‡å‡†ã€‚å®ƒå®šä¹‰äº†ä¸€ç§è¯­è¨€ï¼ˆSQLï¼‰ä»¥åŠæ•°æ®åº“çš„è¡Œä¸ºï¼ˆäº‹åŠ¡ã€éš”ç¦»çº§åˆ«ç­‰ï¼‰ã€‚</span><br></pre></td></tr></table></figure><h2 id="3-COUNT-çš„ä¼˜åŒ–"><a href="#3-COUNT-çš„ä¼˜åŒ–" class="headerlink" title="3.COUNT(*)çš„ä¼˜åŒ–"></a>3.COUNT(*)çš„ä¼˜åŒ–</h2><p>MySQLä¸»è¦ä½¿ç”¨2ç§æ‰§è¡Œå¼•æ“ï¼š</p><p>MyISAM</p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MyISAMä¸æ”¯æŒäº‹åŠ¡ï¼ŒMyISAMä¸­çš„é”æ˜¯è¡¨çº§é”</span><br><span class="line"></span><br><span class="line">MyISAMåšäº†ä¸€ä¸ªç®€å•çš„ä¼˜åŒ–ï¼ŒæŠŠè¡¨çš„æ€»è¡Œæ•°å•ç‹¬è®°å½•ä¸‹æ¥ï¼Œå¦‚æœæ‰§è¡Œ<span class="keyword">count</span>(*)æ—¶å¯ä»¥ç›´æ¥è¿”å›ï¼Œå‰ææ˜¯ä¸èƒ½æœ‰<span class="keyword">where</span>æ¡ä»¶ã€‚</span><br><span class="line"></span><br><span class="line">MyISAMæ˜¯è¡¨çº§é”ï¼Œä¸ä¼šæœ‰å¹¶å‘çš„è¡Œæ“ä½œï¼Œæ‰€ä»¥æŸ¥åˆ°çš„ç»“æœæ˜¯å‡†ç¡®çš„ã€‚</span><br></pre></td></tr></table></figure><p>InnoDB</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">InnoDBæ”¯æŒäº‹åŠ¡ï¼Œå¹¶ä¸”æ”¯æŒè¡Œçº§é”</span><br><span class="line"></span><br><span class="line">InnoDBä¸èƒ½ä½¿ç”¨è¿™ç§ç¼“å­˜æ“ä½œï¼Œå› ä¸ºæ”¯æŒäº‹åŠ¡ï¼Œå¤§éƒ¨åˆ†æ“ä½œéƒ½æ˜¯è¡Œçº§é”ï¼Œè¡Œå¯èƒ½è¢«å¹¶è¡Œä¿®æ”¹ï¼Œé‚£ä¹ˆç¼“å­˜è®°å½•ä¸å‡†ç¡®ã€‚</span><br><span class="line">ä½†æ˜¯ï¼ŒInnoDBè¿˜æ˜¯é’ˆå¯¹COUNT(*)è¯­å¥åšäº†äº›ä¼˜åŒ–çš„ã€‚</span><br><span class="line">é€šè¿‡ä½æˆæœ¬çš„ç´¢å¼•è¿›è¡Œæ‰«è¡¨ï¼Œè€Œä¸å…³æ³¨è¡¨çš„å…·ä½“å†…å®¹ã€‚</span><br><span class="line"></span><br><span class="line">InnoDBä¸­ç´¢å¼•åˆ†ä¸ºèšç°‡ç´¢å¼•ï¼ˆä¸»é”®ç´¢å¼•ï¼‰å’Œéèšç°‡ç´¢å¼•ï¼ˆéä¸»é”®ç´¢å¼•ï¼‰ï¼Œèšç°‡ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ä¸­ä¿å­˜çš„æ˜¯æ•´è¡Œè®°å½•ï¼Œè€Œéèšç°‡ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ä¸­ä¿å­˜çš„æ˜¯è¯¥è¡Œè®°å½•çš„ä¸»é”®çš„å€¼ã€‚</span><br><span class="line">MySQLä¼šä¼˜å…ˆé€‰æ‹©æœ€å°çš„éèšç°‡ç´¢å¼•æ¥æ‰«è¡¨ã€‚</span><br><span class="line">ä¼˜åŒ–çš„å‰ææ˜¯æŸ¥è¯¢è¯­å¥ä¸­ä¸åŒ…å«<span class="keyword">where</span>æ¡ä»¶å’Œ<span class="keyword">group</span> <span class="keyword">by</span>æ¡ä»¶ã€‚</span><br></pre></td></tr></table></figure><h2 id="4-COUNT-å’ŒCOUNT-1"><a href="#4-COUNT-å’ŒCOUNT-1" class="headerlink" title="4.COUNT(*)å’ŒCOUNT(1)"></a>4.COUNT(*)å’ŒCOUNT(1)</h2><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MySQLå®˜æ–¹æ–‡æ¡£è¿™ä¹ˆè¯´ï¼š</span><br><span class="line">    InnoDB handles <span class="keyword">SELECT</span> COUNT<span class="comment">(*) and SELECT COUNT(1) operations in the same way. There is no performance difference.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">æ‰€ä»¥ï¼Œå¯¹äºcount(1)å’Œcount(*)</span>ï¼ŒMySQLçš„ä¼˜åŒ–æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œæ ¹æœ¬ä¸å­˜åœ¨è°æ›´å¿«ï¼</span><br><span class="line">ä½†ä¾æ—§å»ºè®®ä½¿ç”¨count<span class="comment">(*)ï¼Œå› ä¸ºè¿™æ˜¯SQL92å®šä¹‰çš„æ ‡å‡†ç»Ÿè®¡è¡Œæ•°çš„è¯­æ³•ã€‚</span></span><br></pre></td></tr></table></figure><h2 id="5-COUNT-å­—æ®µ"><a href="#5-COUNT-å­—æ®µ" class="headerlink" title="5.COUNT(å­—æ®µ)"></a>5.COUNT(å­—æ®µ)</h2><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¿›è¡Œå…¨è¡¨æ‰«æï¼Œåˆ¤æ–­æŒ‡å®šå­—æ®µçš„å€¼æ˜¯å¦ä¸º<span class="literal">NULL</span>ï¼Œä¸ä¸º<span class="literal">NULL</span>åˆ™ç´¯åŠ ã€‚</span><br><span class="line">æ€§èƒ½æ¯”<span class="built_in">count</span>(<span class="number">1</span>)å’Œ<span class="built_in">count</span>(*)æ…¢ã€‚</span><br></pre></td></tr></table></figure><h2 id="6-æ€»ç»“"><a href="#6-æ€»ç»“" class="headerlink" title="6.æ€»ç»“"></a>6.æ€»ç»“</h2><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">COUNTå‡½æ•°çš„ç”¨æ³•ï¼Œä¸»è¦ç”¨äºç»Ÿè®¡è¡¨è¡Œæ•°ã€‚ä¸»è¦ç”¨æ³•æœ‰COUNT<span class="comment">(*)ã€COUNT(å­—æ®µ)å’ŒCOUNT(1)ã€‚</span></span><br><span class="line"><span class="comment">å› ä¸ºCOUNT(*)</span>æ˜¯SQL92å®šä¹‰çš„æ ‡å‡†ç»Ÿè®¡è¡Œæ•°çš„è¯­æ³•ï¼Œæ‰€ä»¥MySQLå¯¹ä»–è¿›è¡Œäº†å¾ˆå¤šä¼˜åŒ–ï¼ŒMyISAMä¸­ä¼šç›´æ¥æŠŠè¡¨çš„æ€»è¡Œæ•°å•ç‹¬è®°å½•ä¸‹æ¥ä¾›COUNT<span class="comment">(*)æŸ¥è¯¢ï¼Œè€ŒInnoDBåˆ™ä¼šåœ¨æ‰«è¡¨çš„æ—¶å€™é€‰æ‹©æœ€å°çš„ç´¢å¼•æ¥é™ä½æˆæœ¬ã€‚å½“ç„¶ï¼Œè¿™äº›ä¼˜åŒ–çš„å‰æéƒ½æ˜¯æ²¡æœ‰è¿›è¡Œwhereå’Œgroupçš„æ¡ä»¶æŸ¥è¯¢ã€‚</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">åœ¨InnoDBä¸­COUNT(*)</span>å’ŒCOUNT(<span class="number">1</span>)å®ç°ä¸Šæ²¡æœ‰åŒºåˆ«ï¼Œè€Œä¸”æ•ˆç‡ä¸€æ ·ï¼Œä½†æ˜¯COUNT(å­—æ®µ)éœ€è¦è¿›è¡Œå­—æ®µçš„éNULLåˆ¤æ–­ï¼Œæ‰€ä»¥æ•ˆç‡ä¼šä½ä¸€äº›ã€‚</span><br><span class="line">å› ä¸ºCOUNT<span class="comment">(*)æ˜¯SQL92å®šä¹‰çš„æ ‡å‡†ç»Ÿè®¡è¡Œæ•°çš„è¯­æ³•ï¼Œå¹¶ä¸”æ•ˆç‡é«˜ï¼Œæ‰€ä»¥è¯·ç›´æ¥ä½¿ç”¨COUNT(*)</span>æŸ¥è¯¢è¡¨çš„è¡Œæ•°ï¼</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> mysql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é«˜æ€§èƒ½mysqlç¬”è®°</title>
      <link href="/posts/32ec3ef1.html"/>
      <url>/posts/32ec3ef1.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€åŠ å¿«ALTER-TABLEæ“ä½œé€Ÿåº¦"><a href="#ä¸€ã€åŠ å¿«ALTER-TABLEæ“ä½œé€Ÿåº¦" class="headerlink" title="ä¸€ã€åŠ å¿«ALTER TABLEæ“ä½œé€Ÿåº¦"></a>ä¸€ã€åŠ å¿«ALTER TABLEæ“ä½œé€Ÿåº¦</h1><p>MYSQLæ‰§è¡Œå¤§éƒ¨åˆ†ä¿®æ”¹è¡¨çš„æ“ä½œï¼Œéƒ½æ˜¯åˆ›å»ºæ–°çš„è¡¨ï¼Œç„¶åä»æ—§çš„è¡¨å¤åˆ¶æ•°æ®åˆ°æ–°è¡¨ï¼Œç„¶ååˆ é™¤æ—§è¡¨ã€‚</p><h2 id="1-ä¿®æ”¹é»˜è®¤å€¼"><a href="#1-ä¿®æ”¹é»˜è®¤å€¼" class="headerlink" title="1.ä¿®æ”¹é»˜è®¤å€¼"></a>1.ä¿®æ”¹é»˜è®¤å€¼</h2><p>ä¿®æ”¹é»˜è®¤å€¼ï¼Œä¸è§¦å‘é‡å»ºè¡¨æ“ä½œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;ALTER TABLE table ALTER COLUMN name SET DEFAULT &#x27;&#x27;;</span><br></pre></td></tr></table></figure><h2 id="2-åªä¿®æ”¹-frm"><a href="#2-åªä¿®æ”¹-frm" class="headerlink" title="2.åªä¿®æ”¹.frm"></a>2.åªä¿®æ”¹.frm</h2><h3 id="1-åˆ›å»ºä¸€å¼ ç›¸åŒç»“æ„çš„ç©ºè¡¨ï¼Œå¹¶è¿›è¡Œæ‰€éœ€è¦çš„ä¿®æ”¹"><a href="#1-åˆ›å»ºä¸€å¼ ç›¸åŒç»“æ„çš„ç©ºè¡¨ï¼Œå¹¶è¿›è¡Œæ‰€éœ€è¦çš„ä¿®æ”¹" class="headerlink" title="1. åˆ›å»ºä¸€å¼ ç›¸åŒç»“æ„çš„ç©ºè¡¨ï¼Œå¹¶è¿›è¡Œæ‰€éœ€è¦çš„ä¿®æ”¹"></a>1. åˆ›å»ºä¸€å¼ ç›¸åŒç»“æ„çš„ç©ºè¡¨ï¼Œå¹¶è¿›è¡Œæ‰€éœ€è¦çš„ä¿®æ”¹</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;CREATE TABLE table_new LIKE table;</span><br><span class="line">mysql&gt;ALTER TABLE table_new MODIFY COLUMN updateTime INT();</span><br></pre></td></tr></table></figure><h3 id="2-æ‰§è¡ŒFLUSH-TABLES-WITH-READ-LOCK-è¿™å°†ä¼šå…³é—­æ‰€æœ‰æ­£åœ¨ä½¿ç”¨çš„è¡¨ï¼Œå¹¶ç¦æ­¢ä»»ä½•è¡¨è¢«æ‰“å¼€ã€‚"><a href="#2-æ‰§è¡ŒFLUSH-TABLES-WITH-READ-LOCK-è¿™å°†ä¼šå…³é—­æ‰€æœ‰æ­£åœ¨ä½¿ç”¨çš„è¡¨ï¼Œå¹¶ç¦æ­¢ä»»ä½•è¡¨è¢«æ‰“å¼€ã€‚" class="headerlink" title="2. æ‰§è¡ŒFLUSH TABLES WITH READ LOCK,è¿™å°†ä¼šå…³é—­æ‰€æœ‰æ­£åœ¨ä½¿ç”¨çš„è¡¨ï¼Œå¹¶ç¦æ­¢ä»»ä½•è¡¨è¢«æ‰“å¼€ã€‚"></a>2. æ‰§è¡ŒFLUSH TABLES WITH READ LOCK,è¿™å°†ä¼šå…³é—­æ‰€æœ‰æ­£åœ¨ä½¿ç”¨çš„è¡¨ï¼Œå¹¶ç¦æ­¢ä»»ä½•è¡¨è¢«æ‰“å¼€ã€‚</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;FLUSH TABLES WITH READ LOCK;</span><br></pre></td></tr></table></figure><h3 id="3-äº¤æ¢-frm"><a href="#3-äº¤æ¢-frm" class="headerlink" title="3. äº¤æ¢.frm"></a>3. äº¤æ¢.frm</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">mv</span> table.frm table_tmp.frm</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">mv</span> table_new.frm table.frm</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">mv</span> table_tmp.frm table_new.frm</span></span><br></pre></td></tr></table></figure><h3 id="4-æ‰§è¡ŒUNLOCK-TABLESï¼Œé‡Šæ”¾åªè¯»é”"><a href="#4-æ‰§è¡ŒUNLOCK-TABLESï¼Œé‡Šæ”¾åªè¯»é”" class="headerlink" title="4. æ‰§è¡ŒUNLOCK TABLESï¼Œé‡Šæ”¾åªè¯»é”"></a>4. æ‰§è¡ŒUNLOCK TABLESï¼Œé‡Šæ”¾åªè¯»é”</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;UNLOCK TABLES;</span><br></pre></td></tr></table></figure><h3 id="5-åˆ é™¤åˆ›å»ºçš„ä¸´æ—¶è¡¨"><a href="#5-åˆ é™¤åˆ›å»ºçš„ä¸´æ—¶è¡¨" class="headerlink" title="5. åˆ é™¤åˆ›å»ºçš„ä¸´æ—¶è¡¨"></a>5. åˆ é™¤åˆ›å»ºçš„ä¸´æ—¶è¡¨</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;DROP TABLE table_new;</span><br></pre></td></tr></table></figure><h1 id="äºŒã€EXPLAINè¯´æ˜"><a href="#äºŒã€EXPLAINè¯´æ˜" class="headerlink" title="äºŒã€EXPLAINè¯´æ˜"></a>äºŒã€EXPLAINè¯´æ˜</h1><h2 id="1-typeè¯´æ˜"><a href="#1-typeè¯´æ˜" class="headerlink" title="1.typeè¯´æ˜"></a>1.typeè¯´æ˜</h2><p>ç”±ä¸Šåˆ°ä¸‹ï¼Œæ€§èƒ½ç”±æœ€å·®åˆ°æœ€å¥½<br>ALLï¼šFull Table Scanï¼Œ MySQLå°†éå†å…¨è¡¨ä»¥æ‰¾åˆ°åŒ¹é…çš„è¡Œ<br>indexï¼šFull Index Scanï¼Œindexä¸ALLåŒºåˆ«ä¸ºindexç±»å‹åªéå†ç´¢å¼•æ ‘<br>rangeï¼šç´¢å¼•èŒƒå›´æ‰«æï¼Œå¯¹ç´¢å¼•çš„æ‰«æå¼€å§‹äºæŸä¸€ç‚¹ï¼Œè¿”å›åŒ¹é…å€¼åŸŸçš„è¡Œï¼Œå¸¸è§äºbetweenã€&lt;ã€&gt;ç­‰çš„æŸ¥è¯¢<br>refï¼šéå”¯ä¸€æ€§ç´¢å¼•æ‰«æï¼Œè¿”å›åŒ¹é…æŸä¸ªå•ç‹¬å€¼çš„æ‰€æœ‰è¡Œã€‚å¸¸è§äºä½¿ç”¨éå”¯ä¸€ç´¢å¼•å³å”¯ä¸€ç´¢å¼•çš„éå”¯ä¸€å‰ç¼€è¿›è¡Œçš„æŸ¥æ‰¾<br>eq_refï¼šå”¯ä¸€æ€§ç´¢å¼•æ‰«æï¼Œå¯¹äºæ¯ä¸ªç´¢å¼•é”®ï¼Œè¡¨ä¸­åªæœ‰ä¸€æ¡è®°å½•ä¸ä¹‹åŒ¹é…ã€‚å¸¸è§äºä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•æ‰«æ<br>constã€systemï¼šå½“MySQLå¯¹æŸ¥è¯¢æŸéƒ¨åˆ†è¿›è¡Œä¼˜åŒ–ï¼Œå¹¶è½¬æ¢ä¸ºä¸€ä¸ªå¸¸é‡æ—¶ï¼Œä½¿ç”¨è¿™äº›ç±»å‹è®¿é—®ã€‚å¦‚å°†ä¸»é”®ç½®äºwhereåˆ—è¡¨ä¸­ï¼ŒMySQLå°±èƒ½å°†è¯¥æŸ¥è¯¢è½¬æ¢ä¸ºä¸€ä¸ªå¸¸é‡<br>NULLï¼šMySQLåœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­åˆ†è§£è¯­å¥ï¼Œæ‰§è¡Œæ—¶ç”šè‡³ä¸ç”¨è®¿é—®è¡¨æˆ–ç´¢å¼•  </p><h2 id="2-Extraè¯´æ˜"><a href="#2-Extraè¯´æ˜" class="headerlink" title="2.Extraè¯´æ˜"></a>2.Extraè¯´æ˜</h2><p>Using index (JSON property: using_index)<br>è¡¨ç¤ºç›´æ¥è®¿é—®ç´¢å¼•å°±èƒ½å¤Ÿè·å–åˆ°æ‰€éœ€è¦çš„æ•°æ®ï¼ˆè¦†ç›–ç´¢å¼•ï¼‰ï¼Œä¸éœ€è¦é€šè¿‡ç´¢å¼•å›è¡¨ï¼›<br>è¦†ç›–ç´¢å¼•:ä¸€ä¸ªç´¢å¼•åŒ…å«ï¼ˆæˆ–è€…è¯´è¦†ç›–ï¼‰æ‰€æœ‰éœ€è¦æŸ¥è¯¢çš„å­—æ®µçš„å€¼ã€‚æˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œè¦†ç›–ç´¢å¼•â€ã€‚ä¹Ÿä¸éœ€è¦å›è¡¨æ“ä½œ</p><p>Using where (JSON property: attached_condition)<br>è¡¨ç¤ºMySQLæœåŠ¡å™¨åœ¨å­˜å‚¨å¼•æ“æ”¶åˆ°è®°å½•åè¿›è¡Œâ€œåè¿‡æ»¤â€ï¼ˆPost-filterï¼‰,å¦‚æœæŸ¥è¯¢æœªèƒ½ä½¿ç”¨ç´¢å¼•ï¼ŒUsing whereçš„ä½œç”¨åªæ˜¯æé†’æˆ‘ä»¬MySQLå°†ç”¨whereå­å¥æ¥è¿‡æ»¤ç»“æœé›†ã€‚  è¿™ä¸ªä¸€èˆ¬å‘ç”Ÿåœ¨MySQLæœåŠ¡å™¨ï¼Œè€Œä¸æ˜¯å­˜å‚¨å¼•æ“å±‚ã€‚ä¸€èˆ¬å‘ç”Ÿåœ¨ä¸èƒ½èµ°ç´¢å¼•æ‰«æçš„æƒ…å†µä¸‹æˆ–è€…èµ°ç´¢å¼•æ‰«æï¼Œä½†æ˜¯æœ‰äº›æŸ¥è¯¢æ¡ä»¶ä¸åœ¨ç´¢å¼•å½“ä¸­çš„æƒ…å†µä¸‹ã€‚</p><p>Using index condition (JSON property: using_index_condition)<br>é€šè¿‡è®¿é—®ç´¢å¼•å…ƒç»„å¹¶é¦–å…ˆæµ‹è¯•å®ƒä»¬ä»¥ç¡®å®šæ˜¯å¦è¯»å–å®Œæ•´è¡¨è¡Œæ¥è¯»å–è¡¨ã€‚ä»¥è¿™ç§æ–¹å¼ï¼Œç´¢å¼•ä¿¡æ¯ç”¨äºæ¨è¿Ÿè¯»å–å®Œæ•´è¡¨è¡Œï¼Œé™¤éæ˜¯å¿…è¦çš„ã€‚</p><p>Using temporary<br>è¡¨ç¤ºMySQLéœ€è¦ä½¿ç”¨ä¸´æ—¶è¡¨æ¥å­˜å‚¨ç»“æœé›†ï¼Œå¸¸è§äºæ’åºå’Œåˆ†ç»„æŸ¥è¯¢</p><p>Using filesort<br>MySQLä¸­æ— æ³•åˆ©ç”¨ç´¢å¼•å®Œæˆçš„æ’åºæ“ä½œç§°ä¸ºâ€œæ–‡ä»¶æ’åºâ€</p><p>Using Index Condition<br>åœ¨MySQL 5.6ç‰ˆæœ¬ååŠ å…¥çš„æ–°ç‰¹æ€§ï¼ˆIndex Condition Pushdownï¼‰;ä¼šå…ˆæ¡ä»¶è¿‡æ»¤ç´¢å¼•ï¼Œè¿‡æ»¤å®Œç´¢å¼•åæ‰¾åˆ°æ‰€æœ‰ç¬¦åˆç´¢å¼•æ¡ä»¶çš„æ•°æ®è¡Œï¼Œéšåç”¨ WHERE å­å¥ä¸­çš„å…¶ä»–æ¡ä»¶å»è¿‡æ»¤è¿™äº›æ•°æ®è¡Œï¼›</p><h2 id="3-ä½¿ç”¨EXTENDED"><a href="#3-ä½¿ç”¨EXTENDED" class="headerlink" title="3.ä½¿ç”¨EXTENDED"></a>3.ä½¿ç”¨EXTENDED</h2><p>é¢å¤–æ˜¾ç¤ºmysqlä¼˜åŒ–åçš„è¯­å¥</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;<span class="keyword">EXPLAIN</span> EXTENDED <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">user</span>;</span><br><span class="line">mysql&gt;<span class="keyword">SHOW</span> WARNINGS;</span><br></pre></td></tr></table></figure><h1 id="äºŒã€ç´¢å¼•"><a href="#äºŒã€ç´¢å¼•" class="headerlink" title="äºŒã€ç´¢å¼•"></a>äºŒã€ç´¢å¼•</h1><h2 id="1-ç´¢å¼•åŒ¹é…"><a href="#1-ç´¢å¼•åŒ¹é…" class="headerlink" title="1. ç´¢å¼•åŒ¹é…"></a>1. ç´¢å¼•åŒ¹é…</h2><p>å…¨å€¼åŒ¹é…ï¼šå’Œç´¢å¼•ä¸­çš„æ‰€æœ‰åˆ—è¿›è¡ŒåŒ¹é…<br>åŒ¹é…æœ€å·¦å‰ç¼€ï¼šåªä½¿ç”¨ç´¢å¼•çš„ç¬¬ä¸€åˆ—<br>åŒ¹é…åˆ—å‰ç¼€ï¼šåªåŒ¹é…åˆ—çš„å€¼å¼€å¤´éƒ¨åˆ†<br>    (ALTER TABLE ADD KEY(column_name, 4); å¯ä»¥å‡å°‘ç´¢å¼•å¤§å°)<br>åŒ¹é…èŒƒå›´å€¼ï¼šç²¾ç¡®åŒ¹é…æŸä¸€åˆ—å¹¶èŒƒå›´åŒ¹é…å¦å¤–ä¸€åˆ—ï¼š<br>åªè®¿é—®ç´¢å¼•çš„æŸ¥è¯¢ï¼š</p><h2 id="3-é€‰æ‹©åˆé€‚çš„ç´¢å¼•åˆ—é¡ºåº"><a href="#3-é€‰æ‹©åˆé€‚çš„ç´¢å¼•åˆ—é¡ºåº" class="headerlink" title="3.é€‰æ‹©åˆé€‚çš„ç´¢å¼•åˆ—é¡ºåº"></a>3.é€‰æ‹©åˆé€‚çš„ç´¢å¼•åˆ—é¡ºåº</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;SELECT COUNT(*), SUM(uid=1), SUM(group_id=111) FROM (table);</span><br><span class="line">******************************************************************</span><br><span class="line">    COUNT(*): 20000</span><br><span class="line">    SUM(uid=1): 50</span><br><span class="line">    SUM(group_id=111): 18000</span><br><span class="line">å‡è®¾è¾“å‡ºæ•°æ®å¦‚ä¸Šï¼Œgroup_idå’Œæ€»æ•°ç›¸è¿‘ï¼Œè¯¥åˆ—æ·»åŠ ç´¢å¼•åˆ™æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;SELECT COUNT(DISTINCT column1) / COUNT(*) AS column1, COUNT(DISTINCT column2) / COUNT(*) AS column2, COUNT(*) FROM (table);</span><br><span class="line">*******************************************************************</span><br><span class="line">    column1ï¼š 0.03</span><br><span class="line">    column2ï¼š0.02</span><br><span class="line">ç´¢å¼•åˆ—æŒ‰ç…§è¾“å‡ºç»“æœå€¼ä»å¤§åˆ°å°æ’åˆ—ã€‚</span><br><span class="line">mysql&gt;ALTER TABLE (table) ADD KEY (column1, column2);</span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€ä½¿ç”¨ç´¢å¼•æ‰«ææ¥åšæ’åº"><a href="#ä¸‰ã€ä½¿ç”¨ç´¢å¼•æ‰«ææ¥åšæ’åº" class="headerlink" title="ä¸‰ã€ä½¿ç”¨ç´¢å¼•æ‰«ææ¥åšæ’åº"></a>ä¸‰ã€ä½¿ç”¨ç´¢å¼•æ‰«ææ¥åšæ’åº</h1><p>å¦‚æœç´¢å¼•ä¸èƒ½è¦†ç›–æŸ¥è¯¢çš„å…¨éƒ¨åˆ—ï¼Œå°±ä¸å¾—ä¸æ‰«æä¸€æ¡ç´¢å¼•å°±å›è¡¨æŸ¥è¯¢ä¸€æ¬¡å¯¹åº”çš„è¡Œã€‚è¿™åŸºæœ¬ä¸Šéƒ½æ˜¯éšæœºçš„IOï¼Œé€šå¸¸æ¯”é¡ºåºå…¨è¡¨æ‰«ææ…¢ï¼Œå°¤å…¶åœ¨IOå¯†é›†å‹å·¥ä½œè´Ÿè½½æ—¶ã€‚</p><h2 id="1-å¿…è¦æ¡ä»¶"><a href="#1-å¿…è¦æ¡ä»¶" class="headerlink" title="1.å¿…è¦æ¡ä»¶"></a>1.å¿…è¦æ¡ä»¶</h2><ol><li>ç´¢å¼•çš„åˆ—å’ŒORDER BY å­å¥çš„é¡ºåºå®Œå…¨ä¸€è‡´ï¼Œå¹¶ä¸”æ‰€æœ‰åˆ—çš„æ’åºæ–¹å‘ä¸€è‡´ï¼Œæ‰èƒ½ä½¿ç”¨ç´¢å¼•æ’åºã€‚</li><li>è”è¡¨æ—¶ï¼Œå¿…é¡»ORDER BYçš„åˆ—ä¸ºä¸€ä¸ªè¡¨çš„åˆ—æ‰è¡Œï¼Œæ—¢ç¬¦åˆç¬¬ä¸€æ¡</li><li>å¿…é¡»ç¬¦åˆæœ€å·¦å‰ç¼€è¦æ±‚(å‰å¯¼åˆ—ä¸ºå¸¸é‡æ—¶é™¤å¤–)</li><li>å‰å¯¼åˆ—(ç´¢å¼•å‰å‡ ä¸ªåˆ—)ä¸ºå¸¸é‡æ—¶(field&#x3D;â€™xxxâ€™æˆ–è€…refä¸ºå¸¸é‡)ï¼ŒWHEREæˆ–è€…JOINçš„è¿™äº›åˆ—æŒ‡å®šäº†å¸¸é‡</li></ol><h2 id="2-ORDER-BY-å‰å¯¼åˆ—å¸¸é‡ç´¢å¼•æ’åº"><a href="#2-ORDER-BY-å‰å¯¼åˆ—å¸¸é‡ç´¢å¼•æ’åº" class="headerlink" title="2.ORDER BY å‰å¯¼åˆ—å¸¸é‡ç´¢å¼•æ’åº"></a>2.ORDER BY å‰å¯¼åˆ—å¸¸é‡ç´¢å¼•æ’åº</h2><p>å‰å¯¼åˆ—ä¸ºå¸¸é‡æ—¶ï¼ŒWHEREæˆ–è€…JOINçš„è¿™äº›åˆ—æŒ‡å®šäº†å¸¸é‡ï¼Œå³ä½¿ORDER BY ä¸ç¬¦åˆæœ€å·¦å‰ç¼€ï¼Œä¹Ÿå¯ä»¥æŒ‰ç…§ç´¢å¼•æ’åºã€‚</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ç´¢å¼•(<span class="type">date</span>, uid, custom_id)</span><br><span class="line">mysql&gt;<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">table</span>) <span class="keyword">WHERE</span> <span class="type">date</span>=<span class="string">&#x27;&#x27;</span> <span class="keyword">AND</span> uid=<span class="string">&#x27;x&#x27;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> custom_id;</span><br></pre></td></tr></table></figure><h2 id="3-ç´¢å¼•æ£€æµ‹"><a href="#3-ç´¢å¼•æ£€æµ‹" class="headerlink" title="3.ç´¢å¼•æ£€æµ‹"></a>3.ç´¢å¼•æ£€æµ‹</h2><p>pt-duplicate-key-checkerï¼šé€šè¿‡åˆ†æè¡¨ç»“æ„æ¥æ‰¾å‡ºå†—ä½™å’Œé‡å¤çš„ç´¢å¼•ã€‚<br>pt-index-usageï¼šè¯»å–æŸ¥è¯¢æ—¥å¿—ï¼Œå¹¶å¯¹æ¯æ¡æŸ¥è¯¢è¿›è¡ŒEXPLAINæ“ä½œï¼Œç„¶åæ‰“å°å‡ºå…³äºç´¢å¼•å’ŒæŸ¥è¯¢çš„æŠ¥å‘Šï¼Œæ‰¾å‡ºæœªä½¿ç”¨çš„ç´¢å¼•å’ŒæœåŠ¡è´¨é‡å·®çš„æŸ¥è¯¢ã€‚</p><h2 id="4-å»¶è¿Ÿå…³è”"><a href="#4-å»¶è¿Ÿå…³è”" class="headerlink" title="4.å»¶è¿Ÿå…³è”"></a>4.å»¶è¿Ÿå…³è”</h2><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;<span class="keyword">SELECT</span> éç´¢å¼•çš„å­—æ®µ <span class="keyword">FROM</span> (<span class="keyword">table</span>) <span class="keyword">INNER</span> <span class="keyword">JOIN</span> (<span class="keyword">SELECT</span> <span class="keyword">primary key</span> <span class="keyword">FROM</span> (<span class="keyword">table</span>)) <span class="keyword">AS</span> A <span class="keyword">USING</span> (<span class="keyword">primary key</span>);</span><br><span class="line">mysql&gt;<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">table</span>) <span class="keyword">INNER</span> <span class="keyword">JOIN</span> (<span class="keyword">SELECT</span> id <span class="keyword">FROM</span> (<span class="keyword">table</span>)) <span class="keyword">AS</span> A <span class="keyword">USING</span> (id);</span><br></pre></td></tr></table></figure><h2 id="5-æ•°æ®ç¢ç‰‡ç±»å‹"><a href="#5-æ•°æ®ç¢ç‰‡ç±»å‹" class="headerlink" title="5. æ•°æ®ç¢ç‰‡ç±»å‹:"></a>5. æ•°æ®ç¢ç‰‡ç±»å‹:</h2><p>è¡Œç¢ç‰‡ï¼š<br>    æ•°æ®è¡Œè¢«å­˜å‚¨ä¸ºå¤šä¸ªåœ°æ–¹çš„å¤šä¸ªç‰‡æ®µä¸­ã€‚å³ä½¿æŸ¥è¯¢åªä»ç´¢å¼•ä¸­è®¿é—®ä¸€è¡Œè®°å½•ï¼Œè¡Œç¢ç‰‡ä¹Ÿä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™</p><p>è¡Œé—´ç¢ç‰‡ï¼š<br>    é€»è¾‘ä¸Šçš„é¡ºåºçš„é¡µæˆ–è€…è¡Œåœ¨ç£ç›˜ä¸Šä¸æ˜¯é¡ºåºå­˜å‚¨çš„ã€‚<br>    è¡Œé—´ç¢ç‰‡å¯¹è¯¸å¦‚å…¨è¡¨æ‰«æå’Œèšç°‡ç´¢å¼•æ‰«æä¹‹ç±»çš„æ“ä½œæœ‰å¾ˆå¤§çš„å½±å“ï¼Œå› ä¸ºè¿™äº›æ“ä½œåŸæœ¬èƒ½å¤Ÿä»ç£ç›˜ä¸Šé¡ºåºå­˜å‚¨çš„æ•°æ®ä¸­è·ç›Šã€‚</p><p>å‰©ä½™ç©ºé—´ç¢ç‰‡ï¼š<br>    æ•°æ®é¡µä¸­æœ‰å¤§é‡çš„ç©ºä½™ç©ºé—´ã€‚è¿™ä¼šå¯¼è‡´æœåŠ¡å™¨è¯»å–å¤§é‡ä¸éœ€è¦çš„æ•°æ®ï¼Œä»è€Œé€ æˆæµªè´¹ã€‚</p><p>å¯¹äºMyISAMè¡¨ï¼Œè¿™ä¸‰ç§ç¢ç‰‡åŒ–éƒ½å¯èƒ½å‘ç”Ÿã€‚InnoDBä¸ä¼šå‡ºç°çŸ­å°çš„è¡Œç¢ç‰‡ï¼ŒInnoDBä¼šåœ¨ç§»åŠ¨çŸ­å°çš„è¡Œå¹¶é‡å†™åˆ°ä¸€ä¸ªç‰‡æ®µä¸­ã€‚<br>å¯ä»¥é€šè¿‡OPTIMIZE TABLEæˆ–è€…é‡æ–°å¯¼å…¥å¯¼å‡ºæ¥é‡æ–°æ•´ç†æ•°æ®ã€‚</p><p>MyISAMå¯ä»¥é€šè¿‡æ’åºç®—æ³•é‡å»ºç´¢å¼•æ¥æ¶ˆé™¤ç¢ç‰‡ã€‚<br>InnoDBå¯ä»¥é€šè¿‡åˆ é™¤ç´¢å¼•ï¼Œé‡æ–°åˆ›å»ºç´¢å¼•æ¶ˆé™¤ç¢ç‰‡ã€‚<br>å¯¹äºä¸æ”¯æŒOPTIMIZE TABLEçš„å­˜å‚¨å¼•æ“ï¼Œå¯ä»¥é€šè¿‡å°†è¡¨çš„å­˜å‚¨å¼•æ“ä¿®æ”¹ä¸ºå½“å‰çš„å¼•æ“å³å¯ã€‚</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;ALERT TABLE (table) ENGINE<span class="operator">=</span>(engine)<span class="comment">;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥é€šè¿‡XtraBackUp â€“statsä»¥éå¤‡ä»½çš„æ–¹å¼è¿è¡Œï¼Œåªæ‰“å°ç´¢å¼•å’Œè¡¨çš„ç»Ÿè®¡æƒ…å†µï¼Œ<br>åŒ…æ‹¬é¡µä¸­çš„æ•°æ®é‡å’Œç©ºä½™ç©ºé—´ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥ç¡®å®šæ•°æ®çš„ç¢ç‰‡åŒ–ç¨‹åº¦ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">xtrabackup --backup --stats --user=root --password=123456 --datadir=/mydata/data --target-dir=/backdir/fullback</span></span><br></pre></td></tr></table></figure><h2 id="5-æ€»ç»“"><a href="#5-æ€»ç»“" class="headerlink" title="5.æ€»ç»“"></a>5.æ€»ç»“</h2><p>é€‰æ‹©ç´¢å¼•å’Œç¼–å†™åˆ©ç”¨è¿™äº›ç´¢å¼•çš„æŸ¥è¯¢æ—¶ï¼Œæœ‰å¦‚ä¸‹ä¸‰ä¸ªåŸåˆ™ï¼š</p><ol><li>å•è¡Œè®¿é—®æ˜¯å¾ˆæ…¢çš„ã€‚å¦‚æœæœåŠ¡å™¨ä»å­˜å‚¨ä¸­è¯»å–ä¸€ä¸ªæ•°æ®å—åªæ˜¯ä¸ºäº†è·å–å…¶ä¸­ä¸€è¡Œï¼Œé‚£ä¹ˆå°±æµªè´¹å¾ˆå¤šå·¥ä½œã€‚<br>æœ€å¥½è¯»å–çš„å—å°½å¯èƒ½å¤šæ‰€éœ€è¦çš„è¡Œã€‚ä½¿ç”¨ç´¢å¼•å¯ä»¥åˆ›å»ºä½ç½®å¼•ç”¨ä»¥æå‡æ•ˆç‡ã€‚</li></ol><p>2.æŒ‰é¡ºåºè®¿é—®èŒƒå›´æ•°æ®æ˜¯å¾ˆå¿«çš„ï¼Œè¿™æœ‰ä¸¤ä¸ªåŸå› ã€‚ç¬¬ä¸€ï¼Œé¡ºåºIOä¸éœ€è¦å¤šæ¬¡ç£ç›˜å¯»é“ï¼Œæ‰€ä»¥æ¯”éšæœºIOå¿«å¾ˆå¤šã€‚<br>ç¬¬äºŒï¼Œå¦‚æœæœåŠ¡å™¨èƒ½å¤ŸæŒ‰ç…§éœ€è¦é¡ºåºè¯»å–æ•°æ®ï¼Œé‚£ä¹ˆä¸éœ€è¦å†é¢å¤–çš„æ’åºæ“ä½œï¼Œå¹¶ä¸”GROUP BYæŸ¥è¯¢ä¹Ÿæ— éœ€å†åšæ’åºå’Œå°†è¡ŒæŒ‰ç»„è¿›è¡Œèšåˆè®¡ç®—äº†ã€‚</p><ol start="3"><li>ç´¢å¼•è¦†ç›–æŸ¥è¯¢æ˜¯å¾ˆå¿«çš„ã€‚å¦‚æœä¸€ä¸ªç´¢å¼•åŒ…å«æ‰€éœ€è¦çš„æ‰€æœ‰åˆ—ï¼Œé‚£ä¹ˆå­˜å‚¨å¼•æ“å°±ä¸éœ€è¦å†å›è¡¨æŸ¥è¯¢æ‰¾è¡Œã€‚è¿™é¿å…äº†å¤§é‡çš„å•è¡Œè®¿é—®ã€‚</li></ol><h1 id="äº”ã€æŸ¥è¯¢ä¼˜åŒ–å¤„ç†"><a href="#äº”ã€æŸ¥è¯¢ä¼˜åŒ–å¤„ç†" class="headerlink" title="äº”ã€æŸ¥è¯¢ä¼˜åŒ–å¤„ç†"></a>äº”ã€æŸ¥è¯¢ä¼˜åŒ–å¤„ç†</h1><h2 id="1-æŸ¥è¯¢ä¼˜åŒ–å™¨"><a href="#1-æŸ¥è¯¢ä¼˜åŒ–å™¨" class="headerlink" title="1.æŸ¥è¯¢ä¼˜åŒ–å™¨"></a>1.æŸ¥è¯¢ä¼˜åŒ–å™¨</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹</span><br><span class="line">msyql<span class="operator">&gt;</span><span class="keyword">select</span> SQL_NO_CACHE <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> <span class="keyword">user</span>;</span><br><span class="line">mysql<span class="operator">&gt;</span><span class="keyword">show</span> status <span class="keyword">like</span> <span class="string">&#x27;Last_query_cost&#x27;</span>;</span><br><span class="line"># <span class="keyword">value</span>è¡¨ç¤ºä¼˜åŒ–å™¨è®¤ä¸ºå¤§æ¦‚éœ€è¦åš<span class="number">41187</span>ä¸ªæ•°æ®é¡µçš„éšæœºæŸ¥æ‰¾æ‰èƒ½å®Œæˆä¸Šé¢çš„æŸ¥è¯¢ã€‚</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------+--------------+</span></span><br><span class="line"><span class="operator">|</span> Variable_name   <span class="operator">|</span> <span class="keyword">Value</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------+--------------+</span></span><br><span class="line"><span class="operator">|</span> Last_query_cost <span class="operator">|</span> <span class="number">41187.199000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------+--------------+</span></span><br></pre></td></tr></table></figure><h2 id="2-æŸ¥è¯¢çŠ¶æ€"><a href="#2-æŸ¥è¯¢çŠ¶æ€" class="headerlink" title="2.æŸ¥è¯¢çŠ¶æ€"></a>2.æŸ¥è¯¢çŠ¶æ€</h2><p>å¯¹äºMySqlçš„è¿æ¥ï¼Œæˆ–è€…è¯´ä¸€ä¸ªçº¿ç¨‹ï¼Œä»»ä½•æ—¶åˆ»éƒ½æœ‰ä¸€ä¸ªçŠ¶æ€ï¼Œè¯¥çŠ¶æ€è¡¨ç¤ºMySqlå½“å‰æ­£åœ¨åšä»€ä¹ˆã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span><span class="keyword">SHOW</span> <span class="keyword">FULL</span> PROCESSLIST;</span><br></pre></td></tr></table></figure><p>sleep<br>çº¿ç¨‹æ­£åœ¨ç­‰å¾…å®¢æˆ·ç«¯å‘é€æ–°çš„è¯·æ±‚</p><p>query<br>çº¿ç¨‹æ­£åœ¨æ‰§è¡ŒæŸ¥è¯¢æˆ–è€…æ­£åœ¨å°†ç»“æœå‘é€ç»™å®¢æˆ·ç«¯</p><p>locked<br>åœ¨MySQLçš„æœåŠ¡å±‚ï¼Œè¯¥çº¿ç¨‹æ­£åœ¨ç­‰å¾…è¡¨é”ã€‚åœ¨å­˜å‚¨å¼•æ“çº§åˆ«å®ç°çš„è¡Œé”ï¼Œä¾‹å¦‚InnoDbçš„è¡Œé”ï¼Œå¹¶ä¸ä¼šä½“ç°åœ¨çº¿ç¨‹çŠ¶æ€ä¸­</p><p>analying and statistics<br>çº¿ç¨‹æ­£åœ¨æ”¶é›†å­˜å‚¨å¼•æ“çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œå¹¶ç”ŸæˆæŸ¥è¯¢çš„æ‰§è¡Œè®¡åˆ’</p><p>copying to tmp table (on disk)<br>çº¿ç¨‹æ­£åœ¨æ‰§è¡ŒæŸ¥è¯¢ï¼Œå¹¶ä¸”å°†ä¸€ä¸ªç»“æœé›†å¤åˆ¶åˆ°ä¸€ä¸ªä¸´æ—¶è¡¨ä¸­ã€‚è¿™ä¸ªçŠ¶æ€è¦ä¹ˆæ‰§è¡ŒGROUP BYï¼Œè¦ä¹ˆæ–‡ä»¶æ’åºæ“ä½œï¼Œæˆ–è€…UNIONæ“ä½œã€‚<br>å¦‚æœè¿™ä¸ªçŠ¶æ€åé¢æœ‰â€on diskâ€ï¼Œè¡¨ç¤ºMySQLæ­£åœ¨å°†ä¸€ä¸ªå†…å­˜ä¸´æ—¶è¡¨æ”¾åˆ°ç£ç›˜ä¸Š</p><p>sorting result<br>çº¿ç¨‹æ­£åœ¨å¯¹ç»“æœé›†è¿›è¡Œæ’åº</p><p>sending data<br>çº¿ç¨‹å¯èƒ½åœ¨å¤šç§çŠ¶æ€ä¹‹é—´ä¼ é€’æ•°æ®ï¼Œæˆ–è€…ç”Ÿæˆç»“æœé›†ï¼Œæˆ–è€…åœ¨å‘å®¢æˆ·ç«¯è¿”å›æ•°æ®</p><h2 id="3-COUNT-ä¼˜åŒ–"><a href="#3-COUNT-ä¼˜åŒ–" class="headerlink" title="3.COUNT(*)ä¼˜åŒ–"></a>3.COUNT(*)ä¼˜åŒ–</h2><p>MyISAMï¼Œä¸å¸¦whereä¸‹çš„COUNT(*)éå¸¸å¿«ï¼Œå¯ä»¥é€šè¿‡å†…ç½®çš„ç‰¹æ€§ç›´æ¥è·å–ã€‚<br>å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ¥é¿å…ä½¿ç”¨WHEREã€‚<br>åŸºäº100wæ•°æ®çš„æƒ…å†µä¸‹ï¼Œæµ‹è¯•å‡ºæ•ˆç‡ç”±é«˜åˆ°ä½å¦‚ä¸‹ï¼š</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;<span class="keyword">select</span> count(<span class="keyword">type</span>=<span class="number">1</span> <span class="keyword">or</span> <span class="keyword">NULL</span>),count(<span class="keyword">type</span>=<span class="number">2</span> <span class="keyword">or</span> <span class="keyword">NULL</span>) <span class="keyword">from</span> city_house.(<span class="keyword">table</span>);</span><br><span class="line">mysql&gt;<span class="keyword">select</span> SUM(<span class="keyword">type</span>=<span class="number">1</span>),SUM(<span class="keyword">type</span>=<span class="number">2</span>) <span class="keyword">from</span> city_house.(<span class="keyword">table</span>);</span><br><span class="line">mysql&gt;<span class="keyword">select</span> count(*) <span class="keyword">from</span> city_house.(<span class="keyword">table</span>) <span class="keyword">where</span> <span class="keyword">type</span> = <span class="number">1</span> <span class="keyword">or</span> <span class="keyword">type</span> =<span class="number">2</span> <span class="keyword">GROUP</span> <span class="keyword">by</span> `<span class="keyword">type</span>`;</span><br></pre></td></tr></table></figure><h2 id="4-LIMITä¼˜åŒ–"><a href="#4-LIMITä¼˜åŒ–" class="headerlink" title="4.LIMITä¼˜åŒ–"></a>4.LIMITä¼˜åŒ–</h2><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">limit</span>ä¼šè·å–<span class="number">100010</span>ï¼Œç„¶åæŠ›å¼ƒ<span class="number">100000</span>æ¡æ•°æ®ã€‚å¯¹äºè·å–éç´¢å¼•çš„å­—æ®µä¼šå¾ˆæ…¢</span><br><span class="line">mysql&gt;<span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">limit</span> <span class="number">100000</span>,<span class="number">10</span>;</span><br><span class="line"># é€šè¿‡å»¶è¿Ÿå…³è”ä¼˜åŒ–</span><br><span class="line">mysql&gt;<span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">join</span> (<span class="keyword">select</span> id <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">limit</span> <span class="number">100000</span>,<span class="number">10</span>) <span class="keyword">using</span> (id);</span><br></pre></td></tr></table></figure><h2 id="5-UNIONä¼˜åŒ–"><a href="#5-UNIONä¼˜åŒ–" class="headerlink" title="5.UNIONä¼˜åŒ–"></a>5.UNIONä¼˜åŒ–</h2><p>MySQLæ€»æ˜¯é€šè¿‡åˆ›å»ºå¹¶å¡«å……ä¸´æ—¶è¡¨çš„æ–¹å¼æ¥æ‰§è¡ŒUNIONæŸ¥è¯¢ã€‚<br>é™¤éç¡®å®éœ€è¦æœåŠ¡å™¨æ¶ˆé™¤é‡å¤çš„è¡Œï¼Œå¦åˆ™ä¸€å®šè¦ä½¿ç”¨UNION ALLã€‚<br>å¦‚æœæ²¡æœ‰ALLå…³é”®è¯ï¼ŒMySQLä¼šç»™ä¸´æ—¶è¡¨åŠ ä¸ŠDISTINCTï¼Œè¿™ä¼šå¯¼è‡´å¯¹æ•´ä¸ªä¸´æ—¶è¡¨çš„æ•°æ®åšå”¯ä¸€æ€§æ£€æŸ¥ï¼Œè¿™æ ·åšä»£ä»·éå¸¸å¤§ã€‚</p><h2 id="ç¼–å†™å·æ‡’çš„UNIONï¼ŒæŠ‘åˆ¶æŸ¥è¯¢"><a href="#ç¼–å†™å·æ‡’çš„UNIONï¼ŒæŠ‘åˆ¶æŸ¥è¯¢" class="headerlink" title="ç¼–å†™å·æ‡’çš„UNIONï¼ŒæŠ‘åˆ¶æŸ¥è¯¢"></a>ç¼–å†™å·æ‡’çš„UNIONï¼ŒæŠ‘åˆ¶æŸ¥è¯¢</h2><p>é€šè¿‡å·æ‡’çš„UNIONXæŠ‘åˆ¶æ•°æ®è¿”å›ã€‚åªæœ‰å½“ç¬¬ä¸€ä¸ªè¡¨æ²¡æœ‰æ•°æ®æ—¶ï¼Œæ‰ä¼šå»ç¬¬äºŒä¸ªè¡¨æŸ¥è¯¢ã€‚<br>ä¸€æ—¦åœ¨ç¬¬ä¸€ä¸ªè¡¨æŸ¥è¯¢å²›æ•°æ®ï¼Œæˆ‘ä»¬å°±å®šä¹‰ä¸€ä¸ª@foundå˜é‡ã€‚æˆ‘ä»¬é€šè¿‡åœ¨ç»“æœä¸­åšä¸€æ¬¡èµ‹å€¼å®ç°ï¼Œç„¶åå°†èµ‹å€¼æ”¾åœ¨è¡Œæ•°greatestä¸­æ¥é¿å…è¿”å›é¢å¤–çš„æ•°æ®ã€‚<br>ä¸ºäº†æ˜ç¡®æ•°æ®æ¥æºäºå“ªå¼ è¡¨ï¼Œæ–°å¢äº†ä¸€ä¸ªè¡¨æ˜çš„åˆ—ã€‚æœ€åæˆ‘ä»¬éœ€è¦åœ¨æŸ¥è¯¢çš„æœ«å°¾å°†å˜é‡é‡ç½®ä¸ºnullï¼Œè¿™æ ·ä¿è¯éå†æ—¶ï¼Œä¸å¹²æ‰°åé¢çš„ç»“æœã€‚</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;<span class="keyword">select</span> <span class="string">&#x27;base&#x27;</span>,greatest(@<span class="built_in">found</span> := <span class="number">-1</span>, uid) <span class="keyword">as</span> maxuid <span class="keyword">user</span> <span class="keyword">where</span> uid =<span class="number">143557</span></span><br><span class="line"><span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line"><span class="keyword">select</span> <span class="string">&#x27;info&#x27;</span>,uid <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> uid = <span class="number">143556</span> <span class="keyword">and</span> @<span class="built_in">found</span> <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">and</span> (@<span class="built_in">found</span>:=<span class="keyword">NUll</span>) <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure><h2 id="åˆ†åŒºè¡¨"><a href="#åˆ†åŒºè¡¨" class="headerlink" title="åˆ†åŒºè¡¨"></a>åˆ†åŒºè¡¨</h2><h3 id="åˆ†åŒºè¡¨åŸç†"><a href="#åˆ†åŒºè¡¨åŸç†" class="headerlink" title="åˆ†åŒºè¡¨åŸç†"></a>åˆ†åŒºè¡¨åŸç†</h3><p>åˆ†åŒºè¡¨ç”±å¤šä¸ªç›¸å…³çš„åº•å±‚è¡¨å®ç°ï¼Œè¿™äº›åº•å±‚ä¹Ÿæ˜¯å¥æŸ„å¯¹è±¡è¡¨ç¤ºï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥è®¿é—®å„ä¸ªåˆ†åŒºã€‚<br>å­˜å‚¨å¼•æ“ç®¡ç†åˆ†åŒºçš„å„ä¸ªåº•å±‚è¡¨å’Œç®¡ç†æ™®é€šè¡¨ä¸€æ ·(æ‰€æœ‰çš„åº•å±‚è¡¨éƒ½è¦ä½¿ç”¨ç›¸åŒçš„å­˜å‚¨å¼•æ“)ï¼Œåˆ†åŒºè¡¨çš„ç´¢å¼•åªæ˜¯åœ¨æ‰€æœ‰çš„åº•å±‚è¡¨ä¸Šå„è‡ªæ·»åŠ äº†ç›¸åŒçš„ç´¢å¼•ã€‚<br>5.7.6ä»¥å‰æ–‡ä»¶ä¸Šå­˜åœ¨å¤šä¸ª#partçš„æ–‡ä»¶</p><p>åˆ†åŒºè¡¨select insert update deleteï¼Œåˆ†åŒºè¡¨éƒ½ä¼šå…ˆæ‰“å¼€å¹¶é”å®šæ‰€æœ‰åº•å±‚è¡¨</p><h3 id="åˆ†åŒºè¡¨ä¼šå‡ºç°é—®é¢˜çš„æƒ…å†µ"><a href="#åˆ†åŒºè¡¨ä¼šå‡ºç°é—®é¢˜çš„æƒ…å†µ" class="headerlink" title="åˆ†åŒºè¡¨ä¼šå‡ºç°é—®é¢˜çš„æƒ…å†µ"></a>åˆ†åŒºè¡¨ä¼šå‡ºç°é—®é¢˜çš„æƒ…å†µ</h3><ol><li><p>NULLå€¼ä¼šå¯¼è‡´åˆ†åŒºè¿‡æ»¤æ— æ•ˆ<br>å½“åˆ†åŒºæ–¹æ³•è¿”å›nullæ—¶ï¼Œä¼šè¢«å­˜æ”¾åˆ°ç¬¬ä¸€ä¸ªåˆ†åŒº</p></li><li><p>åˆ†åŒºè¡¨çš„åˆ—å’Œç´¢å¼•åˆ—ä¸åŒ¹é…<br>å¦‚æœå®šä¹‰çš„ç´¢å¼•å’Œåˆ†åŒºçš„åˆ—ä¸åŒ¹é…ï¼Œä¼šå¯¼è‡´æŸ¥è¯¢æ— æ³•è¿›è¡Œåˆ†åŒºè¿‡æ»¤ã€‚</p></li><li><p>é€‰æ‹©åˆ†åŒºçš„æˆæœ¬å¯èƒ½å¾ˆé«˜<br>ç‰¹åˆ«èŒƒå›´åˆ†åŒºæ—¶ï¼ŒæœåŠ¡å™¨éœ€è¦æ‰«ææ‰€æœ‰çš„åˆ†åŒºæ¥æ‰¾åˆ°æ­£ç¡®çš„ç­”æ¡ˆã€‚ç±»ä¼¼è¿™ç§çº¿æ€§æœç´¢çš„æ•ˆæœä¸é«˜ï¼Œéšç€åˆ†åŒºçš„å¢åŠ ï¼Œæˆæœ¬éšç€å¢åŠ ï¼Œå¯¹äºå¤§å¤šæ•°ç³»ç»Ÿæ¥è¯´100ä¸ªå·¦å³çš„åˆ†åŒºæ²¡æœ‰é—®é¢˜</p></li><li><p>æ‰“å¼€å’Œé”å®šæ‰€æœ‰åº•å±‚è¡¨çš„æˆæœ¬å¯èƒ½å¾ˆé«˜  </p></li><li><p>ç»´æŠ¤åˆ†åŒºçš„æˆæœ¬å¯èƒ½å¾ˆé«˜<br>é‡ç»„åˆ†åŒºæˆ–è€…ALTERè¯­å¥çš„æ“ä½œï¼Œéœ€è¦å…ˆåˆ›å»ºä¸´æ—¶åˆ†åŒºï¼Œå†å¤åˆ¶æ•°æ®åˆ°å…¶ä¸­ï¼Œæœ€ååˆ é™¤åŸåˆ†åŒº</p></li></ol><h3 id="æŸ¥è¯¢ä¼˜åŒ–"><a href="#æŸ¥è¯¢ä¼˜åŒ–" class="headerlink" title="æŸ¥è¯¢ä¼˜åŒ–"></a>æŸ¥è¯¢ä¼˜åŒ–</h3><p>å¯¹äºè®¿é—®åˆ†åŒºè¡¨æ¥è¯´ï¼Œå¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯åœ¨whereæ¡ä»¶ä¸­å¸¦å…¥åˆ†åŒºåˆ—ï¼Œè¿™æ ·å¯ä»¥è¿‡æ»¤æ‰æ— é¡»è®¿é—®çš„åˆ†åŒºã€‚</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹ä¼˜åŒ–å™¨æ˜¯å¦æ‰§è¡Œäº†åˆ†åŒºè¿‡æ»¤</span><br><span class="line">mysql&gt;<span class="keyword">EXPLAIN</span> PARTITIONS <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">USER</span>;</span><br></pre></td></tr></table></figure><h3 id="ç»‘å®šå˜é‡"><a href="#ç»‘å®šå˜é‡" class="headerlink" title="ç»‘å®šå˜é‡"></a>ç»‘å®šå˜é‡</h3><p>å½“åˆ›å»ºä¸€ä¸ªç»‘å®šå˜é‡çš„SQLæ—¶ï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªSQLè¯­å¥çš„åŸå‹ã€‚<br>æœåŠ¡å™¨ç«¯æ”¶åˆ°è¿™ä¸ªSQLè¯­å¥æ¡†æ¶åï¼Œè§£æå¹¶ä¿å­˜è¿™ä¸ªSQLè¯­å¥çš„éƒ¨åˆ†æ‰§è¡Œè®¡åˆ’ï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ä¸€ä¸ªSQLè¯­å¥å¤„ç†å¥æŸ„ã€‚ä»¥åæ¯æ¬¡æ‰§è¡Œè¿™ç±»æŸ¥è¯¢ï¼Œå®¢æˆ·ç«¯éƒ½æ‰§è¡Œè¿™ä¸ªå¥æŸ„ã€‚</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;insert into tbname <span class="variable constant_">VALUES</span> (<span class="string">?,</span> <span class="string">?,</span> <span class="string">?)</span>;</span><br></pre></td></tr></table></figure><p>MySqlä½¿ç”¨ç»‘å®šå˜é‡çš„æ—¶å€™ï¼Œå¯ä»¥æ›´é«˜æ•ˆçš„æ‰§è¡Œå¤§é‡çš„é‡å¤è¯­å¥ï¼š</p><ol><li>åœ¨æœåŠ¡å™¨ç«¯åªè¦è§£æä¸€æ¬¡SQLè¯­å¥</li><li>åœ¨æœåŠ¡å™¨ç«¯æŸäº›ä¼˜åŒ–å™¨çš„å·¥ä½œåªéœ€è¦æ‰§è¡Œä¸€æ¬¡ï¼Œå› ä¸ºå®ƒä¼šç¼“å­˜ä¸€éƒ¨åˆ†çš„æ‰§è¡Œè®¡åˆ’ã€‚ (å¦‚æœéœ€è¦æ ¹æ®ä¼ å…¥å‚æ•°è¿›è¡Œè®¡ç®—æ—¶ï¼Œæ— æ³•ç¼“å­˜è¿™éƒ¨åˆ†è®¡åˆ’)</li><li>ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼åªå‘é€å‚æ•°å’Œå¥æŸ„ï¼Œæ¯”èµ·æ¯æ¬¡éƒ½å‘é€ASCIIç æ–‡æœ¬æ•ˆç‡æ›´é«˜ã€‚<br>ä¸€ä¸ªäºŒè¿›åˆ¶çš„æ—¥æœŸå­—æ®µåªéœ€è¦ä¸‰ä¸ªå­—èŠ‚ï¼Œä½†å¦‚æœæ˜¯ASCIIåˆ™éœ€è¦åä¸ªå­—èŠ‚ã€‚<br>ä¸è¿‡æœ€å¤§çš„èŠ‚çœè¿˜æ˜¯æ¥è‡ªäºBLOBå’ŒTEXTå­—æ®µï¼Œç»‘å®šå˜é‡çš„å½¢å¼å¯ä»¥åˆ†å—ä¼ è¾“ï¼Œè€Œæ— é¡»ä¸€æ¬¡æ€§ä¼ è¾“ã€‚<br>äºŒè¿›åˆ¶åè®®åœ¨å®¢æˆ·ç«¯ä¹Ÿå¯èƒ½èŠ‚çœå¾ˆå¤šå†…å­˜ï¼Œå‡å°‘äº†ç½‘ç»œå¼€é”€ï¼Œå¦å¤–è¿˜èŠ‚çœäº†å°†æ•°æ®ä»å­˜å‚¨åŸå§‹æ ¼å¼è½¬æ¢ä¸ºæ–‡æœ¬æ ¼å¼çš„å¼€é”€ã€‚</li><li>ä»…ä»…æ˜¯å‚æ•°ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæŸ¥è¯¢è¯­å¥éœ€è¦å‘é€åˆ°æœåŠ¡å™¨ç«¯ï¼Œæ‰€ä»¥ç½‘ç»œå¼€é”€ä¼šæ›´å°</li><li>MySQLåœ¨å­˜å‚¨å‚æ•°çš„æ—¶å€™ï¼Œç›´æ¥å°†å…¶å­˜æ”¾åˆ°ç¼“å­˜ä¸­ï¼Œä¸å†éœ€è¦åœ¨å†…å­˜ä¸­å¤šæ¬¡å¤åˆ¶ã€‚</li></ol><p>ç»‘å®šå˜é‡ä¹Ÿæ›´å®‰å…¨ï¼Œæ— é¡»åœ¨åº”ç”¨ç¨‹åºä¸­å¤„ç†è½¬ä¹‰ï¼Œä¸€åˆ™æ›´ç®€å•ï¼ŒäºŒåˆ™ä¹Ÿå¤§å¤§å‡å°‘äº†SQLæ³¨å…¥å’Œæ”»å‡»çš„é£é™©ã€‚</p><h3 id="å…¨æ–‡ç´¢å¼•"><a href="#å…¨æ–‡ç´¢å¼•" class="headerlink" title="å…¨æ–‡ç´¢å¼•"></a>å…¨æ–‡ç´¢å¼•</h3><p>MySqlä¼˜å…ˆä½¿ç”¨å…¨æ–‡ç´¢å¼•ï¼Œç„¶åæ‰ä½¿ç”¨WHERE</p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> mysql </category>
          
          <category> é«˜æ€§èƒ½mysql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>composer ä¿®æ”¹ä»“åº“</title>
      <link href="/posts/ef20ed86.html"/>
      <url>/posts/ef20ed86.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>å®‰è£… laravel å¤±è´¥å¤„ç†</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl error <span class="number">28</span> <span class="keyword">while</span> downloading <span class="keyword">https</span>://repo.packagist.org/p2/psr/<span class="keyword">http</span>-client.json: Operation timed out <span class="keyword">after</span> <span class="number">10000</span> <span class="built_in">milliseconds</span> <span class="keyword">with</span> <span class="number">0</span> out <span class="keyword">of</span> <span class="number">0</span> <span class="keyword">bytes</span> received</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ composer ä»“åº“</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ composer config -<span class="selector-tag">g</span> repo<span class="selector-class">.packagist</span> composer https:<span class="comment">//mirrors.aliyun.com/composer/</span></span><br></pre></td></tr></table></figure><p>è®¾ç½®PATH</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">export</span> <span class="attribute">PATH</span>=<span class="string">&quot;~/.config/composer/vendor/bin:<span class="variable">$PATH</span>&quot;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pt-query-digest æ…¢æ—¥å¿—åˆ†æ</title>
      <link href="/posts/aeba0a25.html"/>
      <url>/posts/aeba0a25.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€å®‰è£…"><a href="#ä¸€ã€å®‰è£…" class="headerlink" title="ä¸€ã€å®‰è£…"></a>ä¸€ã€å®‰è£…</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sudo</span> yum install https://repo.percona.com/yum/percona-release-latest.noarch.rpm</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sudo</span> percona-release <span class="built_in">enable</span> tools release</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sudo</span> yum install percona-toolkit</span></span><br></pre></td></tr></table></figure><h1 id="äºŒã€è¯­æ³•å’Œä½¿ç”¨"><a href="#äºŒã€è¯­æ³•å’Œä½¿ç”¨" class="headerlink" title="äºŒã€è¯­æ³•å’Œä½¿ç”¨"></a>äºŒã€<a href="https://www.percona.com/doc/percona-toolkit/3.0/pt-query-digest.html">è¯­æ³•å’Œä½¿ç”¨</a></h1><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="keyword">pt</span>-query-digest mysql-slow.<span class="built_in">log</span></span><br><span class="line"># æŒ‡å®šæ•°æ®åº“åˆ†æ</span><br><span class="line">$ <span class="keyword">pt</span>-query-digest mysql-slow.<span class="built_in">log</span> --<span class="built_in">type</span>=slowlog --<span class="built_in">filter</span> <span class="string">&#x27;($event-&gt;&#123;db&#125; || &quot;&quot;) =~ m/^mysql/i&#x27;</span></span><br><span class="line"># æ‰§è¡Œç”¨æˆ·åˆ†æ</span><br><span class="line">$ <span class="keyword">pt</span>-query-digest mysql-slow.<span class="built_in">log</span> --<span class="built_in">type</span>=slowlog --<span class="built_in">filter</span> <span class="string">&#x27;($event-&gt;&#123;user&#125; || &quot;&quot;) =~ m/^root/i&#x27;</span> </span><br></pre></td></tr></table></figure><h2 id="1-è¯­æ³•"><a href="#1-è¯­æ³•" class="headerlink" title="1.è¯­æ³•"></a>1.è¯­æ³•</h2><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">pt-query-digest <span class="selector-attr">[OPTIONS]</span> <span class="selector-attr">[FILES]</span> <span class="selector-attr">[DSN]</span></span><br><span class="line"><span class="attr">--create-review-table</span> å½“ä½¿ç”¨<span class="attr">--review</span>å‚æ•°æŠŠåˆ†æç»“æœè¾“å‡ºåˆ°è¡¨ä¸­æ—¶ï¼Œå¦‚æœæ²¡æœ‰è¡¨å°±è‡ªåŠ¨åˆ›å»ºã€‚</span><br><span class="line"><span class="attr">--create-history-table</span> å½“ä½¿ç”¨<span class="attr">--history</span>å‚æ•°æŠŠåˆ†æç»“æœè¾“å‡ºåˆ°è¡¨ä¸­æ—¶ï¼Œå¦‚æœæ²¡æœ‰è¡¨å°±è‡ªåŠ¨åˆ›å»ºã€‚</span><br><span class="line"><span class="attr">--filter</span> å¯¹è¾“å…¥çš„æ…¢æŸ¥è¯¢æŒ‰æŒ‡å®šçš„å­—ç¬¦ä¸²è¿›è¡ŒåŒ¹é…è¿‡æ»¤åå†è¿›è¡Œåˆ†æ</span><br><span class="line"><span class="attr">--limit</span> é™åˆ¶è¾“å‡ºç»“æœç™¾åˆ†æ¯”æˆ–æ•°é‡ï¼Œé»˜è®¤å€¼æ˜¯<span class="number">20</span>,å³å°†æœ€æ…¢çš„<span class="number">20</span>æ¡è¯­å¥è¾“å‡ºï¼Œå¦‚æœæ˜¯<span class="number">50%</span>åˆ™æŒ‰æ€»å“åº”æ—¶é—´å æ¯”ä»å¤§åˆ°å°æ’åºï¼Œè¾“å‡ºåˆ°æ€»å’Œè¾¾åˆ°<span class="number">50%</span>ä½ç½®æˆªæ­¢ã€‚</span><br><span class="line"><span class="attr">--host</span> mysqlæœåŠ¡å™¨åœ°å€</span><br><span class="line"><span class="attr">--user</span> mysqlç”¨æˆ·å</span><br><span class="line"><span class="attr">--password</span> mysqlç”¨æˆ·å¯†ç </span><br><span class="line"><span class="attr">--history</span> å°†åˆ†æç»“æœä¿å­˜åˆ°è¡¨ä¸­ï¼Œåˆ†æç»“æœæ¯”è¾ƒè¯¦ç»†ï¼Œä¸‹æ¬¡å†ä½¿ç”¨<span class="attr">--history</span>æ—¶ï¼Œå¦‚æœå­˜åœ¨ç›¸åŒçš„è¯­å¥ï¼Œä¸”æŸ¥è¯¢æ‰€åœ¨çš„æ—¶é—´åŒºé—´å’Œå†å²è¡¨ä¸­çš„ä¸åŒï¼Œåˆ™ä¼šè®°å½•åˆ°æ•°æ®è¡¨ä¸­ï¼Œå¯ä»¥é€šè¿‡æŸ¥è¯¢åŒä¸€CHECKSUMæ¥æ¯”è¾ƒæŸç±»å‹æŸ¥è¯¢çš„å†å²å˜åŒ–ã€‚</span><br><span class="line"><span class="attr">--review</span> å°†åˆ†æç»“æœä¿å­˜åˆ°è¡¨ä¸­ï¼Œè¿™ä¸ªåˆ†æåªæ˜¯å¯¹æŸ¥è¯¢æ¡ä»¶è¿›è¡Œå‚æ•°åŒ–ï¼Œä¸€ä¸ªç±»å‹çš„æŸ¥è¯¢ä¸€æ¡è®°å½•ï¼Œæ¯”è¾ƒç®€å•ã€‚å½“ä¸‹æ¬¡ä½¿ç”¨<span class="attr">--review</span>æ—¶ï¼Œå¦‚æœå­˜åœ¨ç›¸åŒçš„è¯­å¥åˆ†æï¼Œå°±ä¸ä¼šè®°å½•åˆ°æ•°æ®è¡¨ä¸­ã€‚</span><br><span class="line"><span class="attr">--output</span> åˆ†æç»“æœè¾“å‡ºç±»å‹ï¼Œå€¼å¯ä»¥æ˜¯<span class="built_in">report</span>(æ ‡å‡†åˆ†ææŠ¥å‘Š)ã€<span class="built_in">slowlog</span>(Mysql slow log)ã€jsonã€json-anonï¼Œä¸€èˆ¬ä½¿ç”¨reportï¼Œä»¥ä¾¿äºé˜…è¯»ã€‚</span><br><span class="line"><span class="attr">--since</span> ä»ä»€ä¹ˆæ—¶é—´å¼€å§‹åˆ†æï¼Œå€¼ä¸ºå­—ç¬¦ä¸²ï¼Œå¯ä»¥æ˜¯æŒ‡å®šçš„æŸä¸ªâ€yyyy-mm-<span class="selector-tag">dd</span> <span class="selector-attr">[hh:mm:ss]</span>â€æ ¼å¼çš„æ—¶é—´ç‚¹ï¼Œä¹Ÿå¯ä»¥æ˜¯ç®€å•çš„ä¸€ä¸ªæ—¶é—´å€¼ï¼š<span class="built_in">s</span>(ç§’)ã€<span class="built_in">h</span>(å°æ—¶)ã€<span class="built_in">m</span>(åˆ†é’Ÿ)ã€<span class="built_in">d</span>(å¤©)ï¼Œå¦‚<span class="number">12</span>hå°±è¡¨ç¤ºä»<span class="number">12</span>å°æ—¶å‰å¼€å§‹ç»Ÿè®¡ã€‚</span><br><span class="line"><span class="attr">--until</span> æˆªæ­¢æ—¶é—´ï¼Œé…åˆâ€”sinceå¯ä»¥åˆ†æä¸€æ®µæ—¶é—´å†…çš„æ…¢æŸ¥è¯¢ã€‚</span><br></pre></td></tr></table></figure><h2 id="2-è¾“å‡ºç»“æœè§£æ"><a href="#2-è¾“å‡ºç»“æœè§£æ" class="headerlink" title="2.è¾“å‡ºç»“æœè§£æ"></a>2.è¾“å‡ºç»“æœè§£æ</h2><h3 id="1-æ€»ä½“ç»Ÿè®¡ç»“æœ"><a href="#1-æ€»ä½“ç»Ÿè®¡ç»“æœ" class="headerlink" title="(1) æ€»ä½“ç»Ÿè®¡ç»“æœ"></a>(1) æ€»ä½“ç»Ÿè®¡ç»“æœ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç”¨æˆ·æ—¶é—´ï¼Œç³»ç»Ÿæ—¶é—´ï¼Œç‰©ç†å†…å­˜å ç”¨å¤§å°ï¼Œè™šæ‹Ÿå†…å­˜å ç”¨å¤§å°</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">5.3s user <span class="keyword">time</span>, 530ms system <span class="keyword">time</span>, 28.73M rss, 125.29M vsz</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Current <span class="built_in">date</span>: Thu Jan 20 14:29:24 2022</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Hostname: centos7-v1</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Files: mysql-slow.log</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Overall(æ€»æŸ¥è¯¢æ•°): 13.32k total, 52 unique(å”¯ä¸€æŸ¥è¯¢æ•°), 0.00 QPS(Query Per Second æ¯ç§’è¯·æ±‚æ•°), 0.00x concurrency(å¹¶å‘æ•°) __________</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Time range(æŸ¥è¯¢æ‰§è¡Œçš„æ—¶é—´èŒƒå›´): 2021-07-22 09:18:21 to 2022-01-19 10:36:09</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Attribute          total     min     max     avg     95%  stddev(æ ‡å‡†)  median(ä¸­ç­‰)</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">============     ======= ======= ======= ======= ======= ======= =======</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Exec <span class="keyword">time</span>         39987s      1s   1964s      3s      7s     22s      2s</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Lock <span class="keyword">time</span>             3s       0   124ms   215us   273us     2ms   194us</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Rows sent        340.80M       0 352.77k  26.21k  83.83k  43.04k   9.33k (å‘é€åˆ°å®¢æˆ·ç«¯è¡Œæ•°)</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Rows examine       9.39G       0   6.00M 739.43k   1.39M 479.10k 790.84k (sqlæ‰«æè¡Œæ•°)</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Query size         6.91M       6  28.34k  544.19  719.66  360.75  719.66 (æŸ¥è¯¢å­—èŠ‚æ•°)</span></span><br></pre></td></tr></table></figure><h3 id="2-åˆ†ç»„ç»Ÿè®¡ç»“æœ"><a href="#2-åˆ†ç»„ç»Ÿè®¡ç»“æœ" class="headerlink" title="(2) åˆ†ç»„ç»Ÿè®¡ç»“æœ"></a>(2) åˆ†ç»„ç»Ÿè®¡ç»“æœ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Profile</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ’å æŸ¥è¯¢æŒ‡çº¹ Response <span class="keyword">time</span>ï¼šæ€»çš„å“åº”æ—¶é—´ Callsï¼šæ‰§è¡Œæ¬¡æ•° R/Callï¼šå¹³å‡æ¯æ¬¡æ‰§è¡Œçš„å“åº”æ—¶é—´</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Rank Query ID                            Response <span class="keyword">time</span>    Calls R/Call</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">==== =================================== ================ ===== =======</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   1 0xF7E793AD5965FDE698A73EDDF501A102  25710.4656 64.3%  8518  3.0184  1.49 SELECT</span> </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   2 0x15945C636C00F53419144C6B43DD503F   6883.2103 17.2%  3061  2.2487  1.74 SELECT</span> </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">MISC 0xMISC(å‰©ä½™æŸ¥è¯¢çš„å°æ—¶)                5133.6071 12.8%   104 49.3616   0.0 &lt;40 ITEMS&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-æŸ¥è¯¢SQLæ¦‚å†µ"><a href="#3-æŸ¥è¯¢SQLæ¦‚å†µ" class="headerlink" title="(3) æŸ¥è¯¢SQLæ¦‚å†µ"></a>(3) æŸ¥è¯¢SQLæ¦‚å†µ</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥è¯¢çš„é¡ºåºå·å’Œåˆ†ç»„ç»Ÿè®¡çš„Rankä¸€è‡´ã€‚æ¯ç§’è¯·æ±‚æ•°ã€å¹¶å‘æ•°ã€æŸ¥è¯¢æŒ‡çº¹</span><br><span class="line"># é€šè¿‡tail -c +<span class="number">968618</span> mysql-slow.log æŸ¥çœ‹ç»†èŠ‚</span><br><span class="line"># Query <span class="number">1</span>: <span class="number">0.01</span> QPS, <span class="number">0.02</span>x concurrency, ID <span class="number">0xF7E793AD5965FDE698A73EDDF501A102</span> at byte <span class="number">968618</span></span><br><span class="line"># This item is included <span class="keyword">in</span> the report because it matches --limit.</span><br><span class="line"># V/Mï¼šå“åº”æ—¶é—´Variance-to-meançš„æ¯”ç‡ï¼Œç¦»å·®æŒ‡æ•°ã€‚æŒ‡æ•°é«˜çš„æŸ¥è¯¢å¯¹åº”çš„æ‰§è¡Œæ—¶é—´å˜åŒ–è¾ƒå¤§ï¼Œè¿™ç±»æŸ¥è¯¢æ¯”è¾ƒå€¼å¾—ä¼˜åŒ–ï¼Œé€šå¸¸å¯ä»¥ä½¿ç”¨--explain æ¥æŸ¥çœ‹æŸ¥è¯¢çš„æ‰§è¡Œè®¡åˆ’</span><br><span class="line"># Itemï¼šæŸ¥è¯¢å¯¹è±¡</span><br><span class="line"># Scores: V/M = <span class="number">1.49</span></span><br><span class="line"># Time range: <span class="number">2022</span><span class="number">-01</span><span class="number">-01</span> <span class="number">10</span>:<span class="number">06</span>:<span class="number">14</span> to <span class="number">2022</span><span class="number">-01</span><span class="number">-17</span> <span class="number">08</span>:<span class="number">01</span>:<span class="number">17</span></span><br><span class="line"># Attribute    pct   total     min     max     avg     <span class="number">95</span>%  stddev  median</span><br><span class="line"># ============ === ======= ======= ======= ======= ======= ======= =======</span><br><span class="line"># Count         <span class="number">63</span>    <span class="number">8518</span></span><br><span class="line"># Exec time     <span class="number">64</span>  <span class="number">25710</span>s      <span class="number">1</span>s     <span class="number">25</span>s      <span class="number">3</span>s      <span class="number">8</span>s      <span class="number">2</span>s      <span class="number">3</span>s</span><br><span class="line"># Lock time     <span class="number">66</span>      <span class="number">2</span>s   <span class="number">116</span>us    <span class="number">33</span>ms   <span class="number">224</span>us   <span class="number">273</span>us   <span class="number">400</span>us   <span class="number">204</span>us</span><br><span class="line"># Rows sent     <span class="number">22</span>  <span class="number">77.18</span>M       <span class="number">0</span>   <span class="number">9.77</span>k   <span class="number">9.28</span>k   <span class="number">9.33</span>k   <span class="number">1.90</span>k   <span class="number">9.33</span>k</span><br><span class="line"># Rows examine  <span class="number">90</span>   <span class="number">8.50</span>G <span class="number">120.04</span>k   <span class="number">1.49</span>M   <span class="number">1.02</span>M   <span class="number">1.46</span>M <span class="number">269.00</span>k <span class="number">961.27</span>k</span><br><span class="line"># Query size    <span class="number">85</span>   <span class="number">5.91</span>M     <span class="number">723</span>     <span class="number">728</span>  <span class="number">727.56</span>  <span class="number">719.66</span>       <span class="number">0</span>  <span class="number">719.66</span></span><br><span class="line"># String:</span><br><span class="line"># Databases    spider_scheduler</span><br><span class="line"># Hosts        localhost</span><br><span class="line"># Users        dataUseWeb</span><br><span class="line"># Query_time distribution</span><br><span class="line"># æŸ¥è¯¢æ‰§è¡Œæ—¶é—´åˆ†å¸ƒçš„ç›´æ–¹å›¾ï¼š<span class="number">1</span>å¾®å¦™ã€<span class="number">10</span>å¾®å¦™ã€<span class="number">100</span>å¾®å¦™ã€<span class="number">1</span>æ¯«ç§’ã€<span class="number">10</span>æ¯«ç§’ã€<span class="number">100</span>æ¯«ç§’ï¼Œ<span class="number">1</span>ç§’ï¼Œ<span class="number">10</span>ç§’ä»¥ä¸ŠæŸ¥è¯¢çš„åˆ†å¸ƒæƒ…å†µ</span><br><span class="line">#   <span class="number">1</span>us</span><br><span class="line">#  <span class="number">10</span>us</span><br><span class="line"># <span class="number">100</span>us</span><br><span class="line">#   <span class="number">1</span>ms</span><br><span class="line">#  <span class="number">10</span>ms</span><br><span class="line"># <span class="number">100</span>ms</span><br><span class="line">#    <span class="number">1</span>s  ################################################################</span><br><span class="line">#  <span class="number">10</span>s+  #</span><br><span class="line"># Tables</span><br><span class="line">#    SHOW TABLE STATUS FROM `mysql` LIKE <span class="string">&#x27;user&#x27;</span>\G</span><br><span class="line"># æ‰§è¡Œè®¡åˆ’ä¿¡æ¯</span><br><span class="line"># EXPLAIN <span class="comment">/*!50100 PARTITIONS*/</span></span><br><span class="line"># æ‰§è¡Œçš„è¯­å¥</span><br><span class="line">SELECT * FROM mysql.user;</span><br></pre></td></tr></table></figure><h2 id="ä¸‰ã€å¸¸ç”¨å·¥å…·ä½¿ç”¨"><a href="#ä¸‰ã€å¸¸ç”¨å·¥å…·ä½¿ç”¨" class="headerlink" title="ä¸‰ã€å¸¸ç”¨å·¥å…·ä½¿ç”¨"></a>ä¸‰ã€å¸¸ç”¨å·¥å…·ä½¿ç”¨</h2><h3 id="1-æ‰€æœ‰å·¥å…·"><a href="#1-æ‰€æœ‰å·¥å…·" class="headerlink" title="1.æ‰€æœ‰å·¥å…·"></a>1.æ‰€æœ‰å·¥å…·</h3><table cellspacing="0" cellpadding="2" border="1">   <tbody>    <tr>     <td><p>å·¥å…·ç±»åˆ«</p></td>     <td><p>å·¥å…·å‘½ä»¤</p></td>     <td><p>å·¥å…·ä½œç”¨</p></td>     <td><p>å¤‡æ³¨</p></td>    </tr>    <tr>     <td rowspan="5"><p>å¼€å‘ç±»</p></td>     <td><p><span lang="EN-US">pt-duplicate-key-checker</span></p></td>     <td><p>åˆ—å‡ºå¹¶åˆ é™¤é‡å¤çš„ç´¢å¼•å’Œå¤–é”®</p></td>     <td></td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-online-schema-change</span></p></td>     <td><p>åœ¨çº¿ä¿®æ”¹è¡¨ç»“æ„</p></td>     <td></td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-query-advisor</span></p></td>     <td><p>åˆ†ææŸ¥è¯¢è¯­å¥ï¼Œå¹¶ç»™å‡ºå»ºè®®ï¼Œæœ‰<span lang="EN-US">bug</span></p></td>     <td><p>å·²åºŸå¼ƒ</p></td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-show-grants</span></p></td>     <td><p>è§„èŒƒåŒ–å’Œæ‰“å°æƒé™</p></td>     <td></td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-upgrade</span></p></td>     <td><p>åœ¨å¤šä¸ªæœåŠ¡å™¨ä¸Šæ‰§è¡ŒæŸ¥è¯¢ï¼Œå¹¶æ¯”è¾ƒä¸åŒ</p></td>     <td></td>    </tr>    <tr>     <td rowspan="4"><p>æ€§èƒ½ç±»</p></td>     <td><p><span lang="EN-US">pt-index-usage</span></p></td>     <td><p>åˆ†ææ—¥å¿—ä¸­ç´¢å¼•ä½¿ç”¨æƒ…å†µï¼Œå¹¶å‡ºæŠ¥å‘Š</p></td>     <td></td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-pmp</span></p></td>     <td><p>ä¸ºæŸ¥è¯¢ç»“æœè·Ÿè¸ªï¼Œå¹¶æ±‡æ€»è·Ÿè¸ªç»“æœ</p></td>     <td></td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-visual-explain</span></p></td>     <td><p>æ ¼å¼åŒ–æ‰§è¡Œè®¡åˆ’</p></td>     <td></td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-table-usage</span></p></td>     <td><p>åˆ†ææ—¥å¿—ä¸­æŸ¥è¯¢å¹¶åˆ†æè¡¨ä½¿ç”¨æƒ…å†µ</p></td>     <td><p><span lang="EN-US">pt 2.2æ–°å¢å‘½ä»¤</span></p></td>    </tr>    <tr>     <td rowspan="3"><p>é…ç½®ç±»</p></td>     <td><p><span lang="EN-US">pt-config-diff</span></p></td>     <td><p>æ¯”è¾ƒé…ç½®æ–‡ä»¶å’Œå‚æ•°</p></td>     <td></td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-mysql-summary</span></p></td>     <td><p>å¯¹<span lang="EN-US">mysqlé…ç½®å’Œ<span lang="EN-US">statusè¿›è¡Œæ±‡æ€»</span></span></p></td>     <td></td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-variable-advisor</span></p></td>     <td><p>åˆ†æå‚æ•°ï¼Œå¹¶æå‡ºå»ºè®®</p></td>     <td></td>    </tr>    <tr>     <td rowspan="5"><p>ç›‘æ§ç±»</p></td>     <td><p><span lang="EN-US">pt-deadlock-logger</span></p></td>     <td><p>æå–å’Œè®°å½•<span lang="EN-US">mysqlæ­»é”ä¿¡æ¯</span></p></td>     <td></td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-fk-error-logger</span></p></td>     <td><p>æå–å’Œè®°å½•å¤–é”®ä¿¡æ¯</p></td>     <td></td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-mext</span></p></td>     <td><p>å¹¶è¡ŒæŸ¥çœ‹<span lang="EN-US">statusæ ·æœ¬ä¿¡æ¯</span></p></td>     <td></td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-query-digest</span></p></td>     <td><p>åˆ†ææŸ¥è¯¢æ—¥å¿—ï¼Œå¹¶äº§ç”ŸæŠ¥å‘Š</p></td>     <td><p>å¸¸ç”¨å‘½ä»¤</p></td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-trend</span></p></td>     <td><p>æŒ‰ç…§æ—¶é—´æ®µè¯»å–<span lang="EN-US">slowæ—¥å¿—ä¿¡æ¯</span></p></td>     <td><p>å·²åºŸå¼ƒ</p></td>    </tr>    <tr>     <td rowspan="6"><p>å¤åˆ¶ç±»</p></td>     <td><p><span lang="EN-US">pt-heartbeat</span></p></td>     <td><p>ç›‘æ§<span lang="EN-US">mysqlå¤åˆ¶å»¶è¿Ÿ</span></p></td>     <td></td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-slave-delay</span></p></td>     <td><p>è®¾å®šä»è½åä¸»çš„æ—¶é—´</p></td>     <td></td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-slave-find</span></p></td>     <td><p>æŸ¥æ‰¾å’Œæ‰“å°æ‰€æœ‰<span lang="EN-US">mysqlå¤åˆ¶å±‚çº§å…³ç³»</span></p></td>     <td></td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-slave-restart</span></p></td>     <td><p>ç›‘æ§<span lang="EN-US">salveé”™è¯¯ï¼Œå¹¶å°è¯•é‡å¯<span lang="EN-US">salve</span></span></p></td>     <td></td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-table-checksum</span></p></td>     <td><p>æ ¡éªŒä¸»ä»å¤åˆ¶ä¸€è‡´æ€§</p></td>     <td></td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-table-sync</span></p></td>     <td><p>é«˜æ•ˆåŒæ­¥è¡¨æ•°æ®</p></td>     <td></td>    </tr>    <tr>     <td rowspan="6"><p>ç³»ç»Ÿç±»</p></td>     <td><p><span lang="EN-US">pt-diskstats</span></p></td>     <td><p>æŸ¥çœ‹ç³»ç»Ÿç£ç›˜çŠ¶æ€</p></td>     <td></td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-fifo-split</span></p></td>     <td><p>æ¨¡æ‹Ÿåˆ‡å‰²æ–‡ä»¶å¹¶è¾“å‡º</p></td>     <td></td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-summary</span></p></td>     <td><p>æ”¶é›†å’Œæ˜¾ç¤ºç³»ç»Ÿæ¦‚å†µ</p></td>     <td></td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-stalk</span></p></td>     <td><p>å‡ºç°é—®é¢˜æ—¶ï¼Œæ”¶é›†è¯Šæ–­æ•°æ®</p></td>     <td></td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-sift</span></p></td>     <td><p>æµè§ˆç”±<span lang="EN-US">pt-stalkåˆ›å»ºçš„æ–‡ä»¶</span></p></td>     <td><p><span lang="EN-US">pt 2.2æ–°å¢å‘½ä»¤</span></p></td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-ioprofile</span></p></td>     <td><p>æŸ¥è¯¢è¿›ç¨‹<span lang="EN-US">IOå¹¶æ‰“å°ä¸€ä¸ª<span lang="EN-US">IOæ´»åŠ¨è¡¨</span></span></p></td>     <td><p><span lang="EN-US">pt 2.2æ–°å¢å‘½ä»¤</span></p></td>    </tr>    <tr>     <td rowspan="5"><p>å®ç”¨ç±»</p></td>     <td><p><span lang="EN-US">pt-archiver</span></p></td>     <td><p>å°†è¡¨æ•°æ®å½’æ¡£åˆ°å¦ä¸€ä¸ªè¡¨æˆ–æ–‡ä»¶ä¸­</p></td>     <td></td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-find</span></p></td>     <td><p>æŸ¥æ‰¾è¡¨å¹¶æ‰§è¡Œå‘½ä»¤</p></td>     <td></td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-kill</span></p></td>     <td><p><span lang="EN-US">Killæ‰ç¬¦åˆæ¡ä»¶çš„<span lang="EN-US">sql</span></span></p></td>     <td>å¸¸ç”¨å‘½ä»¤</td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-align</span></p></td>     <td><p>å¯¹é½å…¶ä»–å·¥å…·çš„è¾“å‡º</p></td>     <td><p><span lang="EN-US">pt 2.2æ–°å¢å‘½ä»¤</span></p></td>    </tr>    <tr>     <td><p><span lang="EN-US">pt-fingerprint</span></p></td>     <td><p>å°†æŸ¥è¯¢è½¬æˆå¯†æ–‡</p></td>     <td><p><span lang="EN-US">pt 2.2æ–°å¢å‘½ä»¤</span></p></td>    </tr>   </tbody>  </table><h3 id="2-pt-duplicate-key-checker"><a href="#2-pt-duplicate-key-checker" class="headerlink" title="2.pt-duplicate-key-checker"></a>2.pt-duplicate-key-checker</h3><p>è¯¥å·¥å…·é€šè¿‡åˆ†æè¡¨ç»“æ„æ¥æ‰¾å‡ºå†—ä½™å’Œé‡å¤çš„ç´¢å¼•ã€‚</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$ pt-duplicate-key-checker --host=<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> --port=<span class="number">3306</span> --user=root --password=pwd --database=test --table=table_name</span><br><span class="line"></span><br><span class="line"># ########################################################################</span><br><span class="line"># test.user</span><br><span class="line"># ########################################################################</span><br><span class="line"></span><br><span class="line"># htype_cat_id is a duplicate <span class="keyword">of</span> cat_id_htype</span><br><span class="line"># Key definitions:</span><br><span class="line">#   KEY `htype_cat_id` (`cat_id`,`htype`) USING BTREE,</span><br><span class="line">#   KEY `cat_id_htype` (`cat_id`,`htype`),</span><br><span class="line"># Column types:</span><br><span class="line">#         `cat_id` int(<span class="number">10</span>) default null comment <span class="string">&#x27;??id,?htype???sell?hid,??chuzu?hid&#x27;</span></span><br><span class="line">#         `htype` tinyint(<span class="number">3</span>) not null comment <span class="string">&#x27;???????? 2:sell  3:chuzu\r\n4:news\r\n5:loupan&#x27;</span></span><br><span class="line"># To remove this duplicate index, execute:</span><br><span class="line">ALTER TABLE `test`.`user` DROP INDEX `htype_cat_id`;</span><br><span class="line"></span><br><span class="line"># ########################################################################</span><br><span class="line"># Summary <span class="keyword">of</span> indexes</span><br><span class="line"># ########################################################################</span><br><span class="line"></span><br><span class="line"># Size Duplicate Indexes   <span class="number">36845855</span></span><br><span class="line"># Total Duplicate Indexes  <span class="number">10</span></span><br><span class="line"># Total Indexes            <span class="number">286</span></span><br></pre></td></tr></table></figure><h3 id="3-pt-index-usage"><a href="#3-pt-index-usage" class="headerlink" title="3.pt-index-usage"></a>3.pt-index-usage</h3><p>è¯»å–æŸ¥è¯¢æ—¥å¿—ï¼Œå¹¶å¯¹æ¯æ¡æŸ¥è¯¢è¿›è¡ŒEXPLAINæ“ä½œï¼Œç„¶åæ‰“å°å‡ºå…³äºç´¢å¼•å’ŒæŸ¥è¯¢çš„æŠ¥å‘Šï¼Œæ‰¾å‡ºæœªä½¿ç”¨çš„ç´¢å¼•å’ŒæœåŠ¡è´¨é‡å·®çš„æŸ¥è¯¢ã€‚</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ pt-index-usage mysql-slow.log --host <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> --user=root --password=pwd</span><br><span class="line"></span><br><span class="line">#################################################################</span><br><span class="line"># A software update is available:</span><br><span class="line"></span><br><span class="line">ALTER TABLE `test`.`user` DROP KEY `source`; -- type:non-unique</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> mysql </category>
          
          <category> æ…¢æ—¥å¿—åˆ†æ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å•æ¡æŸ¥è¯¢åˆ†æ</title>
      <link href="/posts/2d04e539.html"/>
      <url>/posts/2d04e539.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€SHOW-PROFILE"><a href="#ä¸€ã€SHOW-PROFILE" class="headerlink" title="ä¸€ã€SHOW PROFILE"></a>ä¸€ã€SHOW PROFILE</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;set profiling = 1;</span><br><span class="line"># æŸ¥çœ‹æ‰€æœ‰</span><br><span class="line">mysql&gt; show profiles;</span><br><span class="line">+----------+------------+----------------------------------------------+</span><br><span class="line">| Query_ID | Duration   | Query                                        |</span><br><span class="line">+----------+------------+----------------------------------------------+</span><br><span class="line">|        1 | 0.00060575 | select * from city_base.members_base limit 1 |</span><br><span class="line">+----------+------------+----------------------------------------------+</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹æŒ‡å®šQUERY_ID,æ¯ä¸ªæ­¥éª¤çš„è€—æ—¶</span><br><span class="line">mysql&gt; show profile for query 1;</span><br><span class="line">+----------------------+----------+</span><br><span class="line">| Status               | Duration |</span><br><span class="line">+----------------------+----------+</span><br><span class="line">| starting             | 0.000068 |</span><br><span class="line">| checking permissions | 0.000013 |</span><br><span class="line">| Opening tables       | 0.000047 |</span><br><span class="line">| init                 | 0.000086 |</span><br><span class="line">| System lock          | 0.000022 |</span><br><span class="line">| optimizing           | 0.000014 |</span><br><span class="line">| statistics           | 0.000030 |</span><br><span class="line">| preparing            | 0.000025 |</span><br><span class="line">| executing            | 0.000010 |</span><br><span class="line">| Sending data         | 0.000192 |</span><br><span class="line">| end                  | 0.000013 |</span><br><span class="line">| query end            | 0.000017 |</span><br><span class="line">| closing tables       | 0.000020 |</span><br><span class="line">| freeing items        | 0.000027 |</span><br><span class="line">| cleaning up          | 0.000023 |</span><br><span class="line">+----------------------+----------+</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥è¯¢çº¿ç¨‹è¿è¡ŒçŠ¶æ€</span><br><span class="line">$ mysql -uroot -p -e &quot;show processlist\G&quot;|grep State|sort |uniq -c |sort -rn</span><br></pre></td></tr></table></figure><h1 id="SHOW-STATUS"><a href="#SHOW-STATUS" class="headerlink" title="SHOW STATUS"></a>SHOW STATUS</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;FLUSH STATUS;</span><br><span class="line">mysql&gt;select * from mysql.user;</span><br><span class="line"># æŸ¥çœ‹ç›¸å…³è®¡æ•°çš„å˜åŒ– </span><br><span class="line">mysql&gt;SHOW STATUS WHERE Variable_name LIKE &#x27;Handler%&#x27; OR Variable_name like &#x27;Created%&#x27;;</span><br><span class="line">+----------------------------+-------+</span><br><span class="line">| Variable_name              | Value |</span><br><span class="line">+----------------------------+-------+</span><br><span class="line">| Created_tmp_disk_tables    | 0     |</span><br><span class="line">| Created_tmp_files          | 24    |</span><br><span class="line">| Created_tmp_tables         | 5     |</span><br><span class="line">| Handler_commit             | 1     |</span><br><span class="line">| Handler_delete             | 0     |</span><br><span class="line">| Handler_discover           | 0     |</span><br><span class="line">| Handler_external_lock      | 2     |</span><br><span class="line">| Handler_mrr_init           | 0     |</span><br><span class="line">| Handler_prepare            | 0     |</span><br><span class="line">| Handler_read_first         | 1     |</span><br><span class="line">| Handler_read_key           | 1     |</span><br><span class="line">| Handler_read_last          | 0     |</span><br><span class="line">| Handler_read_next          | 0     |</span><br><span class="line">| Handler_read_prev          | 0     |</span><br><span class="line">| Handler_read_rnd           | 0     |</span><br><span class="line">| Handler_read_rnd_next      | 167   |</span><br><span class="line">| Handler_rollback           | 0     |</span><br><span class="line">| Handler_savepoint          | 0     |</span><br><span class="line">| Handler_savepoint_rollback | 0     |</span><br><span class="line">| Handler_update             | 0     |</span><br><span class="line">| Handler_write              | 161   |</span><br><span class="line">+----------------------------+-------+</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># æ¯ç§’ç›‘æ§æŸ¥è¯¢æ•°ã€çº¿ç¨‹è¿æ¥æ•°ã€æ­£åœ¨æ‰§è¡ŒæŸ¥è¯¢çš„çº¿ç¨‹è¿è¡Œæ•°</span><br><span class="line"># å¦‚æœè¿æ¥æ•°æ²¡å˜åŒ–ï¼Œè¿è¡Œæ•°æ˜æ˜¾ä¸Šå‡ï¼Œåˆ™è¯´æ˜æ–°çš„æŸ¥è¯¢éœ€è¦æ—§çš„æŸ¥è¯¢æ­£åœ¨ç­‰å¾…çš„é”ï¼Œé€ æˆçš„å †ç§¯ã€‚</span><br><span class="line"># å¦å¤–ä¸€ç§å¦‚æœå‡ºç°å¤§é‡çš„æŸ¥è¯¢è¯·æ±‚ï¼Œåˆ™è¯´æ˜å¯ä»¥ç¼“å­˜çªç„¶å¤±æ•ˆã€‚ä¾‹å¦‚redisè¿‡æœŸäº†ã€‚</span><br><span class="line">$ mysqladmin -uroot -p ext -i1|awk &#x27;/Queries/&#123;q=$4-qp;qp=$4&#125;/Threads_connected/&#123;tc=$4&#125;/Threads_running/&#123;printf &quot;%5d %5d %5d\n&quot;,q,tc,$4&#125;&#x27;</span><br></pre></td></tr></table></figure><h1 id="ç»Ÿè®¡æ¯ç§’æŸ¥è¯¢æ•°é‡"><a href="#ç»Ÿè®¡æ¯ç§’æŸ¥è¯¢æ•°é‡" class="headerlink" title="ç»Ÿè®¡æ¯ç§’æŸ¥è¯¢æ•°é‡"></a>ç»Ÿè®¡æ¯ç§’æŸ¥è¯¢æ•°é‡</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ awk &#x27;/^# Time:/&#123;print $3,$4,c;c=0&#125;/^# User/&#123;c++&#125;&#x27; mysql-slow.log |head -n 10</span><br></pre></td></tr></table></figure><h1 id="é€šè¿‡tcpdumpç›‘æ§mysqlç«¯å£"><a href="#é€šè¿‡tcpdumpç›‘æ§mysqlç«¯å£" class="headerlink" title="é€šè¿‡tcpdumpç›‘æ§mysqlç«¯å£"></a>é€šè¿‡tcpdumpç›‘æ§mysqlç«¯å£</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ tcpdump -S -nn -tttt port 3306 and host 192.168.1.213</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> mysql </category>
          
          <category> æ…¢æ—¥å¿—åˆ†æ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jså’ŒAPP webviewsäº¤äº’</title>
      <link href="/posts/47cab41d.html"/>
      <url>/posts/47cab41d.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="jså’ŒAPP-weiviewsäº¤äº’"><a href="#jså’ŒAPP-weiviewsäº¤äº’" class="headerlink" title="jså’ŒAPP weiviewsäº¤äº’"></a>jså’ŒAPP weiviewsäº¤äº’</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">shareFunction</span>(<span class="params">data</span>)&#123;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­æ˜¯å¦æ‰‹æœºç«¯ éªŒè¯ç å¼¹çª—æ ·å¼åŒºåˆ†</span></span><br><span class="line">    <span class="keyword">var</span> ua = navigator.<span class="property">userAgent</span>;</span><br><span class="line">    <span class="keyword">var</span> isAndroid = ua.<span class="title function_">indexOf</span>(<span class="string">&#x27;Android&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> isIos = ua.<span class="title function_">indexOf</span>(<span class="string">&#x27;iOS&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> callbackRes;</span><br><span class="line">    <span class="keyword">if</span> (isAndroid) &#123;</span><br><span class="line">        <span class="comment">// å®‰å“,æ¥æ”¶è¿”å›æ•°æ®</span></span><br><span class="line">        callbackRes = <span class="variable language_">window</span>.<span class="property">android</span>.<span class="title function_">shareFunction</span>(share);<span class="comment">//android</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (isIos) &#123;</span><br><span class="line">        <span class="comment">// IOS,æ¥æ”¶è¿”å›æ•°æ®</span></span><br><span class="line">        callbackRes = data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> callbackRes;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h1 id="jsæ— æ³•è·å–IOSè¿”å›jsonä¿¡æ¯"><a href="#jsæ— æ³•è·å–IOSè¿”å›jsonä¿¡æ¯" class="headerlink" title="jsæ— æ³•è·å–IOSè¿”å›jsonä¿¡æ¯"></a>jsæ— æ³•è·å–IOSè¿”å›jsonä¿¡æ¯</h1><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iOSéœ€è¦é’ˆå¯¹jsonå­—ç¬¦ä¸²æ›¿æ¢ç©ºæ ¼å’Œ<span class="string">\n</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
          <category> js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ—¥å¿—æ–‡ä»¶</title>
      <link href="/posts/5335b023.html"/>
      <url>/posts/5335b023.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os.path</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> house.settings <span class="keyword">as</span> setting</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UtilLog</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        now = datetime.datetime.now()</span><br><span class="line">        rq = now.strftime(<span class="string">&#x27;%Y%m%d&#x27;</span>)</span><br><span class="line">        <span class="variable language_">self</span>.logFile = setting.ROOT_PATH + <span class="string">&#x27;/logs/%s/%s&#x27;</span> + rq + <span class="string">&#x27;.log&#x27;</span></span><br><span class="line">        <span class="comment"># è·å–æ‰§è¡Œè°ƒç”¨çš„æ–‡ä»¶å’Œè¡Œå·ï¼Œä¾‹å¦‚main.py 30è¡Œè°ƒç”¨ï¼ŒfileNameä¸ºmain.py è¡Œå·ä¸º30</span></span><br><span class="line">        fileName = os.path.basename(sys._getframe(<span class="number">2</span>).f_code.co_filename)</span><br><span class="line">        lineNo = sys._getframe(<span class="number">2</span>).f_lineno</span><br><span class="line">        <span class="variable language_">self</span>.formatter = <span class="string">&quot;%(asctime)s - %(filename)s[line:%(lineno)d] - UtilLog %(levelname)s: %(message)s \n&quot;</span></span><br><span class="line">        <span class="variable language_">self</span>.formatterDict = &#123;</span><br><span class="line">            <span class="string">&#x27;asctime&#x27;</span>: now.strftime(<span class="string">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span>),</span><br><span class="line">            <span class="string">&#x27;filename&#x27;</span>: fileName,</span><br><span class="line">            <span class="string">&#x27;lineno&#x27;</span>: lineNo,</span><br><span class="line">            <span class="string">&#x27;levelname&#x27;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;message&#x27;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">infoLog</span>(<span class="params">self, content, fileName=<span class="string">&#x27;info&#x27;</span></span>):</span><br><span class="line">        levelName = <span class="string">&#x27;info&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.writeLog(levelName=levelName, fileName=fileName, content=content)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">warningLog</span>(<span class="params">self, content, fileName=<span class="string">&#x27;&#x27;</span></span>):</span><br><span class="line">        levelName = <span class="string">&#x27;warning&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.writeLog(levelName=levelName, fileName=fileName, content=content)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">debugLog</span>(<span class="params">self, content, fileName=<span class="string">&#x27;&#x27;</span></span>):</span><br><span class="line">        levelName = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.writeLog(levelName=levelName, fileName=fileName, content=content)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">errorLog</span>(<span class="params">self, content, fileName=<span class="string">&#x27;&#x27;</span></span>):</span><br><span class="line">        levelName = <span class="string">&#x27;error&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.writeLog(levelName=levelName, fileName=fileName, content=content)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">writeLog</span>(<span class="params">self, levelName, fileName, content</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        å†™å…¥logåˆ°æ–‡ä»¶</span></span><br><span class="line"><span class="string">        @param levelName: æ—¥å¿—ç­‰çº§åç§°</span></span><br><span class="line"><span class="string">        @param fileName: æ–‡ä»¶å</span></span><br><span class="line"><span class="string">        @param content: å†™å…¥å†…å®¹</span></span><br><span class="line"><span class="string">        @return: </span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        logFile = <span class="variable language_">self</span>.logFile % (levelName, fileName)</span><br><span class="line">        <span class="variable language_">self</span>.formatterDict[<span class="string">&#x27;levelname&#x27;</span>] = levelName</span><br><span class="line">        <span class="variable language_">self</span>.formatterDict[<span class="string">&#x27;message&#x27;</span>] = content</span><br><span class="line"></span><br><span class="line">        logPath = os.path.dirname(logFile)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(logPath):</span><br><span class="line">            os.mkdir(logPath, <span class="number">777</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(logFile, <span class="string">&quot;a+&quot;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                res = f.write(<span class="variable language_">self</span>.formatter % <span class="variable language_">self</span>.formatterDict)</span><br><span class="line">            <span class="keyword">if</span> res:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>éº¦ç”°APPåŠ å¯†ç®—æ³•</title>
      <link href="/posts/96f42c67.html"/>
      <url>/posts/96f42c67.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment">#è·å–Digestçš„responseçš„å€¼,keyè½¬åŒ–ä¸ºæœ€å°å­—æ¯ï¼Œç„¶åè‡ªç„¶æ’åºï¼Œæœ€åk=v+k=væ‹¼æ¥åŠ å¯†</span></span><br><span class="line"><span class="comment"># datasï¼šå­—å…¸ï¼Œk/væ•°æ®</span></span><br><span class="line"><span class="comment"># _thistimeï¼šå½“å‰æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment"># ç¤ºä¾‹ï¼šcommon.urlDigestRes(self.postData, _time)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">urlDigestRes</span>(<span class="params">datas,_thistime,key=<span class="string">&#x27;8ba449f29acf&#x27;</span></span>):</span><br><span class="line">    <span class="comment"># print(datas)</span></span><br><span class="line">    _data = &#123;&#125;</span><br><span class="line">    _getUrlParam = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> datas.items():</span><br><span class="line">        _data[k.lower()] = v</span><br><span class="line">        _getUrlParam = _getUrlParam + <span class="built_in">str</span>(k) + <span class="string">&quot;=&quot;</span> + <span class="built_in">str</span>(v) + <span class="string">&quot;&amp;&quot;</span></span><br><span class="line">        <span class="comment"># print(k.lower() + &#x27;=&#x27; + str(v))</span></span><br><span class="line">        <span class="comment"># _postData[k]=v</span></span><br><span class="line">    <span class="comment"># print((_data.keys()), _data.values())</span></span><br><span class="line">    e = <span class="built_in">sorted</span>(_data.items(), key=<span class="keyword">lambda</span> d: d[<span class="number">0</span>], reverse=<span class="literal">False</span>)</span><br><span class="line">    <span class="comment"># print(e)</span></span><br><span class="line">    _signStr = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> e:</span><br><span class="line">        _signStr = _signStr + <span class="built_in">str</span>(k) + <span class="string">&quot;=&quot;</span> + <span class="built_in">str</span>(v)</span><br><span class="line">    _signStr = _signStr + key + <span class="built_in">str</span>(_thistime)</span><br><span class="line">    _myMd5 = myMD5(_signStr)</span><br><span class="line">    _getUrlParam = _getUrlParam[<span class="number">0</span>:<span class="built_in">len</span>(_getUrlParam)-<span class="number">1</span>]</span><br><span class="line">    <span class="comment"># print(&quot;responseStr:&quot;+_signStr)</span></span><br><span class="line">    <span class="comment"># print(&quot;_getUrlParam:&quot;+_getUrlParam)</span></span><br><span class="line">    <span class="keyword">return</span> _myMd5,_getUrlParam</span><br><span class="line"></span><br><span class="line">headers = &#123;<span class="string">&quot;User-agent&quot;</span>:<span class="string">&quot;okhttp/3.8.0&quot;</span>,<span class="string">&quot;Content-Type&quot;</span>:<span class="string">&quot;application/json&quot;</span>,<span class="string">&quot;Accept&quot;</span>:<span class="string">&quot;*/*&quot;</span>,<span class="string">&quot;token&quot;</span>:<span class="string">&quot;0befe3865bde6ba7bf0a83e90fb2ae12&quot;</span>,<span class="string">&quot;Authorization&quot;</span>:<span class="string">&quot;Digest username=aos384e9f87,cnonce=%s,response=%s&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">digest = common.urlDigestRes(urlQueryDist, _time)</span><br><span class="line">headers[<span class="string">&#x27;Authorization&#x27;</span>] = headers[<span class="string">&#x27;Authorization&#x27;</span>] % ( <span class="built_in">str</span>(<span class="built_in">round</span>(time.time()*<span class="number">1000</span>)), digest[<span class="number">0</span>] )</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gblic</title>
      <link href="/posts/5d56b180.html"/>
      <url>/posts/5d56b180.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€æŸ¥çœ‹å½“å‰ç‰ˆæœ¬"><a href="#ä¸€ã€æŸ¥çœ‹å½“å‰ç‰ˆæœ¬" class="headerlink" title="ä¸€ã€æŸ¥çœ‹å½“å‰ç‰ˆæœ¬"></a>ä¸€ã€æŸ¥çœ‹å½“å‰ç‰ˆæœ¬</h1><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ldd <span class="comment">--version</span></span><br></pre></td></tr></table></figure><h1 id="äºŒã€ä¸‹è½½"><a href="#äºŒã€ä¸‹è½½" class="headerlink" title="äºŒã€ä¸‹è½½"></a>äºŒã€ä¸‹è½½</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">wget http://ftp.gnu.org/gnu/glibc/glibc-2.14.tar.gz</span></span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€ç¼–è¯‘å®‰è£…"><a href="#ä¸‰ã€ç¼–è¯‘å®‰è£…" class="headerlink" title="ä¸‰ã€ç¼–è¯‘å®‰è£…"></a>ä¸‰ã€ç¼–è¯‘å®‰è£…</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tar -zxvf glibc-2.14.tar.gz</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cd</span> glibc-2.14 &amp;&amp; <span class="built_in">mkdir</span> build &amp;&amp; <span class="built_in">cd</span> build</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">../configure --prefix=/usr/local/glibc-2.14</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">make -j4</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">make install</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¿®æ”¹è½¯é“¾æ¥</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ln</span> -s /usr/local/glibc-2.14/lib/libc-2.14.so /lib64/libc.so.6</span></span><br></pre></td></tr></table></figure><h1 id="å››ã€æ³¨æ„äº‹é¡¹"><a href="#å››ã€æ³¨æ„äº‹é¡¹" class="headerlink" title="å››ã€æ³¨æ„äº‹é¡¹"></a>å››ã€æ³¨æ„äº‹é¡¹</h1><h2 id="1-å‡çº§åå¯¼è‡´ä¸­æ–‡ä¹±ç "><a href="#1-å‡çº§åå¯¼è‡´ä¸­æ–‡ä¹±ç " class="headerlink" title="1.å‡çº§åå¯¼è‡´ä¸­æ–‡ä¹±ç "></a>1.å‡çº§åå¯¼è‡´ä¸­æ–‡ä¹±ç </h2><p>å‡çº§å®ŒæˆåæŸ¥çœ‹å¸¦ä¸­æ–‡æ–‡ä»¶çš„ç›®å½• ls ä¼šå‘ç°ä¸­æ–‡å­—å…¨éƒ¨å˜æˆ ???<br>æ‰§è¡Œ localeå‘½ä»¤:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">locale: Cannot <span class="built_in">set</span> LC_CTYPE <span class="keyword">to</span><span class="built_in"> default </span>locale: <span class="literal">No</span> such file <span class="keyword">or</span> directory</span><br><span class="line">locale: Cannot <span class="built_in">set</span> LC_MESSAGES <span class="keyword">to</span><span class="built_in"> default </span>locale: <span class="literal">No</span> such file <span class="keyword">or</span> directory</span><br><span class="line">locale: Cannot <span class="built_in">set</span> LC_COLLATE <span class="keyword">to</span><span class="built_in"> default </span>locale: <span class="literal">No</span> such file <span class="keyword">or</span> directory</span><br></pre></td></tr></table></figure><p>åœ¨glibcç¼–è¯‘ç›®å½•ä¸‹çš„buildç›®å½•ï¼Œæ‰§è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">make localedata/install-locales</span></span><br></pre></td></tr></table></figure><p>å†æ¬¡æ‰§è¡Œlocaleå°±æ¢å¤æ­£å¸¸äº†  </p><p>å¦‚æœå·²ç»åˆ é™¤ç¼–è¯‘ç›®å½•ï¼Œåˆ™å‚è€ƒ<a href="https://www.cnblogs.com/jasondayee/p/13403245.html">CentOS å‡çº§libcåå¯¼è‡´ä¸­æ–‡ä¹±ç </a><br>(æœªæµ‹è¯•æ•ˆ)<br>ä½†æ˜¯å¦‚æœä½ å·²ç»åˆ é™¤äº†ç¼–è¯‘glibcçš„buildç›®å½•æˆ–è€…ä¸çŸ¥é“buildçš„ç›®å½•åœ¨å“ªé‡Œ<br>æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤:<br>æŸ¥çœ‹ libc.so.6 è½¯è¿æ¥æŒ‡å‘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ls -la /lib64/libc.so.6</span><br><span class="line">/lib64/libc.so.6 -&gt; libc-2.14.so</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ locale-archive å½’æ¡£æ–‡ä»¶ç›®å½•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">strings libc-2.14.so | grep locale-archive</span><br><span class="line">/usr/local/glibc-2.14/lib/locale/locale-archive</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç›®å½•æ˜¯åœ¨å‡çº§libcçš„æ—¶å€™buildçš„ç›®å½•<br>æ·»åŠ è½¯é“¾æ¥</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -la /usr/local/glibc-2.14/lib/locale/locale-archive</span><br></pre></td></tr></table></figure><p>å‘ç°æ–‡ä»¶å¹¶ä¸å­˜åœ¨<br>é‚£ä¹ˆ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -s /usr/lib/locale/locale-archive /usr/local/glibc-2.14/lib/locale/locale-archive</span><br></pre></td></tr></table></figure><p>é‡æ–°æ‰§è¡Œ locale å·²ç»æ­£å¸¸äº† ï¼</p><h2 id="2-å‡çº§åå¯¼è‡´æ—¶åŒºé”™è¯¯"><a href="#2-å‡çº§åå¯¼è‡´æ—¶åŒºé”™è¯¯" class="headerlink" title="2.å‡çº§åå¯¼è‡´æ—¶åŒºé”™è¯¯"></a>2.å‡çº§åå¯¼è‡´æ—¶åŒºé”™è¯¯</h2><h3 id="2-1-ç³»ç»Ÿæ—¶åŒºä¿®æ”¹"><a href="#2-1-ç³»ç»Ÿæ—¶åŒºä¿®æ”¹" class="headerlink" title="2.1 ç³»ç»Ÿæ—¶åŒºä¿®æ”¹"></a>2.1 ç³»ç»Ÿæ—¶åŒºä¿®æ”¹</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ln</span> -s /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span></span><br></pre></td></tr></table></figure><p>å¦‚æœè¿˜ä¸è¡Œï¼Œåˆ™åœ¨&#x2F;etc&#x2F;profileæˆ–è€…~&#x2F;.bashrcæ·»åŠ </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> <span class="attribute">TZ</span>=<span class="string">&#x27;Asia/Shanghai&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="2-2-crontabä»¥åŠcrontabçš„è„šæœ¬æ—¶åŒºé”™è¯¯"><a href="#2-2-crontabä»¥åŠcrontabçš„è„šæœ¬æ—¶åŒºé”™è¯¯" class="headerlink" title="2.2 crontabä»¥åŠcrontabçš„è„šæœ¬æ—¶åŒºé”™è¯¯"></a>2.2 crontabä»¥åŠcrontabçš„è„šæœ¬æ—¶åŒºé”™è¯¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ln</span> -s /usr/local/glibc-2.14/share/zoneinfo/Asia/Shanghai /usr/local/glibc-2.14/etc/localtime</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é‡å¯æœåŠ¡å™¨</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">init 6</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>cssèµ„æ–™æ•´ç†</title>
      <link href="/posts/d24431e5.html"/>
      <url>/posts/d24431e5.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h2 id="Safari-transform-rotate-ä¸å…¼å®¹é—®é¢˜åŠè§£å†³"><a href="#Safari-transform-rotate-ä¸å…¼å®¹é—®é¢˜åŠè§£å†³" class="headerlink" title="Safari transform rotate ä¸å…¼å®¹é—®é¢˜åŠè§£å†³"></a>Safari transform rotate ä¸å…¼å®¹é—®é¢˜åŠè§£å†³</h2><p><a href="https://lunashu.org/safari-transform-rotate-bu-jian-rong-wen-ti-ji-jie-jue/">Safari transform rotate ä¸å…¼å®¹é—®é¢˜åŠè§£å†³</a></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">safari ä¸Š ä¸€ä¸ªå…ƒç´ ä½¿ç”¨äº† <span class="attribute">transform</span>:<span class="built_in">rotateY</span>(<span class="number">19deg</span>);æ˜¾ç¤ºé—®é¢˜å¤„ç†</span><br><span class="line"></span><br><span class="line">å¤„ç†æ–¹æ¡ˆï¼š</span><br><span class="line"><span class="attribute">transform</span>: <span class="built_in">perspective</span>(<span class="number">400px</span>) // ä¸ºå•¥æ˜¯<span class="number">400</span>ï¼Ÿ å› ä¸ºanimate.cssä¸­flipInXç”¨åˆ°çš„å°±æ˜¯<span class="number">400</span>ï¼›æˆ‘è¿™é‡Œæ˜¯å¼•ç”¨äº† animate.css æ‰€ä»¥ æ ¹æ®å®ƒçš„è®¾å®šæˆ‘ä¹Ÿè®¾å®šäº†<span class="number">400</span></span><br></pre></td></tr></table></figure><h2 id="css-logo-3Dæ—‹è½¬"><a href="#css-logo-3Dæ—‹è½¬" class="headerlink" title="css logo 3Dæ—‹è½¬"></a>css logo 3Dæ—‹è½¬</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.logo_item</span> &#123;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">2px</span> solid <span class="built_in">hsla</span>(<span class="number">0</span>,<span class="number">0%</span>,<span class="number">100%</span>,.<span class="number">8</span>);</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">2px</span> <span class="number">4px</span> <span class="number">0</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,.<span class="number">2</span>);</span><br><span class="line">    -webkit-<span class="attribute">box-sizing</span>: initial;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">perspective</span>(<span class="number">400px</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.logo_icon</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">&quot;../../www/images/VR/VR.png&quot;</span>) no-repeat;</span><br><span class="line">    <span class="attribute">background-size</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">transform-style</span>: preserve-<span class="number">3</span>d; <span class="comment">/* 3D è½¬æ¢ */</span></span><br><span class="line">    -webkit-<span class="attribute">transform-style</span>: preserve-<span class="number">3</span>d; <span class="comment">/* 3D è½¬æ¢ */</span></span><br><span class="line">    <span class="attribute">animation</span>: logo_icon <span class="number">4s</span> linear infinite;</span><br><span class="line">    -webkit-<span class="attribute">animation</span>: logo_icon <span class="number">4s</span> linear infinite;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@-webkit-keyframes</span> logo_icon &#123;</span><br><span class="line">    <span class="selector-tag">from</span> &#123;</span><br><span class="line">        -webkit-<span class="attribute">transform</span>: <span class="built_in">rotateY</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">to</span> &#123;</span><br><span class="line">        -webkit-<span class="attribute">transform</span>: <span class="built_in">rotateY</span>(<span class="number">360deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> logo_icon &#123;</span><br><span class="line">    <span class="selector-tag">from</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotateY</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">to</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotateY</span>(<span class="number">360deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="css3-æ–‡å­—å¤šè¡Œæ˜¾ç¤ºï¼Œè¶…å‡ºéƒ¨åˆ†â€¦"><a href="#css3-æ–‡å­—å¤šè¡Œæ˜¾ç¤ºï¼Œè¶…å‡ºéƒ¨åˆ†â€¦" class="headerlink" title="css3 æ–‡å­—å¤šè¡Œæ˜¾ç¤ºï¼Œè¶…å‡ºéƒ¨åˆ†â€¦"></a>css3 æ–‡å­—å¤šè¡Œæ˜¾ç¤ºï¼Œè¶…å‡ºéƒ¨åˆ†â€¦</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">overflow</span>: hidden;</span><br><span class="line"># æ˜¾ç¤ºçœç•¥ç¬¦å· ... æ¥ä»£è¡¨è¢«ä¿®å‰ªçš„æ–‡æœ¬ã€‚</span><br><span class="line"><span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line"><span class="attribute">display</span>: -webkit-box;</span><br><span class="line"># å®ƒåªæœ‰åœ¨ <span class="attribute">display</span> å±æ€§è®¾ç½®æˆ -webkit-box æˆ–è€… -webkit-inline-box å¹¶ä¸” -webkit-<span class="attribute">box-orient</span> (en-US) å±æ€§è®¾ç½®æˆ verticalæ—¶æ‰æœ‰æ•ˆæœ</span><br><span class="line"># æŒ‡å®šæ˜¾ç¤ºä¸¤è¡Œ</span><br><span class="line">-webkit-<span class="selector-tag">line</span>-clamp: <span class="number">2</span>;</span><br><span class="line"># å±æ€§è§„å®šæ¡†çš„å­å…ƒç´ åº”è¯¥è¢«æ°´å¹³æˆ–å‚ç›´æ’åˆ—ã€‚</span><br><span class="line">-webkit-<span class="attribute">box-orient</span>: vertical;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
          <category> css </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>åå‘ä»£ç†</title>
      <link href="/posts/0.html"/>
      <url>/posts/0.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><hr><h1 id="ä¸€ã€åå‘ä»£ç†"><a href="#ä¸€ã€åå‘ä»£ç†" class="headerlink" title="ä¸€ã€åå‘ä»£ç†"></a>ä¸€ã€åå‘ä»£ç†</h1><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">server&#123;</span><br><span class="line">  <span class="keyword">listen</span> <span class="number">80</span>;</span><br><span class="line">  server_name  hexo.cat;</span><br><span class="line">  <span class="keyword">index</span>  index.php index.html index.htm;</span><br><span class="line"></span><br><span class="line">  location / &#123;</span><br><span class="line">    proxy_pass  http:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">4000</span>; <span class="comment"># è½¬å‘è§„åˆ™</span></span><br><span class="line">    proxy_set_header Host <span class="variable">$proxy_host</span>; <span class="comment"># ä¿®æ”¹è½¬å‘è¯·æ±‚å¤´</span></span><br><span class="line">    <span class="comment"># è¡¨ç¤ºå‘å‡ºè¯·æ±‚çš„è¿œç¨‹ä¸»æœºçš„ IP åœ°å€ï¼Œremote_addrä»£è¡¨å®¢æˆ·ç«¯çš„IPï¼Œä½†å®ƒçš„å€¼ä¸æ˜¯ç”±å®¢æˆ·ç«¯æä¾›çš„ï¼Œè€Œæ˜¯æœåŠ¡ç«¯æ ¹æ®å®¢æˆ·ç«¯çš„ipæŒ‡å®šçš„ï¼Œå½“ä½ çš„æµè§ˆå™¨è®¿é—®æŸä¸ªç½‘ç«™æ—¶ï¼Œ</span></span><br><span class="line">    <span class="comment"># å‡è®¾ä¸­é—´æ²¡æœ‰ä»»ä½•ä»£ç†ï¼Œé‚£ä¹ˆç½‘ç«™çš„webæœåŠ¡å™¨ï¼ˆNginxï¼ŒApacheç­‰ï¼‰å°±ä¼šæŠŠremote_addrè®¾ä¸ºä½ çš„æœºå™¨IPï¼Œå¦‚æœä½ ç”¨äº†æŸä¸ªä»£ç†ï¼Œé‚£ä¹ˆä½ çš„æµè§ˆå™¨ä¼šå…ˆè®¿é—®è¿™ä¸ªä»£ç†ï¼Œ</span></span><br><span class="line">    <span class="comment"># ç„¶åå†ç”±è¿™ä¸ªä»£ç†è½¬å‘åˆ°ç½‘ç«™ï¼Œè¿™æ ·webæœåŠ¡å™¨å°±ä¼šæŠŠremote_addrè®¾ä¸ºè¿™å°ä»£ç†æœºå™¨çš„IP</span></span><br><span class="line">    proxy_set_header X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">    <span class="comment"># ç®€ç§°XFFå¤´ï¼Œå®ƒä»£è¡¨å®¢æˆ·ç«¯ï¼Œä¹Ÿå°±æ˜¯HTTPçš„è¯·æ±‚ç«¯çœŸå®çš„IPï¼Œåªæœ‰åœ¨é€šè¿‡äº†HTTP ä»£ç†æˆ–è€…è´Ÿè½½å‡è¡¡æœåŠ¡å™¨æ—¶æ‰ä¼šæ·»åŠ è¯¥é¡¹ï¼Œ</span></span><br><span class="line">    <span class="comment"># æ­£å¦‚ä¸Šé¢æ‰€è¿°,å½“ä½ ä½¿ç”¨äº†ä»£ç†æ—¶,webæœåŠ¡å™¨å°±ä¸çŸ¥é“ä½ çš„çœŸå®IPäº†,ä¸ºäº†é¿å…è¿™ä¸ªæƒ…å†µ,ä»£ç†æœåŠ¡å™¨é€šå¸¸ä¼šå¢åŠ ä¸€ä¸ªå«åšx_forwarded_forçš„å¤´ä¿¡æ¯,</span></span><br><span class="line">    <span class="comment"># æŠŠè¿æ¥å®ƒçš„å®¢æˆ·ç«¯IP(å³ä½ çš„ä¸Šç½‘æœºå™¨IP)åŠ åˆ°è¿™ä¸ªå¤´ä¿¡æ¯é‡Œ,è¿™æ ·å°±èƒ½ä¿è¯ç½‘ç«™çš„webæœåŠ¡å™¨èƒ½è·å–åˆ°çœŸå®IP</span></span><br><span class="line">    proxy_set_header X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PIL Imageå¼ºåˆ¶å¥æŸ„</title>
      <link href="/posts/df70f5f5.html"/>
      <url>/posts/df70f5f5.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="PIL-Imageå¼ºåˆ¶å¥æŸ„"><a href="#PIL-Imageå¼ºåˆ¶å¥æŸ„" class="headerlink" title="PIL Imageå¼ºåˆ¶å¥æŸ„"></a>PIL Imageå¼ºåˆ¶å¥æŸ„</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageSequence, ImageDraw, ImageFont</span><br><span class="line">fileOrign = Image.<span class="built_in">open</span>(orgFullFileName)</span><br><span class="line"><span class="comment"># é»˜è®¤æƒ…å†µä¸‹è‡ªåŠ¨é‡Šæ”¾</span></span><br><span class="line">fileOrign.close()</span><br><span class="line"><span class="comment"># ç”±äºè‡ªåŠ¨é‡Šæ”¾éœ€è¦æ—¶é—´ï¼Œä½¿ç”¨delçš„æ–¹å¼æ‰‹åŠ¨å¼ºåˆ¶é‡Šæ”¾</span></span><br><span class="line"><span class="keyword">del</span> fileOrign</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>No module namedå¤„ç†</title>
      <link href="/posts/c927929f.html"/>
      <url>/posts/c927929f.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="No-module-namedå¤„ç†"><a href="#No-module-namedå¤„ç†" class="headerlink" title="No module namedå¤„ç†"></a>No module namedå¤„ç†</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># No module namedå¤„ç†</span></span><br><span class="line"><span class="comment"># å‘½ä»¤è¡Œæ‰§è¡Œ: /etc/profile ä¸­æ–°å¢</span></span><br><span class="line">$ export PYTHONPATH=$PYTHONPATH:/path/é¡¹ç›®è·¯å¾„</span><br><span class="line"><span class="comment"># cronä¸­å¤„ç† æ·»åŠ </span></span><br><span class="line">PYTHONPATH=$PYTHONPATH:/path/é¡¹ç›®è·¯å¾„</span><br><span class="line"><span class="comment"># æˆ–è€…æ–‡ä»¶ä¸­æ·»åŠ PYTHONPATH</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">sys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pipä¸‹è½½æŒ‡å®šç‰ˆæœ¬package</title>
      <link href="/posts/74fae29b.html"/>
      <url>/posts/74fae29b.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="pipä¸‹è½½æŒ‡å®šç‰ˆæœ¬package"><a href="#pipä¸‹è½½æŒ‡å®šç‰ˆæœ¬package" class="headerlink" title="pipä¸‹è½½æŒ‡å®šç‰ˆæœ¬package"></a>pipä¸‹è½½æŒ‡å®šç‰ˆæœ¬package</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pipä¸‹è½½æŒ‡å®šç‰ˆæœ¬package</span></span><br><span class="line">$ pip install package==version</span><br><span class="line"><span class="comment"># pipä½¿ç”¨æ¸…åå¤§å­¦æºä¸‹è½½</span></span><br><span class="line">$ pip install paramiko -i https://pypi.tuna.tsinghua.edu.cn/simple/ </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŠ¨æ€åŠ è½½æ¨¡å—ã€ç±»ã€æ–¹æ³•</title>
      <link href="/posts/96f42c67.html"/>
      <url>/posts/96f42c67.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="åŠ¨æ€åŠ è½½æ¨¡å—ã€ç±»ã€æ–¹æ³•"><a href="#åŠ¨æ€åŠ è½½æ¨¡å—ã€ç±»ã€æ–¹æ³•" class="headerlink" title="åŠ¨æ€åŠ è½½æ¨¡å—ã€ç±»ã€æ–¹æ³•"></a>åŠ¨æ€åŠ è½½æ¨¡å—ã€ç±»ã€æ–¹æ³•</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ¤æ–­æ¨¡å—æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">hasModule = importlib.util.find_spec(<span class="string">&#x27;house.function.dataParse.%s&#x27;</span> % className)</span><br><span class="line">    <span class="keyword">if</span> hasModule <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"><span class="comment"># ç»å¯¹å¯¼å…¥</span></span><br><span class="line">åŠ¨æ€åŠ è½½æ¨¡å—</span><br><span class="line">moduleItem = importlib.import_module(<span class="string">&#x27;house.function.dataParse.%s&#x27;</span> % className)</span><br><span class="line">taskNo = SSIDInfo[<span class="string">&#x27;taskNo&#x27;</span>]</span><br><span class="line"><span class="comment"># å¯¹è±¡ä¸­å–å‡ºéœ€è¦çš„å¯¹è±¡</span></span><br><span class="line"><span class="comment"># è·å–class</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">hasattr</span>(moduleItem, className):</span><br><span class="line">    <span class="comment">#åŠ¨æ€åŠ è½½ç±»</span></span><br><span class="line">    classItem = <span class="built_in">getattr</span>(moduleItem, className)</span><br><span class="line">    <span class="keyword">if</span> classItem:</span><br><span class="line">        <span class="comment"># åŠ¨æ€åŠ è½½æ–¹æ³•</span></span><br><span class="line">        callFunction = <span class="built_in">getattr</span>(classItem, taskNo, <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">callable</span>(callFunction):</span><br><span class="line">            callRes = callFunction(selfItem, SSIDInfo, taskInfo, data)</span><br><span class="line">            <span class="built_in">print</span>(callRes)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>reçš„matchã€searchã€findallã€finditeråŒºåˆ«</title>
      <link href="/posts/83764ae2.html"/>
      <url>/posts/83764ae2.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€reçš„matchã€searchã€findallã€finditeråŒºåˆ«"><a href="#ä¸€ã€reçš„matchã€searchã€findallã€finditeråŒºåˆ«" class="headerlink" title="ä¸€ã€reçš„matchã€searchã€findallã€finditeråŒºåˆ«"></a>ä¸€ã€reçš„matchã€searchã€findallã€finditeråŒºåˆ«</h1><h2 id="1ã€match"><a href="#1ã€match" class="headerlink" title="1ã€match"></a>1ã€match</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">re.match(<span class="keyword">pattern</span>, string[, flags])  </span><br><span class="line">ä»é¦–å­—æ¯å¼€å§‹å¼€å§‹åŒ¹é…ï¼Œstringå¦‚æœåŒ…å«<span class="keyword">pattern</span>å­ä¸²ï¼Œåˆ™åŒ¹é…æˆåŠŸè¿”å›<span class="keyword">Match</span>å¯¹è±¡ï¼Œå¤±è´¥åˆ™è¿”å›<span class="keyword">None</span>ï¼Œè‹¥è¦å®Œå…¨åŒ¹é…ï¼Œ<span class="keyword">pattern</span>è¦ä»¥$ç»“å°¾ã€‚</span><br></pre></td></tr></table></figure><h2 id="2ã€search"><a href="#2ã€search" class="headerlink" title="2ã€search"></a>2ã€search</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">re<span class="selector-class">.search</span>(<span class="selector-tag">pattern</span>, string<span class="selector-attr">[, flags]</span>)  </span><br><span class="line">è‹¥stringä¸­åŒ…å«<span class="selector-tag">pattern</span>å­ä¸²ï¼Œåˆ™è¿”å›Matchå¯¹è±¡ï¼Œå¦åˆ™è¿”å›<span class="attribute">None</span></span><br><span class="line">æ³¨æ„ï¼šå¦‚æœstringä¸­å­˜åœ¨å¤šä¸ª<span class="selector-tag">pattern</span>å­ä¸²ï¼Œåªè¿”å›ç¬¬ä¸€ä¸ªã€‚</span><br></pre></td></tr></table></figure><h2 id="3ã€findall"><a href="#3ã€findall" class="headerlink" title="3ã€findall"></a>3ã€findall</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">re<span class="selector-class">.findall</span>(<span class="selector-tag">pattern</span>, string<span class="selector-attr">[, flags]</span>)  </span><br><span class="line">è¿”å›stringä¸­æ‰€æœ‰ä¸<span class="selector-tag">pattern</span>ç›¸åŒ¹é…çš„å…¨éƒ¨å­—ä¸²ï¼Œè¿”å›å½¢å¼ä¸ºæ•°ç»„ã€‚</span><br></pre></td></tr></table></figure><h2 id="4ã€finditer"><a href="#4ã€finditer" class="headerlink" title="4ã€finditer"></a>4ã€finditer</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">re<span class="selector-class">.finditer</span>(<span class="selector-tag">pattern</span>, string<span class="selector-attr">[, flags]</span>)  </span><br><span class="line">è¿”å›stringä¸­æ‰€æœ‰ä¸<span class="selector-tag">pattern</span>ç›¸åŒ¹é…çš„å…¨éƒ¨å­—ä¸²ï¼Œè¿”å›å½¢å¼ä¸ºMatchå¯¹è±¡çš„è¿­ä»£å™¨ã€‚</span><br></pre></td></tr></table></figure><h2 id="group-ã€groups-ä¸group-index-çš„åŒºåˆ«"><a href="#group-ã€groups-ä¸group-index-çš„åŒºåˆ«" class="headerlink" title="group()ã€groups()ä¸group(index)çš„åŒºåˆ«"></a>group()ã€groups()ä¸group(index)çš„åŒºåˆ«</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">group</span><span class="params">()</span></span>: è¿”å›å­—ç¬¦ä¸²</span><br><span class="line"><span class="function"><span class="title">groups</span><span class="params">()</span></span>: è¿”å›å­—ç¬¦ä¸²çš„å…ƒç»„</span><br><span class="line"><span class="function"><span class="title">group</span><span class="params">(index)</span></span>: è¿”å›å­—ç¬¦ä¸²å…ƒç»„ä¸­çš„index</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¤šç»´å­—å…¸èµ‹å€¼</title>
      <link href="/posts/bddbb5b.html"/>
      <url>/posts/bddbb5b.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="å¤šç»´å­—å…¸èµ‹å€¼"><a href="#å¤šç»´å­—å…¸èµ‹å€¼" class="headerlink" title="å¤šç»´å­—å…¸èµ‹å€¼"></a>å¤šç»´å­—å…¸èµ‹å€¼</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¤šç»´å­—å…¸èµ‹å€¼</span></span><br><span class="line">data_list = &#123;&#125;</span><br><span class="line">company = <span class="string">&#x27;å…¬å¸&#x27;</span></span><br><span class="line">describe_str = <span class="string">&#x27;æè¿°&#x27;</span></span><br><span class="line">data_list.setdefault(<span class="string">&#x27;company_info&#x27;</span>, &#123;&#125;).setdefault(company,&#123;&#125;).setdefault(<span class="string">&#x27;describe_info&#x27;</span>, &#123;&#125;).update(&#123;<span class="string">&#x27;info&#x27;</span>:describe_str&#125;)</span><br><span class="line">data_list.setdefault(<span class="string">&#x27;company_info&#x27;</span>, &#123;&#125;).setdefault(company, &#123;&#125;).setdefault(<span class="string">&#x27;user_list&#x27;</span>, &#123;&#125;).update(</span><br><span class="line">    &#123;<span class="string">&#x27;info&#x27;</span>: describe_str&#125;)</span><br><span class="line"><span class="built_in">print</span>(data_list)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ublacklistå±è”½åˆ—è¡¨</title>
      <link href="/posts/5faa6670.html"/>
      <url>/posts/5faa6670.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="è®¢é˜…æºåœ°å€"><a href="#è®¢é˜…æºåœ°å€" class="headerlink" title="è®¢é˜…æºåœ°å€"></a>è®¢é˜…æºåœ°å€</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//gi</span>tee.com<span class="regexp">/thiscat/u</span>blacklist<span class="regexp">/raw/m</span>aster/ublacklist</span><br><span class="line">https:<span class="regexp">//</span>raw.githubusercontent.com<span class="regexp">/cobaltdisco/</span>Google-Chinese-Results-Blocklist<span class="regexp">/master/u</span>Blacklist_subscription.txt</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å…¶ä»– </category>
          
          <category> æµè§ˆå™¨æ‰©å±• </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>curl</title>
      <link href="/posts/3e01b4d.html"/>
      <url>/posts/3e01b4d.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€æŸ¥çœ‹å½“å‰ç‰ˆæœ¬"><a href="#ä¸€ã€æŸ¥çœ‹å½“å‰ç‰ˆæœ¬" class="headerlink" title="ä¸€ã€æŸ¥çœ‹å½“å‰ç‰ˆæœ¬"></a>ä¸€ã€æŸ¥çœ‹å½“å‰ç‰ˆæœ¬</h1><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$</span> <span class="built_in">curl</span> <span class="literal">--version</span></span><br></pre></td></tr></table></figure><h1 id="äºŒã€å‡çº§curl"><a href="#äºŒã€å‡çº§curl" class="headerlink" title="äºŒã€å‡çº§curl"></a>äºŒã€å‡çº§curl</h1><p>ä½¿ç”¨ city-fan çš„æ›´æ–°æºæ¥æ›´æ–°ã€‚</p><h2 id="2-1-å¤‡ä»½ca-bundle"><a href="#2-1-å¤‡ä»½ca-bundle" class="headerlink" title="2.1 å¤‡ä»½ca-bundle"></a>2.1 å¤‡ä»½ca-bundle</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cp <span class="regexp">/etc/</span>pki<span class="regexp">/tls/</span>certs<span class="regexp">/ca-bundle.crt /</span>etc<span class="regexp">/pki/</span>tls<span class="regexp">/certs/</span>ca-bundle.crt.bak</span><br></pre></td></tr></table></figure><h2 id="2-2-æ–°å¢repo"><a href="#2-2-æ–°å¢repo" class="headerlink" title="2.2 æ–°å¢repo"></a>2.2 æ–°å¢repo</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">vim /etc/yum.repos.d/city-fan-for-curl.repo</span></span><br></pre></td></tr></table></figure><p>å†™å…¥å†…å®¹ï¼Œå¦‚æœæ˜¯7ç‰ˆæœ¬ï¼Œrhel6æ”¹ä¸ºrhel7</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name</span>=City Fan Repo</span><br><span class="line"><span class="attr">baseurl</span>=http://www.city-fan.org/ftp/contrib/yum-repo/rhel6/x<span class="number">86_64</span>/</span><br><span class="line"><span class="attr">enabled</span>=<span class="number">0</span></span><br><span class="line"><span class="attr">gpgcheck</span>=<span class="number">0</span></span><br></pre></td></tr></table></figure><h2 id="2-3-æ›´æ–°curl"><a href="#2-3-æ›´æ–°curl" class="headerlink" title="2.3 æ›´æ–°curl"></a>2.3 æ›´æ–°curl</h2><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ yum <span class="keyword">update</span> curl <span class="comment">--enablerepo=CityFanforCurl -y</span></span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€æ³¨æ„äº‹é¡¹"><a href="#ä¸‰ã€æ³¨æ„äº‹é¡¹" class="headerlink" title="ä¸‰ã€æ³¨æ„äº‹é¡¹"></a>ä¸‰ã€æ³¨æ„äº‹é¡¹</h1><h2 id="3-1-å½“å‡ºç°ä»¥ä¸‹é—®é¢˜æ—¶ï¼Œå¯ä»¥å°è¯•å‡çº§curlå’Œnssæ¥å¤„ç†"><a href="#3-1-å½“å‡ºç°ä»¥ä¸‹é—®é¢˜æ—¶ï¼Œå¯ä»¥å°è¯•å‡çº§curlå’Œnssæ¥å¤„ç†" class="headerlink" title="3.1 å½“å‡ºç°ä»¥ä¸‹é—®é¢˜æ—¶ï¼Œå¯ä»¥å°è¯•å‡çº§curlå’Œnssæ¥å¤„ç†"></a>3.1 å½“å‡ºç°ä»¥ä¸‹é—®é¢˜æ—¶ï¼Œå¯ä»¥å°è¯•å‡çº§curlå’Œnssæ¥å¤„ç†</h2><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* NSS <span class="keyword">error</span> <span class="number">-12286</span></span><br><span class="line">* Closing connection <span class="comment">#0</span></span><br><span class="line">* SSL connect <span class="keyword">error</span></span><br></pre></td></tr></table></figure><h1 id="å››ã€ç¼–è¯‘å®‰è£…curl"><a href="#å››ã€ç¼–è¯‘å®‰è£…curl" class="headerlink" title="å››ã€ç¼–è¯‘å®‰è£…curl"></a>å››ã€ç¼–è¯‘å®‰è£…curl</h1><h2 id="1-ä¸‹è½½"><a href="#1-ä¸‹è½½" class="headerlink" title="1.ä¸‹è½½"></a>1.ä¸‹è½½</h2><p><a href="https://curl.se/download/archeology/curl-7.29.0.tar.gz">curl.se&#x2F;download&#x2F;</a></p><h2 id="2-å®‰è£…"><a href="#2-å®‰è£…" class="headerlink" title="2.å®‰è£…"></a>2.å®‰è£…</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tar zxvf curl-7.29.0</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ›å»ºè¦å®‰è£…çš„ç›®å½•</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">mkdir</span> /usr/local/webserver/curl-7.29.0/</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å®‰è£…åˆ°åˆ›å»ºçš„æŒ‡å®šç›®å½•</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">.configure --prefix=/usr/local/webserver/curl-7.29.0/</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">make &amp;&amp; make install</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>hbaseå®‰è£…æ–‡æ¡£</title>
      <link href="/posts/31ba96e0.html"/>
      <url>/posts/31ba96e0.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>ä¸€ã€ä¸‹è½½å®‰è£…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">install.sh</span></span><br><span class="line">version=2.4.4</span><br><span class="line"></span><br><span class="line">wget https://mirrors.tuna.tsinghua.edu.cn/apache/hbase/$&#123;version&#125;/hbase-$&#123;version&#125;-src.tar.gz &amp;&amp;</span><br><span class="line">tar zxf hbase-$&#123;version&#125;-src.tar.gz &amp;&amp; mv hbase-$&#123;version&#125;-src /usr/local/webserver/hbase</span><br></pre></td></tr></table></figure><p>äºŒã€ç¯å¢ƒå˜é‡</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¿å­˜ä¸º/etc/profile.d/hbase_profile.sh</span></span><br><span class="line">export HBASE_HOME=/usr/local/webserver/hbase</span><br><span class="line">export PATH=.:$HBASE_HOME/bin:$PATH</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> hbase </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰è£…æ–‡æ¡£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hadoopå®‰è£…æ–‡æ¡£</title>
      <link href="/posts/55ef8388.html"/>
      <url>/posts/55ef8388.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>æ³¨æ„: æ²¡æœ‰ç‰¹åˆ«è¯´æ˜ï¼Œé»˜è®¤æ‰€æœ‰æœåŠ¡å™¨éƒ½éœ€è¦ä¸€æ ·çš„æ“ä½œ<br>javaæœ€ä½ç‰ˆæœ¬è¦æ±‚ä¸º1.8  </p><p>hadoopç›¸å…³å‘½ä»¤å¿…é¡»åœ¨HDFS_NAMENODE_USERå®šä¹‰çš„ç”¨æˆ·ä¸‹æ“ä½œã€‚æ­¤æ–‡æ¡£å®šä¹‰ä¸ºhadoopï¼Œæ‰€ä»¥éœ€è¦åœ¨hadoopç”¨æˆ·ä¸‹æ“ä½œ</p><h1 id="ä¸€ã€-ä¸‹è½½å®‰è£…"><a href="#ä¸€ã€-ä¸‹è½½å®‰è£…" class="headerlink" title="ä¸€ã€ ä¸‹è½½å®‰è£…"></a>ä¸€ã€ ä¸‹è½½å®‰è£…</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸‹è½½å¹¶è§£å‹åˆ°æŒ‡å®šç›®å½•</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">wget https://mirrors.tuna.tsinghua.edu.cn/apache/hadoop/common/hadoop-3.1.3/hadoop-3.1.3-src.tar.gz &amp;&amp; \</span></span><br><span class="line"><span class="language-bash">tar zxf hadoop-3.1.3-src.tar.gz &amp;&amp; <span class="built_in">mv</span> hadoop-3.1.3-src /usr/local/webserver/hadoop</span></span><br></pre></td></tr></table></figure><h1 id="äºŒã€ç¯å¢ƒå˜é‡"><a href="#äºŒã€ç¯å¢ƒå˜é‡" class="headerlink" title="äºŒã€ç¯å¢ƒå˜é‡"></a>äºŒã€ç¯å¢ƒå˜é‡</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¿å­˜ä¸º/etc/profile.d/hadoop_profile.sh</span></span><br><span class="line">export HADOOP_HOME=/usr/local/webserver/hadoop</span><br><span class="line">export PATH=.:$HADOOP_HOME/bin:$PATH</span><br><span class="line">export JAVA_LIBRARY_PATH=$HADOOP_HOME/lib/native</span><br><span class="line">export HADOOP_LOG_DIR=/data/hadoop/logs</span><br><span class="line">export HDFS_NAMENODE_USER=hadoop</span><br><span class="line">export HDFS_DATANODE_USER=hadoop</span><br><span class="line">export HDFS_SECONDARYNAMENODE_USER=hadoop</span><br><span class="line">export YARN_RESOURCEMANAGER_USER=hadoop</span><br><span class="line">export YARN_NODEMANAGER_USER=hadoop</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="built_in">export</span> HADOOP_ROOT_LOGGER=DEBUG,console</span></span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€ç›®å½•ç»“æ„"><a href="#ä¸‰ã€ç›®å½•ç»“æ„" class="headerlink" title="ä¸‰ã€ç›®å½•ç»“æ„"></a>ä¸‰ã€ç›®å½•ç»“æ„</h1><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ï¼ˆ<span class="number">1</span>ï¼‰<span class="keyword">bin </span>ç›®å½•ï¼šå­˜æ”¾å¯¹ Hadoop ç›¸å…³æœåŠ¡ï¼ˆhdfsï¼Œyarnï¼Œmapredï¼‰è¿›è¡Œæ“ä½œçš„è„šæœ¬</span><br><span class="line">ï¼ˆ<span class="number">2</span>ï¼‰etc ç›®å½•ï¼šHadoop çš„é…ç½®æ–‡ä»¶ç›®å½•ï¼Œå­˜æ”¾ Hadoop çš„é…ç½®æ–‡ä»¶</span><br><span class="line">ï¼ˆ<span class="number">3</span>ï¼‰lib ç›®å½•ï¼šå­˜æ”¾ Hadoop çš„æœ¬åœ°åº“ï¼ˆå¯¹æ•°æ®è¿›è¡Œå‹ç¼©è§£å‹ç¼©åŠŸèƒ½ï¼‰</span><br><span class="line">ï¼ˆ<span class="number">4</span>ï¼‰<span class="keyword">sbin </span>ç›®å½•ï¼šå­˜æ”¾å¯åŠ¨æˆ–åœæ­¢ Hadoop ç›¸å…³æœåŠ¡çš„è„šæœ¬</span><br><span class="line">ï¼ˆ<span class="number">5</span>ï¼‰<span class="keyword">share </span>ç›®å½•ï¼šå­˜æ”¾ Hadoop çš„ä¾èµ– <span class="keyword">jar </span>åŒ…ã€æ–‡æ¡£ã€å’Œå®˜æ–¹æ¡ˆä¾‹</span><br></pre></td></tr></table></figure><h1 id="å››ã€æ„æ¶æ¦‚è¿°"><a href="#å››ã€æ„æ¶æ¦‚è¿°" class="headerlink" title="å››ã€æ„æ¶æ¦‚è¿°"></a>å››ã€æ„æ¶æ¦‚è¿°</h1><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">HDFS</span><span class="params">(Hadoop Distributed File System)</span></span>æ¶æ„æ¦‚è¿°</span><br><span class="line"><span class="function"><span class="title">NameNode</span><span class="params">(NN)</span></span>ï¼šå­˜å‚¨æ–‡ä»¶çš„å…ƒæ•°æ®ï¼Œå¦‚æ–‡ä»¶åï¼Œæ–‡ä»¶ç›®å½•ç»“æ„ï¼Œæ–‡ä»¶å±æ€§ï¼ˆç”Ÿæˆæ—¶é—´ï¼Œå‰¯æœ¬æ•°ï¼Œæ–‡ä»¶æƒé™ï¼‰ï¼Œä»¥åŠæ¯ä¸ªæ–‡ä»¶çš„å—åˆ—è¡¨å’Œæ‰€åœ¨çš„DataNodeç­‰ã€‚</span><br><span class="line"><span class="function"><span class="title">DataNode</span><span class="params">(DN)</span></span>ï¼šåœ¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨çš„æ–‡ä»¶æ•°æ®ï¼Œä»¥åŠå—æ•°æ®çš„æ ¡éªŒå’Œã€‚</span><br><span class="line">Secondary <span class="built_in">NameNode</span>(<span class="number">2</span>NN)ï¼šç”¨æ¥ç›‘æ§HDFSçŠ¶æ€çš„è¾…åŠ©åå°ç¨‹åºï¼Œæ¯éš”ä¸€æ®µæ—¶é—´è·å–HDFSå…ƒæ•°æ®çš„å¿«ç…§ã€‚</span><br></pre></td></tr></table></figure><h1 id="äº”ã€å‰ç½®å‡†å¤‡"><a href="#äº”ã€å‰ç½®å‡†å¤‡" class="headerlink" title="äº”ã€å‰ç½®å‡†å¤‡"></a>äº”ã€å‰ç½®å‡†å¤‡</h1><h2 id="1-æ–°å¢hadoopç”¨æˆ·ï¼Œå¹¶ç»™äºˆsudoæƒé™"><a href="#1-æ–°å¢hadoopç”¨æˆ·ï¼Œå¹¶ç»™äºˆsudoæƒé™" class="headerlink" title="1. æ–°å¢hadoopç”¨æˆ·ï¼Œå¹¶ç»™äºˆsudoæƒé™"></a>1. æ–°å¢hadoopç”¨æˆ·ï¼Œå¹¶ç»™äºˆsudoæƒé™</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ›å»ºç”¨æˆ·</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">useradd hadoop</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è®¾ç½®å¯†ç </span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">passwd hadoop</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ·»åŠ <span class="built_in">sudo</span>æƒé™</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ–‡ä»¶æ·»åŠ ä¿®æ”¹æƒé™</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">chmod</span> +w /etc/sudoers</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ·»åŠ hadoop ALL=(ALL) ALL</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">vim /etc/sudoers</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ–‡ä»¶åˆ é™¤ä¿®æ”¹æƒé™</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">chmod</span> -w /etc/sudoers</span></span><br></pre></td></tr></table></figure><h2 id="2-é…ç½®host-æ·»åŠ å¯¹åº”æœåŠ¡å™¨çš„host"><a href="#2-é…ç½®host-æ·»åŠ å¯¹åº”æœåŠ¡å™¨çš„host" class="headerlink" title="2. é…ç½®host, æ·»åŠ å¯¹åº”æœåŠ¡å™¨çš„host"></a>2. é…ç½®host, æ·»åŠ å¯¹åº”æœåŠ¡å™¨çš„host</h2><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># <span class="number">212</span>ä¸ºä¸»æœåŠ¡å™¨</span><br><span class="line"># hadoop webçš„æ–‡ä»¶èµ„æºç®¡ç†ä½¿ç”¨çš„æ˜¯linuxçš„hostnameï¼Œä¹Ÿéœ€è¦é…ç½®åˆ°hostä¸­</span><br><span class="line"><span class="number">192.168.1.212</span> hadoop212</span><br><span class="line"><span class="number">192.168.1.213</span> hadoop213</span><br><span class="line"><span class="number">192.168.1.211</span> hadoop211</span><br></pre></td></tr></table></figure><h2 id="3-é…ç½®sshå…å¯†ç ç™»å½•"><a href="#3-é…ç½®sshå…å¯†ç ç™»å½•" class="headerlink" title="3. é…ç½®sshå…å¯†ç ç™»å½•"></a>3. é…ç½®sshå…å¯†ç ç™»å½•</h2><p>ä»¥ä¸‹æ‰€æœ‰æ“ä½œéƒ½å¿…é¡»ç”¨hadoopç”¨æˆ·æ“ä½œ</p><h3 id="ç”Ÿæˆå…¬é’¥å’Œç§é’¥"><a href="#ç”Ÿæˆå…¬é’¥å’Œç§é’¥" class="headerlink" title="ç”Ÿæˆå…¬é’¥å’Œç§é’¥"></a>ç”Ÿæˆå…¬é’¥å’Œç§é’¥</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">su hadoop</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ssh-keygen -t rsa</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å°†å…¬é’¥å¤åˆ¶åˆ°å…ç™»å½•çš„æœåŠ¡å™¨ä¸Š(æ¯ä¸€å°éƒ½è¦ç›¸åŒæ“ä½œ)</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ssh-copy-id hadoop212</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ssh-copy-id hadoop213</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ssh-copy-id hadoop211</span></span><br></pre></td></tr></table></figure><h2 id="4-åˆ›å»ºhadoopæ•°æ®çš„å­˜å‚¨ç›®å½•"><a href="#4-åˆ›å»ºhadoopæ•°æ®çš„å­˜å‚¨ç›®å½•" class="headerlink" title="4. åˆ›å»ºhadoopæ•°æ®çš„å­˜å‚¨ç›®å½•"></a>4. åˆ›å»ºhadoopæ•°æ®çš„å­˜å‚¨ç›®å½•</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">hadoopå­˜å‚¨ç›®å½•ï¼Œåœ¨core-site.xmlä¸­é…ç½®</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">mkdir</span> /data/hadoop/</span></span><br></pre></td></tr></table></figure><h1 id="äº”ã€é›†ç¾¤é…ç½®"><a href="#äº”ã€é›†ç¾¤é…ç½®" class="headerlink" title="äº”ã€é›†ç¾¤é…ç½®"></a>äº”ã€é›†ç¾¤é…ç½®</h1><h2 id="1-é›†ç¾¤éƒ¨ç½²è§„åˆ’"><a href="#1-é›†ç¾¤éƒ¨ç½²è§„åˆ’" class="headerlink" title="1. é›†ç¾¤éƒ¨ç½²è§„åˆ’"></a>1. é›†ç¾¤éƒ¨ç½²è§„åˆ’</h2><p>æ³¨æ„ï¼š<br>NameNode å’Œ SecondaryNameNode ä¸è¦å®‰è£…åœ¨åŒä¸€å°æœåŠ¡å™¨ ã€‚<br>ï¼ˆå®ƒä»¬ä¸¤ä¸ªéƒ½éœ€è¦è€—å†…å­˜ï¼Œåˆ†å¼€å‡å°‘é›†ç¾¤çš„å‹åŠ›ï¼‰<br>ResourceManager ä¹Ÿå¾ˆæ¶ˆè€—å†…å­˜ï¼Œä¸è¦å’Œ NameNodeã€SecondaryNameNode é…ç½®åœ¨åŒä¸€å°æœºå™¨ä¸Šã€‚</p><table>    <tr>        <td></td>        <td>hadoop212</td>        <td>hadoop213</td>        <td>hadoop211</td>    </tr>    <tr>        <td>HDFS</td>        <td>NameNode<br>DataNode</td>        <td>DataNode</td>        <td>SecondaryNameNode<br>DataNode</td>    </tr>    <tr>        <td>YARN</td>        <td>NodeManager</td>        <td>ResourceManager<br>NodeManager</td>        <td>NodeManager</td>    </tr></table>  <h2 id="2-é…ç½®æ–‡ä»¶è¯´æ˜"><a href="#2-é…ç½®æ–‡ä»¶è¯´æ˜" class="headerlink" title="2. é…ç½®æ–‡ä»¶è¯´æ˜"></a>2. é…ç½®æ–‡ä»¶è¯´æ˜</h2><p>(1) é»˜è®¤é…ç½®æ–‡ä»¶<br> ![é»˜è®¤é…ç½®æ–‡ä»¶]](.&#x2F;img&#x2F;é»˜è®¤é…ç½®æ–‡ä»¶.png â€œé»˜è®¤é…ç½®æ–‡ä»¶â€)<br>(2) è‡ªå®šä¹‰é…ç½®æ–‡ä»¶<br>$HADOOP_HOME&#x2F;etc&#x2F;hadoopè·¯å¾„ä¸‹å››ä¸ªé…ç½®æ–‡ä»¶<br>core-site.xml ã€hdfs-site.xml ã€yarn-site.xml ã€mapred-site.xml<br>ç”¨æˆ·å¯ä»¥æ ¹æ®é¡¹ç›®éœ€æ±‚é‡æ–°è¿›è¡Œä¿®æ”¹é…ç½®ã€‚</p><h2 id="é…ç½®é›†ç¾¤"><a href="#é…ç½®é›†ç¾¤" class="headerlink" title="é…ç½®é›†ç¾¤"></a>é…ç½®é›†ç¾¤</h2><h3 id="1-core-site-xml-æ ¸å¿ƒé…ç½®æ–‡ä»¶"><a href="#1-core-site-xml-æ ¸å¿ƒé…ç½®æ–‡ä»¶" class="headerlink" title="1. core-site.xml æ ¸å¿ƒé…ç½®æ–‡ä»¶"></a>1. core-site.xml æ ¸å¿ƒé…ç½®æ–‡ä»¶</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">  &lt;!-- æŒ‡å®š NameNode çš„åœ°å€ 9860ä¸ºhadoopå†…éƒ¨é€šè®¯ç«¯å£--&gt; </span><br><span class="line">  &lt;property&gt; </span><br><span class="line">      &lt;name&gt;fs.defaultFS&lt;/name&gt; </span><br><span class="line">      &lt;value&gt;hdfs://hadoop212:9860&lt;/value&gt; </span><br><span class="line">  &lt;/property&gt; </span><br><span class="line">  &lt;!-- æŒ‡å®š hadoop æ•°æ®çš„å­˜å‚¨ç›®å½• --&gt; </span><br><span class="line">    &lt;property&gt; </span><br><span class="line">        &lt;name&gt;hadoop.tmp.dir&lt;/name&gt; </span><br><span class="line">        &lt;value&gt;/data/hadoop/data&lt;/value&gt; </span><br><span class="line">  &lt;/property&gt; </span><br><span class="line">    &lt;!-- æŒ‡å®šzookeeperé›†ç¾¤ä¸»æœºåœ°å€ --&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">    &lt;name&gt;ha.zookeeper.quorum&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;hadoop212:2181,hadoop213:2181,hadoop211:2181&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"> </span><br><span class="line">  &lt;!-- é…ç½® HDFS ç½‘é¡µç™»å½•ä½¿ç”¨çš„é™æ€ç”¨æˆ·ä¸º hadoop--&gt; </span><br><span class="line">  &lt;property&gt; </span><br><span class="line">      &lt;name&gt;hadoop.http.staticuser.user&lt;/name&gt; </span><br><span class="line">      &lt;value&gt;hadoop&lt;/value&gt; </span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure><h3 id="2-hdfs-site-xml-æ•°æ®å­˜å‚¨"><a href="#2-hdfs-site-xml-æ•°æ®å­˜å‚¨" class="headerlink" title="2. hdfs-site.xml æ•°æ®å­˜å‚¨"></a>2. hdfs-site.xml æ•°æ®å­˜å‚¨</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">&lt;!-- NameNode web ç«¯è®¿é—®åœ°å€--&gt; </span><br><span class="line">  &lt;property&gt; </span><br><span class="line">        &lt;name&gt;dfs.namenode.http-address&lt;/name&gt; </span><br><span class="line">        &lt;value&gt;hadoop212:9870&lt;/value&gt; </span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;dfs.namenode.http-bind-host&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;hadoop212&lt;/value&gt;</span><br><span class="line">    &lt;description&gt;</span><br><span class="line">      The actual address the HTTP server will bind to. If this optional address</span><br><span class="line">      is set, it overrides only the hostname portion of dfs.namenode.http-address.</span><br><span class="line">      It can also be specified per name node or name service for HA/Federation.</span><br><span class="line">      This is useful for making the name node HTTP server listen on all</span><br><span class="line">      interfaces by setting it to 0.0.0.0.</span><br><span class="line">    &lt;/description&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">  &lt;!-- SecondaryNameNode web ç«¯è®¿é—®åœ°å€--&gt; </span><br><span class="line">    &lt;property&gt; </span><br><span class="line">        &lt;name&gt;dfs.namenode.secondary.http-address&lt;/name&gt; </span><br><span class="line">        &lt;value&gt;hadoop211:9868&lt;/value&gt; </span><br><span class="line">    &lt;/property&gt; </span><br><span class="line">    &lt;!-- å‰¯æœ¬æ•° --&gt; </span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;dfs.replication&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;2&lt;/value&gt;</span><br><span class="line">        &lt;description&gt;é»˜è®¤å€¼3.åˆ›å»ºæ–‡ä»¶æ—¶ï¼Œå¯ä»¥æŒ‡å®šå®é™…çš„å¤åˆ¶æ¬¡æ•°ã€‚ å¦‚æœåœ¨åˆ›å»ºæ—¶é—´ä¸­æœªæŒ‡å®šå¤åˆ¶ï¼Œåˆ™ä½¿ç”¨é»˜è®¤å€¼&lt;/description&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;dfs.ha.automatic-failover.enabled&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;true&lt;/value&gt;</span><br><span class="line">        &lt;description&gt;æ˜¯å¦å¯ç”¨äº†è‡ªåŠ¨æ•…éšœè½¬ç§»&lt;/description&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;dfs.datanode.du.reserved&lt;/name&gt;</span><br><span class="line">        &lt;!-- reserved space in bytes æœåŠ¡å™¨é¢„ç•™10Gä¸å¯ä¸ºhadoopä½¿ç”¨ --&gt;</span><br><span class="line">        &lt;value&gt;10737418240&lt;/value&gt;</span><br><span class="line">        &lt;description&gt;ä¿ç•™ç©ºé—´ä»¥æ¯å·çš„å­—èŠ‚ä¸ºå•ä½ã€‚ å§‹ç»ˆä¸ºéDFSä½¿ç”¨å…è´¹ç•™ä¸‹è¿™ä¹ˆå¤šçš„ç©ºé—´ã€‚Reserved space in bytes per volume. Always leave this much space free for non dfs use.</span><br><span class="line">        &lt;/description&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;dfs.disk.balancer.enabled&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;true&lt;/value&gt;</span><br><span class="line">        &lt;description&gt;æ˜¯å¦å¼€å¯ç£ç›˜å¹³è¡¡ï¼Œé»˜è®¤å¼€å¯</span><br><span class="line">        &lt;/description&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;dfs.disk.balancer.plan.threshold.percent&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;10&lt;/value&gt;</span><br><span class="line">        &lt;description&gt;è®¡åˆ’ä¸­å·æ•°æ®å¯†åº¦çš„ç™¾åˆ†æ¯”é˜ˆå€¼ã€‚ å¦‚æœåœ¨èŠ‚ç‚¹ä¸­çš„é˜ˆå€¼è¶…å‡ºé˜ˆå€¼çš„å·æ•°æ®å¯†åº¦çš„ç»å¯¹å€¼ï¼Œåˆ™æ„å‘³ç€å¯¹åº”äºç£ç›˜çš„å·åº”è¯¥åœ¨è®¡åˆ’ä¸­è¿›è¡Œå¹³è¡¡ã€‚ é»˜è®¤å€¼ä¸º10ã€‚</span><br><span class="line">        &lt;/description&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure><h3 id="3-yarn-xml-èµ„æºè°ƒåº¦"><a href="#3-yarn-xml-èµ„æºè°ƒåº¦" class="headerlink" title="3.yarn.xml èµ„æºè°ƒåº¦"></a>3.yarn.xml èµ„æºè°ƒåº¦</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- Site specific YARN configuration properties --&gt;</span><br><span class="line">&lt;!-- æŒ‡å®š MR èµ° shuffle --&gt; </span><br><span class="line">    &lt;property&gt; </span><br><span class="line">        &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt; </span><br><span class="line">        &lt;value&gt;mapreduce_shuffle&lt;/value&gt; </span><br><span class="line">    &lt;/property&gt; </span><br><span class="line"> </span><br><span class="line">    &lt;!-- æŒ‡å®š ResourceManager çš„åœ°å€--&gt; </span><br><span class="line">    &lt;property&gt; </span><br><span class="line">        &lt;name&gt;yarn.resourcemanager.hostname&lt;/name&gt; </span><br><span class="line">        &lt;value&gt;hadoop213&lt;/value&gt; </span><br><span class="line">    &lt;/property&gt; </span><br><span class="line">    &lt;!-- å¼€å¯æ—¥å¿—èšé›†åŠŸèƒ½ --&gt; </span><br><span class="line">    &lt;property&gt; </span><br><span class="line">        &lt;name&gt;yarn.log-aggregation-enable&lt;/name&gt; </span><br><span class="line">        &lt;value&gt;true&lt;/value&gt; </span><br><span class="line">    &lt;/property&gt; </span><br><span class="line">    &lt;!-- è®¾ç½®æ—¥å¿—èšé›†æœåŠ¡å™¨åœ°å€ --&gt; </span><br><span class="line">    &lt;property&gt;   </span><br><span class="line">        &lt;name&gt;yarn.log.server.url&lt;/name&gt;   </span><br><span class="line">        &lt;value&gt;http://hadoop212:19888/jobhistory/logs&lt;/value&gt; </span><br><span class="line">    &lt;/property&gt; </span><br><span class="line">    &lt;!-- è®¾ç½®æ—¥å¿—ä¿ç•™æ—¶é—´ä¸º 7 å¤© --&gt; </span><br><span class="line">    &lt;property&gt; </span><br><span class="line">        &lt;name&gt;yarn.log-aggregation.retain-seconds&lt;/name&gt; </span><br><span class="line">        &lt;value&gt;604800&lt;/value&gt; </span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;yarn.nodemanager.resource.memory-mb&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;2048&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;yarn.scheduler.minimum-allocation-mb&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;1048&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;yarn.nodemanager.vmem-pmem-ratio&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;2.1&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;!-- ç¯å¢ƒå˜é‡çš„ç»§æ‰¿ --&gt; </span><br><span class="line">    &lt;property&gt; </span><br><span class="line">        &lt;name&gt;yarn.nodemanager.env-whitelist&lt;/name&gt; </span><br><span class="line">        </span><br><span class="line">      &lt;value&gt;JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME&lt;/value&gt; </span><br><span class="line">    &lt;/property&gt; </span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure><h3 id="4-mapred-site-xml-è®¡ç®—"><a href="#4-mapred-site-xml-è®¡ç®—" class="headerlink" title="4. mapred-site.xml è®¡ç®—"></a>4. mapred-site.xml è®¡ç®—</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">  &lt;!-- æŒ‡å®š MapReduce ç¨‹åºè¿è¡Œåœ¨ Yarn ä¸Š --&gt; </span><br><span class="line">    &lt;property&gt; </span><br><span class="line">        &lt;name&gt;mapreduce.framework.name&lt;/name&gt; </span><br><span class="line">        &lt;value&gt;yarn&lt;/value&gt; </span><br><span class="line">    &lt;/property&gt; </span><br><span class="line">    &lt;!-- å†å²æœåŠ¡å™¨ç«¯åœ°å€(å†…éƒ¨é€šè®¯ç«¯å£) --&gt; </span><br><span class="line">  &lt;property&gt; </span><br><span class="line">      &lt;name&gt;mapreduce.jobhistory.address&lt;/name&gt; </span><br><span class="line">      &lt;value&gt;hadoop212:10020&lt;/value&gt; </span><br><span class="line">  &lt;/property&gt; </span><br><span class="line">  </span><br><span class="line">  &lt;!-- å†å²æœåŠ¡å™¨ web ç«¯åœ°å€,æŸ¥çœ‹é›†ç¾¤çš„å†å²æœåŠ¡ --&gt; </span><br><span class="line">  &lt;property&gt; </span><br><span class="line">      &lt;name&gt;mapreduce.jobhistory.webapp.address&lt;/name&gt; </span><br><span class="line">      &lt;value&gt;hadoop212:19888&lt;/value&gt; </span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">  &lt;property&gt; </span><br><span class="line">      &lt;name&gt;mapreduce.reduce.shuffle.connect.timeout&lt;/name&gt; </span><br><span class="line">      &lt;value&gt;&lt;/value&gt; </span><br><span class="line">  &lt;/property&gt; </span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure><h3 id="5-hadoop-env-sh-ç¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶"><a href="#5-hadoop-env-sh-ç¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶" class="headerlink" title="5. hadoop-env.sh ç¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶"></a>5. hadoop-env.sh ç¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># éœ€è¦æ·»åŠ ä»¥ä¸‹ä¸¤ä¸ªå˜é‡ï¼Œå³ä½¿åœ¨æœåŠ¡å™¨ä¸Šå·²ç»é…ç½®äº†ï¼Œä¹Ÿéœ€è¦åœ¨æ–‡ä»¶ä¸­é…ç½®</span><br><span class="line">JAVA_HOME=/usr/local/webserver/java8</span><br><span class="line">export HADOOP_LOG_DIR=/data/hadoop/logs</span><br></pre></td></tr></table></figure><h3 id="6-workers-é›†ç¾¤æœåŠ¡å™¨åˆ—è¡¨"><a href="#6-workers-é›†ç¾¤æœåŠ¡å™¨åˆ—è¡¨" class="headerlink" title="6. workers é›†ç¾¤æœåŠ¡å™¨åˆ—è¡¨"></a>6. workers é›†ç¾¤æœåŠ¡å™¨åˆ—è¡¨</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># å°†hostsä¸­é…ç½®çš„æœåŠ¡å™¨å†™å…¥</span><br><span class="line">hadoop212</span><br><span class="line">hadoop213</span><br><span class="line">hadoop211</span><br></pre></td></tr></table></figure><h3 id="iptableså¼€æ”¾ç«¯å£"><a href="#iptableså¼€æ”¾ç«¯å£" class="headerlink" title="iptableså¼€æ”¾ç«¯å£"></a>iptableså¼€æ”¾ç«¯å£</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># NameNodeå†…éƒ¨é€šè®¯ç«¯å£</span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 9860 -j ACCEPT</span><br><span class="line"># NameNode webè®¿é—®ç«¯å£</span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 9870 -j ACCEPT</span><br><span class="line"># namenode.rpc-address ç«¯å£</span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 8020 -j ACCEPT</span><br><span class="line"># namenode.secondary.http-address ç«¯å£</span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 9868 -j ACCEPT</span><br><span class="line"># namenode.secondary.https-address ç«¯å£</span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 9869 -j ACCEPT</span><br><span class="line"># datanode.ipc.address ç«¯å£</span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 9867 -j ACCEPT</span><br><span class="line"># datanode.http.address ç«¯å£</span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 9864 -j ACCEPT</span><br><span class="line"></span><br><span class="line"># ResourceManagerç«¯å£</span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 8088 -j ACCEPT</span><br><span class="line"># MapReduce JobHistory Serverç«¯å£</span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 19888 -j ACCEPT</span><br><span class="line"># jobhistoryå†…éƒ¨é€šè®¯ç«¯å£</span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 10020 -j ACCEPT</span><br></pre></td></tr></table></figure><h1 id="ä¸ƒã€å¯åŠ¨é›†ç¾¤-æ²¡ç‰¹æ®Šè¯´æ˜ï¼Œæ‰€æœ‰å‘½ä»¤éƒ½åœ¨hadoopæ ¹ç›®å½•ä¸‹æ‰§è¡Œ"><a href="#ä¸ƒã€å¯åŠ¨é›†ç¾¤-æ²¡ç‰¹æ®Šè¯´æ˜ï¼Œæ‰€æœ‰å‘½ä»¤éƒ½åœ¨hadoopæ ¹ç›®å½•ä¸‹æ‰§è¡Œ" class="headerlink" title="ä¸ƒã€å¯åŠ¨é›†ç¾¤(æ²¡ç‰¹æ®Šè¯´æ˜ï¼Œæ‰€æœ‰å‘½ä»¤éƒ½åœ¨hadoopæ ¹ç›®å½•ä¸‹æ‰§è¡Œ)"></a>ä¸ƒã€å¯åŠ¨é›†ç¾¤(æ²¡ç‰¹æ®Šè¯´æ˜ï¼Œæ‰€æœ‰å‘½ä»¤éƒ½åœ¨hadoopæ ¹ç›®å½•ä¸‹æ‰§è¡Œ)</h1><h2 id="1-åˆå§‹åŒ–ï¼ˆæ³¨æ„ï¼šåªæœ‰ç¬¬ä¸€æ¬¡çš„æ—¶å€™æ‰éœ€è¦ï¼‰"><a href="#1-åˆå§‹åŒ–ï¼ˆæ³¨æ„ï¼šåªæœ‰ç¬¬ä¸€æ¬¡çš„æ—¶å€™æ‰éœ€è¦ï¼‰" class="headerlink" title="1. åˆå§‹åŒ–ï¼ˆæ³¨æ„ï¼šåªæœ‰ç¬¬ä¸€æ¬¡çš„æ—¶å€™æ‰éœ€è¦ï¼‰"></a>1. åˆå§‹åŒ–ï¼ˆæ³¨æ„ï¼šåªæœ‰ç¬¬ä¸€æ¬¡çš„æ—¶å€™æ‰éœ€è¦ï¼‰</h2><p>å¦‚æœé›†ç¾¤æ˜¯ç¬¬ä¸€æ¬¡å¯åŠ¨ï¼Œéœ€è¦åœ¨ hadoop212 èŠ‚ç‚¹æ ¼å¼åŒ– NameNode<br>æ‰§è¡Œå®Œæˆåä¼šåœ¨å­˜å‚¨ç›®å½•ä¸‹ç”Ÿæˆdataå’Œlogsæ–‡ä»¶å¤¹<br>æ³¨æ„ï¼šæ ¼å¼åŒ– NameNodeï¼Œä¼šäº§ç”Ÿæ–°çš„é›†ç¾¤ idï¼Œå¯¼è‡´ NameNode å’Œ DataNode çš„é›†ç¾¤ id ä¸ä¸€è‡´ï¼Œé›†ç¾¤æ‰¾ä¸åˆ°å·²å¾€æ•°æ®ã€‚å¦‚æœé›†ç¾¤åœ¨è¿è¡Œè¿‡ç¨‹ä¸­æŠ¥é”™ï¼Œéœ€è¦é‡æ–°æ ¼å¼åŒ– NameNode çš„è¯ï¼Œä¸€å®šè¦å…ˆåœæ­¢ namenode å’Œ datanode è¿›ç¨‹ï¼Œå¹¶ä¸”è¦åˆ é™¤æ‰€æœ‰æœºå™¨çš„ data å’Œ logs ç›®å½•ï¼Œç„¶åå†è¿›è¡Œæ ¼å¼åŒ–  </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¿…é¡»hadoopç”¨æˆ·ä¸‹</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">su hadoop</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">hdfs namenode -format</span></span><br></pre></td></tr></table></figure><h2 id="2-æ ¼å¼åŒ–zkfs-ä»¥åŠå¯åŠ¨å¯¹åº”å®ˆæŠ¤è¿›ç¨‹"><a href="#2-æ ¼å¼åŒ–zkfs-ä»¥åŠå¯åŠ¨å¯¹åº”å®ˆæŠ¤è¿›ç¨‹" class="headerlink" title="2. æ ¼å¼åŒ–zkfs, ä»¥åŠå¯åŠ¨å¯¹åº”å®ˆæŠ¤è¿›ç¨‹"></a>2. æ ¼å¼åŒ–zkfs, ä»¥åŠå¯åŠ¨å¯¹åº”å®ˆæŠ¤è¿›ç¨‹</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ ¼å¼åŒ–zookeeper</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">bin/hdfs zkfc -formatZK</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯åŠ¨hdfsçš„zookeeperå®ˆæŠ¤è¿›ç¨‹</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">bin/hdfs --daemon start zkfc</span></span><br></pre></td></tr></table></figure><h2 id="3-å¯åŠ¨journalnode"><a href="#3-å¯åŠ¨journalnode" class="headerlink" title="3. å¯åŠ¨journalnode"></a>3. å¯åŠ¨journalnode</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯åŠ¨journalnode,ä½œç”¨æ˜¯å­˜æ”¾EditLogçš„</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">bin/hdfs --daemon start journalnode</span></span><br></pre></td></tr></table></figure><h2 id="4-å¯åŠ¨HDFS-212ä¸­æ‰§è¡Œ"><a href="#4-å¯åŠ¨HDFS-212ä¸­æ‰§è¡Œ" class="headerlink" title="4. å¯åŠ¨HDFS(212ä¸­æ‰§è¡Œ)"></a>4. å¯åŠ¨HDFS(212ä¸­æ‰§è¡Œ)</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sbin/start-dfs.sh</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æ‰§è¡ŒæˆåŠŸåï¼Œé€šè¿‡jpsæŸ¥çœ‹æ˜¯å¦å’Œé›†ç¾¤è§„åˆ’çš„é…ç½®ç›¸åŒ</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">jps</span></span><br></pre></td></tr></table></figure><h2 id="5-åœ¨é…ç½®äº†ResourceManagerçš„èŠ‚ç‚¹-hadoop213-å¯åŠ¨YARN"><a href="#5-åœ¨é…ç½®äº†ResourceManagerçš„èŠ‚ç‚¹-hadoop213-å¯åŠ¨YARN" class="headerlink" title="5. åœ¨é…ç½®äº†ResourceManagerçš„èŠ‚ç‚¹(hadoop213)å¯åŠ¨YARN"></a>5. åœ¨é…ç½®äº†ResourceManagerçš„èŠ‚ç‚¹(hadoop213)å¯åŠ¨YARN</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sbin/start-yarn.sh</span></span><br></pre></td></tr></table></figure><h2 id="6-Webç«¯æŸ¥çœ‹-HDFS-çš„-NameNode"><a href="#6-Webç«¯æŸ¥çœ‹-HDFS-çš„-NameNode" class="headerlink" title="6. Webç«¯æŸ¥çœ‹ HDFS çš„ NameNode"></a>6. Webç«¯æŸ¥çœ‹ HDFS çš„ NameNode</h2><p>(1) æµè§ˆå™¨è¾“å…¥ï¼šhadoop212:9870<br>(2) ç‚¹å‡»Utilitiesä¸‹çš„Browse the file systemï¼Œå¯ä»¥æŸ¥çœ‹å­˜å‚¨çš„æ–‡ä»¶</p><h2 id="7-webç«¯æŸ¥çœ‹YARNçš„ResourceManager"><a href="#7-webç«¯æŸ¥çœ‹YARNçš„ResourceManager" class="headerlink" title="7. webç«¯æŸ¥çœ‹YARNçš„ResourceManager"></a>7. webç«¯æŸ¥çœ‹YARNçš„ResourceManager</h2><p>(1) æµè§ˆå™¨è¾“å…¥ï¼šhadoop213:8088<br>(2) æŸ¥çœ‹è¿è¡Œçš„Jobä¿¡æ¯</p><h2 id="8-å¯åŠ¨å†å²æœåŠ¡å™¨-212ä¸­æ‰§è¡Œ"><a href="#8-å¯åŠ¨å†å²æœåŠ¡å™¨-212ä¸­æ‰§è¡Œ" class="headerlink" title="8. å¯åŠ¨å†å²æœåŠ¡å™¨(212ä¸­æ‰§è¡Œ)"></a>8. å¯åŠ¨å†å²æœåŠ¡å™¨(212ä¸­æ‰§è¡Œ)</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">mapred --daemon start historyserver</span></span><br></pre></td></tr></table></figure><h2 id="9-webç«¯å†å²æœåŠ¡å™¨"><a href="#9-webç«¯å†å²æœåŠ¡å™¨" class="headerlink" title="9. webç«¯å†å²æœåŠ¡å™¨"></a>9. webç«¯å†å²æœåŠ¡å™¨</h2><p>(1) æµè§ˆå™¨è¾“å…¥ï¼šhadoop212:19888</p><h1 id="å…«ã€é›†ç¾¤åŸºæœ¬å‘½ä»¤"><a href="#å…«ã€é›†ç¾¤åŸºæœ¬å‘½ä»¤" class="headerlink" title="å…«ã€é›†ç¾¤åŸºæœ¬å‘½ä»¤"></a>å…«ã€é›†ç¾¤åŸºæœ¬å‘½ä»¤</h1><h3 id="1-åŸºæœ¬å‘½ä»¤"><a href="#1-åŸºæœ¬å‘½ä»¤" class="headerlink" title="1. åŸºæœ¬å‘½ä»¤"></a>1. åŸºæœ¬å‘½ä»¤</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¿…é¡»hadoopç”¨æˆ·ä¸‹</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">su hadoop</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿è¡Œå¯åŠ¨å‘½ä»¤åŸºæœ¬é¡ºåº(hadoop æ ¹ç›®å½•ä¸‹)</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">hadoop212æ‰§è¡Œ</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä»¥ä¸‹ä¸¤å¥ä¸ºç¬¬ä¸€æ¬¡è¿è¡Œæ—¶éœ€è¦ä½¿ç”¨ï¼Œæ ¼å¼åŒ–æ•°æ®ï¼Œåé¢æ— éœ€å†æ‰§è¡Œ</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">hdfs namenode -format</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">hdfs zkfc -formatZK</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯åŠ¨hadoop</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">hdfs --daemon start zkfc</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">hdfs --daemon start journalnode</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sbin/start-dfs.sh</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">hadoop213æ‰§è¡Œ</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sbin/start-yarn.sh</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">hadoop212æ‰§è¡Œ</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">mapred --daemon start historyserver</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿è¡Œå…³é—­å‘½ä»¤é¡ºåº</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">hadoop212</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">hdfs --daemon stop journalnode</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sbin/stop-dfs.sh</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">hadoop213</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sbin/stop-yarn.sh</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">hadoop212</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">mapred --daemon stop historyserver</span></span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ›å»ºæ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">hdfs dfs -<span class="built_in">mkdir</span> /input</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸Šä¼ æ–‡ä»¶(test.txtä¸ºæœ¬åœ°æ–‡ä»¶)</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">hdfs dfs -put test.txt /input</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸‹è½½æ–‡ä»¶</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">hdfs dfs -get /jdk-8u212-linux-x64.tar.gz ./</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ‰§è¡Œwordcountç¨‹åº, æ‰§è¡Œåå¯åœ¨YARNçš„ResourceManageræŸ¥çœ‹</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.1.3.jar wordcount /input /output</span></span><br></pre></td></tr></table></figure><h3 id="2-æŸ¥çœ‹ä¸Šä¼ æ–‡ä»¶çš„ä½ç½®-æ¯ä¸ªæœåŠ¡å™¨éƒ½ä¼šæœ‰ç›¸åŒçš„ä¸€ä»½å‰¯æœ¬"><a href="#2-æŸ¥çœ‹ä¸Šä¼ æ–‡ä»¶çš„ä½ç½®-æ¯ä¸ªæœåŠ¡å™¨éƒ½ä¼šæœ‰ç›¸åŒçš„ä¸€ä»½å‰¯æœ¬" class="headerlink" title="2. æŸ¥çœ‹ä¸Šä¼ æ–‡ä»¶çš„ä½ç½®(æ¯ä¸ªæœåŠ¡å™¨éƒ½ä¼šæœ‰ç›¸åŒçš„ä¸€ä»½å‰¯æœ¬)"></a>2. æŸ¥çœ‹ä¸Šä¼ æ–‡ä»¶çš„ä½ç½®(æ¯ä¸ªæœåŠ¡å™¨éƒ½ä¼šæœ‰ç›¸åŒçš„ä¸€ä»½å‰¯æœ¬)</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> /data/hadoop/data/dfs/data/current/BP-1149522343-192.168.1.212-1625036516918/current/finalized/subdir0/subdir0</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">blk_1073741825ç±»ä¼¼çš„å‘½åçš„æ–‡ä»¶å°±æ˜¯ä¸Šä¼ çš„æ–‡ä»¶</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> blk_1073758313</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ‹¼æ¥</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> blk_1073758313&gt;&gt;tmp.tar.gz</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿½åŠ ä¸€ä¸ªæ–‡ä»¶åˆ°å‹ç¼©åŒ…ä¸­</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> blk_1073758314&gt;&gt;tmp.tar.gz</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è§£å‹æ–‡ä»¶æŸ¥çœ‹</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tar -zxvf tmp.tar.gz</span></span><br></pre></td></tr></table></figure><h1 id="ä¹ã€pythonå¯¹åº”çš„hdfsæ¥å£æ–‡æ¡£"><a href="#ä¹ã€pythonå¯¹åº”çš„hdfsæ¥å£æ–‡æ¡£" class="headerlink" title="ä¹ã€pythonå¯¹åº”çš„hdfsæ¥å£æ–‡æ¡£"></a>ä¹ã€pythonå¯¹åº”çš„hdfsæ¥å£æ–‡æ¡£</h1><p><a href="https://hdfscli.readthedocs.io/en/latest/" title="pypi hdfsCli">python hdfsCliæ¥å£æ–‡æ¡£</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æœ¬åœ°ä¹Ÿéœ€è¦é…ç½®ä¸‰å°æœåŠ¡å™¨çš„host</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å®‰è£…hdfs,ç›¸å…³æ“ä½œå¯ä»¥çœ‹Client</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">pip install hdfs</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hdfs <span class="keyword">import</span> *</span><br><span class="line">client = Client(<span class="string">&quot;http://192.168.1.212:9870&quot;</span>, root=<span class="string">&#x27;/input&#x27;</span>,timeout=<span class="number">100</span>)</span><br><span class="line"><span class="comment"># åˆ›å»ºæ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="comment"># client._mkdirs(&#x27;/img&#x27;)</span></span><br><span class="line"><span class="comment"># ä¸Šä¼ æ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="comment"># client.upload(&#x27;/img&#x27;, &#x27;./img&#x27;)</span></span><br><span class="line"><span class="comment"># åˆ é™¤æ–‡ä»¶å¤¹ recursive - æ˜¯å¦é€’å½’åˆ é™¤</span></span><br><span class="line"><span class="comment"># client.delete(&#x27;/img&#x27;, recursive=True)</span></span><br><span class="line"><span class="comment"># ä¸‹è½½æ–‡ä»¶</span></span><br><span class="line"><span class="comment"># client.download(&#x27;/img&#x27;, &#x27;/local/img&#x27;)</span></span><br><span class="line"><span class="comment"># è·å–æ–‡ä»¶ç›®å½•</span></span><br><span class="line">imgList = client.<span class="built_in">list</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    file = <span class="string">&#x27;/img/img/logo.png&#x27;</span></span><br><span class="line">    <span class="comment"># è·å–æ–‡ä»¶çŠ¶æ€ï¼Œæ–‡ä»¶å­˜åœ¨åˆ™ä¸‹è½½ï¼Œä¸å­˜åœ¨åˆ™æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">    content = client.status(file, strict=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">if</span> content:</span><br><span class="line">        client.download(file, <span class="string">&#x27;./&#x27;</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(e)</span><br></pre></td></tr></table></figure><h1 id="åã€HDFSæºç åˆ†æ-å…·ä½“çœ‹æºç åˆ†æé“¾æ¥"><a href="#åã€HDFSæºç åˆ†æ-å…·ä½“çœ‹æºç åˆ†æé“¾æ¥" class="headerlink" title="åã€HDFSæºç åˆ†æ(å…·ä½“çœ‹æºç åˆ†æé“¾æ¥)"></a>åã€HDFSæºç åˆ†æ(å…·ä½“çœ‹æºç åˆ†æé“¾æ¥)</h1><p><a href="http://www.imbajin.com/2020-01-17-HDFS3%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B9%8BClient%E8%AF%BB%E6%B5%81%E7%A8%8B%E4%B8%80/">HDFSæºç åˆ†æé“¾æ¥</a></p><p>ä»¥ä¸‹æ¦‚è¿°å†…å®¹ä»â€æºç åˆ†æé“¾æ¥ä¸­å¤åˆ¶æ¥çš„â€</p><h2 id="1-å†™å…¥æµç¨‹æ¦‚è¿°"><a href="#1-å†™å…¥æµç¨‹æ¦‚è¿°" class="headerlink" title="1. å†™å…¥æµç¨‹æ¦‚è¿°"></a>1. å†™å…¥æµç¨‹æ¦‚è¿°</h2><p>![å†™æµç¨‹å›¾]](.&#x2F;img&#x2F;hdfså†™å…¥æµç¨‹.png â€œhdfså†™å…¥æµç¨‹â€)</p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">å®¢æˆ·ç«¯æ ¸å¿ƒåœ¨<span class="keyword">create</span>() å’Œ<span class="keyword">write</span>() ä¸¤ä¸ªAPIè°ƒç”¨ä¸­, å¤§ä½“æ­¥éª¤å¦‚ä¸‹:</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>. æ–°å†™ä¸€ä¸ªæ–‡ä»¶, å…ˆè°ƒç”¨<span class="keyword">create</span>() æ–¹æ³•åº•å±‚å»ç»™NNå‘ä¸€ä¸ªRPCè¯·æ±‚, NNæ”¶åˆ°è¯·æ±‚åä¼šåœ¨FSçš„ç›®å½•æ ‘å¯¹åº”è·¯å¾„æ·»åŠ ä¸€ä¸ªç©ºçš„æ–°æ–‡ä»¶, ç„¶åè®°åœ¨editLog, åˆ›å»ºå®Œæˆåè¿”å›FSDataOutputStream , å®ƒè°ƒç”¨DFSOutputStream å†™æ•°æ®</span><br><span class="line"><span class="number">2</span>. æœ‰äº†è¾“å‡ºæµå¯¹è±¡ä¹‹å, æ ¸å¿ƒå°±æ˜¯è°ƒç”¨<span class="keyword">write</span>()æ–¹æ³•, åœ¨â‘ ä¸­åªæ˜¯å•çº¯åˆ›å»ºç©ºæ–‡ä»¶, è¿™é‡Œå†å¼€å§‹ç”³è¯·æ–°çš„æ•°æ®å—, ä»¥åŠä¼ è¾“ç®¡é“, æˆåŠŸåä¼šè¿”å›è¿™ä¸ªå—çš„æ‰€æœ‰DNèŠ‚ç‚¹ä¿¡æ¯.</span><br><span class="line"><span class="number">3</span>. é€šè¿‡ä¼ è¾“ç®¡é“æŠŠè¦å†™å…¥çš„æ•°æ®åˆ‡åˆ†ä¸ºä¸€ä¸ªä¸ªpacket(çº¦<span class="number">64</span>K)å¤§å°å‘é€, ç„¶ååœ¨å¤šä¸ªDNèŠ‚ç‚¹ä¹‹é—´ä¾æ¬¡é¡ºåºä¼ è¾“, ç„¶åé€†åºè¿”å›ACKç¡®è®¤å†™æˆåŠŸ, æœ€åå®¢æˆ·ç«¯æ¥æ”¶åˆ°æ­£å¸¸ACK, è¡¨ç¤ºå½“å‰packetå‘é€æˆåŠŸ</span><br><span class="line">    (<span class="number">1</span>)å¦‚æœDNæ¥æ”¶å®Œæ–‡ä»¶æ‰€æœ‰packet, åˆ™ä¼šå‘NNæ±‡æŠ¥å½“å‰<span class="keyword">block</span>ä¿¡æ¯</span><br><span class="line">    (<span class="number">2</span>)å¦‚æœå†™æ»¡äº†ä¸€ä¸ª<span class="keyword">block</span>, clientä¼šæ¥ç€å†ç”³è¯·ä¸€ä¸ªæ–°çš„<span class="keyword">block</span>, ç›´åˆ°æ‰€æœ‰æ•°æ®ä¼ è¾“å®Œæˆ</span><br><span class="line"><span class="number">4</span>. æœ€åå…³é—­æµçš„æ—¶å€™, é€complete()-rpc ç»™NNæäº¤æ–‡ä»¶çš„æ‰€æœ‰<span class="keyword">block</span>, ç¡®è®¤DNå·²éƒ½å®Œæˆå—æ±‡æŠ¥å, NNç¡®è®¤å½“å‰æ–‡ä»¶å†™å®Œæˆ.</span><br><span class="line"></span><br><span class="line">æ³¨:</span><br><span class="line"><span class="keyword">block</span>æ ¹æ®namenodeçš„è§„åˆ™(è§„åˆ™ä¸ºæœºæ¶æ„ŸçŸ¥)åˆ†å¸ƒå¼çš„å­˜å‚¨åœ¨datanodeä¸­</span><br><span class="line"></span><br><span class="line">ç”±äºé‡åˆ°è¿‡è¯¯å¯¼è‡ªå·±ï¼Œå¯¼è‡´ç†è§£ä¸Šå­˜åœ¨è¯¯åŒºï¼Œæ‰€ä»¥å†™ä¸‹ä¾‹å­</span><br><span class="line">ä¾‹ï¼šé…ç½®å‰¯æœ¬ä¸º<span class="number">2</span>çš„æƒ…å†µä¸‹ï¼Œblock1å‰¯æœ¬<span class="number">1</span>åœ¨hadoop212ä¸­ï¼Œå‰¯æœ¬<span class="number">2</span>å¯èƒ½åœ¨hadoop213ä¹Ÿå¯èƒ½åœ¨hadoop211ä¸­</span><br><span class="line">åŒç†ï¼šblock2å‰¯æœ¬<span class="number">1</span>åœ¨hadoop212ä¸­ï¼Œå‰¯æœ¬<span class="number">2</span>å¯èƒ½åœ¨hadoop211ä¹Ÿå¯èƒ½åœ¨hadoop213ä¸­ã€‚è™½ç„¶æŒ‰ç…§æœºæ¶ç­–ç•¥ï¼Œ<span class="number">213</span>æœ€åˆé€‚ä¸ºå‰¯æœ¬<span class="number">2</span>ï¼Œç”±äºioç­‰æƒ…å†µï¼Œå¯èƒ½é€‰æ‹©å‰¯æœ¬åˆ†å¸ƒåˆ°<span class="number">211</span></span><br></pre></td></tr></table></figure><h2 id="2-è¯»å–æµç¨‹æ¦‚è¿°"><a href="#2-è¯»å–æµç¨‹æ¦‚è¿°" class="headerlink" title="2. è¯»å–æµç¨‹æ¦‚è¿°"></a>2. è¯»å–æµç¨‹æ¦‚è¿°</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1.</span> å®¢æˆ·ç«¯å‘namenodeå‘RPCè¯·æ±‚, è¯»å–æ–‡ä»¶å¯¹åº”blocksçš„DNä¿¡æ¯</span><br><span class="line"><span class="bullet">2.</span> namenodeæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™è·å–æ–‡ä»¶çš„å…ƒä¿¡æ¯ï¼ˆæŒ‰é¡ºåºè¿”å›BlockIdä»¥åŠå¯¹åº”æ‰€åœ¨çš„datanodeåˆ—è¡¨ï¼‰</span><br><span class="line"><span class="bullet">3.</span> å®¢æˆ·ç«¯æ”¶åˆ°blockå¯¹åº”çš„DNä¿¡æ¯åé€‰å–ä¸€ä¸ªç½‘ç»œè®¿é—®æœ€è¿‘çš„DN, ä¾æ¬¡è¯»å–æ¯ä¸ªæ•°æ®å—(å®¢æˆ·ç«¯è¿™é‡Œæœ‰æ ¡éªŒé€»è¾‘, å¦‚æœå‘ç°å¼‚å¸¸ä¼šæ±‡æŠ¥åå—)</span><br><span class="line"><span class="bullet">4.</span> å®¢æˆ·ç«¯ä¸DNå»ºç«‹socketè¿æ¥ï¼Œé€šè¿‡æµä»¥packetä¸ºå•ä½ä¼ è¾“å¯¹åº”çš„æ•°æ®å—, å®¢æˆ·ç«¯æ”¶åˆ°æ•°æ®å†™å…¥æœ¬åœ°ç£ç›˜</span><br><span class="line"><span class="bullet">5.</span> ä¾æ¬¡ä¼ è¾“å‰©ä¸‹çš„æ•°æ®å—ï¼Œç›´åˆ°æ•´ä¸ªæ–‡ä»¶è¯»å–å®Œæˆ, æœ€åå…³é—­è¾“å…¥æµ</span><br></pre></td></tr></table></figure><h2 id="3-æœºæ¶æ„ŸçŸ¥"><a href="#3-æœºæ¶æ„ŸçŸ¥" class="headerlink" title="3. æœºæ¶æ„ŸçŸ¥"></a>3. æœºæ¶æ„ŸçŸ¥</h2><p><a href="https://www.cnblogs.com/wxisme/p/6270860.html">æ·±åˆ»ç†è§£HDFSå·¥ä½œæœºåˆ¶é“¾æ¥</a></p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æœºæ¶æ„ŸçŸ¥ï¼šHDFSé‡‡ç”¨ä¸€ç§ç§°ä¸ºæœºæ¶æ„ŸçŸ¥(rack-aware)çš„ç­–ç•¥æ¥æ”¹è¿›æ•°æ®çš„å¯é æ€§ã€å¯ç”¨æ€§å’Œç½‘ç»œå¸¦å®½çš„åˆ©ç”¨ç‡ã€‚å¤§å‹HDFSå®ä¾‹ä¸€èˆ¬è¿è¡Œåœ¨è·¨è¶Šå¤šä¸ªæœºæ¶çš„è®¡ç®—æœºç»„æˆçš„é›†ç¾¤ä¸Šï¼Œä¸åŒæœºæ¶ä¸Šçš„ä¸¤å°æœºå™¨ä¹‹é—´çš„é€šè®¯éœ€è¦ç»è¿‡äº¤æ¢æœºã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒåŒä¸€ä¸ªæœºæ¶å†…çš„ä¸¤å°æœºå™¨é—´çš„å¸¦å®½ä¼šæ¯”ä¸åŒæœºæ¶çš„ä¸¤å°æœºå™¨é—´çš„å¸¦å®½å¤§ã€‚é€šè¿‡ä¸€ä¸ªæœºæ¶æ„ŸçŸ¥çš„è¿‡ç¨‹ï¼ŒNamenodeå¯ä»¥ç¡®å®šæ¯ä¸ªDatanodeæ‰€å±çš„æœºæ¶<span class="built_in">id</span>ã€‚ä¸€ä¸ªç®€å•ä½†æ²¡æœ‰ä¼˜åŒ–çš„ç­–ç•¥å°±æ˜¯å°†å‰¯æœ¬å­˜æ”¾åœ¨ä¸åŒçš„æœºæ¶ä¸Šã€‚è¿™æ ·å¯ä»¥æœ‰æ•ˆé˜²æ­¢å½“æ•´ä¸ªæœºæ¶å¤±æ•ˆæ—¶æ•°æ®çš„ä¸¢å¤±ï¼Œå¹¶ä¸”å…è®¸è¯»æ•°æ®çš„æ—¶å€™å……åˆ†åˆ©ç”¨å¤šä¸ªæœºæ¶çš„å¸¦å®½ã€‚è¿™ç§ç­–ç•¥è®¾ç½®å¯ä»¥å°†å‰¯æœ¬å‡åŒ€åˆ†å¸ƒåœ¨é›†ç¾¤ä¸­ï¼Œæœ‰åˆ©äºå½“ç»„ä»¶å¤±æ•ˆæƒ…å†µä¸‹çš„è´Ÿè½½å‡è¡¡ã€‚ä½†æ˜¯ï¼Œå› ä¸ºè¿™ç§ç­–ç•¥çš„ä¸€ä¸ªå†™æ“ä½œéœ€è¦ä¼ è¾“æ•°æ®å—åˆ°å¤šä¸ªæœºæ¶ï¼Œè¿™å¢åŠ äº†å†™çš„ä»£ä»·ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå‰¯æœ¬ç³»æ•°æ˜¯<span class="number">3</span>ï¼ŒHDFSçš„å­˜æ”¾ç­–ç•¥æ˜¯å°†ä¸€ä¸ªå‰¯æœ¬å­˜æ”¾åœ¨æœ¬åœ°æœºæ¶çš„èŠ‚ç‚¹ä¸Šï¼Œä¸€ä¸ªå‰¯æœ¬æ”¾åœ¨åŒä¸€æœºæ¶çš„å¦ä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼Œæœ€åä¸€ä¸ªå‰¯æœ¬æ”¾åœ¨ä¸åŒæœºæ¶çš„èŠ‚ç‚¹ä¸Šã€‚è¿™ç§ç­–ç•¥å‡å°‘äº†æœºæ¶é—´çš„æ•°æ®ä¼ è¾“ï¼Œè¿™å°±æé«˜äº†å†™æ“ä½œçš„æ•ˆç‡ã€‚æœºæ¶çš„é”™è¯¯è¿œè¿œæ¯”èŠ‚ç‚¹çš„é”™è¯¯å°‘ï¼Œæ‰€ä»¥è¿™ä¸ªç­–ç•¥ä¸ä¼šå½±å“åˆ°æ•°æ®çš„å¯é æ€§å’Œå¯ç”¨æ€§ã€‚äºæ­¤åŒæ—¶ï¼Œå› ä¸ºæ•°æ®å—åªæ”¾åœ¨ä¸¤ä¸ªï¼ˆä¸æ˜¯ä¸‰ä¸ªï¼‰ä¸åŒçš„æœºæ¶ä¸Šï¼Œæ‰€ä»¥æ­¤ç­–ç•¥å‡å°‘äº†è¯»å–æ•°æ®æ—¶éœ€è¦çš„ç½‘ç»œä¼ è¾“æ€»å¸¦å®½ã€‚åœ¨è¿™ç§ç­–ç•¥ä¸‹ï¼Œå‰¯æœ¬å¹¶ä¸æ˜¯å‡åŒ€åˆ†å¸ƒåœ¨ä¸åŒçš„æœºæ¶ä¸Šã€‚ä¸‰åˆ†ä¹‹ä¸€çš„å‰¯æœ¬åœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼Œä¸‰åˆ†ä¹‹äºŒçš„å‰¯æœ¬åœ¨ä¸€ä¸ªæœºæ¶ä¸Šï¼Œå…¶ä»–å‰¯æœ¬å‡åŒ€åˆ†å¸ƒåœ¨å‰©ä¸‹çš„æœºæ¶ä¸­ï¼Œè¿™ä¸€ç­–ç•¥åœ¨ä¸æŸå®³æ•°æ®å¯é æ€§å’Œè¯»å–æ€§èƒ½çš„æƒ…å†µä¸‹æ”¹è¿›äº†å†™çš„æ€§èƒ½ã€‚</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> hadoop </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰è£…æ–‡æ¡£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>zookeeperå®‰è£…æ–‡æ¡£</title>
      <link href="/posts/74e42f70.html"/>
      <url>/posts/74e42f70.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€ä¸‹è½½å®‰è£…"><a href="#ä¸€ã€ä¸‹è½½å®‰è£…" class="headerlink" title="ä¸€ã€ä¸‹è½½å®‰è£…"></a>ä¸€ã€ä¸‹è½½å®‰è£…</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">install.sh</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3.5.5ä»¥åç‰ˆæœ¬éœ€è¦binçš„åŒ…</span></span><br><span class="line">wget https://mirrors.tuna.tsinghua.edu.cn/apache/zookeeper/zookeeper-3.7.0/apache-zookeeper-3.7.0-bin.tar.gz &amp;&amp;</span><br><span class="line">tar zxvf apache-zookeeper-3.7.0.tar.gz &amp;&amp; mv apache-zookeeper-3.7.0 /usr/local/webserver/zookeeper</span><br><span class="line"></span><br><span class="line">mkdir -p /data/zookeeper</span><br></pre></td></tr></table></figure><h1 id="äºŒã€ç¯å¢ƒå˜é‡"><a href="#äºŒã€ç¯å¢ƒå˜é‡" class="headerlink" title="äºŒã€ç¯å¢ƒå˜é‡"></a>äºŒã€ç¯å¢ƒå˜é‡</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¿å­˜ä¸º/etc/profile.d/zookeeper_profile.sh</span></span><br><span class="line">export ZOOKEEPER_HOME=/usr/local/webserver/zookeeper</span><br><span class="line">export PATH=.:$ZOOKEEPER_HOME/bin:$PATH</span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€é…ç½®conf-zoo-conf"><a href="#ä¸‰ã€é…ç½®conf-zoo-conf" class="headerlink" title="ä¸‰ã€é…ç½®conf&#x2F;zoo.conf"></a>ä¸‰ã€é…ç½®conf&#x2F;zoo.conf</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"># The number of milliseconds of each tick</span><br><span class="line"># å•æ¬¡å¿ƒè·³é—´éš”</span><br><span class="line">tickTime=2000</span><br><span class="line"># The number of ticks that the initial</span><br><span class="line"># synchronization phase can take</span><br><span class="line"># è¶…è¿‡åæ¬¡å¿ƒè·³æ—¶é—´ï¼Œåˆ™è®¤ä¸ºå®¢æˆ·ç«¯è¿æ¥ç«¯å£</span><br><span class="line">initLimit=10</span><br><span class="line"># The number of ticks that can pass between</span><br><span class="line"># sending a request and getting an acknowledgement</span><br><span class="line"># leaderå’Œfollowè¯·æ±‚åº”ç­”ï¼Œä¸èƒ½è¶…è¿‡5ä¸ªå¿ƒè·³æ—¶é—´</span><br><span class="line">syncLimit=5</span><br><span class="line"># the directory where the snapshot is stored.</span><br><span class="line"># do not use /tmp for storage, /tmp here is just</span><br><span class="line"># example sakes.</span><br><span class="line"># æ•°æ®å­˜å‚¨è·¯å¾„</span><br><span class="line">dataDir=/data/zookeeper/data</span><br><span class="line">dataLogDir=/data/zookeeper/logs</span><br><span class="line"># the port at which the clients will connect</span><br><span class="line"># å®¢æˆ·ç«¯ç«¯å£</span><br><span class="line">clientPort=2181</span><br><span class="line"># the maximum number of client connections.</span><br><span class="line"># increase this if you need to handle more clients</span><br><span class="line"># æœ€å¤§å®¢æˆ·ç«¯è¿æ¥æ•°</span><br><span class="line">maxClientCnxns=60</span><br><span class="line">#</span><br><span class="line"># Be sure to read the maintenance section of the</span><br><span class="line"># administrator guide before turning on autopurge.</span><br><span class="line">#</span><br><span class="line"># http://zookeeper.apache.org/doc/current/zookeeperAdmin.html#sc_maintenance</span><br><span class="line">#</span><br><span class="line"># The number of snapshots to retain in dataDir</span><br><span class="line">#autopurge.snapRetainCount=3</span><br><span class="line"># Purge task interval in hours</span><br><span class="line"># Set to &quot;0&quot; to disable auto purge feature</span><br><span class="line">#autopurge.purgeInterval=1</span><br><span class="line"></span><br><span class="line">## Metrics Providers</span><br><span class="line">#</span><br><span class="line"># https://prometheus.io Metrics Exporter</span><br><span class="line">#metricsProvider.className=org.apache.zookeeper.metrics.prometheus.PrometheusMetricsProvider</span><br><span class="line">#metricsProvider.httpPort=7000</span><br><span class="line">#metricsProvider.exportJvmInfo=true</span><br><span class="line"># åˆ†å¸ƒå¼ä¸»æœºé…ç½®ã€‚2888ä¸ºleaderç«¯å£ï¼Œ3888ä¸ºfollowç«¯å£</span><br><span class="line"># é…ç½®çš„/data/zookeeper/myidå€¼ä¸åºå·ä¸€è‡´</span><br><span class="line">server.1=ip1:2888:3888</span><br><span class="line">server.2=ip2:2888:3888</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="å››ã€å¼€æ”¾iptablesç«¯å£"><a href="#å››ã€å¼€æ”¾iptablesç«¯å£" class="headerlink" title="å››ã€å¼€æ”¾iptablesç«¯å£"></a>å››ã€å¼€æ”¾iptablesç«¯å£</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 2181 -j ACCEPT</span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 2888 -j ACCEPT</span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 3888 -j ACCEPT</span><br></pre></td></tr></table></figure><h1 id="äº”ã€-ä¸ºæ¯å°æœåŠ¡å™¨å†™å…¥ä¸åŒidå·"><a href="#äº”ã€-ä¸ºæ¯å°æœåŠ¡å™¨å†™å…¥ä¸åŒidå·" class="headerlink" title="äº”ã€ ä¸ºæ¯å°æœåŠ¡å™¨å†™å…¥ä¸åŒidå·"></a>äº”ã€ ä¸ºæ¯å°æœåŠ¡å™¨å†™å…¥ä¸åŒidå·</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;1&quot; &gt; dataDir=/data/zookeeper/data/myid</span><br></pre></td></tr></table></figure><h1 id="å…­ã€é€‰æ‹©è§„åˆ™"><a href="#å…­ã€é€‰æ‹©è§„åˆ™" class="headerlink" title="å…­ã€é€‰æ‹©è§„åˆ™"></a>å…­ã€é€‰æ‹©è§„åˆ™</h1><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1.</span> å…ˆæ¯”è¾ƒäº‹åŠ¡ID(ZXID)ï¼Œå¦‚æœç›¸åŒå†æ¯”è¾ƒmyidã€‚å€¼æ¯”è¾ƒå¤§çš„ä¸ºleaderï¼Œå…¶ä½™ä¸ºfollow</span><br><span class="line"><span class="bullet">2.</span> ç”±äºå¯åŠ¨é˜¶æ®µZXIDå‡ä¸º0ï¼Œæ‰€ä»¥åªè¦æ¯”è¾ƒmyidå³å¯</span><br></pre></td></tr></table></figure><h1 id="ä¸ƒã€å¸¸ç”¨å‘½ä»¤"><a href="#ä¸ƒã€å¸¸ç”¨å‘½ä»¤" class="headerlink" title="ä¸ƒã€å¸¸ç”¨å‘½ä»¤"></a>ä¸ƒã€å¸¸ç”¨å‘½ä»¤</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯åŠ¨</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./zkService start</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å‰å°å¯åŠ¨ï¼Œå¯ä»¥æŸ¥çœ‹æ‰§è¡Œä¿¡æ¯ï¼ŒæŸ¥çœ‹æŠ¥é”™ä¿¡æ¯æ—¶å¯ä»¥ä½¿ç”¨</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./zkService start-foreground</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å…³é—­</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./zkService stop</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é‡å¯</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./zkService restart</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹çŠ¶æ€</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./zkService status</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> zookeeper </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰è£…æ–‡æ¡£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>goå®‰è£…</title>
      <link href="/posts/6434012d.html"/>
      <url>/posts/6434012d.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸‹è½½å¹¶è§£å‹"><a href="#ä¸‹è½½å¹¶è§£å‹" class="headerlink" title="ä¸‹è½½å¹¶è§£å‹"></a>ä¸‹è½½å¹¶è§£å‹</h1><p>wget <a href="https://dl.google.com/go/go1.16.5.linux-amd64.tar.gz">https://dl.google.com/go/go1.16.5.linux-amd64.tar.gz</a> &amp;&amp; tar -C &#x2F;usr&#x2F;local&#x2F;webserver -xzf go1.16.5.linux-amd64.tar.gz</p><h1 id="è®¾ç½®profile"><a href="#è®¾ç½®profile" class="headerlink" title="è®¾ç½®profile"></a>è®¾ç½®profile</h1><p>export PATH&#x3D;&#x2F;usr&#x2F;local&#x2F;webserver&#x2F;go&#x2F;bin:$PATH</p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> go </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰è£…æ–‡æ¡£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sphinxæ“ä½œè„šæœ¬</title>
      <link href="/posts/cc7ec99f.html"/>
      <url>/posts/cc7ec99f.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">sphinxæ“ä½œè„šæœ¬</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æ‰§è¡Œæ—¶ï¼Œå¿…é¡»åœ¨sphinx_confæ–‡ä»¶å¤¹ä¸‹</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å½“å‰è„šæœ¬ä»¥åŠsphinxParam.txtæœ‰ä¿®æ”¹åï¼Œåœ¨linuxå¹³å°å¿…é¡»vimå¯¹åº”æ–‡ä»¶åï¼Œæ‰§è¡Œ<span class="built_in">set</span> ff=unix,è½¬æ¢ä¸ºunixæ–‡ä»¶æ ¼å¼</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ›å»ºsphinxæ—¶éœ€è¦å¸¦ç«¯å£å·,æ ¼å¼å¦‚ä¸‹: -tä»£è¡¨ç±»å‹ -lä»£è¡¨åˆ—è¡¨ åˆ—è¡¨æ ¼å¼ä¸º<span class="string">&#x27;æ–‡ä»¶å:ç«¯å£å·&#x27;</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é»˜è®¤è¯»å–sphinx_conf/sphinxParam.txtæ–‡ä»¶,æ–‡ä»¶å†…æ ¼å¼</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">sphinxParam.txtæ ·ä¾‹å¼€å§‹(å‰åæ²¡æœ‰ç©ºæ ¼)</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">sphinxFileConfName:port</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">a.conf:9315</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">sphinxParam.txtæ ·ä¾‹è§£é‡Š</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">sh sphinxOption.sh -t create -l <span class="string">&#x27;sell:9313 chuzu:9313&#x27;</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å…¶ä»–æ“ä½œä¸éœ€è¦å¸¦ç«¯å£å·,ç›®å‰æ”¯æŒæ“ä½œä¸º</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">all: åˆæ¬¡å¯åŠ¨ç”Ÿæˆæ–‡ä»¶ delta:å¢é‡ allrotate:å…¨é‡rotate deltarotate:å¢é‡rotate start: å¯åŠ¨searchd stop:åœæ­¢searchd</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¦‚æœæ˜¯dockerï¼Œéœ€è¦å¸¦å‚æ•° -p docker</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">sh sphinxOption.sh -t deltarotate -l <span class="string">&#x27;sell chuzu&#x27;</span></span></span><br><span class="line"></span><br><span class="line">echo &quot;$*&quot;</span><br><span class="line">platform=&quot;&quot;</span><br><span class="line">while getopts &quot;:p:t:l:&quot; opt; do</span><br><span class="line">  case $opt in</span><br><span class="line">    p)</span><br><span class="line">      platform=$OPTARG</span><br><span class="line">      ;;</span><br><span class="line">    t)</span><br><span class="line">      type=$OPTARG</span><br><span class="line">      ;;</span><br><span class="line">    l)</span><br><span class="line">      fileParam=$OPTARG</span><br><span class="line">      ;;</span><br><span class="line">    ?*)</span><br><span class="line">      echo &quot;æœªå®šä¹‰å‚æ•° $OPTARG é€€å‡ºè„šæœ¬&quot;</span><br><span class="line">      exit 0</span><br><span class="line">      ;;</span><br><span class="line">  esac</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">if [ &quot;$fileParam&quot; == &quot;&quot; ]; then</span><br><span class="line">  fileParam=$(cat sphinxParam.txt)</span><br><span class="line">fi</span><br><span class="line">for line in $fileParam; do</span><br><span class="line">  filename=$(echo $line | awk -F: &#x27;&#123;print $1&#125;&#x27;)</span><br><span class="line">  if [ -z $filename ] || [ ! -f &quot;$&#123;filename&#125;.conf&quot; ]</span><br><span class="line">  then</span><br><span class="line">    echo &quot;å½“å‰ç›®å½•ä¸‹æŸ¥æ‰¾$&#123;filename&#125;.confæ–‡ä»¶å¤±è´¥ï¼Œæ— æ³•æ‰§è¡Œï¼Œé€€å‡ºè„šæœ¬&quot;</span><br><span class="line">    exit 0</span><br><span class="line">  fi</span><br><span class="line"></span><br><span class="line">  port=$(echo $line | awk -F: &#x27;&#123;print $2&#125;&#x27;)</span><br><span class="line"></span><br><span class="line">  echo &quot;filename:$&#123;filename&#125; port:$&#123;port&#125; platform:$&#123;platform&#125;&quot;</span><br><span class="line"></span><br><span class="line">  dockerExec=&quot;&quot;</span><br><span class="line">  if [ $&#123;platform&#125; == &#x27;docker&#x27; ]</span><br><span class="line">  then</span><br><span class="line">    dockerExec=&quot;docker exec -i sphinx_$&#123;filename&#125; &quot;</span><br><span class="line">  fi</span><br><span class="line"></span><br><span class="line">  case $type in</span><br><span class="line">    create)</span><br><span class="line">      echo &quot;åˆ›å»º sphinx&quot;</span><br><span class="line">      if [ -z $port ]</span><br><span class="line">      then</span><br><span class="line">        echo &quot;ç«¯å£å·ä¸ºç©ºï¼Œæ— æ³•æ‰§è¡Œåˆ›å»ºï¼Œé€€å‡ºè„šæœ¬&quot;</span><br><span class="line">        exit 0</span><br><span class="line">      fi</span><br><span class="line">      docker run -ti --restart=always -d  -p $&#123;port&#125;:$&#123;port&#125; --name sphinx_$&#123;filename&#125; -v /data/:/data/:rw -v /dev/shm/:/dev/shm/:rw --network my_net coreseek3.2 bash</span><br><span class="line">      ;;</span><br><span class="line">    all)</span><br><span class="line">      echo &quot;æ‰§è¡Œ --all&quot;</span><br><span class="line">      $&#123;dockerExec&#125; /usr/local/webserver/coreseek/bin/indexer --config /data/http/917.com/sphinx_conf/$&#123;filename&#125;.conf --all --rotate</span><br><span class="line">      ;;</span><br><span class="line">    delta)</span><br><span class="line">      echo &quot;æ‰§è¡Œ delta&quot;</span><br><span class="line">      $&#123;dockerExec&#125; /usr/local/webserver/coreseek/bin/indexer --config /data/http/917.com/sphinx_conf/$&#123;filename&#125;.conf $&#123;filename&#125;_delta</span><br><span class="line">      ;;</span><br><span class="line">    allrotate)</span><br><span class="line">      echo &quot;æ‰§è¡Œ --all --rotate&quot;</span><br><span class="line">      $&#123;dockerExec&#125; /usr/local/webserver/coreseek/bin/indexer --config /data/http/917.com/sphinx_conf/$&#123;filename&#125;.conf --all --rotate</span><br><span class="line">      ;;</span><br><span class="line">    deltarotate)</span><br><span class="line">      echo &quot;æ‰§è¡Œ delta --rotate&quot;</span><br><span class="line">      $&#123;dockerExec&#125; /usr/local/webserver/coreseek/bin/indexer --config /data/http/917.com/sphinx_conf/$&#123;filename&#125;.conf $&#123;filename&#125;_delta --rotate</span><br><span class="line">      ;;</span><br><span class="line">    start)</span><br><span class="line">      echo &quot;æ‰§è¡Œ --pid å¯åŠ¨&quot;</span><br><span class="line">      $&#123;dockerExec&#125; /usr/local/webserver/coreseek/bin/searchd -c /data/http/917.com/sphinx_conf/$&#123;filename&#125;.conf --pidfile</span><br><span class="line">      ;;</span><br><span class="line">    stop)</span><br><span class="line">      echo &quot;æ‰§è¡Œ --stop åœæ­¢&quot;</span><br><span class="line">      $&#123;dockerExec&#125; /usr/local/webserver/coreseek/bin/searchd -c /data/http/917.com/sphinx_conf/$&#123;filename&#125;.conf --stop</span><br><span class="line">      ;;</span><br><span class="line">  esac</span><br><span class="line">done</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
          <category> shell </category>
          
      </categories>
      
      
        <tags>
            
            <tag> shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DFA(TireTree) å®ç°æ•æ„Ÿè¯åŒ¹é…</title>
      <link href="/posts/65999931.html"/>
      <url>/posts/65999931.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="åŸºäºDFAç®—æ³•å®ç°æ•æ„Ÿè¯åŒ¹é…"><a href="#åŸºäºDFAç®—æ³•å®ç°æ•æ„Ÿè¯åŒ¹é…" class="headerlink" title="åŸºäºDFAç®—æ³•å®ç°æ•æ„Ÿè¯åŒ¹é…"></a>åŸºäºDFAç®—æ³•å®ç°æ•æ„Ÿè¯åŒ¹é…</h1><p>ä¸€ã€å°è½¬ç±»</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// rediså°è£…ç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SensitiveByRedis</span> <span class="keyword">extends</span> <span class="title">Sensitive</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$redis</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="variable">$extClass</span>; <span class="comment">// å¤–éƒ¨ç±»ï¼Œç”¨äºè°ƒç”¨å¤–éƒ¨ç±»çš„æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$redis</span> = <span class="literal">null</span>, <span class="variable">$key</span> = <span class="string">&#x27;&#x27;</span>, <span class="variable">$extClass</span> = <span class="literal">null</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;redis = <span class="variable">$redis</span> ? <span class="variable">$redis</span> : <span class="title function_ invoke__">redis</span>(<span class="string">&quot;REDIS_COMMON&quot;</span>);</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;_key = <span class="variable">$key</span> ? <span class="string">&#x27;:&#x27;</span> . <span class="variable">$key</span> : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;extClass = <span class="variable">$extClass</span> ? <span class="variable">$extClass</span> : <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">parent</span>::<span class="title function_ invoke__">__construct</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®è¯»å–çš„æ•æ„Ÿè¯åº“</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> null $sensitiveWords</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array|void</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getSensitiveWords</span>(<span class="params"><span class="variable">$sensitiveWords</span> = <span class="literal">null</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$redisKey</span> = <span class="string">&#x27;SensitiveWords&#x27;</span> . <span class="variable language_">$this</span>-&gt;_key;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;redis-&gt;<span class="title function_ invoke__">exists</span>(<span class="variable">$redisKey</span>))&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;trieTreeMap = <span class="title function_ invoke__">json_decode</span>(<span class="variable">$this</span>-&gt;redis-&gt;<span class="title function_ invoke__">get</span>(<span class="variable">$redisKey</span>),<span class="literal">true</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">// å¦‚æœå¤–éƒ¨æœ‰å£°æ˜æŒ‡å®šæ–¹æ³•ï¼Œåˆ™ä½¿ç”¨å£°æ˜æ–¹æ³•è¿”å›çš„æ•°æ®ä½œä¸ºæ•æ„Ÿè¯åº“</span></span><br><span class="line">            <span class="comment">// ç”±äºç›®å‰åªæœ‰sys_filterDaoè°ƒç”¨ï¼Œæ‰€ä»¥ä¸ä»æ•æ„Ÿè¯æ–‡ä»¶ä¸­è¯»å–</span></span><br><span class="line">            <span class="variable">$sensitiveWordsList</span> = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;extClass &amp;&amp; <span class="title function_ invoke__">method_exists</span>(<span class="variable">$this</span>-&gt;extClass, <span class="string">&#x27;filterRead&#x27;</span>)) &#123;</span><br><span class="line">                <span class="variable">$sensitiveWordsList</span> = <span class="variable language_">$this</span>-&gt;extClass-&gt;<span class="title function_ invoke__">filterRead</span>();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;redis-&gt;<span class="title function_ invoke__">setex</span>(<span class="variable">$redisKey</span>, CACHE_TIME, <span class="title function_ invoke__">json_encode</span>(<span class="built_in">parent</span>::<span class="title function_ invoke__">getSensitiveWords</span>(<span class="variable">$sensitiveWordsList</span>)));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®è¯»å–çš„å¹²æ‰°è¯åº“</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array|void</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getDisturbWords</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$redisKey</span> = <span class="string">&#x27;DisturbWords&#x27;</span> . <span class="variable language_">$this</span>-&gt;_key;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;redis-&gt;<span class="title function_ invoke__">exists</span>(<span class="variable">$redisKey</span>))&#123;</span><br><span class="line"><span class="variable language_">$this</span>-&gt;disturbWords = <span class="variable language_">$this</span>-&gt;redis-&gt;<span class="title function_ invoke__">hGetAll</span>(<span class="string">&#x27;DisturbWords&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable language_">$this</span>-&gt;redis-&gt;<span class="title function_ invoke__">hSet</span>(<span class="variable">$redisKey</span>,<span class="built_in">parent</span>::<span class="title function_ invoke__">getDisturbWords</span>());</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>äºŒã€å®ç°ç±»</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Class Sensitive</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>:</span></span><br><span class="line"><span class="comment"> * æ•æ„Ÿè¯è¿‡æ»¤ç±»</span></span><br><span class="line"><span class="comment"> * é‡‡ç”¨DFAç®—æ³•</span></span><br><span class="line"><span class="comment"> * è£…è½½åæ•°æ®ç»“æ„å¦‚ä¸‹ï¼š å¤§å­—å…¸ä¼šå¯¼è‡´å¤„ç†æ—¶é—´å¾ˆæ…¢ï¼Œå»ºè®®å†™ä¸ªç±»ä¼¼SensitiveByRedisçš„ç±»æ¥ç»§æ‰¿æœ¬ç±»</span></span><br><span class="line"><span class="comment"> *   $words = [</span></span><br><span class="line"><span class="comment"> *       &#x27;å°&#x27; =&gt; [</span></span><br><span class="line"><span class="comment"> *           &#x27;æ—¥&#x27; =&gt; [</span></span><br><span class="line"><span class="comment"> *               &#x27;æœ¬&#x27; =&gt; false,</span></span><br><span class="line"><span class="comment"> *           ],</span></span><br><span class="line"><span class="comment"> *       ],</span></span><br><span class="line"><span class="comment"> *       &#x27;æ—¥&#x27; =&gt; [</span></span><br><span class="line"><span class="comment"> *          &#x27;æœ¬&#x27; =&gt; [</span></span><br><span class="line"><span class="comment"> *              &#x27;é¬¼&#x27; =&gt; [</span></span><br><span class="line"><span class="comment"> *                   &#x27;å­&#x27; =&gt; false,</span></span><br><span class="line"><span class="comment"> *               ],</span></span><br><span class="line"><span class="comment"> *               &#x27;äºº&#x27; =&gt; false,</span></span><br><span class="line"><span class="comment"> *           ],</span></span><br><span class="line"><span class="comment"> *       ],</span></span><br><span class="line"><span class="comment"> *   ];</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * eg:</span></span><br><span class="line"><span class="comment"> *$str = &#x27;æˆ‘çˆ±ä¹   .è¿›  . å¹³æ€»ä¹¦è®°&#x27;;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  æœç´¢$stråŒ…å«çš„å…³é”®è¯</span></span><br><span class="line"><span class="comment"> * $SensitiveClass-&gt;search($str);</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *æ•æ„Ÿè¯æœ‰é»˜è®¤çš„å‰åç¼€</span></span><br><span class="line"><span class="comment"> *  é«˜äº®æ•æ„Ÿè¯ï¼Œå¯å®šåˆ¶ç±»å‹</span></span><br><span class="line"><span class="comment"> * $SensitiveClass-&gt;filter($str,null);</span></span><br><span class="line"><span class="comment"> *  resultï¼š &#x27;æˆ‘çˆ±&lt;em&gt;ä¹   .è¿›  . å¹³&lt;/em&gt;æ€»ä¹¦è®°&#x27;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  ç»Ÿä¸€æ ¼å¼çš„æ•æ„Ÿè¯</span></span><br><span class="line"><span class="comment"> * $SensitiveClass-&gt;filter($str,&#x27;&#x27;,&#x27;&lt;em&gt;æ­¤å¤„ä¸ºæ•æ„Ÿè¯&#x27;,&#x27;&lt;/em&gt;&#x27;);</span></span><br><span class="line"><span class="comment"> *  resultï¼š&#x27;æˆ‘çˆ±&lt;em&gt;æ­¤å¤„ä¸ºæ•æ„Ÿè¯&lt;/em&gt;æ€»ä¹¦è®°&#x27;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  æ›¿æ¢æ•æ„Ÿè¯</span></span><br><span class="line"><span class="comment"> * $SensitiveClass-&gt;filter($str,&#x27;[*]&#x27;,&#x27;&#x27;,&#x27;&#x27;);</span></span><br><span class="line"><span class="comment"> *resultï¼š&#x27;æˆ‘çˆ±[*][*][*][*][*][*][*][*][*][*]æ€»ä¹¦è®°&#x27;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">Class Sensitive</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$redis</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ›¿æ¢ç </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@var</span> string</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="variable">$replaceCode</span> = <span class="string">&#x27;*&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ•æ„Ÿè¯åº“é›†åˆ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@var</span> array</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">protected</span> <span class="variable">$sensitiveWords</span> = <span class="keyword">array</span>();</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$trieTreeMap</span> = <span class="keyword">array</span>();</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¹²æ‰°å› å­é›†åˆ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@var</span> array</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="variable">$disturbWords</span> = <span class="keyword">array</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ„é€ å‡½æ•°ï¼ŒåŠ è½½æ•æ„Ÿè¯åº“åŠå¹²æ‰°è¯åº“</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getSensitiveWords</span>();</span><br><span class="line"><span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getDisturbWords</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è®¾ç½®è¯»å–çš„æ•æ„Ÿè¯åº“</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getSensitiveWords</span>(<span class="params"><span class="variable">$sensitiveWords</span> = <span class="literal">null</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$sensitiveWords</span>) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;sensitiveWords = <span class="variable">$sensitiveWords</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;sensitiveWords = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">readFile</span>(</span><br><span class="line">                <span class="keyword">array</span>(</span><br><span class="line">                    ROOT_PATH . <span class="string">&quot;includes/class/SensitiveWords.dic&quot;</span></span><br><span class="line">                )</span><br><span class="line">            );</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç”ŸæˆTrieTree</span></span><br><span class="line"><span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">formatTrieTree</span>(<span class="variable">$this</span>-&gt;sensitiveWords);</span><br><span class="line"><span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;trieTreeMap;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è®¾ç½®è¯»å–çš„å¹²æ‰°è¯åº“</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getDisturbWords</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="variable language_">$this</span>-&gt;disturbWords = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">readFile</span>(</span><br><span class="line"><span class="keyword">array</span>(</span><br><span class="line">ROOT_PATH . <span class="string">&quot;includes/class/SensitiveDistrubs.dic&quot;</span></span><br><span class="line">)</span><br><span class="line">);</span><br><span class="line"><span class="comment">//ä¸ºäº†é¿å…æœ‰äº›ç¼–è¾‘å™¨åœ¨å¹²æ‰°è¯çš„è¯åº“ä¸­åŠ ç©ºæ ¼ä¼šè¢«åˆ é™¤ï¼Œè¿™é‡Œå•ç‹¬å¯¹ç©ºæ ¼è¿›è¡Œå¤„ç†</span></span><br><span class="line"><span class="variable language_">$this</span>-&gt;disturbWords[] = <span class="string">&#x27; &#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;disturbWords;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è¯»å–è¯åº“</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> array $paths</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">readFile</span>(<span class="params"><span class="variable">$paths</span></span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">is_array</span>(<span class="variable">$paths</span>)) <span class="keyword">return</span> <span class="keyword">array</span>();</span><br><span class="line"><span class="variable">$data</span> = <span class="keyword">array</span>();</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$paths</span> <span class="keyword">as</span> <span class="variable">$path</span>)&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">is_file</span>(<span class="variable">$path</span>))&#123;</span><br><span class="line"><span class="variable">$t</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$path</span>);</span><br><span class="line"><span class="variable">$t</span> = <span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;\r&quot;</span>, <span class="string">&quot;\n&quot;</span>), <span class="string">&quot;,&quot;</span>, <span class="variable">$t</span>);</span><br><span class="line"><span class="variable">$list</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&quot;,&quot;</span>,<span class="variable">$t</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">is_array</span>(<span class="variable">$list</span>))&#123;</span><br><span class="line"><span class="variable">$data</span>=<span class="title function_ invoke__">array_merge</span>(<span class="variable">$data</span>,<span class="variable">$list</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$data</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è½¬åŒ–æˆå­—å…¸æ ‘</span></span><br><span class="line"><span class="comment">     * [&#x27;æ•&#x27; =&gt; [&#x27;æ„Ÿ&#x27; =&gt; [&#x27;è¯&#x27; =&gt; false]]]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> array $wordsList</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">formatTrieTree</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$wordsList</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$wordsList</span> <span class="keyword">as</span> <span class="variable">$words</span>) &#123;</span><br><span class="line"><span class="variable">$nowWords</span> = &amp;<span class="variable language_">$this</span>-&gt;trieTreeMap;</span><br><span class="line"><span class="variable">$len</span> = <span class="title function_ invoke__">mb_strlen</span>(<span class="variable">$words</span>, <span class="string">&#x27;utf-8&#x27;</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line"><span class="variable">$word</span> = <span class="title function_ invoke__">mb_substr</span>(<span class="variable">$words</span>, <span class="variable">$i</span>, <span class="number">1</span>, <span class="string">&#x27;utf-8&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$nowWords</span>[<span class="variable">$word</span>])) &#123;</span><br><span class="line"><span class="variable">$nowWords</span>[<span class="variable">$word</span>] = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// æ³¨é‡Šæœ‰è¯¯çš„è¯ï¼Œè‡ªè¡Œä¿®æ”¹</span></span><br><span class="line">                <span class="comment">// æŒ‡é’ˆå›åˆ°æ•°ç»„ç¬¬ä¸€ä½</span></span><br><span class="line">                <span class="comment">// ç¬¬ä¸€æ¬¡æ‰§è¡ŒæŒ‡å‘&quot;æ•&quot;, å³[&#x27;æ•&#x27; =&gt; false]çš„falseï¼Œ</span></span><br><span class="line">                <span class="comment">// ç¬¬äºŒæ¬¡æ‰§è¡Œæ‰§è¡Œæ„Ÿï¼Œå³[&#x27;æ•&#x27; =&gt; [&#x27;æ„Ÿ&#x27; =&gt; false]çš„false,ä»¥æ­¤ç±»æ¨</span></span><br><span class="line"><span class="variable">$nowWords</span> = &amp;<span class="variable">$nowWords</span>[<span class="variable">$word</span>];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŸ¥æ‰¾å¯¹åº”æ•æ„Ÿè¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $txt</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">search</span>(<span class="params"><span class="variable">$txt</span>, <span class="variable">$hasReplace</span>=<span class="literal">false</span>, &amp;<span class="variable">$replaceCodeList</span> = <span class="keyword">array</span>(<span class="params"></span>), <span class="variable">$prefix</span> = <span class="string">&#x27;&#x27;</span>, <span class="variable">$postfix</span> = <span class="string">&#x27;&#x27;</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$wordsList</span> = <span class="keyword">array</span>();</span><br><span class="line"><span class="variable">$txtLength</span> = <span class="title function_ invoke__">mb_strlen</span>(<span class="variable">$txt</span>, <span class="string">&#x27;utf-8&#x27;</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$txtLength</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line"><span class="variable">$wordLength</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">checkWord</span>(<span class="variable">$txt</span>, <span class="variable">$i</span>, <span class="variable">$txtLength</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$wordLength</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// æå–åŒ¹é…çš„å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="variable">$words</span> = <span class="title function_ invoke__">mb_substr</span>(<span class="variable">$txt</span>, <span class="variable">$i</span>, <span class="variable">$wordLength</span>, <span class="string">&#x27;utf-8&#x27;</span>);</span><br><span class="line"><span class="variable">$wordsList</span>[] = <span class="variable">$words</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$hasReplace</span>)&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;replaceCode === <span class="literal">NULL</span>)&#123;</span><br><span class="line"><span class="variable">$replaceCodeList</span>[] = <span class="variable">$prefix</span>.<span class="variable">$words</span>.<span class="variable">$postfix</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$replaceCodeList</span>[] = <span class="variable">$prefix</span>.<span class="title function_ invoke__">str_repeat</span>(<span class="variable">$this</span>-&gt;replaceCode, <span class="title function_ invoke__">mb_strlen</span>(<span class="variable">$words</span>, <span class="string">&#x27;utf-8&#x27;</span>)).<span class="variable">$postfix</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$i</span> += <span class="variable">$wordLength</span> - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$wordsList</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è¿‡æ»¤æ•æ„Ÿè¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $txt</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> mixed</span></span><br><span class="line"><span class="comment"> * $replaceCode  NULL:ä¸æ›¿æ¢, &#x27;&#x27;:ç›´æ¥è¿‡æ»¤æ‰ï¼Œ &#x27;[*]&#x27;:ç”¨[*]æ›¿æ¢</span></span><br><span class="line"><span class="comment"> * $prefix å‰ç¼€  ç”¨äºé«˜äº®æˆ–æç¤º</span></span><br><span class="line"><span class="comment"> * $postfix åç¼€ ç”¨äºé«˜äº®æˆ–æç¤º</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$txt</span>,<span class="variable">$replaceCode</span> = <span class="string">&#x27;*&#x27;</span>,<span class="variable">$prefix</span> = <span class="string">&#x27;&lt;highlight&gt;&#x27;</span>,<span class="variable">$postfix</span>=<span class="string">&#x27;&lt;/highlight&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable language_">$this</span>-&gt;replaceCode = <span class="variable">$replaceCode</span>;</span><br><span class="line"><span class="variable">$replaceCodeList</span> = <span class="keyword">array</span>();</span><br><span class="line"><span class="variable">$wordsList</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">search</span>(<span class="variable">$txt</span>, <span class="literal">true</span>, <span class="variable">$replaceCodeList</span>,<span class="variable">$prefix</span>,<span class="variable">$postfix</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$wordsList</span>)) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$txt</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">str_replace</span>(<span class="variable">$wordsList</span>, <span class="variable">$replaceCodeList</span>, <span class="variable">$txt</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ•æ„Ÿè¯æ£€æµ‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $txt</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $beginIndex</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $length</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> int</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">checkWord</span>(<span class="params"><span class="variable">$txt</span>, <span class="variable">$beginIndex</span>, <span class="variable">$length</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$flag</span> = <span class="literal">false</span>; <span class="comment">// æ˜¯å¦åœ¨æœ€åä¸€ä½</span></span><br><span class="line"><span class="variable">$wordLength</span> = <span class="number">0</span>; <span class="comment">// åŒ¹é…æ¬¡æ•°</span></span><br><span class="line"><span class="variable">$trieTree</span> = &amp;<span class="variable language_">$this</span>-&gt;trieTreeMap;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="variable">$beginIndex</span>; <span class="variable">$i</span> &lt; <span class="variable">$length</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line"><span class="variable">$word</span> = <span class="title function_ invoke__">mb_substr</span>(<span class="variable">$txt</span>, <span class="variable">$i</span>, <span class="number">1</span>, <span class="string">&#x27;utf-8&#x27;</span>);</span><br><span class="line"><span class="comment">// è·³è¿‡å¹²æ‰°è¯</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">checkDisturb</span>(<span class="variable">$word</span>)) &#123;</span><br><span class="line"><span class="variable">$wordLength</span>++;</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$trieTree</span>[<span class="variable">$word</span>])) &#123;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$wordLength</span>++;</span><br><span class="line"><span class="comment">// åˆ¤æ–­æ˜¯å¦å…¨éƒ¨éå†å®Œæ ‘å¯¹åº”å­é›†</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$trieTree</span>[<span class="variable">$word</span>] !== <span class="literal">false</span>) &#123;</span><br><span class="line"><span class="variable">$trieTree</span> = &amp;<span class="variable">$trieTree</span>[<span class="variable">$word</span>];</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="variable">$flag</span> = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$flag</span>) &#123;</span><br><span class="line">            <span class="variable">$wordLength</span> = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$wordLength</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¹²æ‰°å› å­æ£€æµ‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $word</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> bool</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">checkDisturb</span>(<span class="params"><span class="variable">$word</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">in_array</span>(<span class="variable">$word</span>, <span class="variable">$this</span>-&gt;disturbWords);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gitæ–‡ä»¶è¡Œå°¾ç»“æŸç¬¦å¤„ç†</title>
      <link href="/posts/fb0999de.html"/>
      <url>/posts/fb0999de.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>@link <a href="https://enderhoshi.github.io/2018/11/28/Git%E5%BF%BD%E7%95%A5%E6%96%87%E4%BB%B6%E5%92%8C%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%B0%BE%E9%83%A8%E6%8D%A2%E8%A1%8C%E7%AC%A6%E9%97%AE%E9%A2%98/">åŸæ–‡: Gitå¿½ç•¥æ–‡ä»¶å’Œæ“ä½œç³»ç»Ÿå°¾éƒ¨æ¢è¡Œç¬¦é—®é¢˜</a></p><p>å‡å¦‚ä½ æ­£åœ¨Windowsä¸Šå†™ç¨‹åºï¼Œåˆæˆ–è€…ä½ æ­£åœ¨å’Œå…¶ä»–äººåˆä½œï¼Œä»–ä»¬åœ¨Windowsä¸Šç¼–ç¨‹ï¼Œè€Œä½ å´åœ¨å…¶ä»–ç³»ç»Ÿä¸Šï¼Œåœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œå°±å¯èƒ½ä¼šé‡åˆ°è¡Œå°¾ç»“æŸç¬¦é—®é¢˜ï¼Œè¿™æ˜¯å› ä¸ºWindowsä½¿ç”¨å›è½¦å’Œæ¢è¡Œä¸¤ä¸ªå­—ç¬¦æ¥ç»“æŸä¸€è¡Œï¼Œè€ŒMacå’ŒLinuxåªä½¿ç”¨æ¢è¡Œç¬¦ä¸€ä¸ªå­—ç¬¦ã€‚è™½ç„¶è¿™æ˜¯å°é—®é¢˜ï¼Œä½†å®ƒä¼šæå¤§åœ°æ‰°ä¹±è·¨å¹³å°åä½œï¼Œåœ¨æäº¤æ—¶äº§ç”Ÿéå¸¸å¤šçš„å†²çª</p><p>å¯¹äºä¸åŒçš„å¹³å°ï¼Œæœ‰ä¸åŒçš„å¤„ç†æ–¹æ¡ˆï¼š<br>Gitå¯ä»¥åœ¨ä½ æäº¤æ—¶è‡ªåŠ¨åœ°æŠŠè¡Œç»“æŸç¬¦CRLFè½¬æ¢æˆLFï¼Œè€Œåœ¨ç­¾å‡ºä»£ç æ—¶æŠŠLFè½¬æ¢æˆCRLFã€‚è®¾ç½®core.autocrlfæ¥æ‰“å¼€æ­¤é¡¹åŠŸèƒ½ï¼Œå¦‚æœæ˜¯åœ¨Windowsç³»ç»Ÿä¸Šï¼Œå°±æŠŠå®ƒè®¾ç½®æˆtrueï¼Œè¿™æ ·å½“ç­¾å‡ºä»£ç æ—¶ï¼ŒLFä¼šè¢«è½¬æ¢æˆCRLFï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git config --global core.autocrlf <span class="literal">true</span></span></span><br></pre></td></tr></table></figure><p>Linuxæˆ–Macç³»ç»Ÿä½¿ç”¨LFä½œä¸ºè¡Œç»“æŸç¬¦ï¼Œå› æ­¤ä½ ä¸æƒ³Gitåœ¨ç­¾å‡ºæ–‡ä»¶æ—¶è¿›è¡Œè‡ªåŠ¨çš„è½¬æ¢ï¼›å½“ä¸€ä¸ªä»¥CRLFä¸ºè¡Œç»“æŸç¬¦çš„æ–‡ä»¶ä¸å°å¿ƒè¢«å¼•å…¥æ—¶ä½ è‚¯å®šæƒ³è¿›è¡Œä¿®æ­£ï¼ŒæŠŠcore.autocrlfè®¾ç½®æˆinputæ¥å‘Šè¯‰Gitåœ¨æäº¤æ—¶æŠŠCRLFè½¬æ¢æˆLFï¼Œç­¾å‡ºæ—¶ä¸è½¬æ¢ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git config --global core.autocrlf input</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·ä¼šåœ¨Windowsç³»ç»Ÿä¸Šçš„ç­¾å‡ºæ–‡ä»¶ä¸­ä¿ç•™CRLFï¼Œä¼šåœ¨Macå’ŒLinuxç³»ç»Ÿä¸Šï¼ŒåŒ…æ‹¬ä»“åº“ä¸­ä¿ç•™LFã€‚</p><p>å¦‚æœä½ æ˜¯Windowsç¨‹åºå‘˜ï¼Œä¸”æ­£åœ¨å¼€å‘ä»…è¿è¡Œåœ¨Windowsä¸Šçš„é¡¹ç›®ï¼Œå¯ä»¥è®¾ç½®falseå–æ¶ˆæ­¤åŠŸèƒ½ï¼ŒæŠŠå›è½¦ç¬¦è®°å½•åœ¨åº“ä¸­ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git config --global core.autocrlf <span class="literal">false</span></span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä¸‰æ¡æ€»ç»“èµ·æ¥å°±æ˜¯ä¸‹é¢çš„æƒ…å½¢ï¼Œxæ˜¯ä½ å½“å‰ä½¿ç”¨çš„ç³»ç»Ÿæ‰€ä½¿ç”¨çš„æ¢è¡Œæ–¹å¼</p><figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>) <span class="literal">true</span>:             x -&gt; <span class="type">LF</span> -&gt; <span class="type">CRLF</span></span><br><span class="line"><span class="number">2</span>) input:            x -&gt; <span class="type">LF</span> -&gt; <span class="type">LF</span></span><br><span class="line"><span class="number">3</span>) <span class="literal">false</span>:            x -&gt; x -&gt; x</span><br></pre></td></tr></table></figure><p>é¡¹ç›®å·²ç»å­˜åœ¨æ¢è¡Œç¬¦ä¸åŒçš„é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼š</p><p>å¦‚æœå½“å‰å¼€å‘æœ‰å¤šä¸ªåˆ†æ”¯ä¸”å„åˆ†æ”¯ä¸åŒæ­¥ï¼Œéœ€è¦æ¯ä¸ªåˆ†æ”¯è¿›è¡Œä¸€æ¬¡è½¬æ¢<br>å¦‚æœåªæœ‰ä¸€ä¸ªåˆ†æ”¯æˆ–å¤šä¸ªåˆ†æ”¯å¤„äºåŒä¸€èŠ‚ç‚¹ã€‚å¯ä»¥ä»masteråˆ‡æ¢ä¸€ä¸ªæ–°åˆ†æ”¯ï¼Œè¿›è¡Œè½¬æ¢ï¼Œç„¶åcommit ï¼Œå°†æ­¤åˆ†æ”¯åˆå¹¶åˆ°æ‰€æœ‰åˆ†æ”¯ã€‚<br>å°†ä¿®æ”¹è¿‡çš„åˆ†æ”¯pushåˆ°gitlabï¼Œè®©å…¶ä»–æˆå‘˜æ›´æ–°ä»£ç å³å¯ã€‚<br>Ps:ç”±äºæ¯ä¸ªäººç³»ç»Ÿä¸åŒæˆ–è€…å°±æ˜¯gitçš„é—®é¢˜ï¼Œå¯èƒ½å‡ºç°æ›´æ–°å®Œä»£ç æ¢è¡Œç¬¦ä¸å˜ï¼Œè¿™æ—¶ä»¥æœåŠ¡å™¨ä¸Šçš„ä»£ç ä¸ºå‡†é‡æ–°cloneä¸€ä»½æœ€æ–°ä»£ç å³å¯</p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¸¸ç”¨å‘½ä»¤ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>docker Remote API</title>
      <link href="/posts/2fce4b74.html"/>
      <url>/posts/2fce4b74.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="Dockerå¸¸è§ç«¯å£"><a href="#Dockerå¸¸è§ç«¯å£" class="headerlink" title="Dockerå¸¸è§ç«¯å£"></a>Dockerå¸¸è§ç«¯å£</h1><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2375</span><span class="string">ï¼šæœªåŠ å¯†çš„docker</span> <span class="string">socket,è¿œç¨‹rootæ— å¯†ç è®¿é—®ä¸»æœº</span></span><br><span class="line"><span class="number">2376</span><span class="string">ï¼štlsåŠ å¯†å¥—æ¥å­—,å¾ˆå¯èƒ½è¿™æ˜¯æ‚¨çš„CIæœåŠ¡å™¨4243ç«¯å£ä½œä¸ºhttps</span> <span class="number">443</span><span class="string">ç«¯å£çš„ä¿®æ”¹</span></span><br><span class="line"><span class="number">2377</span><span class="string">ï¼šç¾¤é›†æ¨¡å¼å¥—æ¥å­—,é€‚ç”¨äºç¾¤é›†ç®¡ç†å™¨,ä¸é€‚ç”¨äºdockerå®¢æˆ·ç«¯</span></span><br><span class="line"><span class="number">5000</span><span class="string">ï¼šdockeræ³¨å†ŒæœåŠ¡</span></span><br><span class="line"><span class="number">4789</span><span class="string">å’Œ7946ï¼šè¦†ç›–ç½‘ç»œ</span></span><br></pre></td></tr></table></figure><h1 id="å¼€å¯é…ç½®è¿œç¨‹è®¿é—®API"><a href="#å¼€å¯é…ç½®è¿œç¨‹è®¿é—®API" class="headerlink" title="å¼€å¯é…ç½®è¿œç¨‹è®¿é—®API"></a>å¼€å¯é…ç½®è¿œç¨‹è®¿é—®API</h1><p>æ–¹æ³•ä¸€ã€</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/default/docker</span><br><span class="line">åŠ å…¥ä¸‹é¢ä¸€è¡Œ</span><br><span class="line">DOCKER_OPTS=&quot;-H tcp://0.0.0.0:2375&quot;</span><br><span class="line">é‡å¯dockerå³å¯ï¼š</span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure><p>PS:è¿™æ˜¯ç½‘ä¸Šç»™çš„é…ç½®æ–¹æ³•ï¼Œä¹Ÿæ˜¯è¿™ç§ç®€å•é…ç½®è®©Docker DaemonæŠŠæœåŠ¡æš´éœ²åœ¨tcpçš„2375ç«¯å£ä¸Šï¼Œè¿™æ ·å°±å¯ä»¥åœ¨ç½‘ç»œä¸Šæ“ä½œDockeräº†ã€‚Dockeræœ¬èº«æ²¡æœ‰èº«ä»½è®¤è¯çš„åŠŸèƒ½ï¼Œåªè¦ç½‘ç»œä¸Šèƒ½è®¿é—®åˆ°æœåŠ¡ç«¯å£ï¼Œå°±å¯ä»¥æ“ä½œDockerã€‚</p><p>æ–¹æ³•äºŒã€<br>åœ¨&#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;docker.serviceï¼Œé…ç½®è¿œç¨‹è®¿é—®ã€‚<br>ä¸»è¦æ˜¯åœ¨[Service]è¿™ä¸ªéƒ¨åˆ†ï¼ŒåŠ ä¸Šä¸‹é¢ä¸¤ä¸ªå‚æ•°<br>vim &#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;docker.service</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[Service]</span><br><span class="line">ExecStart=</span><br><span class="line">ExecStart=<span class="regexp">/usr/</span>bin<span class="regexp">/dockerd -H tcp:/</span><span class="regexp">/0.0.0.0:2375 -H unix:/</span><span class="regexp">/var/</span>run/docker.sock</span><br><span class="line"><span class="comment"># å¦‚æœæ˜¯è¿æ¥è™šæ‹Ÿæœºä¸­çš„dockerï¼Œå¿…é¡»ä½¿ç”¨æ˜ç¡®çš„ipï¼Œå¤–éƒ¨å®¿ä¸»æœºæ‰èƒ½é€šè¿‡docker -H è®¿é—®</span></span><br><span class="line">ExecStart=<span class="regexp">/usr/</span>bin<span class="regexp">/dockerd -H tcp:/</span><span class="regexp">/172.28.128.3:2375 -H unix:/</span><span class="regexp">/var/</span>run/docker.sock</span><br></pre></td></tr></table></figure><p>é‡å¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure><p>æ–¹æ³•ä¸‰ã€<br>ä¸‹é¢ä¿®æ”¹daemon.jsonçš„é…ç½®</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/docker/daemon<span class="selector-class">.json</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;hosts&quot;</span>: <span class="selector-attr">[<span class="string">&quot;tcp://0.0.0.0:2375&quot;</span>, <span class="string">&quot;unix:///var/run/docker.sock&quot;</span>]</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€œunix:&#x2F;&#x2F;&#x2F;var&#x2F;run&#x2F;docker.sockâ€ï¼šunix socketï¼Œæœ¬åœ°å®¢æˆ·ç«¯å°†é€šè¿‡è¿™ä¸ªæ¥è¿æ¥ Docker Daemonã€‚<br>â€œtcp:&#x2F;&#x2F;0.0.0.0:2375â€ï¼štcp socketï¼Œè¡¨ç¤ºå…è®¸ä»»ä½•è¿œç¨‹å®¢æˆ·ç«¯é€šè¿‡ 2375 ç«¯å£è¿æ¥ Docker Daemonã€‚</p><p>ä¿®æ”¹é…ç½®ä»¥å,ç„¶åè®©dockeré‡æ–°è¯»å–é…ç½®æ–‡ä»¶,å¹¶é‡å¯dockeræœåŠ¡</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure><h1 id="æŸ¥çœ‹dockerè¿›ç¨‹ï¼š"><a href="#æŸ¥çœ‹dockerè¿›ç¨‹ï¼š" class="headerlink" title="æŸ¥çœ‹dockerè¿›ç¨‹ï¼š"></a>æŸ¥çœ‹dockerè¿›ç¨‹ï¼š</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@slaver2 ~]<span class="comment"># ps -ef|grep docker</span></span><br><span class="line">root      <span class="number">44221</span>      <span class="number">1</span>  <span class="number">1</span> <span class="number">18</span>:<span class="number">16</span> ?        <span class="number">00</span>:<span class="number">00</span>:<span class="number">06</span> <span class="regexp">/usr/</span>bin<span class="regexp">/dockerd -H tcp:/</span><span class="regexp">/0.0.0.0:2375 -H unix:/</span><span class="regexp">/var/</span>run/docker.sock</span><br></pre></td></tr></table></figure><p>Dockerå®ˆæŠ¤è¿›ç¨‹æ‰“å¼€ä¸€ä¸ªHTTP Socket,è¿™æ ·æ‰èƒ½å®ç°è¿œç¨‹é€šä¿¡</p><h1 id="ç®€å•ä½¿ç”¨"><a href="#ç®€å•ä½¿ç”¨" class="headerlink" title="ç®€å•ä½¿ç”¨"></a>ç®€å•ä½¿ç”¨</h1><p>-Hä¸ºè¿æ¥ç›®æ ‡ä¸»æœºdockeræœåŠ¡<br>æŸ¥çœ‹dockerç‰ˆæœ¬</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@slaver2 <span class="operator">/</span>]<span class="comment"># docker -H tcp://172.28.128.3:2375 version</span></span><br><span class="line"><span class="params">Client:</span> Docker Engine <span class="operator">-</span> Community</span><br><span class="line"> <span class="params">Version:</span>           <span class="number">19.03</span>.<span class="number">0</span></span><br><span class="line"> API <span class="params">version:</span>       <span class="number">1.40</span></span><br><span class="line"> Go <span class="params">version:</span>        go1.<span class="number">12.5</span></span><br><span class="line"> Git <span class="params">commit:</span>        aeac9490dc</span><br><span class="line"> <span class="params">Built:</span>             Wed Jul <span class="number">17</span> <span class="number">18</span>:<span class="number">15</span>:<span class="number">40</span> <span class="number">2019</span></span><br><span class="line"> OS<span class="operator">/</span><span class="params">Arch:</span>           linux<span class="symbol">/amd64</span></span><br><span class="line"> <span class="params">Experimental:</span>      <span class="literal">false</span></span><br><span class="line">Cannot connect to the Docker daemon at tcp:<span class="operator">//</span><span class="number">172.28</span>.<span class="number">128.3</span>:<span class="number">2375</span>. Is the docker daemon running<span class="operator">?</span></span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹é•œåƒåŒ…ï¼š</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@slaver2 <span class="symbol">~]# docker -H tcp</span>:<span class="comment">//172.28.128.3:2375 images</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> Docker </category>
          
          <category> æ–‡æ¡£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å›¾ç‰‡å¤„ç†ç±»</title>
      <link href="/posts/16d3e2fc.html"/>
      <url>/posts/16d3e2fc.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">å›¾ç‰‡å¤„ç†</span></span><br><span class="line"><span class="string">author yfc</span></span><br><span class="line"><span class="string">since 2019/7/31 0031 ä¸Šåˆ 10:41</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageSequence, ImageDraw, ImageFont</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> urllib.request <span class="keyword">as</span> request</span><br><span class="line"><span class="keyword">import</span> imghdr</span><br><span class="line"><span class="keyword">import</span> house.function.common <span class="keyword">as</span> common</span><br><span class="line"><span class="keyword">import</span> house.settings <span class="keyword">as</span> settings</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ImageProcess</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">upYunSetUp</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">import</span> upyun</span><br><span class="line">        <span class="keyword">import</span> house.settings <span class="keyword">as</span> settings</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="variable language_">self</span>.upYunClass = upyun.UpYun(settings.UPYUN_NAME, settings.UPYUN_USER, settings.UPYUN_PWD, timeout=<span class="number">60</span>,</span><br><span class="line">                             endpoint=upyun.ED_AUTO)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">raise</span> e</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">upYunUpload</span>(<span class="params">self, image, <span class="built_in">type</span>, delImg=<span class="literal">None</span></span>):</span><br><span class="line">        timeSec = <span class="built_in">int</span>(time.time())</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> image:</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">204</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;å›¾ç‰‡ä¸ºç©º&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">        image = image.replace(<span class="string">&#x27;\\&#x27;</span>, <span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">        <span class="comment"># è·å–å›¾ç‰‡åç¼€</span></span><br><span class="line">        imageType = image.split(<span class="string">&#x27;.&#x27;</span>)[-<span class="number">1</span>]</span><br><span class="line">        imageName = image.split(<span class="string">&#x27;.&#x27;</span>)[-<span class="number">2</span>]</span><br><span class="line">        fileName = common.myMD5(<span class="string">&#x27;%s%s&#x27;</span> % (imageName, timeSec))[<span class="number">8</span>:-<span class="number">8</span>]</span><br><span class="line">        imageUrl = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span> == <span class="number">1</span>:</span><br><span class="line">            fileName = <span class="string">&#x27;%s.%s&#x27;</span> % (fileName, imageType)</span><br><span class="line">            imageUrl = <span class="string">&#x27;/lp/%s/%s&#x27;</span> % (time.strftime(<span class="string">&#x27;%Y/%m/%d&#x27;</span>, time.localtime(timeSec)), fileName)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="number">2</span>:</span><br><span class="line">            fileName = <span class="string">&#x27;%s.%s&#x27;</span> % (fileName, imageType)</span><br><span class="line">            imageUrl = <span class="string">&#x27;/u/%s/%s&#x27;</span> % ((time.strftime(<span class="string">&#x27;%Y%m%d&#x27;</span>, time.localtime(timeSec)), fileName))</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">type</span>==<span class="number">3</span>:</span><br><span class="line">            fileName = <span class="string">&#x27;%s%s.%s&#x27;</span> % (<span class="built_in">str</span>(fileName)[<span class="number">0</span>:<span class="number">6</span>], common.randomValue(<span class="number">16</span>), imageType)</span><br><span class="line">            imageUrl = <span class="string">&#x27;/%s/%s&#x27;</span> % (time.strftime(<span class="string">&#x27;%Y/%m/%d&#x27;</span>, time.localtime(timeSec)), fileName)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">type</span>==<span class="number">4</span>:</span><br><span class="line">            <span class="comment"># èµ„è®¯</span></span><br><span class="line">            fileName = <span class="string">&#x27;%s%s.%s&#x27;</span> % (<span class="built_in">str</span>(fileName)[<span class="number">0</span>:<span class="number">6</span>], common.randomValue(<span class="number">16</span>), imageType)</span><br><span class="line">            imageUrl = <span class="string">&#x27;/news/%s/%s&#x27;</span> % (time.strftime(<span class="string">&#x27;%Y/%m/%d&#x27;</span>, time.localtime(timeSec)), fileName)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(image, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> fh:</span><br><span class="line">                rsp = <span class="variable language_">self</span>.upYunClass.put(imageUrl, fh)  <span class="comment"># ä¸Šä¼ å›¾ç‰‡ï¼Œè‡ªåŠ¨åˆ›å»ºç›®å½•</span></span><br><span class="line">                time.sleep(<span class="number">0.5</span>)</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> rsp.get(<span class="string">&#x27;content-length&#x27;</span>, <span class="string">&#x27;&#x27;</span>):</span><br><span class="line">                    time.sleep(<span class="number">0.5</span>)</span><br><span class="line">                    <span class="keyword">return</span> &#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">204</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;ä¸Šä¼ å¤±è´¥1&#x27;</span>&#125;</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            errorMsg = <span class="string">&#x27;å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸:%s&#x27;</span> % e</span><br><span class="line">            time.sleep(<span class="number">5</span>)</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">204</span>, <span class="string">&#x27;msg&#x27;</span>: errorMsg&#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># å¦‚æœdelImgæ²¡æœ‰ä¼ å€¼ï¼Œå¹¶ä¸”ç¯å¢ƒä¸ºçº¿ä¸Šç¯å¢ƒï¼Œé»˜è®¤ç§»é™¤ä¸Šä¼ æˆåŠŸçš„å›¾ç‰‡</span></span><br><span class="line">            <span class="keyword">if</span> delImg <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">and</span> settings.delLocalImg:</span><br><span class="line">                delImg = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">if</span> delImg:</span><br><span class="line">                os.remove(image)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            errorMsg = <span class="string">&#x27;å›¾ç‰‡ä¸Šä¼ å,åˆ é™¤å›¾ç‰‡å¼‚å¸¸:%s:%s&#x27;</span> % (image, e)</span><br><span class="line">            common.util_log().errorLog(errorMsg)</span><br><span class="line">            <span class="comment"># return &#123;&#x27;status&#x27;: 204, &#x27;msg&#x27;: errorMsg&#125;</span></span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">200</span>, <span class="string">&#x27;msg&#x27;</span>: imageUrl&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">saveFile</span>(<span class="params">self, data, <span class="built_in">type</span>=<span class="number">1</span>, dirPath=<span class="string">&#x27;/&#x27;</span>, filename=<span class="string">&#x27;&#x27;</span>, fileBasePath=<span class="string">&#x27;&#x27;</span></span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        ä¿å­˜æ–‡ä»¶åˆ°æœ¬åœ°</span></span><br><span class="line"><span class="string">        :param data: æ–‡ä»¶å†…å®¹ | urlåœ°å€</span></span><br><span class="line"><span class="string">        :param type: 1-urlåœ°å€ 2-å†…å®¹</span></span><br><span class="line"><span class="string">        :param filename: è‡ªå®šä¹‰æ–‡ä»¶å, å¦‚æœæ˜¯url, é»˜è®¤å–urlçš„æ–‡ä»¶å</span></span><br><span class="line"><span class="string">        :param dirPath: è‡ªå®šä¹‰ç›®å½•è·¯å¾„ xxx/</span></span><br><span class="line"><span class="string">        :param fileBasePath: åŸºç¡€ç›®å½•è·¯å¾„ /xxx/</span></span><br><span class="line"><span class="string">        :return: /path/filename.xx</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> fileBasePath:</span><br><span class="line">            fileBasePath = settings.ROOT_PATH</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å®Œæ•´è·¯å¾„ä»¥åŠç›¸å¯¹è·¯å¾„</span></span><br><span class="line">        timePath = time.strftime(<span class="string">&#x27;%Y%m%d/&#x27;</span>, time.localtime(time.time()))</span><br><span class="line">        shortPath = dirPath + timePath</span><br><span class="line">        path = fileBasePath + shortPath</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(path):</span><br><span class="line">            os.makedirs(path, mode=<span class="number">0o777</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span> == <span class="number">2</span> <span class="keyword">and</span> <span class="keyword">not</span> filename:</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">204</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;æ–‡ä»¶åä¸ºç©º&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> filename:</span><br><span class="line">            filename = data.split(<span class="string">&#x27;/&#x27;</span>)[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ–‡ä»¶å®Œæ•´è·¯å¾„ä»¥åŠç›¸å¯¹è·¯å¾„</span></span><br><span class="line">        <span class="comment"># å¦‚æœå·²å­˜åœ¨æ–‡ä»¶ç›´æ¥è¿”å›è·¯å¾„</span></span><br><span class="line">        fullFileName = path + filename</span><br><span class="line">        shortFileName = shortPath + filename</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(fullFileName):</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">200</span>, <span class="string">&#x27;msg&#x27;</span>: &#123;<span class="string">&#x27;fullFileName&#x27;</span>: fullFileName, <span class="string">&#x27;shortFileName&#x27;</span>: shortFileName&#125;&#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">type</span> == <span class="number">1</span>:</span><br><span class="line">                <span class="comment"># ç½‘ç»œä¸‹è½½æ–¹å¼ä¿å­˜æ–‡ä»¶</span></span><br><span class="line">                result = request.urlretrieve(data, fullFileName)</span><br><span class="line">            <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="number">2</span>:</span><br><span class="line">                <span class="comment"># è¯»å–äºŒè¿›åˆ¶æ–‡ä»¶ä¿å­˜æ–‡ä»¶</span></span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(fullFileName, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> fh:</span><br><span class="line">                    result = fh.write(data)</span><br><span class="line">            <span class="keyword">if</span> result:</span><br><span class="line">                <span class="comment"># éªŒè¯æ–‡ä»¶æ˜¯å¦å®Œæ•´ å¦‚æœä¸å®Œæ•´è¿”å›None(é€šè¿‡åˆ¤æ–­æ–‡ä»¶å¤´éƒ¨åˆ¤æ–­å›¾ç‰‡ç±»å‹)</span></span><br><span class="line">                <span class="keyword">if</span> imghdr.what(fullFileName) == <span class="literal">None</span>:</span><br><span class="line">                    <span class="keyword">return</span> &#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">204</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;%sæ— æ³•è·å–æ–‡ä»¶ç±»å‹ï¼Œæ–‡ä»¶å¯èƒ½å·²æŸå&#x27;</span> % shortFileName&#125;</span><br><span class="line">                dealRes = <span class="variable language_">self</span>.dealFile(fullFileName, fullFileName)</span><br><span class="line">                <span class="keyword">if</span> dealRes.get(<span class="string">&#x27;status&#x27;</span>, <span class="number">0</span>) == <span class="number">204</span>:</span><br><span class="line">                    <span class="keyword">return</span> dealRes</span><br><span class="line">                <span class="keyword">return</span> &#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">200</span>, <span class="string">&#x27;msg&#x27;</span>: &#123;<span class="string">&#x27;fullFileName&#x27;</span>: fullFileName, <span class="string">&#x27;shortFileName&#x27;</span>: shortFileName&#125;&#125;</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">204</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;%sæ–‡ä»¶å†™å…¥å¤±è´¥:%s&#x27;</span> % (shortFileName, e)&#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">204</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">dealImagePixels</span>(<span class="params">self, imgPath=<span class="string">&#x27;&#x27;</span></span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        è·å–å›¾ç‰‡ä¿¡æ¯ï¼Œæ”¯æŒä¿®æ”¹å›¾ç‰‡é€æ˜åº¦</span></span><br><span class="line"><span class="string">        :param imgPath: å›¾ç‰‡åœ°å€</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> imgPath:</span><br><span class="line">            imgPath = settings.logoPath</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            imgOrigin = Image.<span class="built_in">open</span>(imgPath)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">204</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;æ‰“å¼€logoå›¾ç‰‡é”™è¯¯:%s:%s&#x27;</span> % (imgPath, e)&#125;</span><br><span class="line">        imgWidth, imgHeight = imgOrigin.size</span><br><span class="line">        imgPixelsDict = <span class="built_in">dict</span>()</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(imgWidth):</span><br><span class="line">            <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(imgHeight):</span><br><span class="line">                <span class="comment"># é€šè¿‡åæ ‡ç‚¹ï¼Œè·å–(R, G, B, A)</span></span><br><span class="line">                pixel = imgOrigin.getpixel((x, y))</span><br><span class="line">                <span class="comment"># å»é™¤é€æ˜åº¦ä¸º0çš„åƒç´ </span></span><br><span class="line">                <span class="keyword">if</span> pixel != (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>):</span><br><span class="line">                    imgPixelsDict[(x, y)] = pixel</span><br><span class="line">                    <span class="comment"># ä¿®æ”¹é€æ˜åº¦</span></span><br><span class="line">                    <span class="comment"># imgPixelsDict[(x, y)] = pixel[:3]+(100,)</span></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">&#x27;status&#x27;</span>: <span class="number">200</span>,</span><br><span class="line">            <span class="string">&#x27;msg&#x27;</span>: &#123;</span><br><span class="line">                <span class="string">&#x27;origin&#x27;</span>: imgOrigin,</span><br><span class="line">                <span class="string">&#x27;width&#x27;</span>: imgWidth,</span><br><span class="line">                <span class="string">&#x27;height&#x27;</span>: imgHeight,</span><br><span class="line">                <span class="string">&#x27;pixelsDict&#x27;</span>: imgPixelsDict</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">blendPixel</span>(<span class="params">self, pixel1, pixel2</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        æ··åˆé¢œè‰²(R, G, B, A)</span></span><br><span class="line"><span class="string">        :param pixel1: å›¾ç‰‡åƒç´ </span></span><br><span class="line"><span class="string">        :param pixel2: å›¾ç‰‡åƒç´ </span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="comment"># alpha é€æ˜åº¦</span></span><br><span class="line">        alpha1 = <span class="number">256</span> - pixel2[<span class="number">3</span>]</span><br><span class="line">        alpha2 = pixel2[<span class="number">3</span>] - (alpha1 * pixel2[<span class="number">3</span>]) / <span class="number">256.0</span></span><br><span class="line">        alpha = alpha1 + alpha2</span><br><span class="line">        pixel = (</span><br><span class="line">            <span class="built_in">int</span>((alpha1 * pixel1[<span class="number">0</span>] + alpha2 * pixel2[<span class="number">0</span>]) / alpha),</span><br><span class="line">            <span class="built_in">int</span>((alpha1 * pixel1[<span class="number">1</span>] + alpha2 * pixel2[<span class="number">1</span>]) / alpha),</span><br><span class="line">            <span class="built_in">int</span>((alpha1 * pixel1[<span class="number">2</span>] + alpha2 * pixel2[<span class="number">2</span>]) / alpha),</span><br><span class="line">            <span class="built_in">int</span>(alpha)</span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">return</span> pixel</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">dealImage</span>(<span class="params">self, image, logoPixelsDict, offTop=<span class="literal">None</span>, offLeft=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        å¤„ç†å›¾ç‰‡ï¼Œå°†å›¾ç‰‡</span></span><br><span class="line"><span class="string">        :param image: å›¾ç‰‡èµ„æº</span></span><br><span class="line"><span class="string">        :param logoPixelsDict: logoå›¾ç‰‡åƒç´ </span></span><br><span class="line"><span class="string">        :param offTop: yåŸºäºimageåç§»é‡</span></span><br><span class="line"><span class="string">        :param offLeft: xåŸºäºimageåç§»é‡</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="comment"># å¦‚æœå›¾ç‰‡å°ºå¯¸å°äºæ°´å°å›¾ç‰‡ï¼Œä¸åŠ æ°´å°</span></span><br><span class="line">        <span class="keyword">for</span> coords, logoPixel <span class="keyword">in</span> logoPixelsDict.items():</span><br><span class="line">            <span class="comment"># xè½´åæ ‡</span></span><br><span class="line">            coords_x = (coords[<span class="number">0</span>] + offLeft)</span><br><span class="line">            <span class="comment"># yè½´åæ ‡</span></span><br><span class="line">            coords_y = (coords[<span class="number">1</span>] + offTop)</span><br><span class="line">            imagePixel = image.getpixel((coords_x, coords_y))</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">isinstance</span>(imagePixel, <span class="built_in">tuple</span>) <span class="keyword">and</span> <span class="built_in">len</span>(imagePixel) &gt; <span class="number">2</span>):</span><br><span class="line">                <span class="comment"># å°†åæ ‡çš„RGBAä¿®æ”¹ä¸ºæ··åˆåçš„RGBA</span></span><br><span class="line">                image.putpixel((coords_x, coords_y), <span class="variable language_">self</span>.blendPixel(imagePixel, logoPixel))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> image</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">dealFile</span>(<span class="params">self, filePath, outFilePath=<span class="string">&#x27;&#x27;</span>,logoDict=<span class="literal">None</span>, offX=-<span class="number">5</span>, offY=-<span class="number">5</span></span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        å›¾ç‰‡å¢åŠ æ°´å°, éå›¾ç‰‡</span></span><br><span class="line"><span class="string">        :param filePath: å›¾ç‰‡è·¯å¾„</span></span><br><span class="line"><span class="string">        :param logoDict: logoå›¾ç‰‡ä¿¡æ¯</span></span><br><span class="line"><span class="string">        :param offX: logoå¯¹äºå›¾ç‰‡xåç§»é‡</span></span><br><span class="line"><span class="string">        :param offY: logoå¯¹äºå›¾ç‰‡yåç§»é‡</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="comment"># éå›¾ç‰‡ç±»å‹å›¾ç‰‡ä¸è¿›è¡Œå¤„ç†</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> filePath <span class="keyword">or</span> <span class="keyword">not</span> filePath.endswith((<span class="string">&#x27;.gif&#x27;</span>, <span class="string">&#x27;.jpg&#x27;</span>, <span class="string">&#x27;.png&#x27;</span>, <span class="string">&#x27;.jpeg&#x27;</span>)):</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">204</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;æ–‡ä»¶æ ¼å¼é”™è¯¯&#x27;</span>&#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            imgOrign = Image.<span class="built_in">open</span>(filePath)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">204</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;dealFile æ‰“å¼€å›¾ç‰‡å¤±è´¥:%s&#x27;</span> % filePath&#125;</span><br><span class="line">        imgWidth, imgHeight = imgOrign.size</span><br><span class="line">        _, fileType = os.path.splitext(filePath)</span><br><span class="line">        fileType = fileType.lower()</span><br><span class="line">        basename = os.path.basename(filePath)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å¦‚æœæ²¡æœ‰é…ç½®è¾“å‡ºæ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤ä¸ºè¦†ç›–åŸæœ¬çš„è·¯å¾„</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> outFilePath:</span><br><span class="line">            outFilePath = filePath</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># å¦‚æœå­˜åœ¨è¾“å‡ºæ–‡ä»¶è·¯å¾„ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºæ–‡ä»¶ï¼Œå¦‚æœéæ–‡ä»¶åˆ™ä¸ºæ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶åä¸ºåŸæ–‡ä»¶æ–‡ä»¶å</span></span><br><span class="line">            _, outFileType = os.path.splitext(outFilePath)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> outFileType:</span><br><span class="line">                outFilePath = <span class="string">&#x27;%s%s&#x27;</span> % (outFilePath, basename)</span><br><span class="line">        <span class="comment"># å¦‚æœä¸å­˜åœ¨è¾“å‡ºç›®å½•ï¼Œåˆ›å»ºè¾“å‡ºç›®å½•</span></span><br><span class="line">        outFileDir = os.path.dirname(outFilePath)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(outFileDir):</span><br><span class="line">            os.makedirs(outFileDir, mode=<span class="number">0o777</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> logoDict:</span><br><span class="line">            logoRes = <span class="variable language_">self</span>.dealImagePixels()</span><br><span class="line">            <span class="keyword">if</span> logoRes.get(<span class="string">&#x27;status&#x27;</span>, <span class="number">0</span>) == <span class="number">204</span>:</span><br><span class="line">                <span class="keyword">return</span> logoRes</span><br><span class="line">            logoDict = logoRes.get(<span class="string">&#x27;msg&#x27;</span>, &#123;&#125;)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> logoDict:</span><br><span class="line">                <span class="keyword">return</span> &#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">204</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;dealFile è·å–logoå›¾ç‰‡å¤±è´¥:%s&#x27;</span> % filePath&#125;</span><br><span class="line"></span><br><span class="line">        logoOrigin = logoDict.get(<span class="string">&#x27;origin&#x27;</span>)</span><br><span class="line">        logoWidth = logoDict.get(<span class="string">&#x27;width&#x27;</span>)</span><br><span class="line">        logoHeight = logoDict.get(<span class="string">&#x27;height&#x27;</span>)</span><br><span class="line">        logoPixelsDict = logoDict.get(<span class="string">&#x27;pixelsDict&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># if imgOrign.mode in (&quot;RGBA&quot;, &quot;P&quot;):</span></span><br><span class="line">        <span class="comment"># jpgæ ¼å¼ä¸æ”¯æŒé€æ˜åº¦ï¼Œéœ€è¦è½¬æ¢</span></span><br><span class="line">        <span class="keyword">if</span> fileType == <span class="string">&#x27;.jpg&#x27;</span>:</span><br><span class="line">            imgOrign = imgOrign.convert(<span class="string">&quot;RGB&quot;</span>)</span><br><span class="line">        <span class="comment"># å¦‚æœå›¾ç‰‡å°ºå¯¸å°äºæ°´å°å›¾ç‰‡ï¼Œä¸åŠ æ°´å°ï¼Œç›´æ¥è¿”å›åŸå›¾</span></span><br><span class="line">        <span class="keyword">if</span> imgWidth &lt; logoWidth <span class="keyword">and</span> imgHeight &lt; logoHeight:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                imgOrign.save(<span class="string">f&#x27;%s&#x27;</span> % outFilePath)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">return</span> &#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">204</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;dealFile ä¿å­˜åŸå›¾:%så¤±è´¥: %s&#x27;</span> % (filePath, e)&#125;</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">200</span>, <span class="string">&#x27;msg&#x27;</span>: outFilePath&#125;</span><br><span class="line">        offLeft = imgWidth - logoWidth</span><br><span class="line">        <span class="keyword">if</span> offX <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            offLeft += offX</span><br><span class="line">        offTop = imgHeight - logoHeight</span><br><span class="line">        <span class="keyword">if</span> offY <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            offTop += offY</span><br><span class="line">        <span class="keyword">if</span> fileType == <span class="string">&#x27;.gif&#x27;</span>:</span><br><span class="line">            sequence = []</span><br><span class="line">            <span class="comment"># åˆ›å»ºä¸€ä¸ªè¿­ä»£å™¨å®ä¾‹ï¼Œè®©ç”¨æˆ·å¾ªç¯è®¿é—®åºåˆ—ä¸­çš„æ‰€æœ‰å¸§å›¾åƒã€‚</span></span><br><span class="line">            <span class="keyword">for</span> f <span class="keyword">in</span> ImageSequence.Iterator(imgOrign):</span><br><span class="line">                <span class="comment"># if len(sequence) % 2 == 0:</span></span><br><span class="line">                <span class="comment">#     offX=random.random()</span></span><br><span class="line">                <span class="comment">#     offY=random.random()</span></span><br><span class="line">                <span class="comment"># f.convertå›¾ç‰‡æ ¼å¼è½¬æ¢</span></span><br><span class="line">                sequence.append(<span class="variable language_">self</span>.dealImage(f.convert(), logoPixelsDict, offTop=offTop, offLeft=offLeft))</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                sequence[<span class="number">0</span>].save(<span class="string">f&#x27;%s&#x27;</span> % outFilePath, save_all=<span class="literal">True</span>, append_images=sequence[<span class="number">1</span>:])</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">return</span> &#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">204</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;dealFile ä¿å­˜gifå›¾ç‰‡:%så¤±è´¥: %s&#x27;</span> % (filePath, e)&#125;</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            imgOut = <span class="variable language_">self</span>.dealImage(imgOrign, logoPixelsDict, offTop=offTop, offLeft=offLeft)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                imgOut.save(<span class="string">f&#x27;%s&#x27;</span> % outFilePath)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">return</span> &#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">204</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;dealFile ä¿å­˜å›¾ç‰‡:%så¤±è´¥: %s&#x27;</span> % (filePath, e)&#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> imghdr.what(outFilePath) == <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">204</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;æ— æ³•è·å–æ–‡ä»¶ç±»å‹ï¼Œæ–‡ä»¶å¯èƒ½å·²æŸå:%s&#x27;</span> % outFilePath&#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">200</span>, <span class="string">&#x27;msg&#x27;</span>: outFilePath&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">dealDirImage</span>(<span class="params">self, imageDir, outFilePath=<span class="string">&#x27;&#x27;</span>, logoPath=<span class="literal">None</span>, offX=-<span class="number">5</span>, offY=-<span class="number">5</span></span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        å¤„ç†æ–‡ä»¶å¤¹å†…çš„æ‰€æœ‰å›¾ç‰‡</span></span><br><span class="line"><span class="string">        :param imageDir: å›¾ç‰‡æ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="string">        :param outFilePath: è¾“å‡ºæ–‡ä»¶</span></span><br><span class="line"><span class="string">        :param logoPath: logoå›¾ç‰‡è·¯å¾„</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        logoRes = <span class="variable language_">self</span>.dealImagePixels()</span><br><span class="line">        <span class="keyword">if</span> logoRes.get(<span class="string">&#x27;status&#x27;</span>, <span class="number">0</span>) == <span class="number">204</span>:</span><br><span class="line">            <span class="keyword">return</span> logoRes</span><br><span class="line">        logoDict = logoRes.get(<span class="string">&#x27;msg&#x27;</span>, &#123;&#125;)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> logoDict:</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">204</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;dealDirImage è·å–logoå›¾ç‰‡å¤±è´¥:%s&#x27;</span> % imageDir&#125;</span><br><span class="line"></span><br><span class="line">        picFiles = [os.path.join(imageDir, fn) <span class="keyword">for</span> fn <span class="keyword">in</span> os.listdir(imageDir)]</span><br><span class="line">        picDict = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> filePath <span class="keyword">in</span> picFiles:</span><br><span class="line">            res = <span class="variable language_">self</span>.dealFile(filePath, outFilePath, logoDict, offX=offX, offY=offY)</span><br><span class="line">            <span class="keyword">if</span> res.get(<span class="string">&#x27;status&#x27;</span>, <span class="number">0</span>) == <span class="number">204</span>:</span><br><span class="line">                common.util_log().errorLog(res.get(<span class="string">&#x27;msg&#x27;</span>))</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            picDict[filePath] = res.get(<span class="string">&#x27;msg&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> picDict</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">randomValue</span>(<span class="params">length, onlyNum=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="keyword">import</span> random</span><br><span class="line">        <span class="keyword">if</span> onlyNum:</span><br><span class="line">            result = random.randint(<span class="number">0</span>, <span class="built_in">pow</span>(<span class="number">10</span>, length - <span class="number">1</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">            chars = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz&#x27;</span></span><br><span class="line">            <span class="built_in">max</span> = <span class="built_in">len</span>(chars) - <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, length - <span class="number">1</span>):</span><br><span class="line">                result = result + <span class="built_in">str</span>(chars[random.randint(<span class="number">0</span>, <span class="built_in">max</span>)])</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">myMD5</span>(<span class="params">  _<span class="built_in">str</span> </span>):</span><br><span class="line">        m1 = hashlib.md5()</span><br><span class="line">        m1.update(_<span class="built_in">str</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">        <span class="comment"># print(m1.hexdigest() + &#x27;===md5(&#x27; + _str + &#x27;)&#x27;)</span></span><br><span class="line">        <span class="keyword">return</span> m1.hexdigest()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> python3 </category>
          
          <category> å›¾ç‰‡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> å›¾ç‰‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pythonå®‰è£…æ–‡æ¡£</title>
      <link href="/posts/ae9b3c91.html"/>
      <url>/posts/ae9b3c91.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;<br>ä¸€ã€å®‰è£…ä¾èµ–</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ yum -y install zlib zlib-devel \</span><br><span class="line">  bzip2 bzip2-devel \</span><br><span class="line">  ncurses ncurses-devel \</span><br><span class="line">  readline readline-devel \</span><br><span class="line">  openssl openssl-devel \</span><br><span class="line">  openssl-static \</span><br><span class="line">  xz lzma xz-devel \</span><br><span class="line">  sqlite sqlite-devel \</span><br><span class="line">  gdbm gdbm-devel \</span><br><span class="line">  tk tk-devel \</span><br><span class="line">  libffi libffi-devel \</span><br><span class="line">  gcc make</span><br></pre></td></tr></table></figure><p>äºŒã€ä¸‹è½½æ–‡ä»¶è§£å‹æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ wget https://www.python.org/ftp/python/3.6.5/Python-3.6.5.tgz</span><br><span class="line">$ tar zxvf Python3.6.5</span><br></pre></td></tr></table></figure><p>ä¸‰ã€ç¼–è¯‘</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ ./configure --prefix=/usr/local/webserver/python3.6.5/ --enable-shared CFLAGS=-fPIC</span><br><span class="line">$ make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line"><span class="comment"># å»ºç«‹é“¾æ¥</span></span><br><span class="line">$ <span class="built_in">ln</span> -s /path/python3.6.5/bin/python3 /usr/bin/python3</span><br><span class="line">$ <span class="built_in">ln</span> -s /path/python3.6.5/bin/pip3 /usr/bin/pip3</span><br></pre></td></tr></table></figure><p>å››ã€æŠ¥é”™å¤„ç†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python3: error while loading shared libraries: libpython3.6m.so.1.0: cannot open shared object file: No such file or directory</span></span><br><span class="line">$ <span class="built_in">cp</span> libpython3.6m.so.1.0 /usr/lib/</span><br><span class="line">$ <span class="built_in">cp</span> libpython3.6m.so.1.0 /usr/lib64/ </span><br><span class="line"></span><br><span class="line"><span class="comment"># æœªå®‰è£…sqlite, éœ€è¦å®‰è£…åé‡æ–°ç¼–è¯‘</span></span><br><span class="line">$ yum install sqlite-devel</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> python </category>
          
          <category> å®‰è£…æ–‡æ¡£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰è£…æ–‡æ¡£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iptables</title>
      <link href="/posts/736b1750.html"/>
      <url>/posts/736b1750.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…³é—­é˜²ç«å¢™å¹¶ä¸”ç¦æ­¢å¯åŠ¨</span></span><br><span class="line">$ systemctl stop firewalld.service</span><br><span class="line">$ systemctl <span class="built_in">disable</span> firewalld.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£…iptables</span></span><br><span class="line">$ yum install -y iptables iptables-services</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¸¸è§å°ipcommandï¼š</span></span><br><span class="line">$ iptables -A INPUT -s 123.45.67.89 -j DROP </span><br><span class="line"><span class="comment"># å°æ‰å•ä¸ªIPåœ°å€#å±è”½å…¨éƒ¨æ®µï¼ˆAç±»åœ°å€ï¼‰å³ä»192.0.0.1åˆ°192.255.255.254ï¼Œåˆ™å¢åŠ ä»¥ä¸‹è§„åˆ™ã€‚</span></span><br><span class="line">$ iptables -I INPUT -s 192.0.0.0/8 -j DROP</span><br><span class="line"><span class="comment"># å°IPæ®µï¼ˆBç±»åœ°å€ï¼‰å³ä»192.168.0.1åˆ°192.168.255.254ï¼Œåˆ™å¢åŠ ä»¥ä¸‹è§„åˆ™ã€‚</span></span><br><span class="line">$ iptables -I INPUT -s 192.168.0.0/16 -j DROP</span><br><span class="line"><span class="comment"># å°IPæ®µï¼ˆCç±»åœ°å€ï¼‰å³ä»192.168.200.1åˆ°192.168.200.254ï¼Œåˆ™å¢åŠ ä»¥ä¸‹è§„åˆ™ã€‚</span></span><br><span class="line">$ iptables -I INPUT -s 192.168.200.0/24 -j DROP</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–‡ä»¶ä¼ è¾“</title>
      <link href="/posts/e7dd4cd0.html"/>
      <url>/posts/e7dd4cd0.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>ä¸€ã€scp</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¼ è¾“æ–‡ä»¶</span></span><br><span class="line">$ scp local_file remote_username@remote_ip:remote_folder</span><br><span class="line"><span class="comment"># ä¼ è¾“æ–‡ä»¶å¤¹</span></span><br><span class="line">$ scp -r local_folder remote_username@remote_ip:remote_folder </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
          <category> æ–‡ä»¶ä¼ è¾“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>chrome headlessæ¨¡æ‹Ÿæµè§ˆå™¨</title>
      <link href="/posts/6ccdd453.html"/>
      <url>/posts/6ccdd453.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">åœ¨scrapyä¸­ä½¿ç”¨chrome headlessæ–¹å¼æ¨¡æ‹Ÿæµè§ˆå™¨é‡‡é›†</span></span><br><span class="line"><span class="string">éœ€è¦åœ¨settingä¸­æ·»åŠ ä¸­é—´ä»¶</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">from</span> scrapy.http <span class="keyword">import</span> HtmlResponse</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.options <span class="keyword">import</span> Options</span><br><span class="line"><span class="keyword">from</span> selenium.common.exceptions <span class="keyword">import</span> TimeoutException</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ChromeHeadless</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        é…ç½®(ç›®å‰åªæ”¯æŒwindows, linuxåç»­è¡¥å……)</span></span><br><span class="line"><span class="string">        chromedriverä¸‹è½½ https://chromedriver.storage.googleapis.com/2.45/chromedriver_win32.zip</span></span><br><span class="line"><span class="string">        å°†ä¸‹è½½å¥½çš„æ–‡ä»¶æ”¾ç½®äºchromeåŒçº§ç›®å½•ä¸‹</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        chrome_options = Options()</span><br><span class="line">        chrome_options.add_argument(<span class="string">&#x27;--headless&#x27;</span>)</span><br><span class="line">        <span class="variable language_">self</span>.driver = webdriver.Chrome(</span><br><span class="line">            executable_path=(<span class="string">r&#x27;C:\Program Files (x86)\Google\Chrome\Application\chromedriver.exe&#x27;</span>),</span><br><span class="line">            chrome_options=chrome_options)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__del__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.driver.close()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">process_request</span>(<span class="params">self,request,spider</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;chrome drive start&#x27;</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># è¯·æ±‚é¡µé¢</span></span><br><span class="line">            <span class="variable language_">self</span>.driver.get(request.url)</span><br><span class="line">            <span class="comment"># ç”±äºå­˜åœ¨jsåŠ¨æ€åŠ è½½æ•°æ®, ç­‰å¾…jsæ‰§è¡Œå®Œæˆæ—¶é—´æ ¹æ®å…·ä½“æƒ…å†µè®¾ç½®</span></span><br><span class="line">            time.sleep(<span class="number">3</span>)</span><br><span class="line">            <span class="comment"># å°†æ•°æ®(self.driver.page_source) return å›scrapy</span></span><br><span class="line">            <span class="keyword">return</span> HtmlResponse(url=request.url, body=<span class="variable language_">self</span>.driver.page_source, request=request, encoding=<span class="string">&#x27;utf-8&#x27;</span>,</span><br><span class="line">                                status=<span class="number">200</span>)</span><br><span class="line">        <span class="keyword">except</span> TimeoutException:</span><br><span class="line">            <span class="keyword">return</span> HtmlResponse(url=request.url, request=request, encoding=<span class="string">&#x27;utf-8&#x27;</span>, status=<span class="number">500</span>)</span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;chrome drive end&#x27;</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> python </category>
          
          <category> çˆ¬è™« </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> çˆ¬è™« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>scrapyå®‰è£…</title>
      <link href="/posts/2bf5ea92.html"/>
      <url>/posts/2bf5ea92.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;<br>ä¸€ã€å®‰è£…</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>pip install scrapy==version</span><br><span class="line"><span class="comment"># windowsä¸‹æç¤ºcl.exeåœæ­¢æ´»åŠ¨,åœ¨ä»¥ä¸‹åœ°å€ä¸‹è½½å¯¹åº”pythonç‰ˆæœ¬çš„æ–‡ä»¶</span></span><br><span class="line"><span class="symbol">https:</span>/<span class="regexp">/www.lfd.uci.edu/</span>~gohlke/pythonlibs/<span class="comment">#twisted</span></span><br><span class="line"><span class="variable">$ </span>pip install /path/twisted</span><br><span class="line"><span class="variable">$ </span>pip install scrapy</span><br></pre></td></tr></table></figure><p>äºŒã€æ–°å»ºscrapyé¡¹ç›®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ–°å»ºé¡¹ç›®</span></span><br><span class="line">scrapy startproject zimuku</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–°å»ºdemo</span></span><br><span class="line">scrapy genspider demo http://xxx.net</span><br></pre></td></tr></table></figure><p>ä¸‰ã€è°ƒè¯•<br>1.å‘½ä»¤è¡Œä¸‹è°ƒè¯•</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">scrapy crawl demo</span></span><br></pre></td></tr></table></figure><p>2.pycharmä¸‹è°ƒè¯•<br>scrapyé¡¹ç›®ä¸‹çš„spidersç›®å½•ä¸‹æ–°å¢main.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> scrapy.cmdline <span class="keyword">import</span> execute</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ·»åŠ å½“å‰é¡¹ç›®çš„ç»å¯¹åœ°å€</span></span><br><span class="line">sys.path.append(os.path.dirname(os.path.abspath(__file__))) </span><br><span class="line"><span class="comment">#æ‰§è¡Œ scrapy å†…ç½®çš„å‡½æ•°æ–¹æ³•executeï¼Œ  ä½¿ç”¨ crawl çˆ¬å–å¹¶è°ƒè¯•ï¼Œæœ€åä¸€ä¸ªå‚æ•°jobbole æ˜¯æˆ‘çš„çˆ¬è™«æ–‡ä»¶å</span></span><br><span class="line">execute([<span class="string">&#x27;scrapy&#x27;</span>, <span class="string">&#x27;crawl&#x27;</span>, <span class="string">&#x27;jobbole&#x27;</span>])</span><br></pre></td></tr></table></figure><p>3.è¿è¡Œé”™è¯¯å¤„ç†æ–¹æ¡ˆ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># exceptions.ImportError: No module named win32api</span></span><br><span class="line"><span class="comment"># å®‰è£…win32</span></span><br><span class="line">$ pip install pywin32</span><br><span class="line"><span class="comment"># æˆ–è€…ä¸‹è½½url:https://sourceforge.net/projects/pywin32/files/pywin32/Build%20220/</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Could not find a version that satisfies the requirement Twisted&gt;=13.1.0 (from scrapy==1.5.1) (from versions: )</span></span><br><span class="line"><span class="comment"># No matching distribution found for Twisted&gt;=13.1.0 (from scrapy==1.5.1)</span></span><br><span class="line">$ wget https://pypi.python.org/packages/source/T/Twisted/Twisted.tar.bz2</span><br><span class="line">$ tar xjvf Twisted.tar.bz2</span><br><span class="line">$ <span class="built_in">cd</span> Twisted &amp;&amp; python set.py install</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> python </category>
          
          <category> scrapy </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰è£…æ–‡æ¡£ </tag>
            
            <tag> çˆ¬è™« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>laravelè®°å½•</title>
      <link href="/posts/b150e0da.html"/>
      <url>/posts/b150e0da.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="nginx-è®¿é—®404å¤„ç†æ–¹æ¡ˆ"><a href="#nginx-è®¿é—®404å¤„ç†æ–¹æ¡ˆ" class="headerlink" title="nginx è®¿é—®404å¤„ç†æ–¹æ¡ˆ"></a>nginx è®¿é—®404å¤„ç†æ–¹æ¡ˆ</h1><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">        #try_files $uri $uri/ =<span class="number">404</span>;</span><br><span class="line">        try_files $uri $uri/ /index.php?$query_string;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ‰¾ä¸åˆ°-laravel-å‘½ä»¤"><a href="#æ‰¾ä¸åˆ°-laravel-å‘½ä»¤" class="headerlink" title="æ‰¾ä¸åˆ° laravel å‘½ä»¤"></a>æ‰¾ä¸åˆ° laravel å‘½ä»¤</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å®‰è£… laravel åæ— æ³•æ‰¾åˆ° laravel å‘½ä»¤</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">composer global require laravel/installer</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">laravelå®‰è£…è·¯å¾„ä¸º</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">export</span> PATH=<span class="string">&quot;~/.config/composer/vendor/bin:<span class="variable">$PATH</span>&quot;</span></span></span><br></pre></td></tr></table></figure><h1 id="è‡ªå®šä¹‰æ•°ç»„ä½¿ç”¨æ¡†æ¶ç¿»é¡µåŠŸèƒ½-paginate"><a href="#è‡ªå®šä¹‰æ•°ç»„ä½¿ç”¨æ¡†æ¶ç¿»é¡µåŠŸèƒ½-paginate" class="headerlink" title="è‡ªå®šä¹‰æ•°ç»„ä½¿ç”¨æ¡†æ¶ç¿»é¡µåŠŸèƒ½(paginate)"></a>è‡ªå®šä¹‰æ•°ç»„ä½¿ç”¨æ¡†æ¶ç¿»é¡µåŠŸèƒ½(paginate)</h1><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$list</span> = [[<span class="string">&#x27;a&#x27;</span> =&gt; <span class="string">&#x27;a&#x27;</span>]];</span><br><span class="line"><span class="variable">$list</span> = <span class="keyword">new</span><span class="type"></span> LengthAwarePaginator(array_slice(<span class="variable">$list</span>, <span class="variable">$offset</span>, <span class="variable">$search_limit</span>, <span class="literal">true</span>),</span><br><span class="line">                count(<span class="variable">$list</span>), <span class="variable">$search_limit</span>, <span class="variable">$page</span>,</span><br><span class="line">                [<span class="string">&#x27;path&#x27;</span> =&gt; request()-&gt;url(), <span class="string">&#x27;query&#x27;</span> =&gt; request()-&gt;query()]);</span><br><span class="line"><span class="variable">$list</span> = <span class="variable">$list</span>-&gt;toArray();</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
          <category> æ¡†æ¶ </category>
          
          <category> laravel </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> laravel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nginxé…ç½®ä¸­lastå’ŒbreakåŠpermanentå’Œredirectçš„åŒºåˆ«</title>
      <link href="/posts/3291d211.html"/>
      <url>/posts/3291d211.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>ä¸€ã€ä¸å†™lastå’Œbreak<br>æµç¨‹å°±æ˜¯ä¾æ¬¡æ‰§è¡Œè¿™äº›rewrite</p><p>rewrite break - urlé‡å†™åï¼Œç›´æ¥ä½¿ç”¨å½“å‰èµ„æºï¼Œä¸å†æ‰§è¡Œlocationé‡Œä½™ä¸‹çš„è¯­å¥ï¼Œå®Œæˆæœ¬æ¬¡è¯·æ±‚ï¼Œåœ°å€æ urlä¸å˜<br>rewrite last - urlé‡å†™åï¼Œé©¬ä¸Šå‘èµ·ä¸€ä¸ªæ–°çš„è¯·æ±‚ï¼Œå†æ¬¡è¿›å…¥serverå—ï¼Œé‡è¯•locationåŒ¹é…ï¼Œè¶…è¿‡10æ¬¡åŒ¹é…ä¸åˆ°æŠ¥500é”™è¯¯ï¼Œåœ°å€æ urlä¸å˜<br>rewrite redirect â€“ è¿”å›302ä¸´æ—¶é‡å®šå‘ï¼Œåœ°å€æ æ˜¾ç¤ºé‡å®šå‘åçš„urlï¼Œçˆ¬è™«ä¸ä¼šæ›´æ–°urlï¼ˆå› ä¸ºæ˜¯ä¸´æ—¶ï¼‰<br>rewrite permanent â€“ è¿”å›301æ°¸ä¹…é‡å®šå‘, åœ°å€æ æ˜¾ç¤ºé‡å®šå‘åçš„urlï¼Œçˆ¬è™«æ›´æ–°url</p><p>äºŒã€ä½¿ç”¨lastä¼šå¯¹serveræ ‡ç­¾é‡æ–°å‘èµ·è¯·æ±‚<br>å¦‚æœlocationä¸­rewriteåæ˜¯å¯¹é™æ€èµ„æºçš„è¯·æ±‚ï¼Œä¸éœ€è¦å†è¿›è¡Œå…¶ä»–åŒ¹é…ï¼Œä¸€èˆ¬è¦ä½¿ç”¨breakæˆ–ä¸å†™ï¼Œç›´æ¥ä½¿ç”¨å½“å‰locationä¸­çš„æ•°æ®æºï¼Œå®Œæˆæœ¬æ¬¡è¯·æ±‚<br>å¦‚æœlocationä¸­rewriteåï¼Œè¿˜éœ€è¦è¿›è¡Œå…¶ä»–å¤„ç†ï¼Œå¦‚åŠ¨æ€fastcgiè¯·æ±‚(.PHP,.jsp)ç­‰ï¼Œè¦ç”¨lastç»§ç»­å‘èµ·æ–°çš„è¯·æ±‚<br>(æ ¹çš„locationä½¿ç”¨lastæ¯”è¾ƒå¥½, å› ä¸ºå¦‚æœæœ‰.phpç­‰fastcgiè¯·æ±‚è¿˜è¦ç»§ç»­å¤„ç†)<br>ä½¿ç”¨aliasæŒ‡å®šæºï¼šå¿…é¡»ä½¿ç”¨last</p><p>ä¸‰ã€lastå’Œbreakæ€»ç»“<br>1.å½“å‡ºç°åœ¨locationä¹‹å¤–æ—¶ï¼Œä¸¤è€…çš„ä½œç”¨æ˜¯ä¸€è‡´çš„æ²¡æœ‰ä»»ä½•å·®å¼‚ã€‚<br>æ³¨æ„ä¸€ç‚¹å°±æ˜¯ï¼Œä»–ä»¬ä¼šè·³è¿‡æ‰€æœ‰åœ¨ä»–ä»¬ä¹‹åçš„rewriteæ¨¡å—ä¸­çš„æŒ‡ä»¤ï¼Œå»é€‰æ‹©è‡ªå·±åŒ¹é…çš„location</p><p>2.lastå’Œbreakå½“å‡ºç°åœ¨locationå†…éƒ¨æ—¶ï¼Œä¸¤è€…å°±å­˜åœ¨äº†å·®å¼‚<br>last: ä½¿ç”¨äº†lastæŒ‡ä»¤ï¼Œrewriteåä¼šè·³å‡ºlocationä½œç”¨åŸŸï¼Œé‡æ–°å¼€å§‹å†èµ°ä¸€æ¬¡åˆšåˆšçš„è¡Œä¸º<br>break: ä½¿ç”¨äº†breakæŒ‡ä»¤ï¼Œrewriteåä¸ä¼šè·³å‡ºlocation ä½œç”¨åŸŸã€‚å®ƒçš„ç”Ÿå‘½ä¹Ÿåœ¨è¿™ä¸ªlocationä¸­ç»ˆç»“ã€‚  </p><p>å››ã€permanentå’Œredirectæ€»ç»“<br>permanent: å¤§å®¶å…¬è®¤çš„ä¿¡æ¯ï¼Œæ°¸ä¹…æ€§é‡å®šå‘ã€‚è¯·æ±‚æ—¥å¿—ä¸­çš„çŠ¶æ€ç ä¸º301<br>redirectï¼šå¤§å®¶å…¬è®¤çš„ä¿¡æ¯ï¼Œä¸´æ—¶é‡å®šå‘ã€‚è¯·æ±‚æ—¥å¿—ä¸­çš„çŠ¶æ€ç ä¸º302<br>ä»å®ç°åŠŸèƒ½çš„è§’åº¦ä¸Šå»çœ‹ï¼Œpermanent å’Œ redirect æ˜¯ä¸€æ ·çš„ã€‚ä¸å­˜åœ¨å“ªé‡Œå¥½ï¼Œå“ªé‡Œåã€‚ä¹Ÿä¸å­˜åœ¨ä»€ä¹ˆæ€§èƒ½ä¸Šçš„é—®é¢˜ã€‚<br>ä½†ä»SEO(æˆ–è€…æ˜¯ç™¾åº¦çˆ¬ä½ çš„ç½‘ç«™æ—¶)ã€‚ ç±»ä¼¼äºè¿™æ ·çš„ä¸œè¥¿ï¼Œä¼šå¯¹ä½ åˆ°åº•æ˜¯æ°¸ä¹…æ€§é‡å®šå‘è¿˜æ˜¯ä¸´æ—¶é‡å®šå‘æ„Ÿå…´è¶£ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nginx echoæ¨¡å—</title>
      <link href="/posts/2e3e3de.html"/>
      <url>/posts/2e3e3de.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>ä¸€ã€ä¸‹è½½echoæ¨¡å—</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ wget https://github.com/openresty/echo-nginx-module/archive/v0.62.tar.gz</span><br><span class="line">tar zxvf v0.62.tar.gz</span><br></pre></td></tr></table></figure><p>äºŒã€é‡æ–°ç¼–è¯‘nginxï¼Œæ·»åŠ æ¨¡å—</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥nginxç¼–è¯‘æ–‡ä»¶ç›®å½•(åœ¨åŸæœ¬åŸºç¡€ä¸Šæ·»åŠ æ¨¡ç»„)</span></span><br><span class="line">$ ./configure --add-module=/opt/echo-nginx-module-0.62</span><br><span class="line">$ make</span><br><span class="line"><span class="comment"># å¦‚æœæ˜¯é‡æ–°å®‰è£…ç›´æ¥make install</span></span><br><span class="line"><span class="comment"># å¦‚æœå·²å­˜åœ¨nginx, å¤‡ä»½åŸæœ¬å·²å­˜åœ¨çš„nginxæ–‡ä»¶ï¼Œå†å°†makeå¥½çš„nginxè¦†ç›–</span></span><br><span class="line">$ <span class="built_in">cp</span> objs/nginx /usr/local/webserver/nginx/sbin/nginx</span><br></pre></td></tr></table></figure><p>ä¸‰ã€ä½¿ç”¨echoï¼Œåœ¨nginxé…ç½®æ–‡ä»¶ä¸­æ·»åŠ </p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">location</span> /hello &#123; </span><br><span class="line">    <span class="comment"># è½¬æ¢ä¸ºæ–‡æœ¬è¾“å‡ºï¼Œå¦åˆ™ä¼šå˜æˆä¸‹è½½</span></span><br><span class="line">    <span class="attribute">default_type</span> <span class="string">&#x27;text/plain&#x27;</span>;</span><br><span class="line">    <span class="attribute">echo</span> <span class="string">&#x27;hello!&#x27;</span>;</span><br><span class="line">    <span class="comment"># return 200 &#x27;hello!&#x27;;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å››ã€å…³é—­nginxï¼Œåå¯åŠ¨nginx(é‡å¯æ— æ•ˆå°±å…ˆå…³é—­å†å¯åŠ¨)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> -QUIT `<span class="built_in">cat</span> /usr/local/nginx/logs/nginx.pid` &amp;&amp; /usr/local/nginx/sbin/nginx</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nginxå˜é‡å¤§å…¨</title>
      <link href="/posts/d94f978b.html"/>
      <url>/posts/d94f978b.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>nginxå†…ç½®å˜é‡<br>å†…ç½®å˜é‡å­˜æ”¾åœ¨ ngx_http_core_module æ¨¡å—ä¸­ï¼Œå˜é‡çš„å‘½åæ–¹å¼å’Œapache æœåŠ¡å™¨å˜é‡æ˜¯ä¸€è‡´çš„ã€‚<br>æ€»è€Œè¨€ä¹‹ï¼Œè¿™äº›å˜é‡ä»£è¡¨ç€å®¢æˆ·ç«¯è¯·æ±‚å¤´çš„å†…å®¹ï¼Œä¾‹å¦‚$http_user_agent, $http_cookie, ç­‰ç­‰ã€‚ä¸‹é¢æ˜¯nginxæ”¯æŒçš„æ‰€æœ‰å†…ç½®å˜é‡ï¼š</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">å˜é‡åè¯´æ˜</span><br><span class="line"><span class="meta"><span class="keyword">$arg</span>_&#123;name&#125;è¯·æ±‚ä¸­çš„çš„å‚æ•°åï¼Œå³â€œ?â€åé¢çš„name=valueå½¢å¼çš„e.g. ?title=test å¯ç”¨ $arg_titleè·å–åˆ°</span></span><br><span class="line"><span class="meta"><span class="keyword">$args</span>è¯·æ±‚ä¸­çš„å‚æ•°å€¼</span></span><br><span class="line"><span class="meta"><span class="keyword">$binary</span>_remote_addrå®¢æˆ·ç«¯åœ°å€çš„äºŒè¿›åˆ¶å½¢å¼, å›ºå®šé•¿åº¦ä¸º4ä¸ªå­—èŠ‚</span></span><br><span class="line"><span class="meta"><span class="keyword">$body</span>_bytes_sentä¼ è¾“ç»™å®¢æˆ·ç«¯çš„å­—èŠ‚æ•°ï¼Œå“åº”å¤´ä¸è®¡ç®—åœ¨å†…ï¼›è¿™ä¸ªå˜é‡å’ŒApacheçš„mod_log_configæ¨¡å—ä¸­çš„â€œ%Bâ€å‚æ•°ä¿æŒå…¼å®¹</span></span><br><span class="line"><span class="meta"><span class="keyword">$bytes</span>_sentä¼ è¾“ç»™å®¢æˆ·ç«¯çš„å­—èŠ‚æ•° (1.3.8, 1.2.5)</span></span><br><span class="line"><span class="meta"><span class="keyword">$connection</span>TCPè¿æ¥çš„åºåˆ—å· (1.3.8, 1.2.5)</span></span><br><span class="line"><span class="meta"><span class="keyword">$connection</span>_requestsTCPè¿æ¥å½“å‰çš„è¯·æ±‚æ•°é‡ (1.3.8, 1.2.5)</span></span><br><span class="line"><span class="meta"><span class="keyword">$content</span>_lengthâ€œContent-Lengthâ€ è¯·æ±‚å¤´å­—æ®µ</span></span><br><span class="line"><span class="meta"><span class="keyword">$content</span>_typeâ€œContent-Typeâ€ è¯·æ±‚å¤´å­—æ®µ</span></span><br><span class="line"><span class="meta"><span class="keyword">$cookie</span>_namecookieåç§°</span></span><br><span class="line"><span class="meta"><span class="keyword">$document</span>_rootå½“å‰è¯·æ±‚çš„æ–‡æ¡£æ ¹ç›®å½•æˆ–åˆ«å</span></span><br><span class="line"><span class="meta"><span class="keyword">$document</span>_uriåŒ $uri</span></span><br><span class="line"><span class="meta"><span class="keyword">$host</span>ä¼˜å…ˆçº§å¦‚ä¸‹ï¼šHTTPè¯·æ±‚è¡Œçš„ä¸»æœºå&gt;â€HOSTâ€è¯·æ±‚å¤´å­—æ®µ&gt;ç¬¦åˆè¯·æ±‚çš„æœåŠ¡å™¨å</span></span><br><span class="line"><span class="meta"><span class="keyword">$hostname</span>ä¸»æœºå</span></span><br><span class="line"><span class="meta"><span class="keyword">$http</span>_&#123;name&#125;åŒ¹é…ä»»æ„è¯·æ±‚å¤´å­—æ®µï¼›å˜é‡åä¸­çš„ååŠéƒ¨åˆ†â€œnameâ€å¯ä»¥æ›¿æ¢æˆä»»æ„è¯·æ±‚å¤´å­—æ®µï¼Œå¦‚åœ¨é…ç½®æ–‡ä»¶ä¸­éœ€è¦è·å–httpè¯·æ±‚å¤´ï¼šâ€œAccept-Languageâ€ï¼Œé‚£ä¹ˆå°†â€œï¼â€æ›¿æ¢ä¸ºä¸‹åˆ’çº¿ï¼Œå¤§å†™å­—æ¯æ›¿æ¢ä¸ºå°å†™ï¼Œå½¢å¦‚ï¼š$http_accept_languageå³å¯ã€‚</span></span><br><span class="line"><span class="meta"><span class="keyword">$https</span>å¦‚æœå¼€å¯äº†SSLå®‰å…¨æ¨¡å¼ï¼Œå€¼ä¸ºâ€œonâ€ï¼Œå¦åˆ™ä¸ºç©ºå­—ç¬¦ä¸²ã€‚</span></span><br><span class="line"><span class="meta"><span class="keyword">$is</span>_argså¦‚æœè¯·æ±‚ä¸­æœ‰å‚æ•°ï¼Œå€¼ä¸ºâ€œ?â€ï¼Œå¦åˆ™ä¸ºç©ºå­—ç¬¦ä¸²ã€‚</span></span><br><span class="line"><span class="meta"><span class="keyword">$limit</span>_rateç”¨äºè®¾ç½®å“åº”çš„é€Ÿåº¦é™åˆ¶ï¼Œè¯¦è§ limit_rateã€‚</span></span><br><span class="line"><span class="meta"><span class="keyword">$msec</span>å½“å‰çš„Unixæ—¶é—´æˆ³ (1.3.9, 1.2.6)</span></span><br><span class="line"><span class="meta"><span class="keyword">$nginx</span>_versionnginxç‰ˆæœ¬</span></span><br><span class="line"><span class="meta"><span class="keyword">$pid</span>å·¥ä½œè¿›ç¨‹çš„PID</span></span><br><span class="line"><span class="meta"><span class="keyword">$pipe</span>å¦‚æœè¯·æ±‚æ¥è‡ªç®¡é“é€šä¿¡ï¼Œå€¼ä¸ºâ€œpâ€ï¼Œå¦åˆ™ä¸ºâ€œ.â€ (1.3.12, 1.2.7)</span></span><br><span class="line"><span class="meta"><span class="keyword">$proxy</span>_protocol_addrè·å–ä»£ç†è®¿é—®æœåŠ¡å™¨çš„å®¢æˆ·ç«¯åœ°å€ï¼Œå¦‚æœæ˜¯ç›´æ¥è®¿é—®ï¼Œè¯¥å€¼ä¸ºç©ºå­—ç¬¦ä¸²ã€‚(1.5.12)</span></span><br><span class="line"><span class="meta"><span class="keyword">$query</span>_stringåŒ $args</span></span><br><span class="line"><span class="meta"><span class="keyword">$realpath</span>_rootå½“å‰è¯·æ±‚çš„æ–‡æ¡£æ ¹ç›®å½•æˆ–åˆ«åçš„çœŸå®è·¯å¾„ï¼Œä¼šå°†æ‰€æœ‰ç¬¦å·è¿æ¥è½¬æ¢ä¸ºçœŸå®è·¯å¾„ã€‚</span></span><br><span class="line"><span class="meta"><span class="keyword">$remote</span>_addrå®¢æˆ·ç«¯åœ°å€</span></span><br><span class="line"><span class="meta"><span class="keyword">$remote</span>_portå®¢æˆ·ç«¯ç«¯å£</span></span><br><span class="line"><span class="meta"><span class="keyword">$remote</span>_userç”¨äºHTTPåŸºç¡€è®¤è¯æœåŠ¡çš„ç”¨æˆ·å</span></span><br><span class="line"><span class="meta"><span class="keyword">$request</span>ä»£è¡¨å®¢æˆ·ç«¯çš„è¯·æ±‚åœ°å€</span></span><br><span class="line"><span class="meta"><span class="keyword">$request</span>_bodyå®¢æˆ·ç«¯çš„è¯·æ±‚ä¸»ä½“,æ­¤å˜é‡å¯åœ¨locationä¸­ä½¿ç”¨ï¼Œå°†è¯·æ±‚ä¸»ä½“é€šè¿‡proxy_pass, fastcgi_pass, uwsgi_pass, å’Œ scgi_passä¼ é€’ç»™ä¸‹ä¸€çº§çš„ä»£ç†æœåŠ¡å™¨ã€‚</span></span><br><span class="line"><span class="meta"><span class="keyword">$request</span>_body_fileå°†å®¢æˆ·ç«¯è¯·æ±‚ä¸»ä½“ä¿å­˜åœ¨ä¸´æ—¶æ–‡ä»¶ä¸­ã€‚æ–‡ä»¶å¤„ç†ç»“æŸåï¼Œæ­¤æ–‡ä»¶éœ€åˆ é™¤ã€‚å¦‚æœéœ€è¦ä¹‹ä¸€å¼€å¯æ­¤åŠŸèƒ½ï¼Œéœ€è¦è®¾ç½®client_body_in_file_onlyã€‚å¦‚æœå°†æ¬¡æ–‡ä»¶ä¼ é€’ç»™åç«¯çš„ä»£ç†æœåŠ¡å™¨ï¼Œéœ€è¦ç¦ç”¨request bodyï¼Œå³è®¾ç½®proxy_pass_request_body offï¼Œfastcgi_pass_request_body off, uwsgi_pass_request_body off, or scgi_pass_request_body off ã€‚</span></span><br><span class="line"><span class="meta"><span class="keyword">$request</span>_completionå¦‚æœè¯·æ±‚æˆåŠŸï¼Œå€¼ä¸ºâ€OKâ€ï¼Œå¦‚æœè¯·æ±‚æœªå®Œæˆæˆ–è€…è¯·æ±‚ä¸æ˜¯ä¸€ä¸ªèŒƒå›´è¯·æ±‚çš„æœ€åä¸€éƒ¨åˆ†ï¼Œåˆ™ä¸ºç©ºã€‚</span></span><br><span class="line"><span class="meta"><span class="keyword">$request</span>_filenameå½“å‰è¿æ¥è¯·æ±‚çš„æ–‡ä»¶è·¯å¾„ï¼Œç”±rootæˆ–aliasæŒ‡ä»¤ä¸URIè¯·æ±‚ç”Ÿæˆã€‚</span></span><br><span class="line"><span class="meta"><span class="keyword">$request</span>_lengthè¯·æ±‚çš„é•¿åº¦ (åŒ…æ‹¬è¯·æ±‚çš„åœ°å€, httpè¯·æ±‚å¤´å’Œè¯·æ±‚ä¸»ä½“) (1.3.12, 1.2.7)</span></span><br><span class="line"><span class="meta"><span class="keyword">$request</span>_methodHTTPè¯·æ±‚æ–¹æ³•ï¼Œé€šå¸¸ä¸ºâ€œGETâ€æˆ–â€œPOSTâ€</span></span><br><span class="line"><span class="meta"><span class="keyword">$request</span>_timeå¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ä½¿ç”¨çš„æ—¶é—´ (1.3.9, 1.2.6); ä»è¯»å–å®¢æˆ·ç«¯çš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¼€å§‹è®¡æ—¶ã€‚</span></span><br><span class="line"><span class="meta"><span class="keyword">$request</span>_uriè¿™ä¸ªå˜é‡ç­‰äºåŒ…å«ä¸€äº›å®¢æˆ·ç«¯è¯·æ±‚å‚æ•°çš„åŸå§‹URIï¼Œå®ƒæ— æ³•ä¿®æ”¹ï¼Œè¯·æŸ¥çœ‹$uriæ›´æ”¹æˆ–é‡å†™URIï¼Œä¸åŒ…å«ä¸»æœºåï¼Œä¾‹å¦‚ï¼š/cnphp/test.php?arg=freemouseã€‚</span></span><br><span class="line"><span class="meta"><span class="keyword">$scheme</span>è¯·æ±‚ä½¿ç”¨çš„Webåè®®, â€œhttpâ€ æˆ– â€œhttpsâ€</span></span><br><span class="line"><span class="meta"><span class="keyword">$sent</span>_http_&#123;name&#125;å¯ä»¥è®¾ç½®ä»»æ„httpå“åº”å¤´å­—æ®µï¼› å˜é‡åä¸­çš„ååŠéƒ¨åˆ†â€œnameâ€å¯ä»¥æ›¿æ¢æˆä»»æ„å“åº”å¤´å­—æ®µï¼Œå¦‚éœ€è¦è®¾ç½®å“åº”å¤´Content-lengthï¼Œé‚£ä¹ˆå°†â€œï¼â€æ›¿æ¢ä¸ºä¸‹åˆ’çº¿ï¼Œå¤§å†™å­—æ¯æ›¿æ¢ä¸ºå°å†™ï¼Œå½¢å¦‚ï¼š$sent_http_content_length 4096å³å¯ã€‚</span></span><br><span class="line"><span class="meta"><span class="keyword">$server</span>_addræœåŠ¡å™¨ç«¯åœ°å€ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼šä¸ºäº†é¿å…è®¿é—®linuxç³»ç»Ÿå†…æ ¸ï¼Œåº”å°†ipåœ°å€æå‰è®¾ç½®åœ¨é…ç½®æ–‡ä»¶ä¸­ã€‚</span></span><br><span class="line"><span class="meta"><span class="keyword">$server</span>_nameæœåŠ¡å™¨åï¼Œwww.cnphp.info</span></span><br><span class="line"><span class="meta"><span class="keyword">$server</span>_portæœåŠ¡å™¨ç«¯å£</span></span><br><span class="line"><span class="meta"><span class="keyword">$server</span>_protocolæœåŠ¡å™¨çš„HTTPç‰ˆæœ¬, é€šå¸¸ä¸º â€œHTTP/1.0â€ æˆ– â€œHTTP/1.1â€</span></span><br><span class="line"><span class="meta"><span class="keyword">$status</span>HTTPå“åº”ä»£ç  (1.3.2, 1.2.2)</span></span><br><span class="line"><span class="meta"><span class="keyword">$tcpinfo</span>_rtt, $tcpinfo_rttvar, $tcpinfo_snd_cwnd, $tcpinfo_rcv_spaceå®¢æˆ·ç«¯TCPè¿æ¥çš„å…·ä½“ä¿¡æ¯</span></span><br><span class="line"><span class="meta"><span class="keyword">$time</span>_iso8601æœåŠ¡å™¨æ—¶é—´çš„ISO 8610æ ¼å¼ (1.3.12, 1.2.7)</span></span><br><span class="line"><span class="meta"><span class="keyword">$time</span>_localæœåŠ¡å™¨æ—¶é—´ï¼ˆLOG Format æ ¼å¼ï¼‰ (1.3.12, 1.2.7)</span></span><br><span class="line"><span class="meta"><span class="keyword">$uri</span>è¯·æ±‚ä¸­çš„å½“å‰URI(ä¸å¸¦è¯·æ±‚å‚æ•°ï¼Œå‚æ•°åœ¨$argsä¸­)ï¼Œå¯ä»¥ä¸åŒäºæµè§ˆå™¨ä¼ é€’çš„$request_uriçš„å€¼ï¼Œå®ƒå¯ä»¥é€šè¿‡å†…éƒ¨é‡å®šå‘ï¼Œæˆ–è€…ä½¿ç”¨indexæŒ‡ä»¤è¿›è¡Œä¿®æ”¹ï¼Œ$uriä¸åŒ…å«ä¸»æœºåï¼Œå¦‚/foo/bar.htmlã€‚</span></span><br></pre></td></tr></table></figure><p><a href="http://yzone.net/blog/52">è½¬è‡ª: nginxå†…ç½®å˜é‡å¤§å…¨</a></p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ—¥å¸¸</title>
      <link href="/posts/2ec3464e.html"/>
      <url>/posts/2ec3464e.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">chromeç½‘é¡µæˆªå›¾</span><br><span class="line"><span class="symbol">f12</span>/æ£€æŸ¥ -&gt; é€‰æ‹©éœ€è¦æˆªå›¾çš„ DOM -&gt; cmd+shift+p -&gt; capture node screenshot</span><br><span class="line"></span><br><span class="line">ç™¾åº¦æœç´¢</span><br><span class="line">æ’é™¤å…³é”®è¯ -keyword</span><br><span class="line">æœç´¢æŒ‡å®šå…³é”®è¯ --keyword</span><br><span class="line"></span><br><span class="line">windows10å…³é—­hyper(ç®¡ç†å‘˜ä¸‹æ‰§è¡Œ)</span><br><span class="line">bcdedit /set hypervisorlaunchtype off</span><br><span class="line"></span><br><span class="line">excel</span><br><span class="line">=<span class="built_in">VLOOKUP</span> (è¦æŸ¥æ‰¾çš„é¡¹ã€è¦æŸ¥æ‰¾ä½ç½®ã€åŒºåŸŸä¸­åŒ…å«è¦è¿”å›çš„å€¼çš„åˆ—å·ã€è¿”å›è¿‘ä¼¼åŒ¹é…æˆ–ç²¾ç¡®åŒ¹é… - æŒ‡ç¤ºä¸º <span class="number">1</span>/<span class="built_in">TRUE</span> æˆ– <span class="number">0</span>/<span class="built_in">FALSE</span>) ã€‚</span><br><span class="line">=<span class="built_in">VLOOKUP</span>(<span class="symbol">A3</span>,Sheet1!<span class="symbol">A:B</span>,<span class="number">2</span>,<span class="built_in">FALSE</span>) æŸ¥æ‰¾å‡ºBsheetä¸­å’ŒAsheetåŒåæ•°æ®</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å…¶ä»– </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å…¶ä»– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>js å…¨å±€æ›¿æ¢ä½¿ç”¨å˜é‡</title>
      <link href="/posts/f03fd67.html"/>
      <url>/posts/f03fd67.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>Js æ›¿æ¢ä¸€ä¸ªå¤šè¡Œæ–‡æœ¬çš„å…³é”®å­—<br>æ­£å¸¸ï¼Œæ²¡æœ‰å˜é‡ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> string = aaabbbcccc;</span><br><span class="line"><span class="comment">//æŠŠ a æ›¿æ¢æˆ bï¼š</span></span><br><span class="line">string.<span class="title function_">replace</span>(<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>);</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šåªèƒ½æ›¿æ¢ç¬¬ä¸€ä¸ªåŒ¹é…çš„ï¼Œè¦å…¨æ–‡åŒ¹é…åº”è¯¥ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">string.<span class="title function_">replace</span>(<span class="regexp">/a/g</span>,<span class="string">&quot;b&quot;</span>);</span><br><span class="line"><span class="comment">//æ­£åˆ™åŠ ä¸ªå‚æ•° g ï¼Œè¡¨ç¤ºå…¨æ–‡åŒ¹é…ã€‚</span></span><br></pre></td></tr></table></figure><p>ä½†ç°åœ¨ï¼Œæˆ‘è¦æ›¿æ¢çš„ä¸æ˜¯ a è¿™ä¸ªå­—ç¬¦äº†ï¼Œè€Œæ˜¯ä»å¤–é¢ä¼ è¿›æ¥çš„ä¸€ä¸ªå˜é‡ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> key;</span><br><span class="line">string.<span class="title function_">replace</span>(key,<span class="string">&quot;b&quot;</span>);</span><br></pre></td></tr></table></figure><p>è¿™åªèƒ½æ›¿æ¢ç¬¬ä¸€ä¸ªåŒ¹é…çš„ï¼Œè¦å…¨æ–‡åŒ¹é…å°±é‡åˆ°éš¾é¢˜äº†ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string.<span class="title function_">replace</span>(<span class="regexp">/key/g</span>,<span class="string">&quot;b&quot;</span>);</span><br></pre></td></tr></table></figure><p>è¿™æ ·å†™æ˜¯ä¸è¡Œçš„ï¼Œä½†æ˜¯å˜é‡ key å¹¶ä¼ ä¸åˆ°æ­£åˆ™é‡Œé¢å»ã€‚<br>ä½†æ˜¯åæ¥å‘ç°å®˜æ–¹æ–‡æ¡£ä¸­æœ‰å¯¹è¿™ä¸ªå‡½æ•°çš„ä»‹ç»ï¼š<br>å®šä¹‰å’Œç”¨æ³• replace() æ–¹æ³•ç”¨äºåœ¨å­—ç¬¦ä¸²ä¸­ç”¨ä¸€äº›å­—ç¬¦æ›¿æ¢å¦ä¸€äº›å­—ç¬¦ï¼Œæˆ–æ›¿æ¢ä¸€ä¸ªä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„å­ä¸²ã€‚<br>è¯­æ³•ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æè¿°ï¼šå¿…éœ€ã€‚è§„å®šå­å­—ç¬¦ä¸²æˆ–è¦æ›¿æ¢çš„æ¨¡å¼çš„ RegExp å¯¹è±¡ã€‚</span></span><br><span class="line"><span class="comment">// è¯·æ³¨æ„ï¼Œå¦‚æœè¯¥å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ™å°†å®ƒä½œä¸ºè¦æ£€ç´¢çš„ç›´æ¥é‡æ–‡æœ¬æ¨¡å¼ï¼Œè€Œä¸æ˜¯é¦–å…ˆè¢«è½¬æ¢ä¸º RegExp å¯¹è±¡ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‚æ•°ï¼šreplacement</span></span><br><span class="line"><span class="comment">// æè¿°ï¼šå¿…éœ€ã€‚ä¸€ä¸ªå­—ç¬¦ä¸²å€¼ã€‚è§„å®šäº†æ›¿æ¢æ–‡æœ¬æˆ–ç”Ÿæˆæ›¿æ¢æ–‡æœ¬çš„å‡½æ•°ã€‚</span></span><br><span class="line">stringObject.<span class="title function_">replace</span>(regexp/substr,replacement)ï¼šregexp/substr</span><br></pre></td></tr></table></figure><p>è¿™é‡Œï¼Œåˆ©ç”¨ JS çš„ RegExp å¯¹è±¡ï¼Œå°† g å‚æ•°å•æ‹¿äº†å‡ºæ¥ï¼ŒåŒæ—¶ï¼Œæ­£åˆ™çš„å†…å®¹å¯ä»¥ç”¨å˜é‡æ¥ä»£æ›¿äº†ï¼ï¼ï¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string.<span class="title function_">replace</span>(<span class="keyword">new</span> <span class="title class_">RegExp</span>(key,<span class="string">&#x27;g&#x27;</span>),<span class="string">&quot;b&quot;</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
          <category> js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æƒé™è·å–ä¸æ¢å¤</title>
      <link href="/posts/6be05d04.html"/>
      <url>/posts/6be05d04.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¤åˆ¶å¦å¤–ä¸€å°æœºå™¨çš„æƒé™è¿‡æ¥</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¾—åˆ° / ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•çš„æƒé™è¡¨æ–‡ä»¶.</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">getfacl -R / &gt; /tmp/permission.bak</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cd</span> /</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ¢å¤ / ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•çš„æƒé™</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">setfacl --restore=/tmp/permission.bak</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¤åˆ¶gitæ”¹åŠ¨æ–‡ä»¶åˆ°æ–°ç›®å½•</title>
      <link href="/posts/5f109216.html"/>
      <url>/posts/5f109216.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">/bin/bash</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ ¹æ®git diff è·å–ä¸¤ä¸ªåˆ†æ”¯ä¸åŒçš„æ–‡ä»¶, å¹¶å°†å·®å¼‚æ–‡ä»¶æŒ‰ç…§ç›®å½•ç»“æ„å¤åˆ¶æŒ‡å®šç›®å½•ä¸‹</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">éœ€è¦æ‰‹åŠ¨åˆ é™¤<span class="built_in">cp</span>æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ï¼Œæ‰§è¡Œ<span class="built_in">rm</span>å‘½ä»¤é£é™©å¤ªå¤§</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é¡¹ç›®æ ¹ç›®å½•</span></span><br><span class="line">rootDir=&quot;$(dirname $(dirname &quot;$PWD&quot;))&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é»˜è®¤åœ¨é¡¹ç›®æ ¹ç›®å½•åŒçº§ä¸‹åˆ›å»ºæ–‡ä»¶</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¦‚æœæœ‰ä¼ å‚æ•°è¿›æ¥ï¼Œåˆ™ä½¿ç”¨ä¼ è¿›æ¥çš„å­—ç¬¦ä¸²å½“ä½œæ–‡ä»¶å¤¹ç›®å½•ï¼šgitDiffCp <span class="string">&#x27;/data/http/917cp&#x27;</span></span></span><br><span class="line">if [ $1 ]</span><br><span class="line">then</span><br><span class="line">  cpDir=$1</span><br><span class="line">else</span><br><span class="line">  cpDir=&quot;$(dirname $rootDir)/cp&quot;</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¦‚æœç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»º</span></span><br><span class="line">if [ ! -d $cpDir ]</span><br><span class="line">then</span><br><span class="line">  echo &quot;åˆ›å»ºç›®å½•:$cpDir&quot;</span><br><span class="line">  mkdir -p $cpDir</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">echo &quot;å¼€å§‹æ‰§è¡Œå¤åˆ¶éœ€è¦ä¸Šä¼ åˆ°çº¿ä¸Šçš„æ–‡ä»¶åˆ°ç›®å½•&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æœ¬åœ°åˆ†æ”¯å’Œçº¿ä¸Šåˆ†æ”¯ä¸ä¸€è‡´çš„æ–‡ä»¶</span></span><br><span class="line">fileList=$(git diff master origin/master --name-only)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¯»å–åˆ—è¡¨ï¼Œå°†æ–‡ä»¶å¤åˆ¶åˆ°ç›®æ ‡æ–‡ä»¶å¤¹ä¸‹ï¼Œä¿æŒåŸæœ¬çš„ç»“æ„ä¸å˜</span></span><br><span class="line">fileNum=0</span><br><span class="line">for file in $fileList</span><br><span class="line">do</span><br><span class="line">  cpPath=&quot;$cpDir/$(dirname $file)&quot;</span><br><span class="line">  if [ ! -d $cpPath ]</span><br><span class="line">  then</span><br><span class="line">    mkdir -p $cpPath</span><br><span class="line">  fi</span><br><span class="line"></span><br><span class="line">  fileStr=&quot;$rootDir/$file&quot;</span><br><span class="line">  echo &quot;å¤åˆ¶æ–‡ä»¶$fileStr==&gt;$cpDir/$file&quot;</span><br><span class="line"></span><br><span class="line">  if [ -f $fileStr ]</span><br><span class="line">  then</span><br><span class="line">    cp $fileStr &quot;$cpDir/$file&quot;</span><br><span class="line">    fileNum=$(( $fileNum+1 ))</span><br><span class="line">  fi</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">echo &quot;å¤åˆ¶æ–‡ä»¶å®Œæˆ: æ–‡ä»¶æ•°$fileNum&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
          <category> shell </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>rsyncå®‰è£…é…ç½®</title>
      <link href="/posts/86614bdd.html"/>
      <url>/posts/86614bdd.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>å®‰è£…rsyncåŒæ­¥é…ç½®,å®‰è£…rsyncåŒæ­¥å®‰è£…,rsyncå®‰è£…å‚è€ƒ:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>zyan.cc<span class="regexp">/post/</span><span class="number">379</span>/<span class="comment">#entrymore</span></span><br><span class="line">http:<span class="regexp">//</span>sookk8.blog.<span class="number">51</span>cto.com<span class="regexp">/455855/</span><span class="number">328076</span>/</span><br><span class="line">http:<span class="regexp">//</span>www.cnblogs.com<span class="regexp">/itech/</span>archive<span class="regexp">/2009/</span><span class="number">08</span><span class="regexp">/10/</span><span class="number">1542945</span>.html</span><br></pre></td></tr></table></figure><p>ä¸‹è½½:</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">https:</span>//rsync.samba<span class="meta">.org</span>/download.html</span><br><span class="line"><span class="symbol">https:</span>//download.samba<span class="meta">.org</span>/pub/rsync/</span><br></pre></td></tr></table></figure><p>æœåŠ¡å™¨ç«¯å®‰è£…:</p><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tar zxvf rsync-3.1.2.tar.gz</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cd</span> rsync-3.1.2</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./configure --prefix=/usr/local/webserver/rsync</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">make</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">make install</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">mkdir</span> /data/logs/</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">touch</span> /usr/local/webserver/rsync/rsyncd.conf</span></span><br></pre></td></tr></table></figure><p>ä¸»æœåŠ¡å™¨:192.168.1.212<br>å¤‡ä»½æœåŠ¡å™¨:192.168.1.213</p><p>ä¸€ã€ä¸»æœåŠ¡å™¨<br>æ–°å¢ä¿®æ”¹ä¸»é…ç½®æ–‡ä»¶, å¤åˆ¶ç²˜è´´ç°è‰²åŒºåŸŸå¦‚ä¸‹å†…å®¹    </p><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">vi /usr/local/webserver/rsync/rsyncd.conf</span></span><br></pre></td></tr></table></figure><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### å…¨å±€å‚æ•° ###</span></span><br><span class="line"><span class="attribute">port</span>=873</span><br><span class="line"><span class="attribute">uid</span>=root</span><br><span class="line"><span class="attribute">gid</span>=root</span><br><span class="line">motd <span class="attribute">file</span>=/usr/local/webserver/rsync/rsyncd.motd</span><br><span class="line">log <span class="attribute">file</span>=/data/logs/rsyncd.log</span><br><span class="line">pid <span class="attribute">file</span>=/var/run/rsyncd.pid</span><br><span class="line"><span class="comment">###</span></span><br><span class="line">[data_917]</span><br><span class="line"><span class="attribute">path</span>=/data/http/917.com/</span><br><span class="line">ignore errors</span><br><span class="line">read <span class="attribute">only</span>=<span class="literal">no</span></span><br><span class="line">hosts allow = 192.168.1.213</span><br><span class="line">hosts deny = 0.0.0.0/32</span><br><span class="line"><span class="comment">###</span></span><br><span class="line">[data_pachong]</span><br><span class="line"><span class="attribute">path</span>=/data/http/917.com/</span><br><span class="line">ignore errors</span><br><span class="line">read <span class="attribute">only</span>=<span class="literal">no</span></span><br><span class="line">hosts allow = 192.168.1.213</span><br><span class="line">hosts deny = 0.0.0.0/32</span><br></pre></td></tr></table></figure><p>åˆ›å»ºä¿®æ”¹rysncæœåŠ¡å™¨ä¿¡æ¯, å¤åˆ¶ç²˜è´´ç°è‰²åŒºåŸŸå¦‚ä¸‹å†…å®¹</p><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="string">&#x27;welcome use rsync service&#x27;</span> &gt;&gt; /usr/local/webserver/rsync/rsyncd.motd</span></span><br></pre></td></tr></table></figure><p>å¯åŠ¨æœåŠ¡</p><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">/usr/local/webserver/rsync/bin/rsync --daemon --config=/usr/local/webserver/rsync/rsyncd.conf</span></span><br></pre></td></tr></table></figure><p>Â Â <br>äºŒã€å¤‡ç”¨æœåŠ¡å™¨<br>å®‰è£…å’Œä¸»æœåŠ¡å™¨ä¸€æ ·, æ— éœ€é…ç½®</p><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">/usr/local/webserver/rsync/bin/rsync -vzrtopg --progress --delete root@192.168.1.212::data_web /data/http/web</span></span><br></pre></td></tr></table></figure><p>å®šæ—¶è„šæœ¬é…ç½®</p><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">vi /var/spool/cron/root</span></span><br><span class="line">*/30 * * * * /usr/local/webserver/rsync/bin/rsync -vzrtopg --progress --delete root@192.168.1.212::data_web /data/http/web</span><br></pre></td></tr></table></figure><p>ä¸‰ã€è¯­æ³•è§£æ</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">åœ¨é…ç½®å®ŒrsyncæœåŠ¡å™¨åï¼Œå°±å¯ä»¥ä»å®¢æˆ·ç«¯å‘å‡ºrsyncå‘½ä»¤æ¥å®ç°å„ç§åŒæ­¥çš„æ“ä½œã€‚rsyncæœ‰å¾ˆå¤šåŠŸèƒ½é€‰é¡¹ï¼Œä¸‹é¢å°±å¯¹ä»‹ç»ä¸€ä¸‹å¸¸ç”¨çš„é€‰é¡¹ï¼š</span><br><span class="line"></span><br><span class="line">rsyncçš„å‘½ä»¤æ ¼å¼å¯ä»¥ä¸ºï¼š</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>. rsync <span class="selector-attr">[OPTION]</span>... SRC <span class="selector-attr">[SRC]</span>... <span class="selector-attr">[USER@]</span>HOST:DEST</span><br><span class="line"><span class="number">2</span>. rsync <span class="selector-attr">[OPTION]</span>... <span class="selector-attr">[USER@]</span>HOST:SRC DEST</span><br><span class="line"><span class="number">3</span>. rsync <span class="selector-attr">[OPTION]</span>... SRC <span class="selector-attr">[SRC]</span>... DEST</span><br><span class="line"><span class="number">4</span>. rsync <span class="selector-attr">[OPTION]</span>... <span class="selector-attr">[USER@]</span>HOST::SRC <span class="selector-attr">[DEST]</span></span><br><span class="line"><span class="number">5</span>. rsync <span class="selector-attr">[OPTION]</span>... SRC <span class="selector-attr">[SRC]</span>... <span class="selector-attr">[USER@]</span>HOST::DEST</span><br><span class="line"><span class="number">6</span>. rsync <span class="selector-attr">[OPTION]</span>... rsync:<span class="comment">//[USER@]HOST[:PORT]/SRC [DEST]</span></span><br><span class="line"></span><br><span class="line">rsyncæœ‰å…­ç§ä¸åŒçš„å·¥ä½œæ¨¡å¼ï¼š</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>. æ‹·è´æœ¬åœ°æ–‡ä»¶ï¼›å½“SRCå’ŒDESè·¯å¾„ä¿¡æ¯éƒ½ä¸åŒ…å«æœ‰å•ä¸ªå†’å·<span class="string">&quot;:&quot;</span>åˆ†éš”ç¬¦æ—¶å°±å¯åŠ¨è¿™ç§å·¥ä½œæ¨¡å¼ã€‚</span><br><span class="line"><span class="number">2</span>.ä½¿ç”¨ä¸€ä¸ªè¿œç¨‹shellç¨‹åºï¼ˆå¦‚rshã€sshï¼‰æ¥å®ç°å°†æœ¬åœ°æœºå™¨çš„å†…å®¹æ‹·è´åˆ°è¿œç¨‹æœºå™¨ã€‚å½“DSTè·¯å¾„åœ°å€åŒ…å«å•ä¸ªå†’å·<span class="string">&quot;:&quot;</span>åˆ†éš”ç¬¦æ—¶å¯åŠ¨è¯¥æ¨¡å¼ã€‚</span><br><span class="line"><span class="number">3</span>.ä½¿ç”¨ä¸€ä¸ªè¿œç¨‹shellç¨‹åºï¼ˆå¦‚rshã€sshï¼‰æ¥å®ç°å°†è¿œç¨‹æœºå™¨çš„å†…å®¹æ‹·è´åˆ°æœ¬åœ°æœºå™¨ã€‚å½“SRCåœ°å€è·¯å¾„åŒ…å«å•ä¸ªå†’å·<span class="string">&quot;:&quot;</span>åˆ†éš”ç¬¦æ—¶å¯åŠ¨è¯¥æ¨¡å¼ã€‚</span><br><span class="line"><span class="number">4</span>. ä»è¿œç¨‹rsyncæœåŠ¡å™¨ä¸­æ‹·è´æ–‡ä»¶åˆ°æœ¬åœ°æœºã€‚å½“SRCè·¯å¾„ä¿¡æ¯åŒ…å«<span class="string">&quot;::&quot;</span>åˆ†éš”ç¬¦æ—¶å¯åŠ¨è¯¥æ¨¡å¼ã€‚</span><br><span class="line"><span class="number">5</span>. ä»æœ¬åœ°æœºå™¨æ‹·è´æ–‡ä»¶åˆ°è¿œç¨‹rsyncæœåŠ¡å™¨ä¸­ã€‚å½“DSTè·¯å¾„ä¿¡æ¯åŒ…å«<span class="string">&quot;::&quot;</span>åˆ†éš”ç¬¦æ—¶å¯åŠ¨è¯¥æ¨¡å¼ã€‚</span><br><span class="line"><span class="number">6</span>. åˆ—è¿œç¨‹æœºçš„æ–‡ä»¶åˆ—è¡¨ã€‚è¿™ç±»ä¼¼äºrsyncä¼ è¾“ï¼Œä¸è¿‡åªè¦åœ¨å‘½ä»¤ä¸­çœç•¥æ‰æœ¬åœ°æœºä¿¡æ¯å³å¯ã€‚</span><br><span class="line">-<span class="selector-tag">a</span> ä»¥archiveæ¨¡å¼æ“ä½œã€å¤åˆ¶ç›®å½•ã€ç¬¦å·è¿æ¥ ç›¸å½“äº-rlptgoD</span><br><span class="line"></span><br><span class="line">rsyncä¸­çš„å‚æ•°</span><br><span class="line"></span><br><span class="line">-<span class="attribute">r</span> æ˜¯é€’å½’</span><br><span class="line">-l æ˜¯é“¾æ¥æ–‡ä»¶ï¼Œæ„æ€æ˜¯æ‹·è´é“¾æ¥æ–‡ä»¶ï¼›-<span class="selector-tag">p</span> è¡¨ç¤ºä¿æŒæ–‡ä»¶åŸæœ‰æƒé™ï¼›-t ä¿æŒæ–‡ä»¶åŸæœ‰æ—¶é—´ï¼›-<span class="selector-tag">g</span> ä¿æŒæ–‡ä»¶åŸæœ‰ç”¨æˆ·ç»„ï¼›-o ä¿æŒæ–‡ä»¶åŸæœ‰å±ä¸»ï¼›-D ç›¸å½“äºå—è®¾å¤‡æ–‡ä»¶ï¼›</span><br><span class="line">-z ä¼ è¾“æ—¶å‹ç¼©ï¼›</span><br><span class="line">-P ä¼ è¾“è¿›åº¦ï¼›</span><br><span class="line">-v ä¼ è¾“æ—¶çš„è¿›åº¦ç­‰ä¿¡æ¯ï¼Œå’Œ-Pæœ‰ç‚¹å…³ç³»ï¼Œè‡ªå·±è¯•è¯•ã€‚å¯ä»¥çœ‹æ–‡æ¡£ï¼›</span><br><span class="line">-e sshçš„å‚æ•°å»ºç«‹èµ·åŠ å¯†çš„è¿æ¥ã€‚</span><br><span class="line">-uåªè¿›è¡Œæ›´æ–°ï¼Œé˜²æ­¢æœ¬åœ°æ–°æ–‡ä»¶è¢«é‡å†™ï¼Œæ³¨æ„ä¸¤è€…æœºå™¨çš„æ—¶é’Ÿçš„åŒæ—¶</span><br><span class="line"><span class="attr">--progress</span>æ˜¯æŒ‡æ˜¾ç¤ºå‡ºè¯¦ç»†çš„è¿›åº¦æƒ…å†µ</span><br><span class="line"><span class="attr">--delete</span>æ˜¯æŒ‡å¦‚æœæœåŠ¡å™¨ç«¯åˆ é™¤äº†è¿™ä¸€æ–‡ä»¶ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯ä¹Ÿç›¸åº”æŠŠæ–‡ä»¶åˆ é™¤ï¼Œä¿æŒçœŸæ­£çš„ä¸€è‡´</span><br><span class="line"><span class="attr">--password-file</span>=/password/path/fileæ¥æŒ‡å®šå¯†ç æ–‡ä»¶ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨è„šæœ¬ä¸­ä½¿ç”¨è€Œæ— éœ€äº¤äº’å¼åœ°è¾“å…¥éªŒè¯å¯†ç äº†ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯è¿™ä»½å¯†ç æ–‡ä»¶æƒé™å±æ€§è¦è®¾å¾—åªæœ‰å±ä¸»å¯è¯»ã€‚</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
          <category> rsync </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸»ä¸»åŒæ­¥</title>
      <link href="/posts/c3d98a2c.html"/>
      <url>/posts/c3d98a2c.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="MYSQLä¸»ä¸»åŒæ­¥"><a href="#MYSQLä¸»ä¸»åŒæ­¥" class="headerlink" title="MYSQLä¸»ä¸»åŒæ­¥"></a>MYSQLä¸»ä¸»åŒæ­¥</h1><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># ä¸»æœåŠ¡å™¨ 192.168.1.212 master</span></span><br><span class="line"><span class="meta"># ä»æœåŠ¡å™¨ 192.168.1.213 slave</span></span><br></pre></td></tr></table></figure><br><h1 id="ä¸»æœåŠ¡å™¨é…ç½®"><a href="#ä¸»æœåŠ¡å™¨é…ç½®" class="headerlink" title="ä¸»æœåŠ¡å™¨é…ç½®"></a>ä¸»æœåŠ¡å™¨é…ç½®</h1><h2 id="ä¸€ã€é…ç½®my-cnf"><a href="#ä¸€ã€é…ç½®my-cnf" class="headerlink" title="ä¸€ã€é…ç½®my.cnf"></a>ä¸€ã€é…ç½®my.cnf</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">vim my.cnf</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">log-bin=mysql-bin-master</span><br><span class="line">server-id=212</span><br><span class="line">binlog-ignore-db = mysql</span><br><span class="line">#æŠŠä»åº“çš„å†™æ“ä½œè®°å½•åˆ°binlogä¸­</span><br><span class="line">log-slave-updates = 1</span><br><span class="line"></span><br><span class="line"># å¤„ç†ä¸»é”®å†²çª</span><br><span class="line">auto-increment-increment = 2</span><br><span class="line">auto-increment-offset = 1</span><br><span class="line"></span><br><span class="line"># å¼€å¯gtidæ¨¡å¼</span><br><span class="line"># é»˜è®¤é…ç½®égtidæ¨¡å¼ï¼Œå¦‚éœ€å¼€å¯gtidæ¨¡å¼ï¼Œéœ€åšä»¥ä¸‹ä¿®æ”¹</span><br><span class="line"># å‘½ä»¤ä¸­ MASTER_LOG_FILE=&#x27;mysql-bin.000255&#x27;,MASTER_LOG_POS=120 æ”¹ä¸º MASTER_AUTO_POSITION=1;</span><br><span class="line">gtid_mode = on</span><br><span class="line"># ä¸€è‡´æ€§</span><br><span class="line">enforce_gtid_consistency = 1</span><br></pre></td></tr></table></figure><h2 id="äºŒã€é‡å¯mysql"><a href="#äºŒã€é‡å¯mysql" class="headerlink" title="äºŒã€é‡å¯mysql"></a>äºŒã€é‡å¯mysql</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">kill</span> -USR2 `<span class="built_in">cat</span> /data/mysqlData/mysql.pid`</span></span><br></pre></td></tr></table></figure><h2 id="ä¸‰ã€åˆ›å»ºè´¦å·å¹¶ä¸”æˆæƒ"><a href="#ä¸‰ã€åˆ›å»ºè´¦å·å¹¶ä¸”æˆæƒ" class="headerlink" title="ä¸‰ã€åˆ›å»ºè´¦å·å¹¶ä¸”æˆæƒ"></a>ä¸‰ã€åˆ›å»ºè´¦å·å¹¶ä¸”æˆæƒ</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;grant replication slave on  to &#x27;tongbu&#x27;@&#x27;192.168.1.213&#x27; identified by &#x27;123456&#x27;;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># mysql8</span><br><span class="line">mysql&gt; CREATE USER &#x27;tongbu&#x27;@&#x27;192.168.1.213&#x27; IDENTIFIED BY &#x27;123456&#x27;;</span><br><span class="line">mysql&gt;GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, RELOAD, PROCESS, REFERENCES, INDEX, ALTER, SHOW DATABASES, SUPER, CREATE TEMPORARY TABLES, LOCK TABLES, EXECUTE, REPLICATION SLAVE, REPLICATION CLIENT, CREATE VIEW, SHOW VIEW, CREATE ROUTINE, ALTER ROUTINE, CREATE USER, EVENT, TRIGGER, CREATE ROLE, DROP ROLE ON *.* TO `tongbu`@`192.168.1.213` WITH GRANT OPTION;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><h2 id="å››ã€æŸ¥çœ‹binlogæ–‡ä»¶ä»¥åŠpos"><a href="#å››ã€æŸ¥çœ‹binlogæ–‡ä»¶ä»¥åŠpos" class="headerlink" title="å››ã€æŸ¥çœ‹binlogæ–‡ä»¶ä»¥åŠpos"></a>å››ã€æŸ¥çœ‹binlogæ–‡ä»¶ä»¥åŠpos</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;show master status;</span><br></pre></td></tr></table></figure><h2 id="äº”ã€å¯¼å‡ºæ•°æ®åº“"><a href="#äº”ã€å¯¼å‡ºæ•°æ®åº“" class="headerlink" title="äº”ã€å¯¼å‡ºæ•°æ®åº“"></a>äº”ã€å¯¼å‡ºæ•°æ®åº“</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump  -uroot -p123456 cat&gt;cat.sql</span><br></pre></td></tr></table></figure><h2 id="å…­ã€å°†æ•°æ®åº“ä¼ åˆ°ä»æœåŠ¡å™¨"><a href="#å…­ã€å°†æ•°æ®åº“ä¼ åˆ°ä»æœåŠ¡å™¨" class="headerlink" title="å…­ã€å°†æ•°æ®åº“ä¼ åˆ°ä»æœåŠ¡å™¨"></a>å…­ã€å°†æ•°æ®åº“ä¼ åˆ°ä»æœåŠ¡å™¨</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">scp cat.sql  192.168.1.213:/data</span></span><br></pre></td></tr></table></figure><h2 id="ä¸ƒã€mysqlå‘½ä»¤è¡Œä¸‹é…ç½®slave-logfileå’Œlogposéœ€è¦åœ¨213ä½¿ç”¨show-master-status"><a href="#ä¸ƒã€mysqlå‘½ä»¤è¡Œä¸‹é…ç½®slave-logfileå’Œlogposéœ€è¦åœ¨213ä½¿ç”¨show-master-status" class="headerlink" title="ä¸ƒã€mysqlå‘½ä»¤è¡Œä¸‹é…ç½®slave logfileå’Œlogposéœ€è¦åœ¨213ä½¿ç”¨show master status;"></a>ä¸ƒã€mysqlå‘½ä»¤è¡Œä¸‹é…ç½®slave logfileå’Œlogposéœ€è¦åœ¨213ä½¿ç”¨show master status;</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;CHANGE MASTER TO MASTER_HOST=&#x27;192.168.1.213&#x27;,MASTER_USER=&#x27;tongbu&#x27;,MASTER_PASSWORD=&#x27;123456&#x27;,</span><br><span class="line">MASTER_LOG_FILE=&#x27;mysql-bin.000255&#x27;,MASTER_LOG_POS=120;</span><br><span class="line">mysql&gt;start slave;</span><br><span class="line">mysql&gt;show slave status \G;</span><br></pre></td></tr></table></figure><br><h1 id="ä»æœåŠ¡å™¨é…ç½®"><a href="#ä»æœåŠ¡å™¨é…ç½®" class="headerlink" title="ä»æœåŠ¡å™¨é…ç½®"></a>ä»æœåŠ¡å™¨é…ç½®</h1><h2 id="ä¸€ã€é…ç½®my-cnf-1"><a href="#ä¸€ã€é…ç½®my-cnf-1" class="headerlink" title="ä¸€ã€é…ç½®my.cnf"></a>ä¸€ã€é…ç½®my.cnf</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">vim my.cnf</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">log-bin=mysql-bin-master</span><br><span class="line">server-id=213</span><br><span class="line">binlog-ignore-db = mysql</span><br><span class="line">#æŠŠä»åº“çš„å†™æ“ä½œè®°å½•åˆ°binlogä¸­</span><br><span class="line">log-slave-updates = 1</span><br><span class="line"># å¤„ç†ä¸»é”®å†²çª</span><br><span class="line"># mysqlçš„æœåŠ¡å™¨å˜é‡auto_increment_incrementã€å¢é•¿å€¼ã€‘å’Œauto_increment_offsetã€åç§»é‡ã€‘å¯ä»¥åè°ƒå¤šä¸»æœåŠ¡å™¨å¤åˆ¶å’ŒAUTO_INCREMENTåˆ—ã€‚</span><br><span class="line"># å¹¶ä¸”æ¯ä¸ªå˜é‡æœ‰ä¸€ä¸ªé»˜è®¤çš„(å¹¶ä¸”æ˜¯æœ€å°çš„)å€¼1ï¼Œæœ‰ä¸€ä¸ªæœ€å¤§å€¼65,535ã€‚æŠŠè¿™äº›å˜é‡è®¾ç½®ä¸ºéå†²çªçš„å€¼ï¼Œä¾‹å¦‚åœ¨åŒ ä¸€ä¸ªè¡¨æ’å…¥æ–°è¡Œæ—¶ï¼Œ</span><br><span class="line"># å¤šä¸»æœåŠ¡å™¨é…ç½®ä¸»çš„æœåŠ¡å™¨å°±ä¸ä¼šå‘ç”ŸAUTO_INCREMENTå€¼å†²çªï¼Œè¿™é‡Œå°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜</span><br><span class="line">auto-increment-increment = 2</span><br><span class="line">auto-increment-offset = 2</span><br><span class="line"></span><br><span class="line"># å¼€å¯gtidæ¨¡å¼</span><br><span class="line"># é»˜è®¤é…ç½®égtidæ¨¡å¼ï¼Œå¦‚éœ€å¼€å¯gtidæ¨¡å¼ï¼Œéœ€åšä»¥ä¸‹ä¿®æ”¹</span><br><span class="line"># å‘½ä»¤ä¸­ MASTER_LOG_FILE=&#x27;mysql-bin.000255&#x27;,MASTER_LOG_POS=120 æ”¹ä¸º MASTER_AUTO_POSITION=1;</span><br><span class="line">gtid_mode = on</span><br><span class="line"># ä¸€è‡´æ€§</span><br><span class="line">enforce_gtid_consistency = 1</span><br></pre></td></tr></table></figure><h2 id="äºŒã€é‡å¯mysql-1"><a href="#äºŒã€é‡å¯mysql-1" class="headerlink" title="äºŒã€é‡å¯mysql"></a>äºŒã€é‡å¯mysql</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">kill</span> -USR2 `<span class="built_in">cat</span> /data/mysqlData/mysql.pid`</span></span><br></pre></td></tr></table></figure><h2 id="ä¸‰ã€åˆ›å»ºè´¦å·å¹¶ä¸”æˆæƒ-1"><a href="#ä¸‰ã€åˆ›å»ºè´¦å·å¹¶ä¸”æˆæƒ-1" class="headerlink" title="ä¸‰ã€åˆ›å»ºè´¦å·å¹¶ä¸”æˆæƒ"></a>ä¸‰ã€åˆ›å»ºè´¦å·å¹¶ä¸”æˆæƒ</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;grant replication slave on *.* to &#x27;tongbu&#x27;@&#x27;192.168.1.212&#x27; identified by &#x27;123456&#x27;;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><h2 id="å››ã€æŸ¥çœ‹binlogæ–‡ä»¶ä»¥åŠpos-1"><a href="#å››ã€æŸ¥çœ‹binlogæ–‡ä»¶ä»¥åŠpos-1" class="headerlink" title="å››ã€æŸ¥çœ‹binlogæ–‡ä»¶ä»¥åŠpos"></a>å››ã€æŸ¥çœ‹binlogæ–‡ä»¶ä»¥åŠpos</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;show master status;</span><br></pre></td></tr></table></figure><h2 id="äº”ã€mysqlå‘½ä»¤è¡Œä¸‹é…ç½®slave-logfileå’Œlogposéœ€è¦åœ¨212ä½¿ç”¨show-master-status"><a href="#äº”ã€mysqlå‘½ä»¤è¡Œä¸‹é…ç½®slave-logfileå’Œlogposéœ€è¦åœ¨212ä½¿ç”¨show-master-status" class="headerlink" title="äº”ã€mysqlå‘½ä»¤è¡Œä¸‹é…ç½®slave logfileå’Œlogposéœ€è¦åœ¨212ä½¿ç”¨show master status;"></a>äº”ã€mysqlå‘½ä»¤è¡Œä¸‹é…ç½®slave logfileå’Œlogposéœ€è¦åœ¨212ä½¿ç”¨show master status;</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;CHANGE MASTER TO MASTER_HOST=&#x27;192.168.1.212&#x27;,MASTER_USER=&#x27;tongbu&#x27;,MASTER_PASSWORD=&#x27;123456&#x27;,</span><br><span class="line">MASTER_LOG_FILE=&#x27;mysql-bin.000255&#x27;,MASTER_LOG_POS=120;</span><br></pre></td></tr></table></figure><h2 id="å…­ã€åˆ°ä¸»æœåŠ¡å™¨æŸ¥çœ‹çŠ¶æ€"><a href="#å…­ã€åˆ°ä¸»æœåŠ¡å™¨æŸ¥çœ‹çŠ¶æ€" class="headerlink" title="å…­ã€åˆ°ä¸»æœåŠ¡å™¨æŸ¥çœ‹çŠ¶æ€"></a>å…­ã€åˆ°ä¸»æœåŠ¡å™¨æŸ¥çœ‹çŠ¶æ€</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;show processlist \G;</span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€æ³¨æ„äº‹é¡¹"><a href="#ä¸‰ã€æ³¨æ„äº‹é¡¹" class="headerlink" title="ä¸‰ã€æ³¨æ„äº‹é¡¹"></a>ä¸‰ã€æ³¨æ„äº‹é¡¹</h1><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># <span class="selector-tag">binlog_format</span>ä¸ç­‰äº<span class="selector-tag">row</span>ï¼Œéœ€è¦<span class="selector-tag">use</span> <span class="selector-tag">database</span>;åæ‰§è¡Œè¯­å¥ï¼Œæ‰èƒ½å¤ŸåŒæ­¥æ•°æ®</span><br><span class="line"># <span class="selector-attr">[å…·ä½“è¯´æ˜]</span>(<span class="attribute">https</span>:<span class="comment">//blog.csdn.net/weixin_33709609/article/details/89865649)</span></span><br></pre></td></tr></table></figure><h2 id="ä¸€ã€-è·³è¿‡é”™è¯¯-égtidæ¨¡å¼"><a href="#ä¸€ã€-è·³è¿‡é”™è¯¯-égtidæ¨¡å¼" class="headerlink" title="ä¸€ã€ è·³è¿‡é”™è¯¯(égtidæ¨¡å¼)"></a>ä¸€ã€ è·³è¿‡é”™è¯¯(égtidæ¨¡å¼)</h2><h3 id="1-mysqlè¯­å¥"><a href="#1-mysqlè¯­å¥" class="headerlink" title="1. mysqlè¯­å¥"></a>1. mysqlè¯­å¥</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># è·³è¿‡æŒ‡å®šæ•°é‡çš„äº‹åŠ¡ï¼š</span><br><span class="line">mysql&gt;slave stop;</span><br><span class="line">mysql&gt;SET GLOBAL SQL_SLAVE_SKIP_COUNTER = 1        #è·³è¿‡ä¸€ä¸ªäº‹åŠ¡</span><br><span class="line">mysql&gt;slave start;</span><br></pre></td></tr></table></figure><h3 id="2-ä¿®æ”¹mysqlçš„é…ç½®æ–‡ä»¶ï¼Œé€šè¿‡slave-skip-errorså‚æ•°æ¥è·³æ‰€æœ‰é”™è¯¯æˆ–æŒ‡å®šç±»å‹çš„é”™è¯¯"><a href="#2-ä¿®æ”¹mysqlçš„é…ç½®æ–‡ä»¶ï¼Œé€šè¿‡slave-skip-errorså‚æ•°æ¥è·³æ‰€æœ‰é”™è¯¯æˆ–æŒ‡å®šç±»å‹çš„é”™è¯¯" class="headerlink" title="2.ä¿®æ”¹mysqlçš„é…ç½®æ–‡ä»¶ï¼Œé€šè¿‡slave_skip_errorså‚æ•°æ¥è·³æ‰€æœ‰é”™è¯¯æˆ–æŒ‡å®šç±»å‹çš„é”™è¯¯"></a>2.ä¿®æ”¹mysqlçš„é…ç½®æ–‡ä»¶ï¼Œé€šè¿‡slave_skip_errorså‚æ•°æ¥è·³æ‰€æœ‰é”™è¯¯æˆ–æŒ‡å®šç±»å‹çš„é”™è¯¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">vim /etc/my.cnf</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">#slave-skip-errors=1062,1053,1146 #è·³è¿‡æŒ‡å®šerror noç±»å‹çš„é”™è¯¯</span><br><span class="line">#slave-skip-errors=all #è·³è¿‡æ‰€æœ‰é”™è¯¯</span><br></pre></td></tr></table></figure><h2 id="äºŒã€è·³è¿‡é”™è¯¯-gtidæ¨¡å¼"><a href="#äºŒã€è·³è¿‡é”™è¯¯-gtidæ¨¡å¼" class="headerlink" title="äºŒã€è·³è¿‡é”™è¯¯(gtidæ¨¡å¼)"></a>äºŒã€è·³è¿‡é”™è¯¯(gtidæ¨¡å¼)</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><h2 id="ä¸‰ã€é”™è¯¯å¤„ç†"><a href="#ä¸‰ã€é”™è¯¯å¤„ç†" class="headerlink" title="ä¸‰ã€é”™è¯¯å¤„ç†"></a>ä¸‰ã€é”™è¯¯å¤„ç†</h2><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é”™è¯¯ä¿¡æ¯:</span></span><br><span class="line">Last_IO_Errno: <span class="number">1236</span></span><br><span class="line">Last_IO_Error: Got fatal error <span class="number">1236</span> from <span class="keyword">master</span> <span class="title">when</span> reading data from binary log: &#x27;Could not find first log file name <span class="keyword">in</span> binary log index file&#x27;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤„ç†æ–¹æ¡ˆ</span></span><br><span class="line"><span class="literal">Slave</span>: mysql&gt;<span class="literal">stop</span> <span class="literal">slave</span>;</span><br><span class="line"><span class="literal">Master</span>: mysql&gt;flush logs</span><br><span class="line"><span class="literal">Master</span>: mysql&gt;show <span class="keyword">master</span> <span class="title">status</span>;</span><br><span class="line"><span class="literal">Slave</span>: mysql&gt;CHANGE <span class="keyword">MASTER</span> <span class="title">TO</span> <span class="attr">MASTER_LOG_FILE=</span>&#x27;log-bin.<span class="number">00000</span>X&#x27;, <span class="attr">MASTER_LOG_POS=</span><span class="number">106</span>;</span><br><span class="line"><span class="literal">Slave</span>: mysql&gt;<span class="literal">start</span> <span class="literal">slave</span>;</span><br><span class="line"></span><br><span class="line">é”™è¯¯ä¿¡æ¯:</span><br><span class="line">ERROR <span class="number">1776</span> (HY000): Parameters MASTER_LOG_FILE, MASTER_LOG_POS, RELAY_LOG_FILE <span class="keyword">and</span> RELAY_LOG_POS cannot be set when MASTER_AUTO_POSITION is active.</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤„ç†æ–¹æ¡ˆ</span></span><br><span class="line">mysql&gt;change <span class="keyword">master</span> <span class="title">to</span> <span class="attr">master_auto_position=</span><span class="number">0</span>;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> mysql </category>
          
          <category> ä¸»ä»åŒæ­¥ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡å›¾å¯¹åº”font-weight</title>
      <link href="/posts/ec825a3a.html"/>
      <url>/posts/ec825a3a.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">å­—ä½“ç²—ç»†ï¼šâ€˜font-weightâ€™å±æ€§</span><br><span class="line">åç§°ï¼š font-weight</span><br><span class="line">å–å€¼ï¼š <span class="keyword">normal </span><span class="title">| bold |</span> <span class="keyword">bolder </span><span class="title">| lighter |</span> <span class="number">100</span> <span class="title">| 200 |</span> <span class="number">300</span> <span class="title">| 400 |</span> <span class="number">500</span> <span class="title">| 600 |</span> <span class="number">700</span> <span class="title">| 800 |</span> <span class="number">900</span></span><br><span class="line">åˆå§‹ï¼š <span class="keyword">normal</span></span><br><span class="line"><span class="keyword"></span>é€‚ç”¨äºï¼š    æ‰€æœ‰å…ƒç´ </span><br><span class="line">ç»§æ‰¿ï¼š æ˜¯</span><br><span class="line">ç™¾åˆ†æ¯”ï¼š    ï¼ˆä¸é€‚ç”¨ï¼‰</span><br><span class="line">åª’ä»‹ï¼š è§†è§‰</span><br><span class="line">è®¡ç®—å€¼ï¼š    è¯¦è§æè¿°</span><br><span class="line">åŠ¨ç”»ï¼š -</span><br><span class="line">â€˜font-weightâ€™å±æ€§æ‰§è¡Œå­—ä½“ä¸­å­—å½¢çš„é‡é‡ï¼Œè¿™å–å†³äºé»‘åº¦ç­‰çº§æˆ–ç¬”åˆ’ç²—ç»†ã€‚</span><br><span class="line">å…¶å€¼çš„æ„ä¹‰å¦‚ä¸‹ï¼š</span><br><span class="line"><span class="number">100</span>è‡³<span class="number">900</span></span><br><span class="line">è¿™äº›æœ‰åºæ’åˆ—ä¸­çš„æ¯ä¸ªå€¼ï¼Œè¡¨ç¤ºè‡³å°‘ä¸å…¶èµ·èº«æ‹¥æœ‰ç›¸åŒé»‘åº¦çš„é‡é‡ã€‚å…¶å¤§è‡´ç¬¦åˆä¸‹åˆ—é€šç”¨é‡é‡åç§°ï¼š</span><br><span class="line"><span class="number">100</span> - Thin</span><br><span class="line"><span class="number">200</span> - <span class="keyword">Extra </span>Light (Ultra Light)</span><br><span class="line"><span class="number">300</span> - Light</span><br><span class="line"><span class="number">400</span> - Regular (<span class="keyword">Normalã€Bookã€Roman)</span></span><br><span class="line"><span class="keyword"></span><span class="number">500</span> - Medium</span><br><span class="line"><span class="number">600</span> - Semi <span class="keyword">Bold </span>(Demi <span class="keyword">Bold)</span></span><br><span class="line"><span class="keyword"></span><span class="number">700</span> - <span class="keyword">Bold</span></span><br><span class="line"><span class="keyword"></span><span class="number">800</span> - <span class="keyword">Extra </span><span class="keyword">Bold </span>(Ultra <span class="keyword">Bold)</span></span><br><span class="line"><span class="keyword"></span><span class="number">900</span> - <span class="keyword">Black </span>(Heavy)</span><br><span class="line"></span><br><span class="line"><span class="keyword">normalã€regularä¸&#x27;400&#x27;ç›¸åŒã€‚</span></span><br><span class="line"><span class="keyword"></span><span class="keyword">boldä¸&#x27;700&#x27;ç›¸åŒã€‚</span></span><br><span class="line"><span class="keyword"></span><span class="keyword">bolderæŒ‡å®šå¤–è§‚çš„é‡é‡å¤§äºç»§æ‰¿çš„å€¼ã€‚</span></span><br><span class="line"><span class="keyword"></span>lighter æŒ‡å®šå¤–è§‚çš„é‡é‡å°äºç»§æ‰¿çš„å€¼ã€‚</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
          <category> css </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯ </tag>
            
            <tag> css </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windowsä¸‹å®‰è£…docker</title>
      <link href="/posts/2fce4b74.html"/>
      <url>/posts/2fce4b74.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="win7ä¸‹ä½¿ç”¨Docker-Toolboxå®‰è£…"><a href="#win7ä¸‹ä½¿ç”¨Docker-Toolboxå®‰è£…" class="headerlink" title="win7ä¸‹ä½¿ç”¨Docker Toolboxå®‰è£…"></a>win7ä¸‹ä½¿ç”¨Docker Toolboxå®‰è£…</h1><p>ä¸€ã€å›½å†…é•œåƒæº:  </p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span><span class="comment">//get.daocloud.io/  </span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//mirrors.aliyun.com/docker-toolbox/</span></span><br></pre></td></tr></table></figure><br><p>äºŒã€æ‰§è¡ŒDocker Toolboxå®‰è£…<br>ä¸‰ã€åœ¨å‘½ä»¤è¡Œ(cmd)ä¸‹æ‰§è¡Œå‘½ä»¤<br>å‚æ•°è¯´æ˜:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># --virtualbox-boot2docker-url: æŒ‡å®šboot2dockerè·¯å¾„</span></span><br><span class="line"><span class="comment"># --engine-registry-mirror: æŒ‡å®šåŠ é€Ÿåœ°å€</span></span><br><span class="line"><span class="comment"># default virtualBoxå‘½å</span></span><br></pre></td></tr></table></figure><p>1.ä¸€ç§æ–¹å¼æ˜¯åœ¨åˆ›å»ºçš„æ—¶å€™ç›´æ¥è®¾ç½®åŠ é€Ÿåœ°å€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨cmdä¸­æ‰§è¡Œåˆ›å»ºå‘½ä»¤</span></span><br><span class="line">$ docker-machine create --driver virtualbox --virtualbox-boot2docker-url=/Users/Administrator/.docker/machine/cache/boot2docker.iso --engine-registry-mirror=http://f1361db2.m.daocloud.io default</span><br><span class="line"></span><br></pre></td></tr></table></figure><br><p>2.å¦å¤–ä¸€ç§æ–¹å¼æ˜¯å…ˆåˆ›å»ºvirtualBox, ç„¶åè®¾ç½®åŠ é€Ÿåœ°å€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨cmdåˆ›å»ºvirtualBox</span></span><br><span class="line">$ docker-machine create --driver virtualbox --virtualbox-boot2docker-url=/Users/Administrator/.docker/machine/cache/boot2docker.iso default</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥virtualBoxä¸­</span></span><br><span class="line">$ docker-machine ssh default</span><br><span class="line"><span class="comment"># åœ¨è¿›å…¥virtualBoxåæ‰§è¡Œå‘½ä»¤, å°†åŠ é€Ÿåœ°å€æ·»åŠ åˆ°æ–‡ä»¶ä¸­ --label provider=virtualbox çš„ä¸‹ä¸€è¡Œ</span></span><br><span class="line">$ <span class="built_in">sudo</span> sed -i <span class="string">&quot;s|EXTRA_ARGS=&#x27;|EXTRA_ARGS=&#x27;--registry-mirror=åŠ é€Ÿåœ°å€ |g&quot;</span> /var/lib/boot2docker/profile</span><br><span class="line"><span class="comment"># æˆ–è€…sudo vim /var/lib/boot2docker/profile </span></span><br><span class="line"><span class="comment"># åœ¨â€“label provider=virtualboxçš„ä¸‹ä¸€è¡Œæ·»åŠ --registry-mirror åŠ é€Ÿå™¨åœ°å€(https://dockerhub.azk8s.cn https://reg-mirror.qiniu.com)</span></span><br><span class="line"><span class="comment"># é€€å‡ºvirtualBox</span></span><br><span class="line">$ <span class="built_in">exit</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é€€å‡ºå, å›åˆ°cmdå‘½ä»¤ç•Œé¢, æ‰§è¡Œdockeré‡å¯æ“ä½œ</span></span><br><span class="line">$ docker-machine restart default</span><br><span class="line"><span class="comment"># æ‰§è¡Œdocker info, å¦‚æœæ²¡æœ‰è¾“å‡ºæ•°æ®åˆ™æ‰§è¡Œ</span></span><br><span class="line">$ docker-machine <span class="built_in">env</span> default</span><br><span class="line"><span class="comment"># æ‰§è¡Œåä¼šå‡ºç° export xxxx Run this command to configure your shell:çš„è¯­å¥, æŒ‰ç…§æç¤ºæ‰§è¡Œè¯­å¥</span></span><br><span class="line">$ <span class="built_in">eval</span> $(<span class="string">&quot;C:\Program Files\Docker Toolbox\docker-machine.exe&quot;</span> <span class="built_in">env</span> default)</span><br><span class="line"><span class="comment"># ç»§ç»­æµ‹è¯•docker info, å¦‚æœè¾“å‡ºæ•°æ®åˆ™è¯´æ˜æˆåŠŸ, å¯ä»¥é€šè¿‡docker pull é•œåƒæ‰§è¡Œé•œåƒä¸‹è½½</span></span><br><span class="line">$ docker pull ubuntu</span><br></pre></td></tr></table></figure><br><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">ssh</span> ç”¨æˆ·åé»˜è®¤æ˜¯ï¼šdocker  å¯†ç é»˜è®¤ï¼štcuser  ç«¯å£ï¼š<span class="number">22</span></span><br></pre></td></tr></table></figure><h1 id="Dockerè™šæ‹Ÿæœºæ–‡ä»¶åœ°å€ä¿®æ”¹"><a href="#Dockerè™šæ‹Ÿæœºæ–‡ä»¶åœ°å€ä¿®æ”¹" class="headerlink" title="Dockerè™šæ‹Ÿæœºæ–‡ä»¶åœ°å€ä¿®æ”¹"></a>Dockerè™šæ‹Ÿæœºæ–‡ä»¶åœ°å€ä¿®æ”¹</h1><p>ä¸€ã€æœªå®‰è£…æ—¶ç›´æ¥ä¿®æ”¹å­˜å‚¨ä½ç½®</p><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>ã€åœ¨Windowsçš„ç³»ç»Ÿç¯å¢ƒæ·»åŠ MACHINE_STORAGE_PATH ï¼ŒæŒ‡å‘è™šæ‹Ÿæœºçš„ä½ç½®ï¼ˆæˆ‘æ¨èD:\VM\machine\machinesï¼‰</span><br><span class="line"><span class="number">2</span>ã€å¤åˆ¶boot2docker.isoåˆ°è™šæ‹Ÿæœºçš„ä½ç½®åŒçº§ç›®å½•<span class="keyword">cache</span>ä¸Šï¼ˆD:\VM\machine\<span class="keyword">cache</span>ï¼‰</span><br></pre></td></tr></table></figure><p>äºŒã€å·²å®‰è£…çš„è¿›è¡Œè¿ç§»</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>ä½¿ç”¨docker-machine stop <span class="keyword">default</span>åœæ‰Dockerçš„è™šæ‹Ÿæœºã€‚</span><br><span class="line"><span class="number">2.</span>æ‰“å¼€VirtualBoxï¼Œé€‰æ‹©â€œç®¡ç†â€èœå•ä¸‹çš„â€œè™šæ‹Ÿä»‹è´¨ç®¡ç†â€ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°Dockerè™šæ‹Ÿæœºç”¨çš„è™šæ‹Ÿç¡¬ç›˜çš„æ–‡ä»¶diskã€‚</span><br><span class="line"><span class="number">3.</span>é€‰ä¸­â€œdiskâ€ï¼Œç„¶åç‚¹å‡»èœå•ä¸­çš„â€œå¤åˆ¶â€å‘½ä»¤ï¼Œæ ¹æ®å‘å¯¼ï¼ŒæŠŠå½“å‰çš„diskå¤åˆ¶åˆ°å¦ä¸€ä¸ªç›˜ä¸Šé¢å»ã€‚</span><br><span class="line"><span class="number">4.</span>å›åˆ°VirtualBoxä¸»ç•Œé¢ï¼Œå³é”®â€œ<span class="keyword">default</span>â€è¿™ä¸ªè™šæ‹Ÿæœºï¼Œé€‰æ‹©â€œè®¾ç½®â€å‘½ä»¤ï¼Œåœ¨å¼¹å‡ºçš„çª—å£ä¸­é€‰æ‹©â€œå­˜å‚¨â€é€‰é¡¹ã€‚</span><br><span class="line"><span class="number">5.</span>æŠŠdiskä»â€œæ§åˆ¶å™¨SATAâ€ä¸­åˆ é™¤ï¼Œç„¶åé‡æ–°æ·»åŠ æˆ‘ä»¬åˆšæ‰å¤åˆ¶åˆ°å¦å¤–ä¸€ä¸ªç£ç›˜ä¸Šçš„é‚£ä¸ªæ–‡ä»¶ã€‚</span><br></pre></td></tr></table></figure><br><h1 id="å¯èƒ½ä¼šé‡åˆ°çš„å‘"><a href="#å¯èƒ½ä¼šé‡åˆ°çš„å‘" class="headerlink" title="å¯èƒ½ä¼šé‡åˆ°çš„å‘"></a>å¯èƒ½ä¼šé‡åˆ°çš„å‘</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç›´æ¥ä½¿ç”¨docker run è¿è¡Œubuntuçš„é•œåƒæ—¶ä¼šå‡ºç° </span></span><br><span class="line"><span class="comment"># the input device is not a TTY.  If you are using mintty, try prefixing the command with &#x27;winpty&#x27; çš„é”™è¯¯</span></span><br><span class="line">$ winpty docker run -it ubuntu bash</span><br></pre></td></tr></table></figure><h1 id="win7ä½¿ç”¨toolboxæŒ‚è½½å¤±è´¥"><a href="#win7ä½¿ç”¨toolboxæŒ‚è½½å¤±è´¥" class="headerlink" title="win7ä½¿ç”¨toolboxæŒ‚è½½å¤±è´¥"></a>win7ä½¿ç”¨toolboxæŒ‚è½½å¤±è´¥</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ä¿®æ”¹virtualboxä¸­ï¼Œè®¾ç½®å…±äº«æ–‡ä»¶å¤¹</span><br><span class="line">å‡è®¾æœ¬åœ°åœ°å€ä¸ºd:\dnmp,æ–‡ä»¶åä¸º<span class="regexp">/d/</span>dnmp,dnmpæ–‡ä»¶å¤¹éœ€è¦æ”¾åœ¨ç›˜æ ¹ç›®å½•ï¼ŒåŸå› æœªçŸ¥</span><br></pre></td></tr></table></figure><p>docker windowsç¯å¢ƒå˜é‡</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">COMPOSE_CONVERT_WINDOWS_PATHS</span><span class="symbol">:true</span></span><br><span class="line"><span class="variable constant_">DOCKER_CERT_PATH</span><span class="symbol">:D</span><span class="symbol">:</span>\dockerVM\machines\default</span><br><span class="line"><span class="variable constant_">DOCKER_HOST</span><span class="symbol">:tcp</span><span class="symbol">://localhost</span><span class="symbol">:</span><span class="number">2376</span></span><br><span class="line"><span class="variable constant_">DOCKER_MACHINE_NAME</span><span class="symbol">:default</span></span><br><span class="line"><span class="variable constant_">DOCKER_TLS_VERIFY</span><span class="symbol">:</span><span class="number">0</span></span><br><span class="line"><span class="variable constant_">MACHINE_STORAGE_PATH</span><span class="symbol">:D</span><span class="symbol">:</span>\dockerVM</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> Docker </category>
          
          <category> æ–‡æ¡£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‚è®°</title>
      <link href="/posts/430d67de.html"/>
      <url>/posts/430d67de.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># <span class="attribute">offset</span>()<span class="selector-class">.top</span>å’ŒoffsetTopåŒºåˆ«</span><br><span class="line"><span class="attribute">offset</span>()<span class="selector-class">.top</span>è·å–å’Œdocumentè·ç¦»</span><br><span class="line">offsetTopè·å–å’Œçˆ¶ç±»è·ç¦»(offsetParent()è·å–çˆ¶ç±»)</span><br></pre></td></tr></table></figure><h1 id="å¤„ç†é¡µé¢è·³è½¬åä¿®æ”¹class"><a href="#å¤„ç†é¡µé¢è·³è½¬åä¿®æ”¹class" class="headerlink" title="å¤„ç†é¡µé¢è·³è½¬åä¿®æ”¹class"></a>å¤„ç†é¡µé¢è·³è½¬åä¿®æ”¹class</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–¹æ³•1</span></span><br><span class="line"><span class="keyword">var</span> links = $(<span class="string">&#x27;.navigation&gt;li&#x27;</span>).<span class="title function_">find</span>(<span class="string">&#x27;a&#x27;</span>),</span><br><span class="line">  index = <span class="number">0</span>,<span class="comment">//é»˜è®¤ç¬¬ä¸€ä¸ªèœå•é¡¹</span></span><br><span class="line">  url = location.<span class="property">href</span>.<span class="title function_">split</span>(<span class="string">&#x27;?&#x27;</span>)[<span class="number">0</span>].<span class="title function_">split</span>(<span class="string">&#x27;/&#x27;</span>).<span class="title function_">pop</span>();<span class="comment">//å–å½“å‰URLæœ€åä¸€ä¸ª / åé¢çš„æ–‡ä»¶å</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(url)&#123;<span class="comment">//å¦‚æœæœ‰å–åˆ°, åˆ™è¿›è¡ŒåŒ¹é…, å¦åˆ™é»˜è®¤ä¸ºé¦–é¡µ(å³indexçš„å€¼æ‰€æŒ‡å‘çš„é‚£ä¸ª)</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i=links.<span class="property">length</span>; i--;) &#123;<span class="comment">//éå† menu çš„ä¸­è¿æ¥åœ°å€</span></span><br><span class="line">     <span class="keyword">if</span>(links[i].<span class="property">href</span>.<span class="title function_">indexOf</span>(url) !== -<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>($(<span class="variable language_">this</span>));</span><br><span class="line">        index = i;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">     &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// links[index].parent.className = &#x27;active&#x27;;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹æ³•2</span></span><br><span class="line">$(<span class="string">&#x27;.on&#x27;</span>).<span class="title function_">removeClass</span>(<span class="string">&#x27;on&#x27;</span>);</span><br><span class="line">$(<span class="string">&quot;.navigation li a&quot;</span>).<span class="title function_">each</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">   $this = $(<span class="variable language_">this</span>);</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span>($this[<span class="number">0</span>].<span class="property">href</span>==<span class="title class_">String</span>(<span class="variable language_">window</span>.<span class="property">location</span>))&#123;</span><br><span class="line">      $this.<span class="title function_">parent</span>().<span class="title function_">addClass</span>(<span class="string">&#x27;on&#x27;</span>);</span><br><span class="line">      $this.<span class="title function_">parents</span>(<span class="string">&#x27;li&#x27;</span>).<span class="title function_">addClass</span>(<span class="string">&#x27;on&#x27;</span>);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="floatToString"><a href="#floatToString" class="headerlink" title="floatToString"></a>floatToString</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**2.0   --&gt;   &#x27;2.0&#x27;</span></span><br><span class="line"><span class="comment">2.123 --&gt;   &#x27;2.123&#x27;</span></span><br><span class="line"><span class="comment">0.05  --&gt;   &#x27;0.05&#x27;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">floatToString</span>(<span class="params">num</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(num%<span class="number">1</span> == <span class="number">0</span>)</span><br><span class="line">        num = num.<span class="title function_">toFixed</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="jså¤åˆ¶object"><a href="#jså¤åˆ¶object" class="headerlink" title="jså¤åˆ¶object"></a>jså¤åˆ¶object</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–¹æ³•ä¸€:</span></span><br><span class="line"><span class="keyword">var</span> o = &#123;<span class="attr">a</span>: [<span class="number">1</span>]&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æµ…æ‹·è´</span></span><br><span class="line"><span class="keyword">var</span> o1 = $.<span class="title function_">extend</span>(&#123;&#125;, o);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(o1.<span class="property">a</span> === o.<span class="property">a</span>);  <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·±æ‹·è´</span></span><br><span class="line"><span class="keyword">var</span> o2 = $.<span class="title function_">extend</span>(<span class="literal">true</span>, &#123;&#125;, o);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(o2.<span class="property">a</span> === o.<span class="property">a</span>);  <span class="comment">//false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–¹æ³•äºŒ:</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">copy</span>(<span class="params"> obj </span>)&#123;</span><br><span class="line">    <span class="comment">// JSONè§£æä¹‹ç±»çš„å…¶å®å¦‚æœç»™å®šæ ¼å¼ä¸å¯¹å¾ˆå®¹æ˜“å‡ºé”™æ»´ï¼Œè‡ªå·±åšå¥½æ£€éªŒ~</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">JSON</span>.<span class="title function_">parse</span>( <span class="title class_">JSON</span>.<span class="title function_">stringify</span>( obj ) );</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> data = &#123; <span class="attr">name</span>: <span class="string">&quot;neekey&quot;</span>, <span class="attr">sex</span>: <span class="string">&quot;male&quot;</span> &#125;</span><br><span class="line"><span class="keyword">var</span> dataCopy = <span class="title function_">copy</span>( data );</span><br></pre></td></tr></table></figure><h1 id="çˆ†ç‚¸ç²’å­æ•ˆæœ"><a href="#çˆ†ç‚¸ç²’å­æ•ˆæœ" class="headerlink" title="çˆ†ç‚¸ç²’å­æ•ˆæœ"></a>çˆ†ç‚¸ç²’å­æ•ˆæœ</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç²’å­æ€»æ•°</span></span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">COUNT</span> = <span class="number">500</span>;</span><br><span class="line"><span class="comment">// é‡åŠ›</span></span><br><span class="line"><span class="keyword">var</span> G = -<span class="number">0.1</span>;</span><br><span class="line"><span class="comment">// æ‘©æ“¦åŠ›</span></span><br><span class="line"><span class="keyword">var</span> F = -<span class="number">0.04</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">init</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="variable constant_">COUNT</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> d = <span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">2</span> * <span class="title class_">Math</span>.<span class="property">PI</span>;</span><br><span class="line">        <span class="keyword">var</span> v = <span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">5</span>;</span><br><span class="line">        <span class="keyword">var</span> circle = $(<span class="string">&#x27;&lt;div id=&quot;circle-&#x27;</span> + i + <span class="string">&#x27;&quot; class=&quot;circle&quot; data-x=&quot;250&quot; data-y=&quot;250&quot; data-d=&quot;&#x27;</span> + d + <span class="string">&#x27;&quot; data-v=&quot;&#x27;</span> + v + <span class="string">&#x27;&quot;&gt;&lt;/div&gt;&#x27;</span>);</span><br><span class="line">        circle.<span class="title function_">appendTo</span>($(<span class="string">&#x27;.main&#x27;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">updateCircle</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="variable constant_">COUNT</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> x = <span class="built_in">parseFloat</span>($(<span class="string">&#x27;#circle-&#x27;</span> + i).<span class="title function_">attr</span>(<span class="string">&#x27;data-x&#x27;</span>));</span><br><span class="line">        <span class="keyword">var</span> y = <span class="built_in">parseFloat</span>($(<span class="string">&#x27;#circle-&#x27;</span> + i).<span class="title function_">attr</span>(<span class="string">&#x27;data-y&#x27;</span>));</span><br><span class="line">        <span class="keyword">var</span> d = <span class="built_in">parseFloat</span>($(<span class="string">&#x27;#circle-&#x27;</span> + i).<span class="title function_">attr</span>(<span class="string">&#x27;data-d&#x27;</span>));</span><br><span class="line">        <span class="keyword">var</span> v = <span class="built_in">parseFloat</span>($(<span class="string">&#x27;#circle-&#x27;</span> + i).<span class="title function_">attr</span>(<span class="string">&#x27;data-v&#x27;</span>));</span><br><span class="line">        <span class="keyword">var</span> vx = v * <span class="title class_">Math</span>.<span class="title function_">cos</span>(d);</span><br><span class="line">        <span class="keyword">var</span> vy = v * <span class="title class_">Math</span>.<span class="title function_">sin</span>(d);</span><br><span class="line">        <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">abs</span>(vx) &lt; <span class="number">1e-9</span>) vx = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// é€Ÿåº¦åˆ†é‡æ”¹å˜</span></span><br><span class="line">        vx += F * <span class="title class_">Math</span>.<span class="title function_">cos</span>(d);</span><br><span class="line">        vy += F * <span class="title class_">Math</span>.<span class="title function_">sin</span>(d) + G;</span><br><span class="line">        <span class="comment">// è®¡ç®—æ–°é€Ÿåº¦</span></span><br><span class="line">        v = <span class="title class_">Math</span>.<span class="title function_">sqrt</span>(vx * vx + vy * vy);</span><br><span class="line">        <span class="keyword">if</span> (vy &gt; <span class="number">0</span>) d = <span class="title class_">Math</span>.<span class="title function_">acos</span>(vx / v);</span><br><span class="line">        <span class="keyword">else</span> d = -<span class="title class_">Math</span>.<span class="title function_">acos</span>(vx / v);</span><br><span class="line">        <span class="comment">// ä½ç§»åˆ†é‡æ”¹å˜</span></span><br><span class="line">        x += vx;</span><br><span class="line">        y += vy;</span><br><span class="line">        $(<span class="string">&#x27;#circle-&#x27;</span> + i).<span class="title function_">attr</span>(<span class="string">&#x27;data-x&#x27;</span>, x);</span><br><span class="line">        $(<span class="string">&#x27;#circle-&#x27;</span> + i).<span class="title function_">attr</span>(<span class="string">&#x27;data-y&#x27;</span>, y);</span><br><span class="line">        $(<span class="string">&#x27;#circle-&#x27;</span> + i).<span class="title function_">attr</span>(<span class="string">&#x27;data-d&#x27;</span>, d);</span><br><span class="line">        $(<span class="string">&#x27;#circle-&#x27;</span> + i).<span class="title function_">attr</span>(<span class="string">&#x27;data-v&#x27;</span>, v);</span><br><span class="line">        $(<span class="string">&#x27;#circle-&#x27;</span> + i).<span class="title function_">css</span>(&#123;<span class="string">&#x27;top&#x27;</span>: <span class="number">400</span> - y, <span class="string">&#x27;left&#x27;</span>: x&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> interval = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showAnimation</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (interval) <span class="built_in">clearInterval</span>(interval);</span><br><span class="line">    $(<span class="string">&#x27;.main&#x27;</span>).<span class="title function_">html</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    <span class="title function_">init</span>();</span><br><span class="line">    interval = <span class="built_in">setInterval</span>(updateCircle, <span class="number">1000</span> / <span class="number">60</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ç¦æ­¢æµè§ˆå™¨æ»šåŠ¨æ¡æ»šåŠ¨"><a href="#ç¦æ­¢æµè§ˆå™¨æ»šåŠ¨æ¡æ»šåŠ¨" class="headerlink" title="ç¦æ­¢æµè§ˆå™¨æ»šåŠ¨æ¡æ»šåŠ¨"></a>ç¦æ­¢æµè§ˆå™¨æ»šåŠ¨æ¡æ»šåŠ¨</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å½“é¡µé¢æ»šåŠ¨æ—¶ï¼ŒæŠŠå½“å‰è·ç¦»èµ‹å€¼ç»™é¡µé¢ï¼Œè¿™æ ·ä¿æŒé¡µé¢æ»šåŠ¨æ¡ä¸åŠ¨</span></span><br><span class="line"><span class="keyword">var</span> tops = $(<span class="variable language_">document</span>).<span class="title function_">scrollTop</span>();</span><br><span class="line">$(<span class="variable language_">document</span>).<span class="title function_">bind</span>(<span class="string">&quot;scroll&quot;</span>,<span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">        $(<span class="variable language_">document</span>).<span class="title function_">scrollTop</span>(tops);</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"><span class="comment">//å…³é—­æ¨¡æ€æ¡†æ—¶é‡Šæ”¾document.scrolläº‹ä»¶</span></span><br><span class="line">$(<span class="variable language_">document</span>).<span class="title function_">unbind</span>(<span class="string">&quot;scroll&quot;</span>);</span><br></pre></td></tr></table></figure><h1 id="åŠ¨æ€ç»‘å®šäº‹ä»¶æ— æ•ˆ"><a href="#åŠ¨æ€ç»‘å®šäº‹ä»¶æ— æ•ˆ" class="headerlink" title="åŠ¨æ€ç»‘å®šäº‹ä»¶æ— æ•ˆ"></a>åŠ¨æ€ç»‘å®šäº‹ä»¶æ— æ•ˆ</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŠ¨æ€ç»‘å®šåŸæœ¬ä¸å­˜åœ¨çš„å…ƒç´ æ—¶ï¼Œå­˜åœ¨å…ƒç´ è¿˜æ²¡ç”Ÿæˆï¼Œç»‘å®šäº‹ä»¶çš„ä»£ç å·²ç»æ‰§è¡Œ</span></span><br><span class="line">$(<span class="string">&#x27;a&#x27;</span>).<span class="title function_">on</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;)</span><br><span class="line"><span class="comment">// éœ€è¦æ›´æ”¹ä¸ºä»¥ä¸‹æ–¹å¼å¤„ç†</span></span><br><span class="line">$(<span class="variable language_">document</span>).<span class="title function_">on</span>(<span class="string">&#x27;click&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;)</span><br></pre></td></tr></table></figure><h1 id="IEè·¨åŸŸå¤„ç†"><a href="#IEè·¨åŸŸå¤„ç†" class="headerlink" title="IEè·¨åŸŸå¤„ç†"></a>IEè·¨åŸŸå¤„ç†</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç‚¹å‡»IEæµè§ˆå™¨çš„çš„â€œå·¥å…·-&gt;Internet é€‰é¡¹-&gt;å®‰å…¨-&gt;è‡ªå®šä¹‰çº§åˆ«â€ä¿®æ”¹åŸŸç›¸å…³è®¾ç½®ä¸ºå¯åŠ¨</span></span><br><span class="line">$.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>: <span class="string">&#x27;urlåœ°å€&#x27;</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">        <span class="attr">dataType</span>: <span class="string">&#x27;json&#x27;</span>,</span><br><span class="line">        <span class="attr">crossDomain</span>: <span class="literal">true</span> == !(<span class="variable language_">document</span>.<span class="property">all</span>), <span class="comment">// ä¸»è¦è¿™å¥å¯åŠ¨è·¨åŸŸä½œç”¨</span></span><br><span class="line">        <span class="attr">data</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;command&#x27;</span>: <span class="string">&#x27;&#123;$compareCommand&#125;&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;action&#x27;</span>: <span class="string">&#x27;GetOne&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;city_id&#x27;</span>: <span class="string">&#x27;&#123;SITE_ID&#125;&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;hid&#x27;</span>: hid</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">result</span>) &#123;</span><br><span class="line">        </span><br><span class="line">        &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="é€‰æ‹©å™¨è·å–script"><a href="#é€‰æ‹©å™¨è·å–script" class="headerlink" title="é€‰æ‹©å™¨è·å–script"></a>é€‰æ‹©å™¨è·å–script</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–æ‰€æœ‰çš„script</span></span><br><span class="line">$(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line"><span class="comment">// è·å–åŒ…å«lngå­—ç¬¦ä¸²ä»¥åŠä¹‹åçš„æ–‡æœ¬</span></span><br><span class="line">$(<span class="string">&#x27;script:contains(&quot;lng&quot;)&#x27;</span>);</span><br></pre></td></tr></table></figure><h1 id="ç›‘å¬æµè§ˆå™¨æ ‡ç­¾åˆ‡æ¢æˆ–è€…ç¼©å°"><a href="#ç›‘å¬æµè§ˆå™¨æ ‡ç­¾åˆ‡æ¢æˆ–è€…ç¼©å°" class="headerlink" title="ç›‘å¬æµè§ˆå™¨æ ‡ç­¾åˆ‡æ¢æˆ–è€…ç¼©å°"></a>ç›‘å¬æµè§ˆå™¨æ ‡ç­¾åˆ‡æ¢æˆ–è€…ç¼©å°</h1><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Page_Visibility_API">é¡µé¢å¯è§æ€§ API</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> hidden, visibilityChange;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">document</span>.<span class="property">hidden</span> !== <span class="string">&quot;undefined&quot;</span>) &#123; <span class="comment">// Opera 12.10 and Firefox 18 and later support</span></span><br><span class="line">    hidden = <span class="string">&quot;hidden&quot;</span>;</span><br><span class="line">    visibilityChange = <span class="string">&quot;visibilitychange&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">document</span>.<span class="property">msHidden</span> !== <span class="string">&quot;undefined&quot;</span>) &#123;</span><br><span class="line">    hidden = <span class="string">&quot;msHidden&quot;</span>;</span><br><span class="line">    visibilityChange = <span class="string">&quot;msvisibilitychange&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">document</span>.<span class="property">webkitHidden</span> !== <span class="string">&quot;undefined&quot;</span>) &#123;</span><br><span class="line">    hidden = <span class="string">&quot;webkitHidden&quot;</span>;</span><br><span class="line">    visibilityChange = <span class="string">&quot;webkitvisibilitychange&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$(<span class="variable language_">document</span>).<span class="title function_">on</span>(visibilityChange,handleVisibilityChange);</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleVisibilityChange</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">document</span>[hidden]) &#123;</span><br><span class="line">        $(<span class="string">&#x27;title&#x27;</span>).<span class="title function_">text</span>(<span class="string">&#x27;åˆ‡æ¢æ ‡ç­¾&#x27;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $(<span class="string">&#x27;title&#x27;</span>).<span class="title function_">text</span>(<span class="string">&#x27;åˆ‡å›æ ‡ç­¾&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="cookieè½¬json"><a href="#cookieè½¬json" class="headerlink" title="cookieè½¬json"></a>cookieè½¬json</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">cookieToJson</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> cookieArr = <span class="variable language_">document</span>.<span class="property">cookie</span>.<span class="title function_">split</span>(<span class="string">&quot;;&quot;</span>);</span><br><span class="line">    <span class="keyword">let</span> obj = &#123;&#125; </span><br><span class="line">    cookieArr.<span class="title function_">forEach</span>(<span class="function">(<span class="params">i</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> arr = i.<span class="title function_">split</span>(<span class="string">&quot;=&quot;</span>);</span><br><span class="line">        obj[arr[<span class="number">0</span>].<span class="title function_">trim</span>()] =arr[<span class="number">1</span>].<span class="title function_">trim</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> obj</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> cookieJson = <span class="title function_">cookieToJson</span>();</span><br><span class="line">  <span class="keyword">var</span> cookieJsonStr = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>();</span><br></pre></td></tr></table></figure><h1 id="jsonè½¬å­—ç¬¦ä¸²ï¼Œæ ¼å¼åŒ–è¾“å‡º"><a href="#jsonè½¬å­—ç¬¦ä¸²ï¼Œæ ¼å¼åŒ–è¾“å‡º" class="headerlink" title="jsonè½¬å­—ç¬¦ä¸²ï¼Œæ ¼å¼åŒ–è¾“å‡º"></a>jsonè½¬å­—ç¬¦ä¸²ï¼Œæ ¼å¼åŒ–è¾“å‡º</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// JSON.stringify(value[, replacer[, space]])</span></span><br><span class="line"><span class="comment">// space:</span></span><br><span class="line"><span class="comment">// å¯é€‰ï¼Œæ–‡æœ¬æ·»åŠ ç¼©è¿›ã€ç©ºæ ¼å’Œæ¢è¡Œç¬¦ï¼Œå¦‚æœ space æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œåˆ™è¿”å›å€¼æ–‡æœ¬åœ¨æ¯ä¸ªçº§åˆ«ç¼©è¿›æŒ‡å®šæ•°ç›®çš„ç©ºæ ¼ï¼Œå¦‚æœ space å¤§äº 10ï¼Œåˆ™æ–‡æœ¬ç¼©è¿› 10 ä¸ªç©ºæ ¼ã€‚space ä¹Ÿå¯ä»¥ä½¿ç”¨éæ•°//// å­—ï¼Œå¦‚ï¼š\tã€‚</span></span><br><span class="line"><span class="keyword">let</span> json = &#123;&#125;</span><br><span class="line"><span class="title class_">JSON</span>.<span class="title function_">stringify</span>(json, <span class="literal">null</span>, <span class="string">&#x27;\t&#x27;</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
          <category> js </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0.html"/>
      <url>/posts/0.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>vagrantå¸¸ç”¨å‘½ä»¤</title>
      <link href="/posts/eeec638f.html"/>
      <url>/posts/eeec638f.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h2 id="sshæ–¹å¼ç™»é™†vagrant"><a href="#sshæ–¹å¼ç™»é™†vagrant" class="headerlink" title="sshæ–¹å¼ç™»é™†vagrant"></a>sshæ–¹å¼ç™»é™†vagrant</h2><p>å…·ä½“å‚æ•°é€šè¿‡vagrant ssh-configæŸ¥çœ‹ </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh vagrant@127.0.0.1 -p 2222 -o Compression=<span class="built_in">yes</span> -o DSAAuthentication=<span class="built_in">yes</span> -o LogLevel=FATAL -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o IdentitiesOnly=<span class="built_in">yes</span> -i /cygdrive/c/Users/Administrator/.vagrant.d/boxes/centos7-docker/0/virtualbox/vagrant_private_key</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…docker-compose"><a href="#å®‰è£…docker-compose" class="headerlink" title="å®‰è£…docker-compose"></a>å®‰è£…docker-compose</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…docker-compose</span></span><br><span class="line">$ <span class="built_in">sudo</span> curl -L https://github.com/docker/compose/releases/download/1.24.1/docker-compose-`<span class="built_in">uname</span> -s`-`<span class="built_in">uname</span> -m` -o /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure><h2 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ vagrant box add <span class="comment"># æ·»åŠ boxçš„æ“ä½œ</span></span><br><span class="line">$ vagrant init <span class="comment"># åˆå§‹åŒ–boxçš„æ“ä½œ</span></span><br><span class="line">$ vagrant up <span class="comment"># å¯åŠ¨è™šæ‹Ÿæœºçš„æ“ä½œ</span></span><br><span class="line">$ vagrant halt <span class="comment"># å…³é—­è™šæ‹Ÿæœºçš„æ“ä½œ</span></span><br><span class="line">$ vagrant ssh <span class="comment"># ç™»å½•è™šæ‹Ÿæœºçš„æ“ä½œ</span></span><br><span class="line">$ vagrant box list <span class="comment"># æ˜¾ç¤ºå½“å‰å·²ç»æ·»åŠ çš„boxåˆ—è¡¨</span></span><br><span class="line">$ vagrant box remove <span class="comment"># ç§»é™¤ç›¸åº”çš„box</span></span><br><span class="line">$ vagrant destroy <span class="comment"># åœæ­¢å½“å‰æ­£åœ¨è¿è¡Œçš„è™šæ‹Ÿæœºå¹¶é”€æ¯æ‰€æœ‰åˆ›å»ºçš„èµ„æº</span></span><br><span class="line">$ vagrant plugin <span class="comment"># ç”¨äºå®‰è£…å¸è½½æ’ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ --provision:å¼ºåˆ¶</span></span><br><span class="line">$ vagrant reload --provision</span><br><span class="line"><span class="comment">#æ‰“åŒ…</span></span><br><span class="line">$ vagrant package</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®vagrantå­˜å‚¨è·¯å¾„</span></span><br><span class="line">VAGRANT_HOME</span><br><span class="line"></span><br><span class="line"><span class="comment">#è®¾ç½®ä¸é€‚ç”¨vagranté»˜è®¤çš„ssh, ä½¿ç”¨ç³»ç»Ÿçš„ssh(ä¿®æ”¹é»˜è®¤å­˜å‚¨è·¯å¾„å vagrant sshä¼šå¯¼è‡´è¯·æ±‚å¤±è´¥)</span></span><br><span class="line">VAGRANT_PREFER_SYSTEM_BIN=0</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨clashä»£ç†"><a href="#ä½¿ç”¨clashä»£ç†" class="headerlink" title="ä½¿ç”¨clashä»£ç†"></a>ä½¿ç”¨clashä»£ç†</h2><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é…ç½®ä¸­æ–°å¢ 9091ï¼šé…ç½®çš„apiç«¯å£</span></span><br><span class="line">config.vm.network <span class="string">&quot;forwarded_port&quot;</span>, <span class="params">guest:</span> <span class="number">9091</span>, <span class="params">host:</span> <span class="number">9091</span>, <span class="params">host_ip:</span> <span class="string">&quot;127.0.0.1&quot;</span></span><br></pre></td></tr></table></figure><h2 id="ioæ…¢å¤„ç†"><a href="#ioæ…¢å¤„ç†" class="headerlink" title="ioæ…¢å¤„ç†"></a>ioæ…¢å¤„ç†</h2><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…nfsæ’ä»¶</span></span><br><span class="line">$ vagrant plugin <span class="keyword">install </span>vagrant-winnfsd</span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½®ä¸­ä¿®æ”¹ç½‘ç»œä¸ºprivate_networkï¼Œå¹¶ä¸”å¼€å¯nfs</span></span><br><span class="line"><span class="built_in">config</span>.vm.network <span class="string">&quot;private_network&quot;</span>, type: <span class="string">&quot;dhcp&quot;</span></span><br><span class="line"><span class="built_in">config</span>.winnfsd.uid = <span class="number">1</span></span><br><span class="line"><span class="built_in">config</span>.winnfsd.gid = <span class="number">1</span></span><br><span class="line"><span class="comment"># åŒæ­¥æ–¹å¼ä¸ºnfs</span></span><br><span class="line"><span class="built_in">config</span>.vm.<span class="keyword">synced_folder </span><span class="string">&quot;E:/vagrant&quot;</span>, <span class="string">&quot;/data/vagrant&quot;</span>, type: <span class="string">&quot;nfs&quot;</span></span><br></pre></td></tr></table></figure><h2 id="é€šè¿‡å›½å†…ç½‘å€ä¸‹è½½æ’ä»¶"><a href="#é€šè¿‡å›½å†…ç½‘å€ä¸‹è½½æ’ä»¶" class="headerlink" title="é€šè¿‡å›½å†…ç½‘å€ä¸‹è½½æ’ä»¶"></a>é€šè¿‡å›½å†…ç½‘å€ä¸‹è½½æ’ä»¶</h2><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vagrant <span class="keyword">plugin</span> install --<span class="keyword">plugin</span>-clean-sources --<span class="keyword">plugin</span>-source https:<span class="comment">//gems.ruby-china.com/ vagrant-disksize</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> vagrant </category>
          
          <category> å¸¸ç”¨å‘½ä»¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¸¸ç”¨å‘½ä»¤ </tag>
            
            <tag> vagrant </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ­£åˆ™è¡¨è¾¾å¼</title>
      <link href="/posts/2f57a694.html"/>
      <url>/posts/2f57a694.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="è·å–jsonéƒ¨åˆ†"><a href="#è·å–jsonéƒ¨åˆ†" class="headerlink" title="è·å–jsonéƒ¨åˆ†"></a>è·å–jsonéƒ¨åˆ†</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\[&#123;.*?\&#125;]/is&quot;</span>, <span class="variable">$str</span>, <span class="variable">$matches</span>);</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åªèƒ½è¾“å…¥æ•°å­—ï¼Œå¹¶ä¸”å°æ•°ç‚¹åä¸¤ä½</span></span><br><span class="line">(<span class="variable language_">this</span>.<span class="property">value</span>.<span class="title function_">match</span>(<span class="regexp">/\d+(\.\d&#123;0,2&#125;)?/</span>)||[<span class="string">&#x27;&#x27;</span>])[<span class="number">0</span>];</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–hrefåœ°å€:</span></span><br><span class="line">/\&lt;a\shref\=\<span class="string">&quot;([^\&quot;]+)/</span></span><br><span class="line"><span class="string">// è·å–div</span></span><br><span class="line"><span class="string">/&lt;div class=&quot;</span>resume-left<span class="string">&quot;[\S\s]*?&gt;/</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å»é™¤htmlæ ‡ç­¾çš„idä»¥åŠclass</span></span><br><span class="line">preg = re.<span class="built_in">compile</span>(<span class="string">r&#x27;((id|class)=\&quot;[\S\s]*?\&quot;)&#x27;</span>)</span><br><span class="line">essayMain = re.sub(preg, <span class="string">&#x27;&#x27;</span>, essayMain)</span><br><span class="line"><span class="comment"># å»é™¤htmlçš„æ³¨é‡Š</span></span><br><span class="line">preg = re.<span class="built_in">compile</span>(<span class="string">r&#x27;&lt;!--[\S\s]*?--&gt;&#x27;</span>)</span><br><span class="line">essayMain = re.sub(preg, <span class="string">&#x27;&#x27;</span>, essayMain)</span><br></pre></td></tr></table></figure><h1 id="é“¾æ¥åªä¿ç•™æ–‡å­—å»é™¤æ ‡ç­¾"><a href="#é“¾æ¥åªä¿ç•™æ–‡å­—å»é™¤æ ‡ç­¾" class="headerlink" title="é“¾æ¥åªä¿ç•™æ–‡å­—å»é™¤æ ‡ç­¾"></a>é“¾æ¥åªä¿ç•™æ–‡å­—å»é™¤æ ‡ç­¾</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">&lt;a href=<span class="string">&quot;xxx&quot;</span>&gt;æ–‡å­—&lt;/a&gt; æ›¿æ¢åä¿ç•™<span class="string">&quot;æ–‡å­—&quot;</span></span></span><br><span class="line">(?i)&lt;/?a[^&gt;]*&gt;</span><br></pre></td></tr></table></figure><h1 id="å°ç¨‹åºUser-Agent-éœ€è¦å¿½ç•¥å¤§å°å†™i"><a href="#å°ç¨‹åºUser-Agent-éœ€è¦å¿½ç•¥å¤§å°å†™i" class="headerlink" title="å°ç¨‹åºUser-Agent(éœ€è¦å¿½ç•¥å¤§å°å†™i)"></a>å°ç¨‹åºUser-Agent(éœ€è¦å¿½ç•¥å¤§å°å†™i)</h1><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># å¾®ä¿¡</span></span><br><span class="line">Android.*MicroMessenger.*miniProgram <span class="comment">// å®‰å“ç«¯çš„å°ç¨‹åº</span></span><br><span class="line">iPhone.*MicroMessenger <span class="comment">// è‹¹æœç«¯å°ç¨‹åº</span></span><br><span class="line"><span class="meta"># ç™¾åº¦</span></span><br><span class="line">Android.*swan.*swan<span class="punctuation">-</span>baiduboxapp</span><br><span class="line">iPhone.*swan.*swan<span class="punctuation">-</span>baiduboxapp</span><br></pre></td></tr></table></figure><h1 id="å»é™¤htmlæ‰€æœ‰å±æ€§"><a href="#å»é™¤htmlæ‰€æœ‰å±æ€§" class="headerlink" title="å»é™¤htmlæ‰€æœ‰å±æ€§"></a>å»é™¤htmlæ‰€æœ‰å±æ€§</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># styleå°†è¢«å»é™¤</span></span><br><span class="line"><span class="variable">$html</span> = <span class="string">&#x27;&lt;div style=&quot;&quot;&gt;&lt;/div&gt;&#x27;</span>;</span><br><span class="line"><span class="variable">$html</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/(&lt;[^\s\/&gt;]+)\b[^&gt;]*&gt;/i&#x27;</span>, <span class="string">&quot;<span class="subst">$1</span>&gt;&quot;</span>, <span class="variable">$html</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> æ­£åˆ™è¡¨è¾¾å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ­£åˆ™è¡¨è¾¾å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ­£åˆ™è¡¨è¾¾å¼é€ŸæŸ¥</title>
      <link href="/posts/351dcf8c.html"/>
      <url>/posts/351dcf8c.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€é€ŸæŸ¥è¡¨"><a href="#ä¸€ã€é€ŸæŸ¥è¡¨" class="headerlink" title="ä¸€ã€é€ŸæŸ¥è¡¨"></a>ä¸€ã€é€ŸæŸ¥è¡¨</h1><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„ç‰¹æ®Šå­—ç¬¦</span></span><br><span class="line"><span class="language-xml">å­—ç¬¦å«ä¹‰</span></span><br><span class="line"><span class="language-xml">\</span></span><br><span class="line"><span class="language-xml">ä¾ç…§ä¸‹åˆ—è§„åˆ™åŒ¹é…ï¼š</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">åœ¨éç‰¹æ®Šå­—ç¬¦ä¹‹å‰çš„åæ–œæ è¡¨ç¤ºä¸‹ä¸€ä¸ªå­—ç¬¦æ˜¯ç‰¹æ®Šå­—ç¬¦ï¼Œä¸èƒ½æŒ‰ç…§å­—é¢ç†è§£ã€‚ä¾‹å¦‚ï¼Œå‰é¢æ²¡æœ‰ &quot;\&quot; çš„ &quot;b&quot; é€šå¸¸åŒ¹é…å°å†™å­—æ¯ &quot;b&quot;ï¼Œå³å­—ç¬¦ä¼šè¢«ä½œä¸ºå­—é¢ç†è§£ï¼Œæ— è®ºå®ƒå‡ºç°åœ¨å“ªé‡Œã€‚ä½†å¦‚æœå‰é¢åŠ äº† &quot;\&quot;ï¼Œå®ƒå°†ä¸å†åŒ¹é…ä»»ä½•å­—ç¬¦ï¼Œè€Œæ˜¯è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦è¾¹ç•Œã€‚</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">åœ¨ç‰¹æ®Šå­—ç¬¦ä¹‹å‰çš„åæ–œæ è¡¨ç¤ºä¸‹ä¸€ä¸ªå­—ç¬¦ä¸æ˜¯ç‰¹æ®Šå­—ç¬¦ï¼Œåº”è¯¥æŒ‰ç…§å­—é¢ç†è§£ã€‚è¯¦æƒ…è¯·å‚é˜…ä¸‹æ–‡ä¸­çš„ &quot;è½¬ä¹‰ï¼ˆEscapingï¼‰&quot; éƒ¨åˆ†ã€‚</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">å¦‚æœä½ æƒ³å°†å­—ç¬¦ä¸²ä¼ é€’ç»™ RegExp æ„é€ å‡½æ•°ï¼Œä¸è¦å¿˜è®°åœ¨å­—ç¬¦ä¸²å­—é¢é‡ä¸­åæ–œæ æ˜¯è½¬ä¹‰å­—ç¬¦ã€‚æ‰€ä»¥ä¸ºäº†åœ¨æ¨¡å¼ä¸­æ·»åŠ ä¸€ä¸ªåæ–œæ ï¼Œä½ éœ€è¦åœ¨å­—ç¬¦ä¸²å­—é¢é‡ä¸­è½¬ä¹‰å®ƒã€‚/[a-z]\s/i å’Œ new RegExp(&quot;[a-z]\\s&quot;, &quot;i&quot;) åˆ›å»ºäº†ç›¸åŒçš„æ­£åˆ™è¡¨è¾¾å¼ï¼šä¸€ä¸ªç”¨äºæœç´¢åé¢ç´§è·Ÿç€ç©ºç™½å­—ç¬¦ï¼ˆ\s å¯çœ‹åæ–‡ï¼‰å¹¶ä¸”åœ¨ a-z èŒƒå›´å†…çš„ä»»æ„å­—ç¬¦çš„è¡¨è¾¾å¼ã€‚ä¸ºäº†é€šè¿‡å­—ç¬¦ä¸²å­—é¢é‡ç»™ RegExp æ„é€ å‡½æ•°åˆ›å»ºåŒ…å«åæ–œæ çš„è¡¨è¾¾å¼ï¼Œä½ éœ€è¦åœ¨å­—ç¬¦ä¸²çº§åˆ«å’Œæ­£åˆ™è¡¨è¾¾å¼çº§åˆ«éƒ½å¯¹å®ƒè¿›è¡Œè½¬ä¹‰ã€‚ä¾‹å¦‚ /[a-z]:\\/i å’Œ new RegExp(&quot;[a-z]:\\\\&quot;,&quot;i&quot;) ä¼šåˆ›å»ºç›¸åŒçš„è¡¨è¾¾å¼ï¼Œå³åŒ¹é…ç±»ä¼¼ &quot;C:\&quot; å­—ç¬¦ä¸²ã€‚</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">^</span></span><br><span class="line"><span class="language-xml">åŒ¹é…è¾“å…¥çš„å¼€å§‹ã€‚å¦‚æœå¤šè¡Œæ ‡å¿—è¢«è®¾ç½®ä¸º trueï¼Œé‚£ä¹ˆä¹ŸåŒ¹é…æ¢è¡Œç¬¦åç´§è·Ÿçš„ä½ç½®ã€‚</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">ä¾‹å¦‚ï¼Œ/^A/ å¹¶ä¸ä¼šåŒ¹é… &quot;an A&quot; ä¸­çš„ &#x27;A&#x27;ï¼Œä½†æ˜¯ä¼šåŒ¹é… &quot;An E&quot; ä¸­çš„ &#x27;A&#x27;ã€‚</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">å½“ &#x27;^&#x27; ä½œä¸ºç¬¬ä¸€ä¸ªå­—ç¬¦å‡ºç°åœ¨ä¸€ä¸ªå­—ç¬¦é›†åˆæ¨¡å¼æ—¶ï¼Œå®ƒå°†ä¼šæœ‰ä¸åŒçš„å«ä¹‰ã€‚åå‘å­—ç¬¦é›†åˆ ä¸€èŠ‚æœ‰è¯¦ç»†ä»‹ç»å’Œç¤ºä¾‹ã€‚</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">$</span></span><br><span class="line"><span class="language-xml">åŒ¹é…è¾“å…¥çš„ç»“æŸã€‚å¦‚æœå¤šè¡Œæ ‡å¿—è¢«è®¾ç½®ä¸º trueï¼Œé‚£ä¹ˆä¹ŸåŒ¹é…æ¢è¡Œç¬¦å‰çš„ä½ç½®ã€‚</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">ä¾‹å¦‚ï¼Œ/t$/ å¹¶ä¸ä¼šåŒ¹é… &quot;eater&quot; ä¸­çš„ &#x27;t&#x27;ï¼Œä½†æ˜¯ä¼šåŒ¹é… &quot;eat&quot; ä¸­çš„ &#x27;t&#x27;ã€‚</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">*</span></span><br><span class="line"><span class="language-xml">åŒ¹é…å‰ä¸€ä¸ªè¡¨è¾¾å¼ 0 æ¬¡æˆ–å¤šæ¬¡ã€‚ç­‰ä»·äº </span><span class="template-variable">&#123;0,&#125;</span><span class="language-xml">ã€‚</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">ä¾‹å¦‚ï¼Œ/bo*/ ä¼šåŒ¹é… &quot;A ghost boooooed&quot; ä¸­çš„ &#x27;booooo&#x27; å’Œ &quot;A bird warbled&quot; ä¸­çš„ &#x27;b&#x27;ï¼Œä½†æ˜¯åœ¨ &quot;A goat grunted&quot; ä¸­ä¸ä¼šåŒ¹é…ä»»ä½•å†…å®¹ã€‚</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">+</span></span><br><span class="line"><span class="language-xml">åŒ¹é…å‰é¢ä¸€ä¸ªè¡¨è¾¾å¼ 1 æ¬¡æˆ–è€…å¤šæ¬¡ã€‚ç­‰ä»·äº </span><span class="template-variable">&#123;1,&#125;</span><span class="language-xml">ã€‚</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">ä¾‹å¦‚ï¼Œ/a+/ ä¼šåŒ¹é… &quot;candy&quot; ä¸­çš„ &#x27;a&#x27; å’Œ &quot;caaaaaaandy&quot; ä¸­æ‰€æœ‰çš„ &#x27;a&#x27;ï¼Œä½†æ˜¯åœ¨ &quot;cndy&quot; ä¸­ä¸ä¼šåŒ¹é…ä»»ä½•å†…å®¹ã€‚</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">?</span></span><br><span class="line"><span class="language-xml">åŒ¹é…å‰é¢ä¸€ä¸ªè¡¨è¾¾å¼ 0 æ¬¡æˆ–è€… 1 æ¬¡ã€‚ç­‰ä»·äº </span><span class="template-variable">&#123;0,1&#125;</span><span class="language-xml">ã€‚</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">ä¾‹å¦‚ï¼Œ/e?le?/ åŒ¹é… &quot;angel&quot; ä¸­çš„ &#x27;el&#x27;ã€&quot;angle&quot; ä¸­çš„ &#x27;le&#x27; ä»¥åŠ &quot;oslo&#x27; ä¸­çš„ &#x27;l&#x27;ã€‚</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">å¦‚æœç´§è·Ÿåœ¨ä»»ä½•é‡è¯ *ã€ +ã€? æˆ– </span><span class="template-variable">&#123;&#125;</span><span class="language-xml"> çš„åé¢ï¼Œå°†ä¼šä½¿é‡è¯å˜ä¸ºéè´ªå©ªï¼ˆåŒ¹é…å°½é‡å°‘çš„å­—ç¬¦ï¼‰ï¼Œå’Œç¼ºçœä½¿ç”¨çš„è´ªå©ªæ¨¡å¼ï¼ˆåŒ¹é…å°½å¯èƒ½å¤šçš„å­—ç¬¦ï¼‰æ­£å¥½ç›¸åã€‚ä¾‹å¦‚ï¼Œå¯¹ &quot;123abc&quot; ä½¿ç”¨ /\d+/ å°†ä¼šåŒ¹é… &quot;123&quot;ï¼Œè€Œä½¿ç”¨ /\d+?/ åˆ™åªä¼šåŒ¹é…åˆ° &quot;1&quot;ã€‚</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">è¿˜ç”¨äºå…ˆè¡Œæ–­è¨€ä¸­ï¼Œå¦‚æœ¬è¡¨çš„ x(?=y) å’Œ x(?!y) æ¡ç›®æ‰€è¿°ã€‚</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">.</span></span><br><span class="line"><span class="language-xml">ï¼ˆå°æ•°ç‚¹ï¼‰é»˜è®¤åŒ¹é…é™¤æ¢è¡Œç¬¦ä¹‹å¤–çš„ä»»ä½•å•ä¸ªå­—ç¬¦ã€‚</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">ä¾‹å¦‚ï¼Œ/.n/ å°†ä¼šåŒ¹é… &quot;nay, an apple is on the tree&quot; ä¸­çš„ &#x27;an&#x27; å’Œ &#x27;on&#x27;ï¼Œä½†æ˜¯ä¸ä¼šåŒ¹é… &#x27;nay&#x27;ã€‚</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">å¦‚æœ s (&quot;dotAll&quot;) æ ‡å¿—ä½è¢«è®¾ä¸º trueï¼Œå®ƒä¹Ÿä¼šåŒ¹é…æ¢è¡Œç¬¦ã€‚</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">(x)</span></span><br><span class="line"><span class="language-xml">åƒä¸‹é¢çš„ä¾‹å­å±•ç¤ºçš„é‚£æ ·ï¼Œå®ƒä¼šåŒ¹é… &#x27;x&#x27; å¹¶ä¸”è®°ä½åŒ¹é…é¡¹ã€‚å…¶ä¸­æ‹¬å·è¢«ç§°ä¸ºæ•è·æ‹¬å·ã€‚</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">æ¨¡å¼ /(foo) (bar) \1 \2/ ä¸­çš„ &#x27;(foo)&#x27; å’Œ &#x27;(bar)&#x27; åŒ¹é…å¹¶è®°ä½å­—ç¬¦ä¸² &quot;foo bar foo bar&quot; ä¸­å‰ä¸¤ä¸ªå•è¯ã€‚æ¨¡å¼ä¸­çš„ \1 å’Œ \2 è¡¨ç¤ºç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªè¢«æ•è·æ‹¬å·åŒ¹é…çš„å­å­—ç¬¦ä¸²ï¼Œå³ foo å’Œ barï¼ŒåŒ¹é…äº†åŸå­—ç¬¦ä¸²ä¸­çš„åä¸¤ä¸ªå•è¯ã€‚æ³¨æ„ \1ã€\2ã€...ã€\n æ˜¯ç”¨åœ¨æ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…ç¯èŠ‚ï¼Œè¯¦æƒ…å¯ä»¥å‚é˜…åæ–‡çš„ \n æ¡ç›®ã€‚è€Œåœ¨æ­£åˆ™è¡¨è¾¾å¼çš„æ›¿æ¢ç¯èŠ‚ï¼Œåˆ™è¦ä½¿ç”¨åƒ $1ã€$2ã€...ã€$n è¿™æ ·çš„è¯­æ³•ï¼Œä¾‹å¦‚ï¼Œ&#x27;bar foo&#x27;.replace(/(...) (...)/, &#x27;$2 $1&#x27;)ã€‚$&amp; è¡¨ç¤ºæ•´ä¸ªç”¨äºåŒ¹é…çš„åŸå­—ç¬¦ä¸²ã€‚</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">(?:x)</span></span><br><span class="line"><span class="language-xml">åŒ¹é… &#x27;x&#x27; ä½†æ˜¯ä¸è®°ä½åŒ¹é…é¡¹ã€‚è¿™ç§æ‹¬å·å«ä½œéæ•è·æ‹¬å·ï¼Œä½¿å¾—ä½ èƒ½å¤Ÿå®šä¹‰ä¸æ­£åˆ™è¡¨è¾¾å¼è¿ç®—ç¬¦ä¸€èµ·ä½¿ç”¨çš„å­è¡¨è¾¾å¼ã€‚çœ‹çœ‹è¿™ä¸ªä¾‹å­ /(?:foo)</span><span class="template-variable">&#123;1,2&#125;</span><span class="language-xml">/ã€‚å¦‚æœè¡¨è¾¾å¼æ˜¯ /foo</span><span class="template-variable">&#123;1,2&#125;</span><span class="language-xml">/ï¼Œ</span><span class="template-variable">&#123;1,2&#125;</span><span class="language-xml"> å°†åªåº”ç”¨äº &#x27;foo&#x27; çš„æœ€åä¸€ä¸ªå­—ç¬¦ &#x27;o&#x27;ã€‚å¦‚æœä½¿ç”¨éæ•è·æ‹¬å·ï¼Œåˆ™ </span><span class="template-variable">&#123;1,2&#125;</span><span class="language-xml"> ä¼šåº”ç”¨äºæ•´ä¸ª &#x27;foo&#x27; å•è¯ã€‚æ›´å¤šä¿¡æ¯ï¼Œå¯ä»¥å‚é˜…ä¸‹æ–‡çš„ Using parentheses æ¡ç›®.</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">x(?=y)</span></span><br><span class="line"><span class="language-xml">åŒ¹é…&#x27;x&#x27;ä»…ä»…å½“&#x27;x&#x27;åé¢è·Ÿç€&#x27;y&#x27;.è¿™ç§å«åšå…ˆè¡Œæ–­è¨€ã€‚</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">ä¾‹å¦‚ï¼Œ/Jack(?=Sprat)/ä¼šåŒ¹é…åˆ°&#x27;Jack&#x27;ä»…å½“å®ƒåé¢è·Ÿç€&#x27;Sprat&#x27;ã€‚/Jack(?=Sprat|Frost)/åŒ¹é…â€˜Jackâ€™ä»…å½“å®ƒåé¢è·Ÿç€&#x27;Sprat&#x27;æˆ–è€…æ˜¯â€˜Frostâ€™ã€‚ä½†æ˜¯â€˜Spratâ€™å’Œâ€˜Frostâ€™éƒ½ä¸æ˜¯åŒ¹é…ç»“æœçš„ä¸€éƒ¨åˆ†ã€‚</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">(?&lt;=y)x</span></span><br><span class="line"><span class="language-xml">åŒ¹é…&#x27;x&#x27;ä»…å½“&#x27;x&#x27;å‰é¢æ˜¯&#x27;y&#x27;.è¿™ç§å«åšåè¡Œæ–­è¨€ã€‚</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">ä¾‹å¦‚ï¼Œ/(?&lt;=Jack)Sprat/ä¼šåŒ¹é…åˆ°&#x27; Sprat &#x27;ä»…ä»…å½“å®ƒå‰é¢æ˜¯&#x27; Jack &#x27;ã€‚/(?&lt;=Jack|Tom)Sprat/åŒ¹é…â€˜ Sprat â€™ä»…ä»…å½“å®ƒå‰é¢æ˜¯&#x27;Jack&#x27;æˆ–è€…æ˜¯â€˜Tomâ€™ã€‚ä½†æ˜¯â€˜Jackâ€™å’Œâ€˜Tomâ€™éƒ½ä¸æ˜¯åŒ¹é…ç»“æœçš„ä¸€éƒ¨åˆ†ã€‚</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">x(?!y)</span></span><br><span class="line"><span class="language-xml">ä»…ä»…å½“&#x27;x&#x27;åé¢ä¸è·Ÿç€&#x27;y&#x27;æ—¶åŒ¹é…&#x27;x&#x27;ï¼Œè¿™è¢«ç§°ä¸ºæ­£å‘å¦å®šæŸ¥æ‰¾ã€‚</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">ä¾‹å¦‚ï¼Œä»…ä»…å½“è¿™ä¸ªæ•°å­—åé¢æ²¡æœ‰è·Ÿå°æ•°ç‚¹çš„æ—¶å€™ï¼Œ/\d+(?!\.)/ åŒ¹é…ä¸€ä¸ªæ•°å­—ã€‚æ­£åˆ™è¡¨è¾¾å¼/\d+(?!\.)/.exec(&quot;3.141&quot;)åŒ¹é…â€˜141â€™è€Œä¸æ˜¯â€˜3.141â€™</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">(?<span class="meta">&lt;!y)x</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">ä»…ä»…å½“<span class="string">&#x27;x&#x27;</span>å‰é¢ä¸æ˜¯<span class="string">&#x27;y&#x27;</span>æ—¶åŒ¹é…<span class="string">&#x27;x&#x27;</span>ï¼Œè¿™è¢«ç§°ä¸ºåå‘å¦å®šæŸ¥æ‰¾ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">ä¾‹å¦‚, ä»…ä»…å½“è¿™ä¸ªæ•°å­—å‰é¢æ²¡æœ‰è´Ÿå·çš„æ—¶å€™ï¼Œ/(?&lt;!-)\d+/ åŒ¹é…ä¸€ä¸ªæ•°å­—ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">/(?&lt;!-)\d+/.exec(&#x27;3&#x27;) åŒ¹é…åˆ° <span class="string">&quot;3&quot;</span>.</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">/(?&lt;!-)\d+/.exec(&#x27;-3&#x27;) å› ä¸ºè¿™ä¸ªæ•°å­—å‰æœ‰è´Ÿå·ï¼Œæ‰€ä»¥æ²¡æœ‰åŒ¹é…åˆ°ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">x|y</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">åŒ¹é…â€˜xâ€™æˆ–è€…â€˜yâ€™ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">ä¾‹å¦‚ï¼Œ/green|red/åŒ¹é…â€œgreen <span class="keyword">apple</span>â€ä¸­çš„â€˜greenâ€™å’Œâ€œred <span class="keyword">apple</span>â€ä¸­çš„â€˜redâ€™</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span><span class="template-variable">&#123;n&#125;</span><span class="language-xml"><span class="meta">n æ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼ŒåŒ¹é…äº†å‰é¢ä¸€ä¸ªå­—ç¬¦åˆšå¥½å‡ºç°äº† n æ¬¡ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">æ¯”å¦‚ï¼Œ /a</span></span><span class="template-variable">&#123;2&#125;</span><span class="language-xml"><span class="meta">/ ä¸ä¼šåŒ¹é…â€œcandyâ€ä¸­çš„<span class="string">&#x27;a&#x27;</span>,ä½†æ˜¯ä¼šåŒ¹é…â€œcaandyâ€ä¸­æ‰€æœ‰çš„ aï¼Œä»¥åŠâ€œcaaandyâ€ä¸­çš„å‰ä¸¤ä¸ª<span class="string">&#x27;a&#x27;</span>ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span><span class="template-variable">&#123;n,&#125;</span><span class="language-xml"><span class="meta"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">næ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼ŒåŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦è‡³å°‘å‡ºç°äº†næ¬¡ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">ä¾‹å¦‚, /a</span></span><span class="template-variable">&#123;2,&#125;</span><span class="language-xml"><span class="meta">/ åŒ¹é… <span class="string">&quot;aa&quot;</span>, <span class="string">&quot;aaaa&quot;</span> å’Œ <span class="string">&quot;aaaaa&quot;</span> ä½†æ˜¯ä¸åŒ¹é… <span class="string">&quot;a&quot;</span>ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span><span class="template-variable">&#123;n,m&#125;</span><span class="language-xml"><span class="meta"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">n å’Œ m éƒ½æ˜¯æ•´æ•°ã€‚åŒ¹é…å‰é¢çš„å­—ç¬¦è‡³å°‘næ¬¡ï¼Œæœ€å¤šmæ¬¡ã€‚å¦‚æœ n æˆ–è€… m çš„å€¼æ˜¯0ï¼Œ è¿™ä¸ªå€¼è¢«å¿½ç•¥ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">ä¾‹å¦‚ï¼Œ/a</span></span><span class="template-variable">&#123;1, 3&#125;</span><span class="language-xml"><span class="meta">/ å¹¶ä¸åŒ¹é…â€œcndyâ€ä¸­çš„ä»»æ„å­—ç¬¦ï¼ŒåŒ¹é…â€œcandyâ€ä¸­çš„aï¼ŒåŒ¹é…â€œcaandyâ€ä¸­çš„å‰ä¸¤ä¸ªaï¼Œä¹ŸåŒ¹é…â€œcaaaaaaandyâ€ä¸­çš„å‰ä¸‰ä¸ªaã€‚æ³¨æ„ï¼Œå½“åŒ¹é…â€caaaaaaandyâ€œæ—¶ï¼ŒåŒ¹é…çš„å€¼æ˜¯â€œaaaâ€ï¼Œå³ä½¿åŸå§‹çš„å­—ç¬¦ä¸²ä¸­æœ‰æ›´å¤šçš„aã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">[xyz]ä¸€ä¸ªå­—ç¬¦é›†åˆã€‚åŒ¹é…æ–¹æ‹¬å·ä¸­çš„ä»»æ„å­—ç¬¦ï¼ŒåŒ…æ‹¬è½¬ä¹‰åºåˆ—ã€‚ä½ å¯ä»¥ä½¿ç”¨ç ´æŠ˜å·ï¼ˆ-ï¼‰æ¥æŒ‡å®šä¸€ä¸ªå­—ç¬¦èŒƒå›´ã€‚å¯¹äºç‚¹ï¼ˆ.ï¼‰å’Œæ˜Ÿå·ï¼ˆ*ï¼‰è¿™æ ·çš„ç‰¹æ®Šç¬¦å·åœ¨ä¸€ä¸ªå­—ç¬¦é›†ä¸­æ²¡æœ‰ç‰¹æ®Šçš„æ„ä¹‰ã€‚ä»–ä»¬ä¸å¿…è¿›è¡Œè½¬ä¹‰ï¼Œä¸è¿‡è½¬ä¹‰ä¹Ÿæ˜¯èµ·ä½œç”¨çš„ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">ä¾‹å¦‚ï¼Œ[abcd] å’Œ[a-d]æ˜¯ä¸€æ ·çš„ã€‚ä»–ä»¬éƒ½åŒ¹é…<span class="string">&quot;brisket&quot;</span>ä¸­çš„â€˜bâ€™,ä¹Ÿéƒ½åŒ¹é…â€œcityâ€ä¸­çš„â€˜câ€™ã€‚/[a-z.]+/ å’Œ/[\w.]+/ä¸å­—ç¬¦ä¸²â€œtest.i.ngâ€åŒ¹é…ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">[^xyz]</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">ä¸€ä¸ªåå‘å­—ç¬¦é›†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ å®ƒåŒ¹é…ä»»ä½•æ²¡æœ‰åŒ…å«åœ¨æ–¹æ‹¬å·ä¸­çš„å­—ç¬¦ã€‚ä½ å¯ä»¥ä½¿ç”¨ç ´æŠ˜å·ï¼ˆ-ï¼‰æ¥æŒ‡å®šä¸€ä¸ªå­—ç¬¦èŒƒå›´ã€‚ä»»ä½•æ™®é€šå­—ç¬¦åœ¨è¿™é‡Œéƒ½æ˜¯èµ·ä½œç”¨çš„ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">ä¾‹å¦‚ï¼Œ[^abc] å’Œ [^a-c] æ˜¯ä¸€æ ·çš„ã€‚ä»–ä»¬åŒ¹é…<span class="string">&quot;brisket&quot;</span>ä¸­çš„â€˜râ€™ï¼Œä¹ŸåŒ¹é…â€œchopâ€ä¸­çš„â€˜hâ€™ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">[\b]</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">åŒ¹é…ä¸€ä¸ªé€€æ ¼(U+0008)ã€‚ï¼ˆä¸è¦å’Œ\bæ··æ·†äº†ã€‚ï¼‰</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">\b</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">åŒ¹é…ä¸€ä¸ªè¯çš„è¾¹ç•Œã€‚ä¸€ä¸ªè¯çš„è¾¹ç•Œå°±æ˜¯ä¸€ä¸ªè¯ä¸è¢«å¦å¤–ä¸€ä¸ªâ€œå­—â€å­—ç¬¦è·Ÿéšçš„ä½ç½®æˆ–è€…å‰é¢è·Ÿå…¶ä»–â€œå­—â€å­—ç¬¦çš„ä½ç½®ï¼Œä¾‹å¦‚åœ¨å­—æ¯å’Œç©ºæ ¼ä¹‹é—´ã€‚æ³¨æ„ï¼ŒåŒ¹é…ä¸­ä¸åŒ…æ‹¬åŒ¹é…çš„å­—è¾¹ç•Œã€‚æ¢å¥è¯è¯´ï¼Œä¸€ä¸ªåŒ¹é…çš„è¯çš„è¾¹ç•Œçš„å†…å®¹çš„é•¿åº¦æ˜¯0ã€‚ï¼ˆä¸è¦å’Œ[\b]æ··æ·†äº†ï¼‰</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">ä½¿ç”¨<span class="string">&quot;moon&quot;</span>ä¸¾ä¾‹ï¼š</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">/\bm/åŒ¹é…â€œmoonâ€ä¸­çš„â€˜mâ€™ï¼›</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">/oo\b/å¹¶ä¸åŒ¹é…<span class="string">&quot;moon&quot;</span>ä¸­çš„<span class="string">&#x27;oo&#x27;</span>ï¼Œå› ä¸º<span class="string">&#x27;oo&#x27;</span>è¢«ä¸€ä¸ªâ€œå­—â€å­—ç¬¦<span class="string">&#x27;n&#x27;</span>ç´§è·Ÿç€ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">/oon\b/åŒ¹é…<span class="string">&quot;moon&quot;</span>ä¸­çš„<span class="string">&#x27;oon&#x27;</span>ï¼Œå› ä¸º<span class="string">&#x27;oon&#x27;</span>æ˜¯è¿™ä¸ªå­—ç¬¦ä¸²çš„ç»“æŸéƒ¨åˆ†ã€‚è¿™æ ·ä»–æ²¡æœ‰è¢«ä¸€ä¸ªâ€œå­—â€å­—ç¬¦ç´§è·Ÿç€ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">/\w\b\w/å°†ä¸èƒ½åŒ¹é…ä»»ä½•å­—ç¬¦ä¸²ï¼Œå› ä¸ºåœ¨ä¸€ä¸ªå•è¯ä¸­é—´çš„å­—ç¬¦æ°¸è¿œä¹Ÿä¸å¯èƒ½åŒæ—¶æ»¡è¶³æ²¡æœ‰â€œå­—â€å­—ç¬¦è·Ÿéšå’Œæœ‰â€œå­—â€å­—ç¬¦è·Ÿéšä¸¤ç§æƒ…å†µã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">æ³¨æ„: <span class="keyword">JavaScript</span>çš„æ­£åˆ™è¡¨è¾¾å¼å¼•æ“å°†ç‰¹å®šçš„å­—ç¬¦é›†å®šä¹‰ä¸ºâ€œå­—â€å­—ç¬¦ã€‚ä¸åœ¨è¯¥é›†åˆä¸­çš„ä»»ä½•å­—ç¬¦éƒ½è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªæ–­è¯ã€‚è¿™ç»„å­—ç¬¦ç›¸å½“æœ‰é™ï¼šå®ƒåªåŒ…æ‹¬å¤§å†™å’Œå°å†™çš„ç½—é©¬å­—æ¯ï¼Œåè¿›åˆ¶æ•°å­—å’Œä¸‹åˆ’çº¿å­—ç¬¦ã€‚ä¸å¹¸çš„æ˜¯ï¼Œé‡è¦çš„å­—ç¬¦ï¼Œä¾‹å¦‚â€œÃ©â€æˆ–â€œÃ¼â€ï¼Œè¢«è§†ä¸ºæ–­è¯ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">\B</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">åŒ¹é…ä¸€ä¸ªéå•è¯è¾¹ç•Œã€‚åŒ¹é…å¦‚ä¸‹å‡ ç§æƒ…å†µï¼š</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">å­—ç¬¦ä¸²ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºéâ€œå­—â€å­—ç¬¦</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">å­—ç¬¦ä¸²æœ€åä¸€ä¸ªå­—ç¬¦ä¸ºéâ€œå­—â€å­—ç¬¦</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">ä¸¤ä¸ªå•è¯å­—ç¬¦ä¹‹é—´</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">ä¸¤ä¸ªéå•è¯å­—ç¬¦ä¹‹é—´</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">ç©ºå­—ç¬¦ä¸²</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">ä¾‹å¦‚ï¼Œ/\B../åŒ¹é…<span class="string">&quot;noonday&quot;</span>ä¸­çš„<span class="string">&#x27;oo&#x27;</span>, è€Œ/y\B../åŒ¹é…<span class="string">&quot;possibly yesterday&quot;</span>ä¸­çš„â€™yesâ€˜</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">\cX</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">å½“Xæ˜¯å¤„äºAåˆ°Zä¹‹é—´çš„å­—ç¬¦çš„æ—¶å€™ï¼ŒåŒ¹é…å­—ç¬¦ä¸²ä¸­çš„ä¸€ä¸ªæ§åˆ¶ç¬¦ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">ä¾‹å¦‚ï¼Œ/\cM/ åŒ¹é…å­—ç¬¦ä¸²ä¸­çš„ <span class="keyword">control-M</span> (U+000D)ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">\d</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">åŒ¹é…ä¸€ä¸ªæ•°å­—ã€‚ç­‰ä»·äº[0-9]ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">ä¾‹å¦‚ï¼Œ /\d/ æˆ–è€… /[0-9]/ åŒ¹é…<span class="string">&quot;B2 is the suite number.&quot;</span>ä¸­çš„<span class="string">&#x27;2&#x27;</span>ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">\D</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">åŒ¹é…ä¸€ä¸ªéæ•°å­—å­—ç¬¦ã€‚ç­‰ä»·äº[^0-9]ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">ä¾‹å¦‚ï¼Œ /\D/ æˆ–è€… /[^0-9]/ åŒ¹é…<span class="string">&quot;B2 is the suite number.&quot;</span>ä¸­çš„<span class="string">&#x27;B&#x27;</span> ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">\fåŒ¹é…ä¸€ä¸ªæ¢é¡µç¬¦ (U+000C)ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">\nåŒ¹é…ä¸€ä¸ªæ¢è¡Œç¬¦ (U+000A)ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">\råŒ¹é…ä¸€ä¸ªå›è½¦ç¬¦ (U+000D)ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">\s</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">åŒ¹é…ä¸€ä¸ªç©ºç™½å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦å’Œæ¢è¡Œç¬¦ã€‚ç­‰ä»·äº[ \f\n\r\t\v\u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">ä¾‹å¦‚, /\s\w*/ åŒ¹é…<span class="string">&quot;foo bar.&quot;</span>ä¸­çš„<span class="string">&#x27; bar&#x27;</span>ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">ç»æµ‹è¯•ï¼Œ\sä¸åŒ¹é…<span class="string">&quot;\u180e&quot;</span>ï¼Œåœ¨å½“å‰ç‰ˆæœ¬Chrome(<span class="keyword">v8</span>0.0.3987.122)å’ŒFirefox(76.0.1)æ§åˆ¶å°è¾“å…¥/\s/.test(&quot;\<span class="keyword">u18</span>0e&quot;)å‡è¿”å›falseã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">\S</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">åŒ¹é…ä¸€ä¸ªéç©ºç™½å­—ç¬¦ã€‚ç­‰ä»·äº [^ \f\n\r\t\v\u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">ä¾‹å¦‚ï¼Œ/\S\w*/ åŒ¹é…<span class="string">&quot;foo bar.&quot;</span>ä¸­çš„<span class="string">&#x27;foo&#x27;</span>ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">\tåŒ¹é…ä¸€ä¸ªæ°´å¹³åˆ¶è¡¨ç¬¦ (U+0009)ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">\våŒ¹é…ä¸€ä¸ªå‚ç›´åˆ¶è¡¨ç¬¦ (U+000B)ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">\w</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">åŒ¹é…ä¸€ä¸ªå•å­—å­—ç¬¦ï¼ˆå­—æ¯ã€æ•°å­—æˆ–è€…ä¸‹åˆ’çº¿ï¼‰ã€‚ç­‰ä»·äº [A-Za-z0-9_]ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">ä¾‹å¦‚, /\w/ åŒ¹é… <span class="string">&quot;apple,&quot;</span> ä¸­çš„ <span class="string">&#x27;a&#x27;</span>ï¼Œ<span class="string">&quot;$5.28,&quot;</span>ä¸­çš„ <span class="string">&#x27;5&#x27;</span> å’Œ <span class="string">&quot;3D.&quot;</span> ä¸­çš„ <span class="string">&#x27;3&#x27;</span>ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">\W</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">åŒ¹é…ä¸€ä¸ªéå•å­—å­—ç¬¦ã€‚ç­‰ä»·äº [^A-Za-z0-9_]ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">ä¾‹å¦‚, /\W/ æˆ–è€… /[^A-Za-z0-9_]/ åŒ¹é… <span class="string">&quot;50%.&quot;</span> ä¸­çš„ <span class="string">&#x27;%&#x27;</span>ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">\n</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œå®ƒè¿”å›æœ€åçš„ç¬¬nä¸ªå­æ•è·åŒ¹é…çš„å­å­—ç¬¦ä¸²(æ•è·çš„æ•°ç›®ä»¥å·¦æ‹¬å·è®¡æ•°)ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">æ¯”å¦‚ /apple(,)\sorange\1/ åŒ¹é…<span class="string">&quot;apple, orange, cherry, peach.&quot;</span>ä¸­çš„<span class="string">&#x27;apple, orange,&#x27;</span> ã€‚</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">\0åŒ¹é… <span class="keyword">NULL</span>ï¼ˆU+0000ï¼‰å­—ç¬¦ï¼Œ ä¸è¦åœ¨è¿™åé¢è·Ÿå…¶å®ƒå°æ•°ï¼Œå› ä¸º \0&lt;digits&gt;</span> æ˜¯ä¸€ä¸ªå…«è¿›åˆ¶è½¬ä¹‰åºåˆ—ã€‚</span></span><br><span class="line"><span class="language-xml">\xhhåŒ¹é…ä¸€ä¸ªä¸¤ä½åå…­è¿›åˆ¶æ•°ï¼ˆ\x00-\xFFï¼‰è¡¨ç¤ºçš„å­—ç¬¦ã€‚</span></span><br><span class="line"><span class="language-xml">\uhhhhåŒ¹é…ä¸€ä¸ªå››ä½åå…­è¿›åˆ¶æ•°è¡¨ç¤ºçš„ UTF-16 ä»£ç å•å…ƒã€‚</span></span><br><span class="line"><span class="language-xml">\u</span><span class="template-variable">&#123;hhhh&#125;</span><span class="language-xml">æˆ–\u</span><span class="template-variable">&#123;hhhhh&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">ï¼ˆä»…å½“è®¾ç½®äº†uæ ‡å¿—æ—¶ï¼‰åŒ¹é…ä¸€ä¸ªåå…­è¿›åˆ¶æ•°è¡¨ç¤ºçš„ Unicode å­—ç¬¦ã€‚</span></span><br></pre></td></tr></table></figure><h1 id="äºŒã€ä¿®é¥°ç¬¦"><a href="#äºŒã€ä¿®é¥°ç¬¦" class="headerlink" title="äºŒã€ä¿®é¥°ç¬¦"></a>äºŒã€ä¿®é¥°ç¬¦</h1><p>i ä¸åŒºåˆ†(ignore)å¤§å°å†™ï¼›</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä¾‹å¦‚: /<span class="keyword">abc</span>/i å¯ä»¥åŒ¹é… <span class="keyword">abc</span>ã€aBCã€Abc</span><br></pre></td></tr></table></figure><p>g å…¨å±€(global)åŒ¹é…<br>å¦‚æœä¸å¸¦gï¼Œæ­£åˆ™è¿‡ç¨‹ä¸­å­—ç¬¦ä¸²ä»å·¦åˆ°å³åŒ¹é…ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„å³åŒ¹é…æˆåŠŸï¼Œè¿”å›<br>å¦‚æœå¸¦gï¼Œåˆ™å­—ç¬¦ä¸²ä»å·¦åˆ°å³ï¼Œæ‰¾åˆ°æ¯ä¸ªç¬¦åˆæ¡ä»¶çš„éƒ½è®°å½•ä¸‹æ¥ï¼ŒçŸ¥é“å­—ç¬¦ä¸²ç»“å°¾ä½ç½®<br>ä¾‹å¦‚:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">&#x27;aaaaaaaa&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> reg1 = <span class="regexp">/a/</span>;  str.<span class="title function_">match</span>(reg1);  <span class="comment">// ç»“æœä¸ºï¼š[&quot;a&quot;, index: 0, input: &quot;aaaaaaaa&quot;]</span></span><br><span class="line"><span class="keyword">var</span> reg2 = <span class="regexp">/a/g</span>; str.<span class="title function_">match</span>(reg2);  <span class="comment">// ç»“æœä¸ºï¼š[&quot;a&quot;, &quot;a&quot;, &quot;a&quot;, &quot;a&quot;, &quot;a&quot;, &quot;a&quot;, &quot;a&quot;, &quot;a&quot;]</span></span><br></pre></td></tr></table></figure><p>m å¤š(more)è¡ŒåŒ¹é…<br>è‹¥å­˜åœ¨æ¢è¡Œ\nå¹¶ä¸”æœ‰å¼€å§‹^æˆ–ç»“æŸ$ç¬¦çš„æƒ…å†µä¸‹ï¼Œå’Œgä¸€èµ·ä½¿ç”¨å®ç°å…¨å±€åŒ¹é…,<br>å› ä¸ºå­˜åœ¨æ¢è¡Œæ—¶é»˜è®¤ä¼šæŠŠæ¢è¡Œç¬¦ä½œä¸ºä¸€ä¸ªå­—ç¬¦ä»»åŠ¡åŒ¹é…å­—ç¬¦ä¸²æ˜¯ä¸ªå•è¡Œï¼Œ<br>gåªåŒ¹é…ç¬¬ä¸€è¡Œï¼Œæ·»åŠ mä¹‹åå®ç°å¤šè¡Œï¼Œæ¯ä¸ªæ¢è¡Œç¬¦ä¹‹åå°±æ˜¯å¼€å§‹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;abcggab\nabcoab&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> preg1 = <span class="regexp">/^abc/gm</span>;  str.<span class="title function_">match</span>(preg1);  <span class="comment">// ç»“æœä¸ºï¼š[&quot;abc&quot;, &quot;abc&quot;]</span></span><br><span class="line"><span class="keyword">var</span> preg2 = <span class="regexp">/ab$/gm</span>;   str.<span class="title function_">match</span>(preg2);  <span class="comment">// ç»“æœä¸ºï¼š[&quot;ab&quot;, &quot;ab&quot;]</span></span><br></pre></td></tr></table></figure><p>s ç‰¹æ®Šå­—ç¬¦åœ†ç‚¹ . ä¸­åŒ…å«æ¢è¡Œç¬¦<br>é»˜è®¤çš„åœ†ç‚¹ . æ˜¯ åŒ¹é…é™¤æ¢è¡Œç¬¦ \n ä¹‹å¤–çš„ä»»ä½•å•å­—ç¬¦ï¼ŒåŠ ä¸Šsä¹‹å, . ä¸­åŒ…å«æ¢è¡Œç¬¦</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$str</span> = <span class="string">&quot;abggab\nacbs&quot;</span>;</span><br><span class="line"><span class="variable">$preg</span> = <span class="string">&quot;/b./s&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">preg_match_all</span>(<span class="variable">$preg</span>, <span class="variable">$str</span>,<span class="variable">$matchs</span>);</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="variable">$matchs</span>);<span class="comment">//Array ( [0] =&gt; Array ( [0] =&gt; bg [1] =&gt; b [2] =&gt; bs ) )</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="built_in">str</span> = <span class="string">&quot;abggab\nacbs&quot;</span>;</span><br><span class="line">reg = re.<span class="built_in">compile</span>(<span class="string">r&#x27;b.&#x27;</span>, re.S)</span><br><span class="line"><span class="built_in">print</span>(re.findall(reg, <span class="built_in">str</span>))</span><br></pre></td></tr></table></figure><p>U åªåŒ¹é…æœ€è¿‘çš„ä¸€ä¸ªå­—ç¬¦ä¸²;ä¸é‡å¤åŒ¹é…;</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$mode</span>=<span class="string">&quot;/a(.*?)c/&quot;</span>;</span><br><span class="line"><span class="variable">$preg</span>=<span class="string">&quot;/a.*c/U&quot;</span>;<span class="comment">//è¿™ä¸¤ä¸ªæ­£åˆ™è¿”å›ç›¸åŒçš„å€¼</span></span><br><span class="line"><span class="variable">$str</span>=<span class="string">&quot;abcabbbcabbbbbc&quot;</span> ;</span><br><span class="line"><span class="title function_ invoke__">preg_match</span>(<span class="variable">$mode</span>,<span class="variable">$str</span>,<span class="variable">$content</span>);   <span class="keyword">echo</span> <span class="variable">$content</span>[<span class="number">0</span>];<span class="comment">//abc</span></span><br><span class="line"><span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span>,<span class="variable">$str</span>,<span class="variable">$content</span>);   <span class="keyword">echo</span> <span class="variable">$content</span>[<span class="number">0</span>];<span class="comment">//abc</span></span><br></pre></td></tr></table></figure><p>ä¿®æ­£ç¬¦:x å°†æ¨¡å¼ä¸­çš„ç©ºç™½å¿½ç•¥;<br>ä¿®æ­£ç¬¦:A å¼ºåˆ¶ä»ç›®æ ‡å­—ç¬¦ä¸²å¼€å¤´åŒ¹é…;<br>ä¾‹:</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$mode=<span class="string">&quot;/abc/A&quot;</span><span class="comment">;</span></span><br><span class="line">å¯ä»¥ä¸$str=<span class="string">&quot;abcsdfi&quot;</span>åŒ¹é…,</span><br><span class="line">ä¸å¯ä»¥ä¸$str2=<span class="string">&quot;sdsdabc&quot;</span>åŒ¹é…<span class="comment">;</span></span><br><span class="line">å› ä¸º$str2ä¸æ˜¯ä»¥abcå¼€å¤´<span class="comment">;</span></span><br></pre></td></tr></table></figure><p>ä¿®æ­£ç¬¦:D å¦‚æœä½¿ç”¨$é™åˆ¶ç»“å°¾å­—ç¬¦,åˆ™ä¸å…è®¸ç»“å°¾æœ‰æ¢è¡Œ;<br>ä¾‹:</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æ¨¡å¼ä¸º:<span class="variable">$mode</span><span class="operator">=</span><span class="string">&quot;/abc$/&quot;</span>;</span><br><span class="line">å¯ä»¥ä¸æœ€åæœ‰æ¢è¡Œçš„<span class="variable">$str</span><span class="operator">=</span><span class="string">&quot;adshabc<span class="subst">\n</span>&quot;</span>åŒ¹é…;</span><br><span class="line">å…ƒå­ç¬¦<span class="variable">$ä¼šå¿½ç•¥æœ€åçš„æ¢è¡Œ</span>\n;</span><br><span class="line">å¦‚æœæ¨¡å¼ä¸º:<span class="variable">$mode</span><span class="operator">=</span><span class="string">&quot;/abc/D&quot;</span>,</span><br><span class="line">åˆ™ä¸èƒ½ä¸<span class="variable">$str</span><span class="operator">=</span><span class="string">&quot;adshabc<span class="subst">\n</span>&quot;</span>åŒ¹é…</span><br></pre></td></tr></table></figure><p>ä¿®æ­£ç¬¦Dé™åˆ¶å…¶ä¸å¯æœ‰æ¢è¡Œ;å¿…éœ€ä»¥abcç»“å°¾;<br>ä¿®æ­£ç¬¦:e é…åˆå‡½æ•°preg_replace()ä½¿ç”¨, å¯ä»¥æŠŠåŒ¹é…æ¥çš„å­—ç¬¦ä¸²å½“ä½œæ­£åˆ™è¡¨è¾¾å¼æ‰§è¡Œ;</p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> æ­£åˆ™è¡¨è¾¾å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ­£åˆ™è¡¨è¾¾å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­—å…¸æ’åº</title>
      <link href="/posts/df1b8d1e.html"/>
      <url>/posts/df1b8d1e.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="å­—å…¸æŒ‰ç…§keyä»å¤§åˆ°å°æ’åº"><a href="#å­—å…¸æŒ‰ç…§keyä»å¤§åˆ°å°æ’åº" class="headerlink" title="å­—å…¸æŒ‰ç…§keyä»å¤§åˆ°å°æ’åº"></a>å­—å…¸æŒ‰ç…§keyä»å¤§åˆ°å°æ’åº</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keysInfoDict = <span class="built_in">dict</span>(<span class="built_in">sorted</span>(<span class="built_in">list</span>(keysInfoDict.items()),key = <span class="keyword">lambda</span> x:x[<span class="number">0</span>], reverse=<span class="literal">True</span>))</span><br></pre></td></tr></table></figure><h1 id="å­—å…¸æŒ‰ç…§å€¼ä»å¤§åˆ°å°æ’åº"><a href="#å­—å…¸æŒ‰ç…§å€¼ä»å¤§åˆ°å°æ’åº" class="headerlink" title="å­—å…¸æŒ‰ç…§å€¼ä»å¤§åˆ°å°æ’åº"></a>å­—å…¸æŒ‰ç…§å€¼ä»å¤§åˆ°å°æ’åº</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keysInfoDict = <span class="built_in">dict</span>(<span class="built_in">sorted</span>(<span class="built_in">list</span>(keysInfoDict.items()),key = <span class="keyword">lambda</span> x:x[<span class="number">1</span>], reverse=<span class="literal">True</span>))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHPä¸­ä½¿ç”¨OpenSSLç”ŸæˆRSAå…¬é’¥ç§é’¥åŠè¿›è¡ŒåŠ å¯†è§£å¯†ç¤ºä¾‹ï¼ˆéå¯¹ç§°åŠ å¯†ï¼‰</title>
      <link href="/posts/8bee91c2.html"/>
      <url>/posts/8bee91c2.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>ä¸€ã€å…¬é’¥åŠ å¯†<br>å‡è®¾ä¸€ä¸‹ï¼Œæˆ‘æ‰¾äº†ä¸¤ä¸ªæ•°å­—ï¼Œä¸€ä¸ªæ˜¯1ï¼Œä¸€ä¸ªæ˜¯2ã€‚æˆ‘æŠŠ2ä¿ç•™èµ·æ¥ï¼Œä¸å‘Šè¯‰ä½ ä»¬ï¼Œå½“åšæˆ‘çš„ç§é’¥ï¼Œç„¶åæˆ‘å‘Šè¯‰å¤§å®¶ï¼Œ1æ˜¯æˆ‘çš„å…¬é’¥ã€‚<br>æˆ‘æœ‰ä¸€ä¸ªæ–‡ä»¶ï¼Œä¸èƒ½è®©åˆ«äººçœ‹ï¼Œæˆ‘å°±ç”¨1åŠ å¯†äº†ã€‚åˆ«äººæ‰¾åˆ°äº†è¿™ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯ä»–ä¸çŸ¥é“2å°±æ˜¯è§£å¯†çš„ç§é’¥å•Šï¼Œæ‰€ä»¥ä»–è§£ä¸å¼€ï¼Œåªæœ‰æˆ‘å¯ä»¥ç”¨æ•°å­—2ï¼Œå°±æ˜¯æˆ‘çš„ç§é’¥ï¼Œæ¥è§£å¯†ã€‚è¿™æ ·æˆ‘å°±å¯ä»¥ä¿æŠ¤æ•°æ®äº†ã€‚<br>æˆ‘çš„å¥½æœ‹å‹xç”¨æˆ‘çš„å…¬é’¥1åŠ å¯†äº†å­—ç¬¦aï¼ŒåŠ å¯†åæˆäº†bï¼Œæ”¾åœ¨ç½‘ä¸Šã€‚åˆ«äººå·åˆ°äº†è¿™ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯åˆ«äººè§£ä¸å¼€ï¼Œå› ä¸ºåˆ«äººä¸çŸ¥é“2å°±æ˜¯æˆ‘çš„ç§é’¥ï¼Œåªæœ‰æˆ‘æ‰èƒ½è§£å¯†ï¼Œè§£å¯†åå°±å¾—åˆ°aã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¼ é€åŠ å¯†çš„æ•°æ®äº†ã€‚  </p><p>äºŒã€ç§é’¥ç­¾å<br>å¦‚æœæˆ‘ç”¨ç§é’¥åŠ å¯†ä¸€æ®µæ•°æ®ï¼ˆå½“ç„¶åªæœ‰æˆ‘å¯ä»¥ç”¨ç§é’¥åŠ å¯†ï¼Œå› ä¸ºåªæœ‰æˆ‘çŸ¥é“2æ˜¯æˆ‘çš„ç§é’¥ï¼‰ï¼Œç»“æœæ‰€æœ‰çš„äººéƒ½çœ‹åˆ°æˆ‘çš„å†…å®¹äº†ï¼Œå› ä¸ºä»–ä»¬éƒ½çŸ¥é“æˆ‘çš„å…¬é’¥æ˜¯1ï¼Œé‚£ä¹ˆè¿™ç§åŠ å¯†æœ‰ä»€ä¹ˆç”¨å¤„å‘¢ï¼Ÿ<br>ä½†æ˜¯æˆ‘çš„å¥½æœ‹å‹xè¯´æœ‰äººå†’å……æˆ‘ç»™ä»–å‘ä¿¡ã€‚æ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘æŠŠæˆ‘è¦å‘çš„ä¿¡ï¼Œå†…å®¹æ˜¯cï¼Œç”¨æˆ‘çš„ç§é’¥2ï¼ŒåŠ å¯†ï¼ŒåŠ å¯†åçš„å†…å®¹æ˜¯dï¼Œå‘ç»™xï¼Œå†å‘Šè¯‰ä»–è§£å¯†çœ‹æ˜¯ä¸æ˜¯cã€‚ä»–ç”¨æˆ‘çš„å…¬é’¥1è§£å¯†ï¼Œå‘ç°æœç„¶æ˜¯cã€‚<br>è¿™ä¸ªæ—¶å€™ï¼Œä»–ä¼šæƒ³åˆ°ï¼Œèƒ½å¤Ÿç”¨æˆ‘çš„å…¬é’¥è§£å¯†çš„æ•°æ®ï¼Œå¿…ç„¶æ˜¯ç”¨æˆ‘çš„ç§é’¥åŠ çš„å¯†ã€‚åªæœ‰æˆ‘çŸ¥é“æˆ‘å¾—ç§é’¥ï¼Œå› æ­¤ä»–å°±å¯ä»¥ç¡®è®¤ç¡®å®æ˜¯æˆ‘å‘çš„ä¸œè¥¿ã€‚<br>è¿™æ ·æˆ‘ä»¬å°±èƒ½ç¡®è®¤å‘é€æ–¹èº«ä»½äº†ã€‚è¿™ä¸ªè¿‡ç¨‹å«åšæ•°å­—ç­¾åã€‚å½“ç„¶å…·ä½“çš„è¿‡ç¨‹è¦ç¨å¾®å¤æ‚ä¸€äº›ã€‚ç”¨ç§é’¥æ¥åŠ å¯†æ•°æ®ï¼Œç”¨é€”å°±æ˜¯æ•°å­—ç­¾åã€‚  </p><p>ä¸‰ã€æ€»ç»“<br>å…¬é’¥å’Œç§é’¥æ˜¯æˆå¯¹çš„ï¼Œå®ƒä»¬äº’ç›¸è§£å¯†ã€‚<br>å…¬é’¥åŠ å¯†ï¼Œç§é’¥è§£å¯†ã€‚<br>ç§é’¥æ•°å­—ç­¾åï¼Œå…¬é’¥éªŒè¯ã€‚  </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$config</span> = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&quot;digest_alg&quot;</span>    =&gt; <span class="string">&quot;sha512&quot;</span>,</span><br><span class="line">        <span class="string">&quot;private_key_bits&quot;</span> =&gt; <span class="number">4096</span>,           <span class="comment">//å­—èŠ‚æ•° 512 1024 2048 4096 ç­‰åŠ å¯†é•¿åº¦</span></span><br><span class="line">        <span class="string">&quot;private_key_type&quot;</span> =&gt; OPENSSL_KEYTYPE_RSA,   <span class="comment">//åŠ å¯†ç±»å‹</span></span><br><span class="line">      );</span><br><span class="line">    <span class="variable">$res</span> =    <span class="title function_ invoke__">openssl_pkey_new</span>(<span class="variable">$config</span>); </span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æå–ç§é’¥</span></span><br><span class="line">    <span class="title function_ invoke__">openssl_pkey_export</span>(<span class="variable">$res</span>, <span class="variable">$private_key</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç”Ÿæˆå…¬é’¥</span></span><br><span class="line">    <span class="variable">$public_key</span> = <span class="title function_ invoke__">openssl_pkey_get_details</span>(<span class="variable">$res</span>);</span><br><span class="line">    <span class="comment">// var_dump($public_key);</span></span><br><span class="line">    </span><br><span class="line">    <span class="variable">$public_key</span>=<span class="variable">$public_key</span>[<span class="string">&quot;key&quot;</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ˜¾ç¤ºæ•°æ®</span></span><br><span class="line">    <span class="title function_ invoke__">var_dump</span>(<span class="variable">$private_key</span>);    <span class="comment">//ç§é’¥</span></span><br><span class="line">    <span class="title function_ invoke__">var_dump</span>(<span class="variable">$public_key</span>);     <span class="comment">//å…¬é’¥</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è¦åŠ å¯†çš„æ•°æ®</span></span><br><span class="line">    <span class="variable">$data</span> = <span class="string">&quot;thisofcat&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;åŠ å¯†çš„æ•°æ®ï¼š&#x27;</span>.<span class="variable">$data</span>.<span class="string">&quot;\r\n&quot;</span>;  </span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç§é’¥åŠ å¯†åçš„æ•°æ®</span></span><br><span class="line">    <span class="title function_ invoke__">openssl_private_encrypt</span>(<span class="variable">$data</span>,<span class="variable">$encrypted</span>,<span class="variable">$private_key</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åŠ å¯†åçš„å†…å®¹é€šå¸¸å«æœ‰ç‰¹æ®Šå­—ç¬¦ï¼Œéœ€è¦base64ç¼–ç è½¬æ¢ä¸‹</span></span><br><span class="line">    <span class="variable">$encrypted</span> = <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$encrypted</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ç§é’¥åŠ å¯†åçš„æ•°æ®:&quot;</span>.<span class="variable">$encrypted</span>.<span class="string">&quot;\r\n&quot;</span>;  </span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å…¬é’¥è§£å¯†  </span></span><br><span class="line">    <span class="title function_ invoke__">openssl_public_decrypt</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$encrypted</span>), <span class="variable">$decrypted</span>, <span class="variable">$public_key</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;å…¬é’¥è§£å¯†åçš„æ•°æ®:&quot;</span>.<span class="variable">$decrypted</span>,<span class="string">&quot;\r\n&quot;</span>;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">// å…¬é’¥åŠ å¯† </span></span><br><span class="line">    <span class="title function_ invoke__">openssl_public_encrypt</span>(<span class="variable">$data</span>, <span class="variable">$encrypted</span>, <span class="variable">$public_key</span>);</span><br><span class="line">    <span class="variable">$encrypted</span> = <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$encrypted</span>);  </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;å…¬é’¥åŠ å¯†åçš„æ•°æ®:&quot;</span>.<span class="variable">$encrypted</span>.<span class="string">&quot;\r\n&quot;</span>;</span><br><span class="line">      </span><br><span class="line">    <span class="title function_ invoke__">openssl_private_decrypt</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$encrypted</span>), <span class="variable">$decrypted</span>, <span class="variable">$private_key</span>);<span class="comment">//ç§é’¥è§£å¯†  </span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ç§é’¥è§£å¯†åçš„æ•°æ®:&quot;</span>.<span class="variable">$decrypted</span>.<span class="string">&quot;n&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
          <category> åŠ å¯†è§£å¯† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> åŠ å¯†è§£å¯† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>url_safe base64ç¼–ç è§£ç </title>
      <link href="/posts/d0c08f2f.html"/>
      <url>/posts/d0c08f2f.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>1: ä¸ºä»€ä¹ˆéœ€è¦base64?<br>ASCIIç ä¸€å…±è§„å®šäº†128ä¸ªå­—ç¬¦çš„ç¼–ç ,è¿™128ä¸ªç¬¦å·,èŒƒå›´åœ¨[0,127]ä¹‹é—´.<br>å…¶ä¸­,[0,31],åŠ127, 33ä¸ªå±äºä¸å¯æ‰“å°çš„æ§åˆ¶å­—ç¬¦.<br>åœ¨ç”µå­é‚®ä»¶ä¼ è¾“ä¿¡æ¯æ—¶,æœ‰äº›é‚®ä»¶ç½‘å…³ä¼šæŠŠ[0,31]è¿™äº›æ§åˆ¶å­—ç¬¦ç»™æ‚„æ‚„æ¸…é™¤.<br>è¿˜æœ‰çš„æ—©æœŸç¨‹åº,æ”¶åˆ°[128,255]ä¹‹é—´çš„å›½é™…å­—ç¬¦æ—¶,ç”šè‡³ä¼šå‘ç”Ÿé”™è¯¯.<br>å¦‚ä½•åœ¨ä¸åŒé‚®ä»¶ç½‘å…³ä¹‹é—´å®‰å…¨çš„ä¼ è¾“æ§åˆ¶å­—ç¬¦,å›½é™…å­—ç¬¦,ç”šè‡³äºŒè¿›åˆ¶æ–‡ä»¶?<br>äºæ˜¯ä½œä¸ºMIMEå¤šåª’ä½“ç”µå­é‚®ä»¶æ ‡å‡†çš„ä¸€éƒ¨åˆ†â€”base64è¢«å¼€å‘å‡ºæ¥.  </p><p>1.url_safe base64ç¼–ç <br>åœ¨ä¸Šé¢çš„base64ä¼ ç»Ÿç¼–ç ä¸­ä¼šå‡ºç°+, &#x2F;ä¸¤ä¸ªä¼šè¢«urlç›´æ¥è½¬ä¹‰çš„ç¬¦å·ï¼Œå› æ­¤å¦‚æœå¸Œæœ›é€šè¿‡urlä¼ è¾“è¿™äº›ç¼–ç å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬<br>éœ€è¦å…ˆåšä¼ ç»Ÿbase64ç¼–ç ï¼Œéšåå°†+å’Œ&#x2F;åˆ†åˆ«æ›¿æ¢ä¸º- _ä¸¤ä¸ªå­—ç¬¦ï¼Œåœ¨æ¥æ”¶ç«¯åˆ™åšç›¸åçš„åŠ¨ä½œè§£ç   </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * URL base64è§£ç </span></span><br><span class="line"><span class="comment">     * &#x27;-&#x27; -&gt; &#x27;+&#x27;</span></span><br><span class="line"><span class="comment">     * &#x27;_&#x27; -&gt; &#x27;/&#x27;</span></span><br><span class="line"><span class="comment">     * å­—ç¬¦ä¸²é•¿åº¦%4çš„ä½™æ•°ï¼Œè¡¥&#x27;=&#x27;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">urlsafe_b64decode</span>(<span class="params"><span class="variable">$string</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$data</span> = <span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;_&#x27;</span>),<span class="keyword">array</span>(<span class="string">&#x27;+&#x27;</span>,<span class="string">&#x27;/&#x27;</span>),<span class="variable">$string</span>);</span><br><span class="line">        <span class="variable">$mod4</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$data</span>) % <span class="number">4</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$mod4</span>) &#123;</span><br><span class="line">            <span class="variable">$data</span> .= <span class="title function_ invoke__">substr</span>(<span class="string">&#x27;====&#x27;</span>, <span class="variable">$mod4</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$data</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * URL base64ç¼–ç </span></span><br><span class="line"><span class="comment">     * &#x27;+&#x27; -&gt; &#x27;-&#x27;</span></span><br><span class="line"><span class="comment">     * &#x27;/&#x27; -&gt; &#x27;_&#x27;</span></span><br><span class="line"><span class="comment">     * &#x27;=&#x27; -&gt; &#x27;&#x27;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">urlsafe_b64encode</span>(<span class="params"><span class="variable">$string</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$data</span> = <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$string</span>);</span><br><span class="line">        <span class="variable">$data</span> = <span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&#x27;+&#x27;</span>,<span class="string">&#x27;/&#x27;</span>),<span class="keyword">array</span>(<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;_&#x27;</span>),<span class="variable">$data</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$data</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
          <category> åŠ å¯†è§£å¯† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> åŠ å¯†è§£å¯† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å›¾ç‰‡å¤„ç†</title>
      <link href="/posts/e65a2183.html"/>
      <url>/posts/e65a2183.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”Ÿæˆå¸¦æ°´å°çš„å›¾ç‰‡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $source_path å›¾ç‰‡æ–‡ä»¶æˆ–URL</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $source_type å›¾ç‰‡æ¥æºç±»å‹ 1-æ¥¼ç›˜ 2-ç”¨æˆ·å›¾ç‰‡ 3-å¾®ä¿¡äºŒç»´ç  4- 5-å°ç¨‹åºäºŒç»´ç  6- 7-</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $source_x è°ƒæ•´åçš„åŸå›¾xåæ ‡ç‚¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $source_y è°ƒæ•´åçš„åŸå›¾yåæ ‡ç‚¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $target_width åŸå›¾è°ƒæ•´åçš„å®½åº¦</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $target_height åŸå›¾è°ƒæ•´åçš„é«˜åº¦</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $cropped_width è£å‰ªè°ƒæ•´åå›¾ç‰‡çš„å®½åº¦</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $cropped_height é‡‡é›†è°ƒæ•´åå›¾ç‰‡çš„é«˜åº¦</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> bool|string è¿”å›å›¾ç‰‡åœ°å€</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">imageCropperWatermark</span>(<span class="params"><span class="variable">$source_path</span>, <span class="variable">$source_type</span>, <span class="variable">$source_x</span>=<span class="number">0</span>,<span class="variable">$source_y</span>=<span class="number">0</span>,<span class="variable">$target_width</span>=<span class="number">0</span>, <span class="variable">$target_height</span>=<span class="number">0</span>, <span class="variable">$cropped_width</span> = <span class="number">0</span>, <span class="variable">$cropped_height</span> = <span class="number">0</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$logo</span> = ROOT_PATH . <span class="string">&quot;img/img/picEditLogo.png&quot;</span>; <span class="comment">//æ°´å°å›¾ç‰‡</span></span><br><span class="line">        <span class="comment">//è·å–æ°´å°æº</span></span><br><span class="line">        <span class="variable">$watermark</span> = <span class="title function_ invoke__">imagecreatefromstring</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$logo</span>));</span><br><span class="line">        <span class="comment">//è·å–å›¾ã€æ°´å° å®½é«˜ç±»å‹</span></span><br><span class="line">        <span class="variable">$sourceInfo</span> = <span class="title function_ invoke__">getimagesize</span>(<span class="variable">$source_path</span>);</span><br><span class="line">        <span class="keyword">list</span>(<span class="variable">$sourceWidth</span>, <span class="variable">$sourceHeight</span>, <span class="variable">$sourceType</span>) = <span class="variable">$sourceInfo</span>;</span><br><span class="line">        <span class="variable">$sourceMime</span>   = <span class="variable">$sourceInfo</span>[<span class="string">&#x27;mime&#x27;</span>];</span><br><span class="line">        <span class="keyword">list</span>(<span class="variable">$logoWidth</span>, <span class="variable">$logoHeight</span>, <span class="variable">$logoType</span>) = <span class="title function_ invoke__">getimagesize</span>(<span class="variable">$logo</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$cropped_width</span>) &amp;&amp; <span class="keyword">empty</span>(<span class="variable">$cropped_height</span>)) &#123;</span><br><span class="line">            <span class="variable">$target_width</span> = <span class="variable">$cropped_width</span> = <span class="variable">$sourceWidth</span>;</span><br><span class="line">            <span class="variable">$target_height</span> = <span class="variable">$cropped_height</span> = <span class="variable">$sourceHeight</span>;</span><br><span class="line">        &#125; <span class="keyword">elseif</span>(<span class="variable">$target_width</span>&lt;<span class="variable">$cropped_width</span> || <span class="variable">$target_height</span>&lt; <span class="variable">$cropped_height</span>)&#123;</span><br><span class="line">            <span class="variable">$target_width</span> = <span class="variable">$cropped_width</span>;</span><br><span class="line">            <span class="variable">$target_height</span> = <span class="variable">$cropped_height</span>;</span><br><span class="line">            <span class="variable">$source_x</span> = <span class="number">0</span>;</span><br><span class="line">            <span class="variable">$source_y</span> = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$temp</span> =  <span class="title function_ invoke__">dirname</span>(SITE_PATH).<span class="string">&#x27;/img/tmp/&#x27;</span>.<span class="title function_ invoke__">time</span>();</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$source_type</span> == <span class="number">3</span>) &#123;</span><br><span class="line">            <span class="comment">//å¾®ä¿¡äºŒç»´ç è£å‰ªå›¾</span></span><br><span class="line">            <span class="variable">$temp</span> =  <span class="title function_ invoke__">dirname</span>(SITE_PATH).<span class="string">&#x27;/pic/weixin/&#x27;</span>.<span class="title function_ invoke__">date</span>(<span class="string">&#x27;Y/m/d&#x27;</span>,<span class="title function_ invoke__">time</span>()).<span class="string">&#x27;/&#x27;</span>.<span class="title function_ invoke__">time</span>();</span><br><span class="line">        &#125;<span class="keyword">elseif</span>(<span class="variable">$source_type</span> == <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="comment">//å¤´åƒè£å‰ªå›¾</span></span><br><span class="line">            <span class="variable">$temp</span> =  <span class="title function_ invoke__">dirname</span>(SITE_PATH).<span class="string">&#x27;/img/tmp/&#x27;</span>.<span class="title function_ invoke__">time</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (<span class="variable">$sourceMime</span>) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;image/gif&#x27;</span>:</span><br><span class="line">                <span class="variable">$sourceImage</span> = <span class="title function_ invoke__">imagecreatefromgif</span>(<span class="variable">$source_path</span>);</span><br><span class="line">                <span class="variable">$_type</span> = <span class="string">&#x27;.gif&#x27;</span>;</span><br><span class="line">                <span class="variable">$temp</span> .=<span class="variable">$_type</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;image/jpeg&#x27;</span>:</span><br><span class="line">                <span class="variable">$sourceImage</span> = <span class="title function_ invoke__">imagecreatefromjpeg</span>(<span class="variable">$source_path</span>);</span><br><span class="line">                <span class="variable">$_type</span> = <span class="string">&#x27;.jpg&#x27;</span>;</span><br><span class="line">                <span class="variable">$temp</span> .=<span class="variable">$_type</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;image/png&#x27;</span>:</span><br><span class="line">                <span class="variable">$sourceImage</span> = <span class="title function_ invoke__">imagecreatefrompng</span>(<span class="variable">$source_path</span>);</span><br><span class="line">                <span class="variable">$_type</span> =<span class="string">&#x27;.png&#x27;</span>;</span><br><span class="line">                <span class="variable">$temp</span> .=<span class="variable">$_type</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å®šä¹‰å¹³é“ºæ•°æ®</span></span><br><span class="line">        <span class="variable">$x_length</span> = <span class="variable">$sourceWidth</span>; <span class="comment">//xè½´æ€»é•¿åº¦</span></span><br><span class="line">        <span class="variable">$y_length</span> = <span class="variable">$sourceHeight</span>; <span class="comment">//yè½´æ€»é•¿åº¦</span></span><br><span class="line">        <span class="comment">//åˆ›å»ºé€æ˜ç”»å¸ƒ ä¼ªç™½è‰²</span></span><br><span class="line">        <span class="variable">$opacity</span>=<span class="number">20</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¾ªç¯å¹³é“ºæ°´å°</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$x</span> = <span class="number">0</span>; <span class="variable">$x</span> &lt; <span class="variable">$x_length</span>; <span class="variable">$x</span>++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="variable">$y</span> = <span class="number">0</span>; <span class="variable">$y</span> &lt; <span class="variable">$y_length</span>; <span class="variable">$y</span>++) &#123;</span><br><span class="line">                <span class="title function_ invoke__">imagecopymerge</span>(<span class="variable">$sourceImage</span>, <span class="variable">$watermark</span>, <span class="variable">$x</span>, <span class="variable">$y</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="variable">$logoWidth</span>, <span class="variable">$logoHeight</span>, <span class="variable">$opacity</span>);</span><br><span class="line">                <span class="variable">$y</span> += <span class="variable">$logoHeight</span> - <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$x</span> += <span class="variable">$logoWidth</span> - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$targetImage</span>  = <span class="title function_ invoke__">imagecreatetruecolor</span>(<span class="variable">$target_width</span>, <span class="variable">$target_height</span>);</span><br><span class="line">        <span class="variable">$croppedImage</span> = <span class="title function_ invoke__">imagecreatetruecolor</span>(<span class="variable">$cropped_width</span>, <span class="variable">$cropped_height</span>);</span><br><span class="line">        <span class="title function_ invoke__">imagecopyresampled</span>(<span class="variable">$targetImage</span>,<span class="variable">$sourceImage</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="variable">$target_width</span>,<span class="variable">$target_height</span>,<span class="variable">$sourceWidth</span>,<span class="variable">$sourceHeight</span>);<span class="comment">//ç¼©æ”¾å›¾ç‰‡</span></span><br><span class="line"></span><br><span class="line">        <span class="variable">$source_x</span> = <span class="title function_ invoke__">abs</span>(<span class="variable">$source_x</span>);</span><br><span class="line">        <span class="variable">$source_y</span> = <span class="title function_ invoke__">abs</span>(<span class="variable">$source_y</span>);</span><br><span class="line">        <span class="title function_ invoke__">imagecopy</span>(<span class="variable">$croppedImage</span>, <span class="variable">$targetImage</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="variable">$source_x</span>, <span class="variable">$source_y</span>, <span class="variable">$cropped_width</span>,<span class="variable">$cropped_height</span>);<span class="comment">//åˆ‡å‰²</span></span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type: image/jpeg&#x27;</span>);</span><br><span class="line">        <span class="title function_ invoke__">imagejpeg</span>(<span class="variable">$croppedImage</span>,<span class="variable">$temp</span>,<span class="number">100</span>);</span><br><span class="line">        <span class="title function_ invoke__">imagedestroy</span>(<span class="variable">$sourceImage</span>);</span><br><span class="line">        <span class="title function_ invoke__">imagedestroy</span>(<span class="variable">$targetImage</span>);</span><br><span class="line">        <span class="title function_ invoke__">imagedestroy</span>(<span class="variable">$croppedImage</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
          <category> æ–¹æ³• </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>php $globalå’Œ$GLOBALSåŒºåˆ«</title>
      <link href="/posts/8c25c764.html"/>
      <url>/posts/8c25c764.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br></pre></td><td class="code"><pre><span class="line"> php ä¸­ <span class="keyword">global</span> ä¸ <span class="variable">$GLOBAL</span> ç”±å¼•ç”¨äº§ç”Ÿçš„åŒºåˆ«</span><br><span class="line"></span><br><span class="line">å¾ˆå¤šäººéƒ½è®¤ä¸º<span class="keyword">global</span>å’Œ<span class="variable">$GLOBALS</span>[]åªæ˜¯å†™æ³•ä¸Šé¢çš„å·®åˆ«ï¼Œå…¶å®ä¸ç„¶ã€‚</span><br><span class="line"></span><br><span class="line">æ ¹æ®å®˜æ–¹çš„è§£é‡Šæ˜¯</span><br><span class="line"></span><br><span class="line">    <span class="variable">$GLOBALS</span>[<span class="string">&#x27;var&#x27;</span>] æ˜¯å¤–éƒ¨çš„å…¨å±€å˜é‡<span class="variable">$var</span>æœ¬èº«ã€‚</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$var</span> æ˜¯å¤–éƒ¨<span class="variable">$var</span>çš„åŒåå¼•ç”¨æˆ–è€…æŒ‡é’ˆã€‚ï¼ˆé”™è¯¯ï¼šæ˜¯ä¸ªåˆ«åå¼•ç”¨è€Œå·²ï¼ŒéæŒ‡é’ˆï¼ï¼ï¼ï¼‰</span><br><span class="line"></span><br><span class="line">ä¸¾ä¾‹è¯´æ˜ä¸€ä¸‹ï¼š</span><br><span class="line"><span class="number">01</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="number">02</span></span><br><span class="line"><span class="variable">$var1</span> = <span class="number">1</span>;</span><br><span class="line"><span class="number">03</span></span><br><span class="line"><span class="variable">$var2</span> = <span class="number">2</span>;</span><br><span class="line"><span class="number">04</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="number">05</span></span><br><span class="line">    <span class="variable">$GLOBALS</span>[<span class="string">&#x27;var2&#x27;</span>] = &amp;<span class="variable">$GLOBALS</span>[<span class="string">&#x27;var1&#x27;</span>];</span><br><span class="line"><span class="number">06</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="number">07</span></span><br><span class="line"></span><br><span class="line"><span class="number">08</span></span><br><span class="line"><span class="title function_ invoke__">test</span>();</span><br><span class="line"><span class="number">09</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$var2</span>;</span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">    æ­£å¸¸æ‰“å°ç»“æœä¸º<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="number">01</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="number">02</span></span><br><span class="line"><span class="variable">$var1</span> = <span class="number">1</span>;</span><br><span class="line"><span class="number">03</span></span><br><span class="line"><span class="variable">$var2</span> = <span class="number">2</span>;</span><br><span class="line"><span class="number">04</span></span><br><span class="line"> </span><br><span class="line"><span class="number">05</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="number">06</span></span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$var1</span>, <span class="variable">$var2</span>;</span><br><span class="line"><span class="number">07</span></span><br><span class="line">    <span class="variable">$var2</span> = &amp;<span class="variable">$var1</span>;</span><br><span class="line"><span class="number">08</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$var2</span>;</span><br><span class="line"><span class="number">09</span></span><br><span class="line">    <span class="variable">$var2</span> = <span class="string">&#x27;qianyunlai.com&#x27;</span>;</span><br><span class="line"><span class="number">10</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="number">11</span></span><br><span class="line"> </span><br><span class="line"><span class="number">12</span></span><br><span class="line"><span class="title function_ invoke__">test</span>(); <span class="comment">// è¾“å‡º 1</span></span><br><span class="line"><span class="number">13</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$var2</span>; <span class="comment">// è¾“å‡º 2</span></span><br><span class="line"><span class="number">14</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$var1</span>; <span class="comment">// è¾“å‡º qianyunlai.com</span></span><br><span class="line"><span class="number">15</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">test</span>()å‡½æ•°ä¸­çš„<span class="variable">$var1</span>ï¼Œ<span class="variable">$va2</span>éƒ½æ˜¯å±€éƒ¨å˜é‡ï¼Œåªä¸è¿‡æ˜¯åŠ äº†<span class="keyword">global</span>å…³é”®å­—åï¼Œåˆ†åˆ«å¼•ç”¨æŒ‡å‘å…¨å±€å˜é‡<span class="variable">$var1</span>ï¼Œ<span class="variable">$va2</span>äº†ï¼Œå½“ <span class="variable">$var2</span> = &amp;<span class="variable">$var1</span>; æ—¶ï¼Œå±€éƒ¨å˜é‡<span class="variable">$var2</span>ä¸å†æŒ‡å‘å…¨å±€å˜é‡<span class="variable">$val2</span>ï¼Œè€Œé‡æ–°æŒ‡å‘å…¨å±€å˜é‡<span class="variable">$var1</span>ï¼Œæ¢å¥è¯æ¥è¯´ï¼Œå±€éƒ¨å˜é‡<span class="variable">$var2</span>çš„æ”¹å˜ï¼Œä¸ä¼šå†å½±å“åˆ°å…¨å±€å˜é‡<span class="variable">$val2</span>ï¼Œè€Œä¼šå½±å“åˆ°é‡æ–°æŒ‡å‘çš„å…¨å±€å˜é‡<span class="variable">$val1</span>ã€‚</span><br><span class="line"></span><br><span class="line">æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªä¾‹å­å§ã€‚</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="variable">$var1</span> = <span class="number">1</span>;</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="number">4</span></span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$GLOBALS</span>[<span class="string">&#x27;var1&#x27;</span>]);</span><br><span class="line"><span class="number">5</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="title function_ invoke__">test</span>();</span><br><span class="line"><span class="number">7</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$var1</span>;</span><br><span class="line"><span class="number">8</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">    å› ä¸º<span class="variable">$var1</span>è¢«åˆ é™¤äº†ï¼Œæ‰€ä»¥ä»€ä¹ˆä¸œè¥¿éƒ½æ²¡æœ‰æ‰“å°ã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">01</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="number">02</span></span><br><span class="line"><span class="variable">$var1</span> = <span class="number">1</span>;</span><br><span class="line"><span class="number">03</span></span><br><span class="line"> </span><br><span class="line"><span class="number">04</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="number">05</span></span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$var1</span>;</span><br><span class="line"><span class="number">06</span></span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$var1</span>);</span><br><span class="line"><span class="number">07</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="number">08</span></span><br><span class="line"> </span><br><span class="line"><span class="number">09</span></span><br><span class="line"><span class="title function_ invoke__">test</span>();</span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$var1</span>;</span><br><span class="line"><span class="number">11</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">    æ„å¤–çš„æ‰“å°äº†<span class="number">1</span>ã€‚</span><br><span class="line"></span><br><span class="line">è¯æ˜åˆ é™¤çš„åªæ˜¯åˆ«åï¼Œ<span class="variable">$GLOBALS</span>[<span class="string">&#x27;var&#x27;</span>]çš„å¼•ç”¨ï¼Œèµ·æœ¬èº«çš„å€¼æ²¡æœ‰å—åˆ°ä»»ä½•çš„æ”¹å˜ã€‚</span><br><span class="line"></span><br><span class="line">æ˜ç™½äº†å§ï¼Ÿ</span><br><span class="line"></span><br><span class="line">ä¹Ÿå°±æ˜¯è¯´ <span class="keyword">global</span> <span class="variable">$var</span> å…¶å®å°±æ˜¯<span class="variable">$var</span> = &amp;<span class="variable">$GLOBALS</span>[<span class="string">&#x27;var&#x27;</span>]ã€‚è°ƒç”¨å¤–éƒ¨å˜é‡çš„ä¸€ä¸ªåˆ«åè€Œå·²ã€‚</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">+++ æ¢è®¨ï¼ˆäºŒï¼‰++++++++++++++++++++++++++++++++++++++++++</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">PHPä¸­<span class="keyword">global</span>å’Œ<span class="variable">$GLOBALS</span>ä¸ä»…ä»…æ˜¯å†™æ³•ä¸ä¸€æ ·ä»¥ä¸ºï¼Œä¸¤è€…çš„åŒºåˆ«è¿˜æ˜¯å¾ˆå¤§çš„ï¼Œåœ¨å®é™…åº”ç”¨ä¸­éœ€è¦æ³¨æ„ï¼</span><br><span class="line"></span><br><span class="line">å…ˆçœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="variable">$id</span> = <span class="number">1</span>;</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="number">4</span></span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$id</span>;</span><br><span class="line"><span class="number">5</span></span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$id</span>);</span><br><span class="line"><span class="number">6</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="number">7</span></span><br><span class="line"><span class="title function_ invoke__">test</span>();</span><br><span class="line"><span class="number">8</span></span><br><span class="line"><span class="keyword">echo</span>(<span class="variable">$id</span>); <span class="comment">// è¾“å‡º 1</span></span><br><span class="line"><span class="number">9</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">å¼•ç”¨å®šä½</span><br><span class="line"></span><br><span class="line">è®¸å¤šPHPçš„è¯­æ³•ç»“æ„æ˜¯é€šè¿‡å¼•ç”¨æœºåˆ¶å®ç°çš„ï¼Œæ‰€ä»¥ä¸Šè¿°æœ‰å…³å¼•ç”¨ç»‘å®šçš„ä¸€åˆ‡ä¹Ÿéƒ½é€‚ç”¨äºè¿™äº›ç»“æ„ã€‚ä¸€äº›ç»“æ„ï¼Œä¾‹å¦‚å¼•ç”¨ä¼ é€’å’Œå¼•ç”¨è¿”å›ï¼Œå·²ç»åœ¨ä¸Šé¢æåˆ°äº†ã€‚å…¶å®ƒä½¿ç”¨å¼•ç”¨çš„ç»“æ„æœ‰ï¼š</span><br><span class="line"></span><br><span class="line">å½“ç”¨ <span class="keyword">global</span> <span class="variable">$var</span> å£°æ˜ä¸€ä¸ªå˜é‡æ—¶å®é™…ä¸Šå»ºç«‹äº†ä¸€ä¸ªåˆ°å…¨å±€å˜é‡çš„å¼•ç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´å’Œè¿™æ ·åšæ˜¯ç›¸åŒçš„ï¼š</span><br><span class="line"><span class="number">01</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="number">02</span></span><br><span class="line"><span class="variable">$GLOBALS</span>[<span class="string">&quot;var1&quot;</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="number">03</span></span><br><span class="line"><span class="variable">$var</span> = &amp;<span class="variable">$GLOBALS</span>[<span class="string">&quot;var1&quot;</span>];</span><br><span class="line"><span class="number">04</span></span><br><span class="line"><span class="keyword">unset</span>(<span class="variable">$var</span>);</span><br><span class="line"><span class="number">05</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$GLOBALS</span>[<span class="string">&#x27;var1&#x27;</span>]; <span class="comment">//è¾“å‡º1</span></span><br><span class="line"><span class="number">06</span></span><br><span class="line"><span class="comment">//############################################</span></span><br><span class="line"><span class="number">07</span></span><br><span class="line"><span class="variable">$GLOBALS</span>[<span class="string">&quot;var1&quot;</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="number">08</span></span><br><span class="line"><span class="variable">$var</span> = &amp;<span class="variable">$GLOBALS</span>[<span class="string">&quot;var1&quot;</span>];</span><br><span class="line"><span class="number">09</span></span><br><span class="line"><span class="keyword">unset</span>(<span class="variable">$GLOBALS</span>[<span class="string">&#x27;var1&#x27;</span>]);</span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$var</span>; <span class="comment">//è¾“å‡º1</span></span><br><span class="line"><span class="number">11</span></span><br><span class="line"><span class="comment">//############################################</span></span><br><span class="line"><span class="number">12</span></span><br><span class="line"><span class="comment">//å¦‚æœå†™æˆå¦‚ä¸‹ï¼Œåˆ™ä¼šå‡ºé”™</span></span><br><span class="line"><span class="number">13</span></span><br><span class="line"><span class="variable">$GLOBALS</span>[<span class="string">&quot;var&quot;</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="number">14</span></span><br><span class="line"><span class="variable">$var</span> = &amp;<span class="variable">$GLOBALS</span>[<span class="string">&quot;var&quot;</span>];</span><br><span class="line"><span class="number">15</span></span><br><span class="line"><span class="keyword">unset</span>(<span class="variable">$GLOBALS</span>[<span class="string">&#x27;var&#x27;</span>]);</span><br><span class="line"><span class="number">16</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$var</span>; <span class="comment">//è„šæœ¬æ²¡æ³•æ‰§è¡Œ</span></span><br><span class="line"><span class="number">17</span></span><br><span class="line"><span class="comment">//###########################################</span></span><br><span class="line"><span class="number">18</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">è¿™æ„å‘³ç€ï¼Œä¾‹å¦‚ï¼Œ<span class="keyword">unset</span> <span class="variable">$var</span> ä¸ä¼š <span class="keyword">unset</span> å…¨å±€å˜é‡ã€‚</span><br><span class="line"></span><br><span class="line"><span class="keyword">unset</span>åªæ˜¯æŠŠåªæ˜¯æ–­å¼€äº†å˜é‡åå’Œå˜é‡å†…å®¹ä¹‹é—´çš„ç»‘å®šã€‚è¿™å¹¶ä¸æ„å‘³ç€å˜é‡å†…å®¹è¢«é”€æ¯äº†ã€‚</span><br><span class="line"></span><br><span class="line">ä½¿ç”¨<span class="keyword">isset</span>(<span class="variable">$var</span>)çš„æ—¶å€™è¿”å› <span class="literal">false</span>ã€‚<span class="variable language_">$this</span>åœ¨ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•ä¸­ï¼Œ<span class="variable language_">$this</span> æ°¸è¿œæ˜¯è°ƒç”¨å®ƒçš„å¯¹è±¡çš„å¼•ç”¨ã€‚</span><br><span class="line"></span><br><span class="line">å¦‚æœåœ¨ä¸€ä¸ªå‡½æ•°å†…éƒ¨ç»™ä¸€ä¸ªå£°æ˜ä¸º <span class="keyword">global</span> çš„å˜é‡èµ‹äºä¸€ä¸ªå¼•ç”¨ï¼Œè¯¥å¼•ç”¨åªåœ¨å‡½æ•°å†…éƒ¨å¯è§ã€‚</span><br><span class="line"></span><br><span class="line">å¯ä»¥é€šè¿‡ä½¿ç”¨ <span class="variable">$GLOBALS</span> æ•°ç»„é¿å…è¿™ä¸€ç‚¹ã€‚</span><br><span class="line"></span><br><span class="line">ä¾‹ åœ¨å‡½æ•°å†…å¼•ç”¨å…¨å±€å˜é‡ï¼š</span><br><span class="line"><span class="number">01</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="number">02</span></span><br><span class="line"><span class="variable">$var1</span> = <span class="string">&quot;Example variable&quot;</span>;</span><br><span class="line"><span class="number">03</span></span><br><span class="line"><span class="variable">$var2</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="number">04</span></span><br><span class="line"> </span><br><span class="line"><span class="number">05</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">global_references</span>(<span class="params"><span class="variable">$use_globals</span></span>) </span>&#123;</span><br><span class="line"><span class="number">06</span></span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$var1</span>, <span class="variable">$var2</span>;</span><br><span class="line"><span class="number">07</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable">$use_globals</span>) &#123;</span><br><span class="line"><span class="number">08</span></span><br><span class="line">        <span class="variable">$var2</span> = &amp;<span class="variable">$var1</span>; <span class="comment">// visible only inside the function</span></span><br><span class="line"><span class="number">09</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="number">10</span></span><br><span class="line">        <span class="variable">$GLOBALS</span>[<span class="string">&quot;var2&quot;</span>] = &amp;<span class="variable">$var1</span>; <span class="comment">// visible also in global context</span></span><br><span class="line"><span class="number">11</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="number">12</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="number">13</span></span><br><span class="line"> </span><br><span class="line"><span class="number">14</span></span><br><span class="line"><span class="title function_ invoke__">global_references</span>(<span class="literal">false</span>);</span><br><span class="line"><span class="number">15</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;var2 is set to &#x27;<span class="subst">$var2</span>&#x27;\n&quot;</span>; <span class="comment">// var2 is set to &#x27;&#x27;</span></span><br><span class="line"><span class="number">16</span></span><br><span class="line"><span class="title function_ invoke__">global_references</span>(<span class="literal">true</span>);</span><br><span class="line"><span class="number">17</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;var2 is set to &#x27;<span class="subst">$var2</span>&#x27;\n&quot;</span>; <span class="comment">// var2 is set to &#x27;Example variable&#x27;</span></span><br><span class="line"><span class="number">18</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">æŠŠ <span class="keyword">global</span> <span class="variable">$var</span>; å½“æˆæ˜¯ <span class="variable">$var</span> = &amp;<span class="variable">$GLOBALS</span>[<span class="string">&#x27;var&#x27;</span>]; çš„ç®€å†™ã€‚æ‰€ä»¥ å¦‚æœå°†å…¶å®ƒå¼•ç”¨èµ‹ç»™ <span class="variable">$var</span>ï¼Œ åªæ”¹å˜äº†æœ¬åœ°å˜é‡çš„å¼•ç”¨ã€‚</span><br><span class="line"></span><br><span class="line">å¦‚å‰æ‰€è¿°ï¼Œå¼•ç”¨ä¸æ˜¯æŒ‡é’ˆã€‚è¿™æ„å‘³ç€ä¸‹é¢çš„ç»“æ„ä¸ä¼šäº§ç”Ÿé¢„æœŸçš„æ•ˆæœï¼š</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="variable">$bar</span> = <span class="number">3</span>;</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">&amp;<span class="variable">$var</span></span>) </span>&#123;</span><br><span class="line"><span class="number">4</span></span><br><span class="line">    <span class="variable">$GLOBALS</span>[<span class="string">&quot;baz&quot;</span>] = <span class="number">5</span>;</span><br><span class="line"><span class="number">5</span></span><br><span class="line">    <span class="variable">$var</span> = &amp;<span class="variable">$GLOBALS</span>[<span class="string">&quot;baz&quot;</span>];</span><br><span class="line"><span class="number">6</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="number">7</span></span><br><span class="line"><span class="title function_ invoke__">foo</span>(<span class="variable">$bar</span>);</span><br><span class="line"><span class="number">8</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$bar</span>;<span class="comment">//è¾“å‡º3</span></span><br><span class="line"><span class="number">9</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">è¿™å°†ä½¿ foo å‡½æ•°ä¸­çš„ <span class="variable">$var</span> å˜é‡åœ¨å‡½æ•°è°ƒç”¨æ—¶å’Œ <span class="variable">$bar</span> ç»‘å®šåœ¨ä¸€èµ·ï¼Œä½†æ¥ç€åˆè¢«é‡æ–°ç»‘å®šåˆ°äº† <span class="variable">$GLOBALS</span>[<span class="string">&quot;baz&quot;</span>] ä¸Šé¢ã€‚</span><br><span class="line"></span><br><span class="line">ä¸å¯èƒ½é€šè¿‡å¼•ç”¨æœºåˆ¶å°† <span class="variable">$bar</span> åœ¨å‡½æ•°è°ƒç”¨èŒƒå›´å†…ç»‘å®šåˆ°åˆ«çš„å˜é‡ä¸Šé¢ï¼Œå› ä¸ºåœ¨å‡½æ•° foo ä¸­å¹¶æ²¡æœ‰å˜é‡ <span class="variable">$bar</span>ï¼ˆå®ƒè¢«è¡¨ç¤ºä¸º <span class="variable">$var</span>ï¼Œä½†æ˜¯ <span class="variable">$var</span> åªæœ‰å˜é‡å†…å®¹è€Œæ²¡æœ‰è°ƒç”¨ç¬¦å·è¡¨ä¸­çš„åå­—åˆ°å€¼çš„ç»‘å®šï¼‰ã€‚å¯ä»¥ä½¿ç”¨å¼•ç”¨è¿”å›æ¥å¼•ç”¨è¢«å‡½æ•°é€‰æ‹©çš„å˜é‡ã€‚</span><br><span class="line"></span><br><span class="line">å¼•ç”¨phpæ‰‹å†Œçš„<span class="variable">$GLOBALS</span>çš„è§£é‡Š:</span><br><span class="line"></span><br><span class="line">Global å˜é‡ï¼š<span class="variable">$GLOBALS</span>ï¼Œæ³¨æ„ï¼š <span class="variable">$GLOBALS</span> åœ¨ PHP <span class="number">3.0</span>.<span class="number">0</span> åŠä»¥åç‰ˆæœ¬ä¸­é€‚ç”¨ã€‚</span><br><span class="line"></span><br><span class="line">ç”±æ‰€æœ‰å·²å®šä¹‰å…¨å±€å˜é‡ç»„æˆçš„æ•°ç»„ã€‚å˜é‡åå°±æ˜¯è¯¥æ•°ç»„çš„ç´¢å¼•ã€‚è¿™æ˜¯ä¸€ä¸ªâ€œsuperglobalâ€ï¼Œæˆ–è€…å¯ä»¥æè¿°ä¸ºè‡ªåŠ¨å…¨å±€å˜é‡ã€‚</span><br><span class="line"></span><br><span class="line">ä¹Ÿå°±æ˜¯è¯´ä¸Šé¢ä»£ç ä¸­çš„<span class="variable">$var1</span>å’Œ<span class="variable">$GLOBALS</span>[<span class="string">&#x27;var1&#x27;</span>]æ˜¯æŒ‡çš„åŒä¸€å˜é‡ï¼Œè€Œä¸æ˜¯<span class="number">2</span>ä¸ªä¸åŒçš„å˜é‡ï¼</span><br><span class="line"></span><br><span class="line">å¦‚æœåœ¨ä¸€ä¸ªå‡½æ•°å†…éƒ¨ç»™ä¸€ä¸ªå£°æ˜ä¸º <span class="keyword">global</span> çš„å˜é‡èµ‹äºä¸€ä¸ªå¼•ç”¨ï¼Œè¯¥å¼•ç”¨åªåœ¨å‡½æ•°å†…éƒ¨å¯è§ã€‚å¯ä»¥é€šè¿‡ä½¿ç”¨ <span class="variable">$GLOBALS</span> æ•°ç»„é¿å…è¿™ä¸€ç‚¹ã€‚</span><br><span class="line"></span><br><span class="line">æˆ‘ä»¬éƒ½çŸ¥é“phpä¸­çš„å‡½æ•°æ‰€äº§ç”Ÿçš„å˜é‡éƒ½æ˜¯å‡½æ•°çš„ç§æœ‰å˜é‡ï¼Œé‚£ä¹ˆ <span class="keyword">global</span>å…³é”®å­—äº§ç”Ÿçš„å˜é‡ä¹Ÿè‚¯å®šé€ƒä¸å‡ºè¿™ä¸ªè§„åˆ™ï¼Œ<span class="keyword">global</span>åœ¨å‡½æ•°äº§ç”Ÿä¸€ä¸ªæŒ‡å‘å‡½æ•°å¤–éƒ¨å˜é‡çš„åˆ«åå˜é‡ï¼Œè€Œä¸æ˜¯çœŸæ­£çš„å‡½æ•°å¤–éƒ¨å˜é‡ï¼Œä¸€ä½†æ”¹å˜äº†åˆ«å å˜é‡çš„æŒ‡å‘åœ°å€ï¼Œå°±ä¼šå‘ç”Ÿä¸€äº›æ„æ–™ä¸åˆ°æƒ…å†µï¼Œ<span class="variable">$GLOBALS</span>[]ç¡®ç¡®å®å®è°ƒç”¨æ˜¯å¤–éƒ¨çš„å˜é‡ï¼Œå‡½æ•°å†…å¤–ä¼šå§‹ç»ˆä¿æŒä¸€è‡´ã€‚</span><br><span class="line"><span class="number">01</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="number">02</span></span><br><span class="line"><span class="variable">$a</span> = <span class="number">1</span>;</span><br><span class="line"><span class="number">03</span></span><br><span class="line"><span class="variable">$b</span> = <span class="number">2</span>;</span><br><span class="line"><span class="number">04</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Sum</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="number">05</span></span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$a</span>, <span class="variable">$b</span>;</span><br><span class="line"><span class="number">06</span></span><br><span class="line">    <span class="variable">$b</span> = <span class="variable">$a</span> + <span class="variable">$b</span>;</span><br><span class="line"><span class="number">07</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="number">08</span></span><br><span class="line"><span class="title function_ invoke__">Sum</span>();</span><br><span class="line"><span class="number">09</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>;</span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">è¾“å‡ºå°†æ˜¯ â€œ<span class="number">3</span>â€³ã€‚åœ¨å‡½æ•°ä¸­ç”³æ˜ äº†å…¨å±€å˜é‡ <span class="variable">$a</span> å’Œ <span class="variable">$b</span>ï¼Œä»»ä½•å˜é‡çš„æ‰€æœ‰å¼•ç”¨å˜é‡éƒ½ä¼šæŒ‡å‘åˆ°å…¨å±€å˜é‡ã€‚</span><br><span class="line"></span><br><span class="line">æ€ä¹ˆä¸æ˜¯<span class="number">2</span>å‘¢ï¼Œåœ¨å‡½æ•°å¤–éƒ¨ä¸æ˜¯ä¸å½±å“å—ï¼Œè¯·æ³¨æ„<span class="variable">$b</span>åœ¨å‡½æ•°ä¸­å¹¶æ²¡æœ‰é€šè¿‡å¼•ç”¨ä¿®æ”¹ï¼Œè€Œæ˜¯ä¿®æ”¹çš„<span class="variable">$b</span>æŒ‡å‘ç‰©ç†å†…å­˜çš„å€¼ï¼Œå› æ­¤å¤–éƒ¨è¾“å…¥ä¸º<span class="number">3</span>ã€‚</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>èµ„æ–™æ•´ç†</title>
      <link href="/posts/bc315d23.html"/>
      <url>/posts/bc315d23.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>ä¸€ã€CookiesMiddlewareæ’ä»¶<br>è¯¥ä¸­é—´ä»¶ä½¿å¾—çˆ¬å–éœ€è¦cookie(ä¾‹å¦‚ä½¿ç”¨session)çš„ç½‘ç«™æˆä¸ºäº†å¯èƒ½ã€‚ å…¶è¿½è¸ªäº†web serverå‘é€çš„cookieï¼Œ<br>å¹¶åœ¨ä¹‹åçš„requestä¸­å‘é€å›å»ï¼Œå°±å¦‚æµè§ˆå™¨æ‰€åšçš„é‚£æ ·ã€‚</p><p>COOKIES_ENABLED<br>é»˜è®¤: True<br>æ˜¯å¦å¯ç”¨cookies middlewareã€‚å¦‚æœå…³é—­ï¼Œcookieså°†ä¸ä¼šå‘é€ç»™web serverã€‚</p><p>COOKIES_DEBUG<br>é»˜è®¤: False<br>å¦‚æœå¯ç”¨ï¼ŒScrapyå°†è®°å½•æ‰€æœ‰åœ¨request(Cookie è¯·æ±‚å¤´)å‘é€çš„cookiesåŠresponseæ¥æ”¶åˆ°çš„cookies(Set-Cookie æ¥æ”¶å¤´)ã€‚</p><p>Scrapyé€šè¿‡ä½¿ç”¨ cookiejar Request meta keyæ¥æ”¯æŒå•spiderè¿½è¸ªå¤šcookie sessionã€‚ é»˜è®¤æƒ…å†µä¸‹å…¶ä½¿ç”¨ä¸€ä¸ªcookie jar(session)ï¼Œä¸è¿‡æ‚¨å¯ä»¥ä¼ é€’ä¸€ä¸ªæ ‡ç¤ºç¬¦æ¥ä½¿ç”¨å¤šä¸ªã€‚<br>ä¾‹å¦‚:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i, url <span class="keyword">in</span> <span class="built_in">enumerate</span>(urls):</span><br><span class="line">    <span class="keyword">yield</span> scrapy.Request(<span class="string">&quot;http://www.example.com&quot;</span>, meta=&#123;<span class="string">&#x27;cookiejar&#x27;</span>: i&#125;,</span><br><span class="line">        callback=<span class="variable language_">self</span>.parse_page)</span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ cookiejar meta keyä¸æ˜¯â€é»æ€§çš„(sticky)â€ã€‚ æ‚¨éœ€è¦åœ¨ä¹‹åçš„requestè¯·æ±‚ä¸­æ¥ç€ä¼ é€’ã€‚ä¾‹å¦‚:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">parse_page</span>(<span class="params">self, response</span>):</span><br><span class="line">    <span class="comment"># do some processing</span></span><br><span class="line">    <span class="keyword">return</span> scrapy.Request(<span class="string">&quot;http://www.example.com/otherpage&quot;</span>,</span><br><span class="line">        meta=&#123;<span class="string">&#x27;cookiejar&#x27;</span>: response.meta[<span class="string">&#x27;cookiejar&#x27;</span>]&#125;,</span><br><span class="line">        callback=<span class="variable language_">self</span>.parse_other_page)</span><br></pre></td></tr></table></figure><p>äºŒã€htmlå­—ç¬¦ä¸²è½¬scrapyå¯è¯†åˆ«çš„å…ƒç´ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ–¹æ³•1</span></span><br><span class="line"><span class="keyword">from</span> scrapy.http <span class="keyword">import</span> HtmlResponse</span><br><span class="line"><span class="comment"># å¦‚æœæœ¬èº«å­˜åœ¨response, åˆ™url=response.url</span></span><br><span class="line">response = HtmlResponse(url=<span class="string">&quot;my HTML string&quot;</span>, body=<span class="string">&#x27;&lt;div id=&quot;test&quot;&gt;Test text&lt;/div&gt;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹æ³•2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> scrapy <span class="keyword">import</span> Selector</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>doc = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"><span class="meta">... </span>&lt;div&gt;</span></span><br><span class="line"><span class="string"><span class="meta">... </span>    &lt;ul&gt;</span></span><br><span class="line"><span class="string"><span class="meta">... </span>        &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link1.html&quot;&gt;first item&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="string"><span class="meta">... </span>        &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="string"><span class="meta">... </span>        &lt;li class=&quot;item-inactive&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;third item&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="string"><span class="meta">... </span>        &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="string"><span class="meta">... </span>        &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="string"><span class="meta">... </span>    &lt;/ul&gt;</span></span><br><span class="line"><span class="string"><span class="meta">... </span>&lt;/div&gt;</span></span><br><span class="line"><span class="string"><span class="meta">... </span>&quot;&quot;&quot;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sel = Selector(text=doc, <span class="built_in">type</span>=<span class="string">&quot;html&quot;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sel.xpath(<span class="string">&#x27;//li//@href&#x27;</span>).extract()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> python </category>
          
          <category> scrapy </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>yum</title>
      <link href="/posts/c52a1a9b.html"/>
      <url>/posts/c52a1a9b.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>ä¸€ã€yumé‡è£…<br>yumä¾èµ–pythonï¼Œåˆ é™¤è‡ªå¸¦çš„pythonåå¯¼è‡´yumæ— æ³•æ­£å¸¸ä½¿ç”¨</p><p>1.åˆ é™¤åŸæœ‰yum</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -aq|grep yum|xargs rpm -e --nodeps</span><br></pre></td></tr></table></figure><p>2.ä¸‹è½½pythonå’Œyumç¨‹åºåŒ…ä»¥åŠä¾èµ–åŒ…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># url:http://mirrors.163.com/centos/7.5.1804/os/x86_64/Packages/</span></span><br><span class="line">wget http://mirrors.163.com/centos/7.5.1804/os/x86_64/Packages/lvm2-python-libs-2.02.177-4.el7.x86_64.rpm</span><br><span class="line">wget http://mirrors.163.com/centos/7.5.1804/os/x86_64/Packages/libxml2-python-2.9.1-6.el7_2.3.x86_64.rpm</span><br><span class="line">wget http://mirrors.163.com/centos/7.5.1804/os/x86_64/Packages/python-libs-2.7.5-68.el7.x86_64.rpm</span><br><span class="line">wget http://mirrors.163.com/centos/7.5.1804/os/x86_64/Packages/python-ipaddress-1.0.16-2.el7.noarch.rpm</span><br><span class="line">wget http://mirrors.163.com/centos/7.5.1804/os/x86_64/Packages/python-backports-1.0-8.el7.x86_64.rpm</span><br><span class="line">wget http://mirrors.163.com/centos/7.5.1804/os/x86_64/Packages/python-backports-ssl_match_hostname-3.5.0.1-1.el7.noarch.rpm</span><br><span class="line">wget http://mirrors.163.com/centos/7.5.1804/os/x86_64/Packages/python-2.7.5-68.el7.x86_64.rpm</span><br><span class="line">wget http://mirrors.163.com/centos/7.5.1804/os/x86_64/Packages/python-iniparse-0.4-9.el7.noarch.rpm</span><br><span class="line">wget http://mirrors.163.com/centos/7.5.1804/os/x86_64/Packages/python-pycurl-7.19.0-19.el7.x86_64.rpm</span><br><span class="line">wget http://mirrors.163.com/centos/7.5.1804/os/x86_64/Packages/python-urlgrabber-3.10-8.el7.noarch.rpm</span><br><span class="line">wget http://mirrors.163.com/centos/7.5.1804/os/x86_64/Packages/python-setuptools-0.9.8-7.el7.noarch.rpm</span><br><span class="line">wget http://mirrors.163.com/centos/7.5.1804/os/x86_64/Packages/python-kitchen-1.1.1-5.el7.noarch.rpm</span><br><span class="line">wget http://mirrors.163.com/centos/7.5.1804/os/x86_64/Packages/python-chardet-2.2.1-1.el7_1.noarch.rpm</span><br><span class="line">wget http://mirrors.163.com/centos/7.5.1804/os/x86_64/Packages/rpm-python-4.11.3-32.el7.x86_64.rpm</span><br><span class="line">wget http://mirrors.163.com/centos/7.5.1804/os/x86_64/Packages/yum-utils-1.1.31-45.el7.noarch.rpm</span><br><span class="line">wget http://mirrors.163.com/centos/7.5.1804/os/x86_64/Packages/yum-3.4.3-158.el7.centos.noarch.rpm</span><br><span class="line">wget http://mirrors.163.com/centos/7.5.1804/os/x86_64/Packages/yum-metadata-parser-1.1.4-10.el7.x86_64.rpm</span><br><span class="line">wget http://mirrors.163.com/centos/7.5.1804/os/x86_64/Packages/yum-plugin-aliases-1.1.31-45.el7.noarch.rpm</span><br><span class="line">wget http://mirrors.163.com/centos/7.5.1804/os/x86_64/Packages/yum-plugin-protectbase-1.1.31-45.el7.noarch.rpm</span><br><span class="line">wget http://mirrors.163.com/centos/7.5.1804/os/x86_64/Packages/yum-plugin-fastestmirror-1.1.31-45.el7.noarch.rpm</span><br></pre></td></tr></table></figure><p>3.ä¾æ¬¡æ‰§è¡Œå®‰è£…å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rpm -Uvh --replacepkgs lvm2-python-libs*.rpm</span><br><span class="line">rpm -Uvh --replacepkgs libxml2-python*.rpm</span><br><span class="line">rpm -Uvh --replacepkgs python*.rpm</span><br><span class="line">rpm -Uvh --replacepkgs rpm-python*.rpm yum*.rpm</span><br></pre></td></tr></table></figure><p>4.æµ‹è¯•pythonå’Œyum</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python</span><br><span class="line">yum</span><br></pre></td></tr></table></figure><p>äºŒã€ä¿®æ”¹yumæº<br>1.è¿›å…¥yumæºç›®å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /etc/yum.repos.d</span><br></pre></td></tr></table></figure><p>2.ä¸‹è½½repoæ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget http://mirrors.163.com/.help/CentOS7-Base-163.repo</span><br><span class="line"><span class="comment">#wget http://mirrors.aliyun.com/repo/Centos-7.repo</span></span><br></pre></td></tr></table></figure><p>3.å¤‡ä»½repoæº</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> Cents-Bash.repo Cents-Base.repo.bak</span><br></pre></td></tr></table></figure><p>4.ä¿®æ”¹ä¸‹è½½çš„repoçš„$releaseverä¸ºlinuxç‰ˆæœ¬å·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cat /etc/redhat-release æŸ¥çœ‹ç‰ˆæœ¬å·</span></span><br><span class="line">vim CentOS7-Base-163.repo</span><br><span class="line"><span class="comment"># 1,$ s/$releasever/7/</span></span><br></pre></td></tr></table></figure><p>5.æ¸…é™¤ç¼“å­˜</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum clean all</span><br></pre></td></tr></table></figure><p>6.ç”Ÿæˆç¼“å­˜</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum makecache</span><br></pre></td></tr></table></figure><p>6.1<br>yumå®‰è£…æ—¶å‡ºç°ï¼šCannot retrieve metalink for repository: epel. Please verify its path and try again<br>æ‰“å¼€&#x2F;etc&#x2F;yum.repos.d&#x2F;epel.repoï¼Œå°†</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[epel]</span></span><br><span class="line"><span class="attr">name</span>=Extra Packages for Enterprise Linux <span class="number">6</span> - <span class="variable">$basearch</span></span><br><span class="line"><span class="comment">#baseurl=http://download.fedoraproject.org/pub/epel/6/$basearch</span></span><br><span class="line"><span class="attr">mirrorlist</span>=https://mirrors.fedoraproject.org/metalink?repo=epel-<span class="number">6</span>&amp;arch=<span class="variable">$basearch</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ä¸º</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[epel]</span></span><br><span class="line"><span class="attr">name</span>=Extra Packages for Enterprise Linux <span class="number">6</span> - <span class="variable">$basearch</span></span><br><span class="line"><span class="attr">baseurl</span>=http://download.fedoraproject.org/pub/epel/<span class="number">6</span>/<span class="variable">$basearch</span></span><br><span class="line"><span class="comment">#mirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-6&amp;arch=$basearch</span></span><br></pre></td></tr></table></figure><p>å†æ¸…ç†æºï¼Œé‡æ–°å®‰è£…<br>å¦‚æœè¿˜æ˜¯ä¸è¡Œï¼Œä¿®æ”¹DNS,åˆ°&#x2F;etc&#x2F;resolv.confä¸‹æ·»åŠ ä¸€ä¸‹ï¼š</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nameserver</span> <span class="number">8.8.8.8</span></span><br><span class="line">search localdomain</span><br></pre></td></tr></table></figure><p>ç„¶åé‡å¯networkæœåŠ¡ï¼šservice network restart</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ yum clean all</span><br></pre></td></tr></table></figure><p>7.æ›´æ–°yumæ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum update</span><br></pre></td></tr></table></figure><p>8.æŸ¥çœ‹repoåˆ—è¡¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum repolist</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>è£…é¥°è€…æ¨¡å¼</title>
      <link href="/posts/a708a60d.html"/>
      <url>/posts/a708a60d.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by PhpStorm.</span></span><br><span class="line"><span class="comment"> * User: cat</span></span><br><span class="line"><span class="comment"> * Date: 18-11-20</span></span><br><span class="line"><span class="comment"> * Time: ä¸‹åˆ2:29</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Beverage</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$_name</span>;</span><br><span class="line">    <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Cost</span>(<span class="params"></span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¢«è£…é¥°è€…ç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Coffee</span> <span class="keyword">extends</span> <span class="title">Beverage</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;_name = <span class="string">&#x27;Coffee&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Cost</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1.00</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä»¥ä¸‹ä¸‰ä¸ªç±»æ˜¯è£…é¥°è€…ç›¸å…³ç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CondimentDecorator</span> <span class="keyword">extends</span> <span class="title">Beverage</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;_name = <span class="string">&#x27;Condiment&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Cost</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0.1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Milk</span> <span class="keyword">extends</span> <span class="title">CondimentDecorator</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$_beverage</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$beverage</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;_name = <span class="string">&#x27;Milk&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$beverage</span> <span class="keyword">instanceof</span> Beverage)&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;_beverage = <span class="variable">$beverage</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">            <span class="keyword">exit</span>(<span class="string">&#x27;Failure&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Cost</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;_beverage-&gt;<span class="title function_ invoke__">Cost</span>() + <span class="number">0.2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sugar</span> <span class="keyword">extends</span> <span class="title">CondimentDecorator</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$_beverage</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$beverage</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;_name = <span class="string">&#x27;Sugar&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$beverage</span> <span class="keyword">instanceof</span> Beverage)&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;_beverage = <span class="variable">$beverage</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">exit</span>(<span class="string">&#x27;Failure&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Cost</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;_beverage-&gt;<span class="title function_ invoke__">Cost</span>() + <span class="number">0.2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Test Case</span></span><br><span class="line"><span class="comment">//1.æ‹¿æ¯å’–å•¡</span></span><br><span class="line"><span class="variable">$coffee</span> = <span class="keyword">new</span> <span class="title class_">Coffee</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.åŠ ç‚¹ç‰›å¥¶</span></span><br><span class="line"><span class="variable">$coffee</span> = <span class="keyword">new</span> <span class="title class_">Milk</span>(<span class="variable">$coffee</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.åŠ ç‚¹ç³–</span></span><br><span class="line"><span class="variable">$coffee</span> = <span class="keyword">new</span> <span class="title class_">Sugar</span>(<span class="variable">$coffee</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">printf</span>(<span class="string">&quot;Coffee Total:%0.2få…ƒ\n&quot;</span>,<span class="variable">$coffee</span>-&gt;<span class="title function_ invoke__">Cost</span>());</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexoå®‰è£…</title>
      <link href="/posts/93c315da.html"/>
      <url>/posts/93c315da.html</url>
      
        <content type="html"><![CDATA[<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">1.åœ¨å®‰è£…nodeJså‰æä¸‹å®‰è£…hexo</span><br><span class="line">npm install -g hexo-cli</span><br><span class="line"></span><br><span class="line">2.å»ºç«‹hexoè½¯è¿æ¥</span><br><span class="line"><span class="built_in">ln</span> -s /usr/local/webserver/nodeJs/bin/hexo /usr/local/bin/</span><br><span class="line"></span><br><span class="line">3.åˆå§‹åŒ–</span><br><span class="line">hexo init folder</span><br><span class="line"><span class="built_in">cd</span> folder</span><br><span class="line">npm install</span><br><span class="line"><span class="comment"># å·²å­˜åœ¨hexoé¡¹ç›®æ—¶</span></span><br><span class="line">npm install hexo --save</span><br><span class="line"></span><br><span class="line">4.å®‰è£…hexo-server</span><br><span class="line">npm install hexo-server --save</span><br><span class="line"></span><br><span class="line">5.ç”Ÿæˆæ–‡ä»¶</span><br><span class="line">hexo g -d</span><br><span class="line"></span><br><span class="line">6.è¿è¡Œ</span><br><span class="line"><span class="comment"># æ— éœ€æ‰§è¡Œhexo g -d</span></span><br><span class="line">hexo server</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰è£…æ–‡æ¡£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nodeJså®‰è£…</title>
      <link href="/posts/7479241f.html"/>
      <url>/posts/7479241f.html</url>
      
        <content type="html"><![CDATA[<p>1.ä¸‹è½½</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ wget https://nodejs.org/dist/v10.<span class="number">13.0</span>/<span class="keyword">node</span><span class="title">-v10</span>.<span class="number">13.0</span>-linux-x64.tar.xz</span><br><span class="line">$ tar xvf <span class="keyword">node</span><span class="title">-v10</span>.<span class="number">13.0</span>-linux-x64.tar.xz</span><br></pre></td></tr></table></figure><p>2.å»ºç«‹è½¯è¿æ¥</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ln -s <span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>nodeJs<span class="regexp">/bin/</span>npm <span class="regexp">/usr/</span>local<span class="regexp">/bin/</span></span><br><span class="line">$ ln -s <span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>nodeJs<span class="regexp">/bin/</span>node <span class="regexp">/usr/</span>local<span class="regexp">/bin/</span></span><br></pre></td></tr></table></figure><p>3.æ£€æµ‹å®‰è£…</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="keyword">node</span> <span class="title">-v</span></span><br></pre></td></tr></table></figure><p>4.ä¿®æ”¹æº</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir ~/.pip</span><br><span class="line"></span><br><span class="line">$ vim ~/.pip.conf</span><br><span class="line"># åœ¨.pipç›®å½•åˆ›å»ºå¹¶ç¼–è¾‘pip.conf</span><br><span class="line"># pipå®‰è£…éœ€è¦ä½¿ç”¨çš„httpsåŠ å¯†ï¼Œæ‰€ä»¥åœ¨æ­¤éœ€è¦æ·»åŠ <span class="keyword">trusted</span>-host </span><br><span class="line">[<span class="keyword">global</span>]</span><br><span class="line"><span class="keyword">trusted</span>-host = pypi.tuna.tsinghua.edu.cn</span><br><span class="line"><span class="keyword">index</span>-url = https://pypi.tuna.tsinghua.edu.cn/simple/</span><br></pre></td></tr></table></figure><p>5.é—®é¢˜å¤„ç†<br>5.1. syscall symlinké”™è¯¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm ERR! code EPROTO</span><br><span class="line">npm ERR! errno -71</span><br><span class="line">npm ERR! syscall symlink</span><br><span class="line"></span><br><span class="line">npm ERR! EPROTO: protocol error, symlink</span><br></pre></td></tr></table></figure><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">npm</span>é»˜è®¤ä¼šä½¿ç”¨symbolic linksæ¥å®‰è£…ç»„ä»¶ï¼Œä¹Ÿå³æˆ‘ä»¬åœ¨linuxç³»ç»Ÿé‡Œç»å¸¸ç”¨çš„è½¯é“¾æ¥ï¼ˆln -sï¼‰æˆ–ç¡¬é“¾æ¥(ln)ï¼Œä½†æ˜¯æœ‰äº›æ–‡ä»¶ç³»ç»Ÿä¸æ”¯æŒæ–‡ä»¶é“¾æ¥ï¼Œ  </span><br><span class="line">æ¯”å¦‚Windowsï¼ˆæˆ–è€…è¯´å‡ºäºå®‰å…¨åŸå› ç¦ç”¨äº†ï¼‰ï¼Œæœ‰æ—¶å€™linuxç³»ç»Ÿè¿è¡Œåœ¨æœ‰windowsåˆ†åŒºçš„ç¡¬ç›˜ä¸Šä¹Ÿä¸æ”¯æŒé“¾æ¥ï¼Œæ¯”å¦‚virtualboxåœ¨windowsä¸»æœºä¸Šé»˜è®¤ç¦æ­¢åœ¨å…±äº«æ–‡ä»¶å¤¹é‡Œä½¿ç”¨symbolic links,å½“ç„¶ä¹Ÿæ˜¯å‡ºäºå®‰å…¨è€ƒè™‘ã€‚  </span><br><span class="line">é‚£ä¹ˆ<span class="built_in">npm</span> installé»˜è®¤éœ€è¦ä½¿ç”¨symbolic linkï¼Œè€Œä¸”è¿™ä¹Ÿæœ¬èº«ä¹Ÿæ˜¯<span class="built_in">npm</span>æ¯”è¾ƒé‡è¦çš„ä¸€ä¸ªç‰¹æ€§ï¼Œä½†å¦‚æœæˆ‘ä»¬çš„ç³»ç»Ÿä¸æ”¯æŒè¿™ä¸€å±æ€§çš„è¯ï¼Œå°±ä¼šæŠ¥ä¸Šé¢çš„é”™è¯¯äº†ã€‚  </span><br><span class="line">è§£å†³åŠæ³•ï¼Œå°±æ˜¯åœ¨<span class="built_in">npm</span> installçš„æ—¶å€™åŠ ä¸Šä¸€ä¸ªå‚æ•°ï¼Œå°±æ˜¯--<span class="literal">no</span>-bin-linksï¼Œä¹Ÿå³<span class="built_in">npm</span> install --<span class="literal">no</span>-bin-links:  </span><br><span class="line">ä¹Ÿå³æ˜¯è¯´ï¼Œä¸ºäº†é˜²æ­¢syscall symlinké”™è¯¯ï¼Œå¦‚æœä½ æ˜¯åœ¨windowsä½¿ç”¨<span class="built_in">npm</span>ï¼Œæˆ–è€…å³ä½¿åœ¨homesteadé‡Œï¼Œä½†ä¸»æœºæ˜¯windowsï¼Œé‚£ä¹ˆæ¯æ¬¡ä½ æ‰§è¡Œ<span class="built_in">npm</span>å®‰è£…æˆ–æ›´æ–°ç»„ä»¶ç›¸å…³çš„å‘½ä»¤æ—¶ï¼Œéƒ½è¦åœ¨åé¢åŠ ä¸Š--<span class="literal">no</span>-bin-linksï¼Œ  </span><br><span class="line">æ¯”å¦‚ä½ è¦<span class="built_in">npm</span> update --<span class="literal">no</span>-bin-links,ä½ ä¹Ÿè¦<span class="built_in">npm</span> rebuild node-sass -<span class="literal">no</span>-bin-links,ç¡®å®æŒºéº»çƒ¦çš„  </span><br><span class="line">å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥æ•´ä½“è®¾ç½®ä¸€ä¸‹<span class="built_in">npm</span>ï¼Œè®©å®ƒé»˜è®¤ä¸å†ä½¿ç”¨æ–‡ä»¶é“¾æ¥åŠŸèƒ½äº†ï¼Œæ‰§è¡Œï¼š  </span><br><span class="line">$ <span class="built_in">npm</span> config set bin-links <span class="literal">false</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
          <category> js </category>
          
          <category> nodeJs </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰è£…æ–‡æ¡£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpå®‰è£…æ‰©å±•</title>
      <link href="/posts/5cca63ee.html"/>
      <url>/posts/5cca63ee.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="å®‰è£…redisæ‰©å±•åŒ…"><a href="#å®‰è£…redisæ‰©å±•åŒ…" class="headerlink" title="å®‰è£…redisæ‰©å±•åŒ…"></a>å®‰è£…redisæ‰©å±•åŒ…</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">unzip phpredis-develop.zip</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆæ‰©å±•é…ç½®</span></span><br><span class="line">cd phpredis-develop</span><br><span class="line"><span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>php7<span class="regexp">/bin/</span>phpize</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼–è¯‘Redis</span></span><br><span class="line">.<span class="regexp">/configure --with-php-config=/u</span>sr<span class="regexp">/local/</span>webserver<span class="regexp">/php7/</span>bin/php-config</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><h1 id="å®‰è£…zipæ‰©å±•"><a href="#å®‰è£…zipæ‰©å±•" class="headerlink" title="å®‰è£…zipæ‰©å±•"></a>å®‰è£…zipæ‰©å±•</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸‹è½½</span></span><br><span class="line">wget http:<span class="regexp">//</span>pecl.php.net<span class="regexp">/get/</span>zip</span><br><span class="line">tar xzvf zip</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆæ‰©å±•é…ç½®</span></span><br><span class="line">cd zip</span><br><span class="line"><span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>php7<span class="regexp">/bin/</span>phpize</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼–è¯‘</span></span><br><span class="line">.<span class="regexp">/configure --with-php-config=/u</span>sr<span class="regexp">/local/</span>webserver<span class="regexp">/php/</span>bin/php-config</span><br><span class="line"></span><br><span class="line"><span class="comment"># é”™è¯¯ä¿¡æ¯ï¼š</span></span><br><span class="line">libzip not foundï¼š</span><br><span class="line"><span class="comment"># é‡æ–°å®‰è£…libzip</span></span><br><span class="line">yum remove libzip -y</span><br><span class="line">wget https:<span class="regexp">//</span>nih.at<span class="regexp">/libzip/</span>libzip-<span class="number">1.2</span>.<span class="number">0</span>.tar.gz</span><br><span class="line">tar -zxvf libzip-<span class="number">1.2</span>.<span class="number">0</span>.tar.gz</span><br><span class="line">cd libzip-<span class="number">1.2</span>.<span class="number">0</span></span><br><span class="line">./configure</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line"><span class="comment"># zipconf.h not found</span></span><br><span class="line">find <span class="regexp">/usr/</span>local -iname <span class="string">&#x27;zipconf.h&#x27;</span></span><br><span class="line">ln -s <span class="regexp">/usr/</span>local<span class="regexp">/lib/</span>libzip<span class="regexp">/include/</span>zipconf.h <span class="regexp">/usr/</span>local/include </span><br></pre></td></tr></table></figure><h1 id="curlå®‰è£…"><a href="#curlå®‰è£…" class="headerlink" title="curlå®‰è£…"></a>curlå®‰è£…</h1><p>å¦‚æœç¼–è¯‘å®‰è£…æ—¶ï¼Œå·²æœ‰â€“with-curlï¼Œéœ€è¦é‡æ–°ç¼–è¯‘ï¼Œæ— æ³•åœ¨php.iniä¸­è¦†ç›–</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cd</span> phpæºç ç›®å½•ä¸‹/ext/curl/</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">phpize</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">--with-curlä¸ºå®‰è£…curlçš„ç›®å½•,å¦‚æœç›´æ¥ä½¿ç”¨å½“å‰æœåŠ¡å™¨çš„ç‰ˆæœ¬ï¼Œåˆ™æ— éœ€æŒ‡å®šç›®å½•</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å­˜åœ¨éœ€è¦php curlç‰ˆæœ¬å’ŒæœåŠ¡å™¨ç‰ˆæœ¬ä¸åŒæ—¶ï¼Œå¿…é¡»æŒ‡å®šç›®å½•</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./configure --with-php-config=/usr/local/webserver/php/bin/php-config --with-curl=/usr/local/webserver/curl-7.29.0/</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">make &amp;&amp; make install</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰è£…æ–‡æ¡£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>rediså¸¸ç”¨å‘½ä»¤</title>
      <link href="/posts/c3982ec0.html"/>
      <url>/posts/c3982ec0.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"><span class="comment"># redis keys è·å–å ç”¨å†…å­˜åå†™å…¥æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">filePath = <span class="string">&#x27;./&#x27;</span></span><br><span class="line">execCommand = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># ç›´æ¥è¯»å–æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;%sredisKeys.log&#x27;</span> % filePath, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    fileInfo = f.read()</span><br><span class="line"><span class="comment"># é€šè¿‡å‘½ä»¤è¡Œè·å–</span></span><br><span class="line"><span class="comment"># fileInfo = os.popen(&quot;%sredis-cli keys &#x27;*&#x27;&quot; % execCommand).read()</span></span><br><span class="line"></span><br><span class="line">keysInfoDict = &#123;&#125;</span><br><span class="line">subReg = re.<span class="built_in">compile</span>(<span class="string">r&#x27;\s*\d+\)\s*&#x27;</span>)</span><br><span class="line">redisKeysReg = re.<span class="built_in">compile</span>(<span class="string">r&#x27;[0-9a-zA-Z:-_]+&#x27;</span>)</span><br><span class="line">memoryReg = re.<span class="built_in">compile</span>(<span class="string">r&#x27;\d+&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> redisKey <span class="keyword">in</span> fileInfo.split(<span class="string">&#x27;\n&#x27;</span>):</span><br><span class="line">    redisKey = re.sub(subReg, <span class="string">&#x27;&#x27;</span>, redisKey)</span><br><span class="line">    redisKeyRes = re.search(redisKeysReg, redisKey)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> redisKeyRes:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    redisKey = redisKeyRes.group()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¿”å›å­—èŠ‚</span></span><br><span class="line">    memoryUsageStr = os.popen(<span class="string">&quot;%sredis-cli memory usage %s&quot;</span> % (execCommand, redisKey)).read()</span><br><span class="line">    memoryUsageRes = re.search(memoryReg, memoryUsageStr)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> memoryUsageRes:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    memoryUsage = memoryUsageRes.group()</span><br><span class="line">    <span class="built_in">print</span>(redisKey, memoryUsage)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> memoryUsage:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        memoryUsage = <span class="built_in">int</span>(memoryUsage)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    infoStr = <span class="string">&quot;%s %smb:%skb:%sb\n&quot;</span> % (redisKey, <span class="built_in">int</span>(memoryUsage / <span class="number">1024</span> / <span class="number">1024</span>), <span class="built_in">int</span>(memoryUsage / <span class="number">1024</span>), memoryUsage)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;%sredisKeysMemory.log&#x27;</span> % filePath, <span class="string">&#x27;a+&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(infoStr)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¸¸ç”¨å‘½ä»¤ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>rediså¸¸ç”¨å‘½ä»¤</title>
      <link href="/posts/c3982ec0.html"/>
      <url>/posts/c3982ec0.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h2 id="MONITOR"><a href="#MONITOR" class="headerlink" title="MONITOR"></a>MONITOR</h2><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MONITOR æ˜¯ä¸€ä¸ªè°ƒè¯•å‘½ä»¤ï¼Œè¿”å›æœåŠ¡å™¨å¤„ç†çš„æ¯ä¸€ä¸ªå‘½ä»¤ï¼Œå®ƒèƒ½å¸®åŠ©æˆ‘ä»¬äº†è§£åœ¨æ•°æ®åº“ä¸Šå‘ç”Ÿäº†ä»€ä¹ˆæ“ä½œï¼Œ</span><br><span class="line">å¯ä»¥é€šè¿‡redis-cliå’Œtelnetå‘½ä»¤ä½¿ç”¨.</span><br><span class="line">$ redis-cli<span class="built_in"> monitor</span></span><br><span class="line"><span class="built_in"></span>$ telnet localhost 6379</span><br></pre></td></tr></table></figure><h2 id="redisé›†ç¾¤ä¸‹åˆ é™¤keys"><a href="#redisé›†ç¾¤ä¸‹åˆ é™¤keys" class="headerlink" title="redisé›†ç¾¤ä¸‹åˆ é™¤keys"></a>redisé›†ç¾¤ä¸‹åˆ é™¤keys</h2><p>1.å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./redis-cli -c -h 192.168.1.213 -p 7000 keys <span class="string">&#x27;sell:*&#x27;</span> | xargs -i ./redis-cli -c -h 192.168.1.213 -p 7000 del &#123;&#125;</span><br></pre></td></tr></table></figure><p>2.è„šæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#redisé›†ç¾¤åˆ é™¤redis keys</span></span><br><span class="line">REDIS_SERVER=192.168.1.213</span><br><span class="line">PORT1=7000</span><br><span class="line">PORT2=7001</span><br><span class="line">PORT3=7002</span><br><span class="line"></span><br><span class="line">REDIS_COMMAND=/usr/local/webserver/redis/bin/redis-cli</span><br><span class="line"><span class="keyword">if</span> [ -z <span class="string">&quot;<span class="variable">$1</span>&quot;</span> ];<span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;empty param&quot;</span></span><br><span class="line">    <span class="built_in">exit</span> 0</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$REDIS_COMMAND</span> -c -h <span class="variable">$REDIS_SERVER</span> -p <span class="variable">$PORT1</span> keys <span class="variable">$1</span> | xargs -i <span class="variable">$REDIS_COMMAND</span> -h <span class="variable">$REDIS_SERVER</span> -p <span class="variable">$PORT1</span> del &#123;&#125; &gt;/dev/null 2&gt;1&amp;</span><br><span class="line"><span class="variable">$REDIS_COMMAND</span> -c -h <span class="variable">$REDIS_SERVER</span> -p <span class="variable">$PORT2</span> keys <span class="variable">$1</span> | xargs -i <span class="variable">$REDIS_COMMAND</span> -h <span class="variable">$REDIS_SERVER</span> -p <span class="variable">$PORT2</span> del &#123;&#125; &gt;/dev/null 2&gt;1&amp;</span><br><span class="line"><span class="variable">$REDIS_COMMAND</span> -c -h <span class="variable">$REDIS_SERVER</span> -p <span class="variable">$PORT3</span> keys <span class="variable">$1</span> | xargs -i <span class="variable">$REDIS_COMMAND</span> -h <span class="variable">$REDIS_SERVER</span> -p <span class="variable">$PORT3</span> del &#123;&#125; &gt;/dev/null 2&gt;1&amp;</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;del ok&#x27;</span></span><br></pre></td></tr></table></figure><h1 id="windowsä¸­å°†redisæ·»åŠ ä¸ºæœåŠ¡"><a href="#windowsä¸­å°†redisæ·»åŠ ä¸ºæœåŠ¡" class="headerlink" title="windowsä¸­å°†redisæ·»åŠ ä¸ºæœåŠ¡"></a>windowsä¸­å°†redisæ·»åŠ ä¸ºæœåŠ¡</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ redis-server --service-install conf\redis.windows-sell.conf --service-name serviceName --loglevel verbose</span><br><span class="line"><span class="comment"># å¼€å§‹æœåŠ¡</span></span><br><span class="line">$ redis-server --service-start --service-name redis6371</span><br><span class="line"><span class="comment"># åœæ­¢æœåŠ¡</span></span><br><span class="line">redis-server --service-stop --service-name redis6371</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœæ­¢æœåŠ¡</span></span><br><span class="line">$ Net Stop serviceName</span><br><span class="line"><span class="comment"># åˆ é™¤æœåŠ¡</span></span><br><span class="line">$ sc delete serviceName</span><br></pre></td></tr></table></figure><h1 id="æŸ¥è¯¢å†…å­˜å ç”¨"><a href="#æŸ¥è¯¢å†…å­˜å ç”¨" class="headerlink" title="æŸ¥è¯¢å†…å­˜å ç”¨"></a>æŸ¥è¯¢å†…å­˜å ç”¨</h1><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># memory usage key [SAMPLES count]</span></span><br><span class="line"><span class="comment"># èµ·å§‹ç‰ˆæœ¬ï¼š4.0.0</span></span><br><span class="line"><span class="comment"># æ—¶é—´å¤æ‚åº¦ï¼šO(N) where N is the number of samples.</span></span><br><span class="line"><span class="comment"># å‘½ä»¤MEMORY USAGE ç»™å‡ºä¸€ä¸ªkeyå’Œå®ƒå€¼åœ¨RAMä¸­å ç”¨çš„å­—èŠ‚æ•°</span></span><br><span class="line"><span class="comment"># è¿”å›çš„ç»“æœæ˜¯keyçš„å€¼ä»¥åŠä¸ºç®¡ç†è¯¥keyåˆ†é…çš„å†…å­˜æ€»å­—èŠ‚æ•°</span></span><br><span class="line"><span class="comment"># å¯¹äºåµŒå¥—æ•°æ®ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨é€‰é¡¹SAMPLESï¼Œå…¶ä¸­COUNTè¡¨ç¤ºæŠ½æ ·çš„å…ƒç´ ä¸ªæ•°ï¼Œé»˜è®¤å€¼ä¸º5ã€‚å½“éœ€è¦æŠ½æ ·æ‰€æœ‰å…ƒç´ æ—¶ï¼Œä½¿ç”¨SAMPLES 0</span></span><br><span class="line"><span class="variable">$ </span>redis-cli memory usage key</span><br><span class="line"><span class="comment"># å¯¹äºåµŒå¥—ç±»å‹</span></span><br><span class="line"><span class="variable">$ </span>redis-cli memory usage key samples <span class="number">0</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¸¸ç”¨å‘½ä»¤ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>UA</title>
      <link href="/posts/87cecae8.html"/>
      <url>/posts/87cecae8.html</url>
      
        <content type="html"><![CDATA[<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># IOS-QQBrowser</span></span><br><span class="line"><span class="attribute">5</span>.<span class="number">0</span>(iPhone; CPU iPhone OS <span class="number">12</span>_0 like MAC OS X) AppleWebKit/<span class="number">605</span>.<span class="number">1</span>.<span class="number">15</span>(KHTML, like Gecko) Version/<span class="number">12</span>.<span class="number">0</span> MQQBrowser/<span class="number">8</span>.<span class="number">9</span>.<span class="number">1</span> Mobile/<span class="number">15</span>E148 Safari/<span class="number">604</span>.<span class="number">1</span> MttCustomUA/<span class="number">2</span> QBWebViewType/<span class="number">1</span> WKType/<span class="number">1</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
          <category> UA </category>
          
      </categories>
      
      
        <tags>
            
            <tag> UA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯è®°å½•</title>
      <link href="/posts/fa72dcb4.html"/>
      <url>/posts/fa72dcb4.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="htmlç©ºé“¾æ¥å¯¼è‡´é¡µé¢äºŒæ¬¡åŠ è½½"><a href="#htmlç©ºé“¾æ¥å¯¼è‡´é¡µé¢äºŒæ¬¡åŠ è½½" class="headerlink" title="htmlç©ºé“¾æ¥å¯¼è‡´é¡µé¢äºŒæ¬¡åŠ è½½"></a>htmlç©ºé“¾æ¥å¯¼è‡´é¡µé¢äºŒæ¬¡åŠ è½½</h1><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">é¿å…ç©ºé“¾æ¥å±æ€§ç©ºçš„é“¾æ¥å±æ€§æ˜¯æŒ‡<span class="selector-tag">img</span>ã€linkã€scriptã€ifrrameå…ƒç´ çš„<span class="attribute">src</span>æˆ–hrefå±æ€§è¢«è®¾ç½®äº†ï¼Œ</span><br><span class="line">ä½†æ˜¯å±æ€§å´ä¸ºç©ºã€‚å¦‚ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå›¾ç‰‡ï¼Œå¹¶ä¸”æš‚æ—¶è®¾ç½®å›¾ç‰‡çš„åœ°å€ä¸ºç©ºï¼Œå¸Œæœ›åœ¨æœªæ¥åŠ¨æ€çš„å»ä¿®æ”¹å®ƒã€‚</span><br><span class="line">ä½†æ˜¯å³ä½¿å›¾ç‰‡çš„åœ°å€ä¸ºç©ºï¼Œæµè§ˆå™¨ä¾æ—§ä¼šä»¥é»˜è®¤çš„è§„åˆ™å»è¯·æ±‚ç©ºåœ°å€ï¼š </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>APIæ¥å£</title>
      <link href="/posts/43c6bb40.html"/>
      <url>/posts/43c6bb40.html</url>
      
        <content type="html"><![CDATA[<h1 id="è·å–ç»çº¬åº¦"><a href="#è·å–ç»çº¬åº¦" class="headerlink" title="è·å–ç»çº¬åº¦"></a>è·å–ç»çº¬åº¦</h1><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://api.map.baidu.com/geocoder?address=åœ°å€<span class="variable">&amp;output</span>=json<span class="variable">&amp;key</span>=<span class="variable">&amp;city</span>=åŸå¸‚</span><br></pre></td></tr></table></figure><h1 id="æ”¯æŒhttps"><a href="#æ”¯æŒhttps" class="headerlink" title="æ”¯æŒhttps"></a>æ”¯æŒhttps</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">è¯¦è§ </span><br><span class="line">http:<span class="regexp">//</span>lbsyun.baidu.com<span class="regexp">/index.php?title=jspopular/gui</span>de/introduction<span class="comment">#Https_.E8.AF.B4.E6.98.8E </span></span><br><span class="line">æ‘˜å½•å¦‚ä¸‹ï¼š </span><br><span class="line">æ³¨æ„ï¼šä»… JavaScript API V2.<span class="number">0</span> ç‰ˆæœ¬æ”¯æŒ https ï¼Œå…¶ä»– JavaScript API ç‰ˆæœ¬å‡ä¸æ”¯æŒã€‚ä½¿ç”¨ https æœåŠ¡ï¼Œè¯·å…ˆæ£€æŸ¥æ‚¨çš„ç‰ˆæœ¬ã€‚ </span><br><span class="line">é…ç½® </span><br><span class="line"><span class="number">1</span>. å¦‚æœä½¿ç”¨ JavaScript API ï¼Œéœ€è¦åŠ ä¸€ä¸ªç‰¹æ®Šå­—æ®µ (s=<span class="number">1</span>)ï¼š </span><br><span class="line">https:<span class="regexp">//</span>api.map.baidu.com/api?v=<span class="number">2.0</span>&amp;ak=ä½ çš„å¯†é’¥&amp;s=<span class="number">1</span> ï¼›</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> API </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>gitå¸¸ç”¨å‘½ä»¤</title>
      <link href="/posts/423abe9e.html"/>
      <url>/posts/423abe9e.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>@link <a href="https://www.php.cn/manual/view/34971.html">https://www.php.cn/manual/view/34971.html</a></p><p>ä¸€èˆ¬æ¥è¯´ï¼Œæ—¥å¸¸ä½¿ç”¨åªè¦è®°ä½ä¸‹å›¾6ä¸ªå‘½ä»¤ï¼Œå°±å¯ä»¥äº†ã€‚ä½†æ˜¯ç†Ÿç»ƒä½¿ç”¨ï¼Œææ€•è¦è®°ä½60ï½100ä¸ªå‘½ä»¤ã€‚<br>ä¸‹é¢å¸¸ç”¨ Git å‘½ä»¤æ¸…å•ã€‚å‡ ä¸ªä¸“ç”¨åè¯çš„è¯‘åå¦‚ä¸‹ã€‚</p><p>Workspaceï¼šå·¥ä½œåŒº<br>Index &#x2F; Stageï¼šæš‚å­˜åŒº<br>Repositoryï¼šä»“åº“åŒºï¼ˆæˆ–æœ¬åœ°ä»“åº“ï¼‰<br>Remoteï¼šè¿œç¨‹ä»“åº“</p><h1 id="ä¸€ã€æ–°å»ºä»£ç åº“"><a href="#ä¸€ã€æ–°å»ºä»£ç åº“" class="headerlink" title="ä¸€ã€æ–°å»ºä»£ç åº“"></a>ä¸€ã€æ–°å»ºä»£ç åº“</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åœ¨å½“å‰ç›®å½•æ–°å»ºä¸€ä¸ªGitä»£ç åº“</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git init</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ–°å»ºä¸€ä¸ªç›®å½•ï¼Œå°†å…¶åˆå§‹åŒ–ä¸ºGitä»£ç åº“</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git init [project-name]</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸‹è½½ä¸€ä¸ªé¡¹ç›®å’Œå®ƒçš„æ•´ä¸ªä»£ç å†å²</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">clone</span> [url]</span></span><br></pre></td></tr></table></figure><h1 id="äºŒã€é…ç½®"><a href="#äºŒã€é…ç½®" class="headerlink" title="äºŒã€é…ç½®"></a>äºŒã€é…ç½®</h1><p>Gitçš„è®¾ç½®æ–‡ä»¶ä¸º.gitconfigï¼Œå®ƒå¯ä»¥åœ¨ç”¨æˆ·ä¸»ç›®å½•ä¸‹ï¼ˆå…¨å±€é…ç½®ï¼‰ï¼Œä¹Ÿå¯ä»¥åœ¨é¡¹ç›®ç›®å½•ä¸‹ï¼ˆé¡¹ç›®é…ç½®ï¼‰ã€‚</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">#</span> é…ç½®ç”¨æˆ·å’Œé‚®ç®±</span><br><span class="line"><span class="variable">git</span> <span class="variable">config</span> <span class="operator">--</span><span class="variable">global</span> <span class="variable">user</span><span class="operator">.</span><span class="variable">name</span> <span class="string">&quot;Your Name&quot;</span></span><br><span class="line"><span class="variable">git</span> <span class="variable">config</span> <span class="operator">--</span><span class="variable">global</span> <span class="variable">user</span><span class="operator">.</span><span class="variable">email</span> <span class="string">&quot;email@example.com&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="type">#</span> åˆ›å»º<span class="variable">SSH</span> <span class="built_in">Key</span></span><br><span class="line"><span class="variable">ssh</span><span class="operator">-</span><span class="variable">keygen</span> <span class="operator">-</span><span class="variable">t</span> <span class="variable">rsa</span> <span class="operator">-</span><span class="built_in">C</span> <span class="string">&quot;youremail@example.com&quot;</span></span><br><span class="line">å¦‚æœä¸€åˆ‡é¡ºåˆ©çš„è¯ï¼Œå¯ä»¥åœ¨ç”¨æˆ·ä¸»ç›®å½•é‡Œæ‰¾åˆ°<span class="operator">.</span><span class="variable">ssh</span>ç›®å½•ï¼Œé‡Œé¢æœ‰<span class="type">id_rsa</span>å’Œ<span class="type">id_rsa</span><span class="operator">.</span><span class="variable">pub</span>ä¸¤ä¸ªæ–‡ä»¶ï¼Œè¿™ä¸¤ä¸ªå°±æ˜¯<span class="variable">SSH</span> <span class="built_in">Key</span>çš„ç§˜é’¥å¯¹ï¼Œ<span class="type">id_rsa</span>æ˜¯ç§é’¥ï¼Œä¸èƒ½æ³„éœ²å‡ºå»ï¼Œ<span class="type">id_rsa</span><span class="operator">.</span><span class="variable">pub</span>æ˜¯å…¬é’¥ï¼Œå¯ä»¥æ”¾å¿ƒåœ°å‘Šè¯‰ä»»ä½•äººã€‚</span><br><span class="line">ç™»é™†<span class="variable">GitHub</span>ï¼Œæ‰“å¼€â€œ<span class="variable">Account</span> <span class="variable">settings</span>â€ï¼Œâ€œ<span class="variable">SSH</span> <span class="built_in">Keys</span>â€é¡µé¢ï¼š</span><br><span class="line">ç„¶åï¼Œç‚¹â€œ<span class="variable">Add</span> <span class="variable">SSH</span> <span class="built_in">Key</span>â€ï¼Œå¡«ä¸Šä»»æ„<span class="variable">Title</span>ï¼Œåœ¨<span class="built_in">Key</span>æ–‡æœ¬æ¡†é‡Œç²˜è´´<span class="type">id_rsa</span><span class="operator">.</span><span class="variable">pub</span>æ–‡ä»¶çš„å†…å®¹ï¼š</span><br></pre></td></tr></table></figure><h2 id="1-è®¾ç½®å’Œå–æ¶ˆä»£ç†"><a href="#1-è®¾ç½®å’Œå–æ¶ˆä»£ç†" class="headerlink" title="1. è®¾ç½®å’Œå–æ¶ˆä»£ç†"></a>1. è®¾ç½®å’Œå–æ¶ˆä»£ç†</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">è®¾ç½®httpä»£ç†</span><br><span class="line">git config <span class="attr">--global</span> http<span class="selector-class">.proxy</span> http:<span class="comment">//127.0.0.1:1080</span></span><br><span class="line">è®¾ç½®httpsä»£ç†</span><br><span class="line">git config <span class="attr">--global</span> https<span class="selector-class">.proxy</span> https:<span class="comment">//127.0.0.1:1080</span></span><br><span class="line">å–æ¶ˆä»£ç†</span><br><span class="line">git config <span class="attr">--global</span> <span class="attr">--unset</span> http<span class="selector-class">.proxy</span></span><br><span class="line">git config <span class="attr">--global</span> <span class="attr">--unset</span> https<span class="selector-class">.proxy</span></span><br><span class="line">è®¾ç½®socks5ä»£ç†</span><br><span class="line">git config <span class="attr">--global</span> http<span class="selector-class">.proxy</span> <span class="string">&#x27;socks5://127.0.0.1:1080&#x27;</span></span><br><span class="line">git config <span class="attr">--global</span> https<span class="selector-class">.proxy</span> <span class="string">&#x27;socks5://127.0.0.1:1080&#x27;</span></span><br><span class="line">å–æ¶ˆä»£ç†</span><br><span class="line">git config <span class="attr">--global</span> <span class="attr">--unset</span>  http<span class="selector-class">.proxy</span></span><br><span class="line">git config <span class="attr">--global</span> <span class="attr">--unset</span>  https<span class="selector-class">.proxy</span></span><br><span class="line">åªå¯¹github<span class="selector-class">.com</span></span><br><span class="line">git config <span class="attr">--global</span> http<span class="selector-class">.https</span>:<span class="comment">//github.com.proxy socks5://127.0.0.1:1080</span></span><br><span class="line">#å–æ¶ˆä»£ç†</span><br><span class="line">git config <span class="attr">--global</span> <span class="attr">--unset</span> http<span class="selector-class">.https</span>:<span class="comment">//github.com.proxy</span></span><br></pre></td></tr></table></figure><h2 id="2-æ˜¾ç¤ºå½“å‰çš„Gité…ç½®"><a href="#2-æ˜¾ç¤ºå½“å‰çš„Gité…ç½®" class="headerlink" title="2. æ˜¾ç¤ºå½“å‰çš„Gité…ç½®"></a>2. æ˜¾ç¤ºå½“å‰çš„Gité…ç½®</h2><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="keyword">config</span> --list</span><br><span class="line"></span><br><span class="line"># ç¼–è¾‘Gité…ç½®æ–‡ä»¶</span><br><span class="line">$ git <span class="keyword">config</span> -e [--<span class="keyword">global</span>]</span><br><span class="line"></span><br><span class="line"># è®¾ç½®æäº¤ä»£ç æ—¶çš„ç”¨æˆ·ä¿¡æ¯</span><br><span class="line">$ git <span class="keyword">config</span> [--<span class="keyword">global</span>] user<span class="variable">.name</span> <span class="string">&quot;[name]&quot;</span></span><br><span class="line">$ git <span class="keyword">config</span> [--<span class="keyword">global</span>] user<span class="variable">.email</span> <span class="string">&quot;[email address]&quot;</span></span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€å¢åŠ -åˆ é™¤æ–‡ä»¶"><a href="#ä¸‰ã€å¢åŠ -åˆ é™¤æ–‡ä»¶" class="headerlink" title="ä¸‰ã€å¢åŠ &#x2F;åˆ é™¤æ–‡ä»¶"></a>ä¸‰ã€å¢åŠ &#x2F;åˆ é™¤æ–‡ä»¶</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ·»åŠ æŒ‡å®šæ–‡ä»¶åˆ°æš‚å­˜åŒº</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git add [file1] [file2] ...</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ·»åŠ æŒ‡å®šç›®å½•åˆ°æš‚å­˜åŒºï¼ŒåŒ…æ‹¬å­ç›®å½•</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git add [<span class="built_in">dir</span>]</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ·»åŠ å½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶åˆ°æš‚å­˜åŒº</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git add .</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ·»åŠ æ¯ä¸ªå˜åŒ–å‰ï¼Œéƒ½ä¼šè¦æ±‚ç¡®è®¤</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯¹äºåŒä¸€ä¸ªæ–‡ä»¶çš„å¤šå¤„å˜åŒ–ï¼Œå¯ä»¥å®ç°åˆ†æ¬¡æäº¤</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git add -p</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ é™¤å·¥ä½œåŒºæ–‡ä»¶ï¼Œå¹¶ä¸”å°†è¿™æ¬¡åˆ é™¤æ”¾å…¥æš‚å­˜åŒº</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">rm</span> [file1] [file2] ...</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åœæ­¢è¿½è¸ªæŒ‡å®šæ–‡ä»¶ï¼Œä½†è¯¥æ–‡ä»¶ä¼šä¿ç•™åœ¨å·¥ä½œåŒº</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">rm</span> --cached [file]</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ”¹åæ–‡ä»¶ï¼Œå¹¶ä¸”å°†è¿™ä¸ªæ”¹åæ”¾å…¥æš‚å­˜åŒº</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">mv</span> [file-original] [file-renamed]</span></span><br></pre></td></tr></table></figure><h1 id="å››ã€ä»£ç æäº¤"><a href="#å››ã€ä»£ç æäº¤" class="headerlink" title="å››ã€ä»£ç æäº¤"></a>å››ã€ä»£ç æäº¤</h1><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æäº¤æš‚å­˜åŒºåˆ°ä»“åº“åŒº</span></span><br><span class="line"><span class="variable">$ </span>git commit -m [message]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æäº¤æš‚å­˜åŒºçš„æŒ‡å®šæ–‡ä»¶åˆ°ä»“åº“åŒº</span></span><br><span class="line"><span class="variable">$ </span>git commit [file1] [file2] ... -m [message]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æäº¤å·¥ä½œåŒºè‡ªä¸Šæ¬¡commitä¹‹åçš„å˜åŒ–ï¼Œç›´æ¥åˆ°ä»“åº“åŒº</span></span><br><span class="line"><span class="variable">$ </span>git commit -a</span><br><span class="line"></span><br><span class="line"><span class="comment"># æäº¤æ—¶æ˜¾ç¤ºæ‰€æœ‰diffä¿¡æ¯</span></span><br><span class="line"><span class="variable">$ </span>git commit -v</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ä¸€æ¬¡æ–°çš„commitï¼Œæ›¿ä»£ä¸Šä¸€æ¬¡æäº¤</span></span><br><span class="line"><span class="comment"># å¦‚æœä»£ç æ²¡æœ‰ä»»ä½•æ–°å˜åŒ–ï¼Œåˆ™ç”¨æ¥æ”¹å†™ä¸Šä¸€æ¬¡commitçš„æäº¤ä¿¡æ¯</span></span><br><span class="line"><span class="variable">$ </span>git commit --amend -m [message]</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡åšä¸Šä¸€æ¬¡commitï¼Œå¹¶åŒ…æ‹¬æŒ‡å®šæ–‡ä»¶çš„æ–°å˜åŒ–</span></span><br><span class="line"><span class="variable">$ </span>git commit --amend [file1] [file2] ...</span><br></pre></td></tr></table></figure><h1 id="äº”ã€åˆ†æ”¯"><a href="#äº”ã€åˆ†æ”¯" class="headerlink" title="äº”ã€åˆ†æ”¯"></a>äº”ã€åˆ†æ”¯</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ—å‡ºæ‰€æœ‰æœ¬åœ°åˆ†æ”¯</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git branch</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ—å‡ºæ‰€æœ‰è¿œç¨‹åˆ†æ”¯</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git branch -r</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ—å‡ºæ‰€æœ‰æœ¬åœ°åˆ†æ”¯å’Œè¿œç¨‹åˆ†æ”¯</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git branch -a</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œä½†ä¾ç„¶åœç•™åœ¨å½“å‰åˆ†æ”¯</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git branch [branch-name]</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œå¹¶åˆ‡æ¢åˆ°è¯¥åˆ†æ”¯</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git checkout -b [branch]</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼ŒæŒ‡å‘æŒ‡å®šcommit</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git branch [branch] [commit]</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œä¸æŒ‡å®šçš„è¿œç¨‹åˆ†æ”¯å»ºç«‹è¿½è¸ªå…³ç³»</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git branch --track [branch] [remote-branch]</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ‡æ¢åˆ°æŒ‡å®šåˆ†æ”¯ï¼Œå¹¶æ›´æ–°å·¥ä½œåŒº</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git checkout [branch-name]</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªåˆ†æ”¯</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git checkout -</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å»ºç«‹è¿½è¸ªå…³ç³»ï¼Œåœ¨ç°æœ‰åˆ†æ”¯ä¸æŒ‡å®šçš„è¿œç¨‹åˆ†æ”¯ä¹‹é—´</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git branch --set-upstream-to=origin/remote_branch branch</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆå¹¶æŒ‡å®šåˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git merge [branch]</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆå¹¶æŒ‡å®šåˆ†æ”¯æ‰€æœ‰æäº¤ä¸ºä¸€æ¡ï¼Œå†commitåæäº¤åˆ°å½“å‰åˆ†æ”¯</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git merge --squash branchname</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å–æ¶ˆåˆå¹¶</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git merge --abort</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é€‰æ‹©ä¸€ä¸ªcommitï¼Œåˆå¹¶è¿›å½“å‰åˆ†æ”¯</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git cherry-pick [commit]</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ é™¤åˆ†æ”¯</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git branch -d [branch-name]</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ é™¤è¿œç¨‹åˆ†æ”¯</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git push origin --delete [branch-name]</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git branch -dr [remote/branch]</span></span><br></pre></td></tr></table></figure><h1 id="å…­ã€æ ‡ç­¾"><a href="#å…­ã€æ ‡ç­¾" class="headerlink" title="å…­ã€æ ‡ç­¾"></a>å…­ã€æ ‡ç­¾</h1><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ—å‡ºæ‰€æœ‰tag</span></span><br><span class="line">$ git <span class="keyword">tag</span></span><br><span class="line"></span><br><span class="line"><span class="title"># æ˜¾ç¤ºtag</span>ä»¥åŠæ³¨é‡Šä¿¡æ¯</span><br><span class="line">$ git <span class="keyword">tag</span> <span class="title">-n</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–°å»ºä¸€ä¸ªtagåœ¨å½“å‰commit</span></span><br><span class="line">$ git <span class="keyword">tag</span> <span class="title">[tag</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–°å»ºä¸€ä¸ªtagåœ¨æŒ‡å®šcommit</span></span><br><span class="line">$ git <span class="keyword">tag</span> <span class="title">[tag</span>] [commit]</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤æœ¬åœ°tag</span></span><br><span class="line">$ git <span class="keyword">tag</span> <span class="title">-d</span> [<span class="keyword">tag</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤è¿œç¨‹tag</span></span><br><span class="line">$ git push origin :refs/tags/[tagName]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹tagä¿¡æ¯</span></span><br><span class="line">$ git show [<span class="keyword">tag</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æäº¤æŒ‡å®štag</span></span><br><span class="line">$ git push [remote] [<span class="keyword">tag</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æäº¤æ‰€æœ‰tag</span></span><br><span class="line">$ git push [remote] --tags</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼ŒæŒ‡å‘æŸä¸ªtag</span></span><br><span class="line">$ git checkout -b [branch] [<span class="keyword">tag</span>]</span><br></pre></td></tr></table></figure><h1 id="ä¸ƒã€æŸ¥çœ‹ä¿¡æ¯"><a href="#ä¸ƒã€æŸ¥çœ‹ä¿¡æ¯" class="headerlink" title="ä¸ƒã€æŸ¥çœ‹ä¿¡æ¯"></a>ä¸ƒã€æŸ¥çœ‹ä¿¡æ¯</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤ºæœ‰å˜æ›´çš„æ–‡ä»¶</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git status</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤ºå½“å‰åˆ†æ”¯çš„ç‰ˆæœ¬å†å²</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤ºæŒ‡å®šæ—¶é—´æŒ‡å®šæäº¤è€…å†å²è®°å½•</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span> --after=<span class="string">&quot;2020-01-01&quot;</span> --before=<span class="string">&quot;2021-01-01&quot;</span> --committer=xxx --<span class="built_in">date</span>=format:<span class="string">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span> --pretty=format:<span class="string">&quot;%h - %an, %ci : %s&quot;</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹å·²commitæœªpushåˆ°è¿œç¨‹ä»£ç åº“çš„æäº¤è¯¦æƒ…</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span> master ^origin/master</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤ºcommitå†å²ï¼Œä»¥åŠæ¯æ¬¡commitå‘ç”Ÿå˜æ›´çš„æ–‡ä»¶</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span> --<span class="built_in">stat</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤ºæŸä¸ªcommitä¹‹åçš„æ‰€æœ‰å˜åŠ¨ï¼Œæ¯ä¸ªcommitå æ®ä¸€è¡Œ</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span> [tag] HEAD --pretty=format:%s</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤ºæŸä¸ªcommitä¹‹åçš„æ‰€æœ‰å˜åŠ¨ï¼Œå…¶<span class="string">&quot;æäº¤è¯´æ˜&quot;</span>å¿…é¡»ç¬¦åˆæœç´¢æ¡ä»¶</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span> [tag] HEAD --grep feature</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤ºæŸä¸ªæ–‡ä»¶çš„ç‰ˆæœ¬å†å²ï¼ŒåŒ…æ‹¬æ–‡ä»¶æ”¹å</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span> --follow [file]</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git whatchanged [file]</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶ç›¸å…³çš„æ¯ä¸€æ¬¡diff</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span> -p [file]</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤ºè¿‡å»5æ¬¡æäº¤</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span> -5 --pretty --oneline</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤ºåŒ…å«åœ¨ feature åˆ†æ”¯è€Œä¸åœ¨ master åˆ†æ”¯ä¸­æ‰€æœ‰çš„æäº¤</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span> master..feature</span> </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¿½ç•¥åˆå¹¶è®°å½•</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span> --no-merge</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤ºæ–°å¢ã€ä¿®æ”¹ã€åˆ é™¤çš„æ–‡ä»¶æ¸…å•</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span> --name-status</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤º ASCII å›¾å½¢è¡¨ç¤ºçš„åˆ†æ”¯åˆå¹¶å†å²</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span> --graph</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸€è¡Œæ˜¾ç¤º,åªæ˜¾ç¤ºå“ˆå¸Œå€¼å’Œæäº¤è¯´æ˜</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span> --pretty --oneline</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ§åˆ¶æ˜¾ç¤ºçš„è®°å½•æ ¼å¼</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">%H-å®Œæ•´å“ˆå¸Œ %h-ç®€è¦å“ˆå¸Œ %an-åå­— %ae-é‚®ç®± %ad-ä¿®è®¢æ—¥æœŸ %arä¿®è®¢æ—¥æœŸ(å¤šä¹…å‰)(å…¶ä¸­aä¸ºä½œè€…ï¼Œcä¸ºcommiter) %s-æäº¤è¯´æ˜</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span> --pretty=format:<span class="string">&quot;%h - %an, %ar : %s&quot;</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">git <span class="built_in">log</span> æœç´¢å¼€å§‹</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä»…æ˜¾ç¤ºæŒ‡å®šæ—¶é—´ä¹‹å‰çš„æäº¤</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span> --before=<span class="string">&quot;2019-01-14&quot;</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä»…æ˜¾ç¤ºæŒ‡å®šæ—¶é—´ä¹‹åçš„æäº¤</span> </span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span> --since=<span class="string">&quot;2018-12-10&quot;</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä»…æ˜¾ç¤ºæŒ‡å®šä½œè€…ç›¸å…³çš„æäº¤</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span> --committer=thisofcat</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä»…æ˜¾ç¤ºæŒ‡å®šæäº¤è€…ç›¸å…³çš„æäº¤</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span> --committer=thisofcat</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŒ‰ç…§commitæè¿°</span></span><br><span class="line">git log --grep=&quot;commitæè¿°&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŒ‰ç…§å†…å®¹æœç´¢ S-å­—ç¬¦ä¸² G-æ­£åˆ™</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span> -S<span class="string">&quot;&lt;string&gt;&quot;</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">log</span> -G<span class="string">&quot;&lt;string&gt;&quot;</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">git <span class="built_in">log</span> æœç´¢ç»“æŸ</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤ºæ‰€æœ‰æäº¤è¿‡çš„ç”¨æˆ·ï¼ŒæŒ‰æäº¤æ¬¡æ•°æ’åº</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git shortlog -sn</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶æ˜¯ä»€ä¹ˆäººåœ¨ä»€ä¹ˆæ—¶é—´ä¿®æ”¹è¿‡</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git blame [file]</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤ºæš‚å­˜åŒºå’Œå·¥ä½œåŒºçš„å·®å¼‚</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git diff</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤ºæš‚å­˜åŒºå’Œä¸Šä¸€ä¸ªcommitçš„å·®å¼‚</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git diff --cached [file]</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤ºå·¥ä½œåŒºä¸å½“å‰åˆ†æ”¯æœ€æ–°commitä¹‹é—´çš„å·®å¼‚</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git diff HEAD</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤ºä¸¤æ¬¡æäº¤ä¹‹é—´çš„å·®å¼‚</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git diff [first-branch]...[second-branch]</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤ºä»Šå¤©ä½ å†™äº†å¤šå°‘è¡Œä»£ç </span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git diff --shortstat <span class="string">&quot;@&#123;0 day ago&#125;&quot;</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é€šè¿‡æ–‡ä»¶çŠ¶æ€è¿›è¡Œç­›é€‰, ä»…æ·»åŠ ï¼ˆAï¼‰ï¼Œå¤åˆ¶ï¼ˆCï¼‰ï¼Œåˆ é™¤ï¼ˆDï¼‰ï¼Œä¿®æ”¹ï¼ˆMï¼‰ï¼Œé‡å‘½åï¼ˆRï¼‰ï¼Œå…¶ç±»å‹ï¼ˆå³å¸¸è§„æ–‡ä»¶ï¼Œç¬¦å·é“¾æ¥ï¼Œå­æ¨¡å—ï¼Œ...ï¼‰æ›´æ”¹ï¼ˆTï¼‰ï¼ŒUnmergedï¼ˆUï¼‰</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git --diff-filter=[(A|C|D|M|R|T|U|X|B)â€¦*]</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤ºæŸæ¬¡æäº¤çš„å…ƒæ•°æ®å’Œå†…å®¹å˜åŒ–</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git show [commit]</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤ºæŸæ¬¡æäº¤å‘ç”Ÿå˜åŒ–çš„æ–‡ä»¶</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git show --name-only [commit]</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤ºæŸæ¬¡æäº¤æ—¶ï¼ŒæŸä¸ªæ–‡ä»¶çš„å†…å®¹</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git show [commit]:[filename]</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤ºå½“å‰åˆ†æ”¯çš„æœ€è¿‘å‡ æ¬¡æäº¤</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git reflog</span></span><br></pre></td></tr></table></figure><h1 id="å…«ã€è¿œç¨‹åŒæ­¥"><a href="#å…«ã€è¿œç¨‹åŒæ­¥" class="headerlink" title="å…«ã€è¿œç¨‹åŒæ­¥"></a>å…«ã€è¿œç¨‹åŒæ­¥</h1><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸‹è½½è¿œç¨‹ä»“åº“çš„æ‰€æœ‰å˜åŠ¨</span></span><br><span class="line"><span class="variable">$</span> git fetch [<span class="type">remote</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºæ‰€æœ‰è¿œç¨‹ä»“åº“</span></span><br><span class="line"><span class="variable">$</span> git remote <span class="literal">-v</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºæŸä¸ªè¿œç¨‹ä»“åº“çš„ä¿¡æ¯</span></span><br><span class="line"><span class="variable">$</span> git remote show [<span class="type">remote</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¢åŠ ä¸€ä¸ªæ–°çš„è¿œç¨‹ä»“åº“</span></span><br><span class="line"><span class="variable">$</span> git remote add origin git@git.coding.net:cats/thisofcat.git</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¢åŠ ä¸€ä¸ªæ–°çš„è¿œç¨‹ä»“åº“ï¼Œå¹¶å‘½å</span></span><br><span class="line"><span class="variable">$</span> git remote add [<span class="type">shortname</span>] [<span class="type">url</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹è¿œç¨‹ä»“åº“</span></span><br><span class="line"><span class="variable">$</span> git remote <span class="built_in">set-url</span> origin url</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤è¿œç¨‹ä»“åº“åœ°å€</span></span><br><span class="line"><span class="variable">$</span> git remote <span class="built_in">rm</span> origin</span><br><span class="line"></span><br><span class="line"><span class="comment"># å–å›è¿œç¨‹ä»“åº“çš„å˜åŒ–ï¼Œå¹¶ä¸æœ¬åœ°åˆ†æ”¯åˆå¹¶</span></span><br><span class="line"><span class="variable">$</span> git pull [<span class="type">remote</span>] [<span class="type">branch</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸Šä¼ æœ¬åœ°æŒ‡å®šåˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“</span></span><br><span class="line"><span class="variable">$</span> git push [<span class="type">remote</span>] [<span class="type">branch</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼ºè¡Œæ¨é€å½“å‰åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“ï¼Œå³ä½¿æœ‰å†²çª</span></span><br><span class="line"><span class="variable">$</span> git push [<span class="type">remote</span>] <span class="literal">--force</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨é€æ‰€æœ‰åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“</span></span><br><span class="line"><span class="variable">$</span> git push [<span class="type">remote</span>] <span class="literal">--all</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤æœ¬åœ°å­˜åœ¨ï¼Œè¿œç¨‹ä¸å­˜åœ¨çš„åˆ†æ”¯</span></span><br><span class="line"><span class="variable">$</span> git remote prune æŒ‡å®šåˆ†æ”¯(åˆ é™¤æŒ‡å®šåˆ†æ”¯)</span><br><span class="line"><span class="variable">$</span> git remote prune origin(åˆ é™¤æ‰€æœ‰)</span><br></pre></td></tr></table></figure><h1 id="ä¹ã€æ’¤é”€"><a href="#ä¹ã€æ’¤é”€" class="headerlink" title="ä¹ã€æ’¤é”€"></a>ä¹ã€æ’¤é”€</h1><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¢å¤æš‚å­˜åŒºçš„æŒ‡å®šæ–‡ä»¶åˆ°å·¥ä½œåŒº</span></span><br><span class="line"><span class="variable">$ </span>git checkout [file]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¢å¤æŸä¸ªcommitçš„æŒ‡å®šæ–‡ä»¶åˆ°æš‚å­˜åŒºå’Œå·¥ä½œåŒº</span></span><br><span class="line"><span class="variable">$ </span>git checkout [commit] [file]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¢å¤æš‚å­˜åŒºçš„æ‰€æœ‰æ–‡ä»¶åˆ°å·¥ä½œåŒº</span></span><br><span class="line"><span class="variable">$ </span>git checkout .</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡ç½®æš‚å­˜åŒºçš„æŒ‡å®šæ–‡ä»¶ï¼Œä¸ä¸Šä¸€æ¬¡commitä¿æŒä¸€è‡´ï¼Œä½†å·¥ä½œåŒºä¸å˜</span></span><br><span class="line"><span class="variable">$ </span>git reset [file]</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡ç½®æš‚å­˜åŒºä¸å·¥ä½œåŒºï¼Œä¸ä¸Šä¸€æ¬¡commitä¿æŒä¸€è‡´</span></span><br><span class="line"><span class="variable">$ </span>git reset --hard</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡ç½®å½“å‰åˆ†æ”¯çš„æŒ‡é’ˆä¸ºæŒ‡å®šcommitï¼ŒåŒæ—¶é‡ç½®æš‚å­˜åŒºï¼Œä½†å·¥ä½œåŒºä¸å˜</span></span><br><span class="line"><span class="variable">$ </span>git reset [commit]</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡ç½®å½“å‰åˆ†æ”¯çš„HEADä¸ºæŒ‡å®šcommitï¼ŒåŒæ—¶é‡ç½®æš‚å­˜åŒºå’Œå·¥ä½œåŒºï¼Œä¸æŒ‡å®šcommitä¸€è‡´</span></span><br><span class="line"><span class="variable">$ </span>git reset --hard [commit]</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡ç½®å½“å‰HEADä¸ºæŒ‡å®šcommitï¼Œä½†ä¿æŒæš‚å­˜åŒºå’Œå·¥ä½œåŒºä¸å˜</span></span><br><span class="line"><span class="variable">$ </span>git reset --keep [commit]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–°å»ºä¸€ä¸ªcommitï¼Œç”¨æ¥æ’¤é”€æŒ‡å®šcommit</span></span><br><span class="line"><span class="comment"># åè€…çš„æ‰€æœ‰å˜åŒ–éƒ½å°†è¢«å‰è€…æŠµæ¶ˆï¼Œå¹¶ä¸”åº”ç”¨åˆ°å½“å‰åˆ†æ”¯</span></span><br><span class="line"><span class="variable">$ </span>git revert [commit]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æš‚æ—¶å°†æœªæäº¤çš„å˜åŒ–ç§»é™¤ï¼Œç¨åå†ç§»å…¥</span></span><br><span class="line"><span class="variable">$ </span>git stash</span><br><span class="line"><span class="variable">$ </span>git stash pop</span><br><span class="line"><span class="comment"># è¿›è¡Œå‚¨å­˜å¹¶å¤‡æ³¨</span></span><br><span class="line"><span class="variable">$ </span>git statsh save <span class="string">&#x27;msg&#x27;</span></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å‚¨å­˜åˆ—è¡¨</span></span><br><span class="line"><span class="variable">$ </span>git stash list</span><br><span class="line"><span class="comment"># åº”ç”¨æŒ‡å®šå‚¨å­˜</span></span><br><span class="line"><span class="variable">$ </span>git stash apply stash@&#123;<span class="number">2</span>&#125;</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æŒ‡å®šå‚¨å­˜ä¿®æ”¹è®°å½•</span></span><br><span class="line"><span class="variable">$ </span>git stash show -p stash@&#123;<span class="number">2</span>&#125;</span><br></pre></td></tr></table></figure><h1 id="åã€å…¶ä»–"><a href="#åã€å…¶ä»–" class="headerlink" title="åã€å…¶ä»–"></a>åã€å…¶ä»–</h1><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç”Ÿæˆä¸€ä¸ªå¯ä¾›å‘å¸ƒçš„å‹ç¼©åŒ…</span></span><br><span class="line"><span class="variable">$ </span>git archive</span><br></pre></td></tr></table></figure><h1 id="gitå‘½ä»¤å›¾"><a href="#gitå‘½ä»¤å›¾" class="headerlink" title="gitå‘½ä»¤å›¾"></a>gitå‘½ä»¤å›¾</h1><p><img src="/images/%E5%90%8E%E7%AB%AF/git/git.png" alt="æ‰§è¡Œç¤ºæ„å›¾"></p><p>ï¼ˆå®Œï¼‰</p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¸¸ç”¨å‘½ä»¤ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>javaå®‰è£…æ–‡æ¡£</title>
      <link href="/posts/b612af2c.html"/>
      <url>/posts/b612af2c.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="å¸è½½å·²å®‰è£…çš„ç‰ˆæœ¬"><a href="#å¸è½½å·²å®‰è£…çš„ç‰ˆæœ¬" class="headerlink" title="å¸è½½å·²å®‰è£…çš„ç‰ˆæœ¬"></a>å¸è½½å·²å®‰è£…çš„ç‰ˆæœ¬</h1><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rpm -<span class="keyword">qa</span> | <span class="keyword">grep</span> java</span><br><span class="line">rpm -<span class="keyword">e</span> java-openjdk</span><br></pre></td></tr></table></figure><h1 id="å®‰è£…java7-java-se-1-7"><a href="#å®‰è£…java7-java-se-1-7" class="headerlink" title="å®‰è£…java7(java se 1.7)"></a>å®‰è£…java7(java se 1.7)</h1><h1 id="ä»orcalä¸‹è½½"><a href="#ä»orcalä¸‹è½½" class="headerlink" title="ä»orcalä¸‹è½½"></a>ä»orcalä¸‹è½½</h1><h1 id="java8å¯ä»¥ç›´æ¥ä¸‹è½½ï¼Œjava7éœ€è¦åˆ°javaæ¡£æ¡ˆä¸­ä¸‹è½½"><a href="#java8å¯ä»¥ç›´æ¥ä¸‹è½½ï¼Œjava7éœ€è¦åˆ°javaæ¡£æ¡ˆä¸­ä¸‹è½½" class="headerlink" title="java8å¯ä»¥ç›´æ¥ä¸‹è½½ï¼Œjava7éœ€è¦åˆ°javaæ¡£æ¡ˆä¸­ä¸‹è½½"></a>java8å¯ä»¥ç›´æ¥ä¸‹è½½ï¼Œjava7éœ€è¦åˆ°javaæ¡£æ¡ˆä¸­ä¸‹è½½</h1><p><a href="http://www.oracle.com/technetwork/java/javase/downloads/java-archive-downloads-javase7-521261.html">ç½‘å€é“¾æ¥</a></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ wget https:<span class="regexp">//mi</span>rrors.tuna.tsinghua.edu.cn<span class="regexp">/AdoptOpenJDK/</span><span class="number">8</span><span class="regexp">/jdk/</span>x64<span class="regexp">/linux/</span>OpenJDK8U-jdk_x64_linux_hotspot_8u292b10.tar.gz</span><br></pre></td></tr></table></figure><h1 id="è§£å‹"><a href="#è§£å‹" class="headerlink" title="è§£å‹"></a>è§£å‹</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -xzf OpenJDK8U-jdk_x64_linux_hotspot_8u292b10.tar.gz &amp;&amp; mv jdk8u292-b10 /usr/local/webserver/java8</span><br></pre></td></tr></table></figure><h1 id="é…ç½®ç¯å¢ƒå˜é‡"><a href="#é…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="é…ç½®ç¯å¢ƒå˜é‡"></a>é…ç½®ç¯å¢ƒå˜é‡</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">sudo</span> vim /etc/profile.d/java.sh</span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/local/webserver/java8</span><br><span class="line"><span class="built_in">export</span> JRE_HOME=<span class="variable">$JAVA_HOME</span>/jre</span><br><span class="line"><span class="built_in">export</span> CLASSPATH=.:<span class="variable">$JAVA_HOME</span>/lib/dt.jar:<span class="variable">$JAVA_HOME</span>/lib/tools.jar:<span class="variable">$JRE_HOME</span>/lib:<span class="variable">$CLASSPATH</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure><h1 id="windowsç¯å¢ƒå˜é‡"><a href="#windowsç¯å¢ƒå˜é‡" class="headerlink" title="windowsç¯å¢ƒå˜é‡"></a>windowsç¯å¢ƒå˜é‡</h1><h1 id="æ–°å¢JAVA-HOME"><a href="#æ–°å¢JAVA-HOME" class="headerlink" title="æ–°å¢JAVA_HOME"></a>æ–°å¢JAVA_HOME</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">D:\Program Files\Java\jdk1.7.0_80</span><br><span class="line">```shell</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">PATHæ–°å¢</span></span><br><span class="line">```shell</span><br><span class="line"><span class="meta prompt_">%</span><span class="language-bash">JAVA_HOME%\bin;%JAVA_HOME%\jre\bin;</span></span><br></pre></td></tr></table></figure><h1 id="ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ"><a href="#ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ" class="headerlink" title="ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ"></a>ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">source</span> /etc/profile</span></span><br></pre></td></tr></table></figure><h1 id="æŸ¥çœ‹ç‰ˆæœ¬å·"><a href="#æŸ¥çœ‹ç‰ˆæœ¬å·" class="headerlink" title="æŸ¥çœ‹ç‰ˆæœ¬å·"></a>æŸ¥çœ‹ç‰ˆæœ¬å·</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">java -version</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰è£…æ–‡æ¡£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysqlé…ç½®æ–‡ä»¶</title>
      <link href="/posts/ffed214c.html"/>
      <url>/posts/ffed214c.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># For advice on how to change settings please see</span></span><br><span class="line"><span class="comment"># http://dev.mysql.com/doc/refman/5.6/en/server-configuration-defaults.html</span></span><br><span class="line"></span><br><span class="line"><span class="section">[mysqld]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Remove leading # and set to the amount of RAM for the most important data</span></span><br><span class="line"><span class="comment"># cache in MySQL. Start at 70% of total RAM for dedicated server, else 10%.</span></span><br><span class="line"><span class="comment"># innodb_buffer_pool_size = 128M</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Remove leading # to turn on a very important data integrity option: logging</span></span><br><span class="line"><span class="comment"># changes to the binary log between backups.</span></span><br><span class="line"><span class="comment"># log_bin</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># These are commonly set, remove the # and set as required.</span></span><br><span class="line"><span class="comment"># basedir = .....</span></span><br><span class="line"><span class="comment"># datadir = .....</span></span><br><span class="line"><span class="comment"># port = .....</span></span><br><span class="line"><span class="comment"># server_id = .....</span></span><br><span class="line"><span class="comment"># socket = .....</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Remove leading # to set options mainly useful for reporting servers.</span></span><br><span class="line"><span class="comment"># The server defaults are faster for transactions and fast SELECTs.</span></span><br><span class="line"><span class="comment"># Adjust sizes as needed, experiment to find the optimal values.</span></span><br><span class="line"><span class="comment"># join_buffer_size = 128M</span></span><br><span class="line"><span class="comment"># sort_buffer_size = 2M</span></span><br><span class="line"><span class="comment"># read_rnd_buffer_size = 2M </span></span><br><span class="line"></span><br><span class="line"><span class="attr">user</span> = mysql</span><br><span class="line"><span class="attr">sql_mode</span>=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES </span><br><span class="line"><span class="attr">basedir</span> = /usr/local/webserver/mysql</span><br><span class="line"><span class="attr">datadir</span> = /data/mysql/data</span><br><span class="line"><span class="attr">port</span> = <span class="number">3306</span></span><br><span class="line"><span class="attr">socket</span> = /tmp/mysql.sock</span><br><span class="line"><span class="comment"># pid_file = /var/run/mysqld.pid</span></span><br><span class="line"><span class="attr">pid_file</span> = /data/mysql/data/mysql.pid</span><br><span class="line"><span class="attr">log-error</span> = /data/mysql/mysqld_error.log</span><br><span class="line"><span class="attr">log-bin</span> = /data/mysql/mysql-bin</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥è¯¢è¶…è¿‡å¤šå°‘ç§’å†™å…¥æ…¢æ—¥å¿—</span></span><br><span class="line"><span class="attr">long_query_time</span>=<span class="number">1</span></span><br><span class="line"><span class="comment"># å¼€å¯è®°å½•æ…¢æ—¥å¿—</span></span><br><span class="line"><span class="attr">slow_query_log</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">slow_query_log_file</span>=/data/mysql/mysql-slow.log</span><br><span class="line"><span class="comment"># ã€€è¿è¡Œçš„SQLæ²¡æœ‰ä½¿ç”¨ç´¢å¼•ï¼Œè®°å½•åˆ°æ…¢æ—¥å¿— 1-å¼€å¯ 0-å…³é—­</span></span><br><span class="line"><span class="attr">log_queries_not_using_indexes</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="attr">max_connections</span>=<span class="number">1000</span></span><br><span class="line"><span class="attr">max_allowed_packet</span>=<span class="number">32</span>M</span><br><span class="line"></span><br><span class="line"><span class="attr">innodb_file_per_table</span> = <span class="number">1</span></span><br><span class="line"><span class="attr">innodb_buffer_pool_size</span> = <span class="number">1</span>G</span><br><span class="line"></span><br><span class="line"><span class="comment"># 0ï¼šlog bufferå°†æ¯ç§’ä¸€æ¬¡åœ°å†™å…¥log fileä¸­ï¼Œå¹¶ä¸”log fileçš„flush(åˆ·åˆ°ç£ç›˜)æ“ä½œåŒæ—¶è¿›è¡Œã€‚è¯¥æ¨¡å¼ä¸‹åœ¨äº‹åŠ¡æäº¤çš„æ—¶å€™ï¼Œä¸ä¼šä¸»åŠ¨è§¦å‘å†™å…¥ç£ç›˜çš„æ“ä½œã€‚</span></span><br><span class="line"><span class="comment"># 1ï¼šæ¯æ¬¡äº‹åŠ¡æäº¤æ—¶MySQLéƒ½ä¼šæŠŠlog bufferçš„æ•°æ®å†™å…¥log fileï¼Œå¹¶ä¸”flush(åˆ·åˆ°ç£ç›˜)ä¸­å»ï¼Œè¯¥æ¨¡å¼ä¸ºç³»ç»Ÿé»˜è®¤ã€‚</span></span><br><span class="line"><span class="comment"># 2ï¼šæ¯æ¬¡äº‹åŠ¡æäº¤æ—¶MySQLéƒ½ä¼šæŠŠlog bufferçš„æ•°æ®å†™å…¥log fileï¼Œä½†æ˜¯flush(åˆ·åˆ°ç£ç›˜)æ“ä½œå¹¶ä¸ä¼šåŒæ—¶è¿›è¡Œã€‚è¯¥æ¨¡å¼ä¸‹ï¼ŒMySQLä¼šæ¯ç§’æ‰§è¡Œä¸€æ¬¡ flush(åˆ·åˆ°ç£ç›˜)æ“ä½œã€‚</span></span><br><span class="line"><span class="attr">innodb_flush_log_at_trx_commit</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="attr">sql_mode</span>=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="comment"># lower_case_table_names = 1</span></span><br></pre></td></tr></table></figure><p>é…ç½®æ–‡ä»¶å‚æ•°è§£è¯»</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br></pre></td><td class="code"><pre><span class="line">[client]</span><br><span class="line"><span class="comment"># å®¢æˆ·ç«¯é»˜è®¤è¿æ¥ç«¯å£socket</span></span><br><span class="line">port = 3306</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨äºæœ¬åœ°è¿æ¥çš„socketå¥—æ¥å­—</span></span><br><span class="line">socket = /apps/mysql/lock/mysql.sock</span><br><span class="line">[mysqld]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœåŠ¡ç«¯åŸºæœ¬é…ç½®</span></span><br><span class="line"><span class="comment"># mysqlæœåŠ¡ç«¯ç›‘å¬ç«¯å£</span></span><br><span class="line">port = 3306</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸ºmysqlå®¢æˆ·ç«¯ç¨‹åºå’ŒæœåŠ¡å™¨ä¹‹é—´çš„æœ¬åœ°é€šè®¯æŒ‡å®šä¸€ä¸ªå¥—æ¥å­—æ–‡ä»¶</span></span><br><span class="line">socket = /apps/mysql/lock/mysql.sock</span><br><span class="line"></span><br><span class="line"><span class="comment"># mysqlå®‰è£…ç›®å½•</span></span><br><span class="line">basedir = /apps/mysql</span><br><span class="line"></span><br><span class="line"><span class="comment"># mysqlæ•°æ®åº“æ•°æ®æ–‡ä»¶å­˜æ”¾ç›®å½•</span></span><br><span class="line">datadir = /apps/mysql/data</span><br><span class="line"></span><br><span class="line"><span class="comment"># pidæ‰€åœ¨çš„ç›®å½•</span></span><br><span class="line">pid-file = /apps/mysql/run/mysql.pid</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®°å½•mysqlé”™è¯¯æ—¥å¿—æ–‡ä»¶</span></span><br><span class="line">log-error = /apps/mysql/logs/mysql-error.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># mysqlå¯åŠ¨ç”¨æˆ·</span></span><br><span class="line">user = mysql</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸´æ—¶ç›®å½• æ¯”å¦‚load data infileä¼šç”¨åˆ°,ä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨/tmp</span></span><br><span class="line">tmpdir  = /tmp</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¡¨ç¤ºè·³è¿‡ä¸»æœºåè§£æ</span></span><br><span class="line"><span class="comment"># ç¦æ­¢MySQLå¯¹å¤–éƒ¨è¿æ¥è¿›è¡ŒDNSè§£æï¼Œä½¿ç”¨è¿™ä¸€é€‰é¡¹å¯ä»¥æ¶ˆé™¤MySQLè¿›è¡ŒDNSè§£æçš„æ—¶é—´ã€‚</span></span><br><span class="line"><span class="comment"># ç¼ºç‚¹ï¼šæ‰€æœ‰è¿œç¨‹ä¸»æœºè¿æ¥æˆæƒéƒ½è¦ä½¿ç”¨IPåœ°å€æ–¹å¼ï¼Œå› ä¸ºåªè®¤å¾—ipåœ°å€äº†ã€‚</span></span><br><span class="line">skip_name_resolve = 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># mysqlé€‰é¡¹ä»¥é¿å…å¤–éƒ¨é”å®šã€‚è¯¥é€‰é¡¹é»˜è®¤å¼€å¯ã€‚ä¸ä½¿ç”¨ç³»ç»Ÿé”å®šï¼Œè¦ä½¿ç”¨myisamchk,å¿…é¡»å…³é—­æœåŠ¡å™¨ </span></span><br><span class="line"><span class="comment"># å‚è€ƒhttp://www.kuqin.com/database/20120815/328905.html</span></span><br><span class="line">skip-external-locking</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™ä¸ªå‚æ•°ç”¨æ¥ç¼“å­˜MyISAMå­˜å‚¨å¼•æ“çš„ç´¢å¼•å‚æ•°ï¼Œå¢åŠ å®ƒå¯å¾—åˆ°æ›´å¥½å¤„ç†çš„ç´¢å¼•(å¯¹æ‰€æœ‰è¯»å’Œå¤šé‡å†™)ã€‚é»˜è®¤ä¸ºInnoDBå­˜å‚¨å¼•æ“ï¼Œè¯¥å‚æ•°å¯ä»¥è®¾ç½®å°ç‚¹ï¼Œ64Må³å¯ã€‚</span></span><br><span class="line"><span class="comment"># ç³»ç»Ÿå°†å¼€å§‹æ¢é¡µå¹¶ä¸”çœŸçš„å˜æ…¢äº†ã€‚å¯¹äºå†…å­˜åœ¨4GBå·¦å³çš„æœåŠ¡å™¨è¯¥å‚æ•°å¯è®¾ç½®ä¸º384Mæˆ–512Mã€‚é€šè¿‡æ£€æŸ¥çŠ¶æ€å€¼Key_read_requestså’ŒKey_readsï¼Œ</span></span><br><span class="line"><span class="comment"># å¯ä»¥çŸ¥é“key_buffer_sizeè®¾ç½®æ˜¯å¦åˆç†ã€‚æ¯”ä¾‹key_reads/key_read_requestsåº”è¯¥å°½å¯èƒ½çš„ä½ï¼Œ  </span></span><br><span class="line"><span class="comment"># è‡³å°‘æ˜¯1:100ï¼Œ1:1000æ›´å¥½(ä¸Šè¿°çŠ¶æ€å€¼å¯ä»¥ä½¿ç”¨SHOW STATUS LIKE &#x27;key_read%&#x27;è·å¾—)ã€‚æ³¨æ„ï¼šè¯¥å‚æ•°å€¼è®¾ç½®çš„è¿‡å¤§åè€Œä¼šæ˜¯æœåŠ¡å™¨æ•´ä½“æ•ˆç‡é™ä½</span></span><br><span class="line">key_buffer_size = 384M</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…è®¸æœ€å¤§æ¥æ”¶æ•°æ®åŒ…çš„å¤§å°ï¼Œé˜²æ­¢æœåŠ¡å™¨å‘é€è¿‡å¤§çš„æ•°æ®åŒ…ã€‚å¢åŠ è¯¥å˜é‡çš„å€¼ååˆ†å®‰å…¨ï¼Œè¿™æ˜¯å› ä¸ºä»…å½“éœ€è¦æ—¶æ‰ä¼šåˆ†é…é¢å¤–å†…å­˜ã€‚ä¾‹å¦‚ä»…å½“ä½ å‘å‡ºé•¿æŸ¥è¯¢æˆ–mysqldå¿…é¡»è¿”å›å¤§çš„ç»“æœè¡Œæ—¶mysqldæ‰ä¼šåˆ†é…æ›´å¤šå†…å­˜ã€‚å¯ä»¥è®¾ç½®ä¸º16MBæˆ–è€…æ›´å¤§ï¼Œä½†è®¾ç½®çš„å¤ªå¤§ä¹Ÿå¯èƒ½æœ‰å±é™©ã€‚</span></span><br><span class="line"><span class="comment"># è¯¥å˜é‡ä¹‹æ‰€ä»¥å–è¾ƒå°é»˜è®¤å€¼æ˜¯ä¸€ç§é¢„é˜²æªæ–½ï¼Œä»¥æ•è·å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„é”™è¯¯ä¿¡æ¯åŒ…ï¼Œå¹¶ç¡®ä¿ä¸ä¼šå› å¶ç„¶ä½¿ç”¨å¤§çš„ä¿¡æ¯åŒ…è€Œå¯¼è‡´å†…å­˜æº¢å‡ºã€‚  </span></span><br><span class="line">max_allowed_packet = 16M</span><br><span class="line"></span><br><span class="line"><span class="comment"># MySQLæ¯æ‰“å¼€ä¸€ä¸ªè¡¨ï¼Œéƒ½ä¼šè¯»å…¥ä¸€äº›æ•°æ®åˆ°table_open_cacheç¼“å­˜ä¸­ï¼Œå½“MySQLåœ¨è¿™ä¸ªç¼“å­˜ä¸­æ‰¾ä¸åˆ°ç›¸åº”ä¿¡æ¯æ—¶ï¼Œæ‰ä¼šå»ç£ç›˜ä¸Šè¯»å–ã€‚é»˜è®¤å€¼64ï¼Œå‡å®šç³»ç»Ÿæœ‰200ä¸ªå¹¶å‘è¿æ¥ï¼Œåˆ™éœ€å°†æ­¤å‚æ•°è®¾ç½®ä¸º200*N(Nä¸ºæ¯ä¸ªè¿æ¥æ‰€éœ€çš„æ–‡ä»¶æè¿°ç¬¦æ•°ç›®)ï¼›å½“æŠŠtable_open_cacheè®¾ç½®ä¸ºå¾ˆå¤§æ—¶ï¼Œå¦‚æœç³»ç»Ÿå¤„ç†ä¸äº†é‚£ä¹ˆå¤šæ–‡ä»¶æè¿°ç¬¦ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°å®¢æˆ·ç«¯å¤±æ•ˆï¼Œè¿æ¥ä¸ä¸Šã€‚</span></span><br><span class="line"><span class="comment"># ç¼“å­˜linuxæ–‡ä»¶æè¿°ç¬¦ä¿¡æ¯ï¼ŒåŠ å¿«æ•°æ®æ–‡ä»¶æ‰“å¼€é€Ÿåº¦</span></span><br><span class="line"><span class="comment"># å®ƒå½±å“myisamè¡¨çš„æ‰“å¼€å…³é—­ï¼Œä½†æ˜¯ä¸å½±å“innodbè¡¨çš„æ‰“å¼€å…³é—­ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼2000ï¼Œå»ºè®®å€¼ï¼šæ ¹æ®çŠ¶æ€å˜é‡Opened_tableså»è®¾å®š</span></span><br><span class="line">table_open_cache = 512</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼“å­˜è¡¨å®šä¹‰çš„ç›¸å…³ä¿¡æ¯ï¼ŒåŠ å¿«è¯»å–è¡¨ä¿¡æ¯é€Ÿåº¦</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼1400ï¼Œæœ€å¤§å€¼2000ï¼Œå»ºè®®å€¼ï¼šåŸºæœ¬ä¸æ”¹ã€‚</span></span><br><span class="line">table_definition_cache = 1400</span><br><span class="line"><span class="comment"># è¯¥å‚æ•°æ˜¯myssql 5.6åå¼•å…¥çš„ï¼Œç›®çš„æ˜¯æé«˜å¹¶å‘ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼1ï¼Œå»ºè®®å€¼ï¼šcpuæ ¸æ•°ï¼Œå¹¶ä¸”&lt;=16</span></span><br><span class="line">table_open_cache_instances = 2</span><br><span class="line"></span><br><span class="line"><span class="comment"># MySQLèƒ½æœ‰çš„è¿æ¥æ•°é‡ã€‚å½“ä¸»è¦MySQLçº¿ç¨‹åœ¨ä¸€ä¸ªå¾ˆçŸ­æ—¶é—´å†…å¾—åˆ°éå¸¸å¤šçš„è¿æ¥è¯·æ±‚ï¼Œè¿™å°±èµ·ä½œç”¨ï¼Œ  </span></span><br><span class="line"><span class="comment"># ç„¶åä¸»çº¿ç¨‹èŠ±äº›æ—¶é—´(å°½ç®¡å¾ˆçŸ­)æ£€æŸ¥è¿æ¥å¹¶ä¸”å¯åŠ¨ä¸€ä¸ªæ–°çº¿ç¨‹ã€‚back_logå€¼æŒ‡å‡ºåœ¨MySQLæš‚æ—¶åœæ­¢å›ç­”æ–°è¯·æ±‚ä¹‹å‰çš„çŸ­æ—¶é—´å†…å¤šå°‘ä¸ªè¯·æ±‚å¯ä»¥è¢«å­˜åœ¨å †æ ˆä¸­ã€‚</span></span><br><span class="line"><span class="comment"># å¦‚æœæœŸæœ›åœ¨ä¸€ä¸ªçŸ­æ—¶é—´å†…æœ‰å¾ˆå¤šè¿æ¥ï¼Œä½ éœ€è¦å¢åŠ å®ƒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœMySQLçš„è¿æ¥æ•°æ®è¾¾åˆ°max_connectionsæ—¶ï¼Œæ–°æ¥çš„è¯·æ±‚å°†ä¼šè¢«å­˜åœ¨å †æ ˆä¸­ï¼Œ  </span></span><br><span class="line"><span class="comment"># ä»¥ç­‰å¾…æŸä¸€è¿æ¥é‡Šæ”¾èµ„æºï¼Œè¯¥å †æ ˆçš„æ•°é‡å³back_logï¼Œå¦‚æœç­‰å¾…è¿æ¥çš„æ•°é‡è¶…è¿‡back_logï¼Œå°†ä¸è¢«æˆäºˆè¿æ¥èµ„æºã€‚  </span></span><br><span class="line"><span class="comment"># å¦å¤–ï¼Œè¿™å€¼ï¼ˆback_logï¼‰é™äºæ‚¨çš„æ“ä½œç³»ç»Ÿå¯¹åˆ°æ¥çš„TCP/IPè¿æ¥çš„ä¾¦å¬é˜Ÿåˆ—çš„å¤§å°ã€‚  </span></span><br><span class="line"><span class="comment"># ä½ çš„æ“ä½œç³»ç»Ÿåœ¨è¿™ä¸ªé˜Ÿåˆ—å¤§å°ä¸Šæœ‰å®ƒè‡ªå·±çš„é™åˆ¶ï¼ˆå¯ä»¥æ£€æŸ¥ä½ çš„OSæ–‡æ¡£æ‰¾å‡ºè¿™ä¸ªå˜é‡çš„æœ€å¤§å€¼ï¼‰ï¼Œè¯•å›¾è®¾å®šback_logé«˜äºä½ çš„æ“ä½œç³»ç»Ÿçš„é™åˆ¶å°†æ˜¯æ— æ•ˆçš„ã€‚</span></span><br><span class="line"><span class="comment"># åœ¨MySQLæš‚æ—¶åœæ­¢å“åº”æ–°è¯·æ±‚ä¹‹å‰çš„çŸ­æ—¶é—´å†…å¤šå°‘ä¸ªè¯·æ±‚å¯ä»¥è¢«å­˜åœ¨å †æ ˆä¸­ </span></span><br><span class="line"><span class="comment"># å®˜æ–¹å»ºè®®back_log = 50 + (max_connections / 5),å°é¡¶æ•°ä¸º900</span></span><br><span class="line">back_log = 600</span><br><span class="line"></span><br><span class="line"><span class="comment"># MySQLæ‰§è¡Œæ’åºä½¿ç”¨çš„ç¼“å†²å¤§å°ã€‚å¦‚æœæƒ³è¦å¢åŠ ORDER BYçš„é€Ÿåº¦ï¼Œé¦–å…ˆçœ‹æ˜¯å¦å¯ä»¥è®©MySQLä½¿ç”¨ç´¢å¼•è€Œä¸æ˜¯é¢å¤–çš„æ’åºé˜¶æ®µã€‚  </span></span><br><span class="line"><span class="comment"># å¦‚æœä¸èƒ½ï¼Œå¯ä»¥å°è¯•å¢åŠ sort_buffer_sizeå˜é‡çš„å¤§å°ï¼Œé»˜è®¤ä¸º256kã€‚å¦å¤–ï¼Œä¸€èˆ¬å‡ºç°Using filesortçš„æ—¶å€™ï¼Œè¦é€šè¿‡å¢åŠ ç´¢å¼•æ¥è§£å†³ã€‚</span></span><br><span class="line">sort_buffer_size = 8M</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯¥å‚æ•°ç”¨äºè¡¨çš„é¡ºåºæ‰«æï¼Œè¡¨ç¤ºæ¯ä¸ªçº¿ç¨‹åˆ†é…çš„ç¼“å†²åŒºå¤§å°ã€‚æ¯”å¦‚åœ¨è¿›è¡Œå…¨è¡¨æ‰«ææ—¶ï¼ŒMySQLä¼šæŒ‰ç…§æ•°æ®çš„å­˜å‚¨é¡ºåºä¾æ¬¡è¯»å–æ•°æ®å—ï¼Œæ¯æ¬¡è¯»å–çš„æ•°æ®å—é¦–å…ˆä¼šæš‚å­˜åœ¨read_buffer_sizeä¸­ï¼Œå½“bufferç©ºé—´è¢«å†™æ»¡æˆ–è€…å…¨éƒ¨æ•°æ®è¯»å–ç»“æŸåï¼Œå†å°†bufferä¸­çš„æ•°æ®è¿”å›ç»™ä¸Šå±‚è°ƒç”¨è€…ï¼Œä»¥æé«˜æ•ˆç‡ã€‚é»˜è®¤ä¸º128Kï¼Œè¿™ä¸ªå‚æ•°ä¸è¦è®¾ç½®è¿‡å¤§ï¼Œä¸€èˆ¬åœ¨128ï½256ä¹‹é—´ã€‚å¦‚æœå¯¹è¡¨çš„é¡ºåºæ‰«æè¯·æ±‚éå¸¸é¢‘ç¹ï¼Œå¹¶ä¸”ä½ è®¤ä¸ºé¢‘ç¹æ‰«æè¿›è¡Œå¾—å¤ªæ…¢ï¼Œå¯ä»¥é€šè¿‡å¢åŠ è¯¥å˜é‡å€¼ä»¥åŠå†…å­˜ç¼“å†²åŒºå¤§å°æé«˜å…¶æ€§èƒ½</span></span><br><span class="line"><span class="comment"># ä¸ºæ¯ä¸ªæ‰«æMyISAMçš„çº¿ç¨‹åˆ†é…å‚æ•°è®¾ç½®çš„å†…å­˜å¤§å°ç¼“å†²åŒºã€‚ </span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼128kbï¼Œå»ºè®®å€¼ï¼š16Gå†…å­˜å»ºè®®1Mï¼Œ4Gï¼š128kbæˆ–è€…256kbå§</span></span><br><span class="line"><span class="comment"># æ³¨æ„ï¼Œè¯¥ç¼“å†²åŒºæ˜¯æ¯ä¸ªè¿æ¥ç‹¬å çš„ï¼Œæ‰€ä»¥æ€»ç¼“å†²åŒºå¤§å°ä¸º 128kb*è¿æ¥æ•°ï¼›æç«¯æƒ…å†µ128kb*maxconnectiosnsï¼Œä¼šè¶…çº§å¤§ï¼Œæ‰€ä»¥è¦è€ƒè™‘æ—¥å¸¸å¹³å‡è¿æ¥æ•°ã€‚</span></span><br><span class="line"><span class="comment"># ä¸€èˆ¬ä¸éœ€è¦å¤ªå…³å¿ƒè¯¥æ•°å€¼ï¼Œç¨å¾®å¢å¤§å°±å¯ä»¥äº†</span></span><br><span class="line">read_buffer_size = 2M  </span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯¥å‚æ•°ç”¨äºè¡¨çš„éšæœºè¯»å–ï¼Œè¡¨ç¤ºæ¯ä¸ªçº¿ç¨‹åˆ†é…çš„ç¼“å†²åŒºå¤§å°ã€‚æ¯”å¦‚æŒ‰ç…§ä¸€ä¸ªéç´¢å¼•å­—æ®µåšorder byæ’åºæ“ä½œæ—¶ï¼Œå°±ä¼šåˆ©ç”¨è¿™ä¸ªç¼“å†²åŒºæ¥æš‚å­˜è¯»å–çš„æ•°æ®ã€‚é»˜è®¤ä¸º256KBï¼Œè¿™ä¸ªå‚æ•°ä¸è¦è®¾ç½®è¿‡å¤§ï¼Œä¸€èˆ¬åœ¨128ï½512KBã€‚</span></span><br><span class="line"><span class="comment"># mysqlä¼šé¦–å…ˆæ‰«æä¸€éè¯¥ç¼“å†²ï¼Œä»¥é¿å…ç£ç›˜æœç´¢ï¼Œæé«˜æŸ¥è¯¢é€Ÿåº¦ï¼Œå¦‚æœéœ€è¦æ’åºå¤§é‡æ•°æ®ï¼Œå¯é€‚å½“è°ƒé«˜è¯¥å€¼ã€‚ä½†MySQLä¼šä¸ºæ¯ä¸ªå®¢æˆ·è¿æ¥å‘æ”¾è¯¥ç¼“å†²ç©ºé—´ï¼Œæ‰€ä»¥åº”å°½é‡é€‚å½“è®¾ç½®è¯¥å€¼ï¼Œä»¥é¿å…å†…å­˜å¼€é”€è¿‡å¤§ã€‚</span></span><br><span class="line"><span class="comment"># æ”¯æŒä»»ä½•å­˜å‚¨å¼•æ“</span></span><br><span class="line"><span class="comment"># MySQLçš„éšæœºè¯»ç¼“å†²åŒºå¤§å°ï¼Œé€‚å½“å¢å¤§ï¼Œå¯ä»¥æé«˜æ€§èƒ½ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼256kbï¼›å»ºè®®å€¼ï¼šå¾—å‚è€ƒè¿æ¥æ•°ï¼Œ16Gå†…å­˜ï¼Œæœ‰äººæ¨è8M</span></span><br><span class="line"><span class="comment"># æ³¨æ„ï¼Œè¯¥ç¼“å†²åŒºæ˜¯æ¯ä¸ªè¿æ¥ç‹¬å çš„ï¼Œæ‰€ä»¥æ€»ç¼“å†²åŒºå¤§å°ä¸º128kb*è¿æ¥æ•°ï¼›æç«¯æƒ…å†µ128kb*maxconnectiosnsï¼Œä¼šè¶…çº§å¤§ï¼Œæ‰€ä»¥è¦è€ƒè™‘æ—¥å¸¸å¹³å‡è¿æ¥æ•°ã€‚</span></span><br><span class="line">read_rnd_buffer_size = 8M</span><br><span class="line"></span><br><span class="line"><span class="comment"># MyISAMè®¾ç½®æ¢å¤è¡¨ä¹‹æ—¶ä½¿ç”¨çš„ç¼“å†²åŒºçš„å°ºå¯¸ï¼Œå½“åœ¨REPAIR TABLEæˆ–ç”¨CREATE INDEXåˆ›å»ºç´¢å¼•æˆ–ALTER TABLEè¿‡ç¨‹ä¸­æ’åºMyISAMç´¢å¼•åˆ†é…çš„ç¼“å†²åŒºè®¾ç½®å¤ªå°æ—¶å¯èƒ½ä¼šé‡åˆ°â€ myisam_sort_buffer_size is too smallâ€</span></span><br><span class="line">myisam_sort_buffer_size = 64M</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœä¸´æ—¶æ–‡ä»¶ä¼šå˜å¾—è¶…è¿‡ç´¢å¼•ï¼Œä¸è¦ä½¿ç”¨å¿«é€Ÿæ’åºç´¢å¼•æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªç´¢å¼•ã€‚æ³¨é‡Šï¼šè¿™ä¸ªå‚æ•°ä»¥å­—èŠ‚çš„å½¢å¼ç»™å‡º</span></span><br><span class="line">myisam_max_sort_file_size = 10G</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœè¯¥å€¼å¤§äº1ï¼Œåœ¨Repair by sortingè¿‡ç¨‹ä¸­å¹¶è¡Œåˆ›å»ºMyISAMè¡¨ç´¢å¼•(æ¯ä¸ªç´¢å¼•åœ¨è‡ªå·±çš„çº¿ç¨‹å†…)</span></span><br><span class="line">myisam_repair_threads = 1 </span><br><span class="line"></span><br><span class="line"><span class="comment"># çº¿ç¨‹æ± ï¼Œçº¿ç¨‹ç¼“å­˜ã€‚ç”¨æ¥ç¼“å­˜ç©ºé—²çš„çº¿ç¨‹ï¼Œä»¥è‡³äºä¸è¢«é”€æ¯ï¼Œå¦‚æœçº¿ç¨‹ç¼“å­˜åœ¨çš„ç©ºé—²çº¿ç¨‹ï¼Œéœ€è¦é‡æ–°å»ºç«‹æ–°è¿æ¥ï¼Œåˆ™ä¼šä¼˜å…ˆè°ƒç”¨çº¿ç¨‹æ± ä¸­çš„ç¼“å­˜ï¼Œå¾ˆå¿«å°±èƒ½å“åº”è¿æ¥è¯·æ±‚ã€‚æ¯å»ºç«‹ä¸€ä¸ªè¿æ¥ï¼Œéƒ½éœ€è¦ä¸€ä¸ªçº¿ç¨‹ä¸ä¹‹åŒ¹é…ã€‚</span></span><br><span class="line"><span class="comment"># è¿™ä¸ªå€¼ï¼ˆé»˜è®¤8ï¼‰è¡¨ç¤ºå¯ä»¥é‡æ–°åˆ©ç”¨ä¿å­˜åœ¨ç¼“å­˜ä¸­çº¿ç¨‹çš„æ•°é‡ï¼Œå½“æ–­å¼€è¿æ¥æ—¶å¦‚æœç¼“å­˜ä¸­è¿˜æœ‰ç©ºé—´ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯çš„çº¿ç¨‹å°†è¢«æ”¾åˆ°ç¼“å­˜ä¸­ï¼Œ  </span></span><br><span class="line"><span class="comment"># å¦‚æœçº¿ç¨‹é‡æ–°è¢«è¯·æ±‚ï¼Œé‚£ä¹ˆè¯·æ±‚å°†ä»ç¼“å­˜ä¸­è¯»å–,å¦‚æœç¼“å­˜ä¸­æ˜¯ç©ºçš„æˆ–è€…æ˜¯æ–°çš„è¯·æ±‚ï¼Œé‚£ä¹ˆè¿™ä¸ªçº¿ç¨‹å°†è¢«é‡æ–°åˆ›å»º,å¦‚æœæœ‰å¾ˆå¤šæ–°çš„çº¿ç¨‹ï¼Œ  </span></span><br><span class="line"><span class="comment"># å¢åŠ è¿™ä¸ªå€¼å¯ä»¥æ”¹å–„ç³»ç»Ÿæ€§èƒ½.é€šè¿‡æ¯”è¾ƒConnectionså’ŒThreads_createdçŠ¶æ€çš„å˜é‡ï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªå˜é‡çš„ä½œç”¨ã€‚(â€“&gt;è¡¨ç¤ºè¦è°ƒæ•´çš„å€¼)  </span></span><br><span class="line"><span class="comment"># æ ¹æ®ç‰©ç†å†…å­˜è®¾ç½®è§„åˆ™å¦‚ä¸‹ï¼š  </span></span><br><span class="line"><span class="comment"># 1G  â€”&gt; 8  </span></span><br><span class="line"><span class="comment"># 2G  â€”&gt; 16  </span></span><br><span class="line"><span class="comment"># 3G  â€”&gt; 32  </span></span><br><span class="line"><span class="comment"># å¤§äº3G  â€”&gt; 64</span></span><br><span class="line"><span class="comment"># å½“å®¢æˆ·ç«¯æ–­å¼€ä¹‹åï¼ŒæœåŠ¡å™¨å¤„ç†æ­¤å®¢æˆ·çš„çº¿ç¨‹å°†ä¼šç¼“å­˜èµ·æ¥ä»¥å“åº”ä¸‹ä¸€ä¸ªå®¢æˆ·è€Œä¸æ˜¯é”€æ¯ã€‚å¯é‡ç”¨ï¼Œå‡å°äº†ç³»ç»Ÿå¼€é”€ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ä¸º9ï¼Œå»ºè®®å€¼ï¼šä¸¤ç§å–å€¼æ–¹å¼ï¼Œæ–¹å¼ä¸€ï¼Œæ ¹æ®ç‰©ç†å†…å­˜ï¼Œ1G  â€”&gt; 8ï¼›2G  â€”&gt; 16ï¼› 3G  â€”&gt; 32ï¼› &gt;3G  â€”&gt; 64ï¼›</span></span><br><span class="line"><span class="comment"># æ–¹å¼äºŒï¼Œæ ¹æ®show status like  &#x27;threads%&#x27;ï¼ŒæŸ¥çœ‹Threads_connectedå€¼ã€‚</span></span><br><span class="line">thread_cache_size = 64</span><br><span class="line"></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼256k,å»ºè®®å€¼ï¼š16/32Gå†…å­˜ï¼Œ512kbï¼Œå…¶ä»–ä¸€èˆ¬ä¸æ”¹å˜ï¼Œå¦‚æœæŠ¥é”™ï¼šThread stack overrunï¼Œå°±å¢å¤§çœ‹çœ‹,</span></span><br><span class="line"><span class="comment"># æ³¨æ„ï¼Œæ¯ä¸ªçº¿ç¨‹åˆ†é…å†…å­˜ç©ºé—´ï¼Œæ‰€ä»¥æ€»å†…å­˜ç©ºé—´ã€‚ã€‚ã€‚ä½ æ‡‚å¾—ã€‚</span></span><br><span class="line">thread_stack = 512k</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼“å­˜selectè¯­å¥å’Œç»“æœé›†å¤§å°çš„å‚æ•°ï¼ŒæŸ¥è¯¢ç¼“å­˜ä¼šå­˜å‚¨ä¸€ä¸ªselectæŸ¥è¯¢çš„æ–‡æœ¬ä¸è¢«ä¼ é€åˆ°å®¢æˆ·ç«¯çš„ç›¸åº”ç»“æœã€‚å¦‚æœä¹‹åæ¥æ”¶åˆ°ä¸€ä¸ªç›¸åŒçš„æŸ¥è¯¢ï¼ŒæœåŠ¡å™¨ä¼šä»æŸ¥è¯¢ç¼“å­˜ä¸­æ£€ç´¢ç»“æœï¼Œè€Œä¸æ˜¯å†æ¬¡åˆ†æå’Œæ‰§è¡Œè¿™ä¸ªåŒæ ·çš„æŸ¥è¯¢ã€‚å¦‚æœä½ çš„ç¯å¢ƒä¸­å†™æ“ä½œå¾ˆå°‘ï¼Œè¯»æ“ä½œé¢‘ç¹ï¼Œé‚£ä¹ˆæ‰“å¼€query_cache_type=1ï¼Œä¼šå¯¹æ€§èƒ½æœ‰æ˜æ˜¾æå‡ã€‚å¦‚æœå†™æ“ä½œé¢‘ç¹ï¼Œåˆ™åº”è¯¥å…³é—­å®ƒï¼ˆquery_cache_type=0ï¼‰ã€‚</span></span><br><span class="line"><span class="comment"># ä»Šåå¯¹äºåŒæ ·çš„SELECTè¯­å¥ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰ï¼Œå°†ç›´æ¥ä»ç¼“å†²åŒºä¸­è¯»å–ç»“æœã€‚æ ¹æ®MySQLç”¨æˆ·æ‰‹å†Œï¼Œä½¿ç”¨æŸ¥è¯¢ç¼“å†²æœ€å¤šå¯ä»¥è¾¾åˆ°238%çš„æ•ˆç‡ã€‚  </span></span><br><span class="line"><span class="comment"># é€šè¿‡æ£€æŸ¥çŠ¶æ€å€¼&#x27;Qcache_%&#x27;ï¼Œå¯ä»¥çŸ¥é“query_cache_sizeè®¾ç½®æ˜¯å¦åˆç†ï¼šå¦‚æœQcache_lowmem_prunesçš„å€¼éå¸¸å¤§ï¼Œåˆ™è¡¨æ˜ç»å¸¸å‡ºç°ç¼“å†²ä¸å¤Ÿçš„æƒ…å†µï¼Œ  </span></span><br><span class="line"><span class="comment"># å¦‚æœQcache_hitsçš„å€¼ä¹Ÿéå¸¸å¤§ï¼Œåˆ™è¡¨æ˜æŸ¥è¯¢ç¼“å†²ä½¿ç”¨éå¸¸é¢‘ç¹ï¼Œæ­¤æ—¶éœ€è¦å¢åŠ ç¼“å†²å¤§å°ï¼›å¦‚æœQcache_hitsçš„å€¼ä¸å¤§ï¼Œåˆ™è¡¨æ˜ä½ çš„æŸ¥è¯¢é‡å¤ç‡å¾ˆä½ï¼Œ  </span></span><br><span class="line"><span class="comment"># è¿™ç§æƒ…å†µä¸‹ä½¿ç”¨æŸ¥è¯¢ç¼“å†²åè€Œä¼šå½±å“æ•ˆç‡ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘ä¸ç”¨æŸ¥è¯¢ç¼“å†²ã€‚æ­¤å¤–ï¼Œåœ¨SELECTè¯­å¥ä¸­åŠ å…¥SQL_NO_CACHEå¯ä»¥æ˜ç¡®è¡¨ç¤ºä¸ä½¿ç”¨æŸ¥è¯¢ç¼“å†²</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼1Mï¼Œä¼˜ç‚¹æ˜¯æŸ¥è¯¢ç¼“å†²å¯ä»¥æå¤§çš„æé«˜æœåŠ¡å™¨é€Ÿåº¦, å¦‚æœä½ æœ‰å¤§é‡çš„ç›¸åŒçš„æŸ¥è¯¢å¹¶ä¸”å¾ˆå°‘ä¿®æ”¹è¡¨ã€‚</span></span><br><span class="line"><span class="comment"># ç¼ºç‚¹ï¼šåœ¨ä½ è¡¨ç»å¸¸å˜åŒ–çš„æƒ…å†µä¸‹æˆ–è€…å¦‚æœä½ çš„æŸ¥è¯¢åŸæ–‡æ¯æ¬¡éƒ½ä¸åŒ,æŸ¥è¯¢ç¼“å†²ä¹Ÿè®¸å¼•èµ·æ€§èƒ½ä¸‹é™è€Œä¸æ˜¯æ€§èƒ½æå‡ã€‚</span></span><br><span class="line">query_cache_size = 32M  </span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‡å®šå•ä¸ªæŸ¥è¯¢èƒ½å¤Ÿä½¿ç”¨çš„ç¼“å†²åŒºå¤§å°ï¼Œé»˜è®¤1Mã€‚</span></span><br><span class="line"><span class="comment"># åªæœ‰å°äºæ­¤è®¾å®šå€¼çš„ç»“æœæ‰ä¼šè¢«ç¼“å†²ï¼Œä¿æŠ¤æŸ¥è¯¢ç¼“å†²,é˜²æ­¢ä¸€ä¸ªæå¤§çš„ç»“æœé›†å°†å…¶ä»–æ‰€æœ‰çš„æŸ¥è¯¢ç»“æœéƒ½è¦†ç›–ã€‚</span></span><br><span class="line">query_cache_limit = 2M</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¯ä¸ªè¢«ç¼“å­˜çš„ç»“æœé›†è¦å ç”¨çš„æœ€å°å†…å­˜,é»˜è®¤å€¼4kbï¼Œä¸€èˆ¬ä¸æ€ä¹ˆè°ƒæ•´ã€‚</span></span><br><span class="line"><span class="comment"># å¦‚æœQcache_free_blockså€¼è¿‡å¤§ï¼Œå¯èƒ½æ˜¯query_cache_min_res_unitå€¼è¿‡å¤§ï¼Œåº”è¯¥è°ƒå°äº›</span></span><br><span class="line"><span class="comment"># query_cache_min_res_unitçš„ä¼°è®¡å€¼ï¼š(query_cache_size - Qcache_free_memory) / Qcache_queries_in_cache</span></span><br><span class="line">query_cache_min_res_unit = 4kb</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸´æ—¶HEAPæ•°æ®è¡¨çš„æœ€å¤§é•¿åº¦(é»˜è®¤è®¾ç½®æ˜¯32M)ï¼Œ</span></span><br><span class="line"><span class="comment"># MySQLçš„heapï¼ˆå †ç§¯ï¼‰è¡¨ç¼“å†²å¤§å°ã€‚æ‰€æœ‰è”åˆåœ¨ä¸€ä¸ªDMLæŒ‡ä»¤å†…å®Œæˆï¼Œå¹¶ä¸”å¤§å¤šæ•°è”åˆç”šè‡³å¯ä»¥ä¸ç”¨ä¸´æ—¶è¡¨å³å¯ä»¥å®Œæˆã€‚  </span></span><br><span class="line"><span class="comment"># å¤§å¤šæ•°ä¸´æ—¶è¡¨æ˜¯åŸºäºå†…å­˜çš„(HEAP)è¡¨ã€‚å…·æœ‰å¤§çš„è®°å½•é•¿åº¦çš„ä¸´æ—¶è¡¨ (æ‰€æœ‰åˆ—çš„é•¿åº¦çš„å’Œ)æˆ–åŒ…å«BLOBåˆ—çš„è¡¨å­˜å‚¨åœ¨ç¡¬ç›˜ä¸Šã€‚  </span></span><br><span class="line"><span class="comment"># å¦‚æœæŸä¸ªå†…éƒ¨heapï¼ˆå †ç§¯ï¼‰è¡¨å¤§å°è¶…è¿‡tmp_table_sizeï¼ŒMySQLå¯ä»¥æ ¹æ®éœ€è¦è‡ªåŠ¨å°†å†…å­˜ä¸­çš„heapè¡¨æ”¹ä¸ºåŸºäºç¡¬ç›˜çš„MyISAMè¡¨ã€‚è¿˜å¯ä»¥é€šè¿‡è®¾ç½®tmp_table_sizeé€‰é¡¹æ¥å¢åŠ ä¸´æ—¶è¡¨çš„å¤§å°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœè°ƒé«˜è¯¥å€¼ï¼ŒMySQLåŒæ—¶å°†å¢åŠ heapè¡¨çš„å¤§å°ï¼Œå¯è¾¾åˆ°æé«˜è”æ¥æŸ¥è¯¢é€Ÿåº¦çš„æ•ˆæœ</span></span><br><span class="line"><span class="comment"># å†…å­˜ä¸´æ—¶è¡¨çš„æœ€å¤§å€¼,é»˜è®¤16M</span></span><br><span class="line">tmp_table_size = 64M  </span><br><span class="line"></span><br><span class="line"><span class="comment"># è”åˆæŸ¥è¯¢æ“ä½œæ‰€èƒ½ä½¿ç”¨çš„ç¼“å†²åŒºå¤§å°ï¼Œå’Œsort_buffer_sizeä¸€æ ·ï¼Œè¯¥å‚æ•°å¯¹åº”çš„åˆ†é…å†…å­˜ä¹Ÿæ˜¯æ¯è¿æ¥ç‹¬äº«</span></span><br><span class="line"><span class="comment"># æ­¤ç¼“å†²è¢«ä½¿ç”¨æ¥ä¼˜åŒ–å…¨è”åˆ(full JOINs ä¸å¸¦ç´¢å¼•çš„è”åˆ)</span></span><br><span class="line"><span class="comment"># ç±»ä¼¼çš„è”åˆåœ¨æå¤§å¤šæ•°æƒ…å†µä¸‹æœ‰éå¸¸ç³Ÿç³•çš„æ€§èƒ½è¡¨ç°,ä½†æ˜¯å°†æ­¤å€¼è®¾å¤§èƒ½å¤Ÿå‡è½»æ€§èƒ½å½±å“.</span></span><br><span class="line"><span class="comment"># é€šè¿‡ â€œSelect_full_joinâ€ çŠ¶æ€å˜é‡æŸ¥çœ‹å…¨è”åˆçš„æ•°é‡</span></span><br><span class="line"><span class="comment"># æ³¨æ„ï¼Œè¯¥ç¼“å†²åŒºæ˜¯æ¯ä¸ªè¿æ¥ç‹¬å çš„ï¼Œæ‰€ä»¥æ€»ç¼“å†²åŒºå¤§å°ä¸º 1M*è¿æ¥æ•°ï¼›æç«¯æƒ…å†µ1M*maxconnectiosnsï¼Œä¼šè¶…çº§å¤§ã€‚æ‰€ä»¥è¦è€ƒè™‘æ—¥å¸¸å¹³å‡è¿æ¥æ•°ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼256kb;å»ºè®®å€¼ï¼š16Gå†…å­˜ï¼Œè®¾ç½®8M.</span></span><br><span class="line">join_buffer_size = 64M</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯¥å€¼ä¸€èˆ¬å»ºè®®è®¾å®šcpuçš„ä¸ªæ•°*2</span></span><br><span class="line">thread_concurrency = 4</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ†è¯è¯æ±‡æœ€å°é•¿åº¦ï¼Œé»˜è®¤å€¼ä¸º4  </span></span><br><span class="line">ft_min_word_len = 4</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¯å¦æ˜¾ç¤ºé»˜è®¤æ—¶é—´æˆ³ï¼Œtrueæ˜¯æ˜¾ç¤º</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ä¸ºoff,timestampåˆ—ä¼šè‡ªåŠ¨æ›´æ–°ä¸ºå½“å‰æ—¶é—´ï¼Œè®¾ç½®ä¸ºon|1ï¼Œtimestampåˆ—çš„å€¼å°±è¦æ˜¾å¼æ›´æ–°</span></span><br><span class="line">explicit_defaults_for_timestamp = true</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å¯è¯¥é€‰é¡¹åå°±ä¸èƒ½è¿œç¨‹è®¿é—®MySQL</span></span><br><span class="line"><span class="comment"># ä¸ºå®‰å…¨è€ƒè™‘å¸Œæœ›æŒ‡å®šçš„IPè®¿é—®MySQLï¼Œå¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­å¢åŠ bind-address=IPï¼Œå‰ææ˜¯å…³é—­skip-networking</span></span><br><span class="line"><span class="comment"># skip-networking</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¡¨ç¤ºç›‘å¬IPV4åœ°å€</span></span><br><span class="line">bind-address=192.168.1.146</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯¥å‚æ•°æ˜¯ç”¨æ¥è®¾å®šmysqlçš„æœ€å¤§è¿æ¥æ•°ï¼Œé»˜è®¤ä¸º100ï¼Œä¸€èˆ¬è®¾ç½®ä¸º512-1000å³å¯ã€‚å¤ªå¤šçš„è¿æ¥ä¼šå¯¼è‡´å†…å­˜çš„ä½¿ç”¨é‡è¿‡é«˜å¹¶ä¸”ä¼šé”ä½ä½ çš„MySQLæœåŠ¡å™¨ã€‚ä¸€èˆ¬å°å‹ç½‘ç«™éœ€è¦100-200çš„è¿æ¥æ•°ï¼Œè€Œè¾ƒå¤§å¯èƒ½éœ€è¦500-800ç”šè‡³æ›´å¤šã€‚è¿™é‡Œçš„å€¼å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºä½  MySQL/MariaDB çš„ä½¿ç”¨æƒ…å†µã€‚</span></span><br><span class="line"><span class="comment"># å¦‚æœæœåŠ¡å™¨çš„å¹¶å‘è¿æ¥è¯·æ±‚é‡æ¯”è¾ƒå¤§ï¼Œå»ºè®®è°ƒé«˜æ­¤å€¼ï¼Œä»¥å¢åŠ å¹¶è¡Œè¿æ¥æ•°é‡ï¼Œå½“ç„¶è¿™å»ºç«‹åœ¨æœºå™¨èƒ½æ”¯æ’‘çš„æƒ…å†µä¸‹ï¼Œå› ä¸ºå¦‚æœè¿æ¥æ•°è¶Šå¤šï¼Œä»‹äºMySQLä¼šä¸ºæ¯ä¸ªè¿æ¥æä¾›è¿æ¥ç¼“å†²åŒºï¼Œå°±ä¼šå¼€é”€è¶Šå¤šçš„å†…å­˜ï¼Œæ‰€ä»¥è¦é€‚å½“è°ƒæ•´è¯¥å€¼ï¼Œä¸èƒ½ç›²ç›®æé«˜è®¾å€¼ã€‚å¯ä»¥è¿‡&#x27;conn%&#x27;é€šé…ç¬¦æŸ¥çœ‹å½“å‰çŠ¶æ€çš„è¿æ¥æ•°é‡ï¼Œä»¥å®šå¤ºè¯¥å€¼çš„å¤§å°ã€‚</span></span><br><span class="line"><span class="comment"># æœ€å¤§è¿æ¥æ•°ï¼Œå¯è®¾æœ€å¤§å€¼16384ï¼Œä¸€èˆ¬è€ƒè™‘æ ¹æ®åŒæ—¶åœ¨çº¿äººæ•°è®¾ç½®ä¸€ä¸ªæ¯”è¾ƒç»¼åˆçš„æ•°å­—ï¼Œé‰´äºè¯¥æ•°å€¼å¢å¤§å¹¶ä¸å¤ªæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œå»ºè®®ç›´æ¥è®¾10000</span></span><br><span class="line"><span class="comment"># å¦‚æœåœ¨è®¿é—®æ—¶ç»å¸¸å‡ºç°Too Many Connectionsçš„é”™è¯¯æç¤ºï¼Œåˆ™éœ€è¦å¢å¤§è¯¥å‚æ•°å€¼</span></span><br><span class="line">max_connections = 1000</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœæœ‰æ—¶ç½‘ç»œå¼‚å¸¸æˆ–è€…åº”ç”¨é…ç½®é”™è¯¯ï¼Œæˆ–è€…å…¶ä»–åŸå› å¯¼è‡´å®¢æˆ·ç«¯çŸ­æ—¶é—´å†…ä¸æ–­çš„å°è¯•è¿æ¥ï¼Œè¶…å‡ºè¯¥å‚æ•°å€¼ä¸ªæ•°çš„ä¸­æ–­é”™è¯¯è¿æ¥ã€‚è¯¥ä¸»æœºå°†è¢«ç¦æ­¢è¿æ¥ï¼Œå¯èƒ½ä¼šè¢«åˆ—å…¥é»‘åå•ã€‚ç„¶åå°†æ— æ³•è¿æ¥ï¼Œç›´åˆ°å†æ¬¡åˆ·æ–°ä¸»æœºç¼“å­˜ã€‚å¦‚éœ€å¯¹è¯¥ä¸»æœºè¿›è¡Œè§£ç¦éœ€æ‰§è¡ŒFLUSH HOSTã€‚è¿™ä¸ªé€‰é¡¹é»˜è®¤å€¼å¤ªå°äº†ï¼Œå¯ä»¥è€ƒè™‘è®¾çš„è¶³å¤Ÿå¤§ï¼ˆå¦‚æœä½ çš„æœåŠ¡å™¨é…ç½®å¤Ÿå¼ºå¤§çš„è¯)ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼100ï¼Œæœ€å¤§é”™è¯¯è¿æ¥æ•°ï¼Œå¦‚æœæœ‰è¶…å‡ºè¯¥å‚æ•°å€¼ä¸ªæ•°çš„ä¸­æ–­é”™è¯¯è¿æ¥ï¼Œåˆ™è¯¥ä¸»æœºå°†è¢«ç¦æ­¢è¿æ¥ã€‚å¦‚éœ€å¯¹è¯¥ä¸»æœºè¿›è¡Œè§£ç¦ï¼Œæ‰§è¡Œï¼šFLUSH HOST</span></span><br><span class="line"><span class="comment"># è€ƒè™‘é«˜å¹¶å‘åœºæ™¯ä¸‹çš„å®¹é”™ï¼Œå»ºè®®åŠ å¤§ã€‚</span></span><br><span class="line">max_connect_errors = 1000</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾å®šmysqlæ‰“å¼€æœ€å¤§æ–‡ä»¶æ•°ï¼ŒMySQLæ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦é™åˆ¶ï¼Œé»˜è®¤æœ€å°1024ï¼Œå½“open_files_limitæ²¡æœ‰è¢«é…ç½®çš„æ—¶å€™ï¼Œæ¯”è¾ƒmax_connections*5å’Œulimit -nçš„å€¼ï¼Œå“ªä¸ªå¤§ç”¨å“ªä¸ªã€‚</span></span><br><span class="line"><span class="comment"># æ³¨æ„ï¼šä»ç„¶å¯èƒ½å‡ºç°æŠ¥é”™ä¿¡æ¯Can&#x27;t create a new threadï¼›æ­¤æ—¶è§‚å¯Ÿç³»ç»Ÿcat /proc/mysqlè¿›ç¨‹å·/limitsï¼Œè§‚å¯Ÿè¿›ç¨‹ulimité™åˆ¶æƒ…å†µ</span></span><br><span class="line"><span class="comment"># è¿‡å°çš„è¯ï¼Œè€ƒè™‘ä¿®æ”¹ç³»ç»Ÿé…ç½®è¡¨ï¼Œ/etc/security/limits.confå’Œ/etc/security/limits.d/90-nproc.conf </span></span><br><span class="line">open_files_limit = 65535</span><br><span class="line"></span><br><span class="line"><span class="comment"># äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œé»˜è®¤ä¸ºå¯é‡å¤è¯»ï¼ˆREPEATABLE-READï¼‰ã€‚ï¼ˆæ­¤çº§åˆ«ä¸‹å¯èƒ½å‚æ•°å¾ˆå¤šé—´éš™é”ï¼Œå½±å“æ€§èƒ½ï¼Œä½†æ˜¯ä¿®æ”¹åˆå½±å“ä¸»ä»å¤åˆ¶åŠç¾éš¾æ¢å¤ï¼Œå»ºè®®è¿˜æ˜¯ä¿®æ”¹ä»£ç é€»è¾‘å§ï¼‰</span></span><br><span class="line"><span class="comment"># éš”ç¦»çº§åˆ«å¯é€‰é¡¹ç›®ï¼šREAD-UNCOMMITTED  READ-COMMITTED  REPEATABLE-READ  SERIALIZABLE</span></span><br><span class="line"><span class="comment"># å¦‚æ²¡æœ‰æŒ‡å®šï¼ŒMySQLé»˜è®¤é‡‡ç”¨çš„æ˜¯REPEATABLE-READï¼ŒORACLEé»˜è®¤çš„æ˜¯READ-COMMITTED</span></span><br><span class="line"><span class="comment"># transaction_isolation = READ-COMMITTED</span></span><br><span class="line">transaction_isolation = REPEATABLE-READ</span><br><span class="line"></span><br><span class="line"><span class="comment"># MySQLçš„äºŒè¿›åˆ¶æ—¥å¿—å¯ä»¥è¯´æ˜¯MySQLæœ€é‡è¦çš„æ—¥å¿—äº†ï¼Œå®ƒè®°å½•äº†æ‰€æœ‰çš„DDLå’ŒDML(é™¤äº†æ•°æ®æŸ¥è¯¢è¯­å¥)è¯­å¥ï¼Œä»¥äº‹ä»¶å½¢å¼è®°å½•ï¼Œè¿˜åŒ…å«è¯­å¥æ‰€æ‰§è¡Œçš„æ¶ˆè€—çš„æ—¶é—´ï¼ŒMySQLçš„äºŒè¿›åˆ¶æ—¥å¿—æ˜¯äº‹åŠ¡å®‰å…¨å‹çš„ã€‚</span></span><br><span class="line"><span class="comment"># ä¸€èˆ¬æ¥è¯´å¼€å¯äºŒè¿›åˆ¶æ—¥å¿—å¤§æ¦‚ä¼šæœ‰1%çš„æ€§èƒ½æŸè€—(å‚è§MySQLå®˜æ–¹ä¸­æ–‡æ‰‹å†Œ 5.1.24ç‰ˆ)ã€‚äºŒè¿›åˆ¶æœ‰ä¸¤ä¸ªæœ€é‡è¦çš„ä½¿ç”¨åœºæ™¯: </span></span><br><span class="line"><span class="comment"># å…¶ä¸€ï¼šMySQL Replicationåœ¨Masterç«¯å¼€å¯binlogï¼ŒMsteræŠŠå®ƒçš„äºŒè¿›åˆ¶æ—¥å¿—ä¼ é€’ç»™slavesæ¥è¾¾åˆ°master-slaveæ•°æ®ä¸€è‡´çš„ç›®çš„ã€‚ </span></span><br><span class="line"><span class="comment"># å…¶äºŒï¼šè‡ªç„¶å°±æ˜¯æ•°æ®æ¢å¤äº†ï¼Œé€šè¿‡ä½¿ç”¨mysqlbinlogå·¥å…·æ¥ä½¿æ¢å¤æ•°æ®ã€‚</span></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ–¹å¼:binlog events in &#x27;mysql-bin.000256&#x27;;</span></span><br><span class="line">log-bin=mysql-bin</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‡å®šæ—¥å¿—æ ¼å¼ä¸ºmixed</span></span><br><span class="line">binlog_format=mixed</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸€ä¸ªäº‹åŠ¡åœ¨æ²¡æœ‰æäº¤çš„æ—¶å€™äº§ç”Ÿçš„æ—¥å¿—ä¼šè®°å½•åˆ°Cacheä¸­ï¼›ç­‰åˆ°äº‹åŠ¡æäº¤éœ€è¦æäº¤çš„æ—¶å€™ï¼Œåˆ™æŠŠæ—¥å¿—æŒä¹…åŒ–åˆ°ç£ç›˜ã€‚è¯¥å€¼é»˜è®¤å¤§å°32Kï¼Œå¯ä»¥è‡ªè¡Œè®¾å®šã€‚</span></span><br><span class="line"><span class="comment"># åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­binlogä¸ºäº†è®°å½•SQLçŠ¶æ€æ‰€æŒæœ‰çš„cacheå¤§å°</span></span><br><span class="line"><span class="comment"># å¦‚æœä½ ç»å¸¸ä½¿ç”¨å¤§çš„,å¤šå£°æ˜çš„äº‹åŠ¡,ä½ å¯ä»¥å¢åŠ æ­¤å€¼æ¥è·å–æ›´å¤§çš„æ€§èƒ½.</span></span><br><span class="line"><span class="comment"># æ‰€æœ‰ä»äº‹åŠ¡æ¥çš„çŠ¶æ€éƒ½å°†è¢«ç¼“å†²åœ¨binlogç¼“å†²ä¸­ç„¶ååœ¨æäº¤åä¸€æ¬¡æ€§å†™å…¥åˆ°binlogä¸­</span></span><br><span class="line"><span class="comment"># å¦‚æœäº‹åŠ¡æ¯”æ­¤å€¼å¤§, ä¼šä½¿ç”¨ç£ç›˜ä¸Šçš„ä¸´æ—¶æ–‡ä»¶æ¥æ›¿ä»£.</span></span><br><span class="line"><span class="comment"># æ­¤ç¼“å†²åœ¨æ¯ä¸ªè¿æ¥çš„äº‹åŠ¡ç¬¬ä¸€æ¬¡æ›´æ–°çŠ¶æ€æ—¶è¢«åˆ›å»º</span></span><br><span class="line">binlog_cache_size = 64M</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰äº†ç”¨æˆ·å¯ä»¥åˆ›å»ºçš„å†…å­˜è¡¨(memory table)çš„å¤§å°ã€‚è¿™ä¸ªå€¼ç”¨æ¥è®¡ç®—å†…å­˜è¡¨çš„æœ€å¤§è¡Œæ•°å€¼ã€‚è¿™ä¸ªå˜é‡æ”¯æŒåŠ¨æ€æ”¹å˜</span></span><br><span class="line"><span class="comment"># ç”¨æˆ·åˆ›å»ºçš„å†…å­˜è¡¨çš„å¤§å°ï¼Œé»˜è®¤16Mï¼Œå¾€å¾€å’Œtmp_table_sizeä¸€èµ·è®¾ç½®ï¼Œé™åˆ¶ç”¨æˆ·ä¸´å¸ˆè¡¨å¤§å°ã€‚</span></span><br><span class="line"><span class="comment"># è¶…é™çš„è¯ï¼ŒMySQLå°±ä¼šè‡ªåŠ¨åœ°æŠŠå®ƒè½¬åŒ–ä¸ºåŸºäºç£ç›˜çš„MyISAMè¡¨ï¼Œå­˜å‚¨åœ¨æŒ‡å®šçš„tmpdirç›®å½•ä¸‹ï¼Œå¢å¤§IOå‹åŠ›ï¼Œå»ºè®®å†…å­˜å¤§ï¼Œå¢å¤§è¯¥æ•°å€¼ã€‚</span></span><br><span class="line">max_heap_table_size = 8M</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¡¨ç¤ºè¿™ä¸ªmysqlç‰ˆæœ¬æ˜¯å¦æ”¯æŒæŸ¥è¯¢ç¼“å­˜ã€‚psï¼šSHOW STATUS LIKE &#x27;qcache%&#x27;ï¼Œä¸ç¼“å­˜ç›¸å…³çš„çŠ¶æ€å˜é‡ã€‚</span></span><br><span class="line"><span class="comment"># have_query_cache</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™ä¸ªç³»ç»Ÿå˜é‡æ§åˆ¶ç€æŸ¥è¯¢ç¼“å­˜å·¥èƒ½çš„å¼€å¯çš„å…³é—­ï¼Œ0æ—¶è¡¨ç¤ºå…³é—­ï¼Œ1æ—¶è¡¨ç¤ºæ‰“å¼€ï¼Œ2è¡¨ç¤ºåªè¦select ä¸­æ˜ç¡®æŒ‡å®šSQL_CACHEæ‰ç¼“å­˜ã€‚</span></span><br><span class="line"><span class="comment"># çœ‹ä¸šåŠ¡åœºæ™¯å†³å®šæ˜¯å¦ä½¿ç”¨ç¼“å­˜ï¼Œä¸ä½¿ç”¨ï¼Œä¸‹é¢å°±ä¸ç”¨é…ç½®äº†ã€‚</span></span><br><span class="line">query_cache_type = 0 </span><br><span class="line"></span><br><span class="line"><span class="comment"># è¡¨ç¤ºæ˜¯æœ¬æœºçš„åºå·ä¸º1,ç»™æœåŠ¡å™¨åˆ†é…ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„IDç¼–å·; nçš„å–å€¼èŒƒå›´æ˜¯1~2çš„32æ¬¡æ–¹å¯ç”¨äºŒè¿›åˆ¶æ—¥å¿—åŠŸèƒ½ã€‚åœ¨å¤åˆ¶æ•°æ®åŒæ­¥çš„æ—¶å€™ä¼šç”¨åˆ°ï¼Œä¸€èˆ¬æ¥è®²å°±æ˜¯masterçš„æ„æ€</span></span><br><span class="line">server-id = 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®åº“å¼•æ“ä¸å­—ç¬¦é›†ç›¸å…³è®¾ç½®</span></span><br><span class="line"><span class="comment"># mysql 5.1 ä¹‹åï¼Œé»˜è®¤å¼•æ“å°±æ˜¯InnoDBäº†</span></span><br><span class="line">default_storage_engine = InnoDB</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†…å­˜ä¸´æ—¶è¡¨é»˜è®¤å¼•æ“ï¼Œé»˜è®¤InnoDB</span></span><br><span class="line">default_tmp_storage_engine = InnoDB</span><br><span class="line"></span><br><span class="line"><span class="comment"># mysql 5.7æ–°å¢ç‰¹æ€§ï¼Œç£ç›˜ä¸´æ—¶è¡¨é»˜è®¤å¼•æ“ï¼Œé»˜è®¤InnoDB</span></span><br><span class="line">internal_tmp_disk_storage_engine = InnoDB</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®åº“é»˜è®¤å­—ç¬¦é›†,ä¸»æµå­—ç¬¦é›†æ”¯æŒä¸€äº›ç‰¹æ®Šè¡¨æƒ…ç¬¦å·ï¼ˆç‰¹æ®Šè¡¨æƒ…ç¬¦å ç”¨4ä¸ªå­—èŠ‚ï¼‰</span></span><br><span class="line">character-set-server = utf8</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®åº“å­—ç¬¦é›†å¯¹åº”ä¸€äº›æ’åºç­‰è§„åˆ™ï¼Œæ³¨æ„è¦å’Œcharacter-set-serverå¯¹åº”</span></span><br><span class="line">collation-server = utf8_general_ci</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®clientè¿æ¥mysqlæ—¶çš„å­—ç¬¦é›†,é˜²æ­¢ä¹±ç </span></span><br><span class="line"><span class="comment"># init_connect=&#x27;SET NAMES utf8&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¯å¦å¯¹sqlè¯­å¥å¤§å°å†™æ•æ„Ÿï¼Œé»˜è®¤å€¼ä¸º0ï¼Œ1è¡¨ç¤ºä¸æ•æ„Ÿ</span></span><br><span class="line">lower_case_table_names = 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœåŠ¡å™¨å…³é—­äº¤äº’å¼è¿æ¥å‰ç­‰å¾…æ´»åŠ¨çš„ç§’æ•°ã€‚äº¤äº’å¼å®¢æˆ·ç«¯å®šä¹‰ä¸ºåœ¨mysql_real_connect()ä¸­ä½¿ç”¨CLIENT_INTERACTIVEé€‰é¡¹çš„å®¢æˆ·ç«¯ã€‚é»˜è®¤å€¼ï¼š28800ç§’ï¼ˆ8å°æ—¶ï¼‰</span></span><br><span class="line"><span class="comment"># MySQLé»˜è®¤çš„wait_timeout  å€¼ä¸º8ä¸ªå°æ—¶, interactive_timeoutå‚æ•°éœ€è¦åŒæ—¶é…ç½®æ‰èƒ½ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="comment"># MySQLè¿æ¥é—²ç½®è¶…è¿‡ä¸€å®šæ—¶é—´å(å•ä½ï¼šç§’ï¼Œæ­¤å¤„ä¸º1800ç§’)å°†ä¼šè¢«å¼ºè¡Œå…³é—­</span></span><br><span class="line">interactive_timeout = 28800</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœåŠ¡å™¨å…³é—­éäº¤äº’è¿æ¥ä¹‹å‰ç­‰å¾…æ´»åŠ¨çš„ç§’æ•°ã€‚åœ¨çº¿ç¨‹å¯åŠ¨æ—¶ï¼Œæ ¹æ®å…¨å±€wait_timeoutå€¼æˆ–å…¨å±€interactive_timeoutå€¼åˆå§‹åŒ–ä¼šè¯wait_timeoutå€¼ï¼Œ  </span></span><br><span class="line"><span class="comment"># å–å†³äºå®¢æˆ·ç«¯ç±»å‹(ç”±mysql_real_connect()çš„è¿æ¥é€‰é¡¹CLIENT_INTERACTIVEå®šä¹‰)ã€‚å‚æ•°é»˜è®¤å€¼ï¼š28800ç§’ï¼ˆ8å°æ—¶ï¼‰  </span></span><br><span class="line"><span class="comment"># MySQLæœåŠ¡å™¨æ‰€æ”¯æŒçš„æœ€å¤§è¿æ¥æ•°æ˜¯æœ‰ä¸Šé™çš„ï¼Œå› ä¸ºæ¯ä¸ªè¿æ¥çš„å»ºç«‹éƒ½ä¼šæ¶ˆè€—å†…å­˜ï¼Œå› æ­¤æˆ‘ä»¬å¸Œæœ›å®¢æˆ·ç«¯åœ¨è¿æ¥åˆ°MySQL Serverå¤„ç†å®Œç›¸åº”çš„æ“ä½œåï¼Œ  </span></span><br><span class="line"><span class="comment"># åº”è¯¥æ–­å¼€è¿æ¥å¹¶é‡Šæ”¾å ç”¨çš„å†…å­˜ã€‚å¦‚æœä½ çš„MySQL Serveræœ‰å¤§é‡çš„é—²ç½®è¿æ¥ï¼Œä»–ä»¬ä¸ä»…ä¼šç™½ç™½æ¶ˆè€—å†…å­˜ï¼Œè€Œä¸”å¦‚æœè¿æ¥ä¸€ç›´åœ¨ç´¯åŠ è€Œä¸æ–­å¼€ï¼Œ  </span></span><br><span class="line"><span class="comment"># æœ€ç»ˆè‚¯å®šä¼šè¾¾åˆ°MySQL Serverçš„è¿æ¥ä¸Šé™æ•°ï¼Œè¿™ä¼šæŠ¥&#x27;too many connections&#x27;çš„é”™è¯¯ã€‚å¯¹äºwait_timeoutçš„å€¼è®¾å®šï¼Œåº”è¯¥æ ¹æ®ç³»ç»Ÿçš„è¿è¡Œæƒ…å†µæ¥åˆ¤æ–­ </span></span><br><span class="line"><span class="comment"># åœ¨ç³»ç»Ÿè¿è¡Œä¸€æ®µæ—¶é—´åï¼Œå¯ä»¥é€šè¿‡show processlistå‘½ä»¤æŸ¥çœ‹å½“å‰ç³»ç»Ÿçš„è¿æ¥çŠ¶æ€ï¼Œå¦‚æœå‘ç°æœ‰å¤§é‡çš„sleepçŠ¶æ€çš„è¿æ¥è¿›ç¨‹ï¼Œåˆ™è¯´æ˜è¯¥å‚æ•°è®¾ç½®çš„è¿‡å¤§ï¼Œ  </span></span><br><span class="line"><span class="comment"># å¯ä»¥è¿›è¡Œé€‚å½“çš„è°ƒæ•´å°äº›ã€‚è¦åŒæ—¶è®¾ç½®interactive_timeoutå’Œwait_timeoutæ‰ä¼šç”Ÿæ•ˆã€‚</span></span><br><span class="line">wait_timeout = 28800</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤„ç†ä¸»é”®å†²çª</span></span><br><span class="line"><span class="comment"># mysqlçš„æœåŠ¡å™¨å˜é‡auto_increment_incrementã€å¢é•¿å€¼ã€‘å’Œauto_increment_offsetã€åç§»é‡ã€‘å¯ä»¥åè°ƒå¤šä¸»æœåŠ¡å™¨å¤åˆ¶å’ŒAUTO_INCREMENTåˆ—ã€‚</span></span><br><span class="line"><span class="comment"># å¹¶ä¸”æ¯ä¸ªå˜é‡æœ‰ä¸€ä¸ªé»˜è®¤çš„(å¹¶ä¸”æ˜¯æœ€å°çš„)å€¼1ï¼Œæœ‰ä¸€ä¸ªæœ€å¤§å€¼65,535ã€‚æŠŠè¿™äº›å˜é‡è®¾ç½®ä¸ºéå†²çªçš„å€¼ï¼Œä¾‹å¦‚åœ¨åŒ ä¸€ä¸ªè¡¨æ’å…¥æ–°è¡Œæ—¶ï¼Œ</span></span><br><span class="line"><span class="comment"># å¤šä¸»æœåŠ¡å™¨é…ç½®ä¸»çš„æœåŠ¡å™¨å°±ä¸ä¼šå‘ç”ŸAUTO_INCREMENTå€¼å†²çªï¼Œè¿™é‡Œå°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜</span></span><br><span class="line">auto-increment-increment = 2</span><br><span class="line">auto-increment-offset = 2</span><br><span class="line"></span><br><span class="line"><span class="comment"># slave_skip_errorsè·³è¿‡å¤åˆ¶é”™è¯¯é€‰é¡¹æœ‰å››ä¸ªå¯ç”¨å€¼ï¼Œåˆ†åˆ«ä¸ºï¼šoffï¼Œallï¼ŒErorCodeï¼Œddl_exist_errorsã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤æƒ…å†µä¸‹è¯¥å‚æ•°å€¼æ˜¯offï¼Œæˆ‘ä»¬å¯ä»¥åˆ—å‡ºå…·ä½“çš„error codeï¼Œä¹Ÿå¯ä»¥é€‰æ‹©allï¼Œmysql5.6åŠMySQL Cluster NDB 7.3ä»¥åŠåç»­ç‰ˆæœ¬å¢åŠ äº†å‚æ•°ddl_exist_errorsï¼Œè¯¥å‚æ•°åŒ…å«ä¸€ç³»åˆ—error codeï¼ˆ1007,1008,1050,1051,1054,1060,1061,1068,1094,1146ï¼‰</span></span><br><span class="line"><span class="comment"># ä¸€äº›error codeä»£è¡¨çš„é”™è¯¯å¦‚ä¸‹ï¼š</span></span><br><span class="line">    1007ï¼šæ•°æ®åº“å·²å­˜åœ¨ï¼Œåˆ›å»ºæ•°æ®åº“å¤±è´¥</span><br><span class="line">    1008ï¼šæ•°æ®åº“ä¸å­˜åœ¨ï¼Œåˆ é™¤æ•°æ®åº“å¤±è´¥</span><br><span class="line">    1050ï¼šæ•°æ®è¡¨å·²å­˜åœ¨ï¼Œåˆ›å»ºæ•°æ®è¡¨å¤±è´¥</span><br><span class="line">    1051ï¼šæ•°æ®è¡¨ä¸å­˜åœ¨ï¼Œåˆ é™¤æ•°æ®è¡¨å¤±è´¥</span><br><span class="line">    1054ï¼šå­—æ®µä¸å­˜åœ¨ï¼Œæˆ–ç¨‹åºæ–‡ä»¶è·Ÿæ•°æ®åº“æœ‰å†²çª</span><br><span class="line">    1060ï¼šå­—æ®µé‡å¤ï¼Œå¯¼è‡´æ— æ³•æ’å…¥</span><br><span class="line">    1061ï¼šé‡å¤é”®å</span><br><span class="line">    1068ï¼šå®šä¹‰äº†å¤šä¸ªä¸»é”®</span><br><span class="line">    1094ï¼šä½ç½®çº¿ç¨‹ID</span><br><span class="line">    1146ï¼šæ•°æ®è¡¨ç¼ºå¤±ï¼Œè¯·æ¢å¤æ•°æ®åº“</span><br><span class="line">    1053ï¼šå¤åˆ¶è¿‡ç¨‹ä¸­ä¸»æœåŠ¡å™¨å®•æœº</span><br><span class="line">    1062ï¼šä¸»é”®å†²çª Duplicate entry &#x27;%s&#x27; for key %d</span><br><span class="line">slave_skip_errors=all</span><br><span class="line"></span><br><span class="line">sql_mode=&#x27;ONLY_FULL_GROUP_BY,NO_AUTO_VALUE_ON_ZERO,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,</span><br><span class="line">ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,PIPES_AS_CONCAT,ANSI_QUOTES&#x27;</span><br><span class="line">MySQLçš„sql_modeæ¨¡å¼è¯´æ˜åŠè®¾ç½®</span><br><span class="line">MySQLçš„sql_modeåˆç†è®¾ç½®</span><br><span class="line">sql_modeæ˜¯ä¸ªå¾ˆå®¹æ˜“è¢«å¿½è§†çš„å˜é‡,é»˜è®¤å€¼æ˜¯ç©ºå€¼,åœ¨è¿™ç§è®¾ç½®ä¸‹æ˜¯å¯ä»¥å…è®¸ä¸€äº›éæ³•æ“ä½œçš„,æ¯”å¦‚å…è®¸ä¸€äº›éæ³•æ•°æ®çš„æ’å…¥ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒå¿…é¡»å°†è¿™ä¸ªå€¼è®¾ç½®ä¸ºä¸¥æ ¼æ¨¡å¼,æ‰€ä»¥å¼€å‘ã€æµ‹è¯•ç¯å¢ƒçš„æ•°æ®åº“ä¹Ÿå¿…é¡»è¦è®¾ç½®,è¿™æ ·åœ¨å¼€å‘æµ‹è¯•é˜¶æ®µå°±å¯ä»¥å‘ç°é—®é¢˜.</span><br><span class="line">sql model å¸¸ç”¨æ¥è§£å†³ä¸‹é¢å‡ ç±»é—®é¢˜</span><br><span class="line">(1) é€šè¿‡è®¾ç½®sql mode, å¯ä»¥å®Œæˆä¸åŒä¸¥æ ¼ç¨‹åº¦çš„æ•°æ®æ ¡éªŒï¼Œæœ‰æ•ˆåœ°ä¿éšœæ•°æ®å‡†å¤‡æ€§ã€‚</span><br><span class="line">(2) é€šè¿‡è®¾ç½®sql model ä¸ºå®½æ¾æ¨¡å¼ï¼Œæ¥ä¿è¯å¤§å¤šæ•°sqlç¬¦åˆæ ‡å‡†çš„sqlè¯­æ³•ï¼Œè¿™æ ·åº”ç”¨åœ¨ä¸åŒæ•°æ®åº“ä¹‹é—´è¿›è¡Œè¿ç§»æ—¶ï¼Œåˆ™ä¸éœ€è¦å¯¹ä¸šåŠ¡sql è¿›è¡Œè¾ƒå¤§çš„ä¿®æ”¹ã€‚</span><br><span class="line">(3) åœ¨ä¸åŒæ•°æ®åº“ä¹‹é—´è¿›è¡Œæ•°æ®è¿ç§»ä¹‹å‰ï¼Œé€šè¿‡è®¾ç½®SQL Mode å¯ä»¥ä½¿MySQL ä¸Šçš„æ•°æ®æ›´æ–¹ä¾¿åœ°è¿ç§»åˆ°ç›®æ ‡æ•°æ®åº“ä¸­ã€‚</span><br><span class="line"></span><br><span class="line"><span class="section">sql_modeå¸¸ç”¨å€¼å¦‚ä¸‹: </span></span><br><span class="line"><span class="section">ONLY_FULL_GROUP_BY:</span></span><br><span class="line">å¯¹äºGROUP BYèšåˆæ“ä½œ,å¦‚æœåœ¨SELECTä¸­çš„åˆ—,æ²¡æœ‰åœ¨GROUP BYä¸­å‡ºç°,é‚£ä¹ˆè¿™ä¸ªSQLæ˜¯ä¸åˆæ³•çš„,å› ä¸ºåˆ—ä¸åœ¨GROUP BYä»å¥ä¸­</span><br><span class="line"></span><br><span class="line"><span class="section">NO_AUTO_VALUE_ON_ZERO:</span></span><br><span class="line">è¯¥å€¼å½±å“è‡ªå¢é•¿åˆ—çš„æ’å…¥ã€‚é»˜è®¤è®¾ç½®ä¸‹,æ’å…¥0æˆ–NULLä»£è¡¨ç”Ÿæˆä¸‹ä¸€ä¸ªè‡ªå¢é•¿å€¼ã€‚å¦‚æœç”¨æˆ· å¸Œæœ›æ’å…¥çš„å€¼ä¸º0,è€Œè¯¥åˆ—åˆæ˜¯è‡ªå¢é•¿çš„,é‚£ä¹ˆè¿™ä¸ªé€‰é¡¹å°±æœ‰ç”¨äº†ã€‚</span><br><span class="line"></span><br><span class="line"><span class="section">STRICT_TRANS_TABLES:</span></span><br><span class="line">åœ¨è¯¥æ¨¡å¼ä¸‹,å¦‚æœä¸€ä¸ªå€¼ä¸èƒ½æ’å…¥åˆ°ä¸€ä¸ªäº‹åŠ¡è¡¨ä¸­,åˆ™ä¸­æ–­å½“å‰çš„æ“ä½œ,å¯¹éäº‹åŠ¡è¡¨ä¸åšé™åˆ¶</span><br><span class="line"></span><br><span class="line"><span class="section">NO_ZERO_IN_DATE:</span></span><br><span class="line">åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹,ä¸å…è®¸æ—¥æœŸå’Œæœˆä»½ä¸ºé›¶</span><br><span class="line"></span><br><span class="line"><span class="section">NO_ZERO_DATE:</span></span><br><span class="line">è®¾ç½®è¯¥å€¼,mysqlæ•°æ®åº“ä¸å…è®¸æ’å…¥é›¶æ—¥æœŸ,æ’å…¥é›¶æ—¥æœŸä¼šæŠ›å‡ºé”™è¯¯è€Œä¸æ˜¯è­¦å‘Šã€‚</span><br><span class="line"></span><br><span class="line"><span class="section">ERROR_FOR_DIVISION_BY_ZERO:</span></span><br><span class="line">åœ¨INSERTæˆ–UPDATEè¿‡ç¨‹ä¸­,å¦‚æœæ•°æ®è¢«é›¶é™¤,åˆ™äº§ç”Ÿé”™è¯¯è€Œéè­¦å‘Šã€‚å¦‚ æœæœªç»™å‡ºè¯¥æ¨¡å¼,é‚£ä¹ˆæ•°æ®è¢«é›¶é™¤æ—¶MySQLè¿”å›NULL</span><br><span class="line"></span><br><span class="line"><span class="section">NO_AUTO_CREATE_USER:</span></span><br><span class="line">ç¦æ­¢GRANTåˆ›å»ºå¯†ç ä¸ºç©ºçš„ç”¨æˆ·</span><br><span class="line"></span><br><span class="line"><span class="section">NO_ENGINE_SUBSTITUTION:</span></span><br><span class="line">å¦‚æœéœ€è¦çš„å­˜å‚¨å¼•æ“è¢«ç¦ç”¨æˆ–æœªç¼–è¯‘,é‚£ä¹ˆæŠ›å‡ºé”™è¯¯ã€‚ä¸è®¾ç½®æ­¤å€¼æ—¶,ç”¨é»˜è®¤çš„å­˜å‚¨å¼•æ“æ›¿ä»£,å¹¶æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸</span><br><span class="line"></span><br><span class="line"><span class="section">PIPES_AS_CONCAT:</span></span><br><span class="line">å°†<span class="string">&quot;||&quot;</span>è§†ä¸ºå­—ç¬¦ä¸²çš„è¿æ¥æ“ä½œç¬¦è€Œéæˆ–è¿ç®—ç¬¦,è¿™å’ŒOracleæ•°æ®åº“æ˜¯ä¸€æ ·çš„,ä¹Ÿå’Œå­—ç¬¦ä¸²çš„æ‹¼æ¥å‡½æ•°Concatç›¸ç±»ä¼¼</span><br><span class="line"></span><br><span class="line"><span class="section">ANSI_QUOTES:</span></span><br><span class="line">å¯ç”¨ANSI_QUOTESå,ä¸èƒ½ç”¨åŒå¼•å·æ¥å¼•ç”¨å­—ç¬¦ä¸²,å› ä¸ºå®ƒè¢«è§£é‡Šä¸ºè¯†åˆ«ç¬¦</span><br><span class="line"><span class="section">ORACLEçš„sql_modeè®¾ç½®ç­‰åŒ:PIPES_AS_CONCAT, ANSI_QUOTES, IGNORE_SPACE, NO_KEY_OPTIONS, NO_TABLE_OPTIONS, NO_FIELD_OPTIONS, NO_AUTO_CREATE_USER.</span></span><br><span class="line"><span class="section">å¦‚æœä½¿ç”¨mysql,ä¸ºäº†ç»§ç»­ä¿ç•™å¤§å®¶ä½¿ç”¨oracleçš„ä¹ æƒ¯,å¯ä»¥å¯¹mysqlçš„sql_modeè®¾ç½®å¦‚ä¸‹:</span></span><br><span class="line"></span><br><span class="line">æ³¨æ„ï¼šMySQL5.6å’ŒMySQL5.7é»˜è®¤çš„sql_modeæ¨¡å¼å‚æ•°æ˜¯ä¸ä¸€æ ·çš„,5.6çš„modeæ˜¯NO_ENGINE_SUBSTITUTIONï¼Œå…¶å®è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªç©ºå€¼ï¼Œç›¸å½“äºæ²¡æœ‰ä»€ä¹ˆæ¨¡å¼è®¾ç½®ï¼Œå¯ä»¥ç†è§£ä¸ºå®½æ¾æ¨¡å¼ã€‚5.7çš„modeæ˜¯STRICT_TRANS_TABLESï¼Œä¹Ÿå°±æ˜¯ä¸¥æ ¼æ¨¡å¼ã€‚</span><br><span class="line">å¦‚æœè®¾ç½®çš„æ˜¯å®½æ¾æ¨¡å¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨æ’å…¥æ•°æ®çš„æ—¶å€™ï¼Œå³ä¾¿æ˜¯ç»™äº†ä¸€ä¸ªé”™è¯¯çš„æ•°æ®ï¼Œä¹Ÿå¯èƒ½ä¼šè¢«æ¥å—ï¼Œå¹¶ä¸”ä¸æŠ¥é”™ï¼Œä¾‹å¦‚ï¼šæˆ‘åœ¨åˆ›å»ºä¸€ä¸ªè¡¨æ—¶ï¼Œè¯¥è¡¨ä¸­æœ‰ä¸€ä¸ªå­—æ®µä¸ºnameï¼Œç»™nameè®¾ç½®çš„å­—æ®µç±»å‹æ—¶char(10)ï¼Œå¦‚æœæˆ‘åœ¨æ’å…¥æ•°æ®çš„æ—¶å€™ï¼Œå…¶ä¸­nameè¿™ä¸ªå­—æ®µå¯¹åº”çš„æœ‰ä¸€æ¡æ•°æ®çš„é•¿åº¦è¶…è¿‡äº†10ï¼Œä¾‹å¦‚&#x27;1234567890abc&#x27;ï¼Œè¶…è¿‡äº†è®¾å®šçš„å­—æ®µé•¿åº¦10ï¼Œé‚£ä¹ˆä¸ä¼šæŠ¥é”™ï¼Œå¹¶ä¸”å–å‰åä¸ªå­—ç¬¦å­˜ä¸Šï¼Œä¹Ÿå°±æ˜¯è¯´ä½ è¿™ä¸ªæ•°æ®è¢«å­˜ä¸ºäº†&#x27;1234567890&#x27;,è€Œ&#x27;abc&#x27;å°±æ²¡æœ‰äº†ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“ï¼Œæˆ‘ä»¬ç»™çš„è¿™æ¡æ•°æ®æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºè¶…è¿‡äº†å­—æ®µé•¿åº¦ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æŠ¥é”™ï¼Œå¹¶ä¸”mysqlè‡ªè¡Œå¤„ç†å¹¶æ¥å—äº†ï¼Œè¿™å°±æ˜¯å®½æ¾æ¨¡å¼çš„æ•ˆæœï¼Œå…¶å®åœ¨å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç­‰ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬åº”è¯¥é‡‡ç”¨çš„æ˜¯ä¸¥æ ¼æ¨¡å¼ï¼Œå‡ºç°è¿™ç§é”™è¯¯ï¼Œåº”è¯¥æŠ¥é”™æ‰å¯¹ï¼Œæ‰€ä»¥MySQL5.7ç‰ˆæœ¬å°±å°†sql_modeé»˜è®¤å€¼æ”¹ä¸ºäº†ä¸¥æ ¼æ¨¡å¼ï¼Œå¹¶ä¸”æˆ‘ä»¬å³ä¾¿æ˜¯ç”¨çš„MySQL5.6ï¼Œä¹Ÿåº”è¯¥è‡ªè¡Œå°†å…¶æ”¹ä¸ºä¸¥æ ¼æ¨¡å¼ï¼Œè€Œä½ è®°ç€ï¼ŒMySQLç­‰ç­‰çš„è¿™äº›æ•°æ®åº“ï¼Œéƒ½æ˜¯æƒ³æŠŠå…³äºæ•°æ®çš„æ‰€æœ‰æ“ä½œéƒ½è‡ªå·±åŒ…æ½ä¸‹æ¥ï¼ŒåŒ…æ‹¬æ•°æ®çš„æ ¡éªŒï¼Œå…¶å®å¥½å¤šæ—¶å€™ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨è‡ªå·±å¼€å‘çš„é¡¹ç›®ç¨‹åºçº§åˆ«å°†è¿™äº›æ ¡éªŒç»™åšäº†ï¼Œè™½ç„¶å†™é¡¹ç›®çš„æ—¶å€™éº»çƒ¦äº†ä¸€äº›æ­¥éª¤ï¼Œä½†æ˜¯è¿™æ ·åšä¹‹åï¼Œæˆ‘ä»¬åœ¨è¿›è¡Œæ•°æ®åº“è¿ç§»æˆ–è€…åœ¨é¡¹ç›®çš„è¿ç§»æ—¶ï¼Œå°±ä¼šæ–¹ä¾¿å¾ˆå¤šï¼Œè¿™ä¸ªçœ‹ä½ ä»¬è‡ªè¡Œæ¥è¡¡é‡ã€‚mysqlé™¤äº†æ•°æ®æ ¡éªŒä¹‹å¤–ï¼Œä½ æ…¢æ…¢çš„å­¦ä¹ è¿‡ç¨‹ä¸­ä¼šå‘ç°ï¼Œå®ƒèƒ½å¤Ÿåšçš„äº‹æƒ…è¿˜æœ‰å¾ˆå¤šå¾ˆå¤šï¼Œå°†ä½ ç¨‹åºä¸­åšçš„å¥½å¤šäº‹æƒ…éƒ½åŒ…æ½äº†ã€‚</span><br><span class="line"></span><br><span class="line">æ”¹ä¸ºä¸¥æ ¼æ¨¡å¼åå¯èƒ½ä¼šå­˜åœ¨çš„é—®é¢˜ï¼š</span><br><span class="line">è‹¥è®¾ç½®æ¨¡å¼ä¸­åŒ…å«äº†NO_ZERO_DATEï¼Œé‚£ä¹ˆMySQLæ•°æ®åº“ä¸å…è®¸æ’å…¥é›¶æ—¥æœŸï¼Œæ’å…¥é›¶æ—¥æœŸä¼šæŠ›å‡ºé”™è¯¯è€Œä¸æ˜¯è­¦å‘Šã€‚ä¾‹å¦‚è¡¨ä¸­å«å­—æ®µTIMESTAMPåˆ—ï¼ˆå¦‚æœæœªå£°æ˜ä¸ºNULLæˆ–æ˜¾ç¤ºDEFAULTå­å¥ï¼‰å°†è‡ªåŠ¨åˆ†é…DEFAULT &#x27;0000-00-00 00:00:00&#x27;ï¼ˆé›¶æ—¶é—´æˆ³ï¼‰ï¼Œä¹Ÿæˆ–è€…æ˜¯æœ¬æµ‹è¯•çš„è¡¨dayåˆ—é»˜è®¤å…è®¸æ’å…¥é›¶æ—¥æœŸ &#x27;0000-00-00&#x27; COMMENT &#x27;æ—¥æœŸ&#x27;ï¼›è¿™äº›æ˜¾ç„¶æ˜¯ä¸æ»¡è¶³sql_modeä¸­çš„NO_ZERO_DATEè€ŒæŠ¥é”™ã€‚</span><br><span class="line"></span><br><span class="line">æ¨¡å¼è®¾ç½®å’Œä¿®æ”¹(ä»¥è§£å†³ä¸Šè¿°é—®é¢˜ä¸ºä¾‹)ï¼š</span><br><span class="line">æ–¹å¼ä¸€ï¼šå…ˆæ‰§è¡Œselect @@sql_mode,å¤åˆ¶æŸ¥è¯¢å‡ºæ¥çš„å€¼å¹¶å°†å…¶ä¸­çš„NO_ZERO_IN_DATE,NO_ZERO_DATEåˆ é™¤ï¼Œç„¶åæ‰§è¡Œset sql_mode = &#x27;ä¿®æ”¹åçš„å€¼&#x27;æˆ–è€…set session sql_mode=&#x27;ä¿®æ”¹åçš„å€¼&#x27;;ï¼Œä¾‹å¦‚ï¼šset session sql_mode=&#x27;STRICT_TRANS_TABLES&#x27;;æ”¹ä¸ºä¸¥æ ¼æ¨¡å¼</span><br><span class="line">æ­¤æ–¹æ³•åªåœ¨å½“å‰ä¼šè¯ä¸­ç”Ÿæ•ˆï¼Œå…³é—­å½“å‰ä¼šè¯å°±ä¸ç”Ÿæ•ˆäº†ã€‚</span><br><span class="line">æ–¹å¼äºŒï¼šå…ˆæ‰§è¡Œselect @@global.sql_mode,å¤åˆ¶æŸ¥è¯¢å‡ºæ¥çš„å€¼å¹¶å°†å…¶ä¸­çš„NO_ZERO_IN_DATE,NO_ZERO_DATEåˆ é™¤ï¼Œç„¶åæ‰§è¡Œset global sql_mode = &#x27;ä¿®æ”¹åçš„å€¼&#x27;ã€‚</span><br><span class="line">æ­¤æ–¹æ³•åœ¨å½“å‰æœåŠ¡ä¸­ç”Ÿæ•ˆï¼Œé‡æ–°MySQLæœåŠ¡åå¤±æ•ˆ</span><br><span class="line">æ–¹æ³•ä¸‰ï¼šåœ¨mysqlçš„å®‰è£…ç›®å½•ä¸‹ï¼Œæˆ–my.cnfæ–‡ä»¶(windowsç³»ç»Ÿæ˜¯my.iniæ–‡ä»¶)ï¼Œæ–°å¢ sql_mode = ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTIONï¼Œ</span><br><span class="line">æ·»åŠ my.cnfå¦‚ä¸‹ï¼š</span><br><span class="line">[mysqld]</span><br><span class="line">sql_mode=ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER</span><br><span class="line">ç„¶åé‡å¯mysqlã€‚</span><br><span class="line">æ­¤æ–¹æ³•æ°¸ä¹…ç”Ÿæ•ˆ.å½“ç„¶ç”Ÿäº§ç¯å¢ƒä¸Šæ˜¯ç¦æ­¢é‡å¯MySQLæœåŠ¡çš„ï¼Œæ‰€ä»¥é‡‡ç”¨æ–¹å¼äºŒåŠ æ–¹å¼ä¸‰æ¥è§£å†³çº¿ä¸Šçš„é—®é¢˜ï¼Œé‚£ä¹ˆå³ä¾¿æ˜¯æœ‰ä¸€å¤©çœŸçš„é‡å¯äº†MySQLæœåŠ¡ï¼Œä¹Ÿä¼šæ°¸ä¹…ç”Ÿæ•ˆäº†ã€‚</span><br><span class="line"></span><br><span class="line">[mysqldump]</span><br><span class="line"><span class="comment"># quické€‰é¡¹å¼ºåˆ¶ mysqldump ä»æœåŠ¡å™¨æŸ¥è¯¢å–å¾—è®°å½•ç›´æ¥è¾“å‡ºè€Œä¸æ˜¯å–å¾—æ‰€æœ‰è®°å½•åå°†å®ƒä»¬ç¼“å­˜åˆ°å†…å­˜ä¸­</span></span><br><span class="line">quick</span><br><span class="line">quick</span><br><span class="line"><span class="comment"># è¯¥å‚æ•°é™åˆ¶æœåŠ¡å™¨ç«¯ï¼Œæ¥å—çš„æ•°æ®åŒ…å¤§å°ï¼Œå¦‚æœæœ‰BLOBå­æ®µï¼Œå»ºè®®å¢å¤§æ­¤å€¼ï¼Œé¿å…å†™å…¥æˆ–è€…æ›´æ–°å‡ºé”™ã€‚æœ‰BLOBå­æ®µï¼Œå»ºè®®æ”¹ä¸º1024M</span></span><br><span class="line"><span class="comment"># æœåŠ¡å™¨å‘é€å’Œæ¥å—çš„æœ€å¤§åŒ…é•¿åº¦</span></span><br><span class="line">max_allowed_packet = 16M</span><br><span class="line"></span><br><span class="line">[mysql]</span><br><span class="line">auto-rehashæ˜¯è‡ªåŠ¨è¡¥å…¨çš„æ„æ€ï¼Œå°±åƒæˆ‘ä»¬åœ¨linuxå‘½ä»¤è¡Œé‡Œè¾“å…¥å‘½ä»¤çš„æ—¶å€™ï¼Œä½¿ç”¨tabé”®çš„åŠŸèƒ½æ˜¯ä¸€æ ·çš„ã€‚</span><br><span class="line">no-auto-rehash</span><br><span class="line"></span><br><span class="line">[myisamchk]</span><br><span class="line"><span class="comment"># *** MyISAM ç›¸å…³é€‰é¡¹</span></span><br><span class="line"><span class="comment"># æŒ‡å®šç´¢å¼•ç¼“å†²åŒºçš„å¤§å°, ä¸ºMYISAMæ•°æ®è¡¨å¼€å¯ä¾›çº¿ç¨‹å…±äº«çš„ç´¢å¼•ç¼“å­˜,å¯¹INNODBå¼•æ“æ— æ•ˆã€‚ç›¸å½“å½±å“MyISAMçš„æ€§èƒ½ã€‚</span></span><br><span class="line"><span class="comment"># ä¸è¦å°†å…¶è®¾ç½®å¤§äºä½ å¯ç”¨å†…å­˜çš„30%,å› ä¸ºä¸€éƒ¨åˆ†å†…å­˜åŒæ ·è¢«OSç”¨æ¥ç¼“å†²è¡Œæ•°æ®</span></span><br><span class="line"><span class="comment"># ç”šè‡³åœ¨ä½ å¹¶ä¸ä½¿ç”¨MyISAM è¡¨çš„æƒ…å†µä¸‹, ä½ ä¹Ÿéœ€è¦ä»æ—§è®¾ç½®èµ· 8-64M å†…å­˜ç”±äºå®ƒåŒæ ·ä¼šè¢«å†…éƒ¨ä¸´æ—¶ç£ç›˜è¡¨ä½¿ç”¨.</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ 8Mï¼Œå»ºè®®å€¼ï¼šå¯¹äºå†…å­˜åœ¨4GBå·¦å³çš„æœåŠ¡å™¨è¯¥å‚æ•°å¯è®¾ç½®ä¸º256Mæˆ–384Mã€‚æ³¨æ„ï¼šè¯¥å‚æ•°å€¼è®¾ç½®çš„è¿‡å¤§åè€Œä¼šæ˜¯æœåŠ¡å™¨æ•´ä½“æ•ˆç‡é™ä½ï¼</span></span><br><span class="line">key_buffer_size = 384M</span><br><span class="line"></span><br><span class="line"><span class="comment"># order byæˆ–group byæ—¶ç”¨åˆ° </span></span><br><span class="line"><span class="comment"># æ”¯æŒæ‰€æœ‰å¼•æ“ï¼Œinnodbå’Œmyisamæœ‰è‡ªå·±çš„innodb_sort_buffer_sizeå’Œmyisam_sort_buffer_sizeè®¾ç½®</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼256kbï¼›å»ºè®®å€¼ï¼šå¾—å‚è€ƒè¿æ¥æ•°ï¼Œ16Gå†…å­˜ï¼Œæœ‰äººæ¨è8M.</span></span><br><span class="line"><span class="comment"># æ³¨æ„ï¼Œè¯¥ç¼“å†²åŒºæ˜¯æ¯ä¸ªè¿æ¥ç‹¬å çš„ï¼Œæ‰€ä»¥æ€»ç¼“å†²åŒºå¤§å°ä¸º 1M*è¿æ¥æ•°ï¼›æç«¯æƒ…å†µ1M*maxconnectiosnsï¼Œä¼šè¶…çº§å¤§ã€‚æ‰€ä»¥è¦è€ƒè™‘æ—¥å¸¸å¹³å‡è¿æ¥æ•°ã€‚</span></span><br><span class="line">sort_buffer_size = 256M</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸ºæ¯ä¸ªæ‰«æMyISAMçš„çº¿ç¨‹åˆ†é…å‚æ•°è®¾ç½®çš„å†…å­˜å¤§å°ç¼“å†²åŒºã€‚ </span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼128kbï¼Œå»ºè®®å€¼ï¼š16Gå†…å­˜å»ºè®®1Mï¼Œ4Gï¼š128kbæˆ–è€…256kbå§</span></span><br><span class="line"><span class="comment"># æ³¨æ„ï¼Œè¯¥ç¼“å†²åŒºæ˜¯æ¯ä¸ªè¿æ¥ç‹¬å çš„ï¼Œæ‰€ä»¥æ€»ç¼“å†²åŒºå¤§å°ä¸º 128kb*è¿æ¥æ•°ï¼›æç«¯æƒ…å†µ128kb*maxconnectiosnsï¼Œä¼šè¶…çº§å¤§ï¼Œæ‰€ä»¥è¦è€ƒè™‘æ—¥å¸¸å¹³å‡è¿æ¥æ•°ã€‚</span></span><br><span class="line"><span class="comment"># ä¸€èˆ¬ä¸éœ€è¦å¤ªå…³å¿ƒè¯¥æ•°å€¼ï¼Œç¨å¾®å¢å¤§å°±å¯ä»¥äº†</span></span><br><span class="line">read_buffer = 128M</span><br><span class="line">write_buffer = 128M</span><br><span class="line"></span><br><span class="line"><span class="comment"># mysqlå‘½ä»¤è¡Œå·¥å…·ä¸ä½¿ç”¨è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ï¼Œå»ºè®®è¿˜æ˜¯æ”¹ä¸º</span></span><br><span class="line"><span class="comment"># no-auto-rehash</span></span><br><span class="line">auto-rehash</span><br><span class="line">[mysqlhotcopy]</span><br><span class="line"><span class="comment"># æœåŠ¡å™¨å…³é—­äº¤äº’å¼è¿æ¥å‰ç­‰å¾…æ´»åŠ¨çš„ç§’æ•°ã€‚äº¤äº’å¼å®¢æˆ·ç«¯å®šä¹‰ä¸ºåœ¨mysql_real_connect()ä¸­ä½¿ç”¨CLIENT_INTERACTIVEé€‰é¡¹çš„å®¢æˆ·ç«¯ã€‚é»˜è®¤å€¼ï¼š28800ç§’ï¼ˆ8å°æ—¶ï¼‰</span></span><br><span class="line">interactive-timeout</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ—¥å¿—æ–‡ä»¶ç›¸å…³è®¾ç½®ï¼Œä¸€èˆ¬åªå¼€å¯ä¸‰ç§æ—¥å¿—ï¼Œé”™è¯¯æ—¥å¿—ï¼Œæ…¢æŸ¥è¯¢æ—¥å¿—ï¼ŒäºŒè¿›åˆ¶æ—¥å¿—ã€‚æ™®é€šæŸ¥è¯¢æ—¥å¿—ä¸å¼€å¯ã€‚</span></span><br><span class="line"><span class="comment"># æ™®é€šæŸ¥è¯¢æ—¥å¿—ï¼Œé»˜è®¤å€¼offï¼Œä¸å¼€å¯</span></span><br><span class="line">general_log = 0</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ™®é€šæŸ¥è¯¢æ—¥å¿—å­˜æ”¾åœ°å€</span></span><br><span class="line">general_log_file = /usr/local/mysql-5.7.21/log/mysql-general.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¨å±€åŠ¨æ€å˜é‡ï¼Œé»˜è®¤3ï¼ŒèŒƒå›´ï¼š1ï½3</span></span><br><span class="line"><span class="comment"># è¡¨ç¤ºé”™è¯¯æ—¥å¿—è®°å½•çš„ä¿¡æ¯ï¼Œ1ï¼šåªè®°å½•errorä¿¡æ¯ï¼›2ï¼šè®°å½•errorå’Œwarningsä¿¡æ¯ï¼›3ï¼šè®°å½•errorã€warningså’Œæ™®é€šçš„notesä¿¡æ¯ã€‚</span></span><br><span class="line">log_error_verbosity = 2</span><br><span class="line"></span><br><span class="line"><span class="comment"># é”™è¯¯æ—¥å¿—æ–‡ä»¶åœ°å€</span></span><br><span class="line">log_error = /usr/local/mysql-5.7.21/log/mysql-error.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å¯æ…¢æŸ¥è¯¢</span></span><br><span class="line">slow_query_log = 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å¯æ…¢æŸ¥è¯¢æ—¶é—´ï¼Œæ­¤å¤„ä¸º1ç§’ï¼Œè¾¾åˆ°æ­¤å€¼æ‰è®°å½•æ•°æ®</span></span><br><span class="line">long_query_time = 3</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ…¢æŸ¥è¯¢æ—¥å¿—æ–‡ä»¶åœ°å€</span></span><br><span class="line">slow_query_log_file = /usr/local/mysql/log/mysql-slow.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€ç´¢è¡Œæ•°è¾¾åˆ°æ­¤æ•°å€¼ï¼Œæ‰è®°å½•æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­</span></span><br><span class="line">min_examined_row_limit = 100</span><br><span class="line"></span><br><span class="line"><span class="comment"># mysql 5.6.5æ–°å¢ï¼Œç”¨æ¥è¡¨ç¤ºæ¯åˆ†é’Ÿå…è®¸è®°å½•åˆ°slow logçš„ä¸”æœªä½¿ç”¨ç´¢å¼•çš„SQLè¯­å¥æ¬¡æ•°ï¼Œé»˜è®¤å€¼ä¸º0ï¼Œä¸é™åˆ¶ã€‚</span></span><br><span class="line">log_throttle_queries_not_using_indexes = 0</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å¯è®°å½•æ²¡æœ‰ä½¿ç”¨ç´¢å¼•æŸ¥è¯¢è¯­å¥</span></span><br><span class="line">log-queries-not-using-indexes = 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®æ­¤å‚æ•°è¡¨ç¤ºå¯ç”¨binlogåŠŸèƒ½ï¼Œå¹¶æŒ‡å®šè·¯å¾„åç§°</span></span><br><span class="line">log_bin=/usr/local/mysql/log/mysql-bin.log</span><br><span class="line"></span><br><span class="line">è®¾ç½®æ­¤å‚æ•°æ˜¯æŒ‡å®šäºŒè¿›åˆ¶ç´¢å¼•æ–‡ä»¶çš„è·¯å¾„ä¸åç§°</span><br><span class="line">log_bin_index</span><br><span class="line"></span><br><span class="line">æ­¤å‚æ•°è¡¨ç¤ºåªè®°å½•æŒ‡å®šæ•°æ®åº“çš„äºŒè¿›åˆ¶æ—¥å¿—</span><br><span class="line">binlog_do_db</span><br><span class="line"></span><br><span class="line">æ­¤å‚æ•°è¡¨ç¤ºä¸è®°å½•æŒ‡å®šçš„æ•°æ®åº“çš„äºŒè¿›åˆ¶æ—¥å¿—</span><br><span class="line">binlog_ignore_db</span><br><span class="line"></span><br><span class="line">æ­¤å‚æ•°è¡¨ç¤ºbinlogä½¿ç”¨çš„å†…å­˜æœ€å¤§çš„å°ºå¯¸</span><br><span class="line">max_binlog_cache_size</span><br><span class="line"></span><br><span class="line">æ­¤å‚æ•°è¡¨ç¤ºbinlogä½¿ç”¨çš„å†…å­˜å¤§å°ï¼Œå¯ä»¥é€šè¿‡çŠ¶æ€å˜é‡binlog_cache_useå’Œbinlog_cache_disk_useæ¥å¸®åŠ©æµ‹è¯•ã€‚</span><br><span class="line">binlog_cache_size</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨äºŒè¿›åˆ¶æ—¥å¿—ç¼“å­˜çš„äº‹åŠ¡æ•°é‡</span></span><br><span class="line">binlog_cache_use</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨äºŒè¿›åˆ¶æ—¥å¿—ç¼“å­˜ä½†è¶…è¿‡binlog_cache_sizeå€¼å¹¶ä½¿ç”¨ä¸´æ—¶æ–‡ä»¶æ¥ä¿å­˜äº‹åŠ¡ä¸­çš„è¯­å¥çš„äº‹åŠ¡æ•°é‡</span></span><br><span class="line">binlog_cache_disk_use</span><br><span class="line"></span><br><span class="line"><span class="comment"># Binlogæœ€å¤§å€¼ï¼Œæœ€å¤§å’Œé»˜è®¤å€¼æ˜¯1GBï¼Œè¯¥è®¾ç½®å¹¶ä¸èƒ½ä¸¥æ ¼æ§åˆ¶Binlogçš„å¤§å°ï¼Œå°¤å…¶æ˜¯Binlogæ¯”è¾ƒé è¿‘æœ€å¤§å€¼è€Œåˆé‡åˆ°ä¸€ä¸ªæ¯”è¾ƒå¤§äº‹åŠ¡æ—¶ï¼Œä¸ºäº†ä¿è¯äº‹åŠ¡çš„å®Œæ•´æ€§ï¼Œä¸å¯èƒ½åšåˆ‡æ¢æ—¥å¿—çš„åŠ¨ä½œï¼Œåªèƒ½å°†è¯¥äº‹åŠ¡çš„æ‰€æœ‰SQLéƒ½è®°å½•è¿›å½“å‰æ—¥å¿—ï¼Œç›´åˆ°äº‹åŠ¡ç»“æŸ</span></span><br><span class="line"><span class="comment"># å¦‚æœäºŒè¿›åˆ¶æ—¥å¿—å†™å…¥çš„å†…å®¹è¶…å‡ºç»™å®šå€¼ï¼Œæ—¥å¿—å°±ä¼šå‘ç”Ÿæ»šåŠ¨ã€‚ä½ ä¸èƒ½å°†è¯¥å˜é‡è®¾ç½®ä¸ºå¤§äº1GBæˆ–å°äº4096å­—èŠ‚ã€‚ é»˜è®¤å€¼æ˜¯1GBã€‚</span></span><br><span class="line">max_binlog_size</span><br><span class="line"></span><br><span class="line">sync_binlogâ€ï¼šè¿™ä¸ªå‚æ•°æ˜¯å¯¹äºMySQLç³»ç»Ÿæ¥è¯´æ˜¯è‡³å…³é‡è¦çš„ï¼Œä»–ä¸ä»…å½±å“åˆ°Binlogå¯¹MySQLæ‰€å¸¦æ¥çš„æ€§èƒ½æŸè€—ï¼Œè€Œä¸”è¿˜å½±å“åˆ°MySQLä¸­æ•°æ®çš„å®Œæ•´æ€§ã€‚å¯¹äºâ€œsync_binlogâ€å‚æ•°çš„å„ç§è®¾ç½®çš„è¯´æ˜å¦‚ä¸‹ï¼š</span><br><span class="line">sync_binlog=0ï¼Œå½“äº‹åŠ¡æäº¤ä¹‹åï¼ŒMySQLä¸åšfsyncä¹‹ç±»çš„ç£ç›˜åŒæ­¥æŒ‡ä»¤åˆ·æ–°binlog_cacheä¸­çš„ä¿¡æ¯åˆ°ç£ç›˜ï¼Œè€Œè®©Filesystemè‡ªè¡Œå†³å®šä»€ä¹ˆæ—¶å€™æ¥åšåŒæ­¥ï¼Œæˆ–è€…cacheæ»¡äº†ä¹‹åæ‰åŒæ­¥åˆ°ç£ç›˜ã€‚</span><br><span class="line">sync_binlog=nï¼Œå½“æ¯è¿›è¡Œnæ¬¡äº‹åŠ¡æäº¤ä¹‹åï¼ŒMySQLå°†è¿›è¡Œä¸€æ¬¡fsyncä¹‹ç±»çš„ç£ç›˜åŒæ­¥æŒ‡ä»¤æ¥å°†binlog_cacheä¸­çš„æ•°æ®å¼ºåˆ¶å†™å…¥ç£ç›˜ã€‚</span><br><span class="line">åœ¨MySQLä¸­ç³»ç»Ÿé»˜è®¤çš„è®¾ç½®æ˜¯sync_binlog=0ï¼Œä¹Ÿå°±æ˜¯ä¸åšä»»ä½•å¼ºåˆ¶æ€§çš„ç£ç›˜åˆ·æ–°æŒ‡ä»¤ï¼Œè¿™æ—¶å€™çš„æ€§èƒ½æ˜¯æœ€å¥½çš„ï¼Œä½†æ˜¯é£é™©ä¹Ÿæ˜¯æœ€å¤§çš„ã€‚å› ä¸ºä¸€æ—¦ç³»ç»ŸCrashï¼Œåœ¨binlog_cacheä¸­çš„æ‰€æœ‰binlogä¿¡æ¯éƒ½ä¼šè¢«ä¸¢å¤±ã€‚è€Œå½“è®¾ç½®ä¸ºâ€œ1â€çš„æ—¶å€™ï¼Œæ˜¯æœ€å®‰å…¨ä½†æ˜¯æ€§èƒ½æŸè€—æœ€å¤§çš„è®¾ç½®ã€‚å› ä¸ºå½“è®¾ç½®ä¸º1çš„æ—¶å€™ï¼Œå³ä½¿ç³»ç»ŸCrashï¼Œä¹Ÿæœ€å¤šä¸¢å¤±binlog_cacheä¸­æœªå®Œæˆçš„ä¸€ä¸ªäº‹åŠ¡ï¼Œå¯¹å®é™…æ•°æ®æ²¡æœ‰ä»»ä½•å®è´¨æ€§å½±å“ã€‚</span><br><span class="line">ä»ä»¥å¾€ç»éªŒå’Œç›¸å…³æµ‹è¯•æ¥çœ‹ï¼Œå¯¹äºé«˜å¹¶å‘äº‹åŠ¡çš„ç³»ç»Ÿæ¥è¯´ï¼Œâ€œsync_binlogâ€è®¾ç½®ä¸º0å’Œè®¾ç½®ä¸º1çš„ç³»ç»Ÿå†™å…¥æ€§èƒ½å·®è·å¯èƒ½é«˜è¾¾5å€ç”šè‡³æ›´å¤šã€‚</span><br><span class="line">sync_binlog=1</span><br><span class="line">show variables like <span class="string">&#x27;sync_binlog&#x27;</span>;</span><br><span class="line"><span class="built_in">set</span> global sync_binlog=0;</span><br><span class="line"></span><br><span class="line"><span class="comment"># relay logå¾ˆå¤šæ–¹é¢éƒ½è·Ÿbinary logå·®ä¸å¤šã€‚</span></span><br><span class="line"><span class="comment"># åŒºåˆ«æ˜¯ï¼šä»æœåŠ¡å™¨I/Oçº¿ç¨‹å°†ä¸»æœåŠ¡å™¨çš„äºŒè¿›åˆ¶æ—¥å¿—è¯»å–è¿‡æ¥è®°å½•åˆ°ä»æœåŠ¡å™¨æœ¬åœ°æ–‡ä»¶ï¼Œç„¶åSQLçº¿ç¨‹ä¼šè¯»å–relay-logæ—¥å¿—çš„å†…å®¹å¹¶åº”ç”¨åˆ°ä»æœåŠ¡å™¨ï¼Œä»è€Œä½¿ä»æœåŠ¡å™¨å’Œä¸»æœåŠ¡å™¨çš„æ•°æ®ä¿æŒä¸€è‡´</span></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ–¹å¼ï¼šshow replylog events in &#x27;mysql-reply-bin.000256&#x27;;</span></span><br><span class="line">relay_log = /data/mysql/mysql-relay-bin</span><br><span class="line"></span><br><span class="line">relay <span class="built_in">log</span>çš„ç›¸å…³å‚æ•°ï¼š</span><br><span class="line">é€šè¿‡è¯­å¥ï¼šshow variables like <span class="string">&#x27;%relay%&#x27;</span>ï¼ŒæŸ¥çœ‹å…ˆéª¨å¹²çš„relayçš„æ‰€æœ‰ç›¸å…³å‚æ•°</span><br><span class="line">mysql&gt; show variables like <span class="string">&#x27;%relay%&#x27;</span>;</span><br><span class="line">+-----------------------+----------------+</span><br><span class="line">| Variable_name | Value |</span><br><span class="line">+-----------------------+----------------+</span><br><span class="line">| max_relay_log_size | 0 |</span><br><span class="line">| relay_log | |</span><br><span class="line">| relay_log_index | |</span><br><span class="line">| relay_log_info_file | relay-log.info |</span><br><span class="line">| relay_log_purge | ON |</span><br><span class="line">| relay_log_recovery | OFF |</span><br><span class="line">| relay_log_space_limit | 0 |</span><br><span class="line">| sync_relay_log | 0 |</span><br><span class="line">| sync_relay_log_info | 0 |</span><br><span class="line">+-----------------------+----------------+</span><br><span class="line">9 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.08 sec)</span><br><span class="line">2.1 max_relay_log_sizeï¼šæ ‡è®°relay <span class="built_in">log</span> å…è®¸çš„æœ€å¤§å€¼ï¼Œå¦‚æœè¯¥å€¼ä¸º0ï¼Œåˆ™é»˜è®¤å€¼ä¸ºmax_binlog_size(1G)ï¼›å¦‚æœä¸ä¸º0ï¼Œåˆ™max_relay_log_sizeåˆ™ä¸ºæœ€å¤§çš„relay_logæ–‡ä»¶å¤§å°ï¼›</span><br><span class="line">2.2 relay_logï¼šå®šä¹‰relay_logçš„ä½ç½®å’Œåç§°ï¼Œå¦‚æœå€¼ä¸ºç©ºï¼Œåˆ™é»˜è®¤ä½ç½®åœ¨æ•°æ®æ–‡ä»¶çš„ç›®å½•ï¼Œæ–‡ä»¶åä¸ºhost_name-relay-bin.nnnnnnï¼ˆBy default, relay <span class="built_in">log</span> file names have the form host_name-relay-bin.nnnnnn <span class="keyword">in</span> the data directoryï¼‰ï¼›</span><br><span class="line">2.3relay_log_indexï¼šåŒrelay_logï¼Œå®šä¹‰relay_logçš„ä½ç½®å’Œåç§°ï¼›</span><br><span class="line">2.4relay_log_info_fileï¼šè®¾ç½®relay-log.infoçš„ä½ç½®å’Œåç§°ï¼ˆrelay-log.infoè®°å½•MASTERçš„binary_logçš„æ¢å¤ä½ç½®å’Œrelay_logçš„ä½ç½®ï¼‰</span><br><span class="line">2.5relay_log_purgeï¼šæ˜¯å¦è‡ªåŠ¨æ¸…ç©ºä¸å†éœ€è¦ä¸­ç»§æ—¥å¿—æ—¶ã€‚é»˜è®¤å€¼ä¸º1(å¯ç”¨)ã€‚</span><br><span class="line">2.6relay_log_recoveryï¼šå½“slaveä»åº“å®•æœºåï¼Œå‡å¦‚relay-logæŸåäº†ï¼Œå¯¼è‡´ä¸€éƒ¨åˆ†ä¸­ç»§æ—¥å¿—æ²¡æœ‰å¤„ç†ï¼Œåˆ™è‡ªåŠ¨æ”¾å¼ƒæ‰€æœ‰æœªæ‰§è¡Œçš„relay-logï¼Œå¹¶ä¸”é‡æ–°ä»masterä¸Šè·å–æ—¥å¿—ï¼Œè¿™æ ·å°±ä¿è¯äº†relay-logçš„å®Œæ•´æ€§ã€‚é»˜è®¤æƒ…å†µä¸‹è¯¥åŠŸèƒ½æ˜¯å…³é—­çš„ï¼Œå°†relay_log_recoveryçš„å€¼è®¾ç½®ä¸º 1æ—¶ï¼Œå¯åœ¨slaveä»åº“ä¸Šå¼€å¯è¯¥åŠŸèƒ½ï¼Œå»ºè®®å¼€å¯ã€‚</span><br><span class="line">2.7relay_log_space_limitï¼šé˜²æ­¢ä¸­ç»§æ—¥å¿—å†™æ»¡ç£ç›˜ï¼Œè¿™é‡Œè®¾ç½®ä¸­ç»§æ—¥å¿—æœ€å¤§é™é¢ã€‚ä½†æ­¤è®¾ç½®å­˜åœ¨ä¸»åº“å´©æºƒï¼Œä»åº“ä¸­ç»§æ—¥å¿—ä¸å…¨çš„æƒ…å†µï¼Œä¸åˆ°ä¸‡ä¸å¾—å·²ï¼Œä¸æ¨èä½¿ç”¨ï¼›</span><br><span class="line">2.8sync_relay_logï¼šè¿™ä¸ªå‚æ•°å’Œsync_binlogæ˜¯ä¸€æ ·çš„ï¼Œå½“è®¾ç½®ä¸º1æ—¶ï¼Œslaveçš„I/Oçº¿ç¨‹æ¯æ¬¡æ¥æ”¶åˆ°masterå‘é€è¿‡æ¥çš„binlogæ—¥å¿—éƒ½è¦å†™å…¥ç³»ç»Ÿç¼“å†²åŒºï¼Œç„¶ååˆ·å…¥relay <span class="built_in">log</span>ä¸­ç»§æ—¥å¿—é‡Œï¼Œè¿™æ ·æ˜¯æœ€å®‰å…¨çš„ï¼Œå› ä¸ºåœ¨å´©æºƒçš„æ—¶å€™ï¼Œä½ æœ€å¤šä¼šä¸¢å¤±ä¸€ä¸ªäº‹åŠ¡ï¼Œä½†ä¼šé€ æˆç£ç›˜çš„å¤§é‡I/Oã€‚å½“è®¾ç½®ä¸º0æ—¶ï¼Œå¹¶ä¸æ˜¯é©¬ä¸Šå°±åˆ·å…¥ä¸­ç»§æ—¥å¿—é‡Œï¼Œè€Œæ˜¯ç”±æ“ä½œç³»ç»Ÿå†³å®šä½•æ—¶æ¥å†™å…¥ï¼Œè™½ç„¶å®‰å…¨æ€§é™ä½äº†ï¼Œä½†å‡å°‘äº†å¤§é‡çš„ç£ç›˜I/Oæ“ä½œã€‚è¿™ä¸ªå€¼é»˜è®¤æ˜¯0ï¼Œå¯åŠ¨æ€ä¿®æ”¹ï¼Œå»ºè®®é‡‡ç”¨é»˜è®¤å€¼ã€‚</span><br><span class="line">2.9sync_relay_log_infoï¼šè¿™ä¸ªå‚æ•°å’Œsync_relay_logå‚æ•°ä¸€æ ·ï¼Œå½“è®¾ç½®ä¸º1æ—¶ï¼Œslaveçš„I/Oçº¿ç¨‹æ¯æ¬¡æ¥æ”¶åˆ°masterå‘é€è¿‡æ¥çš„binlogæ—¥å¿—éƒ½è¦å†™å…¥ç³»ç»Ÿç¼“å†²åŒºï¼Œç„¶ååˆ·å…¥relay-log.infoé‡Œï¼Œè¿™æ ·æ˜¯æœ€å®‰å…¨çš„ï¼Œå› ä¸ºåœ¨å´©æºƒçš„æ—¶å€™ï¼Œä½ æœ€å¤šä¼šä¸¢å¤±ä¸€ä¸ªäº‹åŠ¡ï¼Œä½†ä¼šé€ æˆç£ç›˜çš„å¤§é‡I/Oã€‚å½“è®¾ç½®ä¸º0æ—¶ï¼Œå¹¶ä¸æ˜¯é©¬ä¸Šå°±åˆ·å…¥relay-log.infoé‡Œï¼Œè€Œæ˜¯ç”±æ“ä½œç³»ç»Ÿå†³å®šä½•æ—¶æ¥å†™å…¥ï¼Œè™½ç„¶å®‰å…¨æ€§é™ä½äº†ï¼Œä½†å‡å°‘äº†å¤§é‡çš„ç£ç›˜I/Oæ“ä½œã€‚è¿™ä¸ªå€¼é»˜è®¤æ˜¯0ï¼Œå¯åŠ¨æ€ä¿®æ”¹ï¼Œå»ºè®®é‡‡ç”¨é»˜è®¤å€¼ã€‚</span><br><span class="line">å…³äºbinlogå’Œrelay <span class="built_in">log</span>çš„åˆ é™¤æ–¹æ³•ï¼š</span><br><span class="line">binlog å¤ªå¤šçš„ è§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š</span><br><span class="line">PURGE MASTER LOGSæ‰‹åŠ¨åˆ é™¤ç”¨æ³•åŠç¤ºä¾‹,MASTERå’ŒBINARYæ˜¯åŒä¹‰è¯</span><br><span class="line">&gt; PURGE &#123;MASTER | BINARY&#125; LOGS TO <span class="string">&#x27;log_name&#x27;</span></span><br><span class="line">&gt; PURGE &#123;MASTER | BINARY&#125; LOGS BEFORE <span class="string">&#x27;date&#x27;</span></span><br><span class="line">å®ä¾‹ï¼š</span><br><span class="line">&gt; PURGE MASTER LOGS TO <span class="string">&#x27;MySQL-bin.010&#x27;</span>; //æ¸…é™¤MySQL-bin.010æ—¥å¿—</span><br><span class="line">&gt; PURGE MASTER LOGS BEFORE <span class="string">&#x27;2008-06-22 13:00:00&#x27;</span>; //æ¸…é™¤2008-06-22 13:00:00å‰binlogæ—¥å¿— &gt; PURGE MASTER LOGS BEFORE DATE_SUB( NOW( ), INTERVAL 3 DAY); //æ¸…é™¤3å¤©å‰binlogæ—¥å¿—BEFOREï¼Œå˜é‡çš„<span class="built_in">date</span>è‡ªå˜é‡å¯ä»¥ä¸º<span class="string">&#x27;YYYY-MM-DD hh:mm:ss&#x27;</span>æ ¼å¼ã€‚</span><br><span class="line">æˆ–è€…ç›´æ¥ï¼š</span><br><span class="line">è¿›å…¥æ•°æ®åº“ï¼ŒæŸ¥çœ‹ä¸€ä¸‹å½“å‰ä½¿ç”¨çš„binlogæ—¥å¿—æ˜¯å“ªä¸ªï¼Œé™¤äº†è¿™ä¸ªä»¥å¤–çš„ï¼Œå…¶å®ƒéƒ½å¯ä»¥ä½¿ç”¨<span class="built_in">rm</span> -rf åˆ é™¤ï¼</span><br><span class="line">relay <span class="built_in">log</span> å¯ä»¥é€šè¿‡ä¿®æ”¹ä¸€ä¸ªå‚æ•°è‡ªåŠ¨åˆ é™¤ï¼Œå‰é¢å·²ç»ä»‹ç»è¿‡å‚æ•°ï¼šrelay_log_purge=on å³å¯ï¼Œè‡ªåŠ¨æ¸…ç©ºä¸å†éœ€è¦ä¸­ç»§æ—¥å¿—ã€‚</span><br><span class="line">æ€»ç»“ï¼š</span><br><span class="line">mysqlæ•°æ®åº“çš„binlogå’Œrelay <span class="built_in">log</span>æ—¥å¿—æœ‰ç€ä¸¾è¶³è½»é‡çš„ä½œç”¨ï¼Œå¹¶ä¸”relay <span class="built_in">log</span>ä»…ä»…å­˜åœ¨äºmysql çš„slaveåº“ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯è®°å½•slaveåº“ä¸­çš„ioè¿›ç¨‹æ¥æ”¶çš„ä»ä¸»åº“ä¼ è¿‡æ¥çš„binlog,ç„¶åç­‰å¾…slaveåº“çš„sqlè¿›ç¨‹å»è¯»å–å’Œåº”ç”¨ï¼Œä¿è¯ä¸»ä»åŒæ­¥ï¼Œä½†æ˜¯binlogä¸»åº“å’Œä»åº“ï¼ˆslaveï¼‰éƒ½å¯ä»¥å­˜åœ¨ï¼Œè®°å½•å¯¹æ•°æ®å‘ç”Ÿæˆ–æ½œåœ¨å‘ç”Ÿæ›´æ”¹çš„SQLè¯­å¥ï¼Œå¹¶ä»¥äºŒè¿›åˆ¶çš„å½¢å¼ä¿å­˜åœ¨ç£ç›˜ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡binlogæ¥å®æ—¶å¤‡ä»½å’Œæ¢å¤æ•°æ®åº“ã€‚</span><br><span class="line">å‚æ•°ä¸»è¦åœ¨å¤šä¸»å¤šä»çš„é›†ç¾¤æ¶æ„ä¸­å¼€å¯ï¼Œå¦åˆ™ä¼šå¯¼è‡´å„ä»å®ä¾‹æ— æ³•å®Œæ•´åŒæ­¥é›†ç¾¤çš„å…¨é‡æ•°æ®çš„é—®é¢˜ã€‚</span><br><span class="line">å¤šä»ä¸€ä»</span><br><span class="line">åœ¨å¤šä¸»ä¸€ä»æ¨¡å¼ä¸‹ï¼Œlogs-slave-updateså°±æ²¡é‚£ä¹ˆå¿…é¡»äº†ï¼Œå„ä¸»å®ä¾‹åªéœ€ç»´æŠ¤å¥½è‡ªèº«çš„ bin-logï¼Œä»å®ä¾‹åˆ™åˆ†åˆ«è¯»å–å„ä¸»å®ä¾‹çš„bin-logæ±‡æ€»é›†ç¾¤çš„å…¨é‡æ•°æ®ï¼Œè¿˜å¯ä»¥ä¸€å®šå±‚åº¦ä¸Šæé«˜é›†ç¾¤æ€§èƒ½ã€‚</span><br><span class="line">ä½†ä¸ºäº†ä¿è¯å®¹ç¾æ¢å¤ï¼Œè¿˜æ˜¯è¦å°½å¯èƒ½çš„ä¿è¯logs-slave-updatesçš„å¼€å¯ï¼Œå¦åˆ™æ¯å°ä¸»å®ä¾‹éƒ½åªæœ‰è‡ªèº«æ•°æ®æ›´æ–°çš„bin-logï¼Œéƒ½åªèƒ½æ¢å¤é›†ç¾¤æ•°æ®çš„ä¸€éƒ¨åˆ†ï¼Œè™½ç„¶ä¹Ÿå¯ä»¥åªæ¢å¤å„è‡ªçš„bin-logå†å…¨é‡åŒæ­¥å…¶ä»–ä¸»å®ä¾‹çš„æ•°æ®ï¼Œä½†ç›¸å¯¹éº»çƒ¦äº›ã€‚</span><br><span class="line">logs-slave-updates=1</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¡¨ç¤ºè¶…è¿‡30å¤©çš„binlogåˆ é™¤,å¯ç”¨äºŒè¿›åˆ¶æ—¥å¿—åä¿ç•™æ—¥å¿—çš„å¤©æ•°ã€‚æœåŠ¡å™¨ä¼šè‡ªåŠ¨æ¸…ç†æŒ‡å®šå¤©æ•°å‰çš„æ—¥å¿—æ–‡ä»¶ï¼Œå¦‚æœä¸è®¾ç½®åˆ™ä¼šå¯¼è‡´æœåŠ¡å™¨ç©ºé—´è€—å°½ã€‚ä¸€èˆ¬è®¾ç½®ä¸º7ï½30å¤©ã€‚</span></span><br><span class="line">expire_logs_days = 30</span><br><span class="line"></span><br><span class="line"><span class="comment"># binlogè¯¦è§£</span></span><br><span class="line">ä¸€ã€binlogå¤åˆ¶æ–¹å¼</span><br><span class="line">mysqlå¤åˆ¶ä¸»è¦æœ‰ä¸‰ç§æ–¹å¼ï¼šåŸºäºSQLè¯­å¥çš„å¤åˆ¶(statement-based replication, SBR)ï¼ŒåŸºäºè¡Œçš„å¤åˆ¶(row-based replication, RBR)ï¼Œæ··åˆæ¨¡å¼å¤åˆ¶(mixed-based replication, MBR)ã€‚å¯¹åº”çš„ï¼Œbinlogçš„æ ¼å¼ä¹Ÿæœ‰ä¸‰ç§ï¼šSTATEMENTï¼ŒROWï¼ŒMIXEDã€‚</span><br><span class="line">â‘  STATEMENTæ¨¡å¼ï¼ˆSBRï¼‰</span><br><span class="line">æ¯ä¸€æ¡ä¼šä¿®æ”¹æ•°æ®çš„sqlè¯­å¥ä¼šè®°å½•åˆ°binlogä¸­ï¼Œslaveåœ¨å¤åˆ¶çš„æ—¶å€™sqlè¿›ç¨‹ä¼šè§£ææˆmasterç«¯æ‰§è¡Œè¿‡çš„ç›¸åŒçš„sqlåœ¨slaveåº“ä¸Šå†æ¬¡æ‰§è¡Œã€‚</span><br><span class="line">ä¼˜ç‚¹ï¼šstatement levelä¸‹çš„ä¼˜ç‚¹é¦–å…ˆå°±æ˜¯è§£å†³äº†row levelä¸‹çš„ç¼ºç‚¹ï¼Œä¸éœ€è¦æ¯ä¸€æ¡sqlè¯­å¥å’Œè®°å½•æ¯ä¸€è¡Œçš„å˜åŒ–ï¼Œè¾ƒå°‘binlogæ—¥å¿—é‡ï¼ŒèŠ‚çº¦IOï¼Œæé«˜æ€§èƒ½ã€‚å› ä¸ºå®ƒåªéœ€è¦è®°å½•åœ¨masterä¸Šæ‰€æ‰§è¡Œçš„è¯­å¥çš„ç»†èŠ‚ï¼Œä»¥åŠæ‰§è¡Œè¯­å¥æ—¶å€™çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</span><br><span class="line">ç¼ºç‚¹ï¼šç”±äºå®ƒæ˜¯è®°å½•æ‰§è¡Œè¯­å¥ï¼Œæ‰€ä»¥ï¼Œä¸ºäº†è®©è¿™äº›è¯­å¥åœ¨slaveç«¯ä¹Ÿèƒ½æ­£ç¡®æ‰§è¡Œï¼Œé‚£ä¹ˆå®ƒè¿˜å¿…é¡»è®°å½•æ¯æ¡è¯­å¥åœ¨æ‰§è¡Œçš„æ—¶å€™çš„ä¸€äº›ç›¸å…³ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œæ¥ä¿è¯æ‰€æœ‰è¯­å¥åœ¨slaveç«¯èƒ½å¤Ÿå¾—åˆ°å’Œåœ¨masterç«¯ç›¸åŒçš„æ‰§è¡Œç»“æœã€‚ç”±äºmysqlæ›´æ–°è¾ƒå¿«ï¼Œä½¿mysqlçš„èµ‹å€¼é‡åˆ°äº†ä¸å°çš„æŒ‘æˆ˜ï¼Œè‡ªç„¶èµ‹å€¼çš„æ—¶å€™å°±ä¼šæ¶‰åŠåˆ°è¶Šå¤æ‚çš„å†…å®¹ï¼Œbugä¹Ÿå°±å®¹æ˜“å‡ºç°ã€‚åœ¨statement levelä¸‹ï¼Œç›®å‰å°±å·²ç»å‘ç°äº†ä¸å°‘æƒ…å†µä¼šé€ æˆmysqlçš„å¤åˆ¶å‡ºç°é—®é¢˜ï¼Œä¸»è¦æ˜¯ä¿®æ”¹æ•°æ®çš„æ—¶å€™ä½¿ç”¨äº†æŸäº›ç‰¹å®šçš„å‡½æ•°æˆ–è€…åŠŸèƒ½çš„æ—¶å€™ä¼šå‡ºç°ã€‚æ¯”å¦‚ï¼š<span class="built_in">sleep</span>ï¼ˆï¼‰å‡½æ•°åœ¨æœ‰äº›ç‰ˆæœ¬ä¸­å°±ä¸èƒ½æ­£ç¡®èµ‹å€¼ï¼Œåœ¨å­˜å‚¨è¿‡ç¨‹ä¸­ä½¿ç”¨äº†last_insert_idï¼ˆï¼‰å‡½æ•°ï¼Œä»¥åŠuser-defined <span class="built_in">functions</span>(udf)ç­‰ï¼Œå¯èƒ½ä¼šä½¿slaveå’Œmasterä¸Šå¾—åˆ°ä¸ä¸€è‡´çš„<span class="built_in">id</span>ç­‰ç­‰ã€‚ç”±äºrow levelæ˜¯åŸºäºæ¯ä¸€è¡Œè®°å½•çš„è£±èŠ±ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°ç±»ä¼¼çš„é—®é¢˜ã€‚</span><br><span class="line">æ€»ç»“ï¼š</span><br><span class="line">Statement levelä¼˜ç‚¹ï¼š</span><br><span class="line">1ã€è§£å†³äº†row levelçš„ç¼ºç‚¹ï¼Œä¸éœ€è¦è®°å½•æ¯ä¸€è¡Œçš„å˜åŒ–ã€‚</span><br><span class="line">2ã€æ—¥å¿—é‡å°‘ï¼ŒèŠ‚çº¦IOï¼Œä»åº“åº”ç”¨æ—¥å¿—å—ã€‚</span><br><span class="line">Statement levelç¼ºç‚¹ï¼šä¸€äº›æ–°åŠŸèƒ½åŒæ­¥å¯èƒ½ä¼šæœ‰éšœç¢,æ¯”å¦‚å‡½æ•°ã€è§¦å‘å™¨ç­‰ã€‚</span><br><span class="line"></span><br><span class="line">â‘¡ ROWæ¨¡å¼ï¼ˆRBRï¼‰</span><br><span class="line">ä¸è®°å½•æ¯æ¡sqlè¯­å¥çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä»…éœ€è®°å½•å“ªæ¡æ•°æ®è¢«ä¿®æ”¹äº†ï¼Œä¿®æ”¹æˆä»€ä¹ˆæ ·äº†ã€‚è€Œä¸”ä¸ä¼šå‡ºç°æŸäº›ç‰¹å®šæƒ…å†µä¸‹çš„å­˜å‚¨è¿‡ç¨‹ã€æˆ–<span class="keyword">function</span>ã€æˆ–triggerçš„è°ƒç”¨å’Œè§¦å‘æ— æ³•è¢«æ­£ç¡®å¤åˆ¶çš„é—®é¢˜ã€‚ç¼ºç‚¹æ˜¯ä¼šäº§ç”Ÿå¤§é‡çš„æ—¥å¿—ï¼Œå°¤å…¶æ˜¯alter tableçš„æ—¶å€™ä¼šè®©æ—¥å¿—æš´æ¶¨ã€‚æ—¥å¿—ä¸­ä¼šè®°å½•æˆæ¯ä¸€è¡Œæ•°æ®ä¿®æ”¹çš„å½¢å¼ï¼Œç„¶ååœ¨slaveç«¯å†å¯¹ç›¸åŒçš„æ•°æ®è¿›è¡Œä¿®æ”¹ã€‚</span><br><span class="line">ä¼˜ç‚¹ï¼šåœ¨row levelçš„æ¨¡å¼ä¸‹ï¼Œbinlogä¸­å¯ä»¥ä¸è®°å½•æ‰§è¡Œçš„sqlè¯­å¥çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä»…ä»…åªéœ€è¦è®°å½•å“ªä¸€æ¡è®°å½•è¢«ä¿®æ”¹ï¼Œä¿®æ”¹æˆä»€ä¹ˆæ ·ã€‚æ‰€ä»¥row levelçš„æ—¥å¿—å†…å®¹ä¼šéå¸¸æ¸…æ¥šçš„è®°å½•æ¯ä¸€è¡Œæ•°æ®ä¿®æ”¹çš„ç»†èŠ‚ï¼Œéå¸¸å®¹æ˜“ç†è§£ã€‚è€Œä¸”ä¸ä¼šå‡ºç°æŸäº›ç‰¹å®šæƒ…å†µä¸‹çš„å­˜å‚¨è¿‡ç¨‹ï¼Œæˆ–fuctionï¼Œä»¥åŠtriggerçš„è°ƒç”¨æˆ–å¤„ç½šæ— æ³•è¢«æ­£ç¡®å¤åˆ¶çš„é—®é¢˜ã€‚</span><br><span class="line">ç¼ºç‚¹ï¼šrow levelæ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰çš„æ‰§è¡Œè¯­å¥éƒ½ä¼šè®°å½•åˆ°æ—¥å¿—ä¸­ï¼ŒåŒæ—¶éƒ½ä¼šä»¥æ¯è¡Œè®°å½•ä¿®æ”¹çš„æ¥è®°å½•ï¼Œè¿™æ ·å¯èƒ½ä¼šäº§ç”Ÿå¤§é‡çš„æ—¥å¿—å†…å®¹ã€‚</span><br><span class="line">æ€»ç»“ï¼š</span><br><span class="line">row levelçš„ä¼˜ç‚¹ï¼š</span><br><span class="line">1ã€è®°å½•è¯¦ç»†</span><br><span class="line">2ã€è§£å†³statement levelæ¨¡å¼æ— æ³•è§£å†³çš„å¤åˆ¶é—®é¢˜ã€‚</span><br><span class="line">row levelçš„ç¼ºç‚¹ï¼šæ—¥å¿—é‡å¤§ï¼Œå› ä¸ºæ˜¯æŒ‰è¡Œæ¥æ‹†åˆ†ã€‚</span><br><span class="line"> </span><br><span class="line">â‘¢ MIXEDæ¨¡å¼ï¼ˆMBRï¼‰</span><br><span class="line">ä»¥ä¸Šä¸¤ç§æ¨¡å¼çš„æ··åˆä½¿ç”¨ï¼Œä¸€èˆ¬çš„å¤åˆ¶ä½¿ç”¨STATEMENTæ¨¡å¼ä¿å­˜binlogï¼Œå¯¹äºSTATEMENTæ¨¡å¼æ— æ³•å¤åˆ¶çš„æ“ä½œä½¿ç”¨ROWæ¨¡å¼ä¿å­˜binlogï¼ŒMySQLä¼šæ ¹æ®æ‰§è¡Œçš„SQLè¯­å¥é€‰æ‹©æ—¥å¿—ä¿å­˜æ–¹å¼ï¼Œä¹Ÿæ˜¯åœ¨statementå’Œrowä¹‹é—´é€‰æ‹©ä¸€ç§ã€‚</span><br><span class="line">æ–°ç‰ˆæœ¬ä¸­çš„mysqlä¸­å¯¹row levelæ¨¡å¼ä¹Ÿåšäº†ä¼˜åŒ–ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ä¿®æ”¹éƒ½ä¼šä»¥row levelæ¥è®°å½•ï¼Œåƒé‡åˆ°è¡¨ç»“æ„å˜æ›´çš„æ—¶å€™å°±ä¼šä»¥statementæ¨¡å¼æ¥è®°å½•ï¼Œå¦‚æœsqlè¯­å¥ç¡®å®å°±æ˜¯updateæˆ–è€…deleteç­‰ä¿®æ”¹æ•°æ®çš„è¯­å¥ï¼Œé‚£ä¹ˆè¿˜æ˜¯ä¼šè®°å½•æ‰€æœ‰è¡Œçš„å˜æ›´ã€‚</span><br><span class="line"> </span><br><span class="line">binlogå¤åˆ¶é…ç½®</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸»ä»å¤åˆ¶äº‹ä»¶æ ¡éªŒ</span></span><br><span class="line">binlog_checksum = none </span><br><span class="line"></span><br><span class="line">åœ¨mysqlçš„é…ç½®æ–‡ä»¶my.cnfä¸­ï¼Œå¯ä»¥é€šè¿‡ä¸€ä¸‹é€‰é¡¹é…ç½®binglogç›¸å…³</span><br><span class="line">binlog_format           = MIXED                         //binlogæ—¥å¿—æ ¼å¼ï¼Œmysqlé»˜è®¤é‡‡ç”¨statementï¼Œå»ºè®®ä½¿ç”¨mixed</span><br><span class="line">log-bin                 = /data/mysql/mysql-bin.log    //binlogæ—¥å¿—æ–‡ä»¶</span><br><span class="line">expire_logs_days        = 7                           //binlogè¿‡æœŸæ¸…ç†æ—¶é—´</span><br><span class="line">max_binlog_size         = 100m                       //binlogæ¯ä¸ªæ—¥å¿—æ–‡ä»¶å¤§å°</span><br><span class="line">binlog_cache_size       = 4m                        //binlogç¼“å­˜å¤§å°</span><br><span class="line">max_binlog_cache_size   = 512m                     //æœ€å¤§binlogç¼“å­˜å¤§å°</span><br><span class="line">å¯¹äºæ‰§è¡Œçš„SQLè¯­å¥ä¸­åŒ…å«now()è¿™æ ·çš„æ—¶é—´å‡½æ•°ï¼Œä¼šåœ¨æ—¥å¿—ä¸­äº§ç”Ÿå¯¹åº”çš„unix_timestamp()*1000çš„æ—¶é—´å­—ç¬¦ä¸²ï¼Œslaveåœ¨å®ŒæˆåŒæ­¥æ—¶ï¼Œå–ç”¨çš„æ˜¯sqlEventå‘ç”Ÿçš„æ—¶é—´æ¥ä¿è¯æ•°æ®çš„å‡†ç¡®æ€§ã€‚å¦å¤–å¯¹äºä¸€äº›åŠŸèƒ½æ€§å‡½æ•°slaveèƒ½å®Œæˆç›¸åº”çš„æ•°æ®åŒæ­¥ï¼Œè€Œå¯¹äºä¸Šé¢æŒ‡å®šçš„ä¸€äº›ç±»ä¼¼äºUDFå‡½æ•°ï¼Œå¯¼è‡´Slaveæ— æ³•çŸ¥æ™“çš„æƒ…å†µï¼Œåˆ™ä¼šé‡‡ç”¨ROWæ ¼å¼å­˜å‚¨è¿™äº›Binlogï¼Œä»¥ä¿è¯äº§ç”Ÿçš„Binlogå¯ä»¥ä¾›Slaveå®Œæˆæ•°æ®åŒæ­¥ã€‚</span><br><span class="line"></span><br><span class="line">ç°åœ¨æ¥æ¯”è¾ƒä»¥ä¸‹ SBR å’Œ RBR 2ä¸­æ¨¡å¼å„è‡ªçš„ä¼˜ç¼ºç‚¹ï¼š</span><br><span class="line"></span><br><span class="line">SBR çš„ä¼˜ç‚¹ï¼š</span><br><span class="line">å†å²æ‚ ä¹…ï¼ŒæŠ€æœ¯æˆç†Ÿ</span><br><span class="line">binlogæ–‡ä»¶è¾ƒå°</span><br><span class="line">binlogä¸­åŒ…å«äº†æ‰€æœ‰æ•°æ®åº“æ›´æ”¹ä¿¡æ¯ï¼Œå¯ä»¥æ®æ­¤æ¥å®¡æ ¸æ•°æ®åº“çš„å®‰å…¨ç­‰æƒ…å†µ</span><br><span class="line">binlogå¯ä»¥ç”¨äºå®æ—¶çš„è¿˜åŸï¼Œè€Œä¸ä»…ä»…ç”¨äºå¤åˆ¶</span><br><span class="line">ä¸»ä»ç‰ˆæœ¬å¯ä»¥ä¸ä¸€æ ·ï¼Œä»æœåŠ¡å™¨ç‰ˆæœ¬å¯ä»¥æ¯”ä¸»æœåŠ¡å™¨ç‰ˆæœ¬é«˜</span><br><span class="line"></span><br><span class="line">SBR çš„ç¼ºç‚¹ï¼š</span><br><span class="line">ä¸æ˜¯æ‰€æœ‰çš„UPDATEè¯­å¥éƒ½èƒ½è¢«å¤åˆ¶ï¼Œå°¤å…¶æ˜¯åŒ…å«ä¸ç¡®å®šæ“ä½œçš„æ—¶å€™ã€‚</span><br><span class="line">è°ƒç”¨å…·æœ‰ä¸ç¡®å®šå› ç´ çš„ UDF æ—¶å¤åˆ¶ä¹Ÿå¯èƒ½å‡ºé—®é¢˜</span><br><span class="line">ä½¿ç”¨ä»¥ä¸‹å‡½æ•°çš„è¯­å¥ä¹Ÿæ— æ³•è¢«å¤åˆ¶ï¼š</span><br><span class="line">* LOAD_FILE()</span><br><span class="line">* UUID()</span><br><span class="line">* USER()</span><br><span class="line">* FOUND_ROWS()</span><br><span class="line">* SYSDATE() (é™¤éå¯åŠ¨æ—¶å¯ç”¨äº† --sysdate-is-now é€‰é¡¹)</span><br><span class="line">INSERT ... SELECT ä¼šäº§ç”Ÿæ¯” RBR æ›´å¤šçš„è¡Œçº§é”</span><br><span class="line">å¤åˆ¶éœ€è¦è¿›è¡Œå…¨è¡¨æ‰«æ(WHERE è¯­å¥ä¸­æ²¡æœ‰ä½¿ç”¨åˆ°ç´¢å¼•)çš„ UPDATE æ—¶ï¼Œéœ€è¦æ¯” RBR è¯·æ±‚æ›´å¤šçš„è¡Œçº§é”</span><br><span class="line">å¯¹äºæœ‰ AUTO_INCREMENT å­—æ®µçš„ InnoDBè¡¨è€Œè¨€ï¼ŒINSERT è¯­å¥ä¼šé˜»å¡å…¶ä»– INSERT è¯­å¥</span><br><span class="line">å¯¹äºä¸€äº›å¤æ‚çš„è¯­å¥ï¼Œåœ¨ä»æœåŠ¡å™¨ä¸Šçš„è€—èµ„æºæƒ…å†µä¼šæ›´ä¸¥é‡ï¼Œè€Œ RBR æ¨¡å¼ä¸‹ï¼Œåªä¼šå¯¹é‚£ä¸ªå‘ç”Ÿå˜åŒ–çš„è®°å½•äº§ç”Ÿå½±å“</span><br><span class="line">å­˜å‚¨å‡½æ•°(ä¸æ˜¯å­˜å‚¨è¿‡ç¨‹)åœ¨è¢«è°ƒç”¨çš„åŒæ—¶ä¹Ÿä¼šæ‰§è¡Œä¸€æ¬¡ NOW() å‡½æ•°ï¼Œè¿™ä¸ªå¯ä»¥è¯´æ˜¯åäº‹ä¹Ÿå¯èƒ½æ˜¯å¥½äº‹</span><br><span class="line">ç¡®å®šäº†çš„ UDF ä¹Ÿéœ€è¦åœ¨ä»æœåŠ¡å™¨ä¸Šæ‰§è¡Œ</span><br><span class="line">æ•°æ®è¡¨å¿…é¡»å‡ ä¹å’Œä¸»æœåŠ¡å™¨ä¿æŒä¸€è‡´æ‰è¡Œï¼Œå¦åˆ™å¯èƒ½ä¼šå¯¼è‡´å¤åˆ¶å‡ºé”™</span><br><span class="line">æ‰§è¡Œå¤æ‚è¯­å¥å¦‚æœå‡ºé”™çš„è¯ï¼Œä¼šæ¶ˆè€—æ›´å¤šèµ„æº</span><br><span class="line"></span><br><span class="line">RBR çš„ä¼˜ç‚¹ï¼š</span><br><span class="line">ä»»ä½•æƒ…å†µéƒ½å¯ä»¥è¢«å¤åˆ¶ï¼Œè¿™å¯¹å¤åˆ¶æ¥è¯´æ˜¯æœ€å®‰å…¨å¯é çš„</span><br><span class="line">å’Œå…¶ä»–å¤§å¤šæ•°æ•°æ®åº“ç³»ç»Ÿçš„å¤åˆ¶æŠ€æœ¯ä¸€æ ·</span><br><span class="line">å¤šæ•°æƒ…å†µä¸‹ï¼Œä»æœåŠ¡å™¨ä¸Šçš„è¡¨å¦‚æœæœ‰ä¸»é”®çš„è¯ï¼Œå¤åˆ¶å°±ä¼šå¿«äº†å¾ˆå¤š</span><br><span class="line">å¤åˆ¶ä»¥ä¸‹å‡ ç§è¯­å¥æ—¶çš„è¡Œé”æ›´å°‘ï¼š</span><br><span class="line">* INSERT ... SELECT</span><br><span class="line">* åŒ…å« AUTO_INCREMENT å­—æ®µçš„ INSERT</span><br><span class="line">* æ²¡æœ‰é™„å¸¦æ¡ä»¶æˆ–è€…å¹¶æ²¡æœ‰ä¿®æ”¹å¾ˆå¤šè®°å½•çš„ UPDATE æˆ– DELETE è¯­å¥</span><br><span class="line">æ‰§è¡Œ INSERTï¼ŒUPDATEï¼ŒDELETE è¯­å¥æ—¶é”æ›´å°‘</span><br><span class="line">ä»æœåŠ¡å™¨ä¸Šé‡‡ç”¨å¤šçº¿ç¨‹æ¥æ‰§è¡Œå¤åˆ¶æˆä¸ºå¯èƒ½</span><br><span class="line"></span><br><span class="line">RBR çš„ç¼ºç‚¹ï¼š</span><br><span class="line">binlog å¤§äº†å¾ˆå¤š</span><br><span class="line">å¤æ‚çš„å›æ»šæ—¶ binlog ä¸­ä¼šåŒ…å«å¤§é‡çš„æ•°æ®</span><br><span class="line">ä¸»æœåŠ¡å™¨ä¸Šæ‰§è¡Œ UPDATE è¯­å¥æ—¶ï¼Œæ‰€æœ‰å‘ç”Ÿå˜åŒ–çš„è®°å½•éƒ½ä¼šå†™åˆ° binlog ä¸­ï¼Œè€Œ SBR åªä¼šå†™ä¸€æ¬¡ï¼Œè¿™ä¼šå¯¼è‡´é¢‘ç¹å‘ç”Ÿ binlog çš„å¹¶å‘å†™é—®é¢˜</span><br><span class="line">UDF äº§ç”Ÿçš„å¤§ BLOB å€¼ä¼šå¯¼è‡´å¤åˆ¶å˜æ…¢</span><br><span class="line">æ— æ³•ä» binlog ä¸­çœ‹åˆ°éƒ½å¤åˆ¶äº†å†™ä»€ä¹ˆè¯­å¥</span><br><span class="line">å½“åœ¨éäº‹åŠ¡è¡¨ä¸Šæ‰§è¡Œä¸€æ®µå †ç§¯çš„SQLè¯­å¥æ—¶ï¼Œæœ€å¥½é‡‡ç”¨ SBR æ¨¡å¼ï¼Œå¦åˆ™å¾ˆå®¹æ˜“å¯¼è‡´ä¸»ä»æœåŠ¡å™¨çš„æ•°æ®ä¸ä¸€è‡´æƒ…å†µå‘ç”Ÿ</span><br><span class="line"></span><br><span class="line">å¦å¤–ï¼Œé’ˆå¯¹ç³»ç»Ÿåº“ mysql é‡Œé¢çš„è¡¨å‘ç”Ÿå˜åŒ–æ—¶çš„å¤„ç†è§„åˆ™å¦‚ä¸‹ï¼š</span><br><span class="line">å¦‚æœæ˜¯é‡‡ç”¨ INSERTï¼ŒUPDATEï¼ŒDELETE ç›´æ¥æ“ä½œè¡¨çš„æƒ…å†µï¼Œåˆ™æ—¥å¿—æ ¼å¼æ ¹æ® binlog_format çš„è®¾å®šè€Œè®°å½•</span><br><span class="line">å¦‚æœæ˜¯é‡‡ç”¨ GRANTï¼ŒREVOKEï¼ŒSET PASSWORD ç­‰ç®¡ç†è¯­å¥æ¥åšçš„è¯ï¼Œé‚£ä¹ˆæ— è®ºå¦‚ä½•éƒ½é‡‡ç”¨ SBR æ¨¡å¼è®°å½•</span><br><span class="line">æ³¨ï¼šé‡‡ç”¨ RBR æ¨¡å¼åï¼Œèƒ½è§£å†³å¾ˆå¤šåŸå…ˆå‡ºç°çš„ä¸»é”®é‡å¤é—®é¢˜ã€‚</span><br></pre></td></tr></table></figure><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># innodbé€‰é¡¹</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šè¯¥å‚æ•°å¯ä»¥æå‡æ‰©å±•æ€§å’Œåˆ·è„é¡µæ€§èƒ½ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼1ï¼Œå»ºè®®å€¼ï¼š4-8ï¼›å¹¶ä¸”å¿…é¡»å°äºinnodb_buffer_pool_instances</span></span><br><span class="line">innodb_page_cleaners = 4</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜:åªæœ‰å½“è®¾ç½® innodb_buffer_pool_size å€¼å¤§äº1Gæ—¶æ‰æœ‰æ„ä¹‰ï¼Œå°äº1Gï¼Œinstancesé»˜è®¤ä¸º1ï¼Œå¤§äº1Gï¼Œinstancesé»˜è®¤ä¸º8</span></span><br><span class="line"><span class="comment"># ä½†æ˜¯ç½‘ç»œä¸Šæœ‰è¯„ä»·ï¼Œæœ€ä½³æ€§èƒ½ï¼Œæ¯ä¸ªå®ä¾‹è‡³å°‘1Gå¤§å°ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ï¼š1æˆ–8ï¼Œå»ºè®®å€¼ï¼šinnodb_buffer_pool_size/innodb_buffer_pool_instances &gt;= 1G</span></span><br><span class="line">innodb_buffer_pool_instances = 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šmysql 5.7 æ–°ç‰¹æ€§ï¼Œdefines the chunk size for online InnoDB buffer pool resizing operations.</span></span><br><span class="line"><span class="comment"># å®é™…ç¼“å†²åŒºå¤§å°å¿…é¡»ä¸ºinnodb_buffer_pool_chunk_size*innodb_buffer_pool_instances*å€æ•°ï¼Œå–ç•¥å¤§äºinnodb_buffer_pool_size</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼128Mï¼Œå»ºè®®å€¼ï¼šé»˜è®¤å€¼å°±å¥½ï¼Œä¹±æ”¹åè€Œå®¹æ˜“å‡ºé—®é¢˜ï¼Œå®ƒä¼šå½±å“å®é™…buffer poolå¤§å°ã€‚</span></span><br><span class="line">innodb_buffer_pool_chunk_size = 128M </span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨å¯åŠ¨æ—¶æŠŠçƒ­æ•°æ®åŠ è½½åˆ°å†…å­˜ã€‚é»˜è®¤å€¼ä¸ºonï¼Œä¸ä¿®æ”¹</span></span><br><span class="line">innodb_buffer_pool_load_at_startup = 1</span><br><span class="line"><span class="comment"># åœ¨å…³é—­æ—¶æŠŠçƒ­æ•°æ®dumpåˆ°æœ¬åœ°ç£ç›˜ã€‚é»˜è®¤å€¼ä¸ºonï¼Œä¸ä¿®æ”¹</span></span><br><span class="line">innodb_buffer_pool_dump_at_shutdown = 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šå½±å“Innodbç¼“å†²åŒºçš„åˆ·æ–°ç®—æ³•ï¼Œå»ºè®®ä»å°åˆ°å¤§é…ç½®ï¼Œç›´åˆ°zero free pagesï¼›innodb_lru_scan_depth * innodb_buffer_pool_instances defines the amount of work performed by the page cleaner thread each second.</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼1024ï¼Œå»ºè®®å€¼: æœªçŸ¥</span></span><br><span class="line">innodb_lru_scan_depth = 1024</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šä¸€èˆ¬8kå’Œ16kä¸­é€‰æ‹©ï¼Œ8kçš„è¯ï¼Œcpuæ¶ˆè€—å°äº›ï¼Œselcetæ•ˆç‡é«˜ä¸€ç‚¹ï¼Œä¸€èˆ¬ä¸ç”¨æ”¹</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ï¼š16kï¼›å»ºè®®å€¼ï¼šä¸æ”¹ï¼Œ</span></span><br><span class="line">innodb_page_size = 16384</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–°æ•°æ®è¡¨çš„é»˜è®¤å­˜å‚¨å¼•æ“(é»˜è®¤è®¾ç½®æ˜¯MyISAM)ã€‚è¿™é¡¹è®¾ç½®è¿˜å¯ä»¥é€šè¿‡â€“default-table-typeé€‰é¡¹æ¥è®¾ç½®ã€‚</span></span><br><span class="line"><span class="comment"># InnoDBä¸ºç‹¬ç«‹è¡¨ç©ºé—´æ¨¡å¼ï¼Œæ¯ä¸ªæ•°æ®åº“çš„æ¯ä¸ªè¡¨éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ•°æ®ç©ºé—´ã€‚å½“åˆ é™¤æˆ–æˆªæ–­ä¸€ä¸ªæ•°æ®åº“è¡¨æ—¶ï¼Œä½ ä¹Ÿå¯ä»¥å›æ”¶æœªä½¿ç”¨çš„ç©ºé—´ã€‚è¿™æ ·é…ç½®çš„å¦ä¸€ä¸ªå¥½å¤„æ˜¯ä½ å¯ä»¥å°†æŸäº›æ•°æ®åº“è¡¨æ”¾åœ¨ä¸€ä¸ªå•ç‹¬çš„å­˜å‚¨è®¾å¤‡ã€‚è¿™å¯ä»¥å¤§å¤§æå‡ä½ ç£ç›˜çš„I/Oè´Ÿè½½ã€‚</span></span><br><span class="line"><span class="comment"># ç‹¬ç«‹è¡¨ç©ºé—´ä¼˜ç‚¹ï¼š  </span></span><br><span class="line"><span class="comment"># 1ï¼æ¯ä¸ªè¡¨éƒ½æœ‰è‡ªå·²ç‹¬ç«‹çš„è¡¨ç©ºé—´ã€‚  </span></span><br><span class="line"><span class="comment"># 2ï¼æ¯ä¸ªè¡¨çš„æ•°æ®å’Œç´¢å¼•éƒ½ä¼šå­˜åœ¨è‡ªå·²çš„è¡¨ç©ºé—´ä¸­ã€‚  </span></span><br><span class="line"><span class="comment"># 3ï¼å¯ä»¥å®ç°å•è¡¨åœ¨ä¸åŒçš„æ•°æ®åº“ä¸­ç§»åŠ¨ã€‚  </span></span><br><span class="line"><span class="comment"># 4ï¼ç©ºé—´å¯ä»¥å›æ”¶ï¼ˆé™¤drop tableæ“ä½œå¤„ï¼Œè¡¨ç©ºä¸èƒ½è‡ªå·²å›æ”¶ï¼‰  </span></span><br><span class="line"><span class="comment"># ç¼ºç‚¹ï¼š  </span></span><br><span class="line"><span class="comment"># å•è¡¨å¢åŠ è¿‡å¤§ï¼Œå¦‚è¶…è¿‡100G  </span></span><br><span class="line"><span class="comment"># ç»“è®ºï¼š  </span></span><br><span class="line"><span class="comment"># å…±äº«è¡¨ç©ºé—´åœ¨Insertæ“ä½œä¸Šå°‘æœ‰ä¼˜åŠ¿ã€‚å…¶å®ƒéƒ½æ²¡ç‹¬ç«‹è¡¨ç©ºé—´è¡¨ç°å¥½ã€‚å½“å¯ç”¨ç‹¬ç«‹è¡¨ç©ºé—´æ—¶ï¼Œè¯·åˆç†è°ƒæ•´ï¼šinnodb_open_files</span></span><br><span class="line">innodb_file_per_table = 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šé™åˆ¶Innodbèƒ½æ‰“å¼€çš„è¡¨çš„æ•°æ®ï¼Œå¦‚æœåº“é‡Œçš„è¡¨ç‰¹åˆ«å¤šçš„æƒ…å†µï¼Œè¯·å¢åŠ è¿™ä¸ªã€‚</span></span><br><span class="line"><span class="comment"># å€¼é»˜è®¤æ˜¯2000ï¼Œå»ºè®®å€¼ï¼šå‚è€ƒæ•°æ®åº“è¡¨æ€»æ•°å†è¿›è¡Œè°ƒæ•´ï¼Œä¸€èˆ¬å¤Ÿç”¨ä¸ç”¨è°ƒæ•´ã€‚</span></span><br><span class="line">innodb_open_files = 8192</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šThe path where InnoDB creates undo tablespaces.é€šå¸¸ç­‰äºundo logæ–‡ä»¶çš„å­˜æ”¾ç›®å½•ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼./;è‡ªè¡Œè®¾ç½®</span></span><br><span class="line">innodb_undo_directory = /usr/local/mysql-5.7.21/log  </span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šThe number of undo tablespaces used by InnoDB.ç­‰äºundo logæ–‡ä»¶æ•°é‡ã€‚5.7.21åå¼€å§‹å¼ƒç”¨</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ä¸º0ï¼Œå»ºè®®é»˜è®¤å€¼å°±å¥½ï¼Œä¸ç”¨è°ƒæ•´äº†ã€‚</span></span><br><span class="line">innodb_undo_tablespaces = 0</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šå®šä¹‰undoä½¿ç”¨çš„å›æ»šæ®µæ•°é‡ã€‚5.7.19åå¼ƒç”¨</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼128ï¼Œå»ºè®®ä¸åŠ¨ï¼Œä»¥åå¼ƒç”¨äº†ã€‚</span></span><br><span class="line">innodb_undo_logs = 128</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼š5.7.5åå¼€å§‹ä½¿ç”¨ï¼Œåœ¨çº¿æ”¶ç¼©undo logä½¿ç”¨çš„ç©ºé—´ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ï¼šå…³é—­ï¼Œå»ºè®®å€¼ï¼šå¼€å¯</span></span><br><span class="line">innodb_undo_log_truncate = 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šç»“åˆinnodb_undo_log_truncateï¼Œå®ç°undoç©ºé—´æ”¶ç¼©åŠŸèƒ½</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ï¼š1Gï¼Œå»ºè®®å€¼ï¼Œä¸æ”¹ã€‚</span></span><br><span class="line">innodb_max_undo_log_size = 1G</span><br><span class="line"></span><br><span class="line"><span class="comment"># InnoDBä¸»ç›®å½•ï¼Œæ‰€æœ‰ä¸InnoDBæ•°æ®è¡¨æœ‰å…³çš„ç›®å½•æˆ–æ–‡ä»¶è·¯å¾„éƒ½ç›¸å¯¹äºè¿™ä¸ªè·¯å¾„ã€‚åœ¨é»˜è®¤çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªä¸»ç›®å½•å°±æ˜¯MySQLçš„æ•°æ®ç›®å½•ã€‚</span></span><br><span class="line">innodb_data_home_dir = /apps/mysql/data</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨æ¥å®¹çº³InnoDBä¸ºæ•°æ®è¡¨çš„è¡¨ç©ºé—´: å¯èƒ½æ¶‰åŠä¸€ä¸ªä»¥ä¸Šçš„æ–‡ä»¶; æ¯ä¸€ä¸ªè¡¨ç©ºé—´æ–‡ä»¶çš„æœ€å¤§é•¿åº¦éƒ½å¿…é¡»ä»¥å­—èŠ‚(B)ã€å…†å­—èŠ‚(MB)æˆ–åƒå…†å­—èŠ‚(GB)ä¸ºå•ä½ç»™å‡º; è¡¨ç©ºé—´æ–‡ä»¶çš„åå­—å¿…é¡»ä»¥åˆ†å·éš”å¼€; æœ€åä¸€ä¸ªè¡¨ç©ºé—´æ–‡ä»¶è¿˜å¯ä»¥å¸¦ä¸€ä¸ªautoextendå±æ€§å’Œä¸€ä¸ªæœ€å¤§é•¿åº¦(max:n)ã€‚</span></span><br><span class="line">innodb_data_file_path = ibdata1:10M:autoextend</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜:è®¾ç½®äº†InnoDBå­˜å‚¨å¼•æ“ç”¨æ¥å­˜æ”¾æ•°æ®å­—å…¸ä¿¡æ¯ä»¥åŠä¸€äº›å†…éƒ¨æ•°æ®ç»“æ„çš„å†…å­˜ç©ºé—´å¤§å°,é™¤éä½ çš„æ•°æ®å¯¹è±¡åŠå…¶å¤šï¼Œå¦åˆ™ä¸€èˆ¬é»˜è®¤ä¸æ”¹ã€‚</span></span><br><span class="line"><span class="comment"># innodb_additional_mem_pool_size = 16M</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨æ¥å­˜æ”¾InnoDBæ—¥å¿—æ–‡ä»¶çš„ç›®å½•è·¯å¾„(å¦‚ib_logfile0ã€ib_logfile1ç­‰)ã€‚åœ¨é»˜è®¤çš„æƒ…å†µä¸‹ï¼ŒInnoDBé©±åŠ¨ç¨‹åºå°†ä½¿ç”¨ MySQLæ•°æ®ç›®å½•ä½œä¸ºè‡ªå·±ä¿å­˜æ—¥å¿—æ–‡ä»¶çš„ä½ç½®ã€‚</span></span><br><span class="line">innodb_log_group_home_dir = /apps/mysql/logs</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™ä¸ªå‚æ•°æ˜¯InnoDBå­˜å‚¨å¼•æ“çš„æ ¸å¿ƒå‚æ•°ï¼Œé»˜è®¤ä¸º128KB</span></span><br><span class="line"><span class="comment"># InnoDBä½¿ç”¨ä¸€ä¸ªç¼“å†²æ± æ¥ä¿å­˜ç´¢å¼•å’ŒåŸå§‹æ•°æ®, ä¸åƒMyISAM.  </span></span><br><span class="line"><span class="comment"># è¿™é‡Œä½ è®¾ç½®è¶Šå¤§,ä½ åœ¨å­˜å–è¡¨é‡Œé¢æ•°æ®æ—¶æ‰€éœ€è¦çš„ç£ç›˜I/Oè¶Šå°‘.  </span></span><br><span class="line"><span class="comment"># åœ¨ä¸€ä¸ªç‹¬ç«‹ä½¿ç”¨çš„æ•°æ®åº“æœåŠ¡å™¨ä¸Š,ä½ å¯ä»¥è®¾ç½®è¿™ä¸ªå˜é‡åˆ°æœåŠ¡å™¨ç‰©ç†å†…å­˜å¤§å°çš„60-80%  </span></span><br><span class="line"><span class="comment"># ä¸è¦è®¾ç½®è¿‡å¤§,å¦åˆ™,ç”±äºç‰©ç†å†…å­˜çš„ç«äº‰å¯èƒ½å¯¼è‡´æ“ä½œç³»ç»Ÿçš„æ¢é¡µé¢ ç°¸.  </span></span><br><span class="line"><span class="comment"># æ³¨æ„åœ¨32ä½ç³»ç»Ÿä¸Šä½ æ¯ä¸ªè¿›ç¨‹å¯èƒ½è¢«é™åˆ¶åœ¨ 2-3.5G ç”¨æˆ·å±‚é¢å†…å­˜é™åˆ¶,  </span></span><br><span class="line"><span class="comment"># æ‰€ä»¥ä¸è¦è®¾ç½®çš„å¤ªé«˜.  </span></span><br><span class="line">innodb_buffer_pool_size = 4G</span><br><span class="line"></span><br><span class="line"><span class="comment"># Innodbä½¿ç”¨åå°çº¿ç¨‹å¤„ç†æ•°æ®é¡µä¸Šçš„è¯»å†™ I/O(è¾“å…¥è¾“å‡º)è¯·æ±‚,æ ¹æ®ä½ çš„ CPU æ ¸æ•°æ¥æ›´æ”¹,é»˜è®¤æ˜¯4  </span></span><br><span class="line"><span class="comment"># æ³¨:è¿™ä¸¤ä¸ªå‚æ•°ä¸æ”¯æŒåŠ¨æ€æ”¹å˜,éœ€è¦æŠŠè¯¥å‚æ•°åŠ å…¥åˆ°my.cnfé‡Œï¼Œä¿®æ”¹å®Œåé‡å¯MySQLæœåŠ¡,å…è®¸å€¼çš„èŒƒå›´ä»1-64</span></span><br><span class="line"><span class="comment"># å»ºè®®å€¼ï¼šä¸é€»è¾‘cpuæ•°é‡çš„ä¸€åŠä¿æŒä¸€è‡´ã€‚</span></span><br><span class="line">innodb_write_io_threads = 4</span><br><span class="line">innodb_read_io_threads = 4  </span><br><span class="line"></span><br><span class="line"><span class="comment"># é»˜è®¤è®¾ç½®ä¸º0,è¡¨ç¤ºä¸é™åˆ¶å¹¶å‘æ•°ï¼Œè¿™é‡Œæ¨èè®¾ç½®ä¸º0ï¼Œæ›´å¥½å»å‘æŒ¥CPUå¤šæ ¸å¤„ç†èƒ½åŠ›ï¼Œæé«˜å¹¶å‘é‡</span></span><br><span class="line">innodb_thread_concurrency = 0  </span><br><span class="line"></span><br><span class="line"><span class="comment"># InnoDBä¸­çš„æ¸…é™¤æ“ä½œæ˜¯ä¸€ç±»å®šæœŸå›æ”¶æ— ç”¨æ•°æ®çš„æ“ä½œã€‚åœ¨ä¹‹å‰çš„å‡ ä¸ªç‰ˆæœ¬ä¸­ï¼Œæ¸…é™¤æ“ä½œæ˜¯ä¸»çº¿ç¨‹çš„ä¸€éƒ¨åˆ†ï¼Œè¿™æ„å‘³ç€è¿è¡Œæ—¶å®ƒå¯èƒ½ä¼šå µå¡å…¶å®ƒçš„æ•°æ®åº“æ“ä½œã€‚  </span></span><br><span class="line"><span class="comment"># ä»MySQL5.5.Xç‰ˆæœ¬å¼€å§‹ï¼Œè¯¥æ“ä½œè¿è¡Œäºç‹¬ç«‹çš„çº¿ç¨‹ä¸­,å¹¶æ”¯æŒæ›´å¤šçš„å¹¶å‘æ•°ã€‚</span></span><br><span class="line"><span class="comment"># ç”¨æˆ·å¯é€šè¿‡è®¾ç½®innodb_purge_threadsé…ç½®å‚æ•°æ¥é€‰æ‹©æ¸…é™¤æ“ä½œæ˜¯å¦ä½¿ç”¨å•ç‹¬çº¿ç¨‹,é»˜è®¤æƒ…å†µä¸‹å‚æ•°è®¾ç½®ä¸º0(ä¸ä½¿ç”¨å•ç‹¬çº¿ç¨‹),</span></span><br><span class="line"><span class="comment"># è®¾ç½®ä¸º 1 æ—¶è¡¨ç¤ºä½¿ç”¨å•ç‹¬çš„æ¸…é™¤çº¿ç¨‹ã€‚å»ºè®®ä¸º1</span></span><br><span class="line"><span class="comment"># mysql 5.5ä¹‹åï¼Œæ”¯æŒå¤šçº¿ç¨‹æ¸…é™¤æ“ä½œã€‚</span></span><br><span class="line">innodb_purge_threads = 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šmysqlç¼“å†²åŒºåˆ†ä¸ºnew blockså’Œold blocksï¼›æ­¤å‚æ•°è¡¨ç¤ºold blockså æ¯”ï¼›</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ï¼š37ï¼Œå»ºè®®å€¼ï¼Œä¸€èˆ¬ä¸åŠ¨</span></span><br><span class="line">innodb_old_blocks_pct = 37</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šæ–°æ•°æ®è¢«è½½å…¥ç¼“å†²æ± ï¼Œè¿›å…¥old pagesé“¾åŒºï¼Œå½“1ç§’åå†æ¬¡è®¿é—®ï¼Œåˆ™æå‡è¿›å…¥new pagesé“¾åŒºã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ï¼š1000</span></span><br><span class="line">innodb_old_blocks_time=1000</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šå¼€å¯å¼‚æ­¥ioï¼Œå¯ä»¥æé«˜å¹¶å‘æ€§ï¼Œé»˜è®¤å¼€å¯ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ä¸º1ï¼Œå»ºè®®ä¸åŠ¨</span></span><br><span class="line">innodb_use_native_aio = 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># äº‹åŠ¡æ—¥å¿—æ–‡ä»¶å†™æ“ä½œç¼“å­˜åŒºçš„æœ€å¤§é•¿åº¦(é»˜è®¤è®¾ç½®æ˜¯1MB)ã€‚æ›´å¤§çš„è®¾ç½®å¯ä»¥æé«˜æ€§èƒ½ï¼Œä½†ä¹Ÿä¼šå¢åŠ æ¢å¤æ•…éšœæ•°æ®åº“æ‰€éœ€çš„æ—¶é—´</span></span><br><span class="line">innodb_log_file_size = 1G  </span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸ºæé«˜æ€§èƒ½ï¼ŒMySQLå¯ä»¥ä»¥å¾ªç¯æ–¹å¼å°†æ—¥å¿—æ–‡ä»¶å†™åˆ°å¤šä¸ªæ–‡ä»¶ã€‚é»˜è®¤å€¼2ï¼Œæ¨èè®¾ç½®ä¸º3</span></span><br><span class="line">innodb_log_files_in_group = 3 </span><br><span class="line"></span><br><span class="line"><span class="comment"># innodbä¸»çº¿ç¨‹åˆ·æ–°ç¼“å­˜æ± ä¸­çš„æ•°æ®ï¼Œä½¿è„æ•°æ®æ¯”ä¾‹å°äº90%</span></span><br><span class="line">innodb_max_dirty_pages_pct = 90 </span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»MySQL5.5.Xç‰ˆæœ¬å¼€å§‹ï¼Œä½ å¯ä»¥å¼€å¯InnoDBä¸¥æ ¼æ£€æŸ¥æ¨¡å¼ï¼Œå°¤å…¶é‡‡ç”¨äº†é¡µæ•°æ®å‹ç¼©åŠŸèƒ½åï¼Œæœ€å¥½æ˜¯å¼€å¯è¯¥åŠŸèƒ½ã€‚å¼€å¯æ­¤åŠŸèƒ½åï¼Œå½“åˆ›å»ºè¡¨ï¼ˆCREATE TABLEï¼‰ã€æ›´æ”¹è¡¨ï¼ˆALTER TABLEï¼‰å’Œåˆ›å»ºç´¢å¼•ï¼ˆCREATE INDEXï¼‰è¯­å¥æ—¶ï¼Œå¦‚æœå†™æ³•æœ‰é”™è¯¯ï¼Œä¸ä¼šæœ‰è­¦å‘Šä¿¡æ¯ï¼Œè€Œæ˜¯ç›´æ¥æŠ›å‡ºé”™è¯¯ï¼Œè¿™æ ·å°±å¯ç›´æ¥å°†é—®é¢˜æ‰¼æ€åœ¨æ‘‡ç¯®é‡Œã€‚</span></span><br><span class="line"><span class="comment"># å¼€å¯InnoDBä¸¥æ ¼æ£€æŸ¥æ¨¡å¼æ¶‰åŠçš„å‚æ•°æ˜¯innodb_strict_modeï¼Œé»˜è®¤ä¸ºOFFï¼Œæ”¯æŒåŠ¨æ€å¼€å¯</span></span><br><span class="line">innodb_strict_mode = 0</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ­¤å‚æ•°ç¡®å®šäº›æ—¥å¿—æ–‡ä»¶æ‰€ç”¨çš„å†…å­˜å¤§å°ï¼Œä»¥Mä¸ºå•ä½ã€‚ç¼“å†²åŒºæ›´å¤§èƒ½æé«˜æ€§èƒ½ï¼Œä½†æ„å¤–çš„æ•…éšœå°†ä¼šä¸¢å¤±æ•°æ®ã€‚äº‹åŠ¡æ—¥å¿—æ‰€ä½¿ç”¨çš„ç¼“å­˜åŒºã€‚InnoDBåœ¨å†™äº‹åŠ¡æ—¥å¿—çš„æ—¶å€™ä¸ºäº†æé«˜æ€§èƒ½ï¼Œå…ˆå°†ä¿¡æ¯å†™å…¥Innodb Log Bufferä¸­ï¼Œå½“æ»¡è¶³innodb_flush_log_trx_commitå‚æ•°æ‰€è®¾ç½®çš„ç›¸åº”æ¡ä»¶ï¼ˆæˆ–è€…æ—¥å¿—ç¼“å†²åŒºå†™æ»¡ï¼‰æ—¶ï¼Œå†å°†æ—¥å¿—å†™åˆ°æ–‡ä»¶ï¼ˆæˆ–è€…åŒæ­¥åˆ°ç£ç›˜ï¼‰ä¸­ã€‚å¯ä»¥é€šè¿‡innodb_log_buffer_sizeå‚æ•°è®¾ç½®å…¶å¯ä»¥ä½¿ç”¨çš„æœ€å¤§å†…å­˜ç©ºé—´ã€‚é»˜è®¤æ˜¯8MBï¼Œä¸€èˆ¬ä¸º16ï½64MBå³å¯ã€‚</span></span><br><span class="line">innodb_log_buffer_size = 64M</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šå¯ä»¥æ§åˆ¶logä»ç³»ç»Ÿbufferåˆ·å…¥ç£ç›˜æ–‡ä»¶çš„åˆ·æ–°é¢‘ç‡ï¼Œå¢å¤§å¯å‡è½»ç³»ç»Ÿè´Ÿè·</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼æ˜¯1ï¼›å»ºè®®å€¼ä¸æ”¹ã€‚ç³»ç»Ÿæ€§èƒ½ä¸€èˆ¬å¤Ÿç”¨ã€‚</span></span><br><span class="line">innodb_flush_log_at_timeout = 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™ä¸ªé€‰é¡¹å†³å®šç€ä»€ä¹ˆæ—¶å€™æŠŠæ—¥å¿—ä¿¡æ¯å†™å…¥æ—¥å¿—æ–‡ä»¶ä»¥åŠä»€ä¹ˆæ—¶å€™æŠŠè¿™äº›æ–‡ä»¶ç‰©ç†åœ°å†™(æœ¯è¯­ç§°ä¸ºâ€åŒæ­¥â€)åˆ°ç¡¬ç›˜ä¸Šã€‚</span></span><br><span class="line"><span class="comment"># 0: å¦‚æœinnodb_flush_log_at_trx_commitçš„å€¼ä¸º0,log bufferæ¯ç§’å°±ä¼šè¢«åˆ·å†™æ—¥å¿—æ–‡ä»¶åˆ°ç£ç›˜ï¼Œæäº¤äº‹åŠ¡çš„æ—¶å€™ä¸åšä»»ä½•æ“ä½œï¼ˆæ‰§è¡Œæ˜¯ç”±mysqlçš„master threadçº¿ç¨‹æ¥æ‰§è¡Œçš„ã€‚  </span></span><br><span class="line"><span class="comment"># ä¸»çº¿ç¨‹ä¸­æ¯ç§’ä¼šå°†é‡åšæ—¥å¿—ç¼“å†²å†™å…¥ç£ç›˜çš„é‡åšæ—¥å¿—æ–‡ä»¶(REDO LOG)ä¸­ã€‚ä¸è®ºäº‹åŠ¡æ˜¯å¦å·²ç»æäº¤ï¼‰é»˜è®¤çš„æ—¥å¿—æ–‡ä»¶æ˜¯ib_logfile0,ib_logfile1  </span></span><br><span class="line"><span class="comment"># 1: å½“è®¾ä¸ºé»˜è®¤å€¼1çš„æ—¶å€™ï¼Œæ¯æ¬¡æäº¤äº‹åŠ¡çš„æ—¶å€™ï¼Œéƒ½ä¼šå°†log bufferåˆ·å†™åˆ°æ—¥å¿—ã€‚  </span></span><br><span class="line"><span class="comment"># 2: å¦‚æœè®¾ä¸º2,æ¯æ¬¡æäº¤äº‹åŠ¡éƒ½ä¼šå†™æ—¥å¿—ï¼Œä½†å¹¶ä¸ä¼šæ‰§è¡Œåˆ·çš„æ“ä½œã€‚æ¯ç§’å®šæ—¶ä¼šåˆ·åˆ°æ—¥å¿—æ–‡ä»¶ã€‚è¦æ³¨æ„çš„æ˜¯ï¼Œå¹¶ä¸èƒ½ä¿è¯100%æ¯ç§’ä¸€å®šéƒ½ä¼šåˆ·åˆ°ç£ç›˜ï¼Œè¿™è¦å–å†³äºè¿›ç¨‹çš„è°ƒåº¦ã€‚  </span></span><br><span class="line"><span class="comment"># æ¯æ¬¡äº‹åŠ¡æäº¤çš„æ—¶å€™å°†æ•°æ®å†™å…¥äº‹åŠ¡æ—¥å¿—ï¼Œè€Œè¿™é‡Œçš„å†™å…¥ä»…æ˜¯è°ƒç”¨äº†æ–‡ä»¶ç³»ç»Ÿçš„å†™å…¥æ“ä½œï¼Œè€Œæ–‡ä»¶ç³»ç»Ÿæ˜¯æœ‰ ç¼“å­˜çš„ï¼Œæ‰€ä»¥è¿™ä¸ªå†™å…¥å¹¶ä¸èƒ½ä¿è¯æ•°æ®å·²ç»å†™å…¥åˆ°ç‰©ç†ç£ç›˜</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼1æ˜¯ä¸ºäº†ä¿è¯å®Œæ•´çš„ACIDã€‚å½“ç„¶ï¼Œä½ å¯ä»¥å°†è¿™ä¸ªé…ç½®é¡¹è®¾ä¸º1ä»¥å¤–çš„å€¼æ¥æ¢å–æ›´é«˜çš„æ€§èƒ½ï¼Œä½†æ˜¯åœ¨ç³»ç»Ÿå´©æºƒçš„æ—¶å€™ï¼Œä½ å°†ä¼šä¸¢å¤±1ç§’çš„æ•°æ®ã€‚  </span></span><br><span class="line"><span class="comment"># è®¾ä¸º0çš„è¯ï¼Œmysqldè¿›ç¨‹å´©æºƒçš„æ—¶å€™ï¼Œå°±ä¼šä¸¢å¤±æœ€å1ç§’çš„äº‹åŠ¡ã€‚è®¾ä¸º2,åªæœ‰åœ¨æ“ä½œç³»ç»Ÿå´©æºƒæˆ–è€…æ–­ç”µçš„æ—¶å€™æ‰ä¼šä¸¢å¤±æœ€å1ç§’çš„æ•°æ®ã€‚InnoDBåœ¨åšæ¢å¤çš„æ—¶å€™ä¼šå¿½ç•¥è¿™ä¸ªå€¼ã€‚  </span></span><br><span class="line"><span class="comment"># æ€»ç»“ </span></span><br><span class="line"><span class="comment"># è®¾ä¸º1å½“ç„¶æ˜¯æœ€å®‰å…¨çš„ï¼Œä½†æ€§èƒ½é¡µæ˜¯æœ€å·®çš„ï¼ˆç›¸å¯¹å…¶ä»–ä¸¤ä¸ªå‚æ•°è€Œè¨€ï¼Œä½†ä¸æ˜¯ä¸èƒ½æ¥å—ï¼‰ã€‚å¦‚æœå¯¹æ•°æ®ä¸€è‡´æ€§å’Œå®Œæ•´æ€§è¦æ±‚ä¸é«˜ï¼Œå®Œå…¨å¯ä»¥è®¾ä¸º2ï¼Œå¦‚æœåªæœ€æ±‚æ€§èƒ½ï¼Œä¾‹å¦‚é«˜å¹¶å‘å†™çš„æ—¥å¿—æœåŠ¡å™¨ï¼Œè®¾ä¸º0æ¥è·å¾—æ›´é«˜æ€§èƒ½</span></span><br><span class="line">innodb_flush_log_at_trx_commit = 1  </span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœæŸä¸ªäº‹åŠ¡åœ¨ç­‰å¾…nç§’(s)åè¿˜æ²¡æœ‰è·å¾—æ‰€éœ€è¦çš„èµ„æºï¼Œå°±ä½¿ç”¨ROLLBACKå‘½ä»¤æ”¾å¼ƒè¿™ä¸ªäº‹åŠ¡ã€‚è¿™é¡¹è®¾ç½®å¯¹äºå‘ç°å’Œå¤„ç†æœªèƒ½è¢«InnoDBæ•°æ®è¡¨é©±åŠ¨ ç¨‹åºè¯†åˆ«å‡ºæ¥çš„æ­»é”æ¡ä»¶æœ‰ç€é‡è¦çš„æ„ä¹‰ã€‚</span></span><br><span class="line"><span class="comment"># InnoDBäº‹åŠ¡åœ¨è¢«å›æ»šä¹‹å‰å¯ä»¥ç­‰å¾…ä¸€ä¸ªé”å®šçš„è¶…æ—¶ç§’æ•°ã€‚InnoDBåœ¨å®ƒè‡ªå·±çš„é”å®šè¡¨ä¸­è‡ªåŠ¨æ£€æµ‹äº‹åŠ¡æ­»é”å¹¶ä¸”å›æ»šäº‹åŠ¡ã€‚InnoDBç”¨LOCK TABLESè¯­å¥æ³¨æ„åˆ°é”å®šè®¾ç½®ã€‚é»˜è®¤å€¼æ˜¯50ç§’</span></span><br><span class="line">innodb_lock_wait_timeout = 50</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šè®¾ç½®äº†Mysqlåå°ä»»åŠ¡ï¼ˆä¾‹å¦‚é¡µåˆ·æ–°å’Œmerge dadta from buffer poolï¼‰æ¯ç§’ioæ“ä½œçš„ä¸Šé™ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ï¼š200ï¼Œå»ºè®®å€¼ï¼šæ–¹æ³•ä¸€ï¼Œå•ç›˜sataè®¾100ï¼Œsas10ï¼Œraid10è®¾200ï¼Œssdè®¾2000ï¼Œfushion-ioè®¾50000ï¼›æ–¹æ³•äºŒï¼Œé€šè¿‡æµ‹è¯•å·¥å…·è·å¾—ç£ç›˜ioæ€§èƒ½åï¼Œè®¾ç½®IOPSæ•°å€¼/2ã€‚</span></span><br><span class="line">innodb_io_capacity = 2000</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šè¯¥å‚æ•°æ˜¯æ‰€æœ‰ç¼“å†²åŒºçº¿ç¨‹ioæ“ä½œçš„æ€»ä¸Šé™ã€‚</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ï¼šinnodb_io_capacityçš„ä¸¤å€ã€‚å»ºè®®å€¼ï¼šä¾‹å¦‚ç”¨iometeræµ‹è¯•åçš„iopsæ•°å€¼å°±å¥½</span></span><br><span class="line">innodb_io_capacity_max = 4000</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šæ§åˆ¶ç€innodbæ•°æ®æ–‡ä»¶åŠredo logçš„æ‰“å¼€ã€åˆ·å†™æ¨¡å¼ï¼Œä¸‰ç§æ¨¡å¼ï¼šfdatasync(é»˜è®¤)ï¼ŒO_DSYNCï¼ŒO_DIRECT</span></span><br><span class="line"><span class="comment"># fdatasyncï¼šæ•°æ®æ–‡ä»¶ï¼Œbuffer pool-&gt;os buffer-&gt;ç£ç›˜ï¼›æ—¥å¿—æ–‡ä»¶ï¼Œbuffer pool-&gt;os buffer-&gt;ç£ç›˜ï¼›</span></span><br><span class="line"><span class="comment"># O_DSYNCï¼š  æ•°æ®æ–‡ä»¶ï¼Œbuffer pool-&gt;os buffer-&gt;ç£ç›˜ï¼›æ—¥å¿—æ–‡ä»¶ï¼Œbuffer pool-&gt;ç£ç›˜ï¼›</span></span><br><span class="line"><span class="comment"># O_DIRECTï¼š æ•°æ®æ–‡ä»¶ï¼Œbuffer pool-&gt;ç£ç›˜ï¼›           æ—¥å¿—æ–‡ä»¶ï¼Œbuffer pool-&gt;os buffer-&gt;ç£ç›˜ï¼›</span></span><br><span class="line"><span class="comment"># é»˜è®¤å€¼ä¸ºç©ºï¼Œå»ºè®®å€¼ï¼šä½¿ç”¨SANæˆ–è€…raidï¼Œå»ºè®®ç”¨O_DIRECTï¼Œä¸æ‡‚æµ‹è¯•çš„è¯ï¼Œé»˜è®¤ç”Ÿäº§ä¸Šä½¿ç”¨O_DIRECT</span></span><br><span class="line">innodb_flush_method = O_DIRECT</span><br><span class="line"></span><br><span class="line">innodb_force_recovery = 1</span><br><span class="line">ä¸ºäº†éªŒè¯æ•°æ®åº“é¡µé¢æ˜¯å¦æŸåï¼Œå¯ä»¥ä½¿ç”¨SELECT ... INTO OUTFILEä»æ•°æ®åº“å¯¼å‡ºæ•°æ®è¡¨ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ä»¥è¿™ç§æ–¹å¼è·å¾—çš„æ•°æ®å¤§å¤šæ•°æ˜¯å®Œæ•´çš„ã€‚ä½†å¦‚æœæ˜¯æŸåä¸¥é‡çš„æ•°æ®å¯èƒ½å¯¼è‡´SELECT * FROM tbl_nameè¯­å¥æˆ–InnoDBåå°æ“ä½œå´©æºƒæˆ–æ–­è¨€ï¼Œç”šè‡³å¯¼è‡´InnoDBå›æ»šæ¢å¤å´©æºƒã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨innodb_force_recoveryé€‰é¡¹è®©InnoDBå­˜å‚¨å¼•æ“å¼ºåˆ¶å¯åŠ¨ï¼ŒåŒæ—¶é˜²æ­¢åå°æ“ä½œè¿è¡Œï¼Œè¿™æ ·å¯ä»¥è½¬å‚¨è¡¨äº†ã€‚</span><br><span class="line">æ³¨æ„</span><br><span class="line">åœ¨è¿›è¡Œè¿™ä¸ªæ“ä½œä¹‹å‰ï¼ŒåŠ¡å¿…å¤‡ä»½æ•°æ®åº“ã€‚</span><br><span class="line">åœ¨ç´§æ€¥æƒ…å†µä¸‹ï¼Œä¸ºäº†å¯ä»¥å¯åŠ¨InnoDBå¹¶è½¬å‚¨è¡¨ï¼Œå¿…é¡»å°†innodb_force_recoveryè®¾ç½®ä¸ºå¤§äº0çš„å€¼ã€‚</span><br><span class="line">4æˆ–æ›´é«˜çš„å€¼å¯èƒ½ä¼šæ°¸ä¹…æŸåæ•°æ®æ–‡ä»¶ã€‚åœ¨æµ‹è¯•æ•°æ®åº“çš„å•ç‹¬ç‰©ç†å‰¯æœ¬ä¸Šæ“ä½œæˆåŠŸåï¼Œæ‰èƒ½åœ¨ç”Ÿäº§æœåŠ¡å™¨ä½¿ç”¨4æˆ–æ›´é«˜ç‰ˆæœ¬çš„innodb_force_recoveryè®¾ç½®ã€‚å½“InnoDBå¼ºåˆ¶æ¢å¤æ—¶ï¼Œåº”è¯¥å§‹ç»ˆä»¥innodb_force_recovery = 1å¼€å§‹ï¼Œå¹¶æ ¹æ®éœ€è¦é€æ¸å¢åŠ å€¼ã€‚ä¸ºä»€ä¹ˆä»1å¼€å§‹å‘¢ï¼Œå› ä¸º1æ˜¯æœ€ä¿é™©çš„ï¼Œå¯ä»¥çœ‹åé¢å¯¹ä¸åŒå€¼çš„è§£é‡Š</span><br><span class="line">innodb_force_recoveryé»˜è®¤ä¸º0ï¼ˆæ­£å¸¸å¯åŠ¨ï¼‰ã€‚ innodb_force_recoveryçš„éé›¶å€¼æ˜¯ä»1åˆ°6ã€‚è¾ƒå¤§çš„å€¼åŒ…æ‹¬è¾ƒå°å€¼çš„åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼Œ3åŒ…æ‹¬1å’Œ2çš„æ‰€æœ‰åŠŸèƒ½ã€‚</span><br><span class="line">innodb_force_recoveryå€¼ä¸º3æˆ–æ›´å°æ—¶ï¼Œåªæœ‰æŸåçš„å•ä¸ªé¡µé¢ä¸Šçš„æŸäº›æ•°æ®ä¸¢å¤±ã€‚ 4æˆ–æ›´é«˜çš„å€¼æ˜¯å±é™©çš„ï¼Œå› ä¸ºæ•°æ®æ–‡ä»¶å¯èƒ½æ°¸ä¹…æŸåã€‚6ä¸å»ºè®®ä½¿ç”¨ï¼Œå› ä¸ºæ•°æ®åº“é¡µé¢å¤„äºè¿‡æ—¶çŠ¶æ€ï¼Œè¿™é™†ç»­å¯èƒ½åœ¨Bæ ‘å’Œå…¶ä»–æ•°æ®åº“ç»“æ„ä¸­å¼•å…¥æ›´å¤šçš„æŸåã€‚</span><br><span class="line">ä¸ºäº†å®‰å…¨èµ·è§ï¼ŒInnoDBåœ¨innodb_force_recoveryå¤§äº0æ—¶ä¼šé˜»æ­¢INSERTï¼ŒUPDATEæˆ–DELETEæ“ä½œã€‚</span><br><span class="line">    ã€Mysql 5.7ã€‘</span><br><span class="line">    åœ¨innodbåªè¯»æ¨¡å¼ä¸‹innodb_force_recoveryå¯ä»¥è®¾ç½®ä¸º4æˆ–æ›´å¤§å€¼</span><br><span class="line">1 (SRV_FORCE_IGNORE_CORRUPT)</span><br><span class="line">å½“æ£€æµ‹åˆ°æŸåçš„é¡µé¢æ—¶ç»§ç»­è®©æœåŠ¡å™¨è¿è¡Œã€‚ å¯¼å‡ºè¡¨æ—¶å°è¯•SELECT * FROM tbl_nameè·³è¿‡æŸåçš„ç´¢å¼•è®°å½•å’Œé¡µé¢ã€‚</span><br><span class="line"></span><br><span class="line">2 (SRV_FORCE_NO_BACKGROUND)</span><br><span class="line">é˜»æ­¢ä¸»çº¿ç¨‹å’Œä»»ä½•åºŸæ­¢çº¿ç¨‹è¿è¡Œã€‚ è®¾ç½®ä¸º2å¯ä»¥åœ¨åºŸæ­¢æ“ä½œæœŸé—´é˜»æ­¢å´©æºƒã€‚</span><br><span class="line"></span><br><span class="line">3 (SRV_FORCE_NO_TRX_UNDO)</span><br><span class="line">å´©æºƒåæ¢å¤æ—¶ä¸æ‰§è¡Œäº‹åŠ¡å›æ»š</span><br><span class="line"></span><br><span class="line">4 (SRV_FORCE_NO_IBUF_MERGE)</span><br><span class="line">é˜»æ­¢å†™å…¥ç¼“å†²åŒºåˆå¹¶æ“ä½œã€‚ å¦‚æœä¼šé€ æˆäº‹æ•…ï¼Œä¸åšå†™å…¥ï¼Œä¸è®¡ç®—è¡¨ç»Ÿè®¡ã€‚ æ­¤ç±»å‹å¯èƒ½ä¼šæ°¸ä¹…æŸåæ•°æ®æ–‡ä»¶ã€‚ éœ€è¦åˆ é™¤å¹¶é‡æ–°åˆ›å»ºæ‰€æœ‰è¾…åŠ©ç´¢å¼•ã€‚innoDBè®¾ç½®ä¸ºåªè¯»æ¨¡å¼ã€Mysql 5.7ã€‘</span><br><span class="line"></span><br><span class="line">5 (SRV_FORCE_NO_UNDO_LOG_SCAN)</span><br><span class="line">å¯åŠ¨æ•°æ®åº“æ—¶ä¸æŸ¥çœ‹undoæ—¥å¿—ï¼šInnoDBä¼šå°†ä¸å®Œæ•´çš„äº‹åŠ¡è§†ä¸ºå·²æäº¤ã€‚ è®¾ç½®ä¸ºæ­¤å€¼å¯èƒ½ä¼šæ°¸ä¹…æŸåæ•°æ®æ–‡ä»¶ã€‚innoDBè®¾ç½®ä¸ºåªè¯»æ¨¡å¼ã€Mysql 5.7ã€‘</span><br><span class="line"></span><br><span class="line">6 (SRV_FORCE_NO_LOG_REDO)</span><br><span class="line">æ— æ³•å°†ä¸æ¢å¤ç›¸å…³è”çš„é‡åšæ—¥å¿—æ¢å¤ã€‚è®¾ç½®æ­¤å€¼å¯èƒ½ä¼šæ°¸ä¹…æŸåæ•°æ®æ–‡ä»¶ã€‚è®©æ•°æ®åº“é¡µé¢å¤„äºè¿‡æ—¶çŠ¶æ€ï¼Œä»è€Œå¯èƒ½ä¼šåœ¨Bæ ‘å’Œå…¶ä»–æ•°æ®åº“ç»“æ„ä¸­å¼•å…¥æ›´å¤šçš„æŸåã€‚innoDBè®¾ç½®ä¸ºåªè¯»æ¨¡å¼ã€Mysql 5.7ã€‘</span><br><span class="line">å³ä½¿å¼€å¯äº†innodb_force_recoveryè®¾ç½®ä¹Ÿå¯ä»¥ä½¿ç”¨SELECT from tableså¯¼å‡ºè¡¨æ•°æ®æˆ–è€…åˆ é™¤ã€åˆ›å»ºè¡¨ã€‚å¦‚æœçŸ¥é“åœ¨å›æ»šæ—¶ä¼šå¼•èµ·å´©æºƒï¼Œå¯ä»¥ç›´æ¥åˆ é™¤è¿™ä¸ªè¡¨ã€‚</span><br><span class="line"></span><br><span class="line">    ã€Mysql 5.7ã€‘</span><br><span class="line">    å¯ä»¥ä½¿ç”¨ SELECT from tablesæ¥å¯¼å‡ºè¡¨æ•°æ®ã€‚innodb_force_recoveryè®¾ç½®ä¸º3åŠä»¥ä¸‹æ—¶å¯ä»¥åˆ›å»ºå’Œåˆ é™¤è¡¨ã€‚å½“ç„¶å¦‚æœmysqlç‰ˆæœ¬ä½äº5.7.18ï¼Œinnodb_force_recoveryè®¾ç½®ä¸º3ä»¥ä¸Šä¹Ÿæ˜¯å¯ä»¥åˆ é™¤è¡¨çš„ï¼Œä»5.7.18èµ·è¢«ç¦æ­¢äº†ã€‚</span><br><span class="line"></span><br><span class="line">æ‚¨è¿˜å¯ä»¥ä½¿ç”¨å®ƒæ¥åœæ­¢ç”±å¤§é‡å¯¼å…¥å¤±è´¥å¯¼è‡´çš„å¤±æ§å›æ»šæˆ–ALTER TABLEæ“ä½œï¼š</span><br><span class="line">æ€æ‰mysqlè¿›ç¨‹å¹¶å°†innodb_force_recoveryè®¾ç½®ä¸º3ï¼Œè®©æ•°æ®åº“å‡çº§è€Œä¸è¿›è¡Œå›æ»šï¼Œç„¶ååˆ é™¤å¯¼è‡´å¤±æ§å›æ»šçš„è¡¨ã€‚</span><br><span class="line">å¦‚æœè¡¨æ•°æ®ä¸­çš„æŸåè€Œå¯¼å‡ºä¸äº†ï¼Œå¯ä»¥ä½¿ç”¨ORDER BY primary_key DESCå­å¥çš„æŸ¥è¯¢å°†æŸåéƒ¨åˆ†åçš„æ•°æ®å¯¼å‡ºæ¥ã€‚</span><br><span class="line">å¦‚æœinnodb_force_recoveryå¿…é¡»è¦è®¾ç½®å¾ˆå¤§çš„å€¼æ‰èƒ½å¯åŠ¨innodbï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´å¤æ‚æŸ¥è¯¢ï¼ˆåŒ…å«WHEREï¼ŒORDER BYæˆ–å…¶ä»–å­å¥çš„æŸ¥è¯¢ï¼‰å¤±è´¥ã€‚è¿™æ—¶å€™åªèƒ½è¿è¡ŒåŸºæœ¬çš„SELECT * FROM tæŸ¥è¯¢ã€‚</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> mysql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é…ç½®æ–‡ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysql_server</title>
      <link href="/posts/b97760d.html"/>
      <url>/posts/b97760d.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/sh</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Copyright Abandoned 1996 TCX DataKonsult AB &amp; Monty Program KB &amp; Detron HB</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">This file is public domain and comes with NO WARRANTY of any kind</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">MySQL daemon start/stop script.</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Usually this is put <span class="keyword">in</span> /etc/init.d (at least on machines SYSV R4 based</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">systems) and linked to /etc/rc3.d/S99mysql and /etc/rc0.d/K01mysql.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">When this is <span class="keyword">done</span> the mysql server will be started when the machine is</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">started and shut down when the systems goes down.</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Comments to support chkconfig on RedHat Linux</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">chkconfig: 2345 64 36</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">description: A very fast and reliable SQL database engine.</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Comments to support LSB init script conventions</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">## BEGIN INIT INFO</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Provides: mysql</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Required-Start: <span class="variable">$local_fs</span> <span class="variable">$network</span> <span class="variable">$remote_fs</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Should-Start: ypbind nscd ldap ntpd xntpd</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Required-Stop: <span class="variable">$local_fs</span> <span class="variable">$network</span> <span class="variable">$remote_fs</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Default-Start:  2 3 4 5</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Default-Stop: 0 1 6</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Short-Description: start and stop MySQL</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Description: MySQL is a very fast and reliable SQL database engine.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">## END INIT INFO</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">If you install MySQL on some other places than /usr/local/webserver/mysql, <span class="keyword">then</span> you</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">have to <span class="keyword">do</span> one of the following things <span class="keyword">for</span> this script to work:</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># - Run this script from within the MySQL installation directory</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">- Create a /etc/my.cnf file with the following information:</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  [mysqld]</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  basedir=&lt;path-to-mysql-installation-directory&gt;</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">- Add the above to any other configuration file (<span class="keyword">for</span> example ~/.my.ini)</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  and copy my_print_defaults to /usr/bin</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">- Add the path to the mysql-installation-directory to the basedir variable</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  below.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># If you want to affect other MySQL variables, you should make your changes</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">in</span> the /etc/my.cnf, ~/.my.cnf or other MySQL configuration files.</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">If you change base <span class="built_in">dir</span>, you must also change datadir. These may get</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">overwritten by settings <span class="keyword">in</span> the MySQL configuration files.</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mysqlæ ¹ç›®å½•</span></span><br><span class="line">basedir=</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ•°æ®æ ¹ç›®å½•</span></span><br><span class="line">datadir=</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Default value, <span class="keyword">in</span> seconds, afterwhich the script should <span class="built_in">timeout</span> waiting</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">for</span> server start.</span> </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Value here is overriden by value <span class="keyword">in</span> my.cnf.</span> </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">0 means don<span class="string">&#x27;t wait at all</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Negative numbers mean to wait indefinitely</span></span></span><br><span class="line">service_startup_timeout=900</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Lock directory for RedHat / SuSE.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">lockæ‰€åœ¨ä¿å­˜ç›®å½•</span></span></span><br><span class="line">lockdir=&#x27;/var/lock/subsys&#x27;</span><br><span class="line">lock_file_path=&quot;$lockdir/mysql&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">The following variables are only set for letting mysql.server find things.</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Set some defaults</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">pidæ‰€åœ¨è·¯å¾„</span></span></span><br><span class="line">mysqld_pid_file_path=/var/run/mysql.pid</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">å¦‚æœæ²¡æœ‰è®¾ç½®æ ¹ç›®å½•ï¼Œæ ¹ç›®å½•ä¿®æ”¹ä¸ºé»˜è®¤ç›®å½•</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">æ ¹ç›®å½•ä¸ºç©º</span></span></span><br><span class="line">if test -z &quot;$basedir&quot;</span><br><span class="line">then</span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash"><span class="string">è®¾ç½®æ ¹ç›®å½•å’Œbinç›®å½•</span></span></span><br><span class="line">  basedir=/usr/local/webserver/mysql</span><br><span class="line">  bindir=/usr/local/webserver/mysql/bin</span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash"><span class="string">æ•°æ®ç›®å½•ä¸ºç©º</span></span></span><br><span class="line">  if test -z &quot;$datadir&quot;</span><br><span class="line">  then</span><br><span class="line">    # è®¾ç½®æ•°æ®ç›®å½•</span><br><span class="line">    datadir=/data/mysqlData</span><br><span class="line">  fi</span><br><span class="line">  sbindir=/usr/local/webserver/mysql/bin</span><br><span class="line">  libexecdir=/usr/local/webserver/mysql/bin</span><br><span class="line">else</span><br><span class="line">  bindir=&quot;$basedir/bin&quot;</span><br><span class="line">  if test -z &quot;$datadir&quot;</span><br><span class="line">  then</span><br><span class="line">    datadir=&quot;$basedir/data&quot;</span><br><span class="line">  fi</span><br><span class="line">  sbindir=&quot;$basedir/sbin&quot;</span><br><span class="line">  libexecdir=&quot;$basedir/libexec&quot;</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">datadir_set is used to determine if datadir was set (and so should be</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">*not* set inside of the --basedir= handler.)</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">ç”¨äºåˆ¤æ–­datadiræ˜¯å¦é…ç½®</span></span></span><br><span class="line">datadir_set=</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Use LSB init script functions for printing messages, if possible</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">é»˜è®¤ä½¿ç”¨ç³»ç»Ÿæ—¥å¿—å‡½æ•°ï¼Œå¦åˆ™ä½¿ç”¨mysqlçš„æ—¥å¿—å‡½æ•°</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash">lsb_functions=&quot;/lib/lsb/init-functions&quot;</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">å¦‚æœå­˜åœ¨æ–‡ä»¶</span></span></span><br><span class="line">if test -f $lsb_functions ; then</span><br><span class="line">  . $lsb_functions</span><br><span class="line">else</span><br><span class="line">  log_success_msg()</span><br><span class="line">  &#123;</span><br><span class="line">    echo &quot; SUCCESS! $@&quot;</span><br><span class="line">  &#125;</span><br><span class="line">  log_failure_msg()</span><br><span class="line">  &#123;</span><br><span class="line">    echo &quot; ERROR! $@&quot;</span><br><span class="line">  &#125;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">PATH=&quot;/sbin:/usr/sbin:/bin:/usr/bin:$basedir/bin&quot;</span><br><span class="line">export PATH</span><br><span class="line"></span><br><span class="line">mode=$1    # start or stop</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">å¦‚æœå‚æ•°ä¸ªæ•° &gt;= 1, åˆ é™¤$1</span></span></span><br><span class="line">[ $# -ge 1 ] &amp;&amp; shift</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">å°†ç¬¬ä¸€ä¸ªå‚æ•°åçš„å…¶ä»–å‚æ•°èµ‹äºˆother_argså˜é‡</span></span></span><br><span class="line">other_args=&quot;$*&quot;   # uncommon, but needed when called from an RPM upgrade action</span><br><span class="line">           # Expected: &quot;--skip-networking --skip-grant-tables&quot;</span><br><span class="line">           # They are not checked here, intentionally, as it is the resposibility</span><br><span class="line">           # of the &quot;spec&quot; file author to give correct arguments only.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">ç³»ç»Ÿå¯¹echo c å’Œ echo -n çš„ç»“æœ</span></span></span><br><span class="line">case `echo &quot;testing\c&quot;`,`echo -n testing` in</span><br><span class="line">    *c*,-n*) echo_n=   echo_c=     ;;</span><br><span class="line">    *c*,*)   echo_n=-n echo_c=     ;;</span><br><span class="line">    *)       echo_n=   echo_c=&#x27;\c&#x27; ;;</span><br><span class="line">esac</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">è¯¥å‡½æ•°å°†my_print_defaults å‘½ä»¤åˆ†æå‡ºå¾—å‚æ•°èµ‹å€¼ç»™ç›¸åº”çš„å˜é‡</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">--basedir=xxx è§£æä¸ºbasedir=xxx</span></span></span><br><span class="line">parse_server_arguments() &#123;</span><br><span class="line">  for arg do</span><br><span class="line">    case &quot;$arg&quot; in</span><br><span class="line">      --basedir=*)  basedir=`echo &quot;$arg&quot; | sed -e &#x27;s/^[^=]*=//&#x27;`</span><br><span class="line">                    bindir=&quot;$basedir/bin&quot;</span><br><span class="line">    if test -z &quot;$datadir_set&quot;; then</span><br><span class="line">      datadir=&quot;$basedir/data&quot;</span><br><span class="line">    fi</span><br><span class="line">    sbindir=&quot;$basedir/sbin&quot;</span><br><span class="line">    libexecdir=&quot;$basedir/libexec&quot;</span><br><span class="line">        ;;</span><br><span class="line">      --datadir=*)  datadir=`echo &quot;$arg&quot; | sed -e &#x27;s/^[^=]*=//&#x27;`</span><br><span class="line">    datadir_set=1</span><br><span class="line">;;</span><br><span class="line">      --pid-file=*) mysqld_pid_file_path=`echo &quot;$arg&quot; | sed -e &#x27;s/^[^=]*=//&#x27;` ;;</span><br><span class="line">      --service-startup-timeout=*) service_startup_timeout=`echo &quot;$arg&quot; | sed -e &#x27;s/^[^=]*=//&#x27;` ;;</span><br><span class="line">    esac</span><br><span class="line">  done</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">è¯¥å‡½æ•°åœ¨å¯åŠ¨å’Œåœæ­¢mysqlæœåŠ¡æ—¶ç”¨äºç­‰å¾…pidçš„ç”Ÿæˆ</span></span></span><br><span class="line">wait_for_pid () &#123;</span><br><span class="line">  verb=&quot;$1&quot;           # created | removed</span><br><span class="line">  pid=&quot;$2&quot;            # process ID of the program operating on the pid-file</span><br><span class="line">  pid_file_path=&quot;$3&quot; # path to the PID file.</span><br><span class="line"></span><br><span class="line">  i=0</span><br><span class="line">  avoid_race_condition=&quot;by checking again&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash"><span class="string">$i != ç­‰å¾…æ—¶é—´</span></span></span><br><span class="line">  while test $i -ne $service_startup_timeout ; do</span><br><span class="line"></span><br><span class="line">    case &quot;$verb&quot; in</span><br><span class="line">      &#x27;created&#x27;)</span><br><span class="line">        # wait for a PID-file to pop into existence.</span><br><span class="line">        # å·²å­˜åœ¨pidè·³å‡º</span><br><span class="line">        test -s &quot;$pid_file_path&quot; &amp;&amp; i=&#x27;&#x27; &amp;&amp; break</span><br><span class="line">        ;;</span><br><span class="line">      &#x27;removed&#x27;)</span><br><span class="line">        # wait for this PID-file to disappear</span><br><span class="line">        # pidä¸å­˜åœ¨è·³å‡º</span><br><span class="line">        test ! -s &quot;$pid_file_path&quot; &amp;&amp; i=&#x27;&#x27; &amp;&amp; break</span><br><span class="line">        ;;</span><br><span class="line">      *)</span><br><span class="line">        echo &quot;wait_for_pid () usage: wait_for_pid created|removed pid pid_file_path&quot;</span><br><span class="line">        exit 1</span><br><span class="line">        ;;</span><br><span class="line">    esac</span><br><span class="line"></span><br><span class="line">    # if server isn&#x27;t running, then pid-file will never be updated</span><br><span class="line">    # pidå­˜åœ¨</span><br><span class="line">    if test -n &quot;$pid&quot;; then</span><br><span class="line"></span><br><span class="line">      # æ£€æŸ¥æ˜¯å¦æœ‰æƒé™åˆ é™¤ 0-æ²¡æœ‰æƒé™ 1-æœ‰æƒé™</span><br><span class="line">      if kill -0 &quot;$pid&quot; 2&gt;/dev/null; then</span><br><span class="line">        :  # the server still runs</span><br><span class="line">      else</span><br><span class="line">        # The server may have exited between the last pid-file check and now.  </span><br><span class="line">        if test -n &quot;$avoid_race_condition&quot;; then</span><br><span class="line">          avoid_race_condition=&quot;&quot;</span><br><span class="line">          continue  # Check again.</span><br><span class="line">        fi</span><br><span class="line"></span><br><span class="line">        # there&#x27;s nothing that will affect the file.</span><br><span class="line">        log_failure_msg &quot;The server quit without updating PID file ($pid_file_path).&quot;</span><br><span class="line">        return 1  # not waiting any more.</span><br><span class="line">      fi</span><br><span class="line">    fi</span><br><span class="line"></span><br><span class="line">    echo $echo_n &quot;.$echo_c&quot;</span><br><span class="line">    i=`expr $i + 1`</span><br><span class="line">    sleep 1</span><br><span class="line"></span><br><span class="line">  done</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash"><span class="string">$iç©º</span></span></span><br><span class="line">  if test -z &quot;$i&quot; ; then</span><br><span class="line">    log_success_msg</span><br><span class="line">    return 0</span><br><span class="line">  else</span><br><span class="line">    log_failure_msg</span><br><span class="line">    return 1</span><br><span class="line">  fi</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Get arguments from the my.cnf file,</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">the only group, which is read from now on is [mysqld]</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">å¾—åˆ°æœ‰æ‰§è¡Œæƒé™çš„my_print_defaultsç¨‹åºï¼ˆè¿™ä¸ªç¨‹åºæ˜¯å°†my.cnfä¸­çš„å‚æ•°æ‰“å°å‡ºæ¥ï¼Œ</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">å…¶è¯»å–my.cnfçš„é¡ºåºæ˜¯/etc/my.cnf /etc/mysql/my.cnf /usr/local/mysql/etc/my.cnf ~/.my.cnfï¼Œåé¢çš„å‚æ•°ä¼šè¦†ç›–æ‰å‰é¢çš„å‚æ•°ï¼‰</span></span></span><br><span class="line">if test -x &quot;$bindir/my_print_defaults&quot;;  then</span><br><span class="line">  print_defaults=&quot;$bindir/my_print_defaults&quot;</span><br><span class="line">else</span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash"><span class="string">Try to find basedir in /etc/my.cnf</span></span></span><br><span class="line">  conf=/etc/my.cnf</span><br><span class="line">  print_defaults=</span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash"><span class="string">æ–‡ä»¶å¯è¯»</span></span></span><br><span class="line">  if test -r $conf</span><br><span class="line">  then</span><br><span class="line">    subpat=&#x27;^[^=]*basedir[^=]*=\(.*\)$&#x27;</span><br><span class="line">    dirs=`sed -e &quot;/$subpat/!d&quot; -e &#x27;s//\1/&#x27; $conf`</span><br><span class="line">    for d in $dirs</span><br><span class="line">    do</span><br><span class="line">      d=`echo $d | sed -e &#x27;s/[ ]//g&#x27;`</span><br><span class="line">      # æ–‡ä»¶å¯æ‰§è¡Œ</span><br><span class="line">      if test -x &quot;$d/bin/my_print_defaults&quot;</span><br><span class="line">      then</span><br><span class="line">        print_defaults=&quot;$d/bin/my_print_defaults&quot;</span><br><span class="line">        break</span><br><span class="line">      fi</span><br><span class="line">    done</span><br><span class="line">  fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash"><span class="string">Hope it&#x27;</span>s <span class="keyword">in</span> the PATH ... but I doubt it</span></span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash">å¦‚æœ<span class="variable">$print_defaults</span>æœªé…ç½®åˆ™è®¾ç½®<span class="variable">$print_defaults</span>ä¸ºé»˜è®¤å€¼</span></span><br><span class="line">  test -z &quot;$print_defaults&quot; &amp;&amp; print_defaults=&quot;my_print_defaults&quot;</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Read defaults file from &#x27;basedir&#x27;.   If there is no defaults file there</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">check <span class="keyword">if</span> it<span class="string">&#x27;s in the old (depricated) place (datadir) and read it from there</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">è·å–é™„åŠ çš„my.cnfã€‚è¿™ä¸ªé‡Œçš„å‚æ•°å€¼ä¼šè¦†ç›–å…¶ä»–çš„å‚æ•°è®¾ç½®ã€‚</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">æ³¨æ„ï¼Œå¦‚æœbasedirä¸‹æœ‰my.cnfå°±ä¸ä¼šå†å»è¯»å–datadirä¸‹çš„my.cnfã€‚å¦‚æœbasedirä¸‹é¢æ²¡æœ‰my.cnfåˆ™ä¼šç»§ç»­è¯»å–datadirä¸‹çš„my.cnfã€‚</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"></span></span></span><br><span class="line">extra_args=&quot;&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">mysql/my.cnfå¯è¯»</span></span></span><br><span class="line">if test -r &quot;$basedir/my.cnf&quot;</span><br><span class="line">then</span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash"><span class="string">æ–‡ä»¶å­˜åœ¨</span></span></span><br><span class="line">  extra_args=&quot;-e $basedir/my.cnf&quot;</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">å°†my_print_defaultsç¨‹åºæ‰“å°å‡ºæ¥çš„Mysqlå‚æ•°ç”¨parse_server_argumentsè¿›è¡Œè§£æï¼Œè§£æåçš„å€¼ä¼šæ˜¯è¿™ä¸ªè„šæœ¬ç¯å¢ƒä¸­çš„å˜é‡å€¼ã€‚</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">è¿™ä¸ªå‘½ä»¤ä¸»è¦ç”¨æ¥åˆ†æmy.cnfçš„å‚æ•° ä½¿ç”¨æ–¹æ³• my_print_defaults   -e  my.cnf   mysqld (æŒ‡çš„é…ç½®æ–‡ä»¶ä¸­[mysqld]ä¸‹çš„å†…å®¹)</span></span></span><br><span class="line">parse_server_arguments `$print_defaults $extra_args mysqld server mysql_server mysql.server`</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Set pid file if not given</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">è®¾ç½®mysqld_pid_file_pathå˜é‡ï¼ˆå…¶ä»£è¡¨pid æ–‡ä»¶çš„ä½ç½®ï¼‰ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®è¿™ä¸ªå€¼æˆ–è€…ä¸æ˜¯ç»å¯¹è·¯å¾„ï¼Œåˆ™é»˜è®¤ä¼šåœ¨$datadirä¸‹é¢</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash">if test -z &quot;$mysqld_pid_file_path&quot;</span></span></span><br><span class="line">then</span><br><span class="line">  mysqld_pid_file_path=$datadir/`hostname`.pid</span><br><span class="line">else</span><br><span class="line">  case &quot;$mysqld_pid_file_path&quot; in</span><br><span class="line">    /* ) ;;</span><br><span class="line">    * )  mysqld_pid_file_path=&quot;$datadir/$mysqld_pid_file_path&quot; ;;</span><br><span class="line">  esac</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">å¯åŠ¨å’Œåœæ­¢mysql server çš„ä¸»ä½“ç¨‹åº</span></span></span><br><span class="line">case &quot;$mode&quot; in</span><br><span class="line">  &#x27;start&#x27;)</span><br><span class="line">    # Start daemon</span><br><span class="line"></span><br><span class="line">    # Safeguard (relative paths, core dumps..)</span><br><span class="line">    cd $basedir</span><br><span class="line"></span><br><span class="line">    echo $echo_n &quot;Starting MySQL&quot;</span><br><span class="line">    # å¦‚æœå¯æ‰§è¡Œ</span><br><span class="line">    if test -x $bindir/mysqld_safe</span><br><span class="line">    then</span><br><span class="line">      # Give extra arguments to mysqld with the my.cnf file. This script</span><br><span class="line">      # may be overwritten at next upgrade.</span><br><span class="line">      # å¯åŠ¨mysqlæœåŠ¡</span><br><span class="line">      $bindir/mysqld_safe --datadir=&quot;$datadir&quot; --pid-file=&quot;$mysqld_pid_file_path&quot; $other_args &gt;/dev/null &amp;</span><br><span class="line">      # ç­‰å¾…å¯åŠ¨</span><br><span class="line">      wait_for_pid created &quot;$!&quot; &quot;$mysqld_pid_file_path&quot;; return_value=$?</span><br><span class="line"></span><br><span class="line">      # Make lock for RedHat / SuSE</span><br><span class="line">      # åˆ¤æ–­æ˜¯å¦å¯å†™ï¼Œç„¶ååˆ›å»ºç³»ç»ŸæœåŠ¡é”</span><br><span class="line">      if test -w &quot;$lockdir&quot;</span><br><span class="line">      then</span><br><span class="line">        touch &quot;$lock_file_path&quot;</span><br><span class="line">      fi</span><br><span class="line"></span><br><span class="line">      exit $return_value</span><br><span class="line">    else</span><br><span class="line">      log_failure_msg &quot;Couldn&#x27;t find MySQL server ($bindir/mysqld_safe)&quot;</span><br><span class="line">    fi</span><br><span class="line">    ;;</span><br><span class="line"></span><br><span class="line">  &#x27;stop&#x27;)</span><br><span class="line">    # Stop daemon. We use a signal here to avoid having to know the</span><br><span class="line">    # root password.</span><br><span class="line"></span><br><span class="line">    # å­˜åœ¨pid</span><br><span class="line">    if test -s &quot;$mysqld_pid_file_path&quot;</span><br><span class="line">    then</span><br><span class="line">      # signal mysqld_safe that it needs to stop</span><br><span class="line">      touch &quot;$mysqld_pid_file_path.shutdown&quot;</span><br><span class="line"></span><br><span class="line">      mysqld_pid=`cat &quot;$mysqld_pid_file_path&quot;`</span><br><span class="line"></span><br><span class="line">      # å¦‚æœæœ‰åˆ é™¤pidæƒé™åˆ™åˆ é™¤</span><br><span class="line">      if (kill -0 $mysqld_pid 2&gt;/dev/null)</span><br><span class="line">      then</span><br><span class="line">        echo $echo_n &quot;Shutting down MySQL&quot;</span><br><span class="line">        kill $mysqld_pid</span><br><span class="line">        # mysqld should remove the pid file when it exits, so wait for it.</span><br><span class="line">        wait_for_pid removed &quot;$mysqld_pid&quot; &quot;$mysqld_pid_file_path&quot;; return_value=$?</span><br><span class="line">      else</span><br><span class="line">        log_failure_msg &quot;MySQL server process #$mysqld_pid is not running!&quot;</span><br><span class="line">        rm &quot;$mysqld_pid_file_path&quot;</span><br><span class="line">      fi</span><br><span class="line"></span><br><span class="line">      # Delete lock for RedHat / SuSE</span><br><span class="line">      # å¦‚æœæœ‰é”ï¼Œåˆ™åˆ é™¤é”</span><br><span class="line">      if test -f &quot;$lock_file_path&quot;</span><br><span class="line">      then</span><br><span class="line">        rm -f &quot;$lock_file_path&quot;</span><br><span class="line">      fi</span><br><span class="line">      exit $return_value</span><br><span class="line">    else</span><br><span class="line">      log_failure_msg &quot;MySQL server PID file could not be found!&quot;</span><br><span class="line">    fi</span><br><span class="line">    ;;</span><br><span class="line"></span><br><span class="line">  &#x27;restart&#x27;)</span><br><span class="line">    # Stop the service and regardless of whether it was</span><br><span class="line">    # running or not, start it again.</span><br><span class="line">    if $0 stop  $other_args; then</span><br><span class="line">      $0 start $other_args</span><br><span class="line">    else</span><br><span class="line">      log_failure_msg &quot;Failed to stop running server, so refusing to try to start.&quot;</span><br><span class="line">      exit 1</span><br><span class="line">    fi</span><br><span class="line">    ;;</span><br><span class="line"></span><br><span class="line">  &#x27;reload&#x27;|&#x27;force-reload&#x27;)</span><br><span class="line">    if test -s &quot;$mysqld_pid_file_path&quot; ; then</span><br><span class="line">      read mysqld_pid &lt;  &quot;$mysqld_pid_file_path&quot;</span><br><span class="line">      kill -HUP $mysqld_pid &amp;&amp; log_success_msg &quot;Reloading service MySQL&quot;</span><br><span class="line">      touch &quot;$mysqld_pid_file_path&quot;</span><br><span class="line">    else</span><br><span class="line">      log_failure_msg &quot;MySQL PID file could not be found!&quot;</span><br><span class="line">      exit 1</span><br><span class="line">    fi</span><br><span class="line">    ;;</span><br><span class="line">  &#x27;status&#x27;)</span><br><span class="line">    # First, check to see if pid file exists</span><br><span class="line">    if test -s &quot;$mysqld_pid_file_path&quot; ; then </span><br><span class="line">      read mysqld_pid &lt; &quot;$mysqld_pid_file_path&quot;</span><br><span class="line">      if kill -0 $mysqld_pid 2&gt;/dev/null ; then </span><br><span class="line">        log_success_msg &quot;MySQL running ($mysqld_pid)&quot;</span><br><span class="line">        exit 0</span><br><span class="line">      else</span><br><span class="line">        log_failure_msg &quot;MySQL is not running, but PID file exists&quot;</span><br><span class="line">        exit 1</span><br><span class="line">      fi</span><br><span class="line">    else</span><br><span class="line">      # Try to find appropriate mysqld process</span><br><span class="line">      mysqld_pid=`pidof $libexecdir/mysqld`</span><br><span class="line"></span><br><span class="line">      # test if multiple pids exist</span><br><span class="line">      pid_count=`echo $mysqld_pid | wc -w`</span><br><span class="line">      if test $pid_count -gt 1 ; then</span><br><span class="line">        log_failure_msg &quot;Multiple MySQL running but PID file could not be found ($mysqld_pid)&quot;</span><br><span class="line">        exit 5</span><br><span class="line">      elif test -z $mysqld_pid ; then</span><br><span class="line">        # pidä¸å­˜åœ¨ï¼Œé”è¿˜åœ¨</span><br><span class="line">        if test -f &quot;$lock_file_path&quot; ; then </span><br><span class="line">          log_failure_msg &quot;MySQL is not running, but lock file ($lock_file_path) exists&quot;</span><br><span class="line">          exit 2</span><br><span class="line">        fi </span><br><span class="line">        log_failure_msg &quot;MySQL is not running&quot;</span><br><span class="line">        exit 3</span><br><span class="line">      else</span><br><span class="line">        log_failure_msg &quot;MySQL is running but PID file could not be found&quot;</span><br><span class="line">        exit 4</span><br><span class="line">      fi</span><br><span class="line">    fi</span><br><span class="line">    ;;</span><br><span class="line">    *)</span><br><span class="line">      # usage</span><br><span class="line">      basename=`basename &quot;$0&quot;`</span><br><span class="line">      echo &quot;Usage: $basename  &#123;start|stop|restart|reload|force-reload|status&#125;  [ MySQL server options ]&quot;</span><br><span class="line">      exit 1</span><br><span class="line">    ;;</span><br><span class="line">esac</span><br><span class="line"></span><br><span class="line">exit 0</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> mysql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è„šæœ¬ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nginxå®‰è£…æ–‡æ¡£</title>
      <link href="/posts/13dbaea.html"/>
      <url>/posts/13dbaea.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ç¯å¢ƒé¢„å®‰è£…"><a href="#ç¯å¢ƒé¢„å®‰è£…" class="headerlink" title="ç¯å¢ƒé¢„å®‰è£…"></a>ç¯å¢ƒé¢„å®‰è£…</h1><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum <span class="keyword">install</span> pcre pcre-devel -y</span><br><span class="line">yum <span class="keyword">install</span> openssl openssl-devel -y</span><br></pre></td></tr></table></figure><h1 id="åˆ›å»ºnginxç”¨æˆ·"><a href="#åˆ›å»ºnginxç”¨æˆ·" class="headerlink" title="åˆ›å»ºnginxç”¨æˆ·"></a>åˆ›å»ºnginxç”¨æˆ·</h1><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupadd -<span class="attribute">r</span> nginx &amp;&amp; useradd -<span class="attribute">r</span> -<span class="selector-tag">g</span> nginx -s /bin/false -M nginx</span><br></pre></td></tr></table></figure><h1 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">./configure \</span><br><span class="line"><span class="attribute">--user</span>=nginx \</span><br><span class="line"><span class="attribute">--group</span>=nginx \</span><br><span class="line"><span class="attribute">--prefix</span>=/usr/local/webserver/nginx \</span><br><span class="line"><span class="attribute">--conf-path</span>=/usr/local/webserver/nginx/conf/nginx.conf \</span><br><span class="line"><span class="attribute">--pid-path</span>=/var/run/nginx/nginx.pid \</span><br><span class="line"><span class="attribute">--lock-path</span>=/var/lock/nginx.lock \</span><br><span class="line"><span class="attribute">--error-log-path</span>=/var/log/nginx/error.log \</span><br><span class="line"><span class="attribute">--http-log-path</span>=/var/log/nginx/access.log \</span><br><span class="line">--with-http_gzip_static_module \</span><br><span class="line"><span class="attribute">--http-client-body-temp-path</span>=/var/temp/nginx/client \</span><br><span class="line"><span class="attribute">--http-proxy-temp-path</span>=/var/temp/nginx/proxy \</span><br><span class="line"><span class="attribute">--http-fastcgi-temp-path</span>=/var/temp/nginx/fastcgi \</span><br><span class="line"><span class="attribute">--http-uwsgi-temp-path</span>=/var/temp/nginx/uwsgi \</span><br><span class="line"><span class="attribute">--http-scgi-temp-path</span>=/var/temp/nginx/scgi</span><br></pre></td></tr></table></figure><h1 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>nginx<span class="regexp">/sbin/</span>nginx</span><br></pre></td></tr></table></figure><h1 id="é‡å¯"><a href="#é‡å¯" class="headerlink" title="é‡å¯"></a>é‡å¯</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/sbin/</span>nginx -s reload</span><br><span class="line">kill -HUP `cat <span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>nginx<span class="regexp">/logs/</span>nginx.pid`</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="å…³é—­"><a href="#å…³é—­" class="headerlink" title="å…³é—­"></a>å…³é—­</h1><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/sbin/nginx -s stop</span><br></pre></td></tr></table></figure><h1 id="nginxæ”¯æŒphp"><a href="#nginxæ”¯æŒphp" class="headerlink" title="nginxæ”¯æŒphp"></a>nginxæ”¯æŒphp</h1><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">location</span> <span class="regexp">~ \.php$</span> &#123;</span><br><span class="line">            <span class="attribute">root</span>           /data/html;</span><br><span class="line">            <span class="attribute">fastcgi_pass</span>   <span class="number">127.0.0.1:9000</span>;</span><br><span class="line">            <span class="attribute">fastcgi_index</span>  index.php;</span><br><span class="line">            <span class="attribute">fastcgi_param</span>  SCRIPT_FILENAME  <span class="variable">$document_root</span><span class="variable">$fastcgi_script_name</span>;</span><br><span class="line">            <span class="attribute">include</span>        fastcgi_params;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰è£…æ–‡æ¡£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sphinxç¬”è®°</title>
      <link href="/posts/2e95148b.html"/>
      <url>/posts/2e95148b.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="sphinxç¬”è®°"><a href="#sphinxç¬”è®°" class="headerlink" title="sphinxç¬”è®°"></a>sphinxç¬”è®°</h1><h2 id="ä¸€ã€ç´¢å¼•é‡å»º"><a href="#ä¸€ã€ç´¢å¼•é‡å»º" class="headerlink" title="ä¸€ã€ç´¢å¼•é‡å»º"></a>ä¸€ã€ç´¢å¼•é‡å»º</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ç›®å½•ï¼šls <span class="regexp">/dev/</span>shm<span class="regexp">/sphinx/</span></span><br><span class="line"><span class="comment"># sphinxå­˜åœ¨æ–‡ä»¶åå¸¦æœ‰newçš„æ‰§è¡Œ</span></span><br><span class="line">vi <span class="regexp">/etc/</span>rc.local å’Œ vi <span class="regexp">/var/</span>spool<span class="regexp">/cron/</span>rootä¸‹çš„ç´¢å¼•é‡å»º</span><br><span class="line"><span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>coreseek<span class="regexp">/bin/i</span>ndexer --config <span class="regexp">/sphinx_conf/</span>xxx.conf xxx_delta</span><br><span class="line"><span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>coreseek<span class="regexp">/bin/i</span>ndexer --config <span class="regexp">/sphinx_conf/</span>xxx.conf xxx_delta --rotate</span><br><span class="line"></span><br><span class="line"><span class="comment"># sphinxé‡å»ºæ‰€æœ‰ ç´¢å¼•</span></span><br><span class="line"><span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>coreseek<span class="regexp">/bin/i</span>ndexer --config <span class="regexp">/sphinx_conf/</span>xxx.conf --all --rotate</span><br><span class="line"><span class="comment"># sphinxé‡å»ºå¢é‡ç´¢å¼•</span></span><br><span class="line"><span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>coreseek<span class="regexp">/bin/i</span>ndexer --config <span class="regexp">/sphinx_conf/</span>xxx.conf xxx_delta --rotate</span><br></pre></td></tr></table></figure><p>äºŒã€å­—ç¬¦ä¸²è¿‡æ»¤<br>1.å±æ€§æŸ¥è¯¢<br>sphinx ä¸æ”¯æŒå­—ç¬¦ä¸²ä½œä¸ºå±æ€§è¿‡æ»¤ï¼Œè¦ä½¿ç”¨å­—ç¬¦ä¸²è¿›è¡Œè¿‡æ»¤å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä¸¤è€…æ–¹æ³•è¿›è¡Œè§£å†³ï¼š</p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">SELECT</span> id, user_<span class="keyword">type</span></span><br><span class="line"><span class="type">FROM</span> users</span><br><span class="line"><span class="title">sql_field_string</span> = user_<span class="keyword">type</span></span><br></pre></td></tr></table></figure><p>åœ¨PHPè¯­è¨€ä¸­ï¼Œè¿™ä¹ˆä½¿ç”¨ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$matches</span> = <span class="variable language_">$this</span>-&gt;sphinxClient-&gt;<span class="title function_ invoke__">Query</span>(<span class="string">&#x27;@user_type &quot;^admin$&quot;&#x27;</span>);</span><br></pre></td></tr></table></figure><p>2.å…¨æ–‡æœç´¢åˆ—<br>å°†å­—ç¬¦ä¸²é€šè¿‡CRC32è½¬ä¸º32å‘³intç±»å‹</p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">SELECT</span> id, <span class="type">CRC32</span>(user_<span class="keyword">type</span>) <span class="type">AS</span> user_type</span><br><span class="line"><span class="type">FROM</span> users</span><br><span class="line"><span class="title">sql_attr_int</span>    = user_<span class="keyword">type</span></span><br></pre></td></tr></table></figure><p>åœ¨PHPè¯­è¨€ä¸­ï¼Œè¿™ä¹ˆä½¿ç”¨ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">$this</span>-&gt;sphinxClient-&gt;<span class="title function_ invoke__">SetFilter</span>(<span class="string">&#x27;user_type&#x27;</span>, <span class="keyword">array</span>(<span class="title function_ invoke__">crc32</span>(<span class="string">&#x27;admin&#x27;</span>));</span><br></pre></td></tr></table></figure><h2 id="äºŒã€æ³¨æ„äº‹é¡¹"><a href="#äºŒã€æ³¨æ„äº‹é¡¹" class="headerlink" title="äºŒã€æ³¨æ„äº‹é¡¹"></a>äºŒã€æ³¨æ„äº‹é¡¹</h2><h3 id="1-WARNING-attribute-â€˜idâ€™-not-found-IGNORING"><a href="#1-WARNING-attribute-â€˜idâ€™-not-found-IGNORING" class="headerlink" title="1. WARNING: attribute â€˜idâ€™ not found-IGNORING"></a>1. WARNING: attribute â€˜idâ€™ not found-IGNORING</h3><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ­¤é—®é¢˜å¯èƒ½å‡ºç°sphinx errorï¼Œä¾‹å¦‚bad sizeæƒ…å†µ</span></span><br><span class="line">ä¸èƒ½åœ¨sql_atträ¸­ä½¿ç”¨ä¸»é”®å­—æ®µ</span><br><span class="line">å¤„ç†æ–¹æ¡ˆï¼š</span><br><span class="line"><span class="number">1.</span> ç§»é™¤sql_attr_uint = <span class="built_in">id</span></span><br><span class="line"><span class="number">2.</span> sqlä¸­<span class="built_in">id</span> <span class="keyword">as</span> aid, sql_attr_uint = aid</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> sphinx </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>nginxæ—¥å¿—åˆ‡å‰²</title>
      <link href="/posts/3610db45.html"/>
      <url>/posts/3610db45.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment"># This script run at 00:00</span></span><br><span class="line"><span class="comment"># The Nginx logs path</span></span><br><span class="line"></span><br><span class="line">logs_path=<span class="string">&quot;/data/logs/&quot;</span></span><br><span class="line"><span class="built_in">mkdir</span> -p <span class="variable">$&#123;logs_path&#125;</span>$(<span class="built_in">date</span> -d <span class="string">&quot;yesterday&quot;</span> +<span class="string">&quot;%Y&quot;</span>)/$(<span class="built_in">date</span> -d <span class="string">&quot;yesterday&quot;</span> +<span class="string">&quot;%m&quot;</span>)/</span><br><span class="line"><span class="built_in">mv</span> <span class="variable">$&#123;logs_path&#125;</span>access.log <span class="variable">$&#123;logs_path&#125;</span>$(<span class="built_in">date</span> -d <span class="string">&quot;yesterday&quot;</span> +<span class="string">&quot;%Y&quot;</span>)/$(<span class="built_in">date</span> -d <span class="string">&quot;yesterday&quot;</span> +<span class="string">&quot;%m&quot;</span>)/access_$(<span class="built_in">date</span> -d <span class="string">&quot;yesterday&quot;</span> +<span class="string">&quot;%Y%m%d&quot;</span>).<span class="built_in">log</span></span><br><span class="line"><span class="built_in">kill</span> -HUP `<span class="built_in">cat</span> /usr/local/webserver/nginx/logs/nginx.pid`</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è„šæœ¬ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>coreseekå®‰è£…æ–‡æ¡£</title>
      <link href="/posts/2799a02a.html"/>
      <url>/posts/2799a02a.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="å¼€å§‹å®‰è£…"><a href="#å¼€å§‹å®‰è£…" class="headerlink" title="å¼€å§‹å®‰è£…"></a>å¼€å§‹å®‰è£…</h1><p>åœ¨å®‰è£…coreseekä¹‹å‰ç¡®ä¿åœ¨ç³»ç»Ÿå®‰è£…äº†LNMP&#x2F;LAMPç¯å¢ƒã€‚</p><h1 id="å®‰è£…ä¾èµ–"><a href="#å®‰è£…ä¾èµ–" class="headerlink" title="å®‰è£…ä¾èµ–"></a>å®‰è£…ä¾èµ–</h1><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install gcc make gcc-c++ libtool <span class="built_in">auto</span>conf <span class="built_in">auto</span>make imake mysql-devel libxml2-devel expat-develã€</span><br></pre></td></tr></table></figure><p>å°†ä¸‹è½½å¥½çš„å®‰è£…åŒ…ä¸Šä¼ åˆ°Linuxï¼Œæ‰§è¡Œè§£å‹å‘½ä»¤ï¼Œè§£å‹å®Œæˆåè¿›å…¥ç›®å½•</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">tar</span> xzvf coreseek-<span class="number">3</span>.<span class="number">2</span>.<span class="number">14</span>.tar.gz</span><br><span class="line"><span class="attribute">cd</span> coreseek-<span class="number">3</span>.<span class="number">2</span>.<span class="number">14</span></span><br></pre></td></tr></table></figure><p>å°†ä¼šçœ‹åˆ°3ä¸ªç›®å½•åˆ†åˆ«æ˜¯csft-3.2.14ã€mmseg-3.2.14ã€testpackï¼Œå…¶ä¸­csftå®é™…å°±æ˜¯sphinxå®‰è£…åŒ…ï¼Œmmsegä¸ºä¸­æ–‡åˆ†è¯å®‰è£…åŒ…ï¼Œtestpackæ˜¯å®‰è£…å®Œcoreseekåæµ‹è¯•ç”¨çš„ã€‚é¦–å…ˆå®‰è£…ä¸­æ–‡åˆ†è¯</p><p>å¦‚æœå‡ºç°å¦‚ä¸‹é”™è¯¯<br>config.status: error: cannot find input file: src&#x2F;Makefile.in<br>è¯·æ‰§è¡Œ</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">aclocal</span><br><span class="line">libtoolize --force</span><br><span class="line"><span class="built_in">auto</span>make --add-missing</span><br><span class="line"><span class="built_in">auto</span>conf</span><br><span class="line"><span class="built_in">auto</span>header</span><br><span class="line">make clean</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œç¼–è¯‘å¹¶å®‰è£…mmseg</p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">make</span> &amp;&amp; <span class="built_in">make</span> install</span><br></pre></td></tr></table></figure><p>åˆ°è¿™é‡Œmmsegå®‰è£…å®Œæ¯•ï¼Œå¯ä»¥æµ‹è¯•ä¸‹ä¸­æ–‡åˆ†è¯</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo <span class="string">&#x27;æµ‹è¯•&#x27;</span>&gt;<span class="number">1</span>.txt</span><br><span class="line"><span class="regexp">/usr/</span>local<span class="regexp">/mmseg/</span>bin<span class="regexp">/mmseg -d /u</span>sr<span class="regexp">/local/mm</span>seg/etc <span class="number">1</span>.txt</span><br></pre></td></tr></table></figure><p>å®‰è£…coreseek</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">cd ../csft-<span class="number">3.2</span>.<span class="number">14</span></span><br><span class="line">sh buildconf.sh <span class="comment">#ç”Ÿæˆconfigureå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¦‚æœå½“å‰ç›®å½•å·²å­˜åœ¨configureæ–‡ä»¶ä¼šå‘å‡ºè­¦å‘Šï¼šå·²å­˜åœ¨å…¶å®ƒç‰ˆæœ¬autoconfï¼Œä½†ä¸èƒ½ä¿è¯èƒ½æ­£å¸¸å·¥ä½œï¼Œå¦‚æœå‡ºç°ä»»ä½•é—®é¢˜ï¼Œå»ºè®®é‡æ–°ç”Ÿæˆ</span></span><br><span class="line"><span class="comment"># å¯èƒ½ä¼šæç¤ºï¼šautomake: warnings are treated as errors é”™è¯¯</span></span><br><span class="line">å°† configure.ac æ–‡ä»¶ä¸­çš„</span><br><span class="line">AM_INIT_AUTOMAKE([-Wall -Werror foreign])</span><br><span class="line">ä¿®æ”¹ä¸º</span><br><span class="line">AM_INIT_AUTOMAKE([-Wall foreign])</span><br><span class="line"></span><br><span class="line">./configure --prefix=<span class="regexp">/usr/local</span><span class="regexp">/webserver/coreseek</span> \</span><br><span class="line">--without-unixodbc \</span><br><span class="line">--<span class="keyword">with</span>-mmseg=<span class="regexp">/usr/local</span><span class="regexp">/webserver/mmseg</span>3 \</span><br><span class="line">--<span class="keyword">with</span>-mmseg-includes=<span class="regexp">/usr/local</span><span class="regexp">/webserver/mmseg</span>3/<span class="keyword">include</span>/mmseg/ \</span><br><span class="line">--<span class="keyword">with</span>-mmseg-libs=<span class="regexp">/usr/local</span><span class="regexp">/webserver/mmseg</span>3/<span class="class"><span class="keyword">lib</span>/ \</span></span><br><span class="line">--<span class="keyword">with</span>-mysql (éœ€è¦å°†mysqlå‘½ä»¤åŠ å…¥ç¯å¢ƒå˜é‡ä¸­)</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘å¯èƒ½ç”±äºgccç‰ˆæœ¬è¿‡é«˜å¯¼è‡´å¤±è´¥</p><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é”™è¯¯æç¤º</span></span><br><span class="line">&#x27;ExprEval&#x27; was not declared in this scope, and no declarations were found by argument-dependent lookup at the point of instantiation [-fpermissive]</span><br><span class="line">   T val = ExprEval ( this-&gt;m_pArg, tMatch ); // &#x27;this&#x27; fixes gcc braindamage</span><br><span class="line"></span><br><span class="line">ä¿®æ”¹csft-3.2.14/src/sphinxexpr.cpp</span><br><span class="line">å°†æç¤ºä½ç½®çš„ExprEvalä¿®æ”¹ä¸ºthis-&gt;ExprEval </span><br></pre></td></tr></table></figure><p>åˆ°æ­¤coreseekå°±å…¨éƒ¨å®‰è£…å®Œæˆäº†ï¼Œæµ‹è¯•ä¸€ä¸‹coreseek</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥å®‰è£…åŒ…æä¾›çš„æµ‹è¯•ç›®å½•</span></span><br><span class="line">cd ../testpack</span><br><span class="line"><span class="comment"># åˆ›å»ºç´¢å¼•</span></span><br><span class="line"><span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>coreseek<span class="regexp">/bin/i</span>ndexer -c etc/csft.conf --all</span><br><span class="line"><span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>coreseek<span class="regexp">/bin/</span>search -c etc/csft.conf <span class="string">&#x27;æµ‹è¯•&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡Œé¡ºåº</span></span><br><span class="line"><span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>coreseek<span class="regexp">/bin/i</span>ndexer -c sphinx.conf sphinx_delta</span><br><span class="line"><span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>coreseek<span class="regexp">/bin/</span>searchd -c sphinx.conf --pidfile</span><br></pre></td></tr></table></figure><p>åˆ›å»ºç´¢å¼•æ—¶å¯èƒ½ä¼šå‡ºç°ä»¥ä¸‹é”™è¯¯</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 1./usr/<span class="keyword">local</span>/coreseek/bin/indexer: <span class="keyword">error</span> <span class="keyword">while</span> loading shared libraries: libmysqlclient.<span class="keyword">so</span>.18: cannot <span class="keyword">open</span> shared object <span class="keyword">file</span>: <span class="keyword">No</span> such <span class="keyword">file</span> or directory</span><br><span class="line"># è§£å†³åŠæ³•</span><br><span class="line">echo &#x27;/usr/<span class="keyword">local</span>/mysql/lib&#x27;&gt;&gt;/etc/ld.<span class="keyword">so</span>.<span class="keyword">conf</span></span><br><span class="line">ldconfig  </span><br><span class="line"># 2.Unigram dictionary load <span class="keyword">Error</span> Segmentation fault</span><br><span class="line">#è§£å†³åŠæ³•</span><br><span class="line">vim etc/csft.<span class="keyword">conf</span> å°†mmseg3 charset_dictpathè·¯å¾„ä¿®æ”¹ä¸ºè‡ªå·±çš„è·¯å¾„</span><br></pre></td></tr></table></figure><p>å®‰è£…sphinxæ‰©å±•for php</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sphinxæ‰©å±•ä¾èµ–äºlibsphinxclientï¼Œå…ˆå®‰è£…libsphinxclient</span></span><br><span class="line"><span class="built_in">cd</span> api/libsphinxclient</span><br><span class="line">./configure</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"><span class="comment"># ä¸‹è½½å¹¶å®‰è£…sphinxæ‰©å±•</span></span><br><span class="line">wget http://pecl.php.net/get/sphinx-1.3.2.tgz</span><br><span class="line">tar zxvf sphinx-1.3.2.tgz</span><br><span class="line"><span class="built_in">cd</span> sphinx-1.3.2</span><br><span class="line">/usr/local/php/bin/phpize</span><br><span class="line">./configure --with-php-config=/usr/local/php/bin/php-config</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><p>å®‰è£…libsphinxclientæ—¶å¦‚æœæŠ¥å¦‚ä¸‹é”™è¯¯<br>sphinxclient.c:1216: error: static declaration of â€˜sock_closeâ€™ follows non-static declaration sphinxclient.c:280: note: previous declaration of â€˜sock_closeâ€™ was here<br>è¯·æ‰§è¡Œ</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sed</span> -ie <span class="string">&#x27;280s/^/static /&#x27;</span> sphinxclient.c</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹php.ini<br>æ·»åŠ sphinxæ‰©å±•<br>extension&#x3D;sphinx.so<br>é‡å¯php</p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> sphinx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰è£…æ–‡æ¡£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>tcp</title>
      <link href="/posts/bb0d3e20.html"/>
      <url>/posts/bb0d3e20.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="URIå’ŒURL"><a href="#URIå’ŒURL" class="headerlink" title="URIå’ŒURL"></a>URIå’ŒURL</h1><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">URI:ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦,æ˜¯ä¸€ä¸ªè¯­æ³•ç»“æ„ï¼Œä¸€ä¸ªè§„åˆ™ï¼Œä¸€ä¸ªç»“æœé›† FTP://</span><br><span class="line"><span class="built_in">URL</span>:ç»Ÿä¸€èµ„æºå®šä½ç¬¦,æ˜¯URIçš„å­é›†ï¼Œå­ç±»ã€‚</span><br><span class="line"></span><br><span class="line">æ¢å¥è¯è¯´ï¼Œä¸€ä¸ª URI å®ä¾‹å’Œä¸€ä¸ªæ”¯æŒè¯­æ³•æ„ä¹‰ä¸Šçš„ã€ä¾èµ–äºæ–¹æ¡ˆçš„æ¯”è¾ƒã€è§„èŒƒåŒ–ã€è§£æå’Œç›¸å¯¹åŒ–è®¡ç®—çš„ç»“æ„åŒ–å­—ç¬¦ä¸²å·®ä¸å¤šã€‚</span><br><span class="line">ä½œä¸ºå¯¹ç…§ï¼Œ<span class="built_in">URL</span> ç±»çš„å®ä¾‹ä»£è¡¨äº† <span class="built_in">URL</span> çš„è¯­æ³•ç»„æˆéƒ¨åˆ†ä»¥åŠè®¿é—®å®ƒæè¿°çš„èµ„æºæ‰€éœ€çš„ä¿¡æ¯ã€‚<span class="built_in">URL</span> å¿…é¡»æ˜¯ç»å¯¹çš„ï¼Œå³å®ƒå¿…é¡»å§‹ç»ˆæŒ‡å®šä¸€ä¸ªæ–¹æ¡ˆã€‚</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> tcp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tcp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linuxæ–‡ä»¶è½¬ç§»è„šæœ¬</title>
      <link href="/posts/c0b6fb27.html"/>
      <url>/posts/c0b6fb27.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#æ–‡ä»¶è½¬ç§»</span></span><br><span class="line">filename=<span class="string">&quot;/data/logs/upyunImgList.log&quot;</span></span><br><span class="line">picDir=<span class="string">&quot;/data/http/upYunPicBack&quot;</span></span><br><span class="line">newpicDir=<span class="string">&quot;/data/upyunbak&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">read</span> -r line</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"> picurl=$picDir<span class="variable">$line</span></span><br><span class="line"> <span class="built_in">echo</span> <span class="variable">$picurl</span></span><br><span class="line"> <span class="comment"># å¦‚æœè¦è½¬ç§»çš„æ–‡ä»¶ä¸å­˜åœ¨</span></span><br><span class="line"> <span class="keyword">if</span> [ -f <span class="variable">$picurl</span> ]; <span class="keyword">then</span></span><br><span class="line">   <span class="built_in">dir</span>=$(<span class="built_in">echo</span> <span class="variable">$line</span> |  awk -F <span class="string">&#x27;/&#x27;</span> <span class="string">&#x27;&#123;print &quot;/&quot;$2&quot;/&quot;$3&quot;/&quot;$4&#125;&#x27;</span>)</span><br><span class="line">   <span class="built_in">dir</span>=$newpicDir<span class="variable">$dir</span>/</span><br><span class="line">   <span class="built_in">echo</span> <span class="variable">$dir</span></span><br><span class="line">   <span class="comment"># è½¬ç§»ç›®æ ‡ç›®å½•ä¸å­˜åœ¨åˆ™æ–°å»º</span></span><br><span class="line">   <span class="keyword">if</span> [ ! -d <span class="variable">$dir</span> ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">mkdir</span> -p <span class="string">&quot;<span class="variable">$dir</span>&quot;</span></span><br><span class="line">   <span class="keyword">fi</span></span><br><span class="line">   <span class="comment"># åˆ¤æ–­æ˜¯å¦å·²å­˜åœ¨è¯¥æ–‡ä»¶</span></span><br><span class="line">   <span class="keyword">if</span> [ ! -f $<span class="built_in">dir</span>$<span class="variable">$line</span> ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">cp</span> <span class="variable">$picurl</span> <span class="variable">$dir</span></span><br><span class="line">   <span class="keyword">fi</span></span><br><span class="line"> <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span> &lt; <span class="variable">$filename</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
          <category> shell </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è„šæœ¬ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vim</title>
      <link href="/posts/280100fb.html"/>
      <url>/posts/280100fb.html</url>
      
        <content type="html"><![CDATA[<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;</span> Source your .vimrc</span><br><span class="line"><span class="comment">&quot;source ~/.vimrc</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;</span> -- Suggested <span class="keyword">options</span> --</span><br><span class="line"><span class="comment">&quot; Show a few lines of context around the cursor. Note that this makes the</span></span><br><span class="line"><span class="comment">&quot; text scroll if you mouse-click near the start or end of the window.</span></span><br><span class="line"><span class="keyword">set</span> scrolloff=<span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Do incremental searching.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; é…ç½®</span></span><br><span class="line"><span class="keyword">syntax</span> <span class="keyword">on</span> <span class="comment">&quot; è‡ªåŠ¨è¯­æ³•é«˜äº®</span></span><br><span class="line"><span class="keyword">set</span> <span class="keyword">number</span> <span class="comment">&quot; æ˜¾ç¤ºè¡Œå·</span></span><br><span class="line"><span class="keyword">set</span> cursorline <span class="comment">&quot; çªæ˜¾å½“å‰è¡Œ/</span></span><br><span class="line"><span class="keyword">set</span> ruler <span class="comment">&quot; æ‰“å¼€çŠ¶æ€æ æ ‡å°º</span></span><br><span class="line"><span class="keyword">set</span> <span class="built_in">shiftwidth</span>=<span class="number">4</span> <span class="comment">&quot; è®¾å®š &lt;&lt; å’Œ &gt;&gt; å‘½ä»¤ç§»åŠ¨æ—¶çš„å®½åº¦ä¸º 4</span></span><br><span class="line"><span class="keyword">set</span> autochdir <span class="comment">&quot; è‡ªåŠ¨åˆ‡æ¢å½“å‰ç›®å½•ä¸ºå½“å‰æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•</span></span><br><span class="line"><span class="string">&quot; set ignorecase smartcase &quot;</span> æœç´¢æ—¶å¿½ç•¥å¤§å°å†™ï¼Œä½†åœ¨æœ‰ä¸€ä¸ªæˆ–ä»¥ä¸Šå¤§å†™å­—æ¯æ—¶ä»ä¿æŒå¯¹å¤§å°å†™æ•æ„Ÿ</span><br><span class="line"><span class="keyword">set</span> ignorecase <span class="comment">&quot; æœç´¢æ—¶å¿½ç•¥å¤§å°å†™ï¼Œä½†åœ¨æœ‰ä¸€ä¸ªæˆ–ä»¥ä¸Šå¤§å†™å­—æ¯æ—¶ä»ä¿æŒå¯¹å¤§å°å†™æ•æ„Ÿ</span></span><br><span class="line"><span class="keyword">set</span> incsearch <span class="comment">&quot; è¾“å…¥æœç´¢å†…å®¹æ—¶å°±æ˜¾ç¤ºæœç´¢ç»“æœ</span></span><br><span class="line"><span class="keyword">set</span> insertmode <span class="comment">&quot; é»˜è®¤insertæ¨¡å¼</span></span><br><span class="line"><span class="keyword">set</span> hlsearch <span class="comment">&quot; æœç´¢æ—¶é«˜äº®æ˜¾ç¤ºè¢«æ‰¾åˆ°çš„æ–‡æœ¬</span></span><br><span class="line"><span class="keyword">set</span> smartindent <span class="comment">&quot; å¼€å¯æ–°è¡Œæ—¶ä½¿ç”¨æ™ºèƒ½è‡ªåŠ¨ç¼©è¿›</span></span><br><span class="line"><span class="keyword">set</span> showcmd <span class="comment">&quot; æ ‡å°ºå³ä¾§æ˜¾ç¤ºæœªå®Œæˆçš„å‘½ä»¤</span></span><br><span class="line"><span class="keyword">set</span> autowrite <span class="comment">&quot; è‡ªåŠ¨ä¿å­˜</span></span><br><span class="line"><span class="keyword">set</span> showmatch <span class="comment">&quot; ä½ é”®å…¥ä¸€ä¸ªå³æ‹¬å· ) æ—¶ï¼Œå¦‚æœèƒ½çŸ¥é“å®ƒåŒ¹é…å“ªä¸ªå·¦æ‹¬å· ( ä¼šå¾ˆæ–¹ä¾¿ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> noerrorbells <span class="comment">&quot; å…³é—­é”™è¯¯ä¿¡æ¯å“é“ƒ</span></span><br><span class="line"><span class="keyword">set</span> novisualbell <span class="comment">&quot; å…³é—­ä½¿ç”¨å¯è§†å“é“ƒä»£æ›¿å‘¼å«</span></span><br><span class="line"><span class="keyword">set</span> t_vb= <span class="comment">&quot; ç½®ç©ºé”™è¯¯é“ƒå£°çš„ç»ˆç«¯ä»£ç </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; å’Œç³»ç»Ÿå‰ªåˆ‡æ¿ç›¸å…³è”</span></span><br><span class="line"><span class="keyword">set</span> clipboard=unnamed</span><br><span class="line"><span class="keyword">set</span> clipboard=unnamedplus</span><br><span class="line"></span><br><span class="line">sethandler <span class="symbol">&lt;C-A&gt;</span> <span class="variable">a:vim</span></span><br><span class="line">sethandler <span class="symbol">&lt;C-B&gt;</span> <span class="variable">a:vim</span></span><br><span class="line">sethandler <span class="symbol">&lt;C-C&gt;</span> <span class="variable">a:vim</span></span><br><span class="line">sethandler <span class="symbol">&lt;C-D&gt;</span> <span class="variable">a:vim</span></span><br><span class="line">sethandler <span class="symbol">&lt;C-E&gt;</span> <span class="variable">a:ide</span></span><br><span class="line">sethandler <span class="symbol">&lt;C-F&gt;</span> <span class="variable">a:vim</span></span><br><span class="line">sethandler <span class="symbol">&lt;C-G&gt;</span> <span class="variable">a:vim</span></span><br><span class="line">sethandler <span class="symbol">&lt;C-H&gt;</span> <span class="variable">a:vim</span></span><br><span class="line">sethandler <span class="symbol">&lt;C-I&gt;</span> <span class="variable">a:vim</span></span><br><span class="line">sethandler <span class="symbol">&lt;C-J&gt;</span> <span class="variable">a:vim</span></span><br><span class="line">sethandler <span class="symbol">&lt;C-K&gt;</span> <span class="variable">a:ide</span></span><br><span class="line">sethandler <span class="symbol">&lt;C-O&gt;</span> <span class="variable">a:vim</span></span><br><span class="line">sethandler <span class="symbol">&lt;C-P&gt;</span> <span class="variable">a:vim</span></span><br><span class="line">sethandler <span class="symbol">&lt;C-Q&gt;</span> <span class="variable">a:ide</span></span><br><span class="line">sethandler <span class="symbol">&lt;C-R&gt;</span> <span class="variable">a:vim</span></span><br><span class="line">sethandler <span class="symbol">&lt;C-S&gt;</span> <span class="variable">a:vim</span></span><br><span class="line">sethandler <span class="symbol">&lt;C-T&gt;</span> <span class="variable">a:ide</span></span><br><span class="line">sethandler <span class="symbol">&lt;C-U&gt;</span> <span class="variable">a:vim</span></span><br><span class="line">sethandler <span class="symbol">&lt;C-V&gt;</span> <span class="variable">a:vim</span></span><br><span class="line">sethandler <span class="symbol">&lt;C-W&gt;</span> <span class="variable">a:vim</span></span><br><span class="line">sethandler <span class="symbol">&lt;C-Y&gt;</span> <span class="variable">a:vim</span></span><br><span class="line">sethandler &lt;C-[&gt; <span class="variable">a:vim</span></span><br><span class="line">sethandler &lt;C-]&gt; <span class="variable">a:vim</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Don&#x27;t use Ex mode, use Q for formatting.</span></span><br><span class="line"><span class="keyword">map</span> Q gq</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;</span> -- Map IDE actions <span class="keyword">to</span> IdeaVim -- https://jb.gg/abva4t</span><br><span class="line"><span class="string">&quot;&quot;</span> Map \r <span class="keyword">to</span> the Reformat Code action</span><br><span class="line"><span class="comment">&quot;map \r &lt;Action&gt;(ReformatCode)</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;</span> Map <span class="symbol">&lt;leader&gt;</span>d <span class="keyword">to</span> start <span class="keyword">debug</span></span><br><span class="line"><span class="comment">&quot;map &lt;leader&gt;d &lt;Action&gt;(Debug)</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;</span> Map \<span class="keyword">b</span> <span class="keyword">to</span> toggle the breakpoint <span class="keyword">on</span> the current <span class="built_in">line</span></span><br><span class="line"><span class="comment">&quot;map \b &lt;Action&gt;(ToggleLineBreakpoint)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Find more examples here: https://jb.gg/share-ideavimrc</span></span><br><span class="line"><span class="string">&quot;&quot;</span> å¯„å­˜å™¨</span><br><span class="line"><span class="string">&quot;&quot;</span></span><br><span class="line"><span class="string">&quot;&quot;</span>     :<span class="keyword">reg</span>[isters] - æ˜¾ç¤ºå¯„å­˜å™¨å†…å®¹</span><br><span class="line"><span class="string">&quot;&quot;</span>     <span class="comment">&quot;xy - å¤åˆ¶å†…å®¹åˆ°å¯„å­˜å™¨ x</span></span><br><span class="line"><span class="string">&quot;&quot;</span>     <span class="comment">&quot;xp - ç²˜è´´å¯„å­˜å™¨ x ä¸­çš„å†…å®¹</span></span><br><span class="line"><span class="string">&quot;&quot;</span>     <span class="comment">&quot;+y - å¤åˆ¶å†…å®¹åˆ°ç³»ç»Ÿå‰ªè´´æ¿å¯„å­˜å™¨</span></span><br><span class="line"><span class="string">&quot;&quot;</span>     <span class="comment">&quot;+p - ç²˜è´´ç³»ç»Ÿå‰ªè´´æ¿å¯„å­˜å™¨çš„å†…å®¹</span></span><br><span class="line"><span class="string">&quot;&quot;</span></span><br><span class="line"><span class="string">&quot;&quot;</span> Tip å¯„å­˜å™¨è¢«å­˜å‚¨åœ¨ ~/.viminfo ä¸­, åœ¨ä¸‹æ¬¡é‡å¯<span class="keyword">vim</span>æ—¶ä»ä¼šåŠ è½½</span><br><span class="line"><span class="string">&quot;&quot;</span> Tip ç‰¹æ®Šå¯„å­˜å™¨ï¼š</span><br><span class="line"><span class="string">&quot;&quot;</span></span><br><span class="line"><span class="string">&quot;&quot;</span> <span class="number">0</span> - ä¸Šæ¬¡å¤åˆ¶</span><br><span class="line"><span class="string">&quot;&quot;</span> <span class="comment">&quot; - æœªå‘½åå¯„å­˜å™¨ï¼Œä¸Šæ¬¡å¤åˆ¶æˆ–åˆ é™¤</span></span><br><span class="line"><span class="string">&quot;&quot;</span> % - å½“å‰æ–‡ä»¶å</span><br><span class="line"><span class="string">&quot;&quot;</span> # - è½®æ¢æ–‡ä»¶å</span><br><span class="line"><span class="string">&quot;&quot;</span> * - å‰ªè´´æ¿å†…å®¹ (X11 primary)</span><br><span class="line"><span class="string">&quot;&quot;</span> + - å‰ªè´´æ¿å†…å®¹ (X11 clipboard)</span><br><span class="line"><span class="string">&quot;&quot;</span> / - ä¸Šæ¬¡æœç´¢çš„pattern</span><br><span class="line"><span class="string">&quot;&quot;</span> : - ä¸Šæ¬¡æ‰§è¡Œçš„å‘½ä»¤</span><br><span class="line"><span class="string">&quot;&quot;</span> . - ä¸Šæ¬¡æ’å…¥çš„æ–‡æœ¬</span><br><span class="line"><span class="string">&quot;&quot;</span> - - ä¸Šæ¬¡å‰ªåˆ‡çš„çŸ­äºä¸€è¡Œçš„æ–‡æœ¬</span><br><span class="line"><span class="string">&quot;&quot;</span> = - è¡¨è¾¾å¼å¯„å­˜å™¨</span><br><span class="line"><span class="string">&quot;&quot;</span> _ - é»‘æ´å¯„å­˜å™¨</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;</span> åˆ é™¤ä¸è¿›å…¥ç²˜è´´æ¿</span><br><span class="line"><span class="string">&quot;&quot;</span> å­˜å…¥å¯„å­˜å™¨<span class="keyword">p</span>ä¸­</span><br><span class="line"><span class="keyword">nnoremap</span> <span class="keyword">x</span> <span class="comment">&quot;px</span></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="keyword">X</span> <span class="comment">&quot;pX</span></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="keyword">c</span> <span class="comment">&quot;pc</span></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="keyword">cc</span> <span class="comment">&quot;pc</span></span><br><span class="line"><span class="keyword">nnoremap</span> C <span class="comment">&quot;pC</span></span><br><span class="line"><span class="keyword">nnoremap</span> d <span class="comment">&quot;pd</span></span><br><span class="line"><span class="keyword">nnoremap</span> D <span class="comment">&quot;pD</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">vnoremap</span> <span class="keyword">x</span> <span class="comment">&quot;px</span></span><br><span class="line"><span class="keyword">vnoremap</span> <span class="keyword">X</span> <span class="comment">&quot;pX</span></span><br><span class="line"><span class="keyword">vnoremap</span> <span class="keyword">c</span> <span class="comment">&quot;pc</span></span><br><span class="line"><span class="keyword">vnoremap</span> <span class="keyword">cc</span> <span class="comment">&quot;pc</span></span><br><span class="line"><span class="keyword">vnoremap</span> C <span class="comment">&quot;pC</span></span><br><span class="line"><span class="keyword">vnoremap</span> d <span class="comment">&quot;pd</span></span><br><span class="line"><span class="keyword">vnoremap</span> D <span class="comment">&quot;pD</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="symbol">&lt;leader&gt;</span><span class="keyword">x</span> <span class="comment">&quot;px</span></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="symbol">&lt;leader&gt;</span><span class="keyword">X</span> <span class="comment">&quot;pX</span></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="symbol">&lt;leader&gt;</span><span class="keyword">c</span> <span class="comment">&quot;pc</span></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="symbol">&lt;leader&gt;</span>d <span class="comment">&quot;pd</span></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="symbol">&lt;leader&gt;</span>D <span class="comment">&quot;pD</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
          <category> vim </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>vimè®°å½•</title>
      <link href="/posts/280100fb.html"/>
      <url>/posts/280100fb.html</url>
      
        <content type="html"><![CDATA[<h1 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h1><h2 id="setå‘½ä»¤"><a href="#setå‘½ä»¤" class="headerlink" title="setå‘½ä»¤"></a>setå‘½ä»¤</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">:<span class="built_in">set</span> number <span class="string">&quot; æ˜¾ç¤ºè¡Œå·</span></span><br><span class="line"><span class="string">:set cursorline &quot;</span> çªæ˜¾å½“å‰è¡Œ</span><br><span class="line">:<span class="built_in">set</span> ruler <span class="string">&quot; æ‰“å¼€çŠ¶æ€æ æ ‡å°º</span></span><br><span class="line"><span class="string">:set shiftwidth=4 &quot;</span> è®¾å®š &lt;&lt; å’Œ &gt;&gt; å‘½ä»¤ç§»åŠ¨æ—¶çš„å®½åº¦ä¸º 4</span><br><span class="line">:<span class="built_in">set</span> autochdir <span class="string">&quot; è‡ªåŠ¨åˆ‡æ¢å½“å‰ç›®å½•ä¸ºå½“å‰æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;</span> :<span class="built_in">set</span> ignorecase smartcase <span class="string">&quot; æœç´¢æ—¶å¿½ç•¥å¤§å°å†™ï¼Œä½†åœ¨æœ‰ä¸€ä¸ªæˆ–ä»¥ä¸Šå¤§å†™å­—æ¯æ—¶ä»ä¿æŒå¯¹å¤§å°å†™æ•æ„Ÿ</span></span><br><span class="line"><span class="string">:set ic(ignorecase) &quot;</span> æœç´¢æ—¶å¿½ç•¥å¤§å°å†™</span><br><span class="line">:<span class="built_in">set</span> noic(noignorecase) <span class="string">&quot; æœç´¢å¤§å°å†™ä¸¥æ ¼</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">:set is(incsearch) &quot;</span> è¾“å…¥æœç´¢å†…å®¹æ—¶å°±æ˜¾ç¤ºæœç´¢ç»“æœ</span><br><span class="line">:<span class="built_in">set</span> nois(incsearch)</span><br><span class="line"></span><br><span class="line">:<span class="built_in">set</span> hsl(lsearch) <span class="string">&quot; æœç´¢æ—¶é«˜äº®æ˜¾ç¤ºè¢«æ‰¾åˆ°çš„æ–‡æœ¬</span></span><br><span class="line"><span class="string">:set nohsl(hlsearch)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">:set si(smartindent) &quot;</span> å¼€å¯æ–°è¡Œæ—¶ä½¿ç”¨æ™ºèƒ½è‡ªåŠ¨ç¼©è¿›</span><br><span class="line">:<span class="built_in">set</span> nosi(smartindent)</span><br><span class="line"></span><br><span class="line">:<span class="built_in">set</span> paste <span class="string">&quot; ç²˜è´´å–æ¶ˆæ ¼å¼</span></span><br><span class="line"><span class="string">:set nopaste &quot;</span> ç²˜è´´ä½¿ç”¨æ ¼å¼</span><br><span class="line">:<span class="built_in">set</span> pastetoggler <span class="string">&quot; åˆ‡æ¢æ ¼å¼ä½¿ç”¨æƒ…å†µ</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">:set showcmd &quot;</span> æ ‡å°ºå³ä¾§æ˜¾ç¤ºæœªå®Œæˆçš„å‘½ä»¤</span><br><span class="line">:<span class="built_in">set</span> noshowcmd</span><br><span class="line"></span><br><span class="line">:<span class="built_in">set</span> autowrite <span class="string">&quot; è‡ªåŠ¨ä¿å­˜</span></span><br><span class="line"><span class="string">:set noautowrite</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">:set insertmode &quot;</span> é»˜è®¤insertæ¨¡å¼</span><br><span class="line">:<span class="built_in">set</span> <span class="attribute">fileformat</span>=unix <span class="string">&quot; è®¾ç½®æ–‡ä»¶æ ¼å¼</span></span><br><span class="line"><span class="string">:set display=truncate &quot;</span> å¦‚æœæœ«è¡Œè¢«æˆªçŸ­ï¼Œæ˜¾ç¤º @@@ è€Œä¸æ˜¯éšè—æ•´è¡Œ</span><br><span class="line">:<span class="built_in">set</span> <span class="attribute">nrformats-</span>=octal <span class="string">&quot; ä¸æŠŠé›¶å¼€å¤´çš„æ•°å€¼è¯†åˆ«ä¸ºå…«è¿›åˆ¶æ•°ã€‚</span></span><br><span class="line"><span class="string">:set backup &quot;</span> è®¾ç½®å¤‡ä»½æ–‡ä»¶</span><br><span class="line">:<span class="built_in">set</span> <span class="attribute">textwidth</span>=72 <span class="string">&quot; æ¯è¡Œ72å­—ç¬¦ï¼Œè‡ªåŠ¨æ¢è¡Œ</span></span><br><span class="line"><span class="string">ä½ é”®å…¥ä¸€ä¸ªå³æ‹¬å· ) æ—¶ï¼Œå¦‚æœèƒ½çŸ¥é“å®ƒåŒ¹é…å“ªä¸ªå·¦æ‹¬å· ( ä¼šå¾ˆæ–¹ä¾¿ã€‚è¦è®© Vim åšåˆ°è¿™</span></span><br><span class="line"><span class="string">ç‚¹ï¼Œç”¨ä¸‹é¢è¿™ä¸ªå‘½ä»¤: </span></span><br><span class="line"><span class="string">:set showmatch</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;</span> æ˜¾ ç¤º TAB é”®</span><br><span class="line"><span class="string">&quot; æ–‡ä»¶ä¸­æœ‰ TAB é”®çš„æ—¶å€™ï¼Œä½ æ˜¯çœ‹ä¸è§çš„ã€‚è¦æŠŠå®ƒæ˜¾ç¤ºå‡ºæ¥:</span></span><br><span class="line"><span class="string">:set list</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;</span> ç°åœ¨ TAB é”®æ˜¾ç¤ºä¸º ^Iï¼Œè€Œ $æ˜¾ç¤ºåœ¨æ¯è¡Œçš„ç»“å°¾ï¼Œä»¥ä¾¿ä½ èƒ½æ‰¾åˆ°å¯èƒ½ä¼šè¢«ä½ å¿½ç•¥çš„ç©ºç™½å­—ç¬¦åœ¨å“ªé‡Œã€‚</span><br><span class="line"><span class="string">&quot; è¿™æ ·åšçš„ä¸€ä¸ªç¼ºç‚¹æ˜¯åœ¨æœ‰å¾ˆå¤š TAB çš„æ—¶å€™çœ‹èµ·æ¥å¾ˆä¸‘ã€‚å¦‚æœä½ ä½¿ç”¨ä¸€ä¸ªæœ‰é¢œè‰²çš„ç»ˆç«¯ï¼Œ</span></span><br><span class="line"><span class="string">&quot;</span> æˆ–è€…ä½¿ç”¨ GUI æ¨¡å¼ï¼ŒVim å¯ä»¥ç”¨é«˜äº®æ˜¾ç¤ºç©ºæ ¼å’Œ TABã€‚ä½¿ç”¨ <span class="string">&#x27;listchars&#x27;</span> é€‰é¡¹:</span><br><span class="line">:<span class="built_in">set</span> <span class="attribute">listchars</span>=tab:&gt;-,trail:-</span><br><span class="line"><span class="string">&quot; TAB ä¼šè¢«æ˜¾ç¤ºæˆ &quot;</span>&gt;---<span class="string">&quot; (&quot;</span>-<span class="string">&quot; çš„ä¸ªæ•°ä¸å®š) è€Œè¡Œå°¾å¤šä½™çš„ç©ºç™½å­—ç¬¦æ˜¾ç¤ºæˆ &quot;</span>-<span class="string">&quot;ã€‚</span></span><br></pre></td></tr></table></figure><h2 id="ç‰¹æ®Šå‘½ä»¤"><a href="#ç‰¹æ®Šå‘½ä»¤" class="headerlink" title="ç‰¹æ®Šå‘½ä»¤"></a>ç‰¹æ®Šå‘½ä»¤</h2><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰¹é‡æ³¨é‡Š(æ‰¹é‡æ›¿æ¢)</span></span><br><span class="line"><span class="number">1</span>,<span class="number">10</span> s/^/<span class="comment">#/g (1-10è¡Œå‰é¢åŠ #å·)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># èŒƒå›´æœç´¢</span></span><br><span class="line"><span class="comment"># åœ¨10-20è¡Œå†…ï¼Œæœç´¢å…³é”®è¯key</span></span><br><span class="line">/\%&gt;<span class="number">10</span>l\%&lt;<span class="number">20</span>lkey</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯è§†èŒƒå›´</span></span><br><span class="line"><span class="symbol">:<span class="string">&#x27;&lt;,&#x27;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¡Œåè½¬</span></span><br><span class="line"><span class="symbol">:g/^/m</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–‡ä»¶æ€»å­—æ•°</span></span><br><span class="line">gCTRL-G</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºå‘½ä»¤è¡Œçª—å£</span></span><br><span class="line"><span class="symbol">q:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç¼–è¾‘è¿‡çš„æ–‡ä»¶</span></span><br><span class="line"><span class="symbol">:oldfiles</span></span><br><span class="line"><span class="comment"># å›åˆ°è¦ç¼–è¾‘çš„æ–‡ä»¶</span></span><br><span class="line"><span class="symbol">:e</span> <span class="comment">#&lt;2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç¼–è¾‘è¿‡çš„æ–‡ä»¶ï¼Œè¾“å…¥ç¼–å·ç¼–è¾‘æ–‡ä»¶</span></span><br><span class="line"><span class="symbol">:browse</span> oldfiles</span><br></pre></td></tr></table></figure><h1 id="å‘½ä»¤"><a href="#å‘½ä»¤" class="headerlink" title="å‘½ä»¤"></a>å‘½ä»¤</h1><h2 id="å…¨å±€"><a href="#å…¨å±€" class="headerlink" title="å…¨å±€"></a>å…¨å±€</h2><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">:<span class="keyword">h</span>[elp] å…³é”®å­— - æ‰“å¼€å…³é”®å­—å¸®åŠ©</span><br><span class="line">:<span class="keyword">sav</span>[eas] æ–‡ä»¶å - å¦å­˜ä¸º</span><br><span class="line">:<span class="keyword">file</span> æ–‡ä»¶å - å¦å­˜ä¸ºï¼Œéœ€è¦write</span><br><span class="line">:<span class="keyword">clo</span>[<span class="keyword">se</span>] - å…³é—­å½“å‰çª—å£</span><br><span class="line">:ter[minal] - æ‰“å¼€ä¸€ä¸ª<span class="keyword">shell</span>çª—å£</span><br><span class="line">K - æ‰“å¼€å…‰æ ‡æ‰€åœ¨å•è¯çš„<span class="keyword">man</span>é¡µé¢</span><br></pre></td></tr></table></figure><h2 id="ç§»åŠ¨å…‰æ ‡"><a href="#ç§»åŠ¨å…‰æ ‡" class="headerlink" title="ç§»åŠ¨å…‰æ ‡"></a>ç§»åŠ¨å…‰æ ‡</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">h - å·¦ç§»å…‰æ ‡</span><br><span class="line">j - ä¸‹ç§»å…‰æ ‡</span><br><span class="line">k - ä¸Šç§»å…‰æ ‡</span><br><span class="line">l - å³ç§»å…‰æ ‡</span><br><span class="line">gj - ä¸‹ç§»å…‰æ ‡(æŠ˜è¡Œæ–‡æœ¬)</span><br><span class="line">gk - ä¸‹ç§»å…‰æ ‡(æŠ˜è¡Œæ–‡æœ¬)</span><br><span class="line">H - ç§»åŠ¨åˆ°å½“å‰é¡µé¢é¡¶éƒ¨</span><br><span class="line">M - ç§»åŠ¨åˆ°å½“å‰é¡µé¢ä¸­é—´</span><br><span class="line">L - ç§»åŠ¨åˆ°å½“å‰é¡µé¢åº•éƒ¨</span><br><span class="line">w - ç§»åŠ¨åˆ°ä¸‹ä¸ªå•è¯å¼€å¤´</span><br><span class="line">W - ç§»åŠ¨åˆ°ä¸‹ä¸ªå•è¯å¼€å¤´(å•è¯å«æ ‡ç‚¹)</span><br><span class="line">e - ç§»åŠ¨åˆ°ä¸‹ä¸ªå•è¯ç»“å°¾</span><br><span class="line">E - ç§»åŠ¨åˆ°ä¸‹ä¸ªå•è¯ç»“å°¾(å•è¯å«æ ‡ç‚¹)</span><br><span class="line"><span class="selector-tag">b</span> - ç§»åŠ¨åˆ°ä¸Šä¸ªå•è¯å¼€å¤´</span><br><span class="line"><span class="selector-tag">B</span> - ç§»åŠ¨åˆ°ä¸Šä¸ªå•è¯å¼€å¤´(å•è¯å«æ ‡ç‚¹)</span><br><span class="line">ge - ç§»åŠ¨åˆ°ä¸Šä¸ªå•è¯ç»“å°¾</span><br><span class="line">gE - ç§»åŠ¨åˆ°ä¸Šä¸ªå•è¯ç»“å°¾(å•è¯å«æ ‡ç‚¹)</span><br><span class="line">% - è·³è½¬åˆ°é…å¯¹çš„ç¬¦å·(é»˜è®¤æ”¯æŒçš„é…å¯¹ç¬¦å·ç»„:: <span class="string">&#x27;()&#x27;</span>, <span class="string">&#x27;&#123;&#125;&#x27;</span>, <span class="string">&#x27;[]&#x27;</span> - åœ¨vimä¸­ä½¿ç”¨ :h matchpairs è·å¾—æ›´å¤šä¿¡æ¯)</span><br><span class="line"><span class="number">0</span> - ç§»åŠ¨åˆ°è¡Œé¦–</span><br><span class="line">^ - ç§»åŠ¨åˆ°è¡Œé¦–çš„éç©ºç™½ç¬¦</span><br><span class="line">$ - ç§»åŠ¨åˆ°è¡Œå°¾</span><br><span class="line">g_ - ç§»åŠ¨åˆ°è¡Œå†…æœ€åä¸€ä¸ªéç©ºç™½ç¬¦</span><br><span class="line">gg - ç§»åŠ¨åˆ°æ–‡ä»¶ç¬¬ä¸€è¡Œ</span><br><span class="line">G - ç§»åŠ¨åˆ°æ–‡ä»¶æœ€åä¸€è¡Œ</span><br><span class="line"><span class="number">5</span>gg or <span class="number">5</span>G - ç§»åŠ¨åˆ°ç¬¬äº”è¡Œ</span><br><span class="line">gd - è·³è½¬åˆ°å±€éƒ¨å®šä¹‰</span><br><span class="line">gD - è·³è½¬åˆ°å…¨å±€å®šä¹‰</span><br><span class="line">[m - ä¸Šä¸€ä¸ªå˜é‡ã€å‡½æ•°</span><br><span class="line">]m - ä¸‹ä¸€ä¸ªå˜é‡ã€å‡½æ•°</span><br><span class="line">fx - ç§»åŠ¨åˆ°å­—ç¬¦ x ä¸‹æ¬¡å‡ºç°çš„ä½ç½®</span><br><span class="line">tx - ç§»åŠ¨åˆ°å­—ç¬¦ x ä¸‹æ¬¡å‡ºç°çš„ä½ç½®çš„å‰ä¸€ä¸ªå­—ç¬¦</span><br><span class="line">Fx - ç§»åŠ¨åˆ°å­—ç¬¦ x ä¸Šæ¬¡å‡ºç°çš„ä½ç½®</span><br><span class="line">Tx - ç§»åŠ¨åˆ°å­—ç¬¦ x ä¸Šæ¬¡å‡ºç°çš„ä½ç½®çš„åä¸€ä¸ªå­—ç¬¦</span><br><span class="line">; - é‡å¤ä¹‹å‰çš„fã€tã€Fã€Tæ“ä½œ</span><br><span class="line">, - åå‘é‡å¤ä¹‹å‰çš„fã€tã€Fã€Tæ“ä½œ</span><br><span class="line">&#125; - ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªæ®µè½ (å½“ç¼–è¾‘ä»£ç æ—¶åˆ™ä¸ºå‡½æ•°ï¼ä»£ç å—)</span><br><span class="line">&#123; - ç§»åŠ¨åˆ°ä¸Šä¸€ä¸ªæ®µè½ (å½“ç¼–è¾‘ä»£ç æ—¶åˆ™ä¸ºå‡½æ•°ï¼ä»£ç å—)</span><br><span class="line">zz - ç§»åŠ¨å±å¹•ä½¿å…‰æ ‡å±…ä¸­</span><br><span class="line">Ctrl + e - å‘ä¸‹ç§»åŠ¨å±å¹•ä¸€è¡Œ(ä¿æŒå…‰æ ‡ä¸åŠ¨)</span><br><span class="line">Ctrl + <span class="attribute">y</span> - å‘ä¸Šç§»åŠ¨å±å¹•ä¸€è¡Œ(ä¿æŒå…‰æ ‡ä¸åŠ¨)</span><br><span class="line">Ctrl + <span class="selector-tag">b</span> - å‘ä¸Šæ»šåŠ¨ä¸€å±</span><br><span class="line">Ctrl + f - å‘ä¸‹æ»šåŠ¨ä¸€å±</span><br><span class="line">Ctrl + d - å‘ä¸‹æ»šåŠ¨åŠå±</span><br><span class="line">Ctrl + u - å‘ä¸Šæ»šåŠ¨åŠå±</span><br></pre></td></tr></table></figure><h2 id="æ’å…¥æ¨¡å¼-æ’å…¥-è¿½åŠ æ–‡æœ¬"><a href="#æ’å…¥æ¨¡å¼-æ’å…¥-è¿½åŠ æ–‡æœ¬" class="headerlink" title="æ’å…¥æ¨¡å¼ - æ’å…¥&#x2F;è¿½åŠ æ–‡æœ¬"></a>æ’å…¥æ¨¡å¼ - æ’å…¥&#x2F;è¿½åŠ æ–‡æœ¬</h2><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">i - ä»å…‰æ ‡å‰å¼€å§‹æ’å…¥å­—ç¬¦</span><br><span class="line">I - ä»è¡Œé¦–å¼€å§‹æ’å…¥å­—ç¬¦</span><br><span class="line">a - ä»å…‰æ ‡åå¼€å§‹æ’å…¥å­—ç¬¦</span><br><span class="line">A - ä»è¡Œå°¾å¼€å§‹æ’å…¥å­—ç¬¦</span><br><span class="line">o - åœ¨å½“å‰è¡Œä¹‹ä¸‹å¦èµ·ä¸€è¡Œ, å¼€å§‹æ’å…¥å­—ç¬¦</span><br><span class="line">O - åœ¨å½“å‰è¡Œä¹‹ä¸Šå¦èµ·ä¸€è¡Œ, å¼€å§‹æ’å…¥å­—ç¬¦</span><br><span class="line">ea - ä»å½“å‰å•è¯æœ«å°¾å¼€å§‹æ’å…¥</span><br><span class="line">Ctrl + h - åœ¨æ’å…¥æ¨¡å¼ä¸‹ï¼Œåˆ é™¤å…‰æ ‡å‰çš„å­—ç¬¦</span><br><span class="line">Ctrl + w - åœ¨æ’å…¥æ¨¡å¼ä¸‹ï¼Œåˆ é™¤å…‰æ ‡å‰çš„å•è¯</span><br><span class="line">Ctrl + j - åœ¨æ’å…¥æ¨¡å¼ä¸‹ï¼Œå¦èµ·ä¸€è¡Œ</span><br><span class="line">Ctrl + t - åœ¨æ’å…¥æ¨¡å¼ä¸‹ï¼Œå‘å³ç¼©è¿›ï¼Œå®½åº¦ç”± shiftwidth æ§åˆ¶</span><br><span class="line">Ctrl + d - åœ¨æ’å…¥æ¨¡å¼ä¸‹ï¼Œå‘å·¦ç¼©è¿›ï¼Œå®½åº¦ç”± shiftwidth æ§åˆ¶</span><br><span class="line">Ctrl + n - åœ¨æ’å…¥æ¨¡å¼ä¸‹ï¼Œåœ¨å…‰æ ‡ä¹‹å‰æ’å…¥è‡ªåŠ¨è¡¥å…¨çš„ä¸‹ä¸€ä¸ªåŒ¹é…é¡¹</span><br><span class="line">Ctrl + p - åœ¨æ’å…¥æ¨¡å¼ä¸‹ï¼Œåœ¨å…‰æ ‡ä¹‹å‰æ’å…¥è‡ªåŠ¨è¡¥å…¨çš„ä¸Šä¸€ä¸ªåŒ¹é…é¡¹</span><br><span class="line"><span class="built_in">CTRL</span>-X <span class="built_in">CTRL</span>-F - åœ¨æ’å…¥æ¨¡å¼ä¸‹ï¼Œè¡¥å…¨ç±»å‹æ–‡æœ¬ï¼šæ–‡ä»¶å</span><br><span class="line"><span class="built_in">CTRL</span>-X <span class="built_in">CTRL</span>-L - åœ¨æ’å…¥æ¨¡å¼ä¸‹ï¼Œè¡¥å…¨ç±»å‹æ–‡æœ¬ï¼šæ•´è¡Œ</span><br><span class="line"><span class="built_in">CTRL</span>-X <span class="built_in">CTRL</span>-D - åœ¨æ’å…¥æ¨¡å¼ä¸‹ï¼Œè¡¥å…¨ç±»å‹æ–‡æœ¬ï¼šå®å®šä¹‰ (åŒ…æ‹¬åŒ…å«æ–‡ä»¶é‡Œçš„)</span><br><span class="line"><span class="built_in">CTRL</span>-X <span class="built_in">CTRL</span>-I - åœ¨æ’å…¥æ¨¡å¼ä¸‹ï¼Œè¡¥å…¨ç±»å‹æ–‡æœ¬ï¼šå½“å‰æ–‡ä»¶ä»¥åŠæ‰€åŒ…å«çš„æ–‡ä»¶</span><br><span class="line"><span class="built_in">CTRL</span>-X <span class="built_in">CTRL</span>-K - åœ¨æ’å…¥æ¨¡å¼ä¸‹ï¼Œè¡¥å…¨ç±»å‹æ–‡æœ¬ï¼šå­—å…¸æ–‡ä»¶å†…çš„å•è¯</span><br><span class="line"><span class="built_in">CTRL</span>-X <span class="built_in">CTRL</span>-T - åœ¨æ’å…¥æ¨¡å¼ä¸‹ï¼Œè¡¥å…¨ç±»å‹æ–‡æœ¬ï¼šåŒä¹‰è¯è¯å…¸æ–‡ä»¶å†…çš„å•è¯</span><br><span class="line"><span class="built_in">CTRL</span>-X <span class="built_in">CTRL</span>-] - åœ¨æ’å…¥æ¨¡å¼ä¸‹ï¼Œè¡¥å…¨ç±»å‹æ–‡æœ¬ï¼šæ ‡ç­¾</span><br><span class="line"><span class="built_in">CTRL</span>-X <span class="built_in">CTRL</span>-V - åœ¨æ’å…¥æ¨¡å¼ä¸‹ï¼Œè¡¥å…¨ç±»å‹æ–‡æœ¬ï¼šVim å‘½ä»¤è¡Œ</span><br><span class="line">Ctrl + rx - æ’å…¥å¯„å­˜å™¨ x çš„å†…å®¹</span><br><span class="line">Ctrl + ox - æš‚æ—¶è¿›å…¥æ­£å¸¸æ¨¡å¼ä»¥å‘å‡ºä¸€ä¸ªæ­£å¸¸æ¨¡å¼å‘½ä»¤ xã€‚</span><br><span class="line">Ctrl + o - æš‚æ—¶è¿›å…¥æ­£å¸¸æ¨¡å¼</span><br><span class="line">Esc - é€€å‡ºæ’å…¥æ¨¡å¼</span><br><span class="line">Ctrl + [ - é€€å‡ºæ’å…¥æ¨¡å¼</span><br></pre></td></tr></table></figure><h2 id="ç¼–è¾‘æ–‡æœ¬"><a href="#ç¼–è¾‘æ–‡æœ¬" class="headerlink" title="ç¼–è¾‘æ–‡æœ¬"></a>ç¼–è¾‘æ–‡æœ¬</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">r</span> - æ›¿æ¢å½“å‰å­—ç¬¦</span><br><span class="line"><span class="built_in">R</span> - åœ¨ ESC æŒ‰ä¸‹ä¹‹å‰ï¼Œæ›¿æ¢å¤šä¸ªå­—ç¬¦(é€€æ ¼é”®å¯ä»¥æ’¤é”€ä¿®æ”¹)</span><br><span class="line">J - å°†ä¸‹ä¸€è¡Œåˆå¹¶åˆ°å½“å‰è¡Œ, å¹¶åœ¨ä¸¤éƒ¨åˆ†æ–‡æœ¬ä¹‹é—´æ’å…¥ä¸€ä¸ªç©ºæ ¼</span><br><span class="line">gJ - å°†ä¸‹ä¸€è¡Œåˆå¹¶åˆ°å½“å‰è¡Œ, ä¸¤éƒ¨åˆ†æ–‡æœ¬ä¹‹é—´ä¸å«ç©ºæ ¼</span><br><span class="line">gwip - é‡æ–°è°ƒæ•´æ®µè½</span><br><span class="line">g~ - å¤§å°å†™è½¬æ¢æ“ä½œä¿®é¥°ç¬¦</span><br><span class="line"><span class="built_in">gu</span> - å°å†™æ“ä½œä¿®é¥°ç¬¦</span><br><span class="line"><span class="built_in">gU</span> - å¤§å†™æ“ä½œä¿®é¥°ç¬¦</span><br><span class="line">cc - å°†å…‰æ ‡æ‰€åœ¨çš„è¡Œåˆ é™¤, ç„¶åè¿›å…¥æ’å…¥æ¨¡å¼</span><br><span class="line">c<span class="variable">$</span> or C - å°†å…‰æ ‡å¤„åˆ°è¡Œå°¾åˆ é™¤, ç„¶åè¿›å…¥æ’å…¥æ¨¡å¼</span><br><span class="line">ciw - å°†å…‰æ ‡æ‰€åœ¨çš„å•è¯åˆ é™¤, ç„¶åè¿›å…¥æ’å…¥æ¨¡å¼</span><br><span class="line">cw or ce - ä»å…‰æ ‡ä½ç½®å¼€å§‹, ä¿®æ”¹å•è¯</span><br><span class="line">s - åˆ é™¤å½“å‰å­—ç¬¦, ç„¶åè¿›å…¥æ’å…¥æ¨¡å¼</span><br><span class="line">S - æ¸…ç©ºå½“å‰è¡Œ, ç„¶åè¿›å…¥æ’å…¥æ¨¡å¼ (åŒcc)</span><br><span class="line">xp - å½“å‰å­—ç¬¦åç§»</span><br><span class="line">u - æ’¤é”€</span><br><span class="line">U - æ’¤é”€ä¸Šä¸€æ¬¡çš„æ”¹åŠ¨è¡Œçš„æ“ä½œ</span><br><span class="line">Ctrl + <span class="built_in">r</span> - é‡åšï¼ˆå–æ¶ˆæ’¤é”€ï¼‰</span><br><span class="line">. - å†æ¬¡æ‰§è¡Œä¸Šä¸ªå‘½ä»¤</span><br></pre></td></tr></table></figure><h2 id="é€‰æ‹©æ–‡æœ¬ï¼ˆå¯è§†åŒ–æ¨¡å¼ï¼‰"><a href="#é€‰æ‹©æ–‡æœ¬ï¼ˆå¯è§†åŒ–æ¨¡å¼ï¼‰" class="headerlink" title="é€‰æ‹©æ–‡æœ¬ï¼ˆå¯è§†åŒ–æ¨¡å¼ï¼‰"></a>é€‰æ‹©æ–‡æœ¬ï¼ˆå¯è§†åŒ–æ¨¡å¼ï¼‰</h2><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">v - è¿›å…¥å¯è§†åŒ–æ¨¡å¼, ç§»åŠ¨å…‰æ ‡é«˜äº®é€‰æ‹©, ç„¶åå¯ä»¥å¯¹é€‰æ‹©çš„æ–‡æœ¬æ‰§è¡Œå‘½ä»¤(æ¯” y - å¤åˆ¶)</span></span><br><span class="line"><span class="language-xml">V - è¿›å…¥å¯è§†åŒ–æ¨¡å¼(è¡Œç²’åº¦é€‰æ‹©)</span></span><br><span class="line"><span class="language-xml">o - åˆ‡æ¢å…‰æ ‡åˆ°é€‰æ‹©åŒºå¼€å¤´/ç»“å°¾</span></span><br><span class="line"><span class="language-xml">Ctrl + v - è¿›å…¥å¯è§†åŒ–æ¨¡å¼(çŸ©é˜µé€‰æ‹©)</span></span><br><span class="line"><span class="language-xml">O - åˆ‡æ¢å…‰æ ‡åˆ°é€‰æ‹©åŒºçš„è§’</span></span><br><span class="line"><span class="language-xml">aw - é€‰æ‹©å½“å‰å•è¯</span></span><br><span class="line"><span class="language-xml">ab - é€‰æ‹©è¢« () åŒ…è£¹çš„åŒºåŸŸ(å«æ‹¬å·)</span></span><br><span class="line"><span class="language-xml">aB - é€‰æ‹©è¢« </span><span class="template-variable">&#123;&#125;</span><span class="language-xml"> åŒ…è£¹çš„åŒºåŸŸ(å«èŠ±æ‹¬å·)</span></span><br><span class="line"><span class="language-xml">at - é€‰æ‹©è¢« <span class="tag">&lt;&gt;</span> æ ‡ç­¾åŒ…è£¹çš„åŒºåŸŸ(å«<span class="tag">&lt;&gt;</span>æ ‡ç­¾)</span></span><br><span class="line"><span class="language-xml">ib - é€‰æ‹©è¢« () åŒ…è£¹çš„åŒºåŸŸ(ä¸å«æ‹¬å·)</span></span><br><span class="line"><span class="language-xml">iB - é€‰æ‹©è¢« </span><span class="template-variable">&#123;&#125;</span><span class="language-xml"> åŒ…è£¹çš„åŒºåŸŸ(ä¸å«èŠ±æ‹¬å·)</span></span><br><span class="line"><span class="language-xml">it - é€‰æ‹©è¢« <span class="tag">&lt;&gt;</span> æ ‡ç­¾åŒ…è£¹çš„åŒºåŸŸ(ä¸å«<span class="tag">&lt;&gt;</span>æ ‡ç­¾)</span></span><br><span class="line"><span class="language-xml">gv - å†æ¬¡é€‰ä¸­ä¹‹å‰é€‰æ‹©çš„æ–‡æœ¬</span></span><br><span class="line"><span class="language-xml">Esc - é€€å‡ºå¯è§†åŒ–æ¨¡å¼</span></span><br><span class="line"><span class="language-xml"> Tip ä¹Ÿå¯ä»¥ä½¿ç”¨ ( å’Œ </span><span class="template-variable">&#123; åˆ†åˆ«ä»£æ›¿ b å’Œ B </span></span><br></pre></td></tr></table></figure><h2 id="å¯è§†åŒ–æ¨¡å¼å‘½ä»¤"><a href="#å¯è§†åŒ–æ¨¡å¼å‘½ä»¤" class="headerlink" title="å¯è§†åŒ–æ¨¡å¼å‘½ä»¤"></a>å¯è§†åŒ–æ¨¡å¼å‘½ä»¤</h2><figure class="highlight node-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">&gt;</span> <span class="language-javascript">- å‘å³ç¼©è¿›</span></span><br><span class="line">&lt; - å‘å·¦ç¼©è¿›</span><br><span class="line">y - å¤åˆ¶</span><br><span class="line">d - å‰ªåˆ‡</span><br><span class="line">~ - å¤§å°å†™åˆ‡æ¢</span><br><span class="line">u - å°†é€‰ä¸­æ–‡æœ¬è½¬æ¢ä¸ºå°å†™</span><br><span class="line">U - å°†é€‰ä¸­æ–‡æœ¬è½¬æ¢ä¸ºå¤§å†™</span><br></pre></td></tr></table></figure><h2 id="å¯„å­˜å™¨"><a href="#å¯„å­˜å™¨" class="headerlink" title="å¯„å­˜å™¨"></a>å¯„å­˜å™¨</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">:<span class="keyword">reg</span>[isters] - æ˜¾ç¤ºå¯„å­˜å™¨å†…å®¹</span><br><span class="line"><span class="comment">&quot;xy - å¤åˆ¶å†…å®¹åˆ°å¯„å­˜å™¨ x</span></span><br><span class="line"><span class="comment">&quot;xp - ç²˜è´´å¯„å­˜å™¨ x ä¸­çš„å†…å®¹</span></span><br><span class="line"><span class="comment">&quot;+y - å¤åˆ¶å†…å®¹åˆ°ç³»ç»Ÿå‰ªè´´æ¿å¯„å­˜å™¨</span></span><br><span class="line"><span class="comment">&quot;+p - ç²˜è´´ç³»ç»Ÿå‰ªè´´æ¿å¯„å­˜å™¨çš„å†…å®¹</span></span><br><span class="line"></span><br><span class="line">Tip å¯„å­˜å™¨è¢«å­˜å‚¨åœ¨ ~/.viminfo ä¸­, åœ¨ä¸‹æ¬¡é‡å¯<span class="keyword">vim</span>æ—¶ä»ä¼šåŠ è½½</span><br><span class="line">Tip ç‰¹æ®Šå¯„å­˜å™¨ï¼š</span><br><span class="line"></span><br><span class="line">â€ƒ<span class="number">0</span> - ä¸Šæ¬¡å¤åˆ¶</span><br><span class="line">â€ƒ<span class="comment">&quot; - æœªå‘½åå¯„å­˜å™¨ï¼Œä¸Šæ¬¡å¤åˆ¶æˆ–åˆ é™¤</span></span><br><span class="line">â€ƒ% - å½“å‰æ–‡ä»¶å</span><br><span class="line">â€ƒ# - è½®æ¢æ–‡ä»¶å</span><br><span class="line">â€ƒ* - å‰ªè´´æ¿å†…å®¹ (X11 primary)</span><br><span class="line">â€ƒ+ - å‰ªè´´æ¿å†…å®¹ (X11 clipboard)</span><br><span class="line">â€ƒ/ - ä¸Šæ¬¡æœç´¢çš„pattern</span><br><span class="line">â€ƒ: - ä¸Šæ¬¡æ‰§è¡Œçš„å‘½ä»¤</span><br><span class="line">â€ƒ. - ä¸Šæ¬¡æ’å…¥çš„æ–‡æœ¬</span><br><span class="line">â€ƒ- - ä¸Šæ¬¡å‰ªåˆ‡çš„çŸ­äºä¸€è¡Œçš„æ–‡æœ¬</span><br><span class="line">â€ƒ= - è¡¨è¾¾å¼å¯„å­˜å™¨</span><br><span class="line">â€ƒ_ - é»‘æ´å¯„å­˜å™¨</span><br></pre></td></tr></table></figure><h2 id="æ ‡è®°"><a href="#æ ‡è®°" class="headerlink" title="æ ‡è®°"></a>æ ‡è®°</h2><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">:marks - æ ‡è®°åˆ—è¡¨</span><br><span class="line">ma - è®¾ç½®å½“å‰ä½ç½®ä¸ºæ ‡è®° a</span><br><span class="line">`a - è·³è½¬åˆ°æ ‡è®° a çš„ä½ç½®</span><br><span class="line">y`a - å¤åˆ¶å½“å‰ä½ç½®åˆ°æ ‡è®° a çš„å†…å®¹</span><br><span class="line">`0 - è·³è½¬åˆ°ä¸Šæ¬¡ Vim é€€å‡ºæ—¶çš„ä½ç½®</span><br><span class="line">`&quot; - è·³è½¬åˆ°ä¸Šæ¬¡ç¼–è¾‘è¯¥æ–‡ä»¶æ—¶çš„ä½ç½®</span><br><span class="line">`. - è·³è½¬åˆ°ä¸Šæ¬¡ä¿®æ”¹çš„ä½ç½®</span><br><span class="line">`` - è·³è½¬å›ä¸Šæ¬¡è·³è½¬å‰çš„ä½ç½®</span><br><span class="line">:ju[mps] - åˆ—å‡ºè·³è½¬å†å²è®°å½•</span><br><span class="line">Ctrl + i - è·³è½¬è‡³è·³è½¬å†å²ä¸­è¾ƒæ™šçš„ä½ç½®</span><br><span class="line">Ctrl + o - è·³è½¬å›è·³è½¬å†å²ä¸­è¾ƒæ—©çš„ä½ç½®</span><br><span class="line">:changes - åˆ—å‡ºä¿®æ”¹å†å²è®°å½•</span><br><span class="line"><span class="built_in">g,</span> - è·³è½¬è‡³ä¿®æ”¹å†å²ä¸­è¾ƒæ™šä¿®æ”¹çš„ä½ç½®</span><br><span class="line">g<span class="comment">; - è·³è½¬è‡³ä¿®æ”¹å†å²ä¸­è¾ƒæ—©ä¿®æ”¹çš„ä½ç½®</span></span><br><span class="line">Ctrl + ] - è·³è½¬åˆ°å½“å‰å…‰æ ‡ä½ç½®å¯¹åº”çš„ tag</span><br><span class="line">Tip å¯ä»¥ä½¿ç”¨åå¼•å·(`)æˆ–å•å¼•å·(&#x27;)è·³è½¬è‡³æ ‡è®°ä½ç½®ã€‚ä½¿ç”¨å•å¼•å·ä¼šè·³è½¬è‡³è¯¥æ ‡è®°æ‰€åœ¨è¡Œè¡Œé¦–(é¦–ä¸ªéç©ºç™½å­—ç¬¦)ã€‚</span><br></pre></td></tr></table></figure><h2 id="å®"><a href="#å®" class="headerlink" title="å®"></a>å®</h2><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">qa - å½•åˆ¶å® <span class="keyword">a</span></span><br><span class="line">q - åœæ­¢å½•åˆ¶å®</span><br><span class="line">@<span class="keyword">a</span> - æ‰§è¡Œå® <span class="keyword">a</span></span><br><span class="line">@@ - é‡æ–°æ‰§è¡Œä¸Šæ¬¡æ‰§è¡Œçš„å®</span><br><span class="line">qA/<span class="built_in">word</span>&lt;Enter&gt;q - å¯¹å® <span class="keyword">a</span> è¿½åŠ æœç´¢<span class="built_in">word</span>å‘½ä»¤</span><br></pre></td></tr></table></figure><h2 id="å‰ªåˆ‡-å¤åˆ¶-ç²˜è´´"><a href="#å‰ªåˆ‡-å¤åˆ¶-ç²˜è´´" class="headerlink" title="å‰ªåˆ‡, å¤åˆ¶, ç²˜è´´"></a>å‰ªåˆ‡, å¤åˆ¶, ç²˜è´´</h2><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">yy - å¤åˆ¶å½“å‰è¡Œ</span><br><span class="line"><span class="number">2</span>yy - å¤åˆ¶ <span class="number">2</span> è¡Œ</span><br><span class="line">yw - å¤åˆ¶å½“å‰å•è¯</span><br><span class="line">yiw - å¤åˆ¶å…‰æ ‡å¤„çš„å•è¯</span><br><span class="line">yaw - å¤åˆ¶å…‰æ ‡å¤„çš„å•è¯åŠå…¶å‰åçš„ç©ºæ ¼</span><br><span class="line">yas - å¤åˆ¶å…‰æ ‡å¤„çš„æ‰€åœ¨è¡Œçš„æ®µè½</span><br><span class="line">y$ <span class="keyword">or </span>Y - å¤åˆ¶, ä»å…‰æ ‡ä½ç½®åˆ°è¡Œæœ«</span><br><span class="line">p - åœ¨å…‰æ ‡åç²˜è´´</span><br><span class="line">P - åœ¨å…‰æ ‡å‰ç²˜è´´</span><br><span class="line"><span class="built_in">gp</span> - åœ¨å…‰æ ‡åç²˜è´´å¹¶æŠŠå…‰æ ‡å®šä½äºç²˜è´´çš„æ–‡æœ¬ä¹‹å</span><br><span class="line"><span class="built_in">gP</span> - åœ¨å…‰æ ‡å‰ç²˜è´´å¹¶æŠŠå…‰æ ‡å®šä½äºç²˜è´´çš„æ–‡æœ¬ä¹‹å</span><br><span class="line">:pu - æ–°å»ºä¸€è¡Œå¹¶ä¸”ç²˜è´´</span><br><span class="line">dd - å‰ªåˆ‡å½“å‰è¡Œ</span><br><span class="line"><span class="number">2</span>dd - å‰ªåˆ‡ <span class="number">2</span> è¡Œ</span><br><span class="line">dw - å‰ªåˆ‡å½“å‰å•è¯</span><br><span class="line"><span class="keyword">diw </span>- åˆ é™¤å…‰æ ‡å¤„çš„å•è¯</span><br><span class="line">daw - åˆ é™¤å…‰æ ‡å¤„çš„å•è¯åŠå…¶å‰åçš„ç©ºæ ¼</span><br><span class="line">das - åˆ é™¤å…‰æ ‡å¤„çš„æ‰€åœ¨è¡Œçš„æ®µè½</span><br><span class="line">d$ <span class="keyword">or </span>D - å‰ªåˆ‡, ä»å…‰æ ‡ä½ç½®åˆ°è¡Œæœ« (åŒ D )</span><br><span class="line">x - å‰ªåˆ‡å½“å‰å­—ç¬¦</span><br></pre></td></tr></table></figure><h2 id="æ–‡å­—ç¼©è¿›"><a href="#æ–‡å­—ç¼©è¿›" class="headerlink" title="æ–‡å­—ç¼©è¿›"></a>æ–‡å­—ç¼©è¿›</h2><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt; - å°†å½“å‰è¡Œå‘å³ç¼©è¿›ï¼Œå®½åº¦ç”± shiftwidth æ§åˆ¶</span><br><span class="line">&lt;&lt; - å°†å½“å‰è¡Œå‘å·¦ç¼©è¿›ï¼Œå®½åº¦ç”± shiftwidth æ§åˆ¶</span><br><span class="line">&gt;% - å‘å³ç¼©è¿› () æˆ– &#123;&#125; å†…çš„åŒºåŸŸ (å…‰æ ‡éœ€ç½®äºæ‹¬å·ä¸Š)</span><br><span class="line">&gt;ib - å‘å³ç¼©è¿› () å†…çš„åŒºåŸŸ</span><br><span class="line">&gt;at - å‘å³ç¼©è¿› &lt;&gt; æ ‡ç­¾å†…çš„åŒºåŸŸ</span><br><span class="line"><span class="number">3</span>== - è‡ªåŠ¨ç¼©è¿› <span class="number">3</span> è¡Œ</span><br><span class="line">=% - è‡ªåŠ¨ç¼©è¿› () æˆ– &#123;&#125; å†…çš„åŒºåŸŸ (å…‰æ ‡éœ€ç½®äºæ‹¬å·ä¸Š)</span><br><span class="line">=iB - è‡ªåŠ¨ç¼©è¿› &#123;&#125; å†…çš„åŒºåŸŸ (å…‰æ ‡éœ€ç½®äºæ‹¬å·ä¸Š)</span><br><span class="line">gg=G - è‡ªåŠ¨ç¼©è¿›æ•´ä¸ªç¼“å†²åŒº</span><br><span class="line">]p - ç²˜è´´å¹¶è°ƒæ•´ç¼©è¿›è‡³å½“å‰è¡Œ</span><br></pre></td></tr></table></figure><h2 id="é€€å‡º"><a href="#é€€å‡º" class="headerlink" title="é€€å‡º"></a>é€€å‡º</h2><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">:w - ä¿å­˜</span><br><span class="line">:w !sudo tee % - ä½¿ç”¨ sudo ä¿å­˜å½“å‰æ–‡ä»¶</span><br><span class="line"><span class="meta">:wq or :x</span> or ZZ - ä¿å­˜å¹¶é€€å‡º</span><br><span class="line">:q - é€€å‡º(ä¿®æ”¹æœªä¿å­˜æ—¶è­¦å‘Š)</span><br><span class="line">:q! or ZQ - ä¸ä¿å­˜å¼ºåˆ¶é€€å‡º</span><br><span class="line">:wqa - ä¿å­˜æ‰€æœ‰æ ‡ç­¾é¡µå¹¶å…¨éƒ¨é€€å‡º</span><br></pre></td></tr></table></figure><h2 id="æŸ¥æ‰¾-æ›¿æ¢"><a href="#æŸ¥æ‰¾-æ›¿æ¢" class="headerlink" title="æŸ¥æ‰¾&#x2F;æ›¿æ¢"></a>æŸ¥æ‰¾&#x2F;æ›¿æ¢</h2><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">/pattern - æŸ¥æ‰¾ pattern</span><br><span class="line"><span class="string">?p</span>attern - å‘ä¸ŠæŸ¥æ‰¾ pattern</span><br><span class="line">\vpattern - pattern ä¸­çš„éå­—æ¯æ•°å­—å­—ç¬¦è¢«è§†ä¸ºæ­£åˆ™è¡¨è¾¾å¼ç‰¹æ®Šå­—ç¬¦ (ä¸éœ€è½¬ä¹‰å­—ç¬¦)</span><br><span class="line">n - æŸ¥æ‰¾ä¸‹ä¸€ä¸ª</span><br><span class="line">N - æŸ¥æ‰¾ä¸Šä¸€ä¸ª</span><br><span class="line"></span><br><span class="line">\&lt; æŒ‡å®šåŒ¹é…å•è¯å¼€å¤´</span><br><span class="line">\&gt; æŒ‡å®šåŒ¹é…å•è¯ç»“å°¾</span><br><span class="line"><span class="symbol">:%s/old/new/g</span> - æ›¿æ¢å…¨éƒ¨ï¼Œå¯ç”¨åŠ å·ä»£æ›¿æ­£æ–œæ </span><br><span class="line"><span class="symbol">:%s/old/new/gc</span> - (é€ä¸ª)æ›¿æ¢</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">è¿™æœ‰ç‚¹åƒ <span class="string">&quot;:substitute&quot;</span> å‘½ä»¤ã€‚åªæ˜¯å®ƒä¸æ›¿æ¢æ–‡æœ¬ï¼Œè€Œæ˜¯æ‰§è¡Œ &#123;command&#125; æŒ‡å®šçš„å‘½ä»¤ã€‚</span><br><span class="line"><span class="symbol">:</span>[range]global/&#123;pattern&#125;/&#123;command&#125;</span><br><span class="line">è¿™ä¸ªå‘½ä»¤ç”¨ <span class="string">&quot;:g&quot;</span> å¼€å¤´ï¼Œè¿™æ˜¯ <span class="string">&quot;:global&quot;</span> çš„ç¼©å†™å½¢å¼ï¼Œå°±åƒ <span class="string">&quot;:s&quot;</span> æ˜¯ <span class="string">&quot;:substitute&quot;</span> çš„</span><br><span class="line">ç¼©å†™å½¢å¼ä¸€æ ·ã€‚ç„¶åæ˜¯ä¸€ä¸ªåŒ¹é…æ¨¡å¼ï¼Œç”±äºæ¨¡å¼ä¸­åŒ…æ‹¬æ­£æ–œæ ï¼Œæˆ‘ä»¬ç”¨åŠ å·ä½œåˆ†éš”ç¬¦ï¼Œå</span><br><span class="line">é¢æ˜¯ä¸€ä¸ªæŠŠ <span class="string">&quot;foobar&quot;</span> æ›¿æ¢æˆ <span class="string">&quot;barfoo&quot;</span> çš„æ›¿æ¢å‘½ä»¤ã€‚</span><br><span class="line">å…¨å±€å‘½ä»¤çš„é»˜è®¤èŒƒå›´æ˜¯æ•´ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥è¿™ä¸ªä¾‹å­ä¸­æ²¡æœ‰æŒ‡å®šèŒƒå›´ã€‚è¿™ä¸€ç‚¹ä¸</span><br><span class="line"><span class="string">&quot;:substitute&quot;</span> æ˜¯ä¸åŒçš„ã€‚åè€…åªä½œç”¨äºä¸€è¡Œã€‚</span><br><span class="line"><span class="symbol">:g+//+s/foobar/barfoo/g</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">:noh</span>[lsearch] - ç§»é™¤æœç´¢ç»“æœçš„é«˜äº®æ˜¾ç¤º</span><br></pre></td></tr></table></figure><h2 id="å¤šæ–‡ä»¶æœç´¢"><a href="#å¤šæ–‡ä»¶æœç´¢" class="headerlink" title="å¤šæ–‡ä»¶æœç´¢"></a>å¤šæ–‡ä»¶æœç´¢</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">:<span class="keyword">vim</span>[<span class="keyword">grep</span>] /pattern/ &#123;`&#123;<span class="keyword">file</span>&#125;`&#125; - åœ¨å¤šä¸ªæ–‡ä»¶ä¸­æœç´¢ pattern</span><br><span class="line"></span><br><span class="line"><span class="keyword">e</span>.g. :<span class="keyword">vim</span>[<span class="keyword">grep</span>] /foo/ **/*</span><br><span class="line"></span><br><span class="line">:<span class="keyword">cn</span>[ext] - ç§»åŠ¨è‡³ä¸‹ä¸€ä¸ª</span><br><span class="line">:<span class="keyword">cp</span>[revious] - ç§»åŠ¨è‡³ä¸Šä¸€ä¸ª</span><br><span class="line">:<span class="keyword">cope</span>[n] - æ‰“å¼€æœç´¢ç»“æœåˆ—è¡¨</span><br><span class="line">:<span class="keyword">ccl</span>[ose] - å…³é—­ quickfix çª—å£</span><br></pre></td></tr></table></figure><h2 id="æ ‡ç­¾"><a href="#æ ‡ç­¾" class="headerlink" title="æ ‡ç­¾"></a>æ ‡ç­¾</h2><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">:tabnew or :tabnew</span> &#123;page.words.file&#125; - åœ¨æ–°æ ‡ç­¾ä¸­æ‰“å¼€æ–‡ä»¶</span><br><span class="line">Ctrl + wT - å°†çª—å£å˜æˆæ ‡ç­¾</span><br><span class="line">gt or :tabn[ext] - åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªæ ‡ç­¾</span><br><span class="line">gT or :tabp[revious] - åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªæ ‡ç­¾</span><br><span class="line">#gt - åˆ‡æ¢åˆ°ç¬¬ # ä¸ªæ ‡ç­¾</span><br><span class="line">:tabm[ove] # - ç§»åŠ¨æ ‡ç­¾åˆ°ç¬¬ # ä½(ä¸‹æ ‡ä» 0 å¼€å§‹)</span><br><span class="line">:tabc[lose] - å…³é—­å½“å‰æ ‡ç­¾</span><br><span class="line">:tabo[nly] - å…³é—­å…¶ä»–æ ‡ç­¾</span><br><span class="line"><span class="meta">:tabdo command - åœ¨æ‰€æœ‰æ ‡ç­¾ä¸­æ‰§è¡Œå‘½ä»¤ (ä¾‹å¦‚ :tabdo</span> q å…³é—­æ‰€æœ‰æ ‡ç­¾)</span><br></pre></td></tr></table></figure><h2 id="å¤šæ–‡ä»¶ç¼–è¾‘"><a href="#å¤šæ–‡ä»¶ç¼–è¾‘" class="headerlink" title="å¤šæ–‡ä»¶ç¼–è¾‘"></a>å¤šæ–‡ä»¶ç¼–è¾‘</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">:<span class="keyword">e</span>[dit] æ–‡ä»¶å - æ–°å»ºç¼“å†²åŒºæ‰“å¼€ filename</span><br><span class="line">:<span class="keyword">bn</span>[ext] - åˆ‡æ¢åˆ°ä¸‹ä¸ªç¼“å†²åŒº</span><br><span class="line">:<span class="keyword">bp</span>[revious] - åˆ‡æ¢åˆ°ä¸Šä¸ªç¼“å†²åŒº</span><br><span class="line">:<span class="keyword">bd</span>[elete] - å…³é—­ç¼“å†²åŒº</span><br><span class="line">:<span class="keyword">b</span>[uffer]# - åˆ‡æ¢åˆ°ç¬¬ # ä¸ªç¼“å†²åŒº</span><br><span class="line">:<span class="keyword">b</span>[uffer] <span class="keyword">file</span> - ç”¨æ–‡ä»¶ååˆ‡æ¢ç¼“å†²åŒº</span><br><span class="line">:<span class="keyword">ls</span> <span class="built_in">or</span> :<span class="keyword">buffers</span> - åˆ—å‡ºæ‰€æœ‰æ‰“å¼€çš„ç¼“å†²åŒº</span><br><span class="line">:<span class="keyword">sp</span>[lit] æ–‡ä»¶å - æ–°å»ºç¼“å†²åŒºæ‰“å¼€ filename å¹¶æ°´å¹³åˆ†å‰²çª—å£</span><br><span class="line">:<span class="keyword">vs</span>[plit] æ–‡ä»¶å - æ–°ç¼“å†²åŒºæ‰“å¼€ filename å¹¶å‚ç›´åˆ†å‰²çª—å£</span><br><span class="line">:<span class="keyword">vert</span>[ical] <span class="keyword">ba</span>[<span class="keyword">ll</span>] - å‚ç›´åˆ†å‰²çª—å£ç¼–è¾‘æ‰€æœ‰ç¼“å†²åŒº</span><br><span class="line">:<span class="keyword">tab</span> <span class="keyword">ba</span>[<span class="keyword">ll</span>] - æ ‡ç­¾é¡µç¼–è¾‘æ‰€æœ‰ç¼“å†²åŒº</span><br><span class="line">Ctrl + <span class="keyword">ws</span> - æ°´å¹³åˆ†å‰²çª—å£</span><br><span class="line">Ctrl + <span class="keyword">wv</span> - å‚ç›´åˆ†å‰²çª—å£</span><br><span class="line">Ctrl + ww - åœ¨çª—å£é—´åˆ‡æ¢</span><br><span class="line">Ctrl + <span class="keyword">wq</span> - å…³é—­çª—å£</span><br><span class="line">Ctrl + wx - å½“å‰çª—å£ä¸ä¸‹ä¸€ä¸ªçª—å£äº¤æ¢ä½ç½®</span><br><span class="line">Ctrl + <span class="keyword">w</span>= - ä»¤æ‰€æœ‰çª—å£é«˜ &amp; å®½ä¸€è‡´</span><br><span class="line">Ctrl + <span class="keyword">wh</span> - åˆ‡æ¢åˆ°å·¦ä¾§çª—å£</span><br><span class="line">Ctrl + wl - åˆ‡æ¢åˆ°å³ä¾§çª—å£</span><br><span class="line">Ctrl + wj - åˆ‡æ¢åˆ°ä¸‹ä¾§çª—å£</span><br><span class="line">Ctrl + wk - åˆ‡æ¢åˆ°ä¸Šä¾§çª—å£</span><br><span class="line">Ctrl + wH - ä½¿æ¸¸æ ‡æ‰€åœ¨è§†çª—å…¨é«˜å¹¶ç§»è‡³æœ€å·¦ (æœ€å·¦å‚ç›´è§†çª—)</span><br><span class="line">Ctrl + wL - ä½¿æ¸¸æ ‡æ‰€åœ¨è§†çª—å…¨é«˜å¹¶ç§»è‡³æœ€å³ (æœ€å³å‚ç›´è§†çª—)</span><br><span class="line">Ctrl + wJ - ä½¿æ¸¸æ ‡æ‰€åœ¨è§†çª—å…¨å®½å¹¶ç§»è‡³æœ€ä¸‹ (æœ€ä¸‹æ°´å¹³è§†çª—)</span><br><span class="line">Ctrl + wK - ä½¿æ¸¸æ ‡æ‰€åœ¨è§†çª—å…¨å®½å¹¶ç§»è‡³æœ€ä¸Š (æœ€ä¸Šæ°´å¹³è§†çª—)</span><br><span class="line"></span><br><span class="line">:<span class="keyword">args</span> - æŸ¥çœ‹<span class="keyword">vim</span>æ‰“å¼€çš„æ•´ä¸ªæ–‡ä»¶åˆ—è¡¨</span><br><span class="line">:<span class="keyword">prev</span> - ä¸Šä¸€ä¸ªæ–‡ä»¶</span><br><span class="line">:<span class="keyword">next</span> - ä¸‹ä¸€ä¸ªæ–‡ä»¶</span><br><span class="line">:<span class="keyword">last</span> - æœ€åä¸€ä¸ªæ–‡ä»¶</span><br></pre></td></tr></table></figure><h2 id="Diff"><a href="#Diff" class="headerlink" title="Diff"></a>Diff</h2><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">zf - å®šä¹‰æŠ˜å ä¿®é¥°ç¬¦</span><br><span class="line">zd - åˆ é™¤å…‰æ ‡ä½ç½®çš„æŠ˜å </span><br><span class="line">za - å±•å¼€ &amp; å…³é—­å…‰æ ‡ä½ç½®çš„æŠ˜å </span><br><span class="line">zo - å±•å¼€å…‰æ ‡ä½ç½®çš„æŠ˜å </span><br><span class="line">zc - å…³é—­å…‰æ ‡ä½ç½®çš„æŠ˜å </span><br><span class="line">zr - å±•å¼€åŒçº§çš„æ‰€æœ‰æŠ˜å </span><br><span class="line">zm - å…³é—­åŒçº§çš„æ‰€æœ‰æŠ˜å </span><br><span class="line">zi - å¼€å¯ &amp; å…³é—­æŠ˜å åŠŸèƒ½</span><br><span class="line">]c - å…‰æ ‡ç§»è‡³ä¸‹ä¸€å¤„å·®å¼‚</span><br><span class="line">[c - å…‰æ ‡ç§»è‡³ä¸Šä¸€å¤„å·®å¼‚</span><br><span class="line">do <span class="keyword">or </span>:<span class="keyword">diffg[et] </span>- å°†å¦ä¸€ç¼“å†²åŒºä¸­çš„å·®å¼‚åˆå¹¶è‡³å½“å‰ç¼“å†²åŒº</span><br><span class="line">dp <span class="keyword">or </span>:<span class="keyword">diffpu[t] </span>- å°†å½“å‰ç¼“å†²åŒºä¸­çš„å·®å¼‚æ¨é€è‡³å¦ä¸€ç¼“å†²åŒº</span><br><span class="line">:<span class="keyword">diffthis </span>- ä»¤å½“å‰çª—å£æˆä¸º <span class="keyword">diff </span>æ¨¡å¼çš„çª—å£ä¹‹ä¸€</span><br><span class="line">:<span class="keyword">dif[fupdate] </span>- å¼ºåˆ¶åˆ·æ–° <span class="keyword">diff </span>çš„é«˜äº®ä¸æŠ˜å </span><br><span class="line">:<span class="keyword">diffo[ff] </span>- ä»¤å½“å‰çª—å£é€€å‡º <span class="keyword">diff </span>æ¨¡å¼</span><br><span class="line">:<span class="keyword">diffsplit </span>æ–‡ä»¶å - æ°´å¹³æ–¹å¼æ‰“å¼€<span class="keyword">diffçª—å£</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line">Tip æŠ˜å å‘½ä»¤(e.g. za)åªä½œç”¨äºå½“å‰çº§åˆ«ã€‚ä½¿ç”¨å¤§å†™å­—æ¯(e.g. zA)ä»¤å‘½ä»¤ä½œç”¨äºå…¨éƒ¨çº§åˆ«ã€‚</span><br><span class="line">Tip å¯ä»¥ç›´æ¥åœ¨ç»ˆç«¯è¿è¡Œ vimdiff æŸ¥çœ‹æ–‡ä»¶é—´çš„ä¸åŒã€‚ä¹Ÿå¯ä»¥å°†è¯¥ç¨‹åºè®¾ä¸º git <span class="keyword">difftool </span>çš„é€‰é¡¹ä¹‹ä¸€ã€‚</span><br></pre></td></tr></table></figure><h2 id="è¯»å†™æ–‡ä»¶"><a href="#è¯»å†™æ–‡ä»¶" class="headerlink" title="è¯»å†™æ–‡ä»¶"></a>è¯»å†™æ–‡ä»¶</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">:<span class="attribute">r</span>[ead] æ–‡ä»¶å - å°†æ–‡ä»¶å†…å®¹å†™å…¥åˆ°å½“å‰è¡Œ</span><br><span class="line">:<span class="number">0</span>r<span class="selector-attr">[ead]</span> æ–‡ä»¶å - å°†æ–‡ä»¶å†…å®¹å†™å…¥åˆ°<span class="number">0</span>è¡Œ</span><br><span class="line">:<span class="attribute">r</span>! sed -n <span class="string">&#x27;1,10p&#x27;</span> æ–‡ä»¶å - å°†æ–‡ä»¶åæŒ‡å®šèŒƒå›´å†…å®¹å†™å…¥åˆ°å½“å‰è¡Œï¼Œé€šè¿‡ç»“åˆ!command å®ç°</span><br><span class="line"></span><br><span class="line">:.,<span class="variable">$w</span><span class="selector-attr">[rite]</span> æ–‡ä»¶å - å°†æŒ‡å®šèŒƒå›´å†…å®¹å†™å…¥åˆ°æ–‡ä»¶ï¼Œæ–‡ä»¶å·²å­˜åœ¨éœ€è¦ä½¿ç”¨!writeï¼Œè¿›è¡Œè¦†ç›–å…¨æ–‡ä»¶</span><br><span class="line">:<span class="selector-class">.w</span> &gt;&gt; æ–‡ä»¶å - å°†å½“å‰ä½ç½®å†…å®¹å†™å…¥æ–‡ä»¶ï¼Œ.ä»£è¡¨å½“å‰è¡Œï¼Œ&gt;&gt;ä»£è¡¨è¿½åŠ </span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨å¤–éƒ¨ç¨‹åº"><a href="#ä½¿ç”¨å¤–éƒ¨ç¨‹åº" class="headerlink" title="ä½¿ç”¨å¤–éƒ¨ç¨‹åº"></a>ä½¿ç”¨å¤–éƒ¨ç¨‹åº</h2><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">!</span><span class="template-variable">&#123;motion&#125;</span><span class="template-variable">&#123;program&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">ç”¨ä¸€ä¸ªå¤–éƒ¨ç¨‹åºå¯¹ä¸€ä¸ªæ–‡æœ¬å—è¿›è¡Œè¿‡æ»¤ï¼Œæ‰§è¡Œä¸€ä¸ªç”± </span><span class="template-variable">&#123;program&#125;</span><span class="language-xml"> æŒ‡å®šçš„å¤–éƒ¨å‘½ä»¤ï¼Œç„¶åç”¨è¯¥ç¨‹åºçš„è¾“å‡º</span></span><br><span class="line"><span class="language-xml">æ›¿ä»£é€‰ä¸­çš„æ–‡æœ¬å—ã€‚</span></span><br><span class="line"><span class="language-xml">!5Gsort<span class="tag">&lt;<span class="name">Enter</span>&gt;</span> - å½“å‰è¡Œåˆ°5è¡Œï¼Œè¿›è¡Œæ’åº</span></span><br><span class="line"><span class="language-xml">!!date<span class="tag">&lt;<span class="name">Enter</span>&gt;</span> - å°†å½“å‰è¡Œæ›¿æ¢ä¸ºdateçš„ç»“æœ</span></span><br></pre></td></tr></table></figure><h2 id="æ–‡ä»¶æµè§ˆå™¨"><a href="#æ–‡ä»¶æµè§ˆå™¨" class="headerlink" title="æ–‡ä»¶æµè§ˆå™¨"></a><a href="https://yianwillis.github.io/vimcdoc/doc/usr_22.html#usr_22.txt">æ–‡ä»¶æµè§ˆå™¨</a></h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">:<span class="built_in">edit</span> .</span><br><span class="line">:hide <span class="built_in">edit</span> æ–‡ä»¶å - éšè—å½“å‰æ–‡ä»¶ï¼Œæ‰“å¼€æ–‡ä»¶åæ–‡ä»¶</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
          <category> vim </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ç¨‹åºåå°è¿è¡Œ</title>
      <link href="/posts/f33b9558.html"/>
      <url>/posts/f33b9558.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>ä¸€ã€ç¨‹åºåå°æ‰§è¡Œ</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># åå°è¿è¡Œ(å…³é—­sshä¼šæ–­å¼€)</span><br><span class="line">./<span class="keyword">test</span>.<span class="keyword">sh</span> &amp;</span><br><span class="line"></span><br><span class="line"># åå°è¿è¡Œ(å…³é—­sshåä¾æ—§è¿è¡Œ) è¾“å‡ºç»“æœå†™å…¥output.<span class="keyword">file</span></span><br><span class="line">nohup ./<span class="keyword">test</span>.<span class="keyword">sh</span> &gt; output.<span class="keyword">file</span> 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure><p>äºŒã€å¸¸ç”¨ä»»åŠ¡ç®¡ç†å‘½ä»¤</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># jobs      <span class="comment">//æŸ¥çœ‹ä»»åŠ¡ï¼Œè¿”å›ä»»åŠ¡ç¼–å·nå’Œè¿›ç¨‹å·</span></span></span><br><span class="line"><span class="meta"># bg  %n   <span class="comment">//å°†ç¼–å·ä¸ºnçš„ä»»åŠ¡è½¬åå°è¿è¡Œ</span></span></span><br><span class="line"><span class="meta"># fg  %n   <span class="comment">//å°†ç¼–å·ä¸ºnçš„ä»»åŠ¡è½¬å‰å°è¿è¡Œ</span></span></span><br><span class="line"><span class="meta"># ctrl+z    <span class="comment">//æŒ‚èµ·å½“å‰ä»»åŠ¡</span></span></span><br><span class="line"><span class="meta"># ctrl+c    <span class="comment">//ç»“æŸå½“å‰ä»»åŠ¡</span></span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ç³»ç»Ÿæ’æŸ¥</title>
      <link href="/posts/1f64d6a1.html"/>
      <url>/posts/1f64d6a1.html</url>
      
        <content type="html"><![CDATA[<h1 id="ç³»ç»Ÿæ’æŸ¥"><a href="#ç³»ç»Ÿæ’æŸ¥" class="headerlink" title="ç³»ç»Ÿæ’æŸ¥"></a>ç³»ç»Ÿæ’æŸ¥</h1><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># ç³»ç»Ÿèµ„æºç»Ÿè®¡</span></span><br><span class="line"><span class="built_in">dstat</span> æ˜¯ä¸€ä¸ªå¯ä»¥å–ä»£vmstatï¼Œiostatï¼Œnetstatå’Œifstatè¿™äº›å‘½ä»¤çš„å¤šåŠŸèƒ½äº§å“</span><br><span class="line"><span class="meta"># IOç›‘æ§</span></span><br><span class="line"><span class="built_in">dstat</span> -tclmnpydr --top-io</span><br><span class="line"><span class="meta"># CPUç›‘æ§</span></span><br><span class="line"><span class="built_in">dstat</span> -tclmnpydr --top-cpu</span><br><span class="line"><span class="meta"># æŸ¥çœ‹ç¡¬ç›˜é€Ÿåº¦ï¼Œç›‘æ§ç­‰</span></span><br><span class="line"><span class="built_in">dstat</span> -tclmnpydr --top-io --top-bio</span><br><span class="line"><span class="meta"># æŸ¥çœ‹å…¨éƒ¨å†…å­˜éƒ½æœ‰è°åœ¨å ç”¨</span></span><br><span class="line"><span class="built_in">dstat</span> -g -l -m -s --top-mem</span><br><span class="line"><span class="meta"># æ˜¾ç¤ºä¸€äº›å…³äºCPUèµ„æºæŸè€—çš„æ•°æ®</span></span><br><span class="line"><span class="built_in">dstat</span> -c -y -l --<span class="function"><span class="keyword">proc</span>-<span class="title">count</span> --<span class="title">top</span>-<span class="title">cpu</span></span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>passwdå‘½ä»¤</title>
      <link href="/posts/fe6f45bf.html"/>
      <url>/posts/fe6f45bf.html</url>
      
        <content type="html"><![CDATA[<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹ç”¨æˆ·å¯†ç </span></span><br><span class="line">passwd <span class="keyword">user</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>è¿›ç¨‹ç›¸å…³</title>
      <link href="/posts/a37e230c.html"/>
      <url>/posts/a37e230c.html</url>
      
        <content type="html"><![CDATA[<h1 id="è¿›ç¨‹"><a href="#è¿›ç¨‹" class="headerlink" title="è¿›ç¨‹"></a>è¿›ç¨‹</h1><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ é™¤æŒ‡å®šåç§°çš„è¿›ç¨‹</span></span><br><span class="line">ps -ef |<span class="string"> grep xxx </span>|<span class="string"> awk &#x27;&#123;print $2&#125;&#x27; </span>|<span class="string"> xargs kill -9</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>shiftå‘½ä»¤</title>
      <link href="/posts/d82d149.html"/>
      <url>/posts/d82d149.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># shiftå‘½ä»¤ç”¨äºå¯¹å‚æ•°çš„ç§»åŠ¨(å·¦ç§»)ï¼Œé€šå¸¸ç”¨äºåœ¨ä¸çŸ¥é“ä¼ å…¥å‚æ•°ä¸ªæ•°çš„æƒ…å†µä¸‹ä¾æ¬¡éå†æ¯ä¸ªå‚æ•°ç„¶åè¿›è¡Œç›¸åº”å¤„ç†ï¼ˆå¸¸è§äºLinuxä¸­å„ç§ç¨‹åºçš„å¯åŠ¨è„šæœ¬ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment"># $#-å‚æ•°ä¸ªæ•° $iç¬¬iä¸ªå‚æ•°  </span></span><br><span class="line"><span class="keyword">while</span> [ <span class="variable">$#</span> != 0 ];<span class="keyword">do</span>  </span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºï¼š<span class="variable">$1</span>,å‚æ•°ä¸ªæ•°ä¸ºï¼š<span class="variable">$#</span>&quot;</span>  </span><br><span class="line"><span class="built_in">shift</span>  </span><br><span class="line"><span class="keyword">done</span> </span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥å¦‚ä¸‹å‘½ä»¤è¿è¡Œï¼šrun.sh a b c d e f</span><br><span class="line"></span><br><span class="line">ç»“æœæ˜¾ç¤ºå¦‚ä¸‹ï¼š</span><br><span class="line">ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºï¼ša,å‚æ•°ä¸ªæ•°ä¸ºï¼š6</span><br><span class="line">ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºï¼šb,å‚æ•°ä¸ªæ•°ä¸ºï¼š5</span><br><span class="line">ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºï¼šc,å‚æ•°ä¸ªæ•°ä¸ºï¼š4</span><br><span class="line">ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºï¼šd,å‚æ•°ä¸ªæ•°ä¸ºï¼š3</span><br><span class="line">ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºï¼še,å‚æ•°ä¸ªæ•°ä¸ºï¼š2</span><br><span class="line">ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºï¼šf,å‚æ•°ä¸ªæ•°ä¸ºï¼š1</span><br><span class="line"></span><br><span class="line">ä»ä¸Šå¯çŸ¥ <span class="built_in">shift</span>(<span class="built_in">shift</span> 1) å‘½ä»¤æ¯æ‰§è¡Œä¸€æ¬¡ï¼Œå˜é‡çš„ä¸ªæ•°(<span class="variable">$#</span>)å‡ä¸€ï¼ˆä¹‹å‰çš„<span class="variable">$1</span>å˜é‡è¢«é”€æ¯,ä¹‹åçš„<span class="variable">$2</span>å°±å˜æˆäº†<span class="variable">$1</span>ï¼‰ï¼Œè€Œå˜é‡å€¼æå‰ä¸€ä½ã€‚</span><br><span class="line">åŒç†ï¼Œ<span class="built_in">shift</span> nåï¼Œå‰nä½å‚æ•°éƒ½ä¼šè¢«é”€æ¯</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>sedå‘½ä»¤</title>
      <link href="/posts/f54357bf.html"/>
      <url>/posts/f54357bf.html</url>
      
        <content type="html"><![CDATA[<h1 id="sedå‘½ä»¤"><a href="#sedå‘½ä»¤" class="headerlink" title="sedå‘½ä»¤"></a>sedå‘½ä»¤</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ipæŒ‡å®šèŒƒå›´å†…è®¿é—®æœ€å¤šå‰20 ï¼ˆ/data/logs/access.logè®¿é—®è®°å½•ï¼‰</span></span><br><span class="line"><span class="attribute">sed</span> -n &#x27;/<span class="number">16</span>:<span class="number">00</span>:<span class="number">00</span>/,/<span class="number">16</span>:<span class="number">26</span>:<span class="number">00</span>/&#x27;p /data/logs/access.log|awk &#x27;&#123;print $<span class="number">1</span>&#125;&#x27;|sort|uniq -c|sort -nr|head -<span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤åŒ…å«æŒ‡å®šå†…å®¹çš„è¡Œ(-e åªæ˜¾ç¤ºä¸ä¿®æ”¹æºæ–‡ä»¶ -iä¸æ˜¾ç¤ºä¼šä¿®æ”¹æºæ–‡ä»¶)</span></span><br><span class="line"><span class="attribute">sed</span> -e &#x27;/\<span class="string">&quot;other\&quot;\:\&quot;[0-9]\+\&quot;/d&#x27; test.log</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>sudoå…å¯†</title>
      <link href="/posts/cf4e0d77.html"/>
      <url>/posts/cf4e0d77.html</url>
      
        <content type="html"><![CDATA[<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## æ— æ³•ä½¿ç”¨su(xxxä¸åœ¨sudoersä¸­)</span></span><br><span class="line"><span class="built_in">chmod</span> 740 /etc/sudoers</span><br><span class="line">vim /etc/sudoers</span><br><span class="line">å¢åŠ (NOPASSWDä½¿ç”¨<span class="built_in">sudo</span>å…å¯†)</span><br><span class="line">user ALL=(ALL)   NOPASSWD:ALL</span><br><span class="line"><span class="built_in">chmod</span> 440 /etc/sudoers</span><br></pre></td></tr></table></figure><h2 id="æŒ‡å®šè´¦æˆ·è¿è¡Œ"><a href="#æŒ‡å®šè´¦æˆ·è¿è¡Œ" class="headerlink" title="æŒ‡å®šè´¦æˆ·è¿è¡Œ"></a>æŒ‡å®šè´¦æˆ·è¿è¡Œ</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">su - <span class="built_in">cat</span>(è´¦æˆ·åç§°) -c <span class="string">&quot;å…·ä½“å‘½ä»¤&quot;</span></span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>linuxå¸¸ç”¨å‘½ä»¤</title>
      <link href="/posts/fe4ef317.html"/>
      <url>/posts/fe4ef317.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ç³»ç»Ÿæ’æŸ¥"><a href="#ç³»ç»Ÿæ’æŸ¥" class="headerlink" title="ç³»ç»Ÿæ’æŸ¥"></a>ç³»ç»Ÿæ’æŸ¥</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç³»ç»Ÿèµ„æºç»Ÿè®¡</span></span><br><span class="line">dstat æ˜¯ä¸€ä¸ªå¯ä»¥å–ä»£vmstatï¼Œiostatï¼Œnetstatå’Œifstatè¿™äº›å‘½ä»¤çš„å¤šåŠŸèƒ½äº§å“</span><br><span class="line"><span class="comment"># IOç›‘æ§</span></span><br><span class="line">dstat -tclmnpydr --top-io</span><br><span class="line"><span class="comment"># CPUç›‘æ§</span></span><br><span class="line">dstat -tclmnpydr --top-cpu</span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç¡¬ç›˜é€Ÿåº¦ï¼Œç›‘æ§ç­‰</span></span><br><span class="line">dstat -tclmnpydr --top-io --top-bio</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å…¨éƒ¨å†…å­˜éƒ½æœ‰è°åœ¨å ç”¨</span></span><br><span class="line">dstat -g -l -m -s --top-mem</span><br><span class="line"><span class="comment"># æ˜¾ç¤ºä¸€äº›å…³äºCPUèµ„æºæŸè€—çš„æ•°æ®</span></span><br><span class="line">dstat -c -y -l --proc-count --top-cpu</span><br><span class="line"><span class="comment"># CPUå ç”¨å‰å</span></span><br><span class="line">ps aux|<span class="built_in">head</span> -1;ps aux|grep -v PID|<span class="built_in">sort</span> -rn -k +3|<span class="built_in">head</span></span><br><span class="line"><span class="comment"># å†…å­˜å ç”¨å‰å</span></span><br><span class="line">ps aux|<span class="built_in">head</span> -1;ps aux|grep -v PID|<span class="built_in">sort</span> -rn -k +4|<span class="built_in">head</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># mysql cpuè¿‡å¤§ï¼Œmysqlè´Ÿè½½è¿‡å¤§,mysql cpuå ç”¨é«˜ </span></span><br><span class="line">show processlist</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç‹¬ç«‹IPæ•°</span></span><br><span class="line">awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span> /var/log/nginx/access.log | <span class="built_in">sort</span> | <span class="built_in">uniq</span> -c | <span class="built_in">sort</span> -nr | <span class="built_in">wc</span> -l</span><br><span class="line"></span><br><span class="line"><span class="comment"># ipæŒ‡å®šèŒƒå›´å†…è®¿é—®æœ€å¤šå‰20 ï¼ˆ/data/logs/access.logè®¿é—®è®°å½•ï¼‰</span></span><br><span class="line">sed -n <span class="string">&#x27;/16:00:00/,/16:26:00/&#x27;</span>p /data/logs/access.log|awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>|<span class="built_in">sort</span>|<span class="built_in">uniq</span> -c|<span class="built_in">sort</span> -nr|<span class="built_in">head</span> -20</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ—¶é—´æ®µå†…ipæµé‡æ€»è®¡ï¼Œå„ipæµé‡æ€»è®¡ï¼š</span></span><br><span class="line">sed -n <span class="string">&#x27;/16:00:00/,/16:30:00/&#x27;</span>p /data/logs/access.log|awk <span class="string">&#x27;&#123;a[$1]+=$10&#125; END &#123;for(i in a)&#123;print i,a[i]&#125;&#125;&#x27;</span>|<span class="built_in">sort</span> -k 2 -nr &gt; /data/1.<span class="built_in">log</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åŒä¸€ä¸ª$3 ä¸åŒ$10å…±æœ‰å¤šå°‘æ•°é‡ï¼Œä¾‹ï¼šåŒä¸€ä¸ªuidä¸‹ä¸åŒipé‡ï¼Œå€’å™æ’åº</span></span><br><span class="line">awk <span class="string">&#x27;&#123;print $3,$10&#125;&#x27;</span> 20181109.<span class="built_in">log</span> |<span class="built_in">sort</span>|<span class="built_in">uniq</span>| awk <span class="string">&#x27;&#123;a[$2]+=1&#125; END &#123;for(i in a)&#123;print i,a[i]&#125;&#125;&#x27;</span>|<span class="built_in">sort</span>|<span class="built_in">uniq</span> -c|<span class="built_in">sort</span> -k3 -nr|<span class="built_in">head</span> -20</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¹æ®æœ€åä¸€ä¸ªå­—æ®µæŸ¥è¯¢ awk &#x27;$(NF)&#x27;è¡¨ç¤ºæœ€åä¸€ä¸ªå­—æ®µçš„å†…å®¹ $0è·å–æ•´è¡Œæ•°æ®</span></span><br><span class="line">sed -n <span class="string">&#x27;/17:00:00/,/17:21:00/&#x27;</span>p /data/logs/access.log|awk <span class="string">&#x27;$(NF)&gt;3 &#123;print $0&#125;&#x27;</span> &gt; /data/logs/1.<span class="built_in">log</span></span><br><span class="line"><span class="comment"># awkè·å–å€’æ•°ç¬¬äºŒä¸ªåŸŸ</span></span><br><span class="line">awk <span class="string">&#x27;&#123;NF - 1&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–è®¿é—®æœ€å¤šçš„url</span></span><br><span class="line">sed -n <span class="string">&#x27;/13:58:00/,/14:00:00/&#x27;</span>p /data/logs/nginx/access.log | grep -oE <span class="string">&quot;(GET|POST) .*&quot;</span>|awk <span class="string">&#x27;&#123;print $1,  $2&#125;&#x27;</span>|<span class="built_in">sort</span> |<span class="built_in">uniq</span> -c |<span class="built_in">sort</span> -nr |<span class="built_in">head</span> -n 50</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–è®¿é—®é¢‘ç‡æœ€é«˜çš„user-agent</span></span><br><span class="line">sed -n <span class="string">&#x27;/14:50:00/,/15:40:00/&#x27;</span>p /data/logs/nginx/access.log |awk -F <span class="string">&#x27;&quot;&#x27;</span> <span class="string">&#x27;&#123;print $4&#125;&#x27;</span>|<span class="built_in">sort</span> | <span class="built_in">uniq</span> -c | <span class="built_in">sort</span> -nr | <span class="built_in">head</span> -n 10</span><br><span class="line"></span><br><span class="line"><span class="comment"># crontabæ²¡æœ‰æ—¥å¿—,æ£€æŸ¥rsyslog</span></span><br><span class="line">service rsyslog status</span><br><span class="line">service rsyslog restart</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºåŒ¹é…è§„åˆ™çš„å†…å®¹</span></span><br><span class="line">grep -o</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‰ç…§æŒ‡å®šåˆ—è¿›è¡Œæ’åº</span></span><br><span class="line"><span class="built_in">sort</span> -t <span class="string">&#x27;åˆ†éš”ç¬¦&#x27;</span> k1(ä¸‹æ ‡ä½ç½®)</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
          <category> æ’æŸ¥ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¸¸ç”¨å‘½ä»¤ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linuxæ¡Œé¢ç¯å¢ƒå®‰è£…</title>
      <link href="/posts/8e1b0d90.html"/>
      <url>/posts/8e1b0d90.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>ä¸€ã€å®‰è£…æ¡Œé¢ç¯å¢ƒ<br>1.å®‰è£…MATE</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ yum <span class="built_in">groups</span> install <span class="string">&quot;MATE Desktop&quot;</span></span><br><span class="line"><span class="comment"># å®‰è£…X</span></span><br><span class="line">$ yum <span class="built_in">groups</span> install <span class="string">&quot;X Window System&quot;</span></span><br><span class="line"><span class="comment">#è‡ªåŠ¨è¿›å…¥å›¾å½¢ç•Œé¢</span></span><br><span class="line">$ systemctl set-default graphical.target</span><br><span class="line"><span class="comment"># åˆ›å»º .xinitrcæ–‡ä»¶, å¯ä»¥ä½¿ç”¨startXå¯åŠ¨å›¾å½¢ç•Œé¢</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;exec /usr/bin/mate-session&quot;</span> &gt;&gt; ~/.xinitrc</span><br></pre></td></tr></table></figure><p>äºŒã€ç¼–è¾‘å™¨æ— æ³•ä½¿ç”¨ä¸­æ–‡è¾“å…¥æ³•å¤„ç†æ–¹å¼</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> <span class="attribute">GTK_IM_MODULE</span>=fcitx</span><br><span class="line"><span class="built_in">export</span> <span class="attribute">QT_IM_MODULE</span>=fcitx</span><br><span class="line"><span class="built_in">export</span> <span class="attribute">XMODIFIERS</span>=@im=fcitx</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
          <category> æ—¥å¿— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¡Œé¢ç¯å¢ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œç›¸å…³å‘½ä»¤</title>
      <link href="/posts/287e4d04.html"/>
      <url>/posts/287e4d04.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="æŸ¥çœ‹æ­£åœ¨ä½¿ç”¨çš„ç½‘å¡"><a href="#æŸ¥çœ‹æ­£åœ¨ä½¿ç”¨çš„ç½‘å¡" class="headerlink" title="æŸ¥çœ‹æ­£åœ¨ä½¿ç”¨çš„ç½‘å¡"></a>æŸ¥çœ‹æ­£åœ¨ä½¿ç”¨çš„ç½‘å¡</h1><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">watch cat /proc/net/dev/</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤ºå‚æ•°è¯¦è§£</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">bytes: The total number of bytes of data transmitted or received by the interface.ï¼ˆæ¥å£å‘é€æˆ–æ¥æ”¶çš„æ•°æ®çš„æ€»å­—èŠ‚æ•°ï¼‰</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">packets: The total number of packets of data transmitted or received by the interface.ï¼ˆæ¥å£å‘é€æˆ–æ¥æ”¶çš„æ•°æ®åŒ…æ€»æ•°ï¼‰</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">errs: The total number of transmit or receive errors detected by the device driver.ï¼ˆç”±è®¾å¤‡é©±åŠ¨ç¨‹åºæ£€æµ‹åˆ°çš„å‘é€æˆ–æ¥æ”¶é”™è¯¯çš„æ€»æ•°ï¼‰</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">drop: The total number of packets dropped by the device driver.ï¼ˆè®¾å¤‡é©±åŠ¨ç¨‹åºä¸¢å¼ƒçš„æ•°æ®åŒ…æ€»æ•°ï¼‰</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">fifo: The number of FIFO buffer errors.ï¼ˆFIFOç¼“å†²åŒºé”™è¯¯çš„æ•°é‡ï¼‰</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">frame: The number of packet framing errors.ï¼ˆåˆ†ç»„å¸§é”™è¯¯çš„æ•°é‡ï¼‰</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">colls: The number of collisions detected on the interface.ï¼ˆæ¥å£ä¸Šæ£€æµ‹åˆ°çš„å†²çªæ•°ï¼‰</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">compressed: The number of compressed packets transmitted or received by the device driver. (This appears to be unused <span class="keyword">in</span> the 2.2.15 kernel.)ï¼ˆè®¾å¤‡é©±åŠ¨ç¨‹åºå‘é€æˆ–æ¥æ”¶çš„å‹ç¼©æ•°æ®åŒ…æ•°ï¼‰</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">carrier: The number of carrier losses detected by the device driver.ï¼ˆç”±è®¾å¤‡é©±åŠ¨ç¨‹åºæ£€æµ‹åˆ°çš„è½½æ³¢æŸè€—çš„æ•°é‡ï¼‰</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">multicast: The number of multicast frames transmitted or received by the device driver.ï¼ˆè®¾å¤‡é©±åŠ¨ç¨‹åºå‘é€æˆ–æ¥æ”¶çš„å¤šæ’­å¸§æ•°ï¼‰</span></span><br></pre></td></tr></table></figure><h1 id="ç½‘ç»œæƒ…å†µ"><a href="#ç½‘ç»œæƒ…å†µ" class="headerlink" title="ç½‘ç»œæƒ…å†µ"></a>ç½‘ç»œæƒ…å†µ</h1><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">iftop -i eth0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ˜¾ç¤ºå‚æ•°è¯¦è§£</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">TX: ä»ç½‘å¡å‘å‡ºçš„æµé‡</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">RX: ç½‘å¡æ¥å—æµé‡</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">TOTAL: ç½‘å¡å‘é€æ¥æ”¶æ€»é‡</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">cum: iftopå¼€å§‹è¿è¡Œåˆ°å½“å‰æ—¶é—´ç‚¹çš„æ€»æµé‡</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">peak: ç½‘å¡æµé‡å³°å€¼</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">rates: åˆ†åˆ«è¡¨ç¤º2sã€10sã€40sçš„å¹³å‡æµé‡</span></span><br></pre></td></tr></table></figure><h1 id="æŒ‰è¿›ç¨‹å®æ—¶ç»Ÿè®¡ç½‘ç»œå¸¦å®½åˆ©ç”¨ç‡"><a href="#æŒ‰è¿›ç¨‹å®æ—¶ç»Ÿè®¡ç½‘ç»œå¸¦å®½åˆ©ç”¨ç‡" class="headerlink" title="æŒ‰è¿›ç¨‹å®æ—¶ç»Ÿè®¡ç½‘ç»œå¸¦å®½åˆ©ç”¨ç‡"></a>æŒ‰è¿›ç¨‹å®æ—¶ç»Ÿè®¡ç½‘ç»œå¸¦å®½åˆ©ç”¨ç‡</h1><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">nethogs</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ¯äº”ç§’åˆ·æ–°</span></span><br><span class="line">nethogs -d 5</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŒ‡å®šeth0ç½‘å¡å’Œeth1</span></span><br><span class="line">nethogs eth0 eth1</span><br><span class="line"></span><br><span class="line">-d: delay for refresh rate.</span><br><span class="line">-h: display available commands usage.</span><br><span class="line">-p: sniff in promiscious mode (not recommended).</span><br><span class="line">-t: trace mode.</span><br><span class="line">-V: prints Version info.</span><br><span class="line"> </span><br><span class="line">äº¤äº’æ¨¡å¼</span><br><span class="line">åœ¨è¿›å…¥ nethogs ä¹‹å,å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„äº¤äº’å‘½ä»¤:</span><br><span class="line">m: ä¿®æ”¹ç½‘é€Ÿå•ä½</span><br><span class="line">r: æŒ‰ç…§æµé‡æ’åº</span><br><span class="line">s: æŒ‰ç…§å‘é€æµé‡æ’åº</span><br><span class="line">q: é€€å‡º</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
          <category> ç½‘ç»œ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œç›¸å…³å‘½ä»¤</title>
      <link href="/posts/287e4d04.html"/>
      <url>/posts/287e4d04.html</url>
      
        <content type="html"><![CDATA[<h1 id="netstat"><a href="#netstat" class="headerlink" title="netstat"></a>netstat</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç½‘ç»œè¿æ¥æƒ…å†µ(tcp)</span></span><br><span class="line">netstat -n(ä¸æ˜¾ç¤ºåˆ«å) -p(æ˜¾ç¤ºç›¸å…³çš„ç¨‹åº) -t(tcp)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç½‘ç»œè¿æ¥æ•°ç»Ÿè®¡(tcp)</span></span><br><span class="line">netstat -nat|awk <span class="string">&#x27;&#123;print awk $NF&#125;&#x27;</span>|<span class="built_in">sort</span>|<span class="built_in">uniq</span> -c|<span class="built_in">sort</span> -n <span class="comment">#æŸ¥çœ‹tcpè¿æ¥æ•°</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
          <category> ç½‘ç»œ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>è®°å½•</title>
      <link href="/posts/e797f254.html"/>
      <url>/posts/e797f254.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">linuxç™»å½•åå‡ºç°-bash-4.1$</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é¦–å…ˆåˆ‡æ¢åˆ°æ•…éšœç”¨æˆ·</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">su - <span class="built_in">test</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¤åˆ¶å¯¹åº”çš„æ–‡ä»¶ï¼ˆä¸è¦ç”¨rootç›´æ¥å¤åˆ¶ï¼Œå¦åˆ™å¤åˆ¶è¿‡å»çš„ä¸œè¥¿å±ä¸»ï¼Œæ•°ç»„éƒ½æ˜¯rootçš„ï¼‰</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cp</span> /etc/skel/.bash*  ~  <span class="comment">##(/etc/skel æ–°ç”¨æˆ·è€å®¶çš„æ ·å­ï¼Œæ‰€ä»¥ä»è¿™é‡Œå¤åˆ¶)</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ã€€å¸è½½</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">rpm -eå’Œyum remove</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¸è½½è½¯ä»¶ä¸å¸è½½ä¾èµ–</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">rpm -e --nodeps</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹è¿›è¡Œè¿è¡Œåœ¨å“ªä¸ªcpuï¼Œè¿›å…¥topåæŒ‰fåæŒ‰jé€‰ä¸­ last cpu used</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">top -p pid</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">top æ ¹æ®è¿›ç¨‹åç§°</span> </span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">top -p `pgrep python | <span class="built_in">tr</span> <span class="string">&quot;\\n&quot;</span> <span class="string">&quot;,&quot;</span> | sed <span class="string">&#x27;s/,$//&#x27;</span>`</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">pgrepæ˜¯é€šè¿‡ç¨‹åºçš„åå­—æ¥æŸ¥è¯¢è¿›ç¨‹çš„å·¥å…·</span></span><br><span class="line">-l åˆ—å‡ºç¨‹åºåå’Œè¿›ç¨‹IDï¼›</span><br><span class="line">-o è¿›ç¨‹èµ·å§‹çš„IDï¼›</span><br><span class="line">-n è¿›ç¨‹ç»ˆæ­¢çš„IDï¼›</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">xargs <span class="built_in">mv</span>åˆç”¨</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-t æ‰“å°å‡ºå‘½ä»¤åæ‰§è¡Œ</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-p éœ€è¦ç¡®å®šåæ‰æ‰§è¡Œ</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-I å°†ä¸€è¡Œè¡Œèµ‹å€¼ç»™&#123;&#125;</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">xargs -t -p -I &#123;&#125; <span class="built_in">mv</span> &#123;&#125; /data/logs/tmpimg/maitiansell/</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">findå’Œxargsåˆç”¨</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥æ‰¾å½“å‰ç›®å½•ä¸‹æ–‡ä»¶åç§°ä¸ç¬¦åˆ*gzè§„åˆ™ï¼Œå¹¶ä¸”ä¿®æ”¹æ—¶é—´7å¤©å‰ï¼Œæ‰“å°å®Œæ•´æ–‡ä»¶ç›®å½•ï¼Œæäº¤ç»™xargsè¿›è¡Œåˆ é™¤ -v:æ˜¾ç¤ºè¯¦ç»†æ­¥éª¤</span></span><br><span class="line">find . -type f -not-name &#x27;*gz&#x27; -ctime +7 -print0 | xargs -0  -I &#123;&#125; rm -v &#123;&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä»æ¯è¡Œå¼€å¤´å¼€å§‹ç¬¬10ä¸ªå­—èŠ‚å¼€å§‹è¾“å‡º</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">tail</span> -c +10 x.log</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹æ–‡ä»¶æœ€å10ä¸ªå­—èŠ‚</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">tail</span> -c 10 x.log</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥æ‰¾ç›®å½•ä¸‹çš„æ–‡ä»¶å¹¶ä¸”èµ‹å€¼æƒé™</span></span><br><span class="line">chomd 755 `find img/ -type d`</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥æ‰¾ç›®å½•ä¸‹çš„æ–‡ä»¶</span></span><br><span class="line">find img/ -type f</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ— æ³•æ˜¾ç¤ºä¸­æ–‡å¤„ç†</span></span><br><span class="line">export LANG C.UTF-8</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> linux </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>nginxé…ç½®æ–‡ä»¶</title>
      <link href="/posts/d271472.html"/>
      <url>/posts/d271472.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä½œä¸ºå®ˆæŠ¤è¿›ç¨‹è¿è¡Œ Nginx</span></span><br><span class="line"><span class="comment">#daemon on;</span></span><br><span class="line">user www www;</span><br><span class="line"><span class="comment">#å·¥ä½œè¿›ç¨‹æ•°</span></span><br><span class="line">worker_processes 12;</span><br><span class="line"><span class="comment">#ä¿å­˜è¿›ç¨‹idå·</span></span><br><span class="line">pid logs/nginx.pid;</span><br><span class="line"><span class="comment">#åŠ å¤§ Nginx æ‰€èƒ½æ“ä½œçš„æ–‡ä»¶å¥æŸ„æ•°</span></span><br><span class="line">worker_rlimit_nofile 65535;</span><br><span class="line">events &#123;</span><br><span class="line">    <span class="comment"># ä¸€èˆ¬æ˜¯é…ç½®nginxè¿æ¥çš„ç‰¹æ€§ï¼Œå¦‚1ä¸ªwordèƒ½åŒæ—¶å…è®¸å¤šå°‘è¿æ¥</span></span><br><span class="line">    <span class="comment"># ä½¿ç”¨epollçš„I/O æ¨¡å‹ã€‚linuxå»ºè®®epollï¼ŒFreeBSDå»ºè®®é‡‡ç”¨kqueueï¼Œwindowä¸‹ä¸æŒ‡å®šã€‚</span></span><br><span class="line">    use epoll;</span><br><span class="line">    <span class="comment">#æ¯çº¿ç¨‹æœ€å¤šå¯æ¥å—çš„è¿æ¥æ•°ï¼Œworker_processes * worker_connections</span></span><br><span class="line">    worker_connections 65535;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include mime.types;</span><br><span class="line">    default_type application/octet-stream;</span><br><span class="line">    <span class="comment">#charset gb2312;</span></span><br><span class="line">    <span class="comment"># å¼€å¯é‡å†™æ—¥å¿—</span></span><br><span class="line">    <span class="comment">#rewrite_log on;</span></span><br><span class="line">    <span class="comment"># éšè—ç‰ˆæœ¬å·,å› ä¸ºå¦‚æœè®¾ç½®äº†è¯¥å‘½ä»¤ï¼ŒæœåŠ¡å™¨åç§°å°±å›ºå®šäº†</span></span><br><span class="line">    server_tokens off;</span><br><span class="line">    <span class="comment">#ç³»ç»Ÿé”™è¯¯æ—¥å¿—</span></span><br><span class="line">    error_log /data/logs/nginx_error.log  crit;</span><br><span class="line">    server_names_hash_bucket_size 128;</span><br><span class="line">    <span class="comment"># å®¢æˆ·ç«¯è¯·æ±‚å¤´éƒ¨çš„ç¼“å†²åŒºå¤§å°ã€‚è¿™ä¸ªå¯ä»¥æ ¹æ®ä½ çš„ç³»ç»Ÿåˆ†é¡µå¤§å°æ¥è®¾ç½®ï¼Œä¸€èˆ¬ä¸€ä¸ªè¯·æ±‚çš„å¤´éƒ¨å¤§å°ä¸ä¼šè¶…è¿‡1kï¼Œä¸è¿‡ç”±äºä¸€èˆ¬ç³»ç»Ÿåˆ†é¡µéƒ½è¦å¤§äº1kï¼Œ</span></span><br><span class="line">    <span class="comment"># æ‰€ä»¥è¿™é‡Œè®¾ç½®ä¸ºåˆ†é¡µå¤§å°ã€‚åˆ†é¡µå¤§å°å¯ä»¥ç”¨å‘½ä»¤getconf PAGESIZEå–å¾—ã€‚</span></span><br><span class="line">    client_header_buffer_size 32k;</span><br><span class="line">    <span class="comment"># å®¢æˆ·è¯·æ±‚å¤´ç¼“å†²å¤§å°ã€‚nginxé»˜è®¤ä¼šç”¨client_header_buffer_sizeè¿™ä¸ªbufferæ¥è¯»å–headerå€¼ï¼Œå¦‚æœ</span></span><br><span class="line">    <span class="comment"># headerè¿‡å¤§ï¼Œå®ƒä¼šä½¿ç”¨large_client_header_buffersæ¥è¯»å–ã€‚</span></span><br><span class="line">    large_client_header_buffers 4 32k;</span><br><span class="line">    <span class="comment"># è®¾å®šé€šè¿‡nginxä¸Šä¼ æ–‡ä»¶çš„å¤§å°</span></span><br><span class="line">    client_max_body_size 8m;</span><br><span class="line">    <span class="comment"># sendfile: è®¾ç½®ä¸ºonè¡¨ç¤ºå¯åŠ¨é«˜æ•ˆä¼ è¾“æ–‡ä»¶çš„æ¨¡å¼ã€‚</span></span><br><span class="line">    <span class="comment"># sendfileå¯ä»¥è®©Nginxåœ¨ä¼ è¾“æ–‡ä»¶æ—¶ç›´æ¥åœ¨ç£ç›˜å’Œtcp socketä¹‹é—´ä¼ è¾“æ•°æ®ã€‚</span></span><br><span class="line">    <span class="comment"># å¦‚æœè¿™ä¸ªå‚æ•°ä¸å¼€å¯ï¼Œä¼šå…ˆåœ¨ç”¨æˆ·ç©ºé—´ï¼ˆNginxè¿›ç¨‹ç©ºé—´ï¼‰ç”³è¯·ä¸€ä¸ªbufferï¼Œç”¨readå‡½æ•°æŠŠæ•°æ®ä»ç£ç›˜è¯»åˆ°cacheï¼Œå†ä»cacheè¯»å–åˆ°ç”¨æˆ·ç©ºé—´çš„bufferï¼Œ</span></span><br><span class="line">    <span class="comment"># å†ç”¨writeå‡½æ•°æŠŠæ•°æ®ä»ç”¨æˆ·ç©ºé—´çš„bufferå†™å…¥åˆ°å†…æ ¸çš„bufferï¼Œæœ€ååˆ°tcp socketã€‚å¼€å¯è¿™ä¸ªå‚æ•°åå¯ä»¥è®©æ•°æ®ä¸ç”¨ç»è¿‡ç”¨æˆ·buffer</span></span><br><span class="line">    sendfile on;</span><br><span class="line">    <span class="comment">#Linux å†…æ ¸ tcp_nopush TCP å‡½æ•°è°ƒç”¨ï¼Œå…³é—­ï¼›</span></span><br><span class="line">    <span class="comment"># æ­¤é€‰é¡¹å…è®¸æˆ–ç¦æ­¢ä½¿ç”¨sockeçš„TCP_CORKçš„é€‰é¡¹ï¼Œæ­¤é€‰é¡¹ä»…åœ¨ä½¿ç”¨sendfileçš„æ—¶å€™ä½¿ç”¨</span></span><br><span class="line">    tcp_nopush on;</span><br><span class="line">    <span class="comment">#Linux &amp; FreeBSD å†…æ ¸ TCP å‡½æ•°è°ƒç”¨ï¼Œå¼€å¯ï¼›</span></span><br><span class="line">    tcp_nodelay on;</span><br><span class="line">    <span class="comment">#æ¯ä¸ªé“¾æ¥ä¿å­˜çš„æ—¶é•¿(å•ä½ï¼šç§’)</span></span><br><span class="line">    keepalive_timeout 60;</span><br><span class="line">    fastcgi_connect_timeout 300;</span><br><span class="line">    fastcgi_send_timeout 300;</span><br><span class="line">    fastcgi_read_timeout 300;</span><br><span class="line">    fastcgi_buffer_size 64k;</span><br><span class="line">    fastcgi_buffers 4 64k;</span><br><span class="line">    <span class="comment"># é»˜è®¤å€¼æ˜¯fastcgi_bufferçš„2å€</span></span><br><span class="line">    fastcgi_busy_buffers_size 128k;</span><br><span class="line">    <span class="comment"># å†™å…¥ç¼“å­˜æ–‡ä»¶ä½¿ç”¨å¤šå¤§çš„æ•°æ®å—ï¼Œé»˜è®¤å€¼æ˜¯fastcgi_bufferçš„2å€</span></span><br><span class="line">    fastcgi_temp_file_write_size 128k;</span><br><span class="line">    gzip on;</span><br><span class="line">    gzip_min_length 1k;</span><br><span class="line">    gzip_buffers 4 16k;</span><br><span class="line">    gzip_http_version 1.0;</span><br><span class="line">    gzip_comp_level 2;</span><br><span class="line">    <span class="comment">#gzip_types text/plain text/css application/xml text/javascript;#application/x-javascript;</span></span><br><span class="line">    gzip_types text/plain text/css application/json application/x-javascript application/javascript image/jpeg image/gif image/png text/xml application/xml application/xml+rss text/javascript;</span><br><span class="line"></span><br><span class="line">    gzip_vary on;</span><br><span class="line"></span><br><span class="line">    geo <span class="variable">$whiteiplist</span>  &#123;</span><br><span class="line">        default 1;</span><br><span class="line">        <span class="comment">#127.0.0.1 0;</span></span><br><span class="line">    &#125;</span><br><span class="line">    map <span class="variable">$whiteiplist</span>  <span class="variable">$limit</span> &#123;</span><br><span class="line">        <span class="comment"># é€šè¿‡remote_addrè¿™ä¸ªæ ‡è¯†æ¥åšé™åˆ¶ï¼Œâ€œbinary_â€çš„ç›®çš„æ˜¯ç¼©å†™å†…å­˜å ç”¨é‡ï¼Œæ˜¯é™åˆ¶åŒä¸€å®¢æˆ·ç«¯ipåœ°å€</span></span><br><span class="line">        1 <span class="variable">$binary_remote_addr</span>;</span><br><span class="line">        0 <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"># zone=allips:128mè¡¨ç¤ºç”Ÿæˆä¸€ä¸ªå¤§å°ä¸º10Mï¼Œåå­—ä¸ºoneçš„å†…å­˜åŒºåŸŸï¼Œç”¨æ¥å­˜å‚¨è®¿é—®çš„é¢‘æ¬¡ä¿¡æ¯</span></span><br><span class="line">    <span class="comment"># rate=50r/sè¡¨ç¤ºå…è®¸ç›¸åŒæ ‡è¯†çš„å®¢æˆ·ç«¯çš„è®¿é—®é¢‘æ¬¡ï¼Œè¿™é‡Œé™åˆ¶çš„æ˜¯æ¯ç§’50æ¬¡ï¼Œè¿˜å¯ä»¥æœ‰æ¯”å¦‚30r/mçš„</span></span><br><span class="line">    limit_req_zone <span class="variable">$limit</span> zone=allips:128m rate=50r/s;</span><br><span class="line">        log_format access <span class="string">&#x27;$remote_addr - $remote_user [$time_local] $request &#x27;</span></span><br><span class="line">                    <span class="string">&#x27;&quot;$status&quot; $body_bytes_sent &quot;$http_referer&quot; &#x27;</span></span><br><span class="line">                    <span class="string">&#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;</span>;</span><br><span class="line">    server&#123;</span><br><span class="line">        listen      80;</span><br><span class="line">        server_name cat.io;</span><br><span class="line">        <span class="built_in">set</span> <span class="variable">$demain</span> <span class="string">&quot;www.&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> ( <span class="variable">$http_user_agent</span> ~* <span class="string">&quot;(Mobile|Android|iPhone|Windows Phone|UC|Kindle|SAMSUNG|SonyEricsson|Opera Mini|LG|MOT|BlackBerry|HTC|Nokia|J2ME)&quot;</span> )&#123;</span><br><span class="line">                <span class="built_in">set</span> <span class="variable">$demain</span> <span class="string">&quot;m.&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        rewrite ^/(.*)$ http://<span class="variable">$&#123;demain&#125;</span>cat.io/<span class="variable">$1</span> permanent;</span><br><span class="line">        access_log off;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  localhost;</span><br><span class="line"></span><br><span class="line">        <span class="comment">#charset koi8-r;</span></span><br><span class="line"></span><br><span class="line">        root   /data/html/public;</span><br><span class="line">        index  index.html index.htm;</span><br><span class="line">        access_log  /data/logs/hexo.access.log  access;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( <span class="variable">$http_user_agent</span> ~* <span class="string">&quot;(wordPress|PHP|java\/|curl|scan|bot|Go-http)&quot;</span> )&#123;</span><br><span class="line">             <span class="built_in">return</span> 404;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ( <span class="variable">$http_user_agent</span> = <span class="string">&quot;&quot;</span> )&#123;</span><br><span class="line">             <span class="built_in">return</span> 404;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"># ç¦æ­¢GETå¤–çš„è¯·æ±‚</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$request_method</span> !~* GET)&#123;</span><br><span class="line">            <span class="built_in">return</span> 404;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"># ç¦æ­¢è®¿é—®æŒ‡å®šçš„åç¼€url</span></span><br><span class="line">        <span class="keyword">if</span> ( <span class="variable">$uri</span> ~* \.(php|java|asp|net|txt|<span class="built_in">log</span>)$)&#123;</span><br><span class="line">            <span class="built_in">return</span> 404;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"># ç¦æ­¢åŒ…å«function exce shå­—ç¬¦ä¸²(ç›®å‰åº”è¯¥æ˜¯thinkphpæ¼æ´æ³¨å…¥ç›¸å…³)</span></span><br><span class="line">        <span class="keyword">if</span> ( <span class="variable">$uri</span> ~* \[<span class="keyword">function</span>|<span class="built_in">exec</span>|mstshash|cookie]$ )&#123;</span><br><span class="line">            <span class="built_in">return</span> 404;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ( <span class="variable">$uri</span> ~* sh[^A-Za-z]+ )&#123;</span><br><span class="line">            <span class="built_in">return</span> 403;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        error_page  301              /404.html;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># redirect server error pages to the static page /50x.html</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        error_page   500 502 503 504  /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">            root   /data/html;</span><br><span class="line">        &#125;</span><br><span class="line">        location ~ /\.php &#123;</span><br><span class="line">            deny  all;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é…ç½®æ–‡ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nginxè®°å½•</title>
      <link href="/posts/e66d5b16.html"/>
      <url>/posts/e66d5b16.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h2 id="sub-m-cat-net-301é‡å®šå‘åˆ°-m-cat-net-sub"><a href="#sub-m-cat-net-301é‡å®šå‘åˆ°-m-cat-net-sub" class="headerlink" title="sub.m.cat.net 301é‡å®šå‘åˆ° m.cat.net&#x2F;sub&#x2F;"></a>sub.m.cat.net 301é‡å®šå‘åˆ° m.cat.net&#x2F;sub&#x2F;</h2><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( <span class="variable">$host</span> ~* (.*)\.m\.cat\.net ) &#123;</span><br><span class="line">    set <span class="variable">$sub_domain</span> <span class="variable">$1</span>;</span><br><span class="line">    rewrite <span class="string">&quot;^(.*)$&quot;</span>  <span class="variable">$scheme</span><span class="symbol">://m</span>.cat.net/<span class="variable">$sub</span>_domain<span class="variable">$1</span> permanent;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="nginxå’Œphpåˆ†ç¦»å¼éƒ¨ç½²"><a href="#nginxå’Œphpåˆ†ç¦»å¼éƒ¨ç½²" class="headerlink" title="nginxå’Œphpåˆ†ç¦»å¼éƒ¨ç½²"></a>nginxå’Œphpåˆ†ç¦»å¼éƒ¨ç½²</h2><h3 id="1-nginxé…ç½®"><a href="#1-nginxé…ç½®" class="headerlink" title="1.nginxé…ç½®"></a>1.nginxé…ç½®</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># å®šä¹‰upsreamæ¨¡å—ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å†™æ­»fastcgi_pass</span><br><span class="line">upstream myfastcgi&#123;</span><br><span class="line">    server 192.168.1.213:9000 weight=2 max_fails=1 fail_timeout=5s;</span><br><span class="line">    server 192.168.1.211:9000 weight=1 max_fails=1 fail_timeout=5s;</span><br><span class="line">&#125;</span><br><span class="line">server&#123;</span><br><span class="line">    listen      80;</span><br><span class="line">    server_name thisofcat.cat;</span><br><span class="line">    location /  &#123;</span><br><span class="line">        fastcgi_pass   myfastcgi;</span><br><span class="line">        fastcgi_index  index.php;</span><br><span class="line">        fastcgi_param  SCRIPT_FILENAME  /data/http/cs$fastcgi_script_name;</span><br><span class="line">        include        fastcgi_params;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> nginx </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>mysqlCMarkå®‰è£…</title>
      <link href="/posts/de5ef85f.html"/>
      <url>/posts/de5ef85f.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p><a href="https://www.linuxidc.com/Linux/2016-11/137645.htm">https://www.linuxidc.com/Linux/2016-11/137645.htm</a></p><h1 id="ä¸€ã€yumå®‰è£…ç›¸å…³ä¾èµ–"><a href="#ä¸€ã€yumå®‰è£…ç›¸å…³ä¾èµ–" class="headerlink" title="ä¸€ã€yumå®‰è£…ç›¸å…³ä¾èµ–"></a>ä¸€ã€yumå®‰è£…ç›¸å…³ä¾èµ–</h1><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gcc gcc-c++ gcc-g77 <span class="built_in">auto</span>conf <span class="built_in">auto</span>make zlib* fiex* libxml* ncurses-devel libmcrypt* libtool-ltdl-devel* \ </span><br><span class="line">make cmake bison git openssl openssl-devel</span><br></pre></td></tr></table></figure><h1 id="äºŒã€ç¼–è¯‘å®‰è£…"><a href="#äºŒã€ç¼–è¯‘å®‰è£…" class="headerlink" title="äºŒã€ç¼–è¯‘å®‰è£…"></a>äºŒã€ç¼–è¯‘å®‰è£…</h1><p>æ·»åŠ ç”¨æˆ·</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">groupadd mysql</span><br><span class="line">useradd -<span class="attribute">r</span> -<span class="selector-tag">g</span> mysql mysql</span><br></pre></td></tr></table></figure><p>2.ç¼–è¯‘å®‰è£…</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">curl</span> https://cdn.mysql.com//Downloads/MySQL-<span class="number">5</span>.<span class="number">6</span>/mysql-<span class="number">5</span>.<span class="number">6</span>.<span class="number">45</span>-linux-glibc2.<span class="number">12</span>-x86_64.tar.gz</span><br><span class="line"><span class="attribute">tar</span> xf mysql-<span class="number">5</span>.<span class="number">6</span>.<span class="number">34</span>.tar.gz</span><br><span class="line"><span class="attribute">cd</span> mysql-<span class="number">5</span>.<span class="number">6</span>.<span class="number">34</span></span><br></pre></td></tr></table></figure><p> é»˜è®¤æƒ…å†µä¸‹æ˜¯å®‰è£…åœ¨&#x2F;usr&#x2F;local&#x2F;webserver&#x2F;mysql<br> cmakeç¼–è¯‘å‚æ•°å¯ä»¥è‡ªå·±è°ƒæ•´</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cmake . <span class="attribute">-DCMAKE_INSTALL_PREFIX</span>=/usr/local/webserver/mysql <span class="attribute">-DMYSQL_DATADIR</span>=/data/mysqlData <span class="attribute">-DSYSCONFDIR</span>=/etc \ </span><br><span class="line"><span class="attribute">-DWITH_INNOBASE_STORAGE_ENGINE</span>=1 <span class="attribute">-DWITH_MYISAM_STORAGE_ENGINE</span>=1 <span class="attribute">-DWITH_ARCHIVE_STORAGE_ENGINE</span>=1 \</span><br><span class="line"><span class="attribute">-DWITH_PARTITION_STORAGE_ENGINE</span>=1 <span class="attribute">-DWITH_BLACKHOLE_STORAGE_ENGINE</span>=1 <span class="attribute">-DWITH_READLINE</span>=1 <span class="attribute">-DWITH_SSL</span>=system \</span><br><span class="line"><span class="attribute">-DWITH_ZLIB</span>=system <span class="attribute">-DMYSQL_UNIX_ADDR</span>=/tmp/mysql.sock <span class="attribute">-DMYSQL_TCP_PORT</span>=3306 <span class="attribute">-DENABLED_LOCAL_INFILE</span>=1 \</span><br><span class="line"><span class="attribute">-DEXTRA_CHARSETS</span>=all <span class="attribute">-DDEFAULT_CHARSET</span>=utf8 <span class="attribute">-DWITH_LIBWRAP</span>=0 <span class="attribute">-DDEFAULT_COLLATION</span>=utf8_general_ci \</span><br><span class="line"><span class="attribute">-DWITH_BOOST</span>=/home/cat/installData/mysql/mysql-8.0.11/boost (æœ€åä¸€å¥ä¸ºmysql8æ‰éœ€è¦ä½¿ç”¨)</span><br></pre></td></tr></table></figure><p>cmakeç¼–è¯‘æŠ¥é”™éœ€è¦åˆ é™¤ç¼–è¯‘ç¼“å­˜ï¼Œä¿®å¤é”™è¯¯åå†æ¬¡é‡æ–°ç¼–è¯‘</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rm</span> <span class="operator">-f</span> CMakeCache.txt</span><br></pre></td></tr></table></figure><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">make</span> &amp;&amp; <span class="built_in">make</span> install</span><br></pre></td></tr></table></figure><p>æ³¨æ„äº‹é¡¹ï¼š<br>é‡æ–°ç¼–è¯‘æ—¶ï¼Œéœ€è¦æ¸…é™¤æ—§çš„å¯¹è±¡æ–‡ä»¶å’Œç¼“å­˜ä¿¡æ¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">make clean</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">rm</span> -f CMakeCache.txt</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">rm</span> -rf /etc/my.cnf</span></span><br></pre></td></tr></table></figure><p>4.æ”¹å˜æ•°æ®å­˜å‚¨ç›®å½•æ‰€æœ‰è€…ä¸ºmysql</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chown</span> -R mysql.mysql /usr/local/webserver/mysql</span><br><span class="line"><span class="built_in">chown</span> -R mysql.mysql /data/mysqlData</span><br></pre></td></tr></table></figure><p>5.å¯åŠ¨è„šæœ¬åˆå§‹åŒ–æ•°æ®åº“</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/webserver/mysql</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">scripts/mysql_install_db --user=mysql --basedir=/usr/local/webserver/mysql --datadir=/data/mysqlData</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mysql8</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">bin/mysqld --initialize --user=mysql --datadir=/data/mysqlData/</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">bin/mysql_ssl_rsa_setup</span></span><br><span class="line"></span><br><span class="line">D38j.)H_yU3J</span><br></pre></td></tr></table></figure><p>6.æ³¨å†ŒæœåŠ¡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> support-files/mysql.server /etc/rc.d/init.d/mysqld</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨é»˜è®¤é…ç½®æ–‡ä»¶</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cp</span> support-<span class="keyword">files</span>/my-default.<span class="keyword">cnf</span> /etc/my.<span class="keyword">cnf</span></span><br></pre></td></tr></table></figure><p>è®©chkconfigç®¡ç†mysqlæœåŠ¡</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkconfig --<span class="built_in">add</span> mysqld</span><br></pre></td></tr></table></figure><p>å¼€æœºå¯åŠ¨</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">chkconfig</span> mysqld <span class="literal">on</span></span><br></pre></td></tr></table></figure><p>ç¼–è¾‘&#x2F;etc&#x2F;my.cnfé…ç½®ï¼ŒåŠ å…¥ä»¥ä¸‹å†…å®¹</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">innodb_file_per_table</span> = <span class="number">1</span></span><br><span class="line"><span class="attr">datadir</span> = /data/mysqlData</span><br><span class="line"><span class="attr">log-bin</span>=/data/binlogs/mysql-bin</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼š<br>ç»è¿‡å®é™…æµ‹è¯•innodb_file_per_table &#x3D; ONè¿™æ¡å‚æ•°éœ€è¦innodb_file_per_table &#x3D; 1 æ‰èƒ½ç”Ÿæ•ˆï¼Œå…·ä½“å¯ä»¥é€šè¿‡</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show <span class="keyword">variables</span> like <span class="comment">&#x27;%per_table%&#x27;</span>;æ¥æŸ¥è¯¢</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> /data/binlogs</span><br><span class="line"><span class="built_in">chown</span> -R mysql.mysql /data/binlogs</span><br></pre></td></tr></table></figure><p>8.å°†mysqlå‘½ä»¤åŠ å…¥ç¯å¢ƒå˜é‡ä¸­</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim <span class="regexp">/etc/</span>profile.d/mysql.sh</span><br><span class="line">åŠ å…¥</span><br><span class="line">export PATH=<span class="regexp">/usr/</span>local<span class="regexp">/webserver/my</span>sql/bin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure><p>é»˜è®¤å¯†ç ä¸ºç©º</p><p>9ä¿®æ”¹&#x2F;etc&#x2F;security&#x2F;limits.confï¼Œç„¶ååŠ å…¥ä»¥ä¸‹å†…å®¹ï¼Œé€€å‡ºå†é‡æ–°ç™»é™†å³å¯(ä¸éœ€è¦é‡å¯ï¼Œé€€å‡ºå½“å‰çš„è¿æ¥shellå³å¯)</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># ulimit -n æŸ¥çœ‹å‚æ•°æ˜¯å¦ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="bullet">*</span> hard nofile 655350</span><br><span class="line"><span class="bullet">*</span> soft nofile 655350</span><br></pre></td></tr></table></figure><p>å¦åˆ™æŠ¥é”™å¦‚ä¸‹ï¼š<br>é”™è¯¯#23: Out of resources when opening file â€˜.&#x2F;XX&#x2F;USER.MYDâ€™ (Errcode: 24)</p><p>10ä¿®æ”¹å¯†ç </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">å‘½ä»¤:<span class="keyword">SET</span> <span class="keyword">PASSWORD</span> <span class="keyword">FOR</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;host&#x27;</span> = <span class="keyword">PASSWORD</span>(<span class="string">&#x27;newpassword&#x27;</span>);</span><br><span class="line">å¦‚æœæ˜¯å½“å‰ç™»é™†ç”¨æˆ·ç”¨<span class="keyword">SET</span> <span class="keyword">PASSWORD</span> = <span class="keyword">PASSWORD</span>(&quot;newpassword&quot;); </span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> mysql.<span class="keyword">user</span> <span class="keyword">set</span> <span class="keyword">password</span>=<span class="keyword">password</span>(<span class="string">&#x27;zxc406520&#x27;</span>) <span class="keyword">where</span> <span class="keyword">User</span>=<span class="string">&#x27;root&#x27;</span> <span class="keyword">and</span> Host=<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line">mysql8</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED <span class="keyword">WITH</span> mysql_native_password <span class="keyword">BY</span> <span class="string">&#x27;ä½ çš„å¯†ç &#x27;</span>; </span><br><span class="line">flush <span class="keyword">privileges</span>;</span><br></pre></td></tr></table></figure><p>æ–°å»ºå¸å·</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;host&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;password&#x27;</span>; </span><br><span class="line">æˆæƒ</span><br><span class="line">å‘½ä»¤:<span class="keyword">GRANT</span> <span class="keyword">privileges</span> <span class="keyword">ON</span> databasename.tablename <span class="keyword">TO</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;host&#x27;</span></span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> <span class="keyword">ON</span> *.* <span class="keyword">TO</span> <span class="string">&#x27;cat&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line">æ³¨æ„:ç”¨ä»¥ä¸Šå‘½ä»¤æˆæƒçš„ç”¨æˆ·ä¸èƒ½ç»™å…¶å®ƒç”¨æˆ·æˆæƒ,å¦‚æœæƒ³è®©è¯¥ç”¨æˆ·å¯ä»¥æˆæƒ,ç”¨ä»¥ä¸‹å‘½ä»¤:</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">privileges</span> <span class="keyword">ON</span> databasename.tablename <span class="keyword">TO</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;host&#x27;</span> <span class="keyword">WITH</span> <span class="keyword">GRANT</span> <span class="keyword">OPTION</span>;</span><br><span class="line">æ’¤é”€æƒé™</span><br><span class="line">å‘½ä»¤: <span class="keyword">REVOKE</span> privilege <span class="keyword">ON</span> databasename.tablename <span class="keyword">FROM</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;host&#x27;</span>;</span><br><span class="line">åˆ é™¤ç”¨æˆ·</span><br><span class="line">å‘½ä»¤: <span class="keyword">DROP</span> <span class="keyword">USER</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;host&#x27;</span>;</span><br></pre></td></tr></table></figure><p>10.é”™è¯¯æç¤º<br>The server requested authentication method unknown to the client [caching_sha2_password]</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql8æ–°ç‰¹æ€§,éœ€è¦åœ¨my.cnfä¸­æ–°å¢</span><br><span class="line"><span class="attribute">default_authentication_plugin</span>=mysql_native_password</span><br></pre></td></tr></table></figure><h1 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/usr/</span>local<span class="regexp">/webserver/my</span>sql<span class="regexp">/support-files/my</span>sql.server start</span><br></pre></td></tr></table></figure><h1 id="é‡å¯"><a href="#é‡å¯" class="headerlink" title="é‡å¯"></a>é‡å¯</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> -USR2 `<span class="built_in">cat</span> /data/mysqlData/mysql.pid`</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> mysql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰è£…æ–‡æ¡£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysqlå®‰è£…æ–‡æ¡£</title>
      <link href="/posts/f3f78fd4.html"/>
      <url>/posts/f3f78fd4.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#groupadd mysql æ·»åŠ ç”¨æˆ·ç»„</span></span><br><span class="line"><span class="comment">#useradd -r -g mysql mysql æ·»åŠ ç”¨æˆ·</span></span><br><span class="line"><span class="comment">#mkdir -p /usr/local/webserver/mysql åˆ›å»ºå®‰è£…ç›®å½•</span></span><br><span class="line"><span class="comment">#mkdir -p /data/mysql/data åˆ›å»ºæ•°æ®åº“ç›®å½•</span></span><br><span class="line"><span class="comment"># chown mysql:mysql /data/mysql/ #ç›®å½•æƒé™ä¿®æ”¹</span></span><br><span class="line"><span class="comment">#tar -zxvf mysql-5.6.10-linux-glibc2.5-x86_64.tar.gz </span></span><br><span class="line"><span class="comment">#mv mysql-5.6.10-linux-glibc2.5-x86_64/* /usr/local/webserver/mysql</span></span><br><span class="line"><span class="comment">#rm -rf ./mysql-5.6.10-linux-glibc2.5-x86_64/</span></span><br><span class="line"><span class="comment">#cd /usr/local/webserver/</span></span><br><span class="line"><span class="comment">#ln -s full-path-to-mysql-VERSION-OS mysql</span></span><br><span class="line"><span class="comment">#cd mysql</span></span><br><span class="line">chown -R mysql .</span><br><span class="line">chgrp -R mysql .</span><br><span class="line">./scripts/mysql_install_db <span class="attribute">--user</span>=mysql <span class="attribute">--basedir</span>=/usr/local/webserver/mysql <span class="attribute">--datadir</span>=/data/mysql/data # MySQL 5.7.6ä¹‹å‰ç‰ˆæœ¬</span><br><span class="line"></span><br><span class="line"><span class="comment">#MySQL 5.7.6ä¹‹åç‰ˆæœ¬ä½¿ç”¨</span></span><br><span class="line">./bin/mysqld <span class="attribute">--defaults-file</span>=/usr/local/webserver/mysql/my.cnf <span class="attribute">--basedir</span>=/usr/local/webserver/mysql <span class="attribute">--datadir</span>=/data/mysql/data <span class="attribute">--user</span>=mysql --initialize-insecure <span class="attribute">--lower-case-table-names</span>=1</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> mysql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰è£…æ–‡æ¡£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸»ä»åŒæ­¥</title>
      <link href="/posts/b70d073a.html"/>
      <url>/posts/b70d073a.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="MYSQLä¸»ä»åŒæ­¥"><a href="#MYSQLä¸»ä»åŒæ­¥" class="headerlink" title="MYSQLä¸»ä»åŒæ­¥"></a>MYSQLä¸»ä»åŒæ­¥</h1><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># ä¸»æœåŠ¡å™¨ 192.168.1.212 master</span></span><br><span class="line"><span class="meta"># ä»æœåŠ¡å™¨ 192.168.1.213 slave</span></span><br></pre></td></tr></table></figure><h1 id="ä¸»æœåŠ¡å™¨é…ç½®"><a href="#ä¸»æœåŠ¡å™¨é…ç½®" class="headerlink" title="ä¸»æœåŠ¡å™¨é…ç½®"></a>ä¸»æœåŠ¡å™¨é…ç½®</h1><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">ä¸€ã€é…ç½®my.cnf</span><br><span class="line">vim my.cnf</span><br><span class="line"><span class="keyword">log</span>-bin=mysql-bin-master</span><br><span class="line"><span class="keyword">server</span>-id=<span class="number">212</span></span><br><span class="line"></span><br><span class="line">binlog_do_dbæ˜¯æŒ‡å®šbinlogæ—¥å¿—è®°å½•é‚£äº›åº“çš„äºŒè¿›åˆ¶æ—¥å¿—ã€‚</span><br><span class="line">replicate_do_dbåˆ™åœ¨slaveåº“ä¸­æŒ‡å®šåŒæ­¥é‚£äº›åº“çš„binlogæ—¥å¿—</span><br><span class="line"></span><br><span class="line">åœ¨masterä¸Šè®¾ç½®binlog_do_å¼Šç«¯ï¼š</span><br><span class="line"><span class="number">1</span>ã€è¿‡æ»¤æ“ä½œå¸¦æ¥çš„è´Ÿè½½éƒ½åœ¨masterä¸Š</span><br><span class="line"><span class="number">2</span>ã€æ— æ³•åšåŸºäºæ—¶é—´ç‚¹çš„å¤åˆ¶ï¼ˆåˆ©ç”¨binlogï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">äºŒã€é‡å¯mysql</span><br><span class="line">kill -USR2 `cat /data/mysqlData/<span class="number">917.</span>pid`</span><br><span class="line"></span><br><span class="line">ä¸‰ã€æˆæƒ</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">all</span> <span class="keyword">on</span> *.* <span class="keyword">to</span> <span class="string">&#x27;slave&#x27;</span>@<span class="string">&#x27;192.168.1.213&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">replication</span> slave <span class="keyword">on</span> *.* <span class="keyword">to</span> <span class="string">&#x27;slave&#x27;</span>@<span class="string">&#x27;192.168.1.213&#x27;</span>;</span><br><span class="line">flush <span class="keyword">privileges</span>;</span><br><span class="line"></span><br><span class="line"># mysql8</span><br><span class="line">mysql&gt; <span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;tongbu&#x27;</span>@<span class="string">&#x27;192.168.1.213&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line">mysql&gt;<span class="keyword">GRANT</span> <span class="keyword">SELECT</span>, <span class="keyword">INSERT</span>, <span class="keyword">UPDATE</span>, <span class="keyword">DELETE</span>, <span class="keyword">CREATE</span>, RELOAD, PROCESS, <span class="keyword">REFERENCES</span>, <span class="keyword">INDEX</span>, <span class="keyword">ALTER</span>, <span class="keyword">SHOW</span> DATABASES, SUPER, <span class="keyword">CREATE</span> <span class="keyword">TEMPORARY</span> <span class="keyword">TABLES</span>, <span class="keyword">LOCK</span> <span class="keyword">TABLES</span>, <span class="keyword">EXECUTE</span>, <span class="keyword">REPLICATION</span> SLAVE, <span class="keyword">REPLICATION</span> CLIENT, <span class="keyword">CREATE</span> <span class="keyword">VIEW</span>, <span class="keyword">SHOW</span> <span class="keyword">VIEW</span>, <span class="keyword">CREATE</span> <span class="keyword">ROUTINE</span>, <span class="keyword">ALTER</span> <span class="keyword">ROUTINE</span>, <span class="keyword">CREATE</span> <span class="keyword">USER</span>, EVENT, <span class="keyword">TRIGGER</span>, <span class="keyword">CREATE</span> <span class="keyword">ROLE</span>, <span class="keyword">DROP</span> <span class="keyword">ROLE</span> <span class="keyword">ON</span> *.* <span class="keyword">TO</span> `tongbu`@`<span class="number">192.168</span><span class="number">.1</span><span class="number">.213</span>` <span class="keyword">WITH</span> <span class="keyword">GRANT</span> <span class="keyword">OPTION</span>;</span><br><span class="line">flush <span class="keyword">privileges</span>;</span><br><span class="line"></span><br><span class="line">å››ã€æŸ¥çœ‹binlogæ–‡ä»¶ä»¥åŠpos</span><br><span class="line"><span class="keyword">show</span> master status;</span><br><span class="line"></span><br><span class="line">äº”ã€å¯¼å‡ºæ•°æ®åº“</span><br><span class="line">mysqldump  -uroot -p123456 cat&gt;cat.<span class="keyword">sql</span></span><br><span class="line"></span><br><span class="line">å…­ã€å°†æ•°æ®åº“ä¼ åˆ°ä»æœåŠ¡å™¨</span><br><span class="line">scp cat.<span class="keyword">sql</span>  <span class="number">192.168</span><span class="number">.1</span><span class="number">.213</span>:/data</span><br></pre></td></tr></table></figure><h1 id="ä»æœåŠ¡å™¨é…ç½®"><a href="#ä»æœåŠ¡å™¨é…ç½®" class="headerlink" title="ä»æœåŠ¡å™¨é…ç½®"></a>ä»æœåŠ¡å™¨é…ç½®</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ä¸€ã€é…ç½®my.cnf</span><br><span class="line">vim my.cnf</span><br><span class="line"><span class="attribute">server-id</span>=212</span><br><span class="line"><span class="attribute">replicate-do-db</span>=cat # è¦å¤„ç†çš„åº“</span><br><span class="line"><span class="attribute">replicate-ignore-db</span>=mysql # è¦å¿½ç•¥çš„åº“</span><br><span class="line"></span><br><span class="line">äºŒã€é‡å¯mysql</span><br><span class="line">kill -USR2 `cat /data/mysqlData/917.pid`</span><br><span class="line"></span><br><span class="line">ä¸‰ã€mysqlå‘½ä»¤è¡Œä¸‹é…ç½®slave</span><br><span class="line">mysql&gt;change master <span class="keyword">to</span> <span class="attribute">master_host</span>=<span class="string">&#x27;192.168.1.212&#x27;</span>,master_user=&#x27;cat&#x27;,master_password=&#x27;cat123456&#x27;,</span><br><span class="line"><span class="attribute">master_log_file</span>=<span class="string">&#x27;mysql-bin.000103&#x27;</span>,master_log_pos=220;</span><br><span class="line">mysql&gt;start slave;</span><br><span class="line">mysql&gt;show slave status \G;</span><br><span class="line"></span><br><span class="line">å››ã€åˆ°ä¸»æœåŠ¡å™¨æŸ¥çœ‹çŠ¶æ€</span><br><span class="line">mysql&gt;show processlist \G;</span><br></pre></td></tr></table></figure><h1 id="è·³è¿‡é”™è¯¯æœ‰ä¸¤ç§æ–¹å¼ï¼š"><a href="#è·³è¿‡é”™è¯¯æœ‰ä¸¤ç§æ–¹å¼ï¼š" class="headerlink" title="è·³è¿‡é”™è¯¯æœ‰ä¸¤ç§æ–¹å¼ï¼š"></a>è·³è¿‡é”™è¯¯æœ‰ä¸¤ç§æ–¹å¼ï¼š</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ä¸€ã€è·³è¿‡æŒ‡å®šæ•°é‡çš„äº‹åŠ¡ï¼š</span><br><span class="line"><span class="meta prompt_">mysql&gt;</span><span class="language-bash">slave stop;</span></span><br><span class="line"><span class="meta prompt_">mysql&gt;</span><span class="language-bash">SET GLOBAL SQL_SLAVE_SKIP_COUNTER = 1        <span class="comment">#è·³è¿‡ä¸€ä¸ªäº‹åŠ¡</span></span></span><br><span class="line"><span class="meta prompt_">mysql&gt;</span><span class="language-bash">slave start;</span></span><br><span class="line"></span><br><span class="line">äºŒã€ä¿®æ”¹mysqlçš„é…ç½®æ–‡ä»¶ï¼Œé€šè¿‡slave_skip_errorså‚æ•°æ¥è·³æ‰€æœ‰é”™è¯¯æˆ–æŒ‡å®šç±»å‹çš„é”™è¯¯</span><br><span class="line">vi /etc/my.cnf</span><br><span class="line">[mysqld]</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">slave-skip-errors=1062,1053,1146 <span class="comment">#è·³è¿‡æŒ‡å®šerror noç±»å‹çš„é”™è¯¯</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">slave-skip-errors=all <span class="comment">#è·³è¿‡æ‰€æœ‰é”™è¯¯</span></span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> mysql </category>
          
          <category> ä¸»ä»åŒæ­¥ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>mysqlè®°å½•</title>
      <link href="/posts/490cdff9.html"/>
      <url>/posts/490cdff9.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="å­—æ®µè½¬ç±»å‹"><a href="#å­—æ®µè½¬ç±»å‹" class="headerlink" title="å­—æ®µè½¬ç±»å‹"></a>å­—æ®µè½¬ç±»å‹</h1><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ–¹æ³•ä¸€ï¼š<span class="keyword">SELECT</span> CAST(<span class="string">&#x27;123&#x27;</span> <span class="keyword">AS</span> SIGNED);</span><br><span class="line">æ–¹æ³•äºŒï¼š<span class="keyword">SELECT</span> CONVERT(<span class="string">&#x27;123&#x27;</span>,SIGNED);</span><br><span class="line">æ–¹æ³•ä¸‰ï¼š<span class="keyword">SELECT</span> <span class="string">&#x27;123&#x27;</span>+<span class="number">0</span>;</span><br></pre></td></tr></table></figure><h1 id="åˆ é™¤è¡¨ä¸­é‡å¤æ•°æ®ä¿ç•™æœ€æ—©çš„ä¸€æ¡"><a href="#åˆ é™¤è¡¨ä¸­é‡å¤æ•°æ®ä¿ç•™æœ€æ—©çš„ä¸€æ¡" class="headerlink" title="åˆ é™¤è¡¨ä¸­é‡å¤æ•°æ®ä¿ç•™æœ€æ—©çš„ä¸€æ¡"></a>åˆ é™¤è¡¨ä¸­é‡å¤æ•°æ®ä¿ç•™æœ€æ—©çš„ä¸€æ¡</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">DELETE FROM TABLE WHERE ID IN &#123;</span><br><span class="line">    SELECT A.ID FROM (</span><br><span class="line">        SELECT ID FROM TABLE </span><br><span class="line">        WHERE</span><br><span class="line">        FIELD IN (SELECT FIELD FROM TABLE GROUP BY FIELD HAVING COUNT(*) &gt; 1)</span><br><span class="line">        AND</span><br><span class="line">        ID NOT IN (SELECT MIN(ID) FROM TABLE GROUP BY FIELD HAVING COUNT(*) &gt; 1)</span><br><span class="line">    ) AS A</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="mysqlæŸ¥è¯¢è¡¨ä¸­ä¸¤ä¸ªå­—æ®µæ•°æ®å®Œå…¨ä¸€æ ·çš„æ•°æ®"><a href="#mysqlæŸ¥è¯¢è¡¨ä¸­ä¸¤ä¸ªå­—æ®µæ•°æ®å®Œå…¨ä¸€æ ·çš„æ•°æ®" class="headerlink" title="mysqlæŸ¥è¯¢è¡¨ä¸­ä¸¤ä¸ªå­—æ®µæ•°æ®å®Œå…¨ä¸€æ ·çš„æ•°æ®"></a>mysqlæŸ¥è¯¢è¡¨ä¸­ä¸¤ä¸ªå­—æ®µæ•°æ®å®Œå…¨ä¸€æ ·çš„æ•°æ®</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select distinct *  from table_name A </span><br><span class="line">where A.createTime between UNIX_TIMESTAMP(&#x27;2018-04-08&#x27;) and UNIX_TIMESTAMP(&#x27;2018-04-09&#x27;)</span><br><span class="line">and exists(select 1 from table_name B </span><br><span class="line">where A.id&lt;&gt;B.id and A.hid=B.hid and A.createTime=B.createTime </span><br><span class="line">and B.createTime between UNIX_TIMESTAMP(&#x27;2018-04-08&#x27;) and UNIX_TIMESTAMP(&#x27;2018-04-09&#x27;))</span><br></pre></td></tr></table></figure><h1 id="ç”Ÿæˆéšæœºæ•°"><a href="#ç”Ÿæˆéšæœºæ•°" class="headerlink" title="ç”Ÿæˆéšæœºæ•°"></a>ç”Ÿæˆéšæœºæ•°</h1><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title"><span class="built_in">round</span></span>(<span class="title">rand</span>() * (<span class="variable">max</span> - <span class="variable">min</span>) + <span class="variable">min</span>)</span></span><br><span class="line">è·å–<span class="number">0</span>-<span class="number">50</span>éšæœºæ•° </span><br><span class="line"><span class="function"><span class="title"><span class="built_in">round</span></span>(<span class="title">rand</span>() * (<span class="number">50</span> - <span class="number">0</span>) + <span class="number">0</span>)</span></span><br></pre></td></tr></table></figure><h1 id="æŸ¥è¯¢æ—¶-è½¬æ¢å­æ®µç±»å‹"><a href="#æŸ¥è¯¢æ—¶-è½¬æ¢å­æ®µç±»å‹" class="headerlink" title="æŸ¥è¯¢æ—¶,è½¬æ¢å­æ®µç±»å‹"></a>æŸ¥è¯¢æ—¶,è½¬æ¢å­æ®µç±»å‹</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select city, convert(binary convert(city using latin5) using utf8mb4) from user_location where city like &#x27;%Ãƒ%&#x27; collate utf8mb4_bin;</span><br><span class="line">select * from topics where name=&#x27;Harligt&#x27; COLLATE utf8_bin;</span><br></pre></td></tr></table></figure><h1 id="æ•°æ®é‡å¤§çš„æƒ…å†µä¸‹åˆ†é¡µå¤„ç†-æ•ˆç‡æ¯”ç›´æ¥ä½¿ç”¨limitå¥½"><a href="#æ•°æ®é‡å¤§çš„æƒ…å†µä¸‹åˆ†é¡µå¤„ç†-æ•ˆç‡æ¯”ç›´æ¥ä½¿ç”¨limitå¥½" class="headerlink" title="æ•°æ®é‡å¤§çš„æƒ…å†µä¸‹åˆ†é¡µå¤„ç†(æ•ˆç‡æ¯”ç›´æ¥ä½¿ç”¨limitå¥½)"></a>æ•°æ®é‡å¤§çš„æƒ…å†µä¸‹åˆ†é¡µå¤„ç†(æ•ˆç‡æ¯”ç›´æ¥ä½¿ç”¨limitå¥½)</h1><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * <span class="keyword">from</span> tbname <span class="keyword">where</span> <span class="built_in">id</span> &gt; <span class="built_in">offset</span> <span class="keyword">and</span> <span class="built_in">id</span> &lt; <span class="built_in">offset</span> + limit (<span class="built_in">id</span>ä¸ºç´¢å¼•)</span><br></pre></td></tr></table></figure><h1 id="case-when-then"><a href="#case-when-then" class="headerlink" title="case when then"></a>case when then</h1><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CASE</span> jgdw <span class="keyword">WHEN</span> <span class="number">1</span> <span class="keyword">THEN</span> zujin <span class="keyword">WHEN</span> <span class="number">2</span> <span class="keyword">THEN</span> zujin * mj <span class="keyword">ELSE</span> zujin * mj * <span class="number">30</span> <span class="keyword">END</span> <span class="keyword">AS</span> zujinMon</span><br></pre></td></tr></table></figure><h1 id="å¯¹æ•°æ®è¿›è¡Œorder-byåå†è¿›è¡Œgroup-by-é»˜è®¤æƒ…å†µä¸‹ä¼šå¯¼è‡´æ•°æ®æŒ‰ç…§è‡ªç„¶æ’åº"><a href="#å¯¹æ•°æ®è¿›è¡Œorder-byåå†è¿›è¡Œgroup-by-é»˜è®¤æƒ…å†µä¸‹ä¼šå¯¼è‡´æ•°æ®æŒ‰ç…§è‡ªç„¶æ’åº" class="headerlink" title="å¯¹æ•°æ®è¿›è¡Œorder byåå†è¿›è¡Œgroup by(é»˜è®¤æƒ…å†µä¸‹ä¼šå¯¼è‡´æ•°æ®æŒ‰ç…§è‡ªç„¶æ’åº)"></a>å¯¹æ•°æ®è¿›è¡Œorder byåå†è¿›è¡Œgroup by(é»˜è®¤æƒ…å†µä¸‹ä¼šå¯¼è‡´æ•°æ®æŒ‰ç…§è‡ªç„¶æ’åº)</h1><p><a href="https://stackoverflow.com/questions/14770671/mysql-order-by-before-group-by">MySQL order by before group by</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">SELECT p1.* </span><br><span class="line">FROM wp_posts AS p1</span><br><span class="line">INNER JOIN</span><br><span class="line">(</span><br><span class="line">    SELECT MAX(post_date) MaxPostDate, post_author</span><br><span class="line">    FROM wp_posts</span><br><span class="line">    WHERE post_status=&#x27;publish&#x27;</span><br><span class="line">       AND post_type=&#x27;post&#x27;</span><br><span class="line">    GROUP BY post_author</span><br><span class="line">) AS p2</span><br><span class="line">  ON p1.post_author = p2.post_author</span><br><span class="line">  AND p1.post_date = p2.MaxPostDate</span><br><span class="line">WHERE p1.post_status=&#x27;publish&#x27;</span><br><span class="line">  AND p1.post_type=&#x27;post&#x27;</span><br><span class="line">ORDER BY p1.post_date DESC;</span><br></pre></td></tr></table></figure><h1 id="è·å–è¡¨å’Œå­—æ®µä»¥åŠæ³¨é‡Š"><a href="#è·å–è¡¨å’Œå­—æ®µä»¥åŠæ³¨é‡Š" class="headerlink" title="è·å–è¡¨å’Œå­—æ®µä»¥åŠæ³¨é‡Š"></a>è·å–è¡¨å’Œå­—æ®µä»¥åŠæ³¨é‡Š</h1><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># è¡¨æ³¨é‡Šå¯ä»¥ç”¨</span><br><span class="line"><span class="keyword">SQL</span> code</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">table</span> status <span class="keyword">like</span> <span class="string">&#x27;è¡¨å&#x27;</span></span><br><span class="line"># å­—æ®µæ³¨é‡Šå¯ä»¥ç”¨</span><br><span class="line"><span class="keyword">SQL</span> code</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">full</span> <span class="keyword">columns</span> <span class="keyword">from</span> è¡¨å</span><br><span class="line">è¿™ä¸¤ä¸ªè¯­å¥æ‰§è¡Œç»“æœéƒ½ä¼šæœ‰<span class="keyword">Comment</span>å­—æ®µã€‚</span><br></pre></td></tr></table></figure><h1 id="å¤‡ä»½"><a href="#å¤‡ä»½" class="headerlink" title="å¤‡ä»½"></a>å¤‡ä»½</h1><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"># æ ¹æ®æ¡ä»¶å¯¼å‡ºæŒ‡å®šè¡¨çš„æ•°æ®</span><br><span class="line">mysqldump -u root -p -h <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="comment">--databases dataName --tables tableName --where=&quot; whereParam&quot; &gt; xxx/xxx.sql</span></span><br><span class="line"># åªå¯¼å‡ºæ•°æ®</span><br><span class="line">mysqldump -t</span><br><span class="line"># åªå¯¼å‡ºç»“æ„</span><br><span class="line">mysqldump -d</span><br><span class="line"># å¿½ç•¥æŒ‡å®šè¡¨å¯¼å‡º</span><br><span class="line">mysqldump <span class="comment">--ignore-table=database.tablex --ignore-table=database.tablexx</span></span><br><span class="line"></span><br><span class="line"># å…¨åº“å¤‡ä»½</span><br><span class="line">[root@linuxidc ~]# mysqldump -uroot -p <span class="comment">--single-transaction -A --master-data=2 &gt;dump.sql</span></span><br><span class="line">åªè¿˜åŸerpåº“çš„å†…å®¹</span><br><span class="line">[root@linuxidc ~]# mysql -uroot -pMANAGER erp <span class="comment">--one-database &lt;dump.sql</span></span><br><span class="line">å¯ä»¥çœ‹å‡ºè¿™é‡Œä¸»è¦ç”¨åˆ°çš„å‚æ•°æ˜¯<span class="comment">--one-databaseç®€å†™-oçš„å‚æ•°ï¼Œæå¤§æ–¹ä¾¿äº†æˆ‘ä»¬çš„æ¢å¤çµæ´»æ€§ã€‚</span></span><br><span class="line">é‚£ä¹ˆå¦‚ä½•ä»å…¨åº“å¤‡ä»½ä¸­æŠ½å–æŸå¼ è¡¨å‘¢ï¼Œå…¨åº“æ¢å¤ï¼Œå†æ¢å¤æŸå¼ è¡¨å°åº“è¿˜å¯ä»¥ï¼Œå¤§åº“å°±å¾ˆéº»çƒ¦äº†ï¼Œé‚£æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥è¿›è¡Œå¿«é€ŸæŠ½å–ï¼Œå…·ä½“å®ç°æ–¹æ³•å¦‚ä¸‹ï¼š</span><br><span class="line"></span><br><span class="line"># ä»å…¨åº“å¤‡ä»½ä¸­æŠ½å–å‡ºtè¡¨çš„è¡¨ç»“æ„</span><br><span class="line">[root@linuxidc ~]# sed -<span class="string">e&#x27;/./&#123;H;$!d;&#125;&#x27;</span> -e <span class="string">&#x27;x;/CREATE TABLE `t`/!d;q&#x27;</span> dump.<span class="keyword">sql</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span>`t`;</span><br><span class="line"><span class="comment">/*!40101 SET@saved_cs_client    =@@character_set_client */</span>;</span><br><span class="line"><span class="comment">/*!40101 SETcharacter_set_client = utf8 */</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `t` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `age` tinyint(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">  `<span class="type">name</span>` <span class="type">varchar</span>(<span class="number">30</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`)</span><br><span class="line">) ENGINE=InnoDBAUTO_INCREMENT=<span class="number">4</span> <span class="keyword">DEFAULT</span> CHARSET=utf8;</span><br><span class="line"><span class="comment">/*!40101 SETcharacter_set_client = @saved_cs_client */</span>;</span><br><span class="line"> </span><br><span class="line"># ä»å…¨åº“å¤‡ä»½ä¸­æŠ½å–å‡ºtè¡¨çš„å†…å®¹</span><br><span class="line">[root@linuxidc ~]# grep<span class="string">&#x27;INSERT INTO `t`&#x27;</span> dump.<span class="keyword">sql</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `t`<span class="keyword">VALUES</span> (<span class="number">0</span>,<span class="number">0</span>,<span class="string">&#x27;&#x27;</span>),(<span class="number">1</span>,<span class="number">0</span>,<span class="string">&#x27;aa&#x27;</span>),(<span class="number">2</span>,<span class="number">0</span>,<span class="string">&#x27;bbb&#x27;</span>),(<span class="number">3</span>,<span class="number">25</span>,<span class="string">&#x27;helei&#x27;</span>);</span><br></pre></td></tr></table></figure><h1 id="è¡¨åˆ†åŒº"><a href="#è¡¨åˆ†åŒº" class="headerlink" title="è¡¨åˆ†åŒº"></a>è¡¨åˆ†åŒº</h1><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>æ–°å»º<span class="type">int</span>å­—æ®µ(é€šè¿‡æ—¶é—´å­—æ®µè¿›è¡Œåˆ†åŒºï¼Œé<span class="type">int</span>ç±»å‹åˆ†åŒºæŸ¥è¯¢ä¼šå­˜åœ¨bug)ï¼Œå¹¶è®¾ç½®ä¸ºä¸»é”®ï¼Œæ·»åŠ ç´¢å¼•ã€‚</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> `tableName`</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">COLUMN</span> `columnName` <span class="type">int</span>(<span class="number">8</span>) <span class="keyword">NULL</span> <span class="keyword">AFTER</span> `gid`,</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">PRIMARY KEY</span> (` columnName `),</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">INDEX</span> ` columnName ` (` columnName `) <span class="keyword">USING</span> BTREE ;</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>ä¸ºå­—æ®µå¡«å……æ•°æ®</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>æ‰§è¡Œåˆ†åŒºåŠ¨ä½œ(å·²å¹´æœˆä¸ºå•ä½)</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tableName <span class="keyword">PARTITION BY RANGE</span>( columnName )</span><br><span class="line">(</span><br><span class="line">  <span class="keyword">PARTITION</span> p_201512 <span class="keyword">VALUES</span> LESS THAN (<span class="number">20160101</span>),</span><br><span class="line">  <span class="keyword">PARTITION</span> p_201601 <span class="keyword">VALUES</span> LESS THAN (<span class="number">20160201</span>),</span><br><span class="line">  <span class="keyword">PARTITION</span> p_201602 <span class="keyword">VALUES</span> LESS THAN (<span class="number">20160301</span>),</span><br><span class="line">  <span class="keyword">PARTITION</span> p_201603 <span class="keyword">VALUES</span> LESS THAN (<span class="number">20160401</span>),</span><br><span class="line">  <span class="keyword">PARTITION</span> p_201604 <span class="keyword">VALUES</span> LESS THAN (<span class="number">20160501</span>),</span><br><span class="line">  <span class="keyword">PARTITION</span> p_201605 <span class="keyword">VALUES</span> LESS THAN (<span class="number">20160601</span>),</span><br><span class="line">  <span class="keyword">PARTITION</span> p_201606 <span class="keyword">VALUES</span> LESS THAN (<span class="number">20160701</span>),</span><br><span class="line">  <span class="keyword">PARTITION</span> p_201607 <span class="keyword">VALUES</span> LESS THAN (<span class="number">20160801</span>),</span><br><span class="line">  <span class="keyword">PARTITION</span> p_201608 <span class="keyword">VALUES</span> LESS THAN (<span class="number">20160901</span>),</span><br><span class="line">  <span class="keyword">PARTITION</span> p_201609 <span class="keyword">VALUES</span> LESS THAN (<span class="number">20161001</span>),</span><br><span class="line">  <span class="keyword">PARTITION</span> p_201610 <span class="keyword">VALUES</span> LESS THAN (<span class="number">20161101</span>),</span><br><span class="line">  <span class="keyword">PARTITION</span> p_201611 <span class="keyword">VALUES</span> LESS THAN (<span class="number">20161201</span>),</span><br><span class="line">  <span class="keyword">PARTITION</span> p_201612 <span class="keyword">VALUES</span> LESS THAN (<span class="number">20170101</span>),</span><br><span class="line">  <span class="keyword">PARTITION</span> p_201701 <span class="keyword">VALUES</span> LESS THAN (<span class="number">20170201</span>),</span><br><span class="line">  <span class="keyword">PARTITION</span> p_201702 <span class="keyword">VALUES</span> LESS THAN (<span class="number">20170301</span>),</span><br><span class="line">  <span class="keyword">PARTITION</span> p_201703 <span class="keyword">VALUES</span> LESS THAN (<span class="number">20170401</span>),</span><br><span class="line">  <span class="keyword">PARTITION</span> p_catch_all <span class="keyword">VALUES</span> LESS THAN <span class="keyword">MAXVALUE</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span>æ‰§è¡ŒæŸ¥è¯¢ (<span class="keyword">where</span>éœ€ä½¿ç”¨ columnName æ‰æœ‰æ•ˆ)</span><br><span class="line"><span class="keyword">EXPLAIN</span> PARTITIONS <span class="keyword">select</span> * <span class="keyword">from</span> tableName <span class="keyword">where</span> columnName &lt;=<span class="string">&#x27;20160202&#x27;</span> <span class="keyword">and</span> columnName &gt;=<span class="string">&#x27;20160101&#x27;</span>;</span><br></pre></td></tr></table></figure><h1 id="æŸ¥çœ‹log"><a href="#æŸ¥çœ‹log" class="headerlink" title="æŸ¥çœ‹log"></a>æŸ¥çœ‹log</h1><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># è¿›å…¥æ•°æ®åº“å</span></span><br><span class="line"><span class="meta"># æŸ¥çœ‹binlog</span></span><br><span class="line">show binlog events in &#x27;mysql-bin.<span class="number">000256</span>&#x27;<span class="punctuation">;</span></span><br><span class="line"></span><br><span class="line"><span class="meta"># æŸ¥çœ‹replylog</span></span><br><span class="line">show replylog events in &#x27;mysql-reply-bin.<span class="number">000256</span>&#x27;<span class="punctuation">;</span></span><br></pre></td></tr></table></figure><h1 id="mysql-s-eæ— æ³•æŸ¥è¯¢ç»“æœ"><a href="#mysql-s-eæ— æ³•æŸ¥è¯¢ç»“æœ" class="headerlink" title="mysql -s -eæ— æ³•æŸ¥è¯¢ç»“æœ"></a>mysql -s -eæ— æ³•æŸ¥è¯¢ç»“æœ</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ç”±äºæ— æ³•è¯†åˆ«ä¸­æ–‡çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½å¯¼è‡´æŸ¥è¯¢ç»“æœä¸å¯¹</span><br><span class="line">ä¾‹å¦‚<span class="attribute">name</span>=<span class="string">&#x27;a&#x27;</span>,ä¼šæ²¡æœ‰ä»»ä½•ç»“æœ</span><br></pre></td></tr></table></figure><h1 id="JOIN-ONå’ŒUSING"><a href="#JOIN-ONå’ŒUSING" class="headerlink" title="JOIN ONå’ŒUSING"></a>JOIN ONå’ŒUSING</h1><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">JOIN ON A<span class="selector-class">.ID</span> = B<span class="selector-class">.ID</span> ä¼šå‡ºç°ä¸¤è¡¨éƒ½æœ‰çš„å­—æ®µ</span><br><span class="line"><span class="function"><span class="title">USING</span><span class="params">(ID)</span></span> IDä¸ºä¸¤ä¸ªè¡¨éƒ½æœ‰çš„å­—æ®µã€‚ä¸”åªä¼šæ˜¾ç¤ºç¬¬ä¸€å¼ è¡¨çš„å­—æ®µ</span><br></pre></td></tr></table></figure><h1 id="selectä¸­å˜é‡èµ‹å€¼"><a href="#selectä¸­å˜é‡èµ‹å€¼" class="headerlink" title="selectä¸­å˜é‡èµ‹å€¼"></a>selectä¸­å˜é‡èµ‹å€¼</h1><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;<span class="keyword">select</span> <span class="symbol">@found</span> := <span class="number">10</span><span class="comment">;</span></span><br></pre></td></tr></table></figure><h1 id="æŸ¥çœ‹åº“æ€»è¡Œæ•°"><a href="#æŸ¥çœ‹åº“æ€»è¡Œæ•°" class="headerlink" title="æŸ¥çœ‹åº“æ€»è¡Œæ•°"></a>æŸ¥çœ‹åº“æ€»è¡Œæ•°</h1><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> SUM(TABLE_ROWS) <span class="keyword">from</span> information_schema.<span class="keyword">TABLES</span> <span class="keyword">where</span> TABLE_SCHEMA=<span class="string">&#x27;city_cypher&#x27;</span>;</span><br></pre></td></tr></table></figure><h1 id="æŸ¥çœ‹åº“è¡¨å¤§å°"><a href="#æŸ¥çœ‹åº“è¡¨å¤§å°" class="headerlink" title="æŸ¥çœ‹åº“è¡¨å¤§å°"></a>æŸ¥çœ‹åº“è¡¨å¤§å°</h1><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">table_name</span>,round(sum(data_length/<span class="number">1024</span>/<span class="number">1024</span>),<span class="number">2</span>) <span class="keyword">as</span> data <span class="keyword">from</span> information_schema.<span class="keyword">tables</span> <span class="keyword">where</span> table_schema=<span class="string">&#x27;database name&#x27;</span> <span class="keyword">GROUP</span> <span class="keyword">by</span> <span class="built_in">table_name</span> <span class="keyword">order</span> <span class="keyword">by</span> data <span class="keyword">asc</span>;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> mysql </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æä¾›åƒè®¿é—®æ•°ç»„ä¸€æ ·è®¿é—®å¯¹è±¡çš„èƒ½åŠ›çš„æ¥å£</title>
      <link href="/posts/476587e9.html"/>
      <url>/posts/476587e9.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// æä¾›åƒè®¿é—®æ•°ç»„ä¸€æ ·è®¿é—®å¯¹è±¡çš„èƒ½åŠ›çš„æ¥å£ã€‚</span></span><br><span class="line">Class ArrayAccessObj <span class="keyword">implements</span> <span class="built_in">ArrayAccess</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$container</span> = <span class="keyword">array</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;container = <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&quot;one&quot;</span>   =&gt; <span class="number">1</span>,</span><br><span class="line">            <span class="string">&quot;two&quot;</span>   =&gt; <span class="number">2</span>,</span><br><span class="line">            <span class="string">&quot;three&quot;</span> =&gt; <span class="number">3</span>,</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">offsetSet</span> (<span class="params"><span class="variable">$offset</span>,<span class="variable">$value</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">is_null</span>(<span class="variable">$offset</span>)) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;container[] = <span class="variable">$value</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;container[<span class="variable">$offset</span>] = <span class="variable">$value</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">offsetExists</span> (<span class="params"><span class="variable">$offset</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;container[<span class="variable">$offset</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">offsetUnset</span> (<span class="params"><span class="variable">$offset</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">unset</span>(<span class="variable language_">$this</span>-&gt;container[<span class="variable">$offset</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">offsetGet</span> (<span class="params"><span class="variable">$offset</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;container[<span class="variable">$offset</span>]) ? <span class="variable language_">$this</span>-&gt;container[<span class="variable">$offset</span>] : <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$obj</span> = <span class="keyword">new</span> <span class="title class_">ArrayAccessObj</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//var_dump(isset($obj[&quot;two&quot;]));</span></span><br><span class="line"><span class="comment">//var_dump($obj[&quot;two&quot;]);</span></span><br><span class="line"><span class="comment">//unset($obj[&quot;two&quot;]);</span></span><br><span class="line"><span class="comment">//var_dump(isset($obj[&quot;two&quot;]));</span></span><br><span class="line"><span class="comment">//$obj[&quot;two&quot;] = &quot;A value&quot;;</span></span><br><span class="line"><span class="comment">//var_dump($obj[&quot;two&quot;]);</span></span><br><span class="line"><span class="variable">$obj</span>[] = <span class="string">&#x27;Append 1&#x27;</span>;</span><br><span class="line"><span class="variable">$obj</span>[] = <span class="string">&#x27;Append 2&#x27;</span>;</span><br><span class="line"><span class="variable">$obj</span>[] = <span class="string">&#x27;Append 3&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="variable">$obj</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ååŒyield</title>
      <link href="/posts/a51fc8aa.html"/>
      <url>/posts/a51fc8aa.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gen</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$ret</span> = (<span class="keyword">yield</span> <span class="string">&#x27;yield1&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">var_dump</span>(<span class="variable">$ret</span>);</span><br><span class="line">    <span class="variable">$ret</span> = (<span class="keyword">yield</span> <span class="string">&#x27;yield2&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">var_dump</span>(<span class="variable">$ret</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$gen</span> = <span class="title function_ invoke__">gen</span>();</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$gen</span>-&gt;<span class="title function_ invoke__">current</span>());    <span class="comment">// string(6) &quot;yield1&quot;</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$gen</span>-&gt;<span class="title function_ invoke__">send</span>(<span class="string">&#x27;ret1&#x27;</span>)); <span class="comment">// string(4) &quot;ret1&quot;   (the first var_dump in gen)</span></span><br><span class="line"><span class="comment">// string(6) &quot;yield2&quot; (the var_dump of the -&gt;send() return value)</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$gen</span>-&gt;<span class="title function_ invoke__">send</span>(<span class="string">&#x27;ret2&#x27;</span>)); <span class="comment">// string(4) &quot;ret2&quot;   (again from within gen)</span></span><br><span class="line"><span class="comment">// NULL               (the return value of -&gt;send())</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>xmlè½¬æ•°ç»„</title>
      <link href="/posts/c0debf31.html"/>
      <url>/posts/c0debf31.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç±»å‹è½¬æ¢</span></span><br><span class="line"><span class="comment"> * Class TypeChange</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TypeChange</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * xmlè½¬ä¸ºæ•°ç»„</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $xml</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">xmlToArray</span>(<span class="params"><span class="variable">$xml</span></span>) </span>&#123;</span><br><span class="line">        <span class="comment">//ç¦æ­¢å¼•ç”¨å¤–éƒ¨xmlå®ä½“</span></span><br><span class="line">        <span class="title function_ invoke__">libxml_disable_entity_loader</span>(<span class="literal">true</span>);</span><br><span class="line">        <span class="variable">$array</span> = <span class="title function_ invoke__">json_decode</span>(<span class="title function_ invoke__">json_encode</span>(<span class="title function_ invoke__">simplexml_load_string</span>(<span class="variable">$xml</span>, <span class="string">&#x27;SimpleXMLElement&#x27;</span>, LIBXML_NOCDATA)), <span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$array</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>php ç¼“å­˜æŸ¥è¯¢ä¸éç¼“å­˜æŸ¥è¯¢(å¤„ç†å¤§æ•°æ®)</title>
      <link href="/posts/c64f7adf.html"/>
      <url>/posts/c64f7adf.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//ç¼“å­˜æŸ¥è¯¢:phpé»˜è®¤çš„æŸ¥è¯¢æ–¹å¼ï¼ŒæŸ¥è¯¢æ•°æ®ç»“æœä¼šä¸€æ¬¡å…¨éƒ¨æå–åˆ°å†…å­˜ã€‚</span></span><br><span class="line"><span class="comment">//éå†…å­˜æŸ¥è¯¢:æ•°æ®åº“æœåŠ¡iå»ä¼šä¸€æ¡ä¸€æ¡çš„è¿”å›æ•°æ®ï¼Œè¿™æ ·çš„ç»“æœå°±æ˜¯phpç¨‹åºæ¶ˆè€—è¾ƒå°‘çš„å†…å­˜ï¼Œå½“ä¼šå¢åŠ æ•°æ®åº“æœåŠ¡å™¨çš„å‹åŠ›ï¼Œå› ä¸ºæ•°æ®åº“ä¼šä¸€ç›´ç­‰å¾…phpæ¥å–æ•°æ®ï¼Œä¸€ç›´åˆ°æ•°æ®å…¨éƒ¨å–å®Œã€‚</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// ç¼“å­˜æŸ¥è¯¢é€‚åˆå°æ•°æ®é‡çš„æŸ¥è¯¢ï¼Œéç¼“å­˜æŸ¥è¯¢é€‚åˆå¤§æ•°æ®æŸ¥è¯¢ã€‚</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//éç¼“å­˜æŸ¥è¯¢æ–¹æ³•ä¸€ï¼šmysqli</span></span><br><span class="line"><span class="variable">$mysqli</span> = <span class="keyword">new</span> <span class="title function_ invoke__">mysqli</span>(<span class="string">&quot;localhost&quot;</span>,<span class="string">&quot;my_user&quot;</span>,<span class="string">&quot;my_pwd&quot;</span>,<span class="string">&quot;dbname&quot;</span>);</span><br><span class="line"><span class="variable">$uresult</span> = <span class="variable">$mysqli</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;select * from table&quot;</span>,MYSQL_USER_RESULT);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$uresult</span>)&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="variable">$row</span> = <span class="variable">$uresule</span>-&gt;<span class="title function_ invoke__">fetch_assoc</span>())&#123;</span><br><span class="line">        <span class="keyword">echo</span>  <span class="variable">$row</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$uresule</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//éç¼“å­˜æŸ¥è¯¢æ–¹æ³•äºŒï¼šmysql</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//æ³¨é‡Šï¼šmysql_unbuffered_query()çš„å¥½å¤„æ˜¯æœ‰ä»£ä»·çš„ï¼šåœ¨mysql_unbuffered_query()è¿”å›çš„ç»“æœé›†ä¹‹ä¸Šä¸èƒ½ä½¿ç”¨</span></span><br><span class="line"><span class="comment">//mysql_num_rows()å’Œmysql_data_seek()ã€‚æ­¤å¤–åœ¨å‘MYSQLå‘é€ä¸€æ¡æ–°çš„SQLæŸ¥è¯¢ä¹‹å‰ï¼Œå¿…é¡»æå–æ‰€æœ‰æœªç¼“å­˜çš„</span></span><br><span class="line"><span class="comment">//SQLæŸ¥è¯¢æ‰€äº§ç”Ÿçš„ç»“æœè¡Œã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$coon</span> = <span class="title function_ invoke__">mysql_connect</span>(<span class="string">&quot;localhost&quot;</span>,<span class="string">&quot;my_user&quot;</span>,<span class="string">&quot;my_pwd&quot;</span>);</span><br><span class="line"><span class="variable">$db</span> = <span class="title function_ invoke__">mysql_select_db</span>(<span class="string">&quot;dbname&quot;</span>);</span><br><span class="line"><span class="variable">$uresule</span> = <span class="title function_ invoke__">mysql_unbuffered_query</span>(<span class="string">&quot;select * from table&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$uresult</span>)&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="variable">$row</span> = <span class="variable">$uresule</span>-&gt;<span class="title function_ invoke__">fetch_assoc</span>(<span class="variable">$uresult</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span>  <span class="variable">$row</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//éç¼“å­˜æŸ¥è¯¢æ–¹æ³•ä¸‰:pdo_mysql</span></span><br><span class="line"><span class="variable">$pdo</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PDO</span>(<span class="string">&quot;mysql:localhost;dbname=dbname&quot;</span>, <span class="string">&quot;my_user&quot;</span>, <span class="string">&quot;my_pwd&quot;</span>);</span><br><span class="line"><span class="variable">$pdo</span>-&gt;<span class="title function_ invoke__">setAttribute</span>(PDO::<span class="variable constant_">MYSQL_ATTR_USE_BUFFERED_QUERY</span>,<span class="literal">false</span>);</span><br><span class="line"><span class="variable">$uresule</span> = <span class="variable">$pdo</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;select * from table&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$uresule</span>)&#123;</span><br><span class="line">      <span class="keyword">while</span>(<span class="variable">$row</span> = <span class="variable">$uresule</span>-&gt;<span class="title function_ invoke__">fetch</span>(PDO::<span class="variable constant_">FETCH_ASSOC</span>))&#123;</span><br><span class="line">               <span class="keyword">echo</span>  <span class="variable">$row</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åå°„ç±»è·å–classä¸‹æºç </title>
      <link href="/posts/226a5c44.html"/>
      <url>/posts/226a5c44.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åå°„ç±»è·å–classä¸‹çš„æºç </span></span><br><span class="line"><span class="comment"> * Class reflectionUtil</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ReflectionUtil</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getClassSourse</span>(<span class="params"> ReflectionClass <span class="variable">$class</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$path</span> = <span class="variable">$class</span>-&gt;<span class="title function_ invoke__">getFileName</span>();</span><br><span class="line">        <span class="variable">$lines</span> = @<span class="title function_ invoke__">file</span>(<span class="variable">$path</span>);</span><br><span class="line">        <span class="variable">$from</span> = <span class="variable">$class</span>-&gt;<span class="title function_ invoke__">getStartLine</span>();</span><br><span class="line">        <span class="variable">$to</span> = <span class="variable">$class</span>-&gt;<span class="title function_ invoke__">getEndLine</span>();</span><br><span class="line">        <span class="variable">$len</span> = <span class="variable">$to</span>-<span class="variable">$from</span>+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">implode</span>(<span class="title function_ invoke__">array_slice</span>(<span class="variable">$lines</span>, <span class="variable">$from</span>-<span class="number">1</span>,<span class="variable">$len</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Class className &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">hello</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title class_">ReflectionUtil</span>::<span class="title function_ invoke__">getClassSourse</span>( <span class="keyword">new</span> <span class="title class_">ReflectionClass</span>(<span class="string">&#x27;ClassName&#x27;</span>)));</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ’åºç®—æ³•</title>
      <link href="/posts/735e5788.html"/>
      <url>/posts/735e5788.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">sortClass</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Array Order</span></span><br><span class="line"><span class="comment">     * äºŒç»´æ•°ç»„æ’åºå‡½æ•°</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>   array $array è¦æ’åºçš„æ•°ç»„</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>   string $field è¦æ’åºçš„å­—æ®µå</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>   string $sortOrder æ’åºæ–¹å¼ï¼ˆé»˜è®¤å‡åºï¼‰</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>   string $sortOrder æ’åºç±»å‹ï¼ˆé»˜è®¤æ•°ç»„ç±»å‹ï¼‰</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>  array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">arraySort</span>(<span class="params"><span class="variable">$Array</span>, <span class="variable">$Field</span>, <span class="variable">$sortOrder</span> = SORT_ASC, <span class="variable">$sortFlags</span> = SORT_NUMERIC</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$Array</span> <span class="keyword">as</span> <span class="variable">$vo</span>) &#123;</span><br><span class="line">            <span class="variable">$t</span>[] = <span class="variable">$vo</span>[<span class="variable">$Field</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">array_multisort</span>(<span class="variable">$t</span>, <span class="variable">$sortOrder</span>, <span class="variable">$sortFlags</span>, <span class="variable">$Array</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$Array</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * äºŒç»´æ•°ç»„æ’åºå‡½æ•°,ä¿ç•™é”®å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array $array è¦æ’åºçš„æ•°ç»„</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $key ç”¨æ¥æ’åºçš„é”®å</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $type é»˜è®¤ä¸ºå‡åºæ’åº</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">array_sort</span>(<span class="params"><span class="variable">$array</span>, <span class="variable">$key</span>, <span class="variable">$type</span> = <span class="string">&#x27;asc&#x27;</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$keysValue</span> = <span class="variable">$newArray</span> = <span class="keyword">array</span>();</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$array</span> <span class="keyword">as</span> <span class="variable">$k</span> =&gt; <span class="variable">$v</span>) &#123;</span><br><span class="line">            <span class="variable">$keysValue</span>[<span class="variable">$k</span>] = <span class="variable">$v</span>[<span class="variable">$key</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$type</span> == <span class="string">&#x27;asc&#x27;</span>) &#123;</span><br><span class="line">            <span class="title function_ invoke__">asort</span>(<span class="variable">$keysValue</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="title function_ invoke__">arsort</span>(<span class="variable">$keysValue</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="title function_ invoke__">reset</span>(<span class="variable">$keysValue</span>);</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$keysValue</span> <span class="keyword">as</span> <span class="variable">$k</span> =&gt; <span class="variable">$v</span>) &#123;</span><br><span class="line">            <span class="variable">$newArray</span>[<span class="variable">$k</span>] = <span class="variable">$array</span>[<span class="variable">$k</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$newArray</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ•°ç»„ä¸­æŠ½å–å‡ºé”®ä¸º$fieldï¼Œå•ç‹¬æˆä¸ºä¸€ä¸ªæ•°ç»„ä½œä¸ºå¤šç»´æ•°ç»„çš„æ’åº</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array $array éœ€è¦æ’åºçš„æ•°ç»„</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $field æŒ‡å®šæ’åºçš„é”®å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getSortArr</span>(<span class="params">&amp;<span class="variable">$array</span>,<span class="variable">$field</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$fieldArr</span> = <span class="keyword">array</span>();</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$array</span> <span class="keyword">as</span> <span class="variable">$key</span>=&gt;<span class="variable">$value</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">array_key_exists</span>(<span class="variable">$field</span>, <span class="variable">$value</span>))&#123;</span><br><span class="line">                <span class="variable">$fieldArr</span>[] = <span class="variable">$value</span>[<span class="variable">$field</span>];</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getSortArr</span>(<span class="variable">$value</span>,<span class="variable">$field</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">actionTest</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$array</span> = <span class="variable">$field</span> = <span class="keyword">array</span>();<span class="comment">//éœ€è¦æ’åºçš„æ•°ç»„</span></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getSortArr</span>(<span class="variable">$array</span>, <span class="variable">$field</span>);<span class="comment">//æ•°ç»„ä¸­æŠ½å–å‡ºé”®ä¸º$fieldï¼Œå•ç‹¬æˆä¸ºä¸€ä¸ªæ•°ç»„</span></span><br><span class="line">        <span class="title function_ invoke__">array_multisort</span>(<span class="variable">$fieldArr</span>, SORT_ASC, <span class="variable">$array</span>);<span class="comment">//è¿›è¡Œæ’åº</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">var_dump</span>(<span class="variable">$array</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;/pre&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å†’æ³¡æ’åº</span></span><br><span class="line"><span class="comment">     * æ¯”è¾ƒç›¸é‚»çš„å…ƒç´ ã€‚å¦‚æœç¬¬ä¸€ä¸ªæ¯”ç¬¬äºŒä¸ªå¤§ï¼Œå°±äº¤æ¢ä»–ä»¬ä¸¤ä¸ªã€‚</span></span><br><span class="line"><span class="comment">     * å¯¹æ¯ä¸€å¯¹ç›¸é‚»å…ƒç´ ä½œåŒæ ·çš„å·¥ä½œï¼Œä»å¼€å§‹ç¬¬ä¸€å¯¹åˆ°ç»“å°¾çš„æœ€åä¸€å¯¹ã€‚åœ¨è¿™ä¸€ç‚¹ï¼Œæœ€åçš„å…ƒç´ åº”è¯¥ä¼šæ˜¯æœ€å¤§çš„æ•°ã€‚</span></span><br><span class="line"><span class="comment">     * é’ˆå¯¹æ‰€æœ‰çš„å…ƒç´ é‡å¤ä»¥ä¸Šçš„æ­¥éª¤ï¼Œé™¤äº†æœ€åä¸€ä¸ªã€‚</span></span><br><span class="line"><span class="comment">     * æŒç»­æ¯æ¬¡å¯¹è¶Šæ¥è¶Šå°‘çš„å…ƒç´ é‡å¤ä¸Šé¢çš„æ­¥éª¤ï¼Œç›´åˆ°æ²¡æœ‰ä»»ä½•ä¸€å¯¹æ•°å­—éœ€è¦æ¯”è¾ƒã€‚</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $arr</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">bubble</span>(<span class="params"><span class="variable">$arr</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$len</span> = <span class="title function_ invoke__">count</span>(<span class="variable">$arr</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span> - <span class="number">1</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>; <span class="variable">$j</span> &lt; <span class="variable">$len</span> - <span class="number">1</span> - <span class="variable">$i</span>; <span class="variable">$j</span>++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$arr</span>[<span class="variable">$j</span>] &gt; <span class="variable">$arr</span>[<span class="variable">$j</span> + <span class="number">1</span>]) &#123;</span><br><span class="line">                    <span class="variable">$temp</span> = <span class="variable">$arr</span>[<span class="variable">$j</span>];</span><br><span class="line">                    <span class="variable">$arr</span>[<span class="variable">$j</span>] = <span class="variable">$arr</span>[<span class="variable">$j</span> + <span class="number">1</span>];</span><br><span class="line">                    <span class="variable">$arr</span>[<span class="variable">$j</span> + <span class="number">1</span>] = <span class="variable">$temp</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$arr</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¿«é€Ÿæ’åº</span></span><br><span class="line"><span class="comment">     * ä»æ•°åˆ—ä¸­æŒ‘å‡ºä¸€ä¸ªå…ƒç´ ï¼Œç§°ä¸º â€œåŸºå‡†â€ï¼ˆpivotï¼‰ï¼Œ</span></span><br><span class="line"><span class="comment">     * é‡æ–°æ’åºæ•°åˆ—ï¼Œæ‰€æœ‰å…ƒç´ æ¯”åŸºå‡†å€¼å°çš„æ‘†æ”¾åœ¨åŸºå‡†å‰é¢ï¼Œæ‰€æœ‰å…ƒç´ æ¯”åŸºå‡†å€¼å¤§çš„æ‘†åœ¨åŸºå‡†çš„åé¢ï¼ˆç›¸åŒçš„æ•°å¯ä»¥åˆ°ä»»ä¸€è¾¹ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">     * åœ¨è¿™ä¸ªåˆ†åŒºé€€å‡ºä¹‹åï¼Œè¯¥åŸºå‡†å°±å¤„äºæ•°åˆ—çš„ä¸­é—´ä½ç½®ã€‚è¿™ä¸ªç§°ä¸ºåˆ†åŒºï¼ˆpartitionï¼‰æ“ä½œã€‚</span></span><br><span class="line"><span class="comment">     * é€’å½’åœ°ï¼ˆrecursiveï¼‰æŠŠå°äºåŸºå‡†å€¼å…ƒç´ çš„å­æ•°åˆ—å’Œå¤§äºåŸºå‡†å€¼å…ƒç´ çš„å­æ•°åˆ—æ’åºã€‚</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $arr</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">quick</span>(<span class="params"><span class="variable">$arr</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$len</span> = <span class="title function_ invoke__">count</span>(<span class="variable">$arr</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$len</span> &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$arr</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$baseNum</span> = <span class="variable">$arr</span>[<span class="number">0</span>];</span><br><span class="line">        <span class="variable">$leftArray</span> = <span class="variable">$rightArray</span> = [];</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">1</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$baseNum</span> &gt; <span class="variable">$arr</span>[<span class="variable">$i</span>]) &#123;</span><br><span class="line">                <span class="variable">$leftArray</span>[] = <span class="variable">$arr</span>[<span class="variable">$i</span>];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$rightArray</span>[] = <span class="variable">$arr</span>[<span class="variable">$i</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$leftArray</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">quick</span>(<span class="variable">$leftArray</span>);</span><br><span class="line">        <span class="variable">$rightArray</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">quick</span>(<span class="variable">$rightArray</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">array_merge</span>(<span class="variable">$leftArray</span>, <span class="keyword">array</span>(<span class="variable">$baseNum</span>), <span class="variable">$rightArray</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€‰æ‹©æ’åº</span></span><br><span class="line"><span class="comment">     * é¦–å…ˆåœ¨æœªæ’åºåºåˆ—ä¸­æ‰¾åˆ°æœ€å°å…ƒç´ ï¼Œå­˜æ”¾åˆ°æ’åºåºåˆ—çš„èµ·å§‹ä½ç½®ï¼Œ</span></span><br><span class="line"><span class="comment">     * ç„¶åï¼Œå†ä»å‰©ä½™æœªæ’åºå…ƒç´ ä¸­ç»§ç»­å¯»æ‰¾æœ€å°å…ƒç´ ï¼Œ</span></span><br><span class="line"><span class="comment">     * ç„¶åæ”¾åˆ°æ’åºåºåˆ—æœ«å°¾ã€‚ä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°æ‰€æœ‰å…ƒç´ å‡æ’åºå®Œæ¯•ã€‚</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $arr</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">select</span>(<span class="params"><span class="variable">$arr</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// å¤–å±‚æ§åˆ¶æ¬¡æ•° å†…å±‚æ§åˆ¶æ¬¡æ•°</span></span><br><span class="line">        <span class="variable">$len</span> = <span class="title function_ invoke__">count</span>(<span class="variable">$arr</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span> - <span class="number">1</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="comment">// è®¾ç½®æœ€å°å€¼çš„ä½ç½®</span></span><br><span class="line">            <span class="variable">$p</span> = <span class="variable">$i</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="variable">$i</span> + <span class="number">1</span>; <span class="variable">$j</span> &lt; <span class="variable">$len</span>; <span class="variable">$j</span>++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$arr</span>[<span class="variable">$p</span>] &gt; <span class="variable">$arr</span>[<span class="variable">$j</span>]) &#123;</span><br><span class="line">                    <span class="comment">// å‘ç°æ›´å°çš„å€¼, ä¿®æ”¹æœ€å°çš„å€¼çš„ä½ç½®</span></span><br><span class="line">                    <span class="variable">$p</span> = <span class="variable">$j</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$p</span> != <span class="variable">$i</span>) &#123;</span><br><span class="line">                <span class="variable">$temp</span> = <span class="variable">$arr</span>[<span class="variable">$p</span>];</span><br><span class="line">                <span class="variable">$arr</span>[<span class="variable">$p</span>] = <span class="variable">$arr</span>[<span class="variable">$i</span>];</span><br><span class="line">                <span class="variable">$arr</span>[<span class="variable">$i</span>] = <span class="variable">$temp</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$arr</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ’å…¥æ’åº</span></span><br><span class="line"><span class="comment">     * ä»ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œè¯¥å…ƒç´ å¯ä»¥è®¤ä¸ºå·²ç»è¢«æ’åº</span></span><br><span class="line"><span class="comment">     * å–å‡ºä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œåœ¨å·²ç»æ’åºçš„å…ƒç´ åºåˆ—ä¸­ä»åå‘å‰æ‰«æ</span></span><br><span class="line"><span class="comment">     * å¦‚æœè¯¥å…ƒç´ ï¼ˆå·²æ’åºï¼‰å¤§äºæ–°å…ƒç´ ï¼Œå°†è¯¥å…ƒç´ ç§»åˆ°ä¸‹ä¸€ä½ç½®</span></span><br><span class="line"><span class="comment">     * é‡å¤æ­¥éª¤3ï¼Œç›´åˆ°æ‰¾åˆ°å·²æ’åºçš„å…ƒç´ å°äºæˆ–è€…ç­‰äºæ–°å…ƒç´ çš„ä½ç½®</span></span><br><span class="line"><span class="comment">     * å°†æ–°å…ƒç´ æ’å…¥åˆ°è¯¥ä½ç½®ä¸­</span></span><br><span class="line"><span class="comment">     * é‡å¤æ­¥éª¤2</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $arr</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">insert</span>(<span class="params"><span class="variable">$arr</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$len</span> = <span class="title function_ invoke__">count</span>(<span class="variable">$arr</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">1</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$temp</span> = <span class="variable">$arr</span>[<span class="variable">$i</span>];</span><br><span class="line">            <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="variable">$i</span> - <span class="number">1</span>; <span class="variable">$j</span> &gt;= <span class="number">0</span>; <span class="variable">$j</span>--) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$temp</span> &lt; <span class="variable">$arr</span>[<span class="variable">$j</span>]) &#123;</span><br><span class="line">                    <span class="variable">$arr</span>[<span class="variable">$j</span> + <span class="number">1</span>] = <span class="variable">$arr</span>[<span class="variable">$j</span>];</span><br><span class="line">                    <span class="variable">$arr</span>[<span class="variable">$j</span>] = <span class="variable">$temp</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$arr</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * äºŒåˆ†æŸ¥æ‰¾ è¦æ±‚çº¿æ€§è¡¨å¿…é¡»é‡‡ç”¨é¡ºåºå­˜å‚¨ç»“æ„ï¼Œè€Œä¸”è¡¨ä¸­å…ƒç´ æŒ‰å…³é”®å­—æœ‰åºæ’åˆ—ã€‚</span></span><br><span class="line"><span class="comment">     * å…ˆå–æ•°ç»„ä¸­é—´çš„å€¼floor((low+top)/2),</span></span><br><span class="line"><span class="comment">     * ç„¶åé€šè¿‡ä¸æ‰€éœ€æŸ¥æ‰¾çš„æ•°å­—è¿›è¡Œæ¯”è¾ƒï¼Œè‹¥æ¯”ä¸­é—´å€¼å¤§ï¼Œåˆ™å°†é¦–å€¼æ›¿æ¢ä¸ºä¸­é—´ä½ç½®ä¸‹ä¸€ä¸ªä½ç½®ï¼Œç»§ç»­ç¬¬ä¸€æ­¥çš„æ“ä½œï¼›</span></span><br><span class="line"><span class="comment">     * è‹¥æ¯”ä¸­é—´å€¼å°ï¼Œåˆ™å°†å°¾å€¼æ›¿æ¢ä¸ºä¸­é—´ä½ç½®ä¸Šä¸€ä¸ªä½ç½®ï¼Œç»§ç»­ç¬¬ä¸€æ­¥æ“ä½œ</span></span><br><span class="line"><span class="comment">     * é‡å¤ç¬¬äºŒæ­¥æ“ä½œç›´è‡³æ‰¾å‡ºç›®æ ‡æ•°å­—</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $arr</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $low</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $top</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> $target</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> int</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">binary</span>(<span class="params">&amp;<span class="variable">$arr</span>, <span class="variable">$low</span>, <span class="variable">$top</span>, <span class="variable">$target</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="variable">$low</span> &lt;= <span class="variable">$top</span>) &#123;</span><br><span class="line">            <span class="variable">$mid</span> = <span class="title function_ invoke__">intval</span>((<span class="variable">$low</span> + <span class="variable">$top</span>) / <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$arr</span>[<span class="variable">$mid</span>] == <span class="variable">$target</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$mid</span>;</span><br><span class="line">            &#125; <span class="keyword">elseif</span> (<span class="variable">$arr</span>[<span class="variable">$mid</span>] &lt; <span class="variable">$target</span>) &#123;</span><br><span class="line">                <span class="variable">$low</span> = <span class="variable">$mid</span> + <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$top</span> = <span class="variable">$mid</span> - <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœç´¢å¼•æ“å­—ç¬¦ä¸²å¤„ç†</title>
      <link href="/posts/340c4b8f.html"/>
      <url>/posts/340c4b8f.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(E_ERROR);</span><br><span class="line"><span class="variable">$input</span>=<span class="string">&quot;php -é”€å”®  +å®¢æœ   + java      å¹³é¢,ç¾å·¥ é…’åº— ,æ±½è½¦&quot;</span>;</span><br><span class="line"><span class="variable">$input</span>=<span class="string">&quot;php +é”€å”®  +å®¢æœ   + java      å¹³é¢,ç¾å·¥ é…’åº— ,æ±½è½¦&quot;</span>;</span><br><span class="line"><span class="variable">$input</span>=<span class="string">&quot;++--php -,é”€å”®  -,-+,+å®¢æœ   +, java      å¹³é¢,ç¾å·¥ é…’åº— ,æ±½è½¦--++|&quot;</span>;</span><br><span class="line"><span class="variable">$input</span>=<span class="string">&quot;++--php -,é”€å”®  -,-+,+\&quot;å®¢æœ\&quot;   +, java      å¹³é¢,ç¾å·¥ é…’åº— ,æ±½è½¦--++| &quot;</span>;</span><br><span class="line"><span class="comment">/*å°†å…¶è½¬åŒ–æˆ</span></span><br><span class="line"><span class="comment">+&quot;php&quot;-&quot;é”€å”®&quot;+&quot;å®¢æœ&quot;+&quot;java&quot;|&quot;å¹³é¢&quot;|&quot;ç¾å·¥&quot;|&quot;é…’åº—&quot;|&quot;æ±½è½¦&quot;</span></span><br><span class="line"><span class="comment">æ³¨æ„ï¼Œ$inputä¸­çš„ç©ºæ ¼æ˜¯ä¸å®šé•¿çš„</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="variable">$t1</span>=<span class="title function_ invoke__">microtime</span>(<span class="literal">true</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">1000</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">    <span class="variable">$s</span>=<span class="title function_ invoke__">queryFormat</span>(<span class="variable">$input</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$t2</span>=<span class="title function_ invoke__">microtime</span>(<span class="literal">true</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;<span class="subst">$s</span>&lt;br&gt;&quot;</span>.(<span class="variable">$t2</span>-<span class="variable">$t1</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*åªå†™å‡½æ•°ä½“ï¼Œä¸Šé¢çš„å†…å®¹ä¸è¦æ”¹å˜*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">queryFormat</span>(<span class="params"><span class="variable">$input</span></span>)</span>&#123;</span><br><span class="line">    <span class="comment">// åªè·å–æŒ‡å®šç±»å‹æ•°æ®</span></span><br><span class="line">    <span class="variable">$input</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/([^\x&#123;4e00&#125;-\x&#123;9fa5&#125;A-Za-z0-9-+]+)/u&quot;</span>, <span class="string">&#x27; &#x27;</span>, <span class="variable">$input</span>);</span><br><span class="line">    <span class="comment">// |,åªåŒ¹é…é€—å·</span></span><br><span class="line">    <span class="variable">$input</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/(\-|\+)(\+|\-|,|\s)*/u&quot;</span>, <span class="string">&#x27;$&#123;1&#125;&#x27;</span>, <span class="variable">$input</span>);</span><br><span class="line">    <span class="variable">$input</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/([\x&#123;4e00&#125;-\x&#123;9fa5&#125;A-Za-z0-9]+)/u&quot;</span>, <span class="string">&#x27;&quot;$&#123;1&#125;&quot;&#x27;</span>, <span class="variable">$input</span>);</span><br><span class="line">    <span class="variable">$input</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/(\&quot;)+(\s)+(\&quot;)+/u&quot;</span>, <span class="string">&#x27;&quot;|&quot;&#x27;</span>, <span class="variable">$input</span>);</span><br><span class="line">    <span class="variable">$input</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/\s+/&quot;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$input</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$input</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯¼å‡ºexcel</title>
      <link href="/posts/1f70a410.html"/>
      <url>/posts/1f70a410.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">Class excelExport</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¯¼å‡ºexcel</span></span><br><span class="line"><span class="comment">     * windowsé»˜è®¤ä¸ºASNIç¼–ç ã€‚å½“é‡åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¸æ˜¯unicodeçš„æ—¶å€™ï¼Œå°±ç”¨é»˜è®¤è¯­è¨€ç¼–ç è§£é‡Šã€‚</span></span><br><span class="line"><span class="comment">     * å¦‚æœå‡ºç°ä¸­æ–‡ä¹±ç ï¼Œä½¿ç”¨ASNIç¼–ç å°è¯•.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">export</span>(<span class="params"><span class="variable">$v</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$data</span> = <span class="string">&quot;ID,å¹´æœˆ,å•†å®¶,å½“æœˆå¾…æ”¶æ¬¾&quot;</span> . <span class="string">&quot;\n&quot;</span>;<span class="comment">//è¡¨å¤´</span></span><br><span class="line">        <span class="variable">$data</span> .= <span class="variable">$v</span>[<span class="string">&#x27;rece&#x27;</span>][<span class="string">&#x27;id&#x27;</span>] . <span class="string">&quot;,&quot;</span> . <span class="variable">$v</span>[<span class="string">&#x27;rece&#x27;</span>][<span class="string">&#x27;pay_date&#x27;</span>] . <span class="string">&quot;,&quot;</span> . <span class="variable">$v</span>[<span class="string">&#x27;vend_org&#x27;</span>][<span class="string">&#x27;org_name&#x27;</span>] . <span class="string">&quot;,&quot;</span> . <span class="variable">$v</span>[<span class="string">&#x27;rece&#x27;</span>][<span class="string">&#x27;pay_amt&#x27;</span>] . <span class="string">&quot;\n&quot;</span>;<span class="comment">//è¡¨èº«æ•°æ®</span></span><br><span class="line">        <span class="variable">$name</span> = <span class="title function_ invoke__">iconv</span>(<span class="string">&#x27;utf-8&#x27;</span>, <span class="string">&#x27;gb2312&#x27;</span>, <span class="string">&#x27;filename&#x27;</span>);</span><br><span class="line">        <span class="variable">$filename</span> = <span class="variable">$name</span> . <span class="title function_ invoke__">date</span>(<span class="string">&#x27;Ymd&#x27;</span>, <span class="title function_ invoke__">time</span>()) . <span class="string">&quot;.csv&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-type:text/csv; charset=utf-8&quot;</span>);</span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Disposition:attachment;filename=&quot;</span> . <span class="variable">$filename</span>);</span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Cache-Control:must-revalidate,post-check=0,pre-check=0&#x27;</span>);</span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Expires:0&#x27;</span>);</span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Pragma:public&#x27;</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$data</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–‡ä»¶äºŒè¿›åˆ¶è¾“å‡º</title>
      <link href="/posts/f7a6ead2.html"/>
      <url>/posts/f7a6ead2.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ–‡ä»¶äºŒè¿›åˆ¶è¾“å‡º</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="variable">$fileName</span>=<span class="string">&quot;a.txt&quot;</span>;</span><br><span class="line"><span class="variable">$handle</span>=<span class="title function_ invoke__">fopen</span>(<span class="variable">$fileName</span>,<span class="string">&quot;r&quot;</span>);<span class="comment">//ä½¿ç”¨æ‰“å¼€æ¨¡å¼ä¸ºr</span></span><br><span class="line"><span class="variable">$content</span>=<span class="title function_ invoke__">fread</span>(<span class="variable">$handle</span>,<span class="title function_ invoke__">filesize</span>(<span class="variable">$fileName</span>));<span class="comment">//è¯»ä¸ºäºŒè¿›åˆ¶</span></span><br><span class="line"><span class="variable">$hex</span> = <span class="title function_ invoke__">bin2hex</span>(<span class="variable">$content</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$hex</span>); <span class="variable">$i</span> = <span class="variable">$i</span>+<span class="number">2</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$i</span> != <span class="number">0</span> &amp;&amp; <span class="variable">$i</span> % <span class="number">16</span> == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">substr</span>(<span class="variable">$hex</span>, <span class="variable">$i</span>, <span class="number">2</span>).<span class="string">&#x27; &#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¨è¾‰ä¸‰è§’</title>
      <link href="/posts/4ee864f8.html"/>
      <url>/posts/4ee864f8.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ¨ä¼šä¸‰è§’</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $n</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $k</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> int</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bio</span>(<span class="params"><span class="variable">$n</span>, <span class="variable">$k</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$k</span> == <span class="number">1</span> || <span class="variable">$n</span> == <span class="variable">$k</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">bio</span>(<span class="variable">$n</span>-<span class="number">1</span>, <span class="variable">$k</span>) + <span class="title function_ invoke__">bio</span>(<span class="variable">$n</span>-<span class="number">1</span>, <span class="variable">$k</span>-<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">yanghui</span>(<span class="params"><span class="variable">$row</span>=<span class="number">5</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">1</span>; <span class="variable">$i</span> &lt; <span class="variable">$row</span>+<span class="number">1</span>; ++<span class="variable">$i</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$j</span> = <span class="number">1</span>; <span class="variable">$j</span> &lt;= <span class="variable">$i</span>; ++<span class="variable">$j</span>)</span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">bio</span>(<span class="variable">$i</span>, <span class="variable">$j</span>).<span class="string">&quot;&amp;nbsp;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br /&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">yanghui</span>(<span class="number">5</span>);<span class="comment">//è¾“å‡º5è¡Œ ;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç±»ä¸­ä½¿ç”¨å›è°ƒ</title>
      <link href="/posts/5e9f4fa3.html"/>
      <url>/posts/5e9f4fa3.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç±»ä¸­ä½¿ç”¨å›è°ƒ</span></span><br><span class="line"><span class="comment"> * Class callbackTest</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">callbackTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span> (<span class="params"><span class="variable">$array</span></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// è°ƒç”¨è‡ªèº«æ–¹æ³•$thisï¼Œè°ƒç”¨æŒ‡å®šclassçš„æ–¹æ³•[&#x27;æŒ‡å®šclass&#x27;]</span></span><br><span class="line">        <span class="title function_ invoke__">array_reduce</span>(<span class="variable">$array</span>, [<span class="variable">$this</span>, <span class="string">&#x27;callback&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">callback</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">//pass</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç”ŸæˆæŒ‡å®šä½æ•°çš„éšæœºæ•°</title>
      <link href="/posts/1fcb6e41.html"/>
      <url>/posts/1fcb6e41.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”ŸæˆæŒ‡å®šä½æ•°çš„éšæœºæ•°</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int $length</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> int</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">generate_code</span>(<span class="params"><span class="variable">$length</span> = <span class="number">4</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">rand</span>(<span class="title function_ invoke__">pow</span>(<span class="number">10</span>,(<span class="variable">$length</span>-<span class="number">1</span>)), <span class="title function_ invoke__">pow</span>(<span class="number">10</span>,<span class="variable">$length</span>)-<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è·å–ç±»ä»¥åŠå†…éƒ¨æ–¹æ³•çš„æ³¨é‡Š</title>
      <link href="/posts/6017eac7.html"/>
      <url>/posts/6017eac7.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * phpè·å–ç±»ä»¥åŠå†…éƒ¨æ–¹æ³•çš„æ³¨é‡Š</span></span><br><span class="line"><span class="comment"> * This is an Example class</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Example</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * This is an example function</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@array</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// void</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@This</span> is an a function</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// void</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è·å–classæ³¨é‡Šå’Œæ–¹æ³•çš„æ³¨é‡Š</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@response</span> array</span></span><br><span class="line"><span class="comment"> * Array</span></span><br><span class="line"><span class="comment">(</span></span><br><span class="line"><span class="comment">[funcName] =&gt; Array</span></span><br><span class="line"><span class="comment">(</span></span><br><span class="line"><span class="comment">[0] =&gt; param string</span></span><br><span class="line"><span class="comment">[1] =&gt; array array</span></span><br><span class="line"><span class="comment">)</span></span><br><span class="line"><span class="comment">)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getDocCommentParams</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$class</span> = <span class="string">&#x27;Example&#x27;</span>;<span class="comment">//ç±»çš„åå­—</span></span><br><span class="line">    <span class="variable">$reflector</span> = <span class="keyword">new</span> <span class="title class_">ReflectionClass</span>(<span class="variable">$class</span>);<span class="comment">//</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// to get the Class DocBlock</span></span><br><span class="line">    <span class="variable">$methods</span> = <span class="variable">$reflector</span>-&gt;<span class="title function_ invoke__">getMethods</span>();</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$methods</span> <span class="keyword">as</span> <span class="variable">$value</span>)&#123;</span><br><span class="line">        <span class="variable">$funcName</span>[] = (<span class="keyword">array</span>)<span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$funcName</span> <span class="keyword">as</span> <span class="variable">$value</span>)&#123;</span><br><span class="line">        <span class="comment">// to get the Method DocBlock</span></span><br><span class="line">        <span class="variable">$doc</span> = <span class="variable">$reflector</span>-&gt;<span class="title function_ invoke__">getMethod</span>(<span class="variable">$value</span>[<span class="string">&#x27;name&#x27;</span>])-&gt;<span class="title function_ invoke__">getDocComment</span>();<span class="comment">//è·å–classå†…çš„æ–¹æ³•çš„æ³¨é‡Š $value[&#x27;name&#x27;]æ–¹æ³•çš„åå­—</span></span><br><span class="line">        <span class="variable">$falg</span> = <span class="title function_ invoke__">matchDocComment</span>(<span class="variable">$doc</span>,<span class="variable">$value</span>[<span class="string">&#x27;name&#x27;</span>],<span class="string">&#x27;@&#x27;</span>);<span class="comment">//æ–¹æ³•æ³¨é‡Šä¸­çš„å‚æ•°</span></span><br><span class="line">        <span class="title function_ invoke__">print_r</span>(<span class="variable">$falg</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br /&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$reflector</span>-&gt;<span class="title function_ invoke__">getDocComment</span>();<span class="comment">//è·å–classçš„æ³¨é‡Š</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é€šè¿‡æ­£åˆ™è·å–å‚æ•°ï¼š<span class="doctag">@param</span> string -&gt; echo param string</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@str</span> string æ³¨é‡Šå†…å®¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@tag</span> string åŒ¹é…çš„æ•°æ®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">matchDocComment</span>(<span class="params"><span class="variable">$str</span>, <span class="variable">$methodName</span>, <span class="variable">$tag</span> = <span class="string">&#x27;&#x27;</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$tag</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$str</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$matches</span> = <span class="keyword">array</span>();</span><br><span class="line">    <span class="title function_ invoke__">preg_match_all</span>(<span class="string">&quot;/&quot;</span>.<span class="variable">$tag</span>.<span class="string">&quot;(.*)(\\r\\n|\\r|\\n)/&quot;</span>, <span class="variable">$str</span>, <span class="variable">$matches</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$matches</span>[<span class="number">1</span>]))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable">$matches</span>[<span class="number">1</span>] <span class="keyword">as</span> <span class="variable">$param</span>)&#123;</span><br><span class="line">            <span class="variable">$params</span>[<span class="variable">$methodName</span>][] = <span class="title function_ invoke__">trim</span>(<span class="variable">$param</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$params</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é”™è¯¯ä¸å¼‚å¸¸å¤„ç†</title>
      <link href="/posts/4fe082bb.html"/>
      <url>/posts/4fe082bb.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="PHPé”™è¯¯ä¸å¼‚å¸¸å¤„ç†"><a href="#PHPé”™è¯¯ä¸å¼‚å¸¸å¤„ç†" class="headerlink" title="PHPé”™è¯¯ä¸å¼‚å¸¸å¤„ç†"></a>PHPé”™è¯¯ä¸å¼‚å¸¸å¤„ç†</h1><p>æ²¡æœ‰ç‰¹æ®Šè¯´æ˜ï¼šæœ¬ä¾‹ PHP Version &lt; 7<br>è¯´èµ·PHPå¼‚å¸¸å¤„ç†ï¼Œå¤§å®¶é¦–å…ˆä¼šæƒ³åˆ°try-catchï¼Œé‚£å¥½ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€æ®µç¨‹åºå§ï¼šæœ‰ä¸€ä¸ªtest.phpæ–‡ä»¶ï¼Œæœ‰ä¸€æ®µç®€å•çš„PHPç¨‹åºï¼Œå†…å®¹å¦‚ä¸‹ï¼Œç„¶åå‘½ä»¤è¡Œæ‰§è¡Œï¼šphp test.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$num</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">         <span class="keyword">echo</span> <span class="number">1</span>/<span class="variable">$num</span>;</span><br><span class="line">    </span><br><span class="line">     &#125; <span class="keyword">catch</span> (<span class="built_in">Exception</span> <span class="variable">$e</span>)&#123;</span><br><span class="line">         <span class="keyword">echo</span> <span class="variable">$e</span>-&gt;<span class="title function_ invoke__">getMessage</span>();</span><br><span class="line">     &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><ul><li>ä¸€ã€å¼‚å¸¸ä¸é”™è¯¯çš„æ¦‚è¿°</li><li>äºŒã€ERRORçš„çº§åˆ«</li><li>ä¸‰ã€PHPå¼‚å¸¸å¤„ç†ä¸­çš„é»‘ç§‘æŠ€</li><li>å››ã€å·§å¦™çš„æ•è·é”™è¯¯å’Œå¼‚å¸¸</li><li>äº”ã€è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†å’Œå¼‚å¸¸åµŒå¥—</li><li>å…­ã€PHP7ä¸­çš„å¼‚å¸¸å¤„ç†</li></ul><h2 id="ä¸€ã€å¼‚å¸¸ä¸é”™è¯¯çš„æ¦‚è¿°"><a href="#ä¸€ã€å¼‚å¸¸ä¸é”™è¯¯çš„æ¦‚è¿°" class="headerlink" title="ä¸€ã€å¼‚å¸¸ä¸é”™è¯¯çš„æ¦‚è¿°"></a>ä¸€ã€å¼‚å¸¸ä¸é”™è¯¯çš„æ¦‚è¿°</h2><p>   PHPä¸­ä»€ä¹ˆæ˜¯å¼‚å¸¸ï¼š<br>   ç¨‹åºåœ¨è¿è¡Œä¸­å‡ºç°ä¸ç¬¦åˆé¢„æœŸçš„æƒ…å†µï¼Œå…è®¸å‘ç”Ÿï¼ˆä½ ä¹Ÿä¸æƒ³è®©ä»–å‡ºç°ä¸æ­£å¸¸çš„æƒ…å†µï¼‰ä½†ä»–æ˜¯ä¸€ç§ä¸æ­£å¸¸çš„æƒ…å†µï¼ŒæŒ‰ç…§æˆ‘ä»¬çš„æ­£å¸¸é€»è¾‘æœ¬ä¸è¯¥å‡ºçš„é”™è¯¯ï¼Œ<br>   ä½†ä»ç„¶ä¼šå‡ºç°çš„é”™è¯¯ï¼Œå±äºé€»è¾‘å’Œä¸šåŠ¡æµç¨‹çš„é”™è¯¯ï¼Œè€Œä¸æ˜¯ç¼–è¯‘æˆ–è€…è¯­æ³•ä¸Šçš„é”™è¯¯ã€‚  </p><p>ã€€ã€€PHPä¸­ä»€ä¹ˆæ˜¯é”™è¯¯ï¼š<br>ã€€ã€€å±äºphpè„šæœ¬è‡ªèº«çš„é—®é¢˜ï¼Œå¤§éƒ¨åˆ†æƒ…å†µæ˜¯ç”±é”™è¯¯çš„è¯­æ³•ï¼ŒæœåŠ¡å™¨ç¯å¢ƒå¯¼è‡´ï¼Œä½¿å¾—ç¼–è¯‘å™¨æ— æ³•é€šè¿‡æ£€æŸ¥ï¼Œç”šè‡³æ— æ³•è¿è¡Œçš„æƒ…å†µã€‚warningã€noticeéƒ½æ˜¯é”™è¯¯ï¼Œ<br>   åªæ˜¯ä»–ä»¬çš„çº§åˆ«ä¸åŒè€Œå·²ï¼Œå¹¶ä¸”é”™è¯¯æ˜¯ä¸èƒ½è¢«try-catchæ•è·çš„ã€‚  </p><p>ã€€ã€€ä¸Šé¢çš„è¯´æ³•æ˜¯æœ‰å‰ææ¡ä»¶çš„ï¼š<br>ã€€ã€€åœ¨PHPä¸­ï¼Œå› ä¸ºåœ¨å…¶ä»–è¯­è¨€ä¸­å°±ä¸èƒ½è¿™æ ·ä¸‹ç»“è®ºäº†ï¼Œä¹Ÿå°±æ˜¯è¯´å¼‚å¸¸å’Œé”™è¯¯çš„è¯´æ³•åœ¨ä¸åŒçš„è¯­è¨€æœ‰ä¸åŒçš„è¯´æ³•ã€‚åœ¨PHPä¸­ä»»ä½•è‡ªèº«çš„é”™è¯¯æˆ–è€…æ˜¯éæ­£å¸¸çš„ä»£ç éƒ½ä¼šå½“åšé”™è¯¯å¯¹å¾…ï¼Œå¹¶ä¸ä¼šä»¥å¼‚å¸¸çš„å½¢å¼æŠ›å‡ºï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›æƒ…å†µä¼šå½“åšå¼‚å¸¸å’Œé”™è¯¯åŒæ—¶æŠ›å‡º(æ®è¯´æ˜¯ï¼Œæˆ‘æ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„ä¾‹å­)ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ æƒ³åœ¨æ•°æ®åº“è¿æ¥å¤±è´¥çš„æ—¶å€™è‡ªåŠ¨æ•è·å¼‚å¸¸æ˜¯è¡Œä¸é€šçš„ï¼Œå› ä¸ºè¿™å°±ä¸æ˜¯å¼‚å¸¸ï¼Œæ˜¯é”™è¯¯ã€‚ä½†æ˜¯åœ¨javaä¸­å°±ä¸ä¸€æ ·äº†ï¼Œä»–ä¼šæŠŠå¾ˆå¤šå’Œé¢„æœŸä¸ä¸€è‡´çš„è¡Œä¸ºå½“åšå¼‚å¸¸æ¥è¿›è¡Œæ•è·ã€‚</p><p>ã€€ã€€PHPå¼‚å¸¸å¤„ç†å¾ˆé¸¡è‚‹ï¼Ÿ<br>ã€€ã€€åœ¨ä¸Šé¢çš„åˆ†æä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼ŒPHPå¹¶ä¸èƒ½ä¸»åŠ¨çš„æŠ›å‡ºå¼‚å¸¸ï¼Œä½†æ˜¯ä½ å¯ä»¥æ‰‹åŠ¨æŠ›å‡ºå¼‚å¸¸ï¼Œæ—¢ç„¶èƒ½æ‰‹åŠ¨æŠ›å‡ºå°±è¯æ˜è¿™ä¸ªä¸æ˜¯å¼‚å¸¸ï¼Œè€Œæ˜¯æ„æ–™ä¹‹ä¸­ã€‚ä»¥æˆ‘çš„ç†è§£ï¼Œè¿™å°±æ˜¯PHPå¼‚å¸¸å¤„ç†é¸¡è‚‹çš„åœ°æ–¹ï¼ˆä¸ä¸€å®šå¯¹å•Šï¼‰ã€‚æ‰€ä»¥PHPçš„å¼‚å¸¸æœºåˆ¶ä¸æ˜¯é‚£ä¹ˆçš„å®Œç¾ï¼Œä½†æ˜¯ä½¿ç”¨è¿‡æ¡†æ¶çš„åŒå­¦éƒ½çŸ¥é“æœ‰è¿™ä¸ªæƒ…å†µï¼šä½ åœ¨æ¡†æ¶ä¸­ç›´æ¥å†™å¼€å¤´é‚£æ®µphpâ€œè‡ªåŠ¨â€æ•è·å¼‚å¸¸çš„ä»£ç æ˜¯å¯ä»¥çš„ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿçœ‹è¿‡æºç çš„åŒå­¦éƒ½çŸ¥é“æ¡†æ¶ä¸­éƒ½ä¼šæ¶‰åŠä¸‰ä¸ªå‡½æ•°ï¼šregister_shutdown_functionï¼Œset_error_handlerï¼Œset_exception_handleråé¢æˆ‘ä¼šé‡ç‚¹è®²è§£ç€ä¸‰ä¸ªé»‘ç§‘æŠ€ï¼Œé€šè¿‡è¿™å‡ ä¸ªå‡½æ•°æˆ‘ä»¬å¯ä»¥å®ç°PHPå‡è‡ªåŠ¨æ•è·å¼‚å¸¸å’Œé”™è¯¯ã€‚</p><h2 id="äºŒã€ERRORçš„çº§åˆ«"><a href="#äºŒã€ERRORçš„çº§åˆ«" class="headerlink" title="äºŒã€ERRORçš„çº§åˆ«"></a>äºŒã€ERRORçš„çº§åˆ«</h2><p>ã€€ã€€åªæœ‰ç†Ÿæ‚‰é”™è¯¯çº§åˆ«æ‰èƒ½å¯¹é”™è¯¯æ•æ‰æœ‰æ›´å¥½çš„è®¤è¯†ã€‚ <a href="http://www.cnblogs.com/zyf-zhaoyafei/p/3649434.html">ERRORæœ‰ä¸åŒçš„é”™è¯¯çº§åˆ«</a><br>ã€€ã€€ä¸‹é¢æˆ‘å†æ€»ç»“æ€§çš„ç»™å‡ºè¿™å‡ ç±»é”™è¯¯çº§åˆ«ï¼š</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Fatal <span class="keyword">Error</span>:è‡´å‘½é”™è¯¯ï¼ˆè„šæœ¬ç»ˆæ­¢è¿è¡Œï¼‰</span><br><span class="line">E_ERROR         <span class="comment">// è‡´å‘½çš„è¿è¡Œé”™è¯¯ï¼Œé”™è¯¯æ— æ³•æ¢å¤ï¼Œæš‚åœæ‰§è¡Œè„šæœ¬</span></span><br><span class="line">E_CORE_ERROR    <span class="comment">// PHPå¯åŠ¨æ—¶åˆå§‹åŒ–è¿‡ç¨‹ä¸­çš„è‡´å‘½é”™è¯¯</span></span><br><span class="line">E_COMPILE_ERROR <span class="comment">// ç¼–è¯‘æ—¶è‡´å‘½æ€§é”™ï¼Œå°±åƒç”±Zendè„šæœ¬å¼•æ“ç”Ÿæˆäº†ä¸€ä¸ªE_ERROR</span></span><br><span class="line">E_USER_ERROR    <span class="comment">// è‡ªå®šä¹‰é”™è¯¯æ¶ˆæ¯ã€‚åƒç”¨PHPå‡½æ•°trigger_errorï¼ˆé”™è¯¯ç±»å‹è®¾ç½®ä¸ºï¼šE_USER_ERRORï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Parse</span> <span class="keyword">Error</span>ï¼šç¼–è¯‘æ—¶è§£æé”™è¯¯ï¼Œè¯­æ³•é”™è¯¯ï¼ˆè„šæœ¬ç»ˆæ­¢è¿è¡Œï¼‰</span><br><span class="line">E_PARSE  <span class="comment">//ç¼–è¯‘æ—¶çš„è¯­æ³•è§£æé”™è¯¯</span></span><br><span class="line"></span><br><span class="line">Warning <span class="keyword">Error</span>ï¼šè­¦å‘Šé”™è¯¯ï¼ˆä»…ç»™å‡ºæç¤ºä¿¡æ¯ï¼Œè„šæœ¬ä¸ç»ˆæ­¢è¿è¡Œï¼‰</span><br><span class="line">E_WARNING         <span class="comment">// è¿è¡Œæ—¶è­¦å‘Š (éè‡´å‘½é”™è¯¯)ã€‚</span></span><br><span class="line">E_CORE_WARNING    <span class="comment">// PHPåˆå§‹åŒ–å¯åŠ¨è¿‡ç¨‹ä¸­å‘ç”Ÿçš„è­¦å‘Š (éè‡´å‘½é”™è¯¯) ã€‚</span></span><br><span class="line">E_COMPILE_WARNING <span class="comment">// ç¼–è¯‘è­¦å‘Š</span></span><br><span class="line">E_USER_WARNING    <span class="comment">// ç”¨æˆ·äº§ç”Ÿçš„è­¦å‘Šä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line">Notice <span class="keyword">Error</span>ï¼šé€šçŸ¥é”™è¯¯ï¼ˆä»…ç»™å‡ºé€šçŸ¥ä¿¡æ¯ï¼Œè„šæœ¬ä¸ç»ˆæ­¢è¿è¡Œï¼‰</span><br><span class="line">E_NOTICE      <span class="comment">// è¿è¡Œæ—¶é€šçŸ¥ã€‚è¡¨ç¤ºè„šæœ¬é‡åˆ°å¯èƒ½ä¼šè¡¨ç°ä¸ºé”™è¯¯çš„æƒ…å†µ.</span></span><br><span class="line">E_USER_NOTICE <span class="comment">// ç”¨æˆ·äº§ç”Ÿçš„é€šçŸ¥ä¿¡æ¯ã€‚</span></span><br><span class="line"></span><br><span class="line">ç”±æ­¤å¯çŸ¥æœ‰5ç±»æ˜¯äº§ç”Ÿ<span class="keyword">ERROR</span>çº§åˆ«çš„é”™è¯¯ï¼Œè¿™ç§é”™è¯¯ç›´æ¥å¯¼è‡´PHPç¨‹åºé€€å‡ºã€‚  </span><br><span class="line">å¯ä»¥å®šä¹‰æˆï¼š  </span><br><span class="line"><span class="keyword">ERROR</span> = E_ERROR | E_CORE_ERROR |  E_COMPILE_ERROR | E_USER_ERROR | E_PARSE</span><br></pre></td></tr></table></figure><h2 id="ä¸‰ã€PHPå¼‚å¸¸å¤„ç†ä¸­çš„é»‘ç§‘æŠ€"><a href="#ä¸‰ã€PHPå¼‚å¸¸å¤„ç†ä¸­çš„é»‘ç§‘æŠ€" class="headerlink" title="ä¸‰ã€PHPå¼‚å¸¸å¤„ç†ä¸­çš„é»‘ç§‘æŠ€"></a>ä¸‰ã€PHPå¼‚å¸¸å¤„ç†ä¸­çš„é»‘ç§‘æŠ€</h2><p>ã€€ã€€å‰é¢æåˆ°æ¡†æ¶ä¸­æ˜¯å¯ä»¥æ•è·æ‰€æœ‰çš„é”™è¯¯å’Œå¼‚å¸¸çš„ï¼Œä¹‹æ‰€ä»¥èƒ½å®ç°åº”è¯¥æ˜¯ä½¿ç”¨äº†é»‘ç§‘æŠ€ï¼Œå“ˆå“ˆï¼å…¶å®ä¹Ÿä¸æ˜¯ä»€ä¹ˆé»‘ç§‘æŠ€ï¼Œä¸»è¦æ˜¯ä¸‰ä¸ªé‡è¦çš„å‡½æ•°ï¼š  </p><p>ã€€ã€€1ï¼šset_error_handler()<br>ã€€ã€€çœ‹åˆ°è¿™ä¸ªåå­—ä¼°è®¡å°±çŸ¥é“ä»€ä¹ˆæ„æ€äº†ï¼Œè¿™ä¸ªå‡½æ•°ç”¨äºæ•è·é”™è¯¯ï¼Œè®¾ç½®ä¸€ä¸ªç”¨æˆ·è‡ªå®šä¹‰çš„é”™è¯¯å¤„ç†å‡½æ•°ã€‚  </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">set_error_handler</span>(<span class="string">&#x27;zyferror&#x27;</span>);</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">zyferror</span>(<span class="params"><span class="variable">$type</span>, <span class="variable">$message</span>, <span class="variable">$file</span>, <span class="variable">$line</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    ã€€ã€€<span class="title function_ invoke__">var_dump</span>(<span class="string">&#x27;&lt;b&gt;set_error_handler: &#x27;</span> . <span class="variable">$type</span> . <span class="string">&#x27;:&#x27;</span> . <span class="variable">$message</span> . <span class="string">&#x27; in &#x27;</span> . <span class="variable">$file</span> . <span class="string">&#x27; on &#x27;</span> . <span class="variable">$line</span> . <span class="string">&#x27; line .&lt;/b&gt;&lt;br /&gt;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ã€€ã€€å½“ç¨‹åºå‡ºç°é”™è¯¯çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨æ­¤æ–¹æ³•ï¼Œä¸è¿‡éœ€è¦æ³¨æ„ä¸€ä¸‹ä¸¤ç‚¹ï¼šç¬¬ä¸€ï¼Œå¦‚æœå­˜åœ¨è¯¥æ–¹æ³•ï¼Œç›¸åº”çš„error_reporting()å°±ä¸èƒ½åœ¨ä½¿ç”¨äº†ã€‚æ‰€æœ‰çš„é”™è¯¯éƒ½ä¼šäº¤ç»™è‡ªå®šä¹‰çš„å‡½æ•°å¤„ç†ã€‚ç¬¬äºŒï¼Œæ­¤æ–¹æ³•ä¸èƒ½å¤„ç†ä»¥ä¸‹çº§åˆ«çš„é”™è¯¯ï¼šE_ERRORã€ E_PARSEã€ E_CORE_ERRORã€ E_CORE_WARNINGã€ E_COMPILE_ERRORã€ E_COMPILE_WARNINGï¼Œset_error_handler() å‡½æ•°æ‰€åœ¨æ–‡ä»¶ä¸­äº§ç”Ÿçš„E_STRICTï¼Œè¯¥å‡½æ•°åªèƒ½æ•è·ç³»ç»Ÿäº§ç”Ÿçš„ä¸€äº›Warningã€Noticeçº§åˆ«çš„é”™è¯¯ã€‚<br>ã€€ã€€å¹¶ä¸”ä»–æœ‰å¤šç§è°ƒç”¨çš„æ–¹æ³•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">     <span class="comment">// ç›´æ¥ä¼ å‡½æ•°å NonClassFunction</span></span><br><span class="line">     <span class="title function_ invoke__">set_error_handler</span>(<span class="string">&#x27;function_name&#x27;</span>); </span><br><span class="line"></span><br><span class="line">     <span class="comment">// ä¼  class_name &amp;&amp; function_name</span></span><br><span class="line">     <span class="title function_ invoke__">set_error_handler</span>(<span class="keyword">array</span>(<span class="string">&#x27;class_name&#x27;</span>, <span class="string">&#x27;function_name&#x27;</span>)); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p> ã€€ã€€2ï¼šregister_shutdown_function()<br>ã€€ã€€æ•è·PHPçš„é”™è¯¯ï¼šFatal Errorã€Parse Errorç­‰ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯PHPè„šæœ¬æ‰§è¡Œç»“æŸå‰æœ€åä¸€ä¸ªè°ƒç”¨çš„å‡½æ•°ï¼Œæ¯”å¦‚è„šæœ¬é”™è¯¯ã€die()ã€exitã€å¼‚å¸¸ã€æ­£å¸¸ç»“æŸéƒ½ä¼šè°ƒç”¨ï¼Œå¤šä¹ˆç‰›é€¼çš„ä¸€ä¸ªå‡½æ•°å•Šï¼é€šè¿‡è¿™ä¸ªå‡½æ•°å°±å¯ä»¥åœ¨è„šæœ¬ç»“æŸå‰åˆ¤æ–­è¿™æ¬¡æ‰§è¡Œæ˜¯å¦æœ‰é”™è¯¯äº§ç”Ÿï¼Œè¿™æ—¶å°±è¦å€ŸåŠ©äºä¸€ä¸ªå‡½æ•°ï¼šerror_get_last()ï¼›è¿™ä¸ªå‡½æ•°å¯ä»¥æ‹¿åˆ°æœ¬æ¬¡æ‰§è¡Œäº§ç”Ÿçš„æ‰€æœ‰é”™è¯¯ã€‚error_get_last();è¿”å›çš„ä¿¡æ¯ï¼š</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">ã€€ã€€[type]</span>    - é”™è¯¯ç±»å‹</span><br><span class="line"><span class="string">ã€€ã€€[message]</span> - é”™è¯¯æ¶ˆæ¯</span><br><span class="line"><span class="string">ã€€ã€€[file]</span>    - å‘ç”Ÿé”™è¯¯æ‰€åœ¨çš„æ–‡ä»¶</span><br><span class="line"><span class="string">ã€€ã€€[line]</span>    - å‘ç”Ÿé”™è¯¯æ‰€åœ¨çš„è¡Œ</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">register_shutdown_function</span>(<span class="string">&#x27;zyfshutdownfunc&#x27;</span>);</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">zyfshutdownfunc</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$error</span> = <span class="title function_ invoke__">error_get_last</span>()) &#123;</span><br><span class="line">            <span class="title function_ invoke__">var_dump</span>(<span class="string">&#x27;&lt;b&gt;register_shutdown_function: Type:&#x27;</span> . <span class="variable">$error</span>[<span class="string">&#x27;type&#x27;</span>] . <span class="string">&#x27; Msg: &#x27;</span> . <span class="variable">$error</span>[<span class="string">&#x27;message&#x27;</span>] . <span class="string">&#x27; in &#x27;</span> . <span class="variable">$error</span>[<span class="string">&#x27;file&#x27;</span>] . <span class="string">&#x27; on line &#x27;</span> . <span class="variable">$error</span>[<span class="string">&#x27;line&#x27;</span>] . <span class="string">&#x27;&lt;/b&gt;&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ã€€é€šè¿‡è¿™ç§æ–¹æ³•å°±å¯ä»¥å·§å¦™çš„æ‰“å°å‡ºç¨‹åºç»“æŸå‰æ‰€æœ‰çš„é”™è¯¯ä¿¡æ¯ã€‚ä½†æ˜¯æˆ‘åœ¨æµ‹è¯•çš„æ—¶å€™æˆ‘å‘ç°å¹¶ä¸æ˜¯æ‰€æœ‰çš„é”™è¯¯ç»ˆæ­¢åéƒ½ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¯ä»¥çœ‹ä¸‹é¢çš„ä¸€ä¸ªæµ‹è¯•æ–‡ä»¶ï¼Œå†…å®¹æ˜¯ï¼š</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">     <span class="title function_ invoke__">register_shutdown_function</span>(<span class="string">&#x27;zyfshutdownfunc&#x27;</span>);</span><br><span class="line">     <span class="function"><span class="keyword">function</span> <span class="title">zyfshutdownfunc</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">     </span>&#123;</span><br><span class="line">         <span class="keyword">if</span> (<span class="variable">$error</span> = <span class="title function_ invoke__">error_get_last</span>()) &#123;</span><br><span class="line">             <span class="title function_ invoke__">var_dump</span>(<span class="string">&#x27;&lt;b&gt;register_shutdown_function: Type:&#x27;</span> . <span class="variable">$error</span>[<span class="string">&#x27;type&#x27;</span>] . <span class="string">&#x27; Msg: &#x27;</span> . <span class="variable">$error</span>[<span class="string">&#x27;message&#x27;</span>] . <span class="string">&#x27; in &#x27;</span> . <span class="variable">$error</span>[<span class="string">&#x27;file&#x27;</span>] . <span class="string">&#x27; on line &#x27;</span> . <span class="variable">$error</span>[<span class="string">&#x27;line&#x27;</span>] . <span class="string">&#x27;&lt;/b&gt;&#x27;</span>);</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="title function_ invoke__">var_dump</span>(<span class="number">23</span>+-+); <span class="comment">//æ­¤å¤„è¯­æ³•é”™è¯¯</span></span><br><span class="line"> <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"> ã€€ã€€è‡ªå·±å¯ä»¥è¯•ä¸€ä¸‹ï¼Œä½ å¯ä»¥çœ‹åˆ°æ ¹æœ¬å°±ä¸ä¼šè§¦å‘<span class="title function_ invoke__">zyfshutdownfunc</span>()å‡½æ•°ï¼Œå…¶å®è¿™æ˜¯ä¸€ä¸ªè¯­æ³•é”™è¯¯ï¼Œç›´æ¥æŠ¥äº†ä¸€ä¸ªï¼š</span><br><span class="line">    Parse error: syntax error, unexpected <span class="string">&#x27;)&#x27;</span> in /www/mytest/exception/<span class="keyword">try</span>-<span class="keyword">catch</span>.php on line <span class="number">71</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€ç”±æ­¤å¼•å‡ºä¸€ä¸ªå¥‡è‘©çš„é—®é¢˜ï¼šé—®ä»€ä¹ˆä¸èƒ½è§¦å‘ï¼Œä¸ºä»€ä¹ˆæ¡†æ¶ä¸­æ˜¯å¯ä»¥çš„ï¼Ÿå…¶å®åŸå› å¾ˆç®€å•ï¼Œåªåœ¨parse-timeå‡ºé”™æ—¶æ˜¯ä¸ä¼šè°ƒç”¨æœ¬å‡½æ•°çš„ã€‚åªæœ‰åœ¨run-timeå‡ºé”™çš„æ—¶å€™ï¼Œæ‰ä¼šè°ƒç”¨æœ¬å‡½æ•°ï¼Œæˆ‘çš„ç†è§£æ˜¯è¯­æ³•æ£€æŸ¥å™¨å‰æ²¡æœ‰æ‰§è¡Œ<span class="title function_ invoke__">register_shutdown_function</span>()å»æŠŠéœ€è¦æ³¨å†Œçš„å‡½æ•°æ”¾åˆ°è°ƒç”¨çš„å †æ ˆä¸­ï¼Œæ‰€ä»¥å°±æ ¹æœ¬ä¸ä¼šè¿è¡Œã€‚é‚£æ¡†æ¶ä¸­ä¸ºä»€ä¹ˆä»»ä½•é”™è¯¯éƒ½èƒ½è¿›å…¥åˆ°<span class="title function_ invoke__">register_shutdown_function</span>()ä¸­å‘¢ï¼Œå…¶å®åœ¨æ¡†æ¶ä¸­ä¸€èˆ¬ä¼šæœ‰ç»Ÿä¸€çš„å…¥å£index.phpï¼Œç„¶åæ¯ä¸ªç±»åº“æ–‡ä»¶éƒ½ä¼šé€šè¿‡<span class="keyword">include</span> ** çš„æ–¹å¼åŠ è½½åˆ°index.phpä¸­ï¼Œç›¸å½“ä¸æ‰€æœ‰çš„ç¨‹åºéƒ½ä¼šåœ¨index.phpä¸­èšé›†ï¼ŒåŒæ ·ï¼Œä½ å†™çš„å…·æœ‰è¯­æ³•é”™è¯¯çš„æ–‡ä»¶ä¹Ÿä¼šè¢«å¼•å…¥åˆ°å…¥å£æ–‡ä»¶ä¸­ï¼Œè¿™æ ·çš„è¯ï¼Œè°ƒç”¨æ¡†æ¶ï¼Œæ‰§è¡Œindex.phpï¼Œindex.phpæœ¬èº«å¹¶æ²¡æœ‰è¯­æ³•é”™è¯¯ï¼Œä¹Ÿå°±ä¸ä¼šäº§ç”Ÿparse-timeé”™è¯¯ï¼Œè€Œæ˜¯ <span class="keyword">include</span> æ–‡ä»¶å‡ºé”™äº†ï¼Œæ˜¯run-timeçš„æ—¶å€™å‡ºé”™äº†ï¼Œæ‰€ä»¥æ¡†æ¶æ‰§è¡Œå®Œä¹‹åå°±ä¼šè§¦å‘<span class="title function_ invoke__">register_shutdown_function</span>();</span><br><span class="line">ã€€ã€€æ‰€ä»¥ç°åœ¨å¯æ˜¯è¯•ä¸€ä¸‹è¿™ä¸ªå†™æ³•ï¼Œè¿™æ ·å°±ä¼šè§¦å‘<span class="title function_ invoke__">zyfshutdownfunc</span>()å›è°ƒäº†ï¼š</span><br><span class="line"></span><br><span class="line"> a.phpæ–‡ä»¶</span><br><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"> ã€€ã€€<span class="comment">// æ¨¡æ‹Ÿè¯­æ³•é”™è¯¯</span></span><br><span class="line"> ã€€ã€€<span class="title function_ invoke__">var_dump</span>(<span class="number">23</span>+-+);</span><br><span class="line"> <span class="meta">?&gt;</span></span><br><span class="line"> </span><br><span class="line"> b.phpæ–‡ä»¶</span><br><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">     <span class="title function_ invoke__">register_shutdown_function</span>(<span class="string">&#x27;zyfshutdownfunc&#x27;</span>);</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">zyfshutdownfunc</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">       <span class="keyword">if</span> (<span class="variable">$error</span> = <span class="title function_ invoke__">error_get_last</span>()) &#123;</span><br><span class="line">            <span class="title function_ invoke__">var_dump</span>(<span class="string">&#x27;&lt;b&gt;register_shutdown_function: Type:&#x27;</span> . <span class="variable">$error</span>[<span class="string">&#x27;type&#x27;</span>] . <span class="string">&#x27; Msg: &#x27;</span> . <span class="variable">$error</span>[<span class="string">&#x27;message&#x27;</span>] . <span class="string">&#x27; in &#x27;</span> . <span class="variable">$error</span>[<span class="string">&#x27;file&#x27;</span>] . <span class="string">&#x27; on line &#x27;</span> . <span class="variable">$error</span>[<span class="string">&#x27;line&#x27;</span>] . <span class="string">&#x27;&lt;/b&gt;&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">require</span> <span class="string">&#x27;a.php&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"> ã€€ã€€<span class="number">3</span>ï¼š<span class="title function_ invoke__">set_exception_handler</span>()</span><br><span class="line">ã€€ã€€è®¾ç½®é»˜è®¤çš„å¼‚å¸¸å¤„ç†ç¨‹åºï¼Œç”¨åœ¨æ²¡æœ‰ç”¨<span class="keyword">try</span>/<span class="keyword">catch</span>å—æ¥æ•è·çš„å¼‚å¸¸ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸ç®¡ä½ æŠ›å‡ºçš„å¼‚å¸¸æœ‰æ²¡æœ‰äººæ•è·ï¼Œå¦‚æœæ²¡æœ‰äººæ•è·å°±ä¼šè¿›å…¥åˆ°è¯¥æ–¹æ³•ä¸­ï¼Œå¹¶ä¸”åœ¨å›è°ƒå‡½æ•°è°ƒç”¨åå¼‚å¸¸ä¼šä¸­æ­¢ã€‚çœ‹ä¸€ä¸‹ç”¨æ³•ï¼š</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">set_exception_handler</span>(<span class="string">&#x27;zyfexception&#x27;</span>);</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">zyfexception</span>(<span class="params"><span class="variable">$exception</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">var_dump</span>(<span class="string">&quot;&lt;b&gt;set_exception_handler: Exception: &quot;</span> . <span class="variable">$exception</span>-&gt;<span class="title function_ invoke__">getMessage</span>()  . <span class="string">&#x27;&lt;/b&gt;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;zyf exception&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## å››ã€å·§å¦™çš„æ•è·é”™è¯¯å’Œå¼‚å¸¸</span></span><br><span class="line">ã€€ã€€<span class="number">1</span>ï¼šæŠŠé”™è¯¯ä»¥å¼‚å¸¸çš„å½¢å¼æŠ›å‡º(ä¸èƒ½å®Œå…¨æŠ›å‡º)</span><br><span class="line">ã€€ã€€ã€€ã€€ç”±ä¸Šé¢çš„è®²è§£æˆ‘ä»¬çŸ¥é“ï¼Œphpä¸­çš„é”™è¯¯æ˜¯ä¸èƒ½ä»¥å¼‚å¸¸çš„åƒæ˜¯æ•è·çš„ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦è®©ä»–ä»¬æŠ›å‡ºï¼Œå·²è¾¾åˆ°æ‰©å±• <span class="keyword">try</span>-<span class="keyword">catch</span>çš„å½±å“èŒƒå›´ï¼Œæˆ‘ä»¬å‰é¢è®²åˆ°è¿‡<span class="title function_ invoke__">set_error_handler</span>() æ–¹æ³•ï¼Œä»–æ˜¯å¹²å˜›ç”¨çš„ï¼Œä»–æ˜¯æ•è·é”™è¯¯çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥å€ŸåŠ©ä»–æ¥å§é”™è¯¯æ•è·ï¼Œç„¶åå†ä»¥å¼‚å¸¸çš„å½¢å¼æŠ›å‡ºï¼Œokï¼Œè¯•è¯•ä¸‹é¢çš„å†™æ³•ï¼š</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">set_error_handler</span>(<span class="string">&#x27;zyferror&#x27;</span>);</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">zyferror</span>(<span class="params"><span class="variable">$type</span>, <span class="variable">$message</span>, <span class="variable">$file</span>, <span class="variable">$line</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">\Exception</span>(<span class="variable">$message</span> . <span class="string">&#x27;zyfé”™è¯¯å½“åšå¼‚å¸¸&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$num</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="number">1</span>/<span class="variable">$num</span>;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (<span class="built_in">Exception</span> <span class="variable">$e</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$e</span>-&gt;<span class="title function_ invoke__">getMessage</span>();</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€å¥½äº†ï¼Œè¯•ä¸€ä¸‹ï¼Œä¼šæ‰“å°å‡ºï¼š</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> Division by zero zyf123</span><br><span class="line">ã€€ã€€æµç¨‹ï¼šæœ¬æ¥æ˜¯é™¤<span class="number">0</span>é”™è¯¯ï¼Œç„¶åè§¦å‘<span class="title function_ invoke__">set_error_handler</span>()ï¼Œåœ¨<span class="title function_ invoke__">set_error_handler</span>()ä¸­ç›¸å½“ä¸æ€äº†ä¸ªå›é©¬æªï¼Œå†æŠŠé”™è¯¯ä¿¡æ¯ä»¥å¼‚å¸¸çš„å½¢å¼æŠ›å‡ºæ¥ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°é”™è¯¯ä»¥å¼‚å¸¸çš„å½¢å¼æŠ›å‡ºã€‚å¤§å®¶è¦æ³¨æ„ï¼šè¿™æ ·åšæ˜¯æœ‰ç¼ºç‚¹çš„ï¼Œä¼šå—åˆ°<span class="title function_ invoke__">set_error_handler</span>()å‡½æ•°æ•è·çº§åˆ«çš„é™åˆ¶ã€‚</span><br><span class="line"></span><br><span class="line">     <span class="number">2</span>ï¼šæ•è·æ‰€æœ‰çš„é”™è¯¯</span><br><span class="line">        ç”±<span class="title function_ invoke__">set_error_handler</span>()å¯çŸ¥ï¼Œä»–èƒ½å¤Ÿæ•è·ä¸€éƒ¨åˆ†é”™è¯¯ï¼Œä¸èƒ½æ•è·ç³»ç»Ÿçº§E_ERRORã€E_PARSEç­‰é”™è¯¯ï¼Œä½†æ˜¯è¿™éƒ¨åˆ†å¯ä»¥ç”±<span class="title function_ invoke__">register_shutdown_function</span>()æ•è·ã€‚æ‰€ä»¥ä¸¤è€…ç»“åˆèƒ½å‡ºç°å¾ˆå¥½çš„åŠŸèƒ½ã€‚</span><br><span class="line">        çœ‹ä¸‹é¢çš„ç¨‹åºï¼š</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> a.phpå†…å®¹ï¼š</span><br><span class="line"> <span class="meta">&lt;?</span></span><br><span class="line">     <span class="comment">// æ¨¡æ‹ŸFatal erroré”™è¯¯</span></span><br><span class="line">     <span class="comment">//test();</span></span><br><span class="line"> </span><br><span class="line">     <span class="comment">// æ¨¡æ‹Ÿç”¨æˆ·äº§ç”ŸERRORé”™è¯¯</span></span><br><span class="line">     <span class="comment">//trigger_error(&#x27;zyf-error&#x27;, E_USER_ERROR);</span></span><br><span class="line"> </span><br><span class="line">     <span class="comment">// æ¨¡æ‹Ÿè¯­æ³•é”™è¯¯</span></span><br><span class="line">    <span class="title function_ invoke__">var_dump</span>(<span class="number">23</span>+-+);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨¡æ‹ŸNoticeé”™è¯¯</span></span><br><span class="line">    <span class="comment">//echo $f;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨¡æ‹ŸWarningé”™è¯¯</span></span><br><span class="line">    <span class="comment">//echo &#x27;123&#x27;;</span></span><br><span class="line">    <span class="comment">//ob_flush();</span></span><br><span class="line">    <span class="comment">//flush();</span></span><br><span class="line">    <span class="comment">//header(&quot;Content-type:text/html;charset=gb2312&quot;);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">b.phpå†…å®¹ï¼š</span><br><span class="line"><span class="meta">&lt;?</span></span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="title function_ invoke__">register_shutdown_function</span>(<span class="string">&#x27;zyfshutdownfunc&#x27;</span>);</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">zyfshutdownfunc</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$error</span> = <span class="title function_ invoke__">error_get_last</span>()) &#123;</span><br><span class="line">            <span class="title function_ invoke__">var_dump</span>(<span class="string">&#x27;&lt;b&gt;register_shutdown_function: Type:&#x27;</span> . <span class="variable">$error</span>[<span class="string">&#x27;type&#x27;</span>] . <span class="string">&#x27; Msg: &#x27;</span> . <span class="variable">$error</span>[<span class="string">&#x27;message&#x27;</span>] . <span class="string">&#x27; in &#x27;</span> . <span class="variable">$error</span>[<span class="string">&#x27;file&#x27;</span>] . <span class="string">&#x27; on line &#x27;</span> . <span class="variable">$error</span>[<span class="string">&#x27;line&#x27;</span>] . <span class="string">&#x27;&lt;/b&gt;&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">set_error_handler</span>(<span class="string">&#x27;zyferror&#x27;</span>);</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">zyferror</span>(<span class="params"><span class="variable">$type</span>, <span class="variable">$message</span>, <span class="variable">$file</span>, <span class="variable">$line</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">var_dump</span>(<span class="string">&#x27;&lt;b&gt;set_error_handler: &#x27;</span> . <span class="variable">$type</span> . <span class="string">&#x27;:&#x27;</span> . <span class="variable">$message</span> . <span class="string">&#x27; in &#x27;</span> . <span class="variable">$file</span> . <span class="string">&#x27; on &#x27;</span> . <span class="variable">$line</span> . <span class="string">&#x27; line .&lt;/b&gt;&lt;br /&gt;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">require</span> <span class="string">&#x27;a.php&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"> ã€€ã€€åˆ°æ­¤å°±å¯ä»¥è§£é‡Šå¼€å¤´çš„é‚£ä¸ªç¨‹åºäº†å§ï¼Œtest.php å¦‚æœæ˜¯å•æ–‡ä»¶æ‰§è¡Œæ˜¯ä¸èƒ½æ•è·åˆ°é”™è¯¯çš„ï¼Œå¦‚æœä½ åœ¨æ¡†æ¶ä¸­æ‰§è¡Œå°±æ˜¯å¯ä»¥çš„ï¼Œå½“ç„¶ä½ æŒ‰ç…§æˆ‘ä¸Šé¢ä»‹ç»çš„æ¥æ‰©å±•ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">## äº”ã€è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†å’Œå¼‚å¸¸åµŒå¥—</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€<span class="number">1</span>ï¼šè‡ªå®šä¹‰å¼‚å¸¸å¤„ç†</span><br><span class="line"></span><br><span class="line">ã€€ã€€åœ¨å¤æ‚çš„ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦è‡ªå·±æ•è·æˆ‘ä»¬éœ€è¦ç‰¹æ®Šå¤„ç†çš„å¼‚å¸¸ï¼Œè¿™äº›å¼‚å¸¸å¯èƒ½æ˜¯ç‰¹æ®Šæƒ…å†µä¸‹æŠ›å‡ºçš„ã€‚æ‰€ä»¥æˆ‘ä»¬å°±è‡ªå·±å®šä¹‰ä¸€ä¸ªå¼‚å¸¸æ•è·ç±»ï¼Œè¯¥ç±»å¿…é¡»æ˜¯ exception ç±»çš„ä¸€ä¸ªæ‰©å±•ï¼Œè¯¥ç±»ç»§æ‰¿äº† PHP çš„ exception ç±»çš„æ‰€æœ‰å±æ€§ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥æ·»åŠ è‡ªå®šä¹‰çš„å‡½æ•°ï¼Œä½¿ç”¨çš„æ—¶å€™å…¶å®å’Œä¹‹å‰çš„ä¸€æ ·ï¼Œå¤§è‡´å†™æ³•å¦‚ä¸‹ï¼š</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">     <span class="class"><span class="keyword">class</span> <span class="title">zyfException</span> <span class="keyword">extends</span> <span class="title">Exception</span></span></span><br><span class="line"><span class="class">     </span>&#123;</span><br><span class="line">         <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">errorzyfMessage</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">         </span>&#123;</span><br><span class="line">             <span class="keyword">return</span> <span class="string">&#x27;Error line &#x27;</span> . <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getLine</span>().<span class="string">&#x27; in &#x27;</span> . <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getFile</span>()</span><br><span class="line">                 .<span class="string">&#x27;: &lt;b&gt;&#x27;</span> . <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getMessage</span>() . <span class="string">&#x27;&lt;/b&gt; Must in (0 - 60)&#x27;</span>;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$age</span> = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="variable">$age</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$age</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$age</span> &gt; <span class="number">60</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title function_ invoke__">zyfException</span>(<span class="variable">$age</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (zyfException <span class="variable">$e</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$e</span>-&gt;<span class="title function_ invoke__">errorzyfMessage</span>();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€<span class="number">2</span>ï¼šå¼‚å¸¸åµŒå¥—</span><br><span class="line"></span><br><span class="line">ã€€ã€€å¼‚å¸¸åµŒå¥—æ˜¯æ¯”è¾ƒå¸¸è§çš„å†™æ³•ï¼Œåœ¨è‡ªå®šä¹‰çš„å¼‚å¸¸å¤„ç†ä¸­ï¼Œ<span class="keyword">try</span> å—ä¸­å¯ä»¥å®šä¹‰å¤šä¸ªå¼‚å¸¸æ•è·ï¼Œç„¶ååˆ†å±‚ä¼ é€’å¼‚å¸¸ï¼Œç†è§£å’Œå†’æ³¡å·®ä¸å¤šï¼Œçœ‹ä¸‹é¢çš„å®ç°ï¼š</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">     <span class="variable">$age</span> = <span class="number">10</span>;</span><br><span class="line">     <span class="keyword">try</span> &#123;</span><br><span class="line">         <span class="variable">$age</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$age</span>);</span><br><span class="line">         <span class="keyword">if</span>(<span class="variable">$age</span> &gt; <span class="number">60</span>) &#123;</span><br><span class="line">             <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title function_ invoke__">zyfException</span>(<span class="variable">$age</span>);</span><br><span class="line">         &#125;</span><br><span class="line"> </span><br><span class="line">         <span class="keyword">if</span> (<span class="variable">$age</span> &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="variable">$age</span> . <span class="string">&#x27; must &gt; 0&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (zyfException <span class="variable">$e</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$e</span>-&gt;<span class="title function_ invoke__">errorzyfMessage</span>();</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span>(<span class="built_in">Exception</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$e</span>-&gt;<span class="title function_ invoke__">getMessage</span>();</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€å½“ç„¶ä¹Ÿå¯ä»¥åœ¨<span class="keyword">catch</span>ä¸­å†æŠ›å‡ºå¼‚å¸¸ç»™ä¸Šå±‚ï¼š</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">     <span class="variable">$age</span> = <span class="number">100</span>;</span><br><span class="line">     <span class="keyword">try</span> &#123;</span><br><span class="line">         <span class="keyword">try</span> &#123;</span><br><span class="line">             <span class="variable">$age</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$age</span>);</span><br><span class="line">             <span class="keyword">if</span>(<span class="variable">$age</span> &gt; <span class="number">60</span>) &#123;</span><br><span class="line">                 <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="variable">$age</span>);</span><br><span class="line">             &#125;</span><br><span class="line"> </span><br><span class="line">        &#125; <span class="keyword">catch</span> (<span class="built_in">Exception</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title function_ invoke__">zyfException</span>(<span class="variable">$age</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (zyfException <span class="variable">$e</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$e</span>-&gt;<span class="title function_ invoke__">errorzyfMessage</span>();</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## å…­ã€PHP7ä¸­çš„å¼‚å¸¸å¤„ç†</span></span><br><span class="line">ã€€ã€€ç°åœ¨å†™PHPå¿…é¡»è€ƒè™‘ç‰ˆæœ¬æƒ…å†µï¼Œä¸Šé¢çš„å†™æ³•åœ¨PHP7ä¸­å¤§éƒ¨åˆ†éƒ½èƒ½å®ç°ï¼Œä½†æ˜¯ä¹Ÿä¼šæœ‰ä¸åŒç‚¹ï¼Œåœ¨PHP7æ›´æ–°ä¸­æœ‰ä¸€æ¡ï¼šæ›´å¤šçš„<span class="built_in">Error</span>å˜ä¸ºå¯æ•è·çš„<span class="built_in">Exception</span>ï¼Œç°åœ¨çš„PHP7å®ç°äº†ä¸€ä¸ªå…¨å±€çš„throwableæ¥å£ï¼ŒåŸæ¥è€çš„<span class="built_in">Exception</span>å’Œå…¶ä¸­ä¸€éƒ¨åˆ†<span class="built_in">Error</span>å®ç°äº†è¿™ä¸ªæ¥å£(<span class="class"><span class="keyword">interface</span>)ï¼Œ<span class="title">PHP7</span>ä¸­æ›´å¤šçš„<span class="title">Error</span>å˜ä¸ºå¯æ•è·çš„<span class="title">Exception</span>è¿”å›ç»™æ•æ‰å™¨ï¼Œè¿™æ ·å…¶å®å’Œå‰é¢æåˆ°çš„æ‰©å±•<span class="title">try</span>-<span class="title">catch</span>å½±å“èŒƒå›´ä¸€æ ·ï¼Œä½†æ˜¯å¦‚æœä¸æ•è·åˆ™è¿˜æ˜¯æŒ‰ç…§<span class="title">Error</span>å¯¹å¾…ï¼Œçœ‹ä¸‹é¢ä¸¤ä¸ªï¼š</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"> &lt;?<span class="title">php</span></span></span><br><span class="line"><span class="class">     <span class="title">try</span> </span>&#123;</span><br><span class="line">         <span class="title function_ invoke__">test</span>();</span><br><span class="line"> </span><br><span class="line">     &#125; <span class="keyword">catch</span>(<span class="built_in">Throwable</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">         <span class="keyword">echo</span> <span class="variable">$e</span>-&gt;<span class="title function_ invoke__">getMessage</span>() . <span class="string">&#x27; zyf&#x27;</span>;</span><br><span class="line">     &#125;</span><br><span class="line"> </span><br><span class="line">     <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">test</span>();</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span>(<span class="built_in">Error</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$e</span>-&gt;<span class="title function_ invoke__">getMessage</span>() . <span class="string">&#x27; zyf&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"> å› ä¸ºPHP7å®ç°äº†throwableæ¥å£ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨ç¬¬ä¸€ä¸ªè¿™ç§æ–¹å¼æ¥æ•è·å¼‚å¸¸ã€‚åˆå› ä¸ºéƒ¨åˆ†<span class="built_in">Error</span>å®ç°äº†æ¥å£ï¼Œå¹¶ä¸”æ›´å¤šçš„<span class="built_in">Error</span>å˜ä¸ºå¯æ•è·çš„<span class="built_in">Exception</span>ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨ç¬¬äºŒç§æ–¹å¼æ¥æ•è·å¼‚å¸¸ã€‚ä¸‹é¢æ˜¯åœ¨ç½‘ä¸Šæ‰¾çš„PHP7çš„å¼‚å¸¸å±‚æ¬¡æ ‘ï¼š</span><br><span class="line"><span class="built_in">Throwable</span></span><br><span class="line">ã€€ã€€<span class="built_in">Exception</span> å¼‚å¸¸</span><br><span class="line">ã€€ã€€ã€€ã€€...</span><br><span class="line">ã€€ã€€<span class="built_in">Error</span> é”™è¯¯</span><br><span class="line">ã€€ã€€ã€€ã€€<span class="built_in">ArithmeticError</span> ç®—æ•°é”™è¯¯</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€<span class="built_in">DivisionByZeroError</span> é™¤æ•°ä¸º<span class="number">0</span>çš„é”™è¯¯</span><br><span class="line">ã€€ã€€ã€€ã€€<span class="built_in">AssertionError</span> å£°æ˜é”™è¯¯</span><br><span class="line">ã€€ã€€ã€€ã€€<span class="built_in">ParseError</span> è§£æé”™è¯¯</span><br><span class="line">ã€€ã€€ã€€ã€€<span class="built_in">TypeError</span> ç±»å‹é”™è¯¯</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>php-fpmé…ç½®æ–‡ä»¶</title>
      <link href="/posts/4aa5794f.html"/>
      <url>/posts/4aa5794f.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">pid</span> = run/php-fpm.pid</span><br><span class="line"><span class="attr">error_log</span> = /data/logs/php-fpm.log</span><br><span class="line"></span><br><span class="line"><span class="comment">; å­è¿›ç¨‹ç­‰å¾…masterè¿›ç¨‹å¯¹ä¿¡å·çš„å›åº”ï¼ˆé»˜è®¤å•ä½ï¼šsç§’ï¼‰ï¼Œå¯é€‰sç§’ï¼Œmåˆ†ï¼Œhæ—¶ï¼Œdå¤©</span></span><br><span class="line"><span class="attr">process_control_timeout</span> = <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="attr">user</span> = www</span><br><span class="line"><span class="attr">group</span> = www</span><br><span class="line"></span><br><span class="line"><span class="comment">; åŒä¸€æ—¶åˆ»èƒ½å¤Ÿå­˜æ´»çš„æœ€å¤§å­è¿›ç¨‹çš„æ•°é‡</span></span><br><span class="line"><span class="attr">pm.max_children</span> = <span class="number">256</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; The number of child processes created on startup.</span></span><br><span class="line"><span class="comment">; <span class="doctag">Note:</span> Used only when pm is set to &#x27;dynamic&#x27;</span></span><br><span class="line"><span class="comment">; Default Value: min_spare_servers + (max_spare_servers - min_spare_servers) / 2</span></span><br><span class="line"><span class="comment">; åœ¨å¯åŠ¨æ—¶å¯åŠ¨çš„å­è¿›ç¨‹æ•°é‡</span></span><br><span class="line"><span class="attr">pm.start_servers</span> = <span class="number">128</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; The desired minimum number of idle server processes.</span></span><br><span class="line"><span class="comment">; <span class="doctag">Note:</span> Used only when pm is set to &#x27;dynamic&#x27;</span></span><br><span class="line"><span class="comment">; <span class="doctag">Note:</span> Mandatory when pm is set to &#x27;dynamic&#x27;</span></span><br><span class="line"><span class="comment">; å¤„äºç©ºé—²&quot;idle&quot;çŠ¶æ€çš„æœ€å°å­è¿›ç¨‹ï¼Œå¦‚æœç©ºé—²è¿›ç¨‹æ•°é‡å°äºè¿™ä¸ªå€¼ï¼Œé‚£ä¹ˆç›¸åº”çš„å­è¿›ç¨‹ä¼šè¢«åˆ›å»º</span></span><br><span class="line"><span class="attr">pm.min_spare_servers</span> = <span class="number">64</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; The desired maximum number of idle server processes.</span></span><br><span class="line"><span class="comment">; <span class="doctag">Note:</span> Used only when pm is set to &#x27;dynamic&#x27;</span></span><br><span class="line"><span class="comment">; <span class="doctag">Note:</span> Mandatory when pm is set to &#x27;dynamic&#x27;</span></span><br><span class="line"><span class="comment">; æœ€å¤§ç©ºé—²å­è¿›ç¨‹æ•°é‡ï¼Œç©ºé—²å­è¿›ç¨‹æ•°é‡è¶…è¿‡è¿™ä¸ªå€¼ï¼Œé‚£ä¹ˆç›¸åº”çš„å­è¿›ç¨‹ä¼šè¢«æ€æ‰ã€‚</span></span><br><span class="line"><span class="attr">pm.max_spare_servers</span> = <span class="number">256</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; åœ¨æ´¾ç”Ÿæ–°çš„å­è¿›ç¨‹å‰ï¼Œæ¯ä¸€ä¸ªå­è¿›ç¨‹åº”è¯¥å¤„ç†çš„è¯·æ±‚æ•°ç›®ï¼Œåœ¨ç¬¬ä¸‰æ–¹åº“ä¸­è§£å†³å†…å­˜æº¢å‡ºå¾ˆæœ‰ç”¨ï¼Œè®¾ç½®ä¸º0åˆ™ä¸ä¼šé™åˆ¶</span></span><br><span class="line"><span class="attr">pm.max_requests</span> = <span class="number">10240</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; ç»ˆæ­¢è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼Œåœ¨workerè¿›ç¨‹è¢«æ€æ‰ä¹‹åï¼Œæä¾›å•ä¸ªè¯·æ±‚çš„è¶…æ—¶é—´éš”ã€‚ç”±äºæŸç§åŸå› ä¸åœæ­¢è„šæœ¬æ‰§è¡Œæ—¶ï¼Œåº”è¯¥ä½¿ç”¨è¯¥é€‰é¡¹ï¼Œ0è¡¨ç¤ºå…³é—­ä¸å¯ç”¨</span></span><br><span class="line"><span class="comment">; (åœ¨php.iniä¸­ï¼Œmax_execution_time ä¸€èˆ¬è®¾ç½®ä¸º30ï¼Œè¡¨ç¤ºæ¯ä¸€ä¸ªè„šæœ¬çš„æœ€å¤§æ‰§è¡Œæ—¶é—´)</span></span><br><span class="line"><span class="attr">request_terminate_timeout</span> = <span class="number">600</span>s</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
          <category> php-fpm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é…ç½®æ–‡ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>new selfå’Œnew staticåŒºåˆ«</title>
      <link href="/posts/8ebbd94d.html"/>
      <url>/posts/8ebbd94d.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * new self()å’Œnew static()åŒºåˆ«</span></span><br><span class="line"><span class="comment"> * new self(); æŒ‡å®šæœ€åº•å±‚çˆ¶ç±»å æ–¹æ³•ä»¥åŠå˜é‡åŒç†</span></span><br><span class="line"><span class="comment"> * new static();å½“å‰ç±»å</span></span><br><span class="line"><span class="comment"> * Class A</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">get_self</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">self</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">get_static</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">static</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">get_class</span>(A::<span class="title function_ invoke__">get_self</span>()); <span class="comment">// A</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">get_class</span>(B::<span class="title function_ invoke__">get_self</span>()); <span class="comment">// A</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">get_class</span>(A::<span class="title function_ invoke__">get_static</span>()); <span class="comment">// A</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">get_class</span>(B::<span class="title function_ invoke__">get_static</span>()); <span class="comment">// B</span></span><br><span class="line"><span class="comment">// new self(); æŒ‡å®šæœ€åº•å±‚çˆ¶ç±»å</span></span><br><span class="line"><span class="comment">// new static();å½“å‰ç±»å</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// PHP ä¸­constçš„å¸¸é‡ä½¿ç”¨ selfè°ƒå‡ºå’Œä½¿ç”¨staticè°ƒå‡ºæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</span></span><br><span class="line"><span class="comment">// self æ˜¯åœ¨ç¼–è¯‘æ—¶ç¡®å®šå€¼ï¼Œstatic æ˜¯åœ¨è¿è¡Œæ—¶ç¡®å®šå€¼ã€‚</span></span><br><span class="line"><span class="comment">// ä¸‹é¢ç•¥å¾®ä¿®æ”¹äº†ä¸€ä¸‹ä½ çš„ä»£ç ï¼Œæ³¨æ„ä¸€ä¸‹è¿è¡Œç»“æœçš„ä¸åŒã€‚</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">A</span> = <span class="string">&quot;this&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">aaa</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="built_in">self</span>::<span class="variable constant_">A</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">bbb</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="built_in">static</span>::<span class="variable constant_">A</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">testX</span> <span class="keyword">extends</span> <span class="title">test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">A</span> = <span class="string">&quot;that&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title function_ invoke__">testX</span>();</span><br><span class="line"><span class="variable">$test</span>-&gt;<span class="title function_ invoke__">aaa</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="variable">$test</span>-&gt;<span class="title function_ invoke__">bbb</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> test::<span class="variable constant_">A</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$test</span>::<span class="variable constant_">A</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AA</span> </span>&#123;</span><br><span class="line">    <span class="built_in">static</span> <span class="variable">$str</span> = <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">className</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">__CLASS__</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="built_in">self</span>::<span class="variable">$str</span>; <span class="comment">// A</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="built_in">static</span>::<span class="variable">$str</span>; <span class="comment">// B</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">self</span>::<span class="variable language_">class</span>Name(); <span class="comment">// A</span></span><br><span class="line">        <span class="built_in">static</span>::<span class="variable language_">class</span>Name(); <span class="comment">// B</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BB</span> <span class="keyword">extends</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="built_in">static</span> <span class="variable">$str</span> = <span class="string">&#x27;B&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">className</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">__CLASS__</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="built_in">self</span>::<span class="variable">$str</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">B::<span class="title function_ invoke__">test</span>();</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpé…ç½®æ–‡ä»¶</title>
      <link href="/posts/75b32cb9.html"/>
      <url>/posts/75b32cb9.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; httpå¤´é‡Œå‘ç°è¿™æ ·çš„ä¿¡æ¯ï¼š</span></span><br><span class="line"><span class="comment">; X-Powered-By:PHP/5.2.11</span></span><br><span class="line"><span class="comment">; PHPçš„ç‰ˆæœ¬å·æš´éœ²æ— ç–‘ï¼Œæ”»å‡»è€…å¾ˆå®¹æ˜“æ•è·åˆ°æ­¤ä¿¡æ¯,ä¿®æ”¹ä¸ºå…³é—­</span></span><br><span class="line"><span class="attr">expose_php</span> = <span class="literal">Off</span></span><br><span class="line"></span><br><span class="line"><span class="attr">max_execution_time</span> = <span class="number">600</span></span><br><span class="line"><span class="attr">error_reporting</span> = E_ALL &amp; ~E_NOTICE</span><br><span class="line"><span class="attr">error_log</span> = /data/logs/php-error.log</span><br><span class="line"></span><br><span class="line"><span class="comment">; $HTTP_RAW_POST_DATA æ¥æ”¶post raw data</span></span><br><span class="line"><span class="attr">always_populate_raw_post_data</span> = <span class="literal">On</span></span><br><span class="line"></span><br><span class="line"><span class="attr">date.timezone</span> = <span class="string">&quot;Asia/Chongqing&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; è®¾ç½®sessionç”¨redisè®°å½•</span></span><br><span class="line"><span class="attr">session.save_handler</span> = redis</span><br><span class="line"><span class="attr">session.save_path</span> = <span class="string">&quot;tcp://127.0.0.1:6379&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; å­—èŠ‚ç ç¼“å­˜æ‰©å±•æ€§èƒ½åŠ é€Ÿ</span></span><br><span class="line"><span class="attr">opcache.enable</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">opcache.enable_cli</span>=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; å¢åŠ æ‰©å±•</span></span><br><span class="line"><span class="attr">extension</span> = <span class="string">&quot;redis.so&quot;</span></span><br><span class="line"><span class="attr">zend_extension</span> = <span class="string">&quot;opcache.so&quot;</span></span><br><span class="line"><span class="attr">extension</span> = <span class="string">&quot;curl.so&quot;</span></span><br><span class="line"><span class="attr">extension</span> = <span class="string">&quot;openssl.so&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; php7 jsonæµ®ç‚¹æ•°ç²¾åº¦ä¸¢å¤±ï¼Œè®¾ç½®æˆ17ç²¾åº¦ä¼šæ›´åŠ ç²¾ç¡®</span></span><br><span class="line"><span class="attr">serialize_precision</span> = <span class="number">17</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é…ç½®æ–‡ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>php xdebugå®‰è£…</title>
      <link href="/posts/6c0c5b4b.html"/>
      <url>/posts/6c0c5b4b.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># ä¸‹è½½xdebug</span></span><br><span class="line">https:<span class="comment">//xdebug.org/download.phpä¸‹è½½xdebugå</span></span><br><span class="line"><span class="meta"># å®‰è£…phpæ‰©å±•</span></span><br><span class="line">/usr/local/webserver/php7/bin/phpize</span><br><span class="line">./configure --<span class="keyword">with</span>-php-config=/usr/local/webserver/php7/bin/php-config</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line"></span><br><span class="line"><span class="meta"># php.iniä¸­è¿½åŠ </span></span><br><span class="line">[<span class="meta">Xdebug</span>]</span><br><span class="line">zend_extension=&lt;full_path_to_xdebug_extension&gt;</span><br><span class="line">xdebug.remote_enable=<span class="number">1</span></span><br><span class="line">xdebug.remote_host=&lt;<span class="function">the host <span class="keyword">where</span> PhpStorm <span class="keyword">is</span> <span class="title">running</span> (<span class="params">e.g. localhost</span>)&gt;</span></span><br><span class="line"><span class="function">xdebug.remote_port</span>=&lt;<span class="function">the port to which Xdebug tries to connect <span class="keyword">on</span> the host <span class="keyword">where</span> PhpStorm <span class="keyword">is</span> <span class="title">running</span> (<span class="params"><span class="literal">default</span> <span class="number">9000</span></span>)&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
          <category> xdebug </category>
          
      </categories>
      
      
        <tags>
            
            <tag> debug </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¾èµ–æ³¨å…¥</title>
      <link href="/posts/caca8281.html"/>
      <url>/posts/caca8281.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä¾èµ–æ³¨å…¥</span></span><br><span class="line"><span class="comment"> * Date: 2018/9/26 0026</span></span><br><span class="line"><span class="comment"> * Time: ä¸‹åˆ 17:24</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sword</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$length</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$length</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;length = <span class="variable">$length</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">useSword</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;use length&#x27;</span> . <span class="variable language_">$this</span>-&gt;length;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Soldier</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$sword</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">Sword <span class="variable">$sword</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;sword = <span class="variable">$sword</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">fight</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;sword-&gt;<span class="title function_ invoke__">useSword</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$sword1</span> = <span class="keyword">new</span> <span class="title class_">Sword</span>(<span class="number">10</span>);</span><br><span class="line"><span class="variable">$sword2</span> = <span class="keyword">new</span> <span class="title class_">Sword</span>(<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$soldier1</span> = <span class="keyword">new</span> <span class="title class_">Soldier</span>(<span class="variable">$sword1</span>);</span><br><span class="line"><span class="variable">$soldier2</span> = <span class="keyword">new</span> <span class="title class_">Soldier</span>(<span class="variable">$sword2</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$soldier1</span>-&gt;<span class="title function_ invoke__">fight</span>();</span><br><span class="line"><span class="variable">$soldier2</span>-&gt;<span class="title function_ invoke__">fight</span>();</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>php7ç¼–è¯‘å®‰è£…</title>
      <link href="/posts/96dc3726.html"/>
      <url>/posts/96dc3726.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€ç¯å¢ƒé¢„å®‰è£…"><a href="#ä¸€ã€ç¯å¢ƒé¢„å®‰è£…" class="headerlink" title="ä¸€ã€ç¯å¢ƒé¢„å®‰è£…"></a>ä¸€ã€ç¯å¢ƒé¢„å®‰è£…</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">yum</span> install -y <span class="punctuation">\</span></span><br><span class="line"><span class="punctuation"></span>zlib-devel <span class="punctuation">\</span></span><br><span class="line"><span class="punctuation"></span>libxml2-devel <span class="punctuation">\</span></span><br><span class="line"><span class="punctuation"></span>libjpeg-devel <span class="punctuation">\</span></span><br><span class="line"><span class="punctuation"></span>freetype-devel <span class="punctuation">\</span></span><br><span class="line"><span class="punctuation"></span>libpng-devel <span class="punctuation">\</span></span><br><span class="line"><span class="punctuation"></span>gd-devel <span class="punctuation">\</span></span><br><span class="line"><span class="punctuation"></span>curl-devel <span class="punctuation">\</span></span><br><span class="line"><span class="punctuation"></span>libc-client-devel <span class="punctuation">\</span></span><br><span class="line"><span class="punctuation"></span>bzip2 <span class="punctuation">\</span></span><br><span class="line"><span class="punctuation"></span>bzip2-devel <span class="punctuation">\</span></span><br><span class="line"><span class="punctuation"></span>libxslt <span class="punctuation">\</span></span><br><span class="line"><span class="punctuation"></span>libsxl-devel</span><br></pre></td></tr></table></figure><h1 id="äºŒã€ç¼–è¯‘-å¦‚æœéœ€è¦æ”¯æŒmysqléœ€è¦åŠ â€“with-mysql-php7ä¸æ”¯æŒmysqlçš„è¿æ¥æ–¹å¼"><a href="#äºŒã€ç¼–è¯‘-å¦‚æœéœ€è¦æ”¯æŒmysqléœ€è¦åŠ â€“with-mysql-php7ä¸æ”¯æŒmysqlçš„è¿æ¥æ–¹å¼" class="headerlink" title="äºŒã€ç¼–è¯‘ (å¦‚æœéœ€è¦æ”¯æŒmysqléœ€è¦åŠ â€“with-mysql, php7ä¸æ”¯æŒmysqlçš„è¿æ¥æ–¹å¼)"></a>äºŒã€ç¼–è¯‘ (å¦‚æœéœ€è¦æ”¯æŒmysqléœ€è¦åŠ â€“with-mysql, php7ä¸æ”¯æŒmysqlçš„è¿æ¥æ–¹å¼)</h1><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">./configure <span class="string">\</span></span><br><span class="line">--prefix=/usr/local/webserver/php7                      <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-config-file-path=/usr/local/webserver/php7/etc   <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-zlib-dir                              <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-freetype-dir                          <span class="string">\</span></span><br><span class="line">--enable-mbstring                            <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-libxml-dir=/usr                       <span class="string">\</span></span><br><span class="line">--enable-soap                                <span class="string">\</span></span><br><span class="line">--enable-calendar                            <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-curl                                  <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-zlib                                  <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-gd                                    <span class="string">\</span></span><br><span class="line">--disable-rpath                              <span class="string">\</span></span><br><span class="line">--enable-inline-optimization                 <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-bz2                                   <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-zlib                                  <span class="string">\</span></span><br><span class="line">--enable-sockets                             <span class="string">\</span></span><br><span class="line">--enable-sysvsem                             <span class="string">\</span></span><br><span class="line">--enable-sysvshm                             <span class="string">\</span></span><br><span class="line">--enable-pcntl                               <span class="string">\</span></span><br><span class="line">--enable-mbregex                             <span class="string">\</span></span><br><span class="line">--enable-exif                                <span class="string">\</span></span><br><span class="line">--enable-bcmath                              <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-mhash                                 <span class="string">\</span></span><br><span class="line">--enable-zip                                 <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-pcre-regex                            <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-pdo-mysql                             <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-mysqli                                <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-mysql-sock=/tmp/mysql.sock <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-jpeg-dir=/usr                         <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-png-dir=/usr                          <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-openssl                               <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-fpm-user=nginx                     <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-fpm-group=nginx                    <span class="string">\</span></span><br><span class="line">--enable-ftp                                 <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-imap                                  <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-imap-ssl                              <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-kerberos                              <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-gettext                               <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-xmlrpc                                <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-xsl                                   <span class="string">\</span></span><br><span class="line">--enable-opcache                             <span class="string">\</span></span><br><span class="line">--<span class="keyword">with</span>-libdir=lib64                           <span class="string">\</span></span><br><span class="line">--enable-fpm</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘å‡ºç°çš„é—®é¢˜<br>Cannot find imap library (libc-client.a).</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ln</span> -s /usr/lib64/libc-client.so /usr/lib/libc-client.so</span><br></pre></td></tr></table></figure><p>xslt-config not found. Please reinstall the libxslt &gt;&#x3D; 1.1.0 distributionè¿™ä¸ªé—®é¢˜ï¼Œæ²¡å®‰è£…libxslt libxslt-develè½¯ä»¶åŒ…</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y <span class="keyword">install</span> libxslt libxslt-devel</span><br></pre></td></tr></table></figure><p>å¤åˆ¶é…ç½®æ–‡ä»¶</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp <span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>php7<span class="regexp">/etc/</span>php-fpm.conf.<span class="keyword">default</span> <span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>php7<span class="regexp">/etc/</span>php-fpm.conf</span><br><span class="line">cp <span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>php7<span class="regexp">/etc/</span>php-fpm.d<span class="regexp">/www.conf.default /u</span>sr<span class="regexp">/local/</span>webserver<span class="regexp">/php7/</span>etc<span class="regexp">/php-fpm.d/</span>www.conf</span><br></pre></td></tr></table></figure><h1 id="å¼€æœºå¯åŠ¨"><a href="#å¼€æœºå¯åŠ¨" class="headerlink" title="å¼€æœºå¯åŠ¨"></a>å¼€æœºå¯åŠ¨</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;/usr/local/webserver/php7/sbin/php-fpm start&quot;</span> &gt;&gt; /etc/rc.local</span><br></pre></td></tr></table></figure><h1 id="é‡å¯php-fpm"><a href="#é‡å¯php-fpm" class="headerlink" title="é‡å¯php-fpm"></a>é‡å¯php-fpm</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> -USR2 php-fpm è¿›ç¨‹</span><br><span class="line"><span class="built_in">kill</span> -USR2 `<span class="built_in">cat</span> /usr/local/webserver/php7/var/run/php-fpm.pid`</span><br></pre></td></tr></table></figure><h1 id="å…³é—­"><a href="#å…³é—­" class="headerlink" title="å…³é—­"></a>å…³é—­</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> -INT `<span class="built_in">cat</span> /usr/local/webserver/php7/var/run/php-fpm.pid`</span><br></pre></td></tr></table></figure><h1 id="æ·»åŠ ç¯å¢ƒå˜é‡"><a href="#æ·»åŠ ç¯å¢ƒå˜é‡" class="headerlink" title="æ·»åŠ ç¯å¢ƒå˜é‡"></a>æ·»åŠ ç¯å¢ƒå˜é‡</h1><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo <span class="operator">-</span>e &#x27;\nexport <span class="type">PATH</span><span class="operator">=/</span>usr<span class="regexp">/local/</span>webserver<span class="regexp">/php7/</span>bin:<span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>php7<span class="regexp">/sbin:$PATH\n&#x27; &gt;&gt; /</span>etc<span class="regexp">/profile &amp;&amp; source /</span>etc<span class="operator">/</span>profile</span><br></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cp php.ini-production <span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>php7<span class="regexp">/etc/</span>php.ini</span><br><span class="line">æ³¨æ„ï¼šéœ€è¦ä¿®æ”¹php.inié…ç½®ä¸­çš„å‚æ•°ï¼Œextension_diræ”¹ä¸ºè‡ªå·±çš„</span><br><span class="line">extension_dir = <span class="string">&quot;/usr/local/webserver/php7/lib/php/extensions/no-debug-non-zts-20151012/&quot;</span></span><br></pre></td></tr></table></figure><p>ç”¨æˆ·å’Œnginxé…ç½®çš„ç”¨æˆ·ä¸€è‡´ å¦‚æœæ²¡æœ‰åˆ›å»ºnginxç”¨æˆ·åˆ™æ–°å»º</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupadd -<span class="attribute">r</span> nginx &amp;&amp; useradd -<span class="attribute">r</span> -<span class="selector-tag">g</span> nginx -s /bin/false -M nginx</span><br></pre></td></tr></table></figure><p>è®¾ç½®PHPæ—¥å¿—ç›®å½•å’Œphp-fpmè¿›ç¨‹æ–‡ä»¶ï¼ˆphp-fpm.sockï¼‰ç›®å½•<br>å…¶ä¸­ï¼Œè®¾ç½®php-fpmè¿›ç¨‹ç›®å½•çš„ç”¨æˆ·å’Œç”¨æˆ·ç»„ä¸ºnginxï¼Œå¹¶åˆ›å»ºphpä¼šè¯sessionç›®å½•</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">mkdir</span> -p /<span class="keyword">var</span>/<span class="keyword">log</span>/php-fpm/ &amp;&amp; <span class="keyword">mkdir</span> -p /<span class="keyword">var</span>/<span class="keyword">run</span>/php-fpm &amp;&amp; <span class="keyword">cd</span> /<span class="keyword">var</span>/<span class="keyword">run</span>/ &amp;&amp; chown -R nginx:nginx php-fpm</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹sessionçš„ç›®å½•é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /var/lib/php/session</span><br><span class="line"><span class="built_in">chown</span> -R nginx:nginx /var/lib/php</span><br></pre></td></tr></table></figure><p>é…ç½®å¼€æœºè‡ªå¯åŠ¨ï¼Œå¢åŠ åˆ°ä¸»æœºsysVæœåŠ¡</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chmod +x /etc/<span class="keyword">init</span>.d/php-fpm</span><br><span class="line">chkconfig --<span class="keyword">add</span> php-fpm</span><br><span class="line">chkconfig php-fpm <span class="keyword">on</span></span><br></pre></td></tr></table></figure><p>nginx æ”¯æŒphp</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">location</span> <span class="regexp">~ \.php$</span> &#123;</span><br><span class="line">            <span class="attribute">root</span>           /data/html;</span><br><span class="line">            <span class="attribute">fastcgi_pass</span>   <span class="number">127.0.0.1:9000</span>;</span><br><span class="line">            <span class="attribute">fastcgi_index</span>  index.php;</span><br><span class="line">            <span class="attribute">fastcgi_param</span>  SCRIPT_FILENAME  <span class="variable">$document_root</span><span class="variable">$fastcgi_script_name</span>;</span><br><span class="line">            <span class="attribute">include</span>        fastcgi_params;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰è£…æ–‡æ¡£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¸¸ç”¨å‡½æ•°</title>
      <link href="/posts/923c3c89.html"/>
      <url>/posts/923c3c89.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// ç”ŸæˆæŒ‡å®šé•¿åº¦çš„å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="title function_ invoke__">str_repeat</span>(<span class="string">&#x27;string&#x27;</span>, <span class="number">10</span>);</span><br><span class="line"><span class="comment">// ç”ŸæˆæŒ‡å®šé•¿åº¦çš„æ•°ç»„</span></span><br><span class="line"><span class="title function_ invoke__">array_fill</span>(<span class="number">0</span>, <span class="number">10</span>, <span class="string">&#x27;string&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–ä¼ å…¥çš„ä¸ç¡®å®šæ•°å‚æ•°</span></span><br><span class="line"><span class="title function_ invoke__">func_num_args</span>(); <span class="comment">// è¿”å›è°ƒç”¨å‡½æ•°çš„ä¼ å…¥å‚æ•°ä¸ªæ•°,ç±»å‹æ˜¯æ•´å‹</span></span><br><span class="line"><span class="title function_ invoke__">func_get_arg</span>(<span class="number">1</span>); <span class="comment">// è¿”å›æŒ‡å®šçš„å‚æ•°å€¼</span></span><br><span class="line"><span class="title function_ invoke__">func_get_args</span>(); <span class="comment">// è¿”å›å…¨éƒ¨å‚æ•°çš„å€¼,ç±»å‹æ˜¯æ•°ç»„</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°å­—ä½æ•°ä¸å…¨</span></span><br><span class="line"><span class="title function_ invoke__">number_format</span>(<span class="number">1</span>,<span class="number">2</span>); <span class="comment">// 1.00;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¸¸è§é—®é¢˜å¤„ç†</title>
      <link href="/posts/acb6d092.html"/>
      <url>/posts/acb6d092.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="php-readfileå¯¼å‡ºæ–‡ä»¶ä¹±ç "><a href="#php-readfileå¯¼å‡ºæ–‡ä»¶ä¹±ç " class="headerlink" title="php readfileå¯¼å‡ºæ–‡ä»¶ä¹±ç "></a>php readfileå¯¼å‡ºæ–‡ä»¶ä¹±ç </h1><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># åŠ ä¸Šä¸€ä¸‹ä¸¤ä¸ªæ–¹æ³•,å¯ä»¥è§£å†³readfileä¹±ç é—®é¢˜</span><br><span class="line"><span class="built_in">ob_clean</span>();</span><br><span class="line"><span class="built_in">flush</span>();</span><br><span class="line"><span class="built_in">readfile</span>($filename);</span><br></pre></td></tr></table></figure><h1 id="php7-jsonæµ®ç‚¹æ•°ç²¾åº¦ä¸¢å¤±ï¼Œè®¾ç½®æˆ17ç²¾åº¦ä¼šæ›´åŠ ç²¾ç¡®"><a href="#php7-jsonæµ®ç‚¹æ•°ç²¾åº¦ä¸¢å¤±ï¼Œè®¾ç½®æˆ17ç²¾åº¦ä¼šæ›´åŠ ç²¾ç¡®" class="headerlink" title="php7 jsonæµ®ç‚¹æ•°ç²¾åº¦ä¸¢å¤±ï¼Œè®¾ç½®æˆ17ç²¾åº¦ä¼šæ›´åŠ ç²¾ç¡®"></a>php7 jsonæµ®ç‚¹æ•°ç²¾åº¦ä¸¢å¤±ï¼Œè®¾ç½®æˆ17ç²¾åº¦ä¼šæ›´åŠ ç²¾ç¡®</h1><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">serialize_precision</span> = <span class="number">17</span></span><br></pre></td></tr></table></figure><h1 id="undefined-function-imagejpeg"><a href="#undefined-function-imagejpeg" class="headerlink" title="undefined function imagejpeg"></a>undefined function imagejpeg</h1><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…jpeg</span></span><br><span class="line"><span class="variable">$ </span>wget <span class="symbol">http:</span>/<span class="regexp">/www.ijg.org/files</span><span class="regexp">/jpegsrc.v9c.tar.gz</span></span><br><span class="line"><span class="regexp">$ tar zxvf jpegsrc.v9c.tar.gz</span></span><br><span class="line"><span class="regexp">$ cd jpeg-9c &amp;&amp; ./configure</span> --prefix=<span class="regexp">/usr/local</span><span class="regexp">/webserver/phpjpeglib</span> --enable-shared --enable-static &amp;&amp; make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡æ–°ç¼–è¯‘gdï¼Œå¹¶ä¸”æŒ‡å®šjpegç›®å½•</span></span><br><span class="line"><span class="variable">$ </span>cd php-src/etx/gd &amp;&amp; phpize</span><br><span class="line"><span class="variable">$ </span>./configure --<span class="keyword">with</span>-php-config=<span class="regexp">/usr/local</span><span class="regexp">/webserver/php</span><span class="regexp">/bin/php</span>-config --<span class="keyword">with</span>-jpeg=<span class="regexp">/usr/local</span><span class="regexp">/webserver/phpjpeglib</span>  --<span class="keyword">with</span>-freetype</span><br><span class="line"><span class="variable">$ </span>make &amp;&amp; make install</span><br><span class="line"><span class="comment"># æ£€æµ‹æ•ˆæœ</span></span><br><span class="line"><span class="variable">$ </span>php --re=gd | grep jpeg</span><br></pre></td></tr></table></figure><h1 id="undefined-function-imagettftext"><a href="#undefined-function-imagettftext" class="headerlink" title="undefined function imagettftext"></a>undefined function imagettftext</h1><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>cd php-src/etx/gd &amp;&amp; phpize</span><br><span class="line"><span class="variable">$ </span>./configure --<span class="keyword">with</span>-php-config=<span class="regexp">/usr/local</span><span class="regexp">/webserver/php</span><span class="regexp">/bin/php</span>-config --<span class="keyword">with</span>-jpeg=<span class="regexp">/usr/local</span><span class="regexp">/webserver/phpjpeglib</span>  --<span class="keyword">with</span>-freetype</span><br><span class="line"><span class="variable">$ </span>make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœè¿˜æ˜¯ä¸è¡Œåˆ™ï¼Œç¼–è¯‘å®‰è£…freetype</span></span><br><span class="line"><span class="variable">$ </span>wget <span class="symbol">https:</span>/<span class="regexp">/download.savannah.gnu.org/releases</span><span class="regexp">/freetype/freetype</span>-<span class="number">2.12</span>.<span class="number">1</span>.tar.gz --no-check-certificate</span><br><span class="line"><span class="variable">$ </span>tar zxvf tar zxvf freetype-<span class="number">2.12</span>.<span class="number">1</span>.tar.gz &amp;&amp; cd freetype-<span class="number">2.12</span>.<span class="number">1</span></span><br><span class="line"><span class="variable">$ </span>./configure --prefix=<span class="regexp">/usr/local</span><span class="regexp">/webserver/freetype</span> &amp;&amp; make &amp;&amp; make install</span><br><span class="line"><span class="comment"># ç„¶åç¼–è¯‘gdæ—¶ï¼Œå‚æ•°æŒ‡å®šè·¯å¾„ --with-freetype=/usr/local/webserver/freetype</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‚è®°</title>
      <link href="/posts/430d67de.html"/>
      <url>/posts/430d67de.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="phpæ•°ç»„éå†é¡ºåº"><a href="#phpæ•°ç»„éå†é¡ºåº" class="headerlink" title="phpæ•°ç»„éå†é¡ºåº"></a>phpæ•°ç»„éå†é¡ºåº</h1><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span>é€šè¿‡ç§»åŠ¨æ•°ç»„å†…éƒ¨æŒ‡é’ˆå®ç°éå†é¡ºåºï¼Œéå†ç»“æŸï¼ŒæŒ‡é’ˆæŒ‡å‘æœ«ç«¯ã€‚æ­¤æ—¶è·å–æŒ‡é’ˆä½ç½®(ä½¿ç”¨ç§»åŠ¨æŒ‡é’ˆçš„å‘½ä»¤prev/next/<span class="keyword">current</span>/<span class="keyword">end</span>/<span class="keyword">each</span>)å°†å¤±è´¥,éœ€è¦æ‰§è¡Œ<span class="keyword">reset</span>æ‰è¡Œã€‚</span><br><span class="line"><span class="keyword">foreach</span>éå†é¡ºåºæ˜¯æ ¹æ®å…ƒç´ æ’å…¥æ•°ç»„çš„å…ˆåé¡ºåºéå†çš„ã€‚</span><br><span class="line">æŒ‰ç…§æ•°å­—ç´¢å¼•å¤§å°è¿›è¡Œå¾ªç¯åº”è¯¥ä½¿ç”¨<span class="keyword">for</span>ã€‚</span><br></pre></td></tr></table></figure><h1 id="å­—ç¬¦å’Œ0æ¯”è¾ƒ"><a href="#å­—ç¬¦å’Œ0æ¯”è¾ƒ" class="headerlink" title="å­—ç¬¦å’Œ0æ¯”è¾ƒ"></a>å­—ç¬¦å’Œ0æ¯”è¾ƒ</h1><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>å’Œä»»æ„ä¸å¯è½¬åŒ–ä¸ºæ•°å­—çš„å­—ç¬¦ä¸²æ¯”è¾ƒ(æ“ä½œç¬¦ä¸º==), å‡è¿”å› <span class="literal">true</span></span><br></pre></td></tr></table></figure><h1 id="php-floatå†™å…¥rediså¯¼è‡´ç²¾åº¦ä¸¢å¤±"><a href="#php-floatå†™å…¥rediså¯¼è‡´ç²¾åº¦ä¸¢å¤±" class="headerlink" title="php floatå†™å…¥rediså¯¼è‡´ç²¾åº¦ä¸¢å¤±"></a>php floatå†™å…¥rediså¯¼è‡´ç²¾åº¦ä¸¢å¤±</h1><h1 id="php-é…ç½®ä¸­å°æ•°éƒ½æ˜¯è½¬æ¢ä¸ºdouble-è¯»å–14ä½æ•°-ç¬¬åäº”ä½å››èˆäº”å…¥"><a href="#php-é…ç½®ä¸­å°æ•°éƒ½æ˜¯è½¬æ¢ä¸ºdouble-è¯»å–14ä½æ•°-ç¬¬åäº”ä½å››èˆäº”å…¥" class="headerlink" title="php é…ç½®ä¸­å°æ•°éƒ½æ˜¯è½¬æ¢ä¸ºdouble,è¯»å–14ä½æ•°,ç¬¬åäº”ä½å››èˆäº”å…¥"></a>php é…ç½®ä¸­å°æ•°éƒ½æ˜¯è½¬æ¢ä¸ºdouble,è¯»å–14ä½æ•°,ç¬¬åäº”ä½å››èˆäº”å…¥</h1><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; The number of significant digits displayed in floating point numbers.</span></span><br><span class="line"><span class="comment">; http://php.net/precision</span></span><br><span class="line"><span class="attribute">precision</span> <span class="operator">=</span> <span class="number">14</span></span><br></pre></td></tr></table></figure><h1 id="redisçš„å°æ•°ä¼šè½¬æ¢ä¸ºdouble-doubleåŒç²¾åº¦æµ®ç‚¹æ•°æ®çš„æœ‰æ•ˆä½æ˜¯16ä½-å¯¼è‡´åå·®"><a href="#redisçš„å°æ•°ä¼šè½¬æ¢ä¸ºdouble-doubleåŒç²¾åº¦æµ®ç‚¹æ•°æ®çš„æœ‰æ•ˆä½æ˜¯16ä½-å¯¼è‡´åå·®" class="headerlink" title="redisçš„å°æ•°ä¼šè½¬æ¢ä¸ºdouble, doubleåŒç²¾åº¦æµ®ç‚¹æ•°æ®çš„æœ‰æ•ˆä½æ˜¯16ä½,å¯¼è‡´åå·®"></a>redisçš„å°æ•°ä¼šè½¬æ¢ä¸ºdouble, doubleåŒç²¾åº¦æµ®ç‚¹æ•°æ®çš„æœ‰æ•ˆä½æ˜¯16ä½,å¯¼è‡´åå·®</h1><h1 id="php-floatå†™å…¥-hSet-zAdd-sAdd-lPush-redisæ—¶-éœ€è¦è½¬æ¢ä¸ºstingç±»å‹"><a href="#php-floatå†™å…¥-hSet-zAdd-sAdd-lPush-redisæ—¶-éœ€è¦è½¬æ¢ä¸ºstingç±»å‹" class="headerlink" title="php floatå†™å…¥(hSet zAdd sAdd lPush)redisæ—¶,éœ€è¦è½¬æ¢ä¸ºstingç±»å‹"></a>php floatå†™å…¥(hSet zAdd sAdd lPush)redisæ—¶,éœ€è¦è½¬æ¢ä¸ºstingç±»å‹</h1><h1 id="md5-fileæ›¿ä»£æ–¹å¼"><a href="#md5-fileæ›¿ä»£æ–¹å¼" class="headerlink" title="md5_fileæ›¿ä»£æ–¹å¼"></a>md5_fileæ›¿ä»£æ–¹å¼</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$url</span> = <span class="string">&#x27;http://pic.917.com/2019/07/23/02104856lkwlfyid76qiii.jpg&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">md5_file</span>(<span class="variable">$url</span>));</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$url</span>)));</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">curl_content</span>(<span class="variable">$url</span>)));</span><br></pre></td></tr></table></figure><h1 id="å–æ¨¡è®¡ç®—æ–¹å¼"><a href="#å–æ¨¡è®¡ç®—æ–¹å¼" class="headerlink" title="å–æ¨¡è®¡ç®—æ–¹å¼"></a>å–æ¨¡è®¡ç®—æ–¹å¼</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å…ˆå°†ä¸¤ä¸ªæ•´æ•°çœ‹ä½œæ˜¯æ­£æ•°ï¼Œå†ä½œé™¤æ³•è¿ç®—:</span></span><br><span class="line"><span class="comment">// 1ã€èƒ½æ•´é™¤æ—¶ï¼Œå…¶å€¼ä¸º 0</span></span><br><span class="line"><span class="comment">// 2ã€ä¸èƒ½æ•´é™¤æ—¶ï¼Œå…¶å€¼=é™¤æ•°Ã—(æ•´å•†+1)-è¢«é™¤æ•°</span></span><br><span class="line"><span class="comment">// 91/26=3.5å–3, (3+1)*26 - 91 = 13 </span></span><br><span class="line"><span class="keyword">echo</span> <span class="number">91</span> % <span class="number">26</span>;</span><br></pre></td></tr></table></figure><h1 id="php-hash-hmac-sha256åŠ å¯†å¯¹åº”javaåŠ å¯†"><a href="#php-hash-hmac-sha256åŠ å¯†å¯¹åº”javaåŠ å¯†" class="headerlink" title="php hash_hmac sha256åŠ å¯†å¯¹åº”javaåŠ å¯†"></a>php hash_hmac sha256åŠ å¯†å¯¹åº”javaåŠ å¯†</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// php hashåŠ å¯†å¯¹åº”javaåŠ å¯†ï¼Œå¦‚æœè¿˜æ˜¯ä¸è¡Œï¼Œå¯èƒ½åŠ å¯†çš„å­—ç¬¦ä¸²ä¸­å­˜åœ¨è½¬ä¹‰å­—ç¬¦</span></span><br><span class="line"><span class="comment">// Javaä¸­sha256HMACåå¾—åˆ°çš„å€¼ä¸ºäºŒè¿›åˆ¶,php ä¹Ÿéœ€è¦è½¬æ¢ä¸ºäºŒè¿›åˆ¶</span></span><br><span class="line"><span class="variable">$signature</span> = <span class="title function_ invoke__">hash_hmac</span>(<span class="string">&#x27;sha256&#x27;</span>, <span class="variable">$callback_url</span>, <span class="variable">$akey</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="variable">$signature</span> = <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$signature</span>);</span><br><span class="line"><span class="comment">// javaä¸­Base64.encodeBase64URLSafeString(bytes) ä¼šå°† ç‰¹æ®Šå­—ç¬¦â€˜+/â€™æ›¿æ¢ä¸º&#x27;-_&#x27;,ä¼šå°†â€˜=â€™å»æ‰</span></span><br><span class="line"><span class="comment">// phpéœ€è¦æ‰‹åŠ¨å¤„ç†æ›¿æ¢</span></span><br><span class="line"><span class="variable">$signature</span> = <span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&#x27;+&#x27;</span>,<span class="string">&#x27;/&#x27;</span>),<span class="keyword">array</span>(<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;_&#x27;</span>),<span class="variable">$signature</span>);</span><br></pre></td></tr></table></figure><h1 id="åˆ¤æ–­æ˜¯å¦çº¯æ•°å­—"><a href="#åˆ¤æ–­æ˜¯å¦çº¯æ•°å­—" class="headerlink" title="åˆ¤æ–­æ˜¯å¦çº¯æ•°å­—"></a>åˆ¤æ–­æ˜¯å¦çº¯æ•°å­—</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ¤æ–­æ•°å­—ï¼Œå¦‚æœå¼€å¤´æ˜¯æ•°å­—çš„å­—ç¬¦ä¸²ä¹Ÿä¼šåˆ¤å®šä¸ºæ•°å­—</span></span><br><span class="line"><span class="title function_ invoke__">is_number</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ¤æ–­çº¯æ•°å­—</span></span><br><span class="line"><span class="title function_ invoke__">ctype_digit</span>();</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>rediså¤šå®ä¾‹</title>
      <link href="/posts/bb0d3e20.html"/>
      <url>/posts/bb0d3e20.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><p>ä¸€ã€é…ç½®å¤šå®ä¾‹<br>1.æ–°å¢å®ä¾‹é…ç½®æ–‡ä»¶, ä¿®æ”¹bind(å¦‚æœ‰éœ€è¦)å’Œportå‚æ•°<br>2.è¿è¡Œæ–°å¢çš„å®ä¾‹</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># windos</span><br><span class="line">runhiddenconsole.<span class="keyword">exe</span> redis-server redis.windows.<span class="keyword">conf</span></span><br><span class="line">runhiddenconsole.<span class="keyword">exe</span> redis-server redis.windows-<span class="keyword">new</span>.<span class="keyword">conf</span></span><br><span class="line">::runhiddenconsole.<span class="keyword">exe</span> redis-server redis.windows.<span class="keyword">conf</span> --service-start</span><br><span class="line">::runhiddenconsole.<span class="keyword">exe</span> redis-server redis.windows-<span class="keyword">new</span>.<span class="keyword">conf</span> --service-start</span><br><span class="line"></span><br><span class="line"># linux</span><br><span class="line">redis-server redis.<span class="keyword">conf</span></span><br><span class="line">redis-server redis-<span class="keyword">new</span>.<span class="keyword">conf</span></span><br></pre></td></tr></table></figure><p>äºŒã€PHPä¸­ä½¿ç”¨å¤šå®ä¾‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;REDIS_CONFIG&#x27;</span>, <span class="string">&#x27;redis://127.0.0.2:6379/0&#x27;</span>); <span class="comment">// é»˜è®¤-ç½‘ç«™é…ç½®ä¿¡æ¯</span></span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;REDIS_new&#x27;</span>, <span class="string">&#x27;redis://127.0.0.2:6370/0&#x27;</span>); <span class="comment">// æ–°å®ä¾‹</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">redis</span>(<span class="params"><span class="variable">$redisConfType</span> = <span class="string">&quot;REDIS_CONFIG&quot;</span></span>)</span>&#123;</span><br><span class="line"><span class="comment">//    static $redisList=[];//ç”¨äºåˆ¤æ–­redisä¸€ä¸ªphpç”Ÿå‘½å‘¨æœŸå†…æ˜¯å¦è¦é‡æ–°è¿æ¥</span></span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$redisList</span>;</span><br><span class="line">    <span class="comment">//åˆ¤æ–­redisæ˜¯å¦å·²è¿æ¥</span></span><br><span class="line">    <span class="keyword">if</span>( <span class="keyword">empty</span>(<span class="variable">$redisList</span>[<span class="variable">$redisConfType</span>]) )&#123;</span><br><span class="line">        <span class="variable">$cfg</span> = <span class="title function_ invoke__">parse_url</span>( <span class="title function_ invoke__">constant</span>(<span class="variable">$redisConfType</span>) );</span><br><span class="line">        <span class="keyword">if</span>( <span class="keyword">empty</span>(<span class="variable">$cfg</span>[<span class="string">&#x27;path&#x27;</span>]) )&#123;</span><br><span class="line">            <span class="title function_ invoke__">trigger_error</span>(<span class="string">&#x27;Invalid redis db name&#x27;</span>,E_USER_ERROR);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$cfg</span>[<span class="string">&#x27;path&#x27;</span>] = <span class="title function_ invoke__">intval</span>( <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$cfg</span>[<span class="string">&#x27;path&#x27;</span>]));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>( <span class="keyword">isset</span>(<span class="variable">$cfg</span>[<span class="string">&#x27;scheme&#x27;</span>]) &amp;&amp; <span class="variable">$cfg</span>[<span class="string">&#x27;scheme&#x27;</span>]==<span class="string">&#x27;redis&#x27;</span> )&#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="variable">$redisList</span>[<span class="variable">$redisConfType</span>] = <span class="keyword">new</span> <span class="title class_">Redis</span>();</span><br><span class="line">                <span class="variable">$ret</span> = <span class="variable">$redisList</span>[<span class="variable">$redisConfType</span>]-&gt;<span class="title function_ invoke__">pconnect</span>(<span class="variable">$cfg</span>[<span class="string">&#x27;host&#x27;</span>], <span class="variable">$cfg</span>[<span class="string">&#x27;port&#x27;</span>], <span class="number">0.3</span>);</span><br><span class="line">                <span class="variable">$redisList</span>[<span class="variable">$redisConfType</span>]-&gt;<span class="title function_ invoke__">select</span>(<span class="variable">$cfg</span>[<span class="string">&#x27;path&#x27;</span>]);</span><br><span class="line">            &#125;<span class="keyword">catch</span>(<span class="built_in">Exception</span> <span class="variable">$e</span>)&#123;</span><br><span class="line">                <span class="variable">$redisList</span>[<span class="variable">$redisConfType</span>] = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$redisList</span>[<span class="variable">$redisConfType</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>scan</title>
      <link href="/posts/c4b3b3ae.html"/>
      <url>/posts/c4b3b3ae.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;<br>    <span id="more"></span><br>    &lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><pre><code><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨scanæ›¿ä»£keys</span></span><br><span class="line"><span class="comment"> * Date: 2018/9/26 0026</span></span><br><span class="line"><span class="comment"> * Time: ä¸‹åˆ 12:00</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘½ä»¤è¡Œæ–¹å¼ redis-cli --scan --pattern &#x27;*&#x27;</span></span><br><span class="line"><span class="variable">$redis</span> = <span class="keyword">new</span> <span class="title class_">Redis</span>();</span><br><span class="line"><span class="variable">$redis</span>-&gt;<span class="title function_ invoke__">connect</span>(<span class="string">&#x27;127.0.0.1&#x27;</span>);</span><br><span class="line"><span class="comment">// å¦‚æœscanä¸ºç©ºï¼Œå°†é‡è¯•ç›´åˆ°éå†ç»“æŸ</span></span><br><span class="line"><span class="variable">$redis</span>-&gt;<span class="title function_ invoke__">setOption</span>(<span class="title class_">Redis</span>::<span class="variable constant_">OPT_SCAN</span>, <span class="title class_">Redis</span>::<span class="variable constant_">SCAN_RETRY</span>);</span><br><span class="line"><span class="variable">$iterator</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="variable">$list</span> = [];</span><br><span class="line"><span class="variable">$match</span> = <span class="string">&#x27;sell:*&#x27;</span>;</span><br><span class="line"><span class="keyword">while</span>(<span class="variable">$keys</span> = <span class="variable">$redis</span>-&gt;<span class="title function_ invoke__">scan</span>(<span class="variable">$iterator</span>, <span class="variable">$match</span>, <span class="number">10</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;item:<span class="subst">&#123;$iterator&#125;</span>\n&quot;</span>;</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$keys</span> <span class="keyword">as</span> <span class="variable">$key</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$key</span> . PHP_EOL;</span><br><span class="line">        <span class="variable">$list</span>[] = <span class="variable">$key</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">count</span>(<span class="variable">$list</span>) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span>(<span class="title function_ invoke__">count</span>(<span class="variable">$redis</span>-&gt;<span class="title function_ invoke__">keys</span>(<span class="variable">$match</span>)));</span><br></pre></td></tr></table></figure></code></pre>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>redis config</title>
      <link href="/posts/32c151bb.html"/>
      <url>/posts/32c151bb.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="redisä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œ"><a href="#redisä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œ" class="headerlink" title="redisä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œ"></a>redisä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œ</h1><h1 id="noè¡¨ç¤ºä¸ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œ-ä¼šå ç”¨ä¸€ä¸ªç»ˆç«¯"><a href="#noè¡¨ç¤ºä¸ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œ-ä¼šå ç”¨ä¸€ä¸ªç»ˆç«¯" class="headerlink" title="noè¡¨ç¤ºä¸ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œ(ä¼šå ç”¨ä¸€ä¸ªç»ˆç«¯)"></a>noè¡¨ç¤ºä¸ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œ(ä¼šå ç”¨ä¸€ä¸ªç»ˆç«¯)</h1><p>daemonize yes</p><h1 id="ä¿®æ”¹ç›®å½•"><a href="#ä¿®æ”¹ç›®å½•" class="headerlink" title="ä¿®æ”¹ç›®å½•"></a>ä¿®æ”¹ç›®å½•</h1><p>dir &#x2F;data&#x2F;redis&#x2F;</p><h1 id><a href="#" class="headerlink" title></a></h1><p>appendonly yes</p><h1 id="Save-the-DB-on-disk"><a href="#Save-the-DB-on-disk" class="headerlink" title="Save the DB on disk:"></a>Save the DB on disk:</h1><h1 id="å…³é—­"><a href="#å…³é—­" class="headerlink" title="å…³é—­"></a>å…³é—­</h1><p>#save 900 1<br>#save 300 10<br>#save 60 10000</p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>curlå°è£…</title>
      <link href="/posts/7dafab05.html"/>
      <url>/posts/7dafab05.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="curlå°è£…"><a href="#curlå°è£…" class="headerlink" title="curlå°è£…"></a>curlå°è£…</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * curlè·å–ä¿¡æ¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $url</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> array $curl_data postæ•°æ®</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int $timeout è¿æ¥è¶…æ—¶æ—¶é—´</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> bool|int|mixed|string</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">curl_get_content</span>(<span class="params"><span class="variable">$url</span>, <span class="keyword">array</span> <span class="variable">$curl_data</span> = [], <span class="variable">$conTimeout</span> = <span class="number">5</span>, <span class="variable">$timeout</span> = <span class="number">60</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$curl_data</span>[<span class="string">&#x27;user_agent&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$curl_data</span>[<span class="string">&#x27;user_agent&#x27;</span>] = <span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.101 Safari/537.36&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$Curl</span>=<span class="title function_ invoke__">curl_init</span>();<span class="comment">//å®ä¾‹åŒ–cURL</span></span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$Curl</span>, CURLOPT_URL, <span class="variable">$url</span>);<span class="comment">//åˆå§‹åŒ–è·¯å¾„</span></span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$Curl</span>, CURLOPT_USERAGENT, <span class="variable">$curl_data</span>[<span class="string">&#x27;user_agent&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$curl_data</span>[<span class="string">&#x27;post_data&#x27;</span>])&#123;</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span> (<span class="variable">$Curl</span>, CURLOPT_POST, <span class="number">1</span>);</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$Curl</span>, CURLOPT_POSTFIELDS, <span class="variable">$curl_data</span>[<span class="string">&#x27;post_data&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$Curl</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);<span class="comment">//0è·å–åç›´æ¥æ‰“å°å‡ºæ¥</span></span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span> (<span class="variable">$Curl</span>, CURLOPT_CONNECTTIMEOUT, <span class="variable">$conTimeout</span>);</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span> (<span class="variable">$Curl</span>, CURLOPT_TIMEOUT, <span class="variable">$timeout</span>);</span><br><span class="line">    <span class="comment">//è½¬ç ã€è§£é‡Šgzipå†…å®¹</span></span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$Curl</span>, CURLOPT_HTTPHEADER,<span class="keyword">array</span>(<span class="string">&#x27;Accept-Encoding: gzip, deflate&#x27;</span>));</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$Curl</span>, CURLOPT_ENCODING, <span class="string">&#x27;gzip,deflate&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$Curl</span>, CURLOPT_HEADER, <span class="number">0</span>);<span class="comment">//0å…³é—­æ‰“å°ç›¸åº”å¤´,ç›´æ¥æ‰“å°éœ€ä¸º1,</span></span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$Curl</span>, CURLOPT_SSL_VERIFYPEER , <span class="literal">false</span>);</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$Curl</span>, CURLOPT_SSL_VERIFYHOST , <span class="literal">false</span>);</span><br><span class="line">    <span class="variable">$result</span>=<span class="title function_ invoke__">curl_exec</span>(<span class="variable">$Curl</span>);<span class="comment">//æ‰§è¡Œä¸€ä¸ªcURLä¼šè¯</span></span><br><span class="line">    <span class="comment">//è½¬ç </span></span><br><span class="line">    <span class="variable">$result</span>=<span class="title function_ invoke__">mb_convert_encoding</span>(<span class="variable">$result</span>, <span class="string">&#x27;UTF-8&#x27;</span>, <span class="string">&#x27;UTF-8,GBK,gb2312,BIG5&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$result</span> === <span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="variable">$result</span>[<span class="string">&#x27;error&#x27;</span>] = <span class="title function_ invoke__">curl_error</span>(<span class="variable">$Curl</span>);</span><br><span class="line">        <span class="variable">$result</span>[<span class="string">&#x27;info&#x27;</span>] = <span class="title function_ invoke__">curl_getinfo</span>(<span class="variable">$Curl</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$lastUrl</span> =  <span class="title function_ invoke__">curl_getinfo</span>(<span class="variable">$Curl</span>, CURLINFO_EFFECTIVE_URL);</span><br><span class="line">    <span class="title function_ invoke__">curl_close</span>(<span class="variable">$Curl</span>);<span class="comment">//å…³é—­cURLä¼šè¯</span></span><br><span class="line">    <span class="comment">//callbackä¸ºéªŒè¯ç </span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$lastUrl</span> , <span class="string">&#x27;callback&#x27;</span>) !== <span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$result</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h1 id="php-curl-è°ƒç”¨curl-exec-è¿”å›-bool-false-ï¼›"><a href="#php-curl-è°ƒç”¨curl-exec-è¿”å›-bool-false-ï¼›" class="headerlink" title="php curl è°ƒç”¨curl_exec() è¿”å› bool(false)ï¼›"></a>php curl è°ƒç”¨curl_exec() è¿”å› bool(false)ï¼›</h1><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">åŸå› <span class="symbol">:SSl</span>è¯ä¹¦é—®é¢˜</span><br><span class="line">è§£å†³æ–¹æ³•:</span><br><span class="line">curl_setopt(<span class="variable">$ch</span>, <span class="title class_">CURLOPT_SSL_VERIFYPEER</span> , <span class="literal">false</span>);</span><br><span class="line">curl_setopt(<span class="variable">$ch</span>, <span class="title class_">CURLOPT_SSL_VERIFYHOST</span> , <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="title class_">CURLOPT_CONNECTTIMEOUT</span>ç”¨æ¥å‘Šè¯‰<span class="title class_">PHP</span>è„šæœ¬åœ¨æˆåŠŸè¿æ¥æœåŠ¡å™¨å‰ç­‰å¾…å¤šä¹…ï¼ˆè¿æ¥æˆåŠŸä¹‹åå°±ä¼šå¼€å§‹ç¼“å†²è¾“å‡ºï¼‰ï¼Œè¿™ä¸ªå‚æ•°æ˜¯ä¸ºäº†åº”å¯¹ç›®æ ‡æœåŠ¡å™¨çš„è¿‡è½½ï¼Œä¸‹çº¿ï¼Œæˆ–è€…å´©æºƒç­‰å¯èƒ½çŠ¶å†µï¼›</span><br><span class="line"><span class="title class_">CURLOPT_TIMEOUT</span>ç”¨æ¥å‘Šè¯‰æˆåŠŸ<span class="title class_">PHP</span>è„šæœ¬ï¼Œä»æœåŠ¡å™¨æ¥æ”¶ç¼“å†²å®Œæˆå‰éœ€è¦ç­‰å¾…å¤šé•¿æ—¶é—´ã€‚å¦‚æœç›®æ ‡æ˜¯ä¸ªå·¨å¤§çš„æ–‡ä»¶ï¼Œç”Ÿæˆå†…å®¹é€Ÿåº¦è¿‡æ…¢æˆ–è€…é“¾è·¯é€Ÿåº¦è¿‡æ…¢ï¼Œè¿™ä¸ªå‚æ•°å°±ä¼šå¾ˆæœ‰ç”¨ã€‚</span><br><span class="line">ä½¿ç”¨cURLä¸‹è½½<span class="title class_">MP3</span>æ–‡ä»¶æ˜¯ä¸€ä¸ªå¯¹å¼€å‘äººå‘˜æ¥è¯´ä¸é”™çš„ä¾‹å­ã€‚</span><br><span class="line"><span class="title class_">CURLOPT_CONNECTTIMEOUT</span> å¯ä»¥è®¾ç½®ä¸º<span class="number">10</span>ç§’ï¼Œæ ‡è¯†å¦‚æœæœåŠ¡å™¨<span class="number">10</span>ç§’å†…æ²¡æœ‰å“åº”ï¼Œè„šæœ¬å°±ä¼šæ–­å¼€è¿æ¥ï¼›<span class="title class_">CURLOPT_TIMEOUT</span>å¯ä»¥è®¾ç½®ä¸º<span class="number">100</span>ï¼Œå¦‚æœ<span class="title class_">MP3</span>æ–‡ä»¶<span class="number">100</span>ç§’å†…æ²¡æœ‰ä¸‹è½½å®Œæˆï¼Œè„šæœ¬å°†ä¼šæ–­å¼€è¿æ¥ã€‚</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>headeræ–¹æ³•</title>
      <link href="/posts/b49d2b45.html"/>
      <url>/posts/b49d2b45.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="phpçš„headerå‡½æ•°ä¹‹è®¾ç½®content-type"><a href="#phpçš„headerå‡½æ•°ä¹‹è®¾ç½®content-type" class="headerlink" title="phpçš„headerå‡½æ•°ä¹‹è®¾ç½®content-type"></a>phpçš„headerå‡½æ•°ä¹‹è®¾ç½®content-type</h1><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line">å¼•ç”¨åœ°å€</span><br><span class="line"><span class="comment">//å®šä¹‰ç¼–ç </span></span><br><span class="line"><span class="built_in">header</span>( &#x27;Content-<span class="built_in">Type</span>:text/html;charset=utf<span class="number">-8</span> &#x27;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Atom</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;Content-<span class="built_in">type</span>: application/atom+xml&#x27;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//CSS</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;Content-<span class="built_in">type</span>: text/css&#x27;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Javascript</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;Content-<span class="built_in">type</span>: text/javascript&#x27;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//JPEG Image</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;Content-<span class="built_in">type</span>: image/jpeg&#x27;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//JSON</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;Content-<span class="built_in">type</span>: application/json&#x27;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//PDF</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;Content-<span class="built_in">type</span>: application/pdf&#x27;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//RSS</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;Content-<span class="built_in">Type</span>: application/rss+xml; charset=ISO<span class="number">-8859</span><span class="number">-1</span>&#x27;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Text (Plain)</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;Content-<span class="built_in">type</span>: text/plain&#x27;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//XML</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;Content-<span class="built_in">type</span>: text/xml&#x27;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ok</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;HTTP/<span class="number">1.1</span> <span class="number">200</span> OK&#x27;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//è®¾ç½®ä¸€ä¸ª404å¤´:</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;HTTP/<span class="number">1.1</span> <span class="number">404</span> Not Found&#x27;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//è®¾ç½®åœ°å€è¢«æ°¸ä¹…çš„é‡å®šå‘</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;HTTP/<span class="number">1.1</span> <span class="number">301</span> Moved Permanently&#x27;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//è½¬åˆ°ä¸€ä¸ªæ–°åœ°å€</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;Location: http://www.example.org/&#x27;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ–‡ä»¶å»¶è¿Ÿè½¬å‘:</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;Refresh: <span class="number">10</span>; url=http://www.example.org/&#x27;);</span><br><span class="line"><span class="keyword">print</span> &#x27;You will be redirected in <span class="number">10</span> seconds&#x27;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨htmlè¯­æ³•å®ç°</span></span><br><span class="line"><span class="comment">// &lt;meta http-equiv=&quot;refresh&quot; content=&quot;10;http://www.example.org/ /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// override X-Powered-By: PHP:</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;X-Powered-By: PHP/<span class="number">4.4</span><span class="number">.0</span>&#x27;);</span><br><span class="line"><span class="built_in">header</span>(&#x27;X-Powered-By: Brain/<span class="number">0.6</span>b&#x27;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ–‡æ¡£è¯­è¨€</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;Content-language: en&#x27;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//å‘Šè¯‰æµè§ˆå™¨æœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´</span></span><br><span class="line">$time = <span class="built_in">time</span>() - <span class="number">60</span>; <span class="comment">// or filemtime($fn), etc</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;Last-Modified: &#x27;.<span class="built_in">gmdate</span>(&#x27;D, d M Y H:i:s&#x27;, $<span class="built_in">time</span>).&#x27; GMT&#x27;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//å‘Šè¯‰æµè§ˆå™¨æ–‡æ¡£å†…å®¹æ²¡æœ‰å‘ç”Ÿæ”¹å˜</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;HTTP/<span class="number">1.1</span> <span class="number">304</span> Not Modified&#x27;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//è®¾ç½®å†…å®¹é•¿åº¦</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;Content-Length: <span class="number">1234</span>&#x27;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//è®¾ç½®ä¸ºä¸€ä¸ªä¸‹è½½ç±»å‹</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;Content-<span class="built_in">Type</span>: application/octet-stream&#x27;);</span><br><span class="line"><span class="built_in">header</span>(&#x27;Content-Disposition: attachment; filename=<span class="string">&quot;example.zip&quot;</span>&#x27;);</span><br><span class="line"><span class="built_in">header</span>(&#x27;Content-Transfer-Encoding: binary&#x27;);</span><br><span class="line"><span class="comment">// load the file to send:</span></span><br><span class="line"><span class="built_in">readfile</span>(&#x27;example.zip&#x27;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹å½“å‰æ–‡æ¡£ç¦ç”¨ç¼“å­˜</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;Cache-Control: no-cache, no-store, max-age=<span class="number">0</span>, must-revalidate&#x27;);</span><br><span class="line"><span class="built_in">header</span>(&#x27;Expires: Mon, <span class="number">26</span> Jul <span class="number">1997</span> <span class="number">05</span>:<span class="number">00</span>:<span class="number">00</span> GMT&#x27;); <span class="comment">// Date in the past</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;Pragma: no-cache&#x27;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//è®¾ç½®å†…å®¹ç±»å‹:</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;Content-<span class="built_in">Type</span>: text/html; charset=iso<span class="number">-8859</span><span class="number">-1</span>&#x27;);</span><br><span class="line"><span class="built_in">header</span>(&#x27;Content-<span class="built_in">Type</span>: text/html; charset=utf<span class="number">-8</span>&#x27;);</span><br><span class="line"><span class="built_in">header</span>(&#x27;Content-<span class="built_in">Type</span>: text/plain&#x27;); <span class="comment">//çº¯æ–‡æœ¬æ ¼å¼</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;Content-<span class="built_in">Type</span>: image/jpeg&#x27;); <span class="comment">//JPG***</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;Content-<span class="built_in">Type</span>: application/zip&#x27;); <span class="comment">// ZIPæ–‡ä»¶</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;Content-<span class="built_in">Type</span>: application/pdf&#x27;); <span class="comment">// PDFæ–‡ä»¶</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;Content-<span class="built_in">Type</span>: audio/mpeg&#x27;); <span class="comment">// éŸ³é¢‘æ–‡ä»¶</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;Content-<span class="built_in">Type</span>: application/x-shockw**e-flash&#x27;); <span class="comment">//FlashåŠ¨ç”»</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ˜¾ç¤ºç™»é™†å¯¹è¯æ¡†</span></span><br><span class="line"><span class="built_in">header</span>(&#x27;HTTP/<span class="number">1.1</span> <span class="number">401</span> Unauthorized&#x27;);</span><br><span class="line"><span class="built_in">header</span>(&#x27;WWW-Authenticate: Basic realm=<span class="string">&quot;Top Secret&quot;</span>&#x27;);</span><br><span class="line"><span class="keyword">print</span> &#x27;Text that will be displayed <span class="keyword">if</span> the user hits cancel <span class="keyword">or</span> &#x27;;</span><br><span class="line"><span class="keyword">print</span> &#x27;enters wrong login data&#x27;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ä¸‹è½½xlsæ–‡ä»¶</span><br><span class="line">$filename = <span class="built_in">rtrim</span>($_SERVER[&#x27;DOCUMENT_ROOT&#x27;],&#x27;/&#x27;).&#x27;/app/files/payment_status.csv&#x27;;</span><br><span class="line"><span class="built_in">header</span>(&#x27;Content-Disposition: attachment; filename=payment_status.xlsx&#x27;);</span><br><span class="line"><span class="built_in">header</span>(&#x27;Content-<span class="built_in">Type</span>: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&#x27;);</span><br><span class="line"><span class="built_in">header</span>(&#x27;Content-Length: &#x27; . <span class="built_in">filesize</span>($filename));</span><br><span class="line"><span class="built_in">header</span>(&#x27;Content-Transfer-Encoding: binary&#x27;);</span><br><span class="line"><span class="built_in">header</span>(&#x27;Cache-Control: must-revalidate&#x27;);</span><br><span class="line"><span class="built_in">header</span>(&#x27;Pragma: public&#x27;);</span><br><span class="line"><span class="built_in">readfile</span>($filename);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>set_time_limit</title>
      <link href="/posts/410d7417.html"/>
      <url>/posts/410d7417.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‘½ä»¤è¡Œä¸­curlæ–¹å¼é…ç½®è„šæœ¬æ—¶é—´æ— æ•ˆ</span></span><br><span class="line"><span class="comment"># php.ini</span></span><br><span class="line"><span class="attribute">max_execution_time</span> = <span class="number">300</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># php-fpm.conf</span></span><br><span class="line">request_terminate_timeout = <span class="number">300</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># nginx.conf</span></span><br><span class="line"><span class="comment"># æ‰€æœ‰ç«™ç‚¹</span></span><br><span class="line">http &#123;</span><br><span class="line"><span class="attribute">fastcgi_read_timeout</span> <span class="number">300</span>; </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># æŒ‡å®šç«™ç‚¹</span></span><br><span class="line"><span class="section">location</span> <span class="regexp">~ \.php$</span> &#123;</span><br><span class="line"><span class="attribute">include</span> /etc/nginx/fastcgi_params;</span><br><span class="line">        <span class="attribute">fastcgi_pass</span>  unix:/var/run/php5-fpm.sock;</span><br><span class="line"><span class="attribute">fastcgi_read_timeout</span> <span class="number">300</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡å¯php-fpmå’Œnginx</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>strtotime</title>
      <link href="/posts/b9cb5dc4.html"/>
      <url>/posts/b9cb5dc4.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä»¤äººå›°æƒ‘çš„strtotime"><a href="#ä»¤äººå›°æƒ‘çš„strtotime" class="headerlink" title="ä»¤äººå›°æƒ‘çš„strtotime"></a>ä»¤äººå›°æƒ‘çš„strtotime</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">date</span>(<span class="string">&#x27;Y-m-d&#x27;</span>, <span class="title function_ invoke__">strtotime</span>(<span class="string">&#x27;-1 month&#x27;</span>, <span class="title function_ invoke__">strtotime</span>(<span class="string">&#x27;2018-07-31&#x27;</span>)));</span><br><span class="line"><span class="comment">// è¾“å‡º2018-07-01</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ¨¡æ‹Ÿä¸‹dateå†…éƒ¨çš„å¯¹äºè¿™ç§äº‹æƒ…çš„å¤„ç†é€»è¾‘:</p><ol><li>å…ˆåš-1 month, é‚£ä¹ˆå½“å‰æ˜¯07-31, å‡å»ä¸€ä»¥åå°±æ˜¯06-31.</li><li>å†åšæ—¥æœŸè§„èŒƒåŒ–, å› ä¸º6æœˆæ²¡æœ‰31å·, æ‰€ä»¥å°±å¥½åƒ2ç‚¹60ç­‰äº3ç‚¹ä¸€æ ·, 6æœˆ31å°±ç­‰äºäº†7æœˆ1<br>ä¹Ÿå°±æ˜¯è¯´, åªè¦æ¶‰åŠåˆ°å¤§å°æœˆçš„æœ€åä¸€å¤©, éƒ½å¯èƒ½ä¼šæœ‰è¿™ä¸ªè¿·æƒ‘, æˆ‘ä»¬ä¹Ÿå¯ä»¥å¾ˆè½»æ¾çš„éªŒè¯ç±»ä¼¼çš„å…¶ä»–æœˆä»½, å°è¯è¿™ä¸ªç»“è®º:<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">date</span>(<span class="string">&quot;Y-m-d&quot;</span>, <span class="title function_ invoke__">strtotime</span>(<span class="string">&quot;-1 month&quot;</span>, <span class="title function_ invoke__">strtotime</span>(<span class="string">&quot;2017-03-31&quot;</span>))));</span><br><span class="line"><span class="comment">//è¾“å‡º2017-03-03</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">date</span>(<span class="string">&quot;Y-m-d&quot;</span>, <span class="title function_ invoke__">strtotime</span>(<span class="string">&quot;+1 month&quot;</span>, <span class="title function_ invoke__">strtotime</span>(<span class="string">&quot;2017-08-31&quot;</span>))));</span><br><span class="line"><span class="comment">//è¾“å‡º2017-10-01</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">date</span>(<span class="string">&quot;Y-m-d&quot;</span>, <span class="title function_ invoke__">strtotime</span>(<span class="string">&quot;next month&quot;</span>, <span class="title function_ invoke__">strtotime</span>(<span class="string">&quot;2017-01-31&quot;</span>))));</span><br><span class="line"><span class="comment">//è¾“å‡º2017-03-03</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">date</span>(<span class="string">&quot;Y-m-d&quot;</span>, <span class="title function_ invoke__">strtotime</span>(<span class="string">&quot;last month&quot;</span>, <span class="title function_ invoke__">strtotime</span>(<span class="string">&quot;2017-03-31&quot;</span>))));</span><br><span class="line"><span class="comment">//è¾“å‡º2017-03-03</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></li></ol><p>ä»PHP5.3å¼€å§‹å‘¢, dateæ–°å¢äº†ä¸€ç³»åˆ—ä¿®æ­£çŸ­è¯­, æ¥æ˜ç¡®è¿™ä¸ªé—®é¢˜, é‚£å°±æ˜¯â€first day ofâ€ å’Œ â€œlast day ofâ€, ä¹Ÿå°±æ˜¯ä½ å¯ä»¥é™å®šå¥½ä¸è¦è®©dateè‡ªåŠ¨â€è§„èŒƒåŒ–â€:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">date</span>(<span class="string">&quot;Y-m-d&quot;</span>, <span class="title function_ invoke__">strtotime</span>(<span class="string">&quot;last day of -1 month&quot;</span>, <span class="title function_ invoke__">strtotime</span>(<span class="string">&quot;2017-03-31&quot;</span>))));</span><br><span class="line"><span class="comment">//è¾“å‡º2017-02-28</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">date</span>(<span class="string">&quot;Y-m-d&quot;</span>, <span class="title function_ invoke__">strtotime</span>(<span class="string">&quot;first day of +1 month&quot;</span>, <span class="title function_ invoke__">strtotime</span>(<span class="string">&quot;2017-08-31&quot;</span>))));</span><br><span class="line"><span class="comment">////è¾“å‡º2017-09-01</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">date</span>(<span class="string">&quot;Y-m-d&quot;</span>, <span class="title function_ invoke__">strtotime</span>(<span class="string">&quot;first day of next month&quot;</span>, <span class="title function_ invoke__">strtotime</span>(<span class="string">&quot;2017-01-31&quot;</span>))));</span><br><span class="line"><span class="comment">////è¾“å‡º2017-02-01</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">date</span>(<span class="string">&quot;Y-m-d&quot;</span>, <span class="title function_ invoke__">strtotime</span>(<span class="string">&quot;last day of last month&quot;</span>, <span class="title function_ invoke__">strtotime</span>(<span class="string">&quot;2017-03-31&quot;</span>))));</span><br><span class="line"><span class="comment">////è¾“å‡º2017-02-28</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>YII</title>
      <link href="/posts/b297c155.html"/>
      <url>/posts/b297c155.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è®°å½•æ•°æ®å·®é›†</span></span><br><span class="line"><span class="comment"> * Class className</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">className</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">actionUpdate</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$model</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">findModel</span>(<span class="variable">$id</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$old</span> = <span class="variable">$model</span>-&gt;attributes;</span><br><span class="line">        <span class="variable">$old</span>[<span class="string">&#x27;add_uid&#x27;</span>] = <span class="string">&#x27;uid&#x27;</span>;</span><br><span class="line">        <span class="variable">$post</span> = <span class="title class_">Yii</span>::<span class="variable">$app</span>-&gt;request-&gt;<span class="title function_ invoke__">post</span>();</span><br><span class="line">        <span class="variable">$new</span> = <span class="variable">$post</span>[<span class="string">&#x27;Message&#x27;</span>];</span><br><span class="line"></span><br><span class="line">        <span class="variable">$old_value</span> = <span class="title function_ invoke__">array_intersect_key</span>(<span class="variable">$old</span>, <span class="variable">$new</span>);</span><br><span class="line">        <span class="variable">$new_value</span> = <span class="title function_ invoke__">array_intersect_key</span>(<span class="variable">$new</span>, <span class="variable">$old</span>);</span><br><span class="line">        <span class="variable">$old_values</span> = <span class="title function_ invoke__">array_diff</span>(<span class="variable">$old_value</span>, <span class="variable">$new_value</span>);</span><br><span class="line">        <span class="variable">$new_values</span> = <span class="title function_ invoke__">array_diff</span>(<span class="variable">$new_value</span>, <span class="variable">$old_value</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">createLog</span>(<span class="variable">$old_values</span>, <span class="variable">$new_values</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$model</span>-&gt;<span class="title function_ invoke__">load</span>(<span class="title class_">Yii</span>::<span class="variable">$app</span>-&gt;request-&gt;<span class="title function_ invoke__">post</span>()) &amp;&amp; <span class="variable">$model</span>-&gt;<span class="title function_ invoke__">save</span>()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">redirect</span>([<span class="string">&#x27;view&#x27;</span>, <span class="string">&#x27;id&#x27;</span> =&gt; <span class="variable">$model</span>-&gt;id]);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">render</span>(<span class="string">&#x27;update&#x27;</span>, [</span><br><span class="line">                <span class="string">&#x27;model&#x27;</span> =&gt; <span class="variable">$model</span>,</span><br><span class="line">            ]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">createLog</span>(<span class="params"><span class="variable">$old_values</span> = <span class="literal">null</span>, <span class="variable">$new_values</span> = <span class="literal">null</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$log</span> = <span class="keyword">new</span> <span class="title class_">Log</span>();</span><br><span class="line">        <span class="variable">$log</span>-&gt;title = <span class="variable">$old_values</span>[<span class="string">&#x27;title&#x27;</span>];</span><br><span class="line">        <span class="variable">$log</span>-&gt;<span class="title function_ invoke__">save</span>();</span><br><span class="line"></span><br><span class="line">        <span class="variable">$model</span> = <span class="keyword">new</span> <span class="title class_">Message</span>();</span><br><span class="line">        <span class="variable">$field_name</span> = <span class="variable">$model</span>-&gt;<span class="title function_ invoke__">attributeLabels</span>();</span><br><span class="line">        <span class="variable">$value</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="variable">$i</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$old_values</span> <span class="keyword">as</span> <span class="variable">$k</span> =&gt; <span class="variable">$v</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$i</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="variable">$value</span> .= <span class="string">&quot;,&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$value</span> .= <span class="string">&quot;(<span class="subst">$log</span>-&gt;id,&#x27;&quot;</span> . <span class="variable">$k</span> . <span class="string">&quot;&#x27;,&#x27;&quot;</span> . <span class="variable">$field_name</span>[<span class="variable">$k</span>] . <span class="string">&quot;&#x27;,&#x27;&quot;</span> . <span class="variable">$v</span> . <span class="string">&quot;&#x27;,&#x27;&quot;</span> . <span class="variable">$new_values</span>[<span class="variable">$k</span>] . <span class="string">&quot;&#x27;)&quot;</span>;</span><br><span class="line">            <span class="variable">$i</span> += <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title class_">Yii</span>::<span class="variable">$app</span>-&gt;db-&gt;<span class="title function_ invoke__">createCommand</span>(<span class="string">&quot;insert into y2bg_detail (log_id,field,field_name,old_value,new_value) values <span class="subst">&#123;$value&#125;</span>&quot;</span>)-&gt;<span class="title function_ invoke__">execute</span>();</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤šæ•°æ®åº“æ“ä½œ</span></span><br><span class="line"><span class="comment">//æ–°å¢æ•°æ®åº“å¦‚ä¸‹:</span></span><br><span class="line">[</span><br><span class="line">    <span class="string">&#x27;db1&#x27;</span>=&gt;<span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&#x27;class&#x27;</span>=&gt;<span class="string">&#x27;CDbConnection&#x27;</span>,<span class="comment">//ä¸€å®šéœ€è¦è¿™ä¸ª</span></span><br><span class="line">        <span class="string">&#x27;connectionString&#x27;</span> =&gt; <span class="string">&#x27;mysql:host=localhost;dbname=test&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;emulatePrepare&#x27;</span> =&gt; <span class="literal">true</span>,</span><br><span class="line">        <span class="string">&#x27;username&#x27;</span> =&gt; <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;password&#x27;</span> =&gt; <span class="string">&#x27;123456&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;charset&#x27;</span> =&gt; <span class="string">&#x27;utf8&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    ),</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="comment">//DAOæ–¹å¼:</span></span><br><span class="line"><span class="title class_">Yii</span>::<span class="title function_ invoke__">app</span>()-&gt;db1;</span><br><span class="line"></span><br><span class="line">ARæ–¹å¼ï¼š</span><br><span class="line">é€šè¿‡GIIæ–°å»ºmodelï¼Œåœ¨dbä¸­é€‰æ‹©db1â†’åˆ›å»ºã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">//åœ¨åˆ›å»ºçš„modelä¸­å‡ºç°å¦‚ä¸‹ä»£ç ï¼ŒæŒ‡å®šäº†è¿æ¥çš„æ•°æ®åº“ï¼Œä»¥æ­¤è¾¾åˆ°ARå¤šæ•°æ®åº“</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getDbConnection</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Yii</span>::<span class="title function_ invoke__">app</span>()-&gt;db1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">YII PDOStatement::bindParamçš„ä¸€ä¸ªé™·é˜±</span></span><br><span class="line"><span class="comment">http://www.laruence.com/2012/10/16/2831.html</span></span><br><span class="line"><span class="comment">è¯¦æƒ…ï¼š</span></span><br><span class="line"><span class="comment">æ–¹æ³• bindParam() å’Œ bindValue() éå¸¸ç›¸ä¼¼ã€‚å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯å‰è€…ä½¿ç”¨ä¸€ä¸ª PHP å˜é‡ç»‘å®šå‚æ•°(&amp;$value)ï¼Œ è€Œåè€…ä½¿ç”¨ä¸€ä¸ªå€¼ã€‚å¯¹äºé‚£äº›å†…å­˜ä¸­çš„å¤§æ•°æ®å—å‚æ•°ï¼Œå¤„äºæ€§èƒ½çš„è€ƒè™‘ï¼Œåº”ä¼˜å…ˆä½¿ç”¨å‰è€…ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
          <category> æ¡†æ¶ </category>
          
          <category> YII </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>YIIæ—¥å¿—åŠŸèƒ½</title>
      <link href="/posts/ed51fe4e.html"/>
      <url>/posts/ed51fe4e.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight zephir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">yiiæ—¥å¿—åŠŸèƒ½è¯¦è§£ï¼š</span><br><span class="line">ä¸€ã€åŸºæœ¬æ—¥å¿—åŠŸèƒ½</span><br><span class="line"></span><br><span class="line">è¯¦ç»†çš„ä»‹ç»æŸ¥çœ‹å®˜ç½‘çš„documentï¼šhttp:<span class="comment">//www.yiiframework.com/doc/guide/1.1/en/topics.logging</span></span><br><span class="line"></span><br><span class="line">ä¹Ÿå¯ä»¥çœ‹ Yii <span class="number">1.1</span> Application Development Cookbook     è¿™æœ¬ä¹¦å¾ˆå¥½</span><br><span class="line"></span><br><span class="line">é»˜è®¤çš„æ—¥å¿—æ˜¯è¾“å‡ºåˆ°<span class="keyword">protected</span>/runtime/application.log </span><br><span class="line"></span><br><span class="line">å¦‚æœéœ€è¦ä¿®æ”¹é‚£ä¹ˆéœ€è¦åœ¨main.phpé‡Œé¢çš„ components ä¸‹é¢å¢åŠ logé…ç½®ï¼Œå¦‚ä¸‹ï¼š</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;preload&#x27;</span> =&gt; <span class="keyword">array</span>(<span class="string">&#x27;log&#x27;</span>),<span class="comment">//è¿™å¥ä¹Ÿå¿…é¡»åŠ ä¸Š</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;components&#x27;</span> =&gt; <span class="keyword">array</span>( </span><br><span class="line">        <span class="string">&#x27;log&#x27;</span>=&gt;<span class="keyword">array</span>( </span><br><span class="line">            <span class="string">&#x27;class&#x27;</span>=&gt;<span class="string">&#x27;CLogRouter&#x27;</span>, </span><br><span class="line">            <span class="string">&#x27;routes&#x27;</span>=&gt;<span class="keyword">array</span>(</span><br><span class="line">               <span class="comment">//è¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶routeè¡¨ç¤ºcategoryä¸ºtestå¼€å¤´çš„æ‰€æœ‰ç±»å‹çš„è¾“å‡ºéƒ½ä¼šè®°å½•åˆ°runtime/test.logä¸‹é¢ </span></span><br><span class="line">                 <span class="keyword">array</span>( </span><br><span class="line">                     <span class="string">&#x27;class&#x27;</span>=&gt;<span class="string">&#x27;CFileLogRoute&#x27;</span>, </span><br><span class="line">                     <span class="string">&#x27;levels&#x27;</span>=&gt;<span class="string">&#x27;trace, info, debug, warn, error, fatal, profile&#x27;</span>, </span><br><span class="line">                     <span class="string">&#x27;categories&#x27;</span>=&gt;<span class="string">&#x27;test.*&#x27;</span>, </span><br><span class="line">                     <span class="string">&#x27;maxFileSize&#x27;</span>=&gt;<span class="number">1048576</span>,<span class="comment">//å•æ–‡ä»¶æœ€å¤§1G </span></span><br><span class="line">                     <span class="string">&#x27;logFile&#x27;</span>=&gt;<span class="string">&#x27;test.log&#x27;</span>, </span><br><span class="line">                 ), </span><br><span class="line">                  <span class="comment">// </span></span><br><span class="line">  </span><br><span class="line"><span class="comment">//                å¼€å‘è¿‡ç¨‹ä¸­æ‰€æœ‰æ—¥å¿—ç›´æ¥è¾“å‡ºåˆ°æµè§ˆå™¨äº†ï¼Œè¿™æ ·ä¸éœ€è¦ç™»å½•æœåŠ¡å™¨çœ‹æ—¥å¿—äº†    </span></span><br><span class="line"></span><br><span class="line">                     </span><br><span class="line">                 <span class="keyword">array</span>( </span><br><span class="line">                    <span class="string">&#x27;class&#x27;</span> =&gt; <span class="string">&#x27;CWebLogRoute&#x27;</span>, <span class="comment">//åœ¨é¡µé¢ä¸Šæ˜¾ç¤ºæ—¥å¿—</span></span><br><span class="line">                    <span class="string">&#x27;categories&#x27;</span> =&gt; <span class="string">&#x27;test.*&#x27;</span>, </span><br><span class="line">                    <span class="string">&#x27;levels&#x27;</span> =&gt; CLogger::LEVEL_PROFILE, </span><br><span class="line">                    <span class="string">&#x27;showInFireBug&#x27;</span> =&gt; <span class="keyword">true</span>, <span class="comment">//åœ¨consoleæ˜¾ç¤ºæ—¥å¿—</span></span><br><span class="line">                    <span class="string">&#x27;ignoreAjaxInFireBug&#x27;</span> =&gt; <span class="keyword">true</span>, </span><br><span class="line">                ), </span><br><span class="line">                <span class="keyword">array</span>( </span><br><span class="line">                    <span class="string">&#x27;class&#x27;</span> =&gt; <span class="string">&#x27;CWebLogRoute&#x27;</span>, </span><br><span class="line">                    <span class="string">&#x27;categories&#x27;</span> =&gt; <span class="string">&#x27;test.* &#x27;</span>, </span><br><span class="line">                ), </span><br><span class="line"></span><br><span class="line">                <span class="keyword">array</span>( </span><br><span class="line">                    <span class="string">&#x27;class&#x27;</span>=&gt;<span class="string">&#x27;CEmailLogRoute&#x27;</span>, </span><br><span class="line">                    <span class="string">&#x27;levels&#x27;</span>=&gt;<span class="string">&#x27;error, warning&#x27;</span>, </span><br><span class="line">                    <span class="string">&#x27;emails&#x27;</span>=&gt;<span class="string">&#x27;admin@example.com&#x27;</span>, </span><br><span class="line">                ), </span><br><span class="line">            ), </span><br><span class="line">        ), </span><br><span class="line">  </span><br><span class="line">    ),</span><br><span class="line"></span><br><span class="line">å¦‚æœåœ¨æŸå¤„è°ƒç”¨äº†Yii::log(<span class="string">&quot;jdkshgds&quot;</span>,<span class="string">&quot;info&quot;</span>,<span class="string">&#x27;test.xx&#x27;</span>);</span><br><span class="line"></span><br><span class="line">è¿™ä¸ªlogé¦–å…ˆè¢«è®°å½•åœ¨äº†å†…å­˜ä¸­ä¸€ä¸ªCLoggerç±»çš„<span class="keyword">array</span>ä¸­ï¼Œç„¶åä¼šé€ä¸€çš„åˆ¤æ–­æ¯ä¸ªLogRouteï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦è¾“å‡ºï¼Œæ³¨æ„æ˜¯é€ä¸€åˆ¤æ–­ï¼Œä¸æ˜¯å…¶ä¸­ä¸€ä¸ªè¾“å‡ºä¸‹ä¸€ä¸ªå°±ä¸ç®¡äº†ã€‚</span><br><span class="line"></span><br><span class="line">æ‹¿ä¸Šé¢çš„é…ç½®æ¥è¯´ï¼š</span><br><span class="line"></span><br><span class="line">ç¬¬ä¸€ä¸ªCFileLogRouteï¼Œ<span class="string">&#x27;categories&#x27;</span>=&gt;<span class="string">&#x27;test.*&#x27;</span>,levelsé‡ŒåŒ…å«äº†info, test.xxæ»¡è¶³æ¡ä»¶ï¼Œæ‰€ä»¥ä¼šæ‰§è¡Œï¼Œå°†è¿™æ¡logè¾“å‡ºåˆ°test.logä¸­ï¼Œç„¶åä¸‹ä¸€ä¸ªCWebLogRouteï¼Œ <span class="string">&#x27;levels&#x27;</span> =&gt; CLogger::LEVEL_PROFILE,ã€‚è€Œè¿™æ¡logæ˜¯infoçš„ï¼Œæ‰€ä»¥ä¸ä¼šæ‰§è¡Œï¼Œå†ä¸‹ä¸€ä¸ªCWebLogRouteï¼Œ<span class="string">&#x27;categories&#x27;</span> =&gt; <span class="string">&#x27;test.* &#x27;</span>,levelsæ²¡æŒ‡å®šï¼Œé‚£å°±è¯´ä¸è¿‡æ»¤ï¼Œæ‰€ä»¥è¿™ä¸ªä¹Ÿä¼šè¢«æ‰§è¡Œï¼Œæ‰€ä»¥è¿™æ¡logå°†è¢«è¾“å‡ºåˆ°æµè§ˆå™¨ä¸­ã€‚</span><br><span class="line"></span><br><span class="line">äºŒã€profileåŠŸèƒ½</span><br><span class="line">å¦å¤–loggerè¿˜æœ‰ä¸€ä¸ªå¾ˆå¼ºå¤§çš„åŠŸèƒ½:profile, </span><br><span class="line"></span><br><span class="line">Yii::beginProfile(<span class="string">&#x27;blockID&#x27;</span>);</span><br><span class="line">...code block being profiled...</span><br><span class="line">Yii::endProfile(<span class="string">&#x27;blockID&#x27;</span>);</span><br><span class="line">è¿™æ ·å°±èƒ½æµ‹è¯•è¿™ä¸ªcode blockçš„æ‰§è¡Œæ•ˆç‡äº†ï¼Œéå¸¸çš„æ–¹ä¾¿å•Šã€‚</span><br><span class="line"></span><br><span class="line">æ›´è¯¦ç»†çš„é…ç½®æŸ¥çœ‹ï¼šhttp:<span class="comment">//www.yiiframework.com/doc/api/1.1/CProfileLogRoute</span></span><br><span class="line"></span><br><span class="line">ç„¶åè¿˜æœ‰ä¸€ä¸ªå¾ˆBUGçš„åŠŸèƒ½ï¼ŒProfiling SQL Executions</span><br><span class="line"></span><br><span class="line">å¾ˆå¤šæ—¶å€™sqlè¯­å¥å†™çš„ä¸å¥½ä¼šéå¸¸å½±å“æ•ˆç‡çš„ï¼Œä½†æ˜¯è¦ç¡®å®šå“ªä¸€æ¡è¯­å¥å½±å“äº†æ•ˆç‡å°±éœ€è¦profilingäº†ã€‚YIIä¹Ÿæä¾›äº†è¿™ä¸ªbugçº§åˆ«çš„åŠŸèƒ½ã€‚å…·ä½“å‚çœ‹http:<span class="comment">//www.yiiframework.com/doc/api/1.1/CDbConnection#enableProfiling-detail</span></span><br><span class="line"></span><br><span class="line">ä¸‹é¢æ˜¯æˆªå–çš„ç‰‡æ®µï¼š</span><br><span class="line"></span><br><span class="line">Profiling is especially useful when working with database since SQL executions are often the main performance bottleneck of an application. While we can manually insert   beginProfile   and   endProfile   statements at appropriate places to measure the time spent in each SQL execution, Yii provides a more systematic approach to solve this problem.</span><br><span class="line"></span><br><span class="line">By setting   CDbConnection::enableProfiling   to be <span class="keyword">true</span> in the application configuration, every SQL statement being executed will be profiled. The results can be readily displayed using the aforementioned   CProfileLogRoute , which can show us how much time is spent in executing what SQL statement. We can also call  CDbConnection::getStats()   to retrieve the total number SQL statements executed and their total execution time.</span><br><span class="line"></span><br><span class="line">ä¸‰ã€BUGçº§åŠŸèƒ½ï¼šè°ƒè¯•sql queryæ¯ä¸ªè¯­å¥æ‰§è¡Œçš„è€—æ—¶</span><br><span class="line"></span><br><span class="line">åœ¨é…ç½®ä¸­çš„logä¸‹åŠ ä¸Šä¸‹é¢è¿™ä¸ªRoute</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿™ä¸ªé…ç½®ä¸“é—¨è´Ÿè´£æ•°æ®åº“æ“ä½œçš„profile </span></span><br><span class="line"><span class="keyword">array</span>( </span><br><span class="line">       <span class="string">&#x27;class&#x27;</span>=&gt;<span class="string">&#x27;CProfileLogRoute&#x27;</span>, </span><br><span class="line">       <span class="string">&#x27;levels&#x27;</span> =&gt; CLogger::LEVEL_PROFILE, </span><br><span class="line">       <span class="string">&#x27;showInFireBug&#x27;</span> =&gt; <span class="keyword">true</span>, </span><br><span class="line">       <span class="string">&#x27;ignoreAjaxInFireBug&#x27;</span> =&gt; <span class="keyword">true</span>, </span><br><span class="line">       <span class="string">&#x27;categories&#x27;</span> =&gt; <span class="string">&#x27;system.db.* &#x27;</span>, <span class="comment">//åªè®°å½•dbçš„æ“ä½œæ—¥å¿—ï¼Œå…¶ä»–çš„å¿½ç•¥ </span></span><br><span class="line">),</span><br><span class="line"></span><br><span class="line">ç„¶ååœ¨æŸä¸ªcontrollerçš„æŸä¸ªactionä¸­åŠ å…¥ï¼š</span><br><span class="line"></span><br><span class="line">Yii::beginProfile(<span class="string">&#x27;db&#x27;</span>, <span class="string">&#x27;pocketpet&#x27;</span>); </span><br><span class="line"><span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;<span class="number">1000</span>;$i++)&#123; </span><br><span class="line">      $user = UserModel::model()-&gt;findByPk(<span class="string">&quot;1&quot;</span>);<span class="comment">//è¿™é‡Œåªè¦æ˜¯æ•°æ®åº“æ“ä½œå°±è¡Œï¼Œè¿™ä¸ªåªæ˜¯ä¸ªä¾‹å­ </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Yii::endProfile(<span class="string">&#x27;db&#x27;</span>, <span class="string">&#x27;pocketpet&#x27;</span>);</span><br><span class="line"></span><br><span class="line">åœ¨æµè§ˆå™¨ä¸­è®¿é—®è¿™ä¸ªactionï¼Œè®°å¾—å…ˆæ‰“å¼€firebugï¼Œç„¶åfirebugä¸­å°±èƒ½çœ‹åˆ°å¦‚ä¸‹å›¾çš„è®°å½•ï¼š</span><br></pre></td></tr></table></figure><p><img src="/images/%E5%90%8E%E7%AB%AF/php/YII/Yii%E6%97%A5%E5%BF%97.jpg" alt="Tiiæ—¥å¿—"></p><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">ç›¸åŒçš„queryä¼šè¿›è¡Œå½’ç±»ï¼Œè®¡ç®—totalå’Œ<span class="keyword">average</span>ï¼Œè¿™ä¸ªå¯¹äºåˆ†æè¿˜æ˜¯éå¸¸æœ‰å¸®åŠ©çš„ã€‚</span><br><span class="line"></span><br><span class="line">ä¹Ÿå¯ä»¥å°†dbçš„æ—¥å¿—å†™åˆ°æ–‡ä»¶ï¼Œé…ç½®å¦‚ä¸‹ï¼ˆä¸å»ºè®®ä½¿ç”¨ï¼Œè¿˜æ˜¯åˆ°æµè§ˆå™¨ç”¨firebugæ–¹ä¾¿ï¼‰ï¼š</span><br><span class="line"></span><br><span class="line"><span class="built_in">array</span>( </span><br><span class="line">    <span class="string">&#x27;class&#x27;</span>=&gt;<span class="string">&#x27;CFileLogRoute&#x27;</span>, </span><br><span class="line">    <span class="string">&#x27;levels&#x27;</span> =&gt; CLogger<span class="type">::LEVEL_PROFILE</span>, </span><br><span class="line">    <span class="string">&#x27;categories&#x27;</span> =&gt; <span class="string">&#x27;system.db.* &#x27;</span>, <span class="comment">//åªè®°å½•dbçš„æ“ä½œæ—¥å¿—ï¼Œå…¶ä»–çš„å¿½ç•¥ </span></span><br><span class="line">    <span class="string">&#x27;logFile&#x27;</span>=&gt;<span class="string">&#x27;db.log&#x27;</span>, </span><br><span class="line">),</span><br><span class="line"></span><br><span class="line">å½“ç„¶ï¼Œæƒ³è¦ç”Ÿæ•ˆè¿˜å¾—æœ‰ä¸‹é¢ä¸¤æ­¥é…ç½®:</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> . è®°å¾—åœ¨index.php, ä¸­åŠ å…¥ä»¥ä¸‹é…ç½®ï¼Œé«˜äº®çš„é‚£äº›</span><br><span class="line"></span><br><span class="line">$yii = dirname(__FILE__).<span class="string">&#x27;/../yii/framework/yii.php&#x27;</span>;</span><br><span class="line">$config = dirname(__FILE__).<span class="string">&#x27;/protected/config/main.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line">defined(<span class="string">&#x27;YII_DEBUG&#x27;</span>) <span class="literal">or</span> <span class="class"><span class="keyword">define</span></span>(<span class="string">&#x27;YII_DEBUG&#x27;</span>,<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">defined(<span class="string">&#x27;YII_DEBUG_SHOW_PROFILER&#x27;</span>) <span class="literal">or</span> <span class="class"><span class="keyword">define</span></span>(<span class="string">&#x27;YII_DEBUG_SHOW_PROFILER&#x27;</span>,<span class="literal">true</span>);</span><br><span class="line"><span class="comment">//enable profiling</span></span><br><span class="line">defined(<span class="string">&#x27;YII_DEBUG_PROFILING&#x27;</span>) <span class="literal">or</span> <span class="class"><span class="keyword">define</span></span>(<span class="string">&#x27;YII_DEBUG_PROFILING&#x27;</span>,<span class="literal">true</span>);</span><br><span class="line"><span class="comment">//trace level</span></span><br><span class="line">defined(<span class="string">&#x27;YII_TRACE_LEVEL&#x27;</span>) <span class="literal">or</span> <span class="class"><span class="keyword">define</span></span>(<span class="string">&#x27;YII_TRACE_LEVEL&#x27;</span>,<span class="number">3</span>);</span><br><span class="line"><span class="comment">//execution time</span></span><br><span class="line">defined(<span class="string">&#x27;YII_DEBUG_DISPLAY_TIME&#x27;</span>) <span class="literal">or</span> <span class="class"><span class="keyword">define</span></span>(<span class="string">&#x27;YII_DEBUG_DISPLAY_TIME&#x27;</span>,<span class="literal">false</span>);</span><br><span class="line">require_once($yii);</span><br><span class="line">Yii<span class="type">::createWebApplication</span>($config)-&gt;run();</span><br><span class="line"><span class="number">2.</span> åœ¨main.phpä¸»é…ç½®æ–‡ä»¶é‡Œé¢ï¼Œçš„components db é‡Œå°†enableProfilingè®¾ç½®ä¸º<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;components&#x27;</span> =&gt; <span class="built_in">array</span>(</span><br><span class="line"><span class="string">&#x27;db&#x27;</span> =&gt; <span class="built_in">array</span>(</span><br><span class="line">        <span class="string">&#x27;enableProfiling&#x27;</span> =&gt; <span class="literal">true</span>, <span class="comment">//è¿™ä¸ªæ˜¯ç”¨æ¥è®°å½•æ—¥å¿—çš„ï¼Œä¼šè®°å½•æ¯ä¸€æ¡è¯­å¥æ‰§è¡Œçš„æ—¶é—´</span></span><br><span class="line">        <span class="string">&#x27;enableParamLogging&#x27;</span> =&gt; <span class="literal">true</span>,<span class="comment">//trueè¡¨ç¤ºåŒ…æ‹¬sqlè¯­å¥çš„å‚æ•°åœ¨å†…çš„ä¿¡æ¯éƒ½ä¼šè®°å½•åˆ°æ—¥å¿—é‡Œï¼Œéå¸¸è¯¦ç»†</span></span><br><span class="line">    ),</span><br><span class="line">)</span><br><span class="line">å››ã€è°ƒç”¨ç¤ºä¾‹</span><br><span class="line">Yii<span class="type">::log</span>(<span class="string">&quot;dfdf&quot;</span>,CLogger<span class="type">::LEVEL_INFO</span>,<span class="string">&quot;example&quot;</span>); </span><br><span class="line">Yii<span class="type">::log</span>(<span class="string">&quot;dfdf&quot;</span>,CLogger<span class="type">::LEVEL_INFO</span>,<span class="string">&quot;example&quot;</span>); </span><br><span class="line">Yii<span class="type">::log</span>(<span class="string">&quot;dfdf&quot;</span>,CLogger<span class="type">::LEVEL_ERROR</span>,<span class="string">&quot;example&quot;</span>); </span><br><span class="line">Yii<span class="type">::trace</span>(<span class="string">&quot;dfdf&quot;</span>, <span class="string">&quot;example&quot;</span>); </span><br><span class="line">Yii<span class="type">::trace</span>(<span class="string">&#x27;example trace message&#x27;</span>, <span class="string">&#x27;example&#x27;</span>); </span><br><span class="line">Yii<span class="type">::log</span>(<span class="string">&#x27;info&#x27;</span>, CLogger<span class="type">::LEVEL_INFO</span>, <span class="string">&#x27;example&#x27;</span>); </span><br><span class="line">Yii<span class="type">::log</span>(<span class="string">&#x27;error&#x27;</span>, CLogger<span class="type">::LEVEL_ERROR</span>, <span class="string">&#x27;example&#x27;</span>); </span><br><span class="line">Yii<span class="type">::log</span>(<span class="string">&#x27;trace&#x27;</span>, CLogger<span class="type">::LEVEL_TRACE</span>, <span class="string">&#x27;example&#x27;</span>); </span><br><span class="line">Yii<span class="type">::log</span>(<span class="string">&#x27;warning&#x27;</span>, CLogger<span class="type">::LEVEL_WARNING</span>, <span class="string">&#x27;example&#x27;</span>); </span><br><span class="line">Yii<span class="type">::beginProfile</span>(<span class="string">&#x27;db&#x27;</span>, <span class="string">&#x27;example&#x27;</span>); </span><br><span class="line">for($i=<span class="number">0</span>;$i&lt;<span class="number">1000</span>;$i++)&#123; </span><br><span class="line">    $user = UserModel<span class="type">::model</span>()-&gt;findByPk(<span class="string">&quot;1&quot;</span>); </span><br><span class="line">&#125; </span><br><span class="line">Yii<span class="type">::endProfile</span>(<span class="string">&#x27;db&#x27;</span>, <span class="string">&#x27;example&#x27;</span>); </span><br><span class="line">echo <span class="string">&#x27;done&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
          <category> æ¡†æ¶ </category>
          
          <category> YII </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>thinkphp</title>
      <link href="/posts/b96f5dfe.html"/>
      <url>/posts/b96f5dfe.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ThinkPHPä¸­çš„__initialize()å’Œç±»çš„æ„é€ å‡½æ•°__construct()</span></span><br><span class="line">åœ°å€ï¼šhttp://www.thinkphp.cn/code/367.html</span><br><span class="line">1ã€__initialize()ä¸æ˜¯phpç±»ä¸­çš„å‡½æ•°ï¼Œphpç±»çš„æ„é€ å‡½æ•°åªæœ‰__construct().</span><br><span class="line">2ã€ç±»çš„åˆå§‹åŒ–ï¼šå­ç±»å¦‚æœæœ‰è‡ªå·±çš„æ„é€ å‡½æ•°ï¼ˆ__construct()ï¼‰,åˆ™è°ƒç”¨è‡ªå·±çš„è¿›è¡Œåˆå§‹åŒ–ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°è¿›è¡Œè‡ªå·±çš„åˆå§‹åŒ–ã€‚</span><br><span class="line">3ã€å½“å­ç±»å’Œçˆ¶ç±»éƒ½æœ‰__construct()å‡½æ•°çš„æ—¶å€™ï¼Œå¦‚æœè¦åœ¨åˆå§‹åŒ–å­ç±»çš„æ—¶å€™åŒæ—¶è°ƒç”¨çˆ¶ç±»çš„__constrcut()ï¼Œåˆ™å¯ä»¥åœ¨å­ç±»ä¸­ä½¿ç”¨parent::__construct().</span><br><span class="line">4ã€_initialize()å‡½æ•°æ˜¯åœ¨ä»»ä½•æ–¹æ³•æ‰§è¡Œä¹‹å‰ï¼Œéƒ½è¦æ‰§è¡Œçš„ï¼Œå½“ç„¶ä¹ŸåŒ…æ‹¬_ _constructæ„é€ å‡½æ•°ï¼Œæ³¨æ„ï¼Œ_ _constructè¿™é‡Œæ˜¯åŒåˆ’çº¿ï¼Œè€Œ_initialize()å‡½æ•°æ˜¯å•åˆ’çº¿ã€‚</span><br><span class="line">5ã€å¦‚æœçˆ¶å­ç±»å‡æœ‰_initialize()å‡½æ•°ï¼Œåˆ™å­ç±»è¦†ç›–äº†çˆ¶ç±»çš„ï¼Œå¦‚æœå­ç±»æ²¡æœ‰è€Œçˆ¶ç±»æœ‰ï¼Œåˆ™å­ç±»ç»§æ‰¿çˆ¶ç±»çš„ã€‚åœ¨è°ƒç”¨å­ç±»å¯¹è±¡çš„_initialize()æ—¶ï¼Œä¸ä¼šå¯¼è‡´è‡ªåŠ¨è°ƒç”¨çˆ¶ç±»çš„_initialize()ã€‚</span><br><span class="line">6ã€é»˜è®¤æƒ…å†µä¸‹ï¼Œå­ç±»çš„æ„é€ å‡½æ•°ä¹Ÿä¸ä¼šè‡ªåŠ¨è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œè¿™ä¸€ç‚¹ä¸Javaä¸åŒã€‚å®é™…ç¼–å†™å­ç±»çš„æ„é€ å‡½æ•°æ—¶ï¼Œä¸€èˆ¬éƒ½è¦åŠ ä¸Šçˆ¶ç±»æ„é€ å‡½æ•°çš„ä¸»åŠ¨è°ƒç”¨parent::_ _construct()ï¼Œå¦åˆ™ä¼šå¯¼è‡´å­ç±»å¯¹è±¡ç©ºæŒ‡é’ˆçš„å¼‚å¸¸ï¼Œå¦‚Call to a member <span class="keyword">function</span> assign() on a non-objectã€‚</span><br><span class="line">7ã€_initialize()å‡½æ•°æ˜¯åœ¨â€œä»»ä½•â€æ–¹æ³•è°ƒç”¨ä¹‹å‰éƒ½è¦è°ƒç”¨çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœå­˜åœ¨_initialize()å‡½æ•°ï¼Œè°ƒç”¨å¯¹è±¡çš„ä»»ä½•æ–¹æ³•éƒ½ä¼šå¯¼è‡´_initialize()å‡½æ•°çš„è‡ªåŠ¨è°ƒç”¨ï¼Œè€Œ_ _constructæ„é€ å‡½æ•°ä»…ä»…åœ¨åˆ›å»ºå¯¹è±¡çš„æ—¶å€™è°ƒç”¨ä¸€æ¬¡ï¼Œè·Ÿå…¶å®ƒæ–¹æ³•è°ƒç”¨æ²¡æœ‰å…³ç³»ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­—æ®µæ’é™¤</span></span><br><span class="line">å¦‚æœæˆ‘å¸Œæœ›è·å–æ’é™¤æ•°æ®è¡¨ä¸­çš„contentå­—æ®µï¼ˆæ–‡æœ¬å­—æ®µçš„å€¼éå¸¸è€—å†…å­˜ï¼‰ä¹‹å¤–çš„æ‰€æœ‰å­—æ®µå€¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨fieldæ–¹æ³•çš„æ’é™¤åŠŸèƒ½ï¼Œä¾‹å¦‚ä¸‹é¢çš„æ–¹å¼å°±å¯ä»¥å®ç°æ‰€è¯´çš„åŠŸèƒ½ï¼š</span><br><span class="line"><span class="variable">$Model</span>-&gt;field(<span class="string">&#x27;content&#x27;</span>,<span class="literal">true</span>)-&gt;<span class="keyword">select</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment"># thinkphp volist ä¸­çš„emptyå¢åŠ æ ·å¼</span></span><br><span class="line">ä¸ºç©ºçš„æ—¶å€™è¾“å‡ºæç¤ºï¼š</span><br><span class="line">&lt;volist name=<span class="string">&quot;list&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;vo&quot;</span> empty=<span class="string">&quot;æš‚æ—¶æ²¡æœ‰æ•°æ®&quot;</span> &gt;</span><br><span class="line">&#123;<span class="variable">$vo</span>.<span class="built_in">id</span>&#125;|&#123;<span class="variable">$vo</span>.name&#125;</span><br><span class="line"> &lt;/volist&gt;</span><br><span class="line">emptyå±æ€§ä¸æ”¯æŒç›´æ¥ä¼ å…¥htmlè¯­æ³•ï¼Œä½†å¯ä»¥æ”¯æŒå˜é‡è¾“å‡ºï¼Œä¾‹å¦‚ï¼š</span><br><span class="line"><span class="variable">$this</span>-&gt;assign(<span class="string">&#x27;empty&#x27;</span>,<span class="string">&#x27;&lt;span class=&quot;empty&quot;&gt;æ²¡æœ‰æ•°æ®&lt;/span&gt;&#x27;</span>);</span><br><span class="line"><span class="variable">$this</span>-&gt;assign(<span class="string">&#x27;list&#x27;</span>,<span class="variable">$list</span>);</span><br><span class="line">ç„¶ååœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ï¼š</span><br><span class="line">&lt;volist name=<span class="string">&quot;list&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;vo&quot;</span> empty=<span class="string">&quot;<span class="variable">$empty</span>&quot;</span> &gt;</span><br><span class="line">&#123;<span class="variable">$vo</span>.<span class="built_in">id</span>&#125;|&#123;<span class="variable">$vo</span>.name&#125;</span><br><span class="line">&lt;/volist&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># thinkphpå…³é—­å­—æ®µç¼“å­˜</span></span><br><span class="line">å¯ä»¥é€šè¿‡è®¾ç½®DB_FIELDS_CACHE å‚æ•°æ¥å…³é—­å­—æ®µè‡ªåŠ¨ç¼“å­˜ï¼Œå¦‚æœåœ¨å¼€å‘çš„æ—¶å€™ç»å¸¸å˜åŠ¨æ•°æ®åº“çš„ç»“æ„ï¼Œè€Œä¸å¸Œæœ›è¿›è¡Œæ•°æ®è¡¨çš„å­—æ®µç¼“å­˜ï¼Œå¯ä»¥åœ¨é¡¹ç›®é…ç½®æ–‡ä»¶ä¸­å¢åŠ å¦‚ä¸‹é…ç½®ï¼š</span><br><span class="line"><span class="string">&#x27;DB_FIELDS_CACHE&#x27;</span>=&gt;<span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># thinkPhp Uæ–¹æ³•ä¸­ä½¿ç”¨jså˜é‡</span></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    var uid = ...;// jsä¸­è·å¾—<span class="built_in">id</span></span><br><span class="line">    var url = <span class="string">&quot;&#123;:U(&#x27;Cate/add&#x27;)&#125;?id=&quot;</span> + uid; // ate/addæ–¹æ³•ä¸­å°±å¯ä»¥I(<span class="string">&quot;id&quot;</span>)è·å–äº†</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> php </category>
          
          <category> æ¡†æ¶ </category>
          
          <category> thinkphp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å…·</title>
      <link href="/posts/93c14ecb.html"/>
      <url>/posts/93c14ecb.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ä¸€ã€ç»ˆç«¯è½¯ä»¶"><a href="#ä¸€ã€ç»ˆç«¯è½¯ä»¶" class="headerlink" title="ä¸€ã€ç»ˆç«¯è½¯ä»¶"></a>ä¸€ã€ç»ˆç«¯è½¯ä»¶</h1><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1.MobaXterm</span><br></pre></td></tr></table></figure><h1 id="äºŒ-æ¥å£æµ‹è¯•è½¯ä»¶"><a href="#äºŒ-æ¥å£æµ‹è¯•è½¯ä»¶" class="headerlink" title="äºŒ.æ¥å£æµ‹è¯•è½¯ä»¶"></a>äºŒ.æ¥å£æµ‹è¯•è½¯ä»¶</h1><ol><li>postman<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">https</span>://dl.pstmn.io/download/version/<span class="number">7</span>.<span class="number">36</span>.<span class="number">7</span>/win64</span><br><span class="line"><span class="attribute">https</span>://dl.pstmn.io/download/version/<span class="number">7</span>.<span class="number">36</span>.<span class="number">7</span>/win32</span><br><span class="line"><span class="attribute">https</span>://dl.pstmn.io/download/version/<span class="number">7</span>.<span class="number">36</span>.<span class="number">7</span>/osx64</span><br><span class="line"><span class="attribute">https</span>://dl.pstmn.io/download/version/<span class="number">7</span>.<span class="number">36</span>.<span class="number">7</span>/linux64</span><br><span class="line"></span><br><span class="line"><span class="attribute">https</span>://dl.pstmn.io/download/version/<span class="number">9</span>.<span class="number">31</span>.<span class="number">28</span>/win64</span><br><span class="line"><span class="attribute">https</span>://dl.pstmn.io/download/version/<span class="number">9</span>.<span class="number">31</span>.<span class="number">28</span>/osx64</span><br><span class="line"><span class="attribute">https</span>://dl.pstmn.io/download/version/<span class="number">9</span>.<span class="number">31</span>.<span class="number">28</span>/osx_arm64</span><br><span class="line"><span class="attribute">https</span>://dl.pstmn.io/download/version/<span class="number">9</span>.<span class="number">31</span>.<span class="number">28</span>/linux_64</span><br><span class="line"><span class="attribute">https</span>://dl.pstmn.io/download/version/<span class="number">9</span>.<span class="number">31</span>.<span class="number">28</span>/linux_arm64</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> å…¶ä»– </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å…¶ä»– </tag>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>redisç¼–è¯‘å®‰è£…</title>
      <link href="/posts/6f5ba107.html"/>
      <url>/posts/6f5ba107.html</url>
      
        <content type="html"><![CDATA[<p>&lt;Excerpt in index | é¦–é¡µæ‘˜è¦&gt;</p><span id="more"></span><p>&lt;The rest of contents | ä½™ä¸‹å…¨æ–‡&gt;</p><h1 id="ç¼–è¯‘ä»¥åŠæŒ‡å®šå®‰è£…è·¯å¾„"><a href="#ç¼–è¯‘ä»¥åŠæŒ‡å®šå®‰è£…è·¯å¾„" class="headerlink" title="ç¼–è¯‘ä»¥åŠæŒ‡å®šå®‰è£…è·¯å¾„"></a>ç¼–è¯‘ä»¥åŠæŒ‡å®šå®‰è£…è·¯å¾„</h1><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">make</span></span><br><span class="line"><span class="built_in">make</span> PREFIX=/usr/<span class="keyword">local</span>/webserver/redis install</span><br></pre></td></tr></table></figure><h1 id="é…ç½®æ–‡ä»¶ç§»åŠ¨"><a href="#é…ç½®æ–‡ä»¶ç§»åŠ¨" class="headerlink" title="é…ç½®æ–‡ä»¶ç§»åŠ¨"></a>é…ç½®æ–‡ä»¶ç§»åŠ¨</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir <span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>redis<span class="regexp">/etc/</span></span><br><span class="line">cp redis.conf <span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>redis<span class="regexp">/etc/</span></span><br></pre></td></tr></table></figure><p>#ä¿®æ”¹redisé…ç½®</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">vim <span class="keyword">/usr/</span>local<span class="keyword">/webserver/</span>redis<span class="keyword">/etc/</span>redis.conf</span><br><span class="line"></span><br><span class="line"><span class="meta"># ä¿®æ”¹ä¸€ä¸‹é…ç½®</span></span><br><span class="line"><span class="meta"># redisä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œ</span></span><br><span class="line"><span class="meta"># noè¡¨ç¤ºä¸ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œ(ä¼šå ç”¨ä¸€ä¸ªç»ˆç«¯)  </span></span><br><span class="line">daemonize yes</span><br><span class="line"></span><br><span class="line"><span class="meta"># å®¢æˆ·ç«¯é—²ç½®å¤šé•¿æ—¶é—´åæ–­å¼€è¿æ¥ï¼Œé»˜è®¤ä¸º0å…³é—­æ­¤åŠŸèƒ½                                      </span></span><br><span class="line">timeout <span class="number">300</span></span><br><span class="line"></span><br><span class="line"><span class="meta"># è®¾ç½®redisæ—¥å¿—çº§åˆ«ï¼Œé»˜è®¤çº§åˆ«ï¼šnotice                    </span></span><br><span class="line">loglevel verbose</span><br><span class="line"></span><br><span class="line"><span class="meta"># è®¾ç½®æ—¥å¿—æ–‡ä»¶çš„è¾“å‡ºæ–¹å¼,å¦‚æœä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œredis é»˜è®¤:<span class="string">&quot;&quot;</span> </span></span><br><span class="line"><span class="meta"># å¹¶ä¸”æ—¥å¿—è¾“å‡ºè®¾ç½®ä¸ºstdout,é‚£ä¹ˆæ—¥å¿—ä¿¡æ¯å°±è¾“å‡ºåˆ°/dev/nullé‡Œé¢å»äº† </span></span><br><span class="line">logfile stdout</span><br></pre></td></tr></table></figure><h1 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vim /etc<span class="built_in">/profile</span></span><br><span class="line"><span class="built_in"></span><span class="built_in">export</span> <span class="attribute">PATH</span>=<span class="string">&quot;<span class="variable">$PATH</span>:/usr/local/webserver/redis/bin&quot;</span></span><br></pre></td></tr></table></figure><h1 id="ä¿å­˜é€€å‡º"><a href="#ä¿å­˜é€€å‡º" class="headerlink" title="ä¿å­˜é€€å‡º"></a>ä¿å­˜é€€å‡º</h1><h1 id="è®©ç¯å¢ƒå˜é‡ç«‹å³ç”Ÿæ•ˆ"><a href="#è®©ç¯å¢ƒå˜é‡ç«‹å³ç”Ÿæ•ˆ" class="headerlink" title="è®©ç¯å¢ƒå˜é‡ç«‹å³ç”Ÿæ•ˆ"></a>è®©ç¯å¢ƒå˜é‡ç«‹å³ç”Ÿæ•ˆ</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure><p>#å¼€æœºå¯åŠ¨</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vim <span class="regexp">/etc/</span>rc.local</span><br><span class="line"><span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>redis<span class="regexp">/bin/</span>redis-server <span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>redis<span class="regexp">/etc/</span>redis.conf</span><br></pre></td></tr></table></figure><p>#é‡å¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> -HUP `<span class="built_in">cat</span> /var/run/redis.pid`</span><br></pre></td></tr></table></figure><p>#å…³é—­</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> è¿›ç¨‹<span class="built_in">id</span>æˆ–è€…./redis-cli shutdown</span><br></pre></td></tr></table></figure><h1 id="é˜²ç«å¢™é…ç½®"><a href="#é˜²ç«å¢™é…ç½®" class="headerlink" title="é˜²ç«å¢™é…ç½®"></a>é˜²ç«å¢™é…ç½®</h1><p> æ‰“å¼€é˜²ç«å¢™è§„åˆ™</p><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/sysconfig/iptables</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¢åŠ å†…å®¹</span></span><br><span class="line">-A INPUT -m <span class="keyword">state</span> --state NEW -m tcp -p tcp --dport <span class="number">6379</span> -j ACCEPT</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡å¯ç«å¢™è§„åˆ™ç«‹å³ç”Ÿæ•ˆ</span></span><br><span class="line">service iptables restart </span><br></pre></td></tr></table></figure><h1 id="å®‰è£…php-redisæ‰©å±•åŒ…"><a href="#å®‰è£…php-redisæ‰©å±•åŒ…" class="headerlink" title="å®‰è£…php redisæ‰©å±•åŒ…"></a>å®‰è£…php redisæ‰©å±•åŒ…</h1><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">unzip</span> phpredis-develop.zip</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆæ‰©å±•é…ç½®</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd phpredis-develop</span><br><span class="line"><span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>php7<span class="regexp">/bin/</span>phpize</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘Redis</p><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./configure --<span class="keyword">with</span>-php-<span class="keyword">config</span>=/usr/<span class="keyword">local</span>/webserver/php7/bin/php-<span class="keyword">config</span></span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><h1 id="å®‰è£…å®Œæˆï¼Œè¿”å›æ¨¡å—æ‰€åœ¨è·¯å¾„"><a href="#å®‰è£…å®Œæˆï¼Œè¿”å›æ¨¡å—æ‰€åœ¨è·¯å¾„" class="headerlink" title="å®‰è£…å®Œæˆï¼Œè¿”å›æ¨¡å—æ‰€åœ¨è·¯å¾„"></a>å®‰è£…å®Œæˆï¼Œè¿”å›æ¨¡å—æ‰€åœ¨è·¯å¾„</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd <span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>php<span class="regexp">/lib/</span>php<span class="regexp">/extensions/</span>no-debug-non-zts-<span class="number">20100525</span>/</span><br></pre></td></tr></table></figure><p>#é…ç½®PHPæ”¯æŒredis</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">vim <span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>php<span class="regexp">/etc/</span>php.ini</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹ä»¥ä¸‹å†…å®¹</span></span><br><span class="line">extension_dir = <span class="string">&quot;/usr/local/webserver/php/lib/php/extensions/no-debug-non-zts-20100525/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¢åŠ æ‰©å±•åˆ°php</span></span><br><span class="line">extension = redis.so</span><br><span class="line"><span class="comment">#é‡æ–°å¯åŠ¨php-fpm</span></span><br><span class="line"></span><br><span class="line">kill -USR2 php-fpm è¿›ç¨‹</span><br><span class="line">kill -USR2 `cat <span class="regexp">/usr/</span>local<span class="regexp">/webserver/</span>php7<span class="regexp">/var/</span>run/php-fpm.pid`</span><br></pre></td></tr></table></figure><p>åœ¨phpæµ‹è¯•ä¸‹æ˜¯å¦æˆåŠŸ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
          <category> redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redis </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
